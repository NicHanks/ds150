'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[22],{1036:function(B,A,a){a.r(A);a.d(A,"FormulaBar",function(){return Ta});B=a(0);var c=a(15),b=a(99),k=a(5),m=a(150),d=a(16),n=a(98),l=a(785),f=a(35),h=a(384),t=a(97);class u{}u.A0h="ewa-fb";u.H0h="ewa-fb-placeholder";u.J0h="ewa-fb-text-box";u.M0h="ewa-fb-text-box-new-theme";u.K0h="ewa-fb-text-box-monospace-experiment";u.L0h="ewa-fb-text-box-new";u.bcf="ewa-fb-refactor";u.acf="ewa-fb-extended";u.tij="not-ie";u.Ukf=
"functionbox";u.BCi="green-fill-paths";u.SV="drop-down";u.zkj="ok-cancel-buttons-container";u.vYf="okbox";u.sWe="cancelbox";u.G0h="ewa-fb-nb";u.F0h="ewa-fb-name-box-placeholder";u.VR="button-disabled";u.D0h="ewa-fb-expand-button-img";u.C0h="ewa-fb-expand-button-container";u.N0h="ewa-fb-text-div-container";u.$bf="ewa-fb-drag-resize";u.B0h="ewa-fb-drag-handler";u.E0h="ewa-fb-fluent";u.aij="no-scrollbar-gutter-support";u.JCa="ewa-fb-disabled";u.I0h="ewa-fb-rtl";u.Xcf="ewa-svg-icon";u.L4="cui-disabled";
Object(B.a)(u,"CssClassNames",null,[]);var v=a(6),y=a(280),C=a(653),x=a(651),w=a(506),z=a(170),F=a(148);A=a(82);var J=a(103);class R extends J.a{constructor(Va,Db,Ca,cb,hb,ya){super(Va);this.zT=()=>{this.domElement.disabled||(this.jhc.className=this.Ojc+" "+this.vVf)};this.yT=()=>{this.domElement.disabled||(this.jhc.className=this.Ojc+" "+this.Ufj)};this.k4f=Pa=>{if(!this.domElement.disabled){const wb=Pa.keyCode;if("mousedown"===Pa.type||13===wb||32===wb)this.jhc.className=this.Ojc+" "+this.WHj}};
this.l4f=()=>{this.domElement.disabled||(this.jhc.className=this.Ojc+" "+this.vVf)};this.Ojc=Ca;this.vVf=cb;this.Ufj=hb;this.WHj=ya;this.tg.ta("mouseover",this.zT);this.tg.ta("mouseout",this.yT);this.tg.ta("focus",this.zT);this.tg.ta("blur",this.yT);this.tg.ta("mousedown",this.k4f);this.tg.ta("keydown",this.k4f);this.tg.ta("mouseup",this.l4f);this.tg.ta("keyup",this.l4f);this.jhc=Db}}Object(B.a)(R,"PseudoClassBehavior",J.a,[]);var I=a(14);class O extends A.a{constructor(Va){super();this.fVa=[];this.$=
Va}dispose(){n.a.Wf(this.fVa);this.fVa.length=0;this.$=null;super.dispose()}hec(Va,Db,Ca,cb,hb){const ya=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Af+Va);Va=Va===Db?ya:I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Af+Db);if(!ya)return null;Ca=new R(ya,Va,Ca,cb,"",hb);this.fVa.push(Ca);return Ca}}O.Rrh="ewa-menu-btn-hover";O.Trh="ewa-menu-btn-pressed";Object(B.a)(O,"InitializePseudoClasses",A.a,[]);var Y=a(27),K=a(263),L=a(208),X=a(157),T=a(41),ba=a(19);class Q{constructor(Va,
Db){this.$=Va;this.eg=Db;y.a(this.$).sn(this)}get ng(){return this.eg.Ja.Ii}get nl(){return ba.h(this.$).De&&ba.h(this.$).ov}get Qh(){return K.a.wkf}Wl(Va,Db){Db||I.DOMElementExtensions.setFocus(this.ng);return!Db}Bm(Va){return I.DOMElementExtensions.Ek(this.ng,Va)}Ko(){}Rp(){}dispose(){y.a(this.$).rD(this)}}Object(B.a)(Q,"FormulaBarFocusManager",null,[54,2]);var P=a(266),ka=a(283),ia=a(18),Ba=a(58),va=a(91),W=a(805),S=a(178),da=a(1);class aa extends A.a{constructor(Va=null,Db,Ca,cb=null){super();
this.AZa=this.Peb=this.Kcb=this.oHc=null;this.bvd=Y.a.Yw()?16:13;this.cvd=Y.a.Yw()?16:13;this.J1f=()=>{const hb=new va.a(753860909,2,this.$.zf,2,null);this.$.Ha.Me(hb);return!0};this.K1f=hb=>hb.Ga.keyCode===b.a.So?(hb=new va.a(753860909,1,this.$.zf,2,null),this.$.Ha.Me(hb),!0):!1;this.L1f=()=>{this.gridView.De&&this.gridView.lm.Ja.Fec();return!1};this.$=Ca;this.gridView=ba.h(Ca);this.mo=Db;this.svgIconProvider=cb;Y.a.Yw()?this.Kcb=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Af+
v.a.sHb):(this.fdi=Db.ia(1035),this.oHc=Va.hec(v.a.sHb,v.a.sHb,u.Ukf+" "+u.SV,u.BCi,""),this.Kcb=this.oHc.domElement);this.$Li(this.Kcb)}$Li(Va){da.EwaSettings.isChangeGateEnabled("OfficeVSO:8026743_insertFunctionButtonTooltipEnabled")&&(Va.role="button",Va.title=this.mo.ia(1035));this.Peb=this.svgIconProvider?this.svgIconProvider.Lia(W.a.edi,this.bvd,this.cvd,Va,void 0,void 0,void 0,this.mo.ia(1035)):S.createClusteredImageFromClusterWithImageClass(this.cvd,this.bvd,ia.a.t3h,Ba.a.rk(0),null,null,
!0,this.mo.ia(1035));Va.appendChild(this.Peb);P.a.instance.va(d.a.click,Va,this.J1f);m.KeyInputManager.instance.va(d.a.Hf,Va,this.K1f);ka.a.instance.va(d.a.yg,Va,this.L1f)}dispose(){this.rie(this.Kcb);this.Kcb=null;Y.a.Yw()||(n.a.Sa(this.oHc),this.oHc=null);I.DOMElementExtensions.Lj(this.Peb);this.AZa=this.Peb=null;super.dispose()}rie(Va){Va&&(P.a.instance.Da(d.a.click,Va,this.J1f),m.KeyInputManager.instance.Da(d.a.Hf,Va,this.K1f),ka.a.instance.Da(d.a.yg,Va,this.L1f))}ZDk(Va){!this.AZa&&this.svgIconProvider&&
(this.AZa=this.svgIconProvider.Lia(W.a.kdi,this.bvd,this.cvd,this.Kcb,void 0,void 0,void 0,this.fdi))&&this.AZa.classList.add("ewa-fb-function-button-img");this.Peb&&this.AZa&&(I.DOMElementExtensions.setVisible(this.Peb,!Va),I.DOMElementExtensions.setVisible(this.AZa,Va))}}Object(B.a)(aa,"FormulaBarFunctionControl",A.a,[]);var za=a(304),qa=a(188),ta=a(48),Xa=a(9),oa=a(164),ha=a(153),Za=a(12);const Fa=Y.a.Yw()?1:2;class La{constructor(Va){this.mCa=this.wqa=this.gDa=this.s_c=this.r_c=this.q_c=null;
this.eyc=this.RHd=this.o6=!1;this.SUe=this.Sng=0;this.lvb=Y.a.Yw()?16:0;this.RDe=0;this.Joc=Y.a.Yw()?24:oa.c;this.DDc=Db=>{this.Vgf();Db.Ga.rawEvent.preventDefault();return!0};this.ADc=Db=>{this.RHd=!0;this.Sng=Db.clientPoint.y;document.body.classList.add(u.$bf);this.o6||(this.Q_a=0);this.gbb.ta("mousemove",this.B0f,!0);this.gbb.ta("touchmove",this.B0f);this.gbb.ta("mouseup",this.jVd);this.gbb.ta("touchend",this.jVd);this.gbb.ta("mouseleave",this.jVd);return!0};this.jVd=()=>{this.RHd=!1;this.Q_a=
Y.a.Yw()?this.o6?this.gDa.clientHeight-this.Joc:0:this.ku.clientHeight-this.Joc;document.body.classList.remove(u.$bf);this.gbb.TJ();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.ku.clientHeight} pixel`)};this.B0f=Db=>{this.RHd?(Db=Za.HelperMethods.Ipc(Db).y,Db=this.zrf(this.Q_a+Math.min(Db,this.$.domElement.clientHeight-75)-this.Sng),this.o6=Db>=this.lineHeight,I.DOMElementExtensions.toggleCssClass(this.ku,u.acf,this.o6),Db=this.Joc+
Math.round(Math.max(Db-Fa,0)),(Y.a.Yw()?this.gDa.clientHeight:this.ku.clientHeight)!==Db&&(this.ku.style.height=Db+"px",this.$.P_a())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.DT=Db=>{this.o6&&(this.USa=Math.round((Math.round(this.USa/this.lineHeight)+(0<Db.UKa?1:-1))*this.lineHeight));Db.Ga.preventDefault();return!1};this.JT=()=>{this.C_j();this.eyc&&(za.a.instance.Da(d.a.tN,document.body,this.JT),
za.a.instance.Da(d.a.BGa,document.body,this.JT),qa.a.instance.Da(d.a.Uh,document.body,this.JT),this.eyc=!1);return!1};this.yh=()=>{this.USa=0};this.jQ=Db=>{this.eyc||(za.a.instance.va(d.a.tN,document.body,this.JT),za.a.instance.va(d.a.BGa,document.body,this.JT),qa.a.instance.va(d.a.Uh,document.body,this.JT),this.eyc=!0);Db.preventDefault()};this.Qyj=Db=>{this.USa=this.SUe;Db.preventDefault()};this.$=Va;this.gbb=ha.a.instance.jRa(document.body.ownerDocument)}get lineHeight(){return this.lvb?this.lvb:
Xa.a.ykf}set lineHeight(Va){this.lvb=Va}get ku(){const {FormulaBar:Va}=a(1036);this.q_c||(this.q_c=Va.ppf(this.$));return this.q_c}get Koc(){this.r_c||(this.r_c=document.getElementById(v.a.tHb));return this.r_c}get V_(){this.s_c||(this.s_c=document.getElementById(v.a.tHb+"_"+v.a.IQc));return this.s_c}get USa(){return this.V_.scrollTop}set USa(Va){this.SUe=Va;this.V_.scrollTop!==Va&&(this.V_.scrollTop=Va)}get kci(){return 2*this.lineHeight-Fa}get Q_a(){return this.RDe}set Q_a(Va){this.RDe=Va}Vgf(){this.o6=
!this.o6;I.DOMElementExtensions.toggleCssClass(this.ku,u.acf,this.o6);this.o6&&!this.Q_a&&(this.Q_a=this.kci);this.ku.style.height=this.Joc+(this.o6?this.Q_a:0)+"px";this.wqa.setAttribute(v.a.Ly,this.o6?"Collapse the formula bar":"Expand the formula bar");this.$.P_a();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.o6?"expanded":"collapsed"}`)}GLh(Va){this.gDa=document.createElement("div");this.gDa.id=this.$.Af+v.a.Jud;this.gDa.className=u.N0h;this.wqa=
La.EHh(this.$.Af,Va);this.gDa.appendChild(this.wqa);this.mCa=La.aHh(this.$.Af);this.gDa.appendChild(this.mCa);return this.gDa}ARj(){za.a.instance.va(d.a.Lt,this.wqa,this.DDc);qa.a.instance.va(d.a.oj,this.wqa,this.DDc);za.a.instance.va(d.a.Lt,this.mCa,this.ADc);qa.a.instance.va(d.a.oj,this.mCa,this.ADc)}DRj(){za.a.instance.va(d.a.uI,this.Koc,this.DT);ta.a.addHandler(this.V_,d.a.scroll,this.jQ);Y.a.Yw()&&ta.a.addHandler(this.V_,d.a.scrollEnd,this.JT);ta.a.addHandler(this.V_,d.a.focus,this.Qyj);ba.h(this.$).ha.add_activeCellChanged(this.yh)}MBk(){void 0!==
this.wqa&&null!==this.wqa&&(za.a.instance.Da(d.a.Lt,this.wqa,this.DDc),qa.a.instance.Da(d.a.oj,this.wqa,this.DDc));void 0!==this.mCa&&null!==this.mCa&&(za.a.instance.Da(d.a.Lt,this.mCa,this.ADc),qa.a.instance.Da(d.a.oj,this.mCa,this.ADc));void 0!==this.Koc&&null!==this.Koc&&za.a.instance.Da(d.a.uI,this.Koc,this.DT);ba.h(this.$).ha.remove_activeCellChanged(this.yh)}C_j(){this.USa=Math.round(this.zrf(this.USa))}zrf(Va){return Math.round(Va/this.lineHeight)*this.lineHeight}static EHh(Va,Db){const Ca=
document.createElement("a");Ca.id=Va+v.a.nci;Ca.classList.add(u.C0h);I.DOMElementExtensions.ME(Ca,v.a.Kz);Ca.setAttribute(v.a.Ly,"Expand the formula bar");Db.Lia(W.a.YAh,12,12,Ca,Y.a.Yw()?20:null,Y.a.Yw()?20:null).classList.add(u.D0h);return Ca}static aHh(Va){const Db=document.createElement("div");Db.id=Va+v.a.lci;Db.className=u.B0h;return Db}}Object(B.a)(La,"FormulaBarResizeControl",null,[]);J=a(253);var xa=a(45),db=a(1055),bb=a(196),kb=a(115),Rb=a(47),zb=a(1221);class nc{}nc.disabled="disabled";
nc.mpk="stale";nc.PHj="presentationMode";Object(B.a)(nc,"NameBoxStateUpdateKey",null,[]);class Zb extends J.a{constructor(Va,Db){super(document.createElement("div"));this.Ri=null;this.jyk=()=>{this.$.Ha.VJb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.HVd=()=>{var Ca=this.gridView.ha;const cb=Ca.pa.cKb()?Ca.pa.JEb:Ca.pa.activeRange;Ca=cb.isSingle?Ca.pa.activeCell.toString():cb.jvi();this.IQ(Ca)};this.Hm=(Ca,cb)=>{this.Uka(Ca,cb);this.FYb(Ca,cb)};this.FYb=()=>{let Ca=zb.c(this.$,this.gridView);
db.c(Ca,!0)||(this.Ri&&(Ca=this.$.nf.getItemByName(this.Ri))&&Ca.deactivate(),this.IQ(this.gridView.ha.pa.activeCell.toString()))};this.eSb=(Ca,cb)=>{var hb,ya;if((Ca=cb.na)&&(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")||(null===(hb=cb.pD)||void 0===hb?void 0:hb.name)!==(null===(ya=cb.na)||void 0===ya?void 0:ya.name))){hb=Ca.usedRange;2===Ca.type&&(hb=bb.a(Ca));ya=this.gridView.ha.pa.Fk;var Pa=this.gridView.inRangePicker||this.gridView.Fm,wb=
!1;2===Ca.type&&ya&&!Pa&&(ya=this.gridView.ha.pa.activeRange,wb=Ca.sheetName===this.$.sa.na.name&&!!ya&&ya.top===hb.top&&ya.left===hb.left&&ya.bottom===hb.bottom&&ya.right===hb.right);hb=xa.v(hb,this.$),hb.NamedObjectName=Ca.name,hb.SheetName=Ca.sheetName,this.gridView.Tk(hb,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,cb.disableAutoFocusOnGrid);cb=db.a(Ca.name);this.IQ(cb.name,cb.fullName)}};this.zq=()=>{const Ca=zb.b(this.gridView);null!=Ca&&this.IQ(Ca.name)};
this.w1f=(Ca,cb)=>{this.HVd(Ca,cb)};this.uHa=()=>{this.UEb(!0)};this.tHa=()=>{this.UEb(!1)};this.xB=()=>{this.UEb(!this.$.isEditMode)};this.HT=(Ca,cb)=>{this.UEb(cb.fV?!0:!this.$.isEditMode)};this.onKeyDown=Ca=>Ca.Ga.keyCode===b.a.JKa?(this.gridView.focus(),!0):!1;this.Uka=()=>{this.rje({[nc.mpk]:!0})};this.$=Va;this.gridView=ba.h(Va);this.gph(Db)&&(this.IQ(this.gridView.ha.pa.activeCell.toString()),this.UEb(Rb.a(this.$).Gt()||!this.$.isEditMode),this.Kl(),m.KeyInputManager.instance.va(d.a.Hf,this.domElement,
this.onKeyDown.bind(this)))}dispose(){this.$&&(this.$.Le.C4d(this.uHa.bind(this)),this.$.Le.B4d(this.tHa.bind(this)),this.$.ea.N7(this.xB.bind(this)),kb.a(this.$).bJc(this.w1f.bind(this)),kb.a(this.$).o4d(this.zq.bind(this)),Rb.a(this.$).Jj.$ua(this.HT.bind(this)),this.$.nf&&(this.$.nf.vk(this.eSb.bind(this)),this.$.nf.gJc(this.FYb.bind(this)),this.$.nf.gJc(this.shg.bind(this)),this.$.nf.yda(this.Uka.bind(this)),this.$.nf.Yua(this.Uka.bind(this)),this.$.nf.Zua(this.Uka.bind(this)),this.$.nf.tWb(this.Uka.bind(this))),
this.$.sa&&this.$.sa.vk(this.Hm.bind(this)));if(this.gridView){const Va=this.gridView.ha;Va.zda(this.FYb.bind(this));Va.O7(this.HVd.bind(this));Va.Ua.xQ(this.zq.bind(this))}super.dispose()}XDk(Va){this.rje({[nc.PHj]:Va})}gph(Va){const Db=document.getElementById(this.$.Af+v.a.zkf);void 0!==Db&&null!==Db&&Va.removeChild(Db);appChrome.renderNameBoxUI(this.domElement,this.jyk.bind(this));Va.insertBefore(this.domElement,Va.firstChild);return!0}Kl(){this.$.Le.jcd(this.uHa.bind(this));this.$.Le.icd(this.tHa.bind(this));
this.$.ea.Z3(this.xB.bind(this));const Va=this.gridView.ha;this.$.nf.Vj(this.eSb.bind(this));this.$.sa.Vj(this.Hm.bind(this));Va.woa(this.FYb.bind(this));Va.b4(this.HVd.bind(this));Va.Ua.uJ(this.zq.bind(this));kb.a(this.$).Wbd(this.zq.bind(this));kb.a(this.$).kcc(this.w1f.bind(this));Rb.a(this.$).Jj.voa(this.HT.bind(this));this.$.nf.ncc(this.FYb.bind(this));this.$.nf.ncc(this.shg.bind(this));this.$.nf.a4(this.Uka.bind(this));this.$.nf.toa(this.Uka.bind(this));this.$.nf.uoa(this.Uka.bind(this));this.$.nf.W7a(this.Uka.bind(this))}IQ(Va,
Db=""){this.Ri=""!==Db?Db:this.Ri;appChrome.setNamedObjectOrActiveCellRange(Db,Va)}UEb(Va){this.rje({[nc.disabled]:Va})}shg(Va,Db){zb.a(this.$,!0);this.Uka(Va,Db)}rje(Va){appChrome.updateNameBoxState(Va)}}Object(B.a)(Zb,"NameBox",J.a,[2]);var Sa=a(133),Na=a(155);const Ea=u.vYf+" "+u.SV,Aa=u.sWe+" "+u.SV;class Ka extends A.a{constructor(Va=null,Db,Ca,cb){super();this.OBb=this.bSb=this.PBb=this.cSb=this.YA=this.vB=null;this.bN=this.Pxc=!1;this.nig=()=>{this.gridView.dP.jr(this.hk);this.gridView.dP.Wr(this.Yi);
this.Pxc=!0};this.hk=()=>{this.nGg(!0)};this.Yi=()=>{this.nGg(!1)};this.P4f=ya=>this.iDc(!0,`OkCancelEditControl.OnOkClick: ${ya.Te}`,Za.HelperMethods.Rv(ya));this.Q4f=ya=>this.iDc(!0,`OkCancelEditControl.OnOkKeyDown: ${ya.Te}`);this.NZf=ya=>this.iDc(!1,`OkCancelEditControl.OnCancelClick: ${ya.Te}`,Za.HelperMethods.Rv(ya));this.QZf=ya=>this.iDc(!1,`OkCancelEditControl.OnCancelKeyDown: ${ya.Te}`);this.JK=()=>{this.cwk(!this.$.isEditMode)};this.onPointerDown=()=>{this.gridView.De&&(this.gridView.lm.Ja.TM=
!0);return!1};const {FormulaBar:hb}=a(1036);this.$=Ca;this.gridView=ba.h(Ca);this.bN=Y.a.bN();cb?(this.cSb=cb.iUa(W.a.RXe,16),this.PBb=cb.iUa(W.a.tPh,16),Y.a.Yw()||(this.bSb=cb.iUa(W.a.oxh,16),this.OBb=cb.iUa(W.a.uPh,16),this.cSb.style.display="none",this.PBb.style.display="none")):(this.cSb=S.createClusteredImageFromClusterWithImageClass(16,16,ia.a.l3h,Ba.a.rk(1),null,null,!0,Db.ia(1041)),this.PBb=S.createClusteredImageFromClusterWithImageClass(16,16,ia.a.n3h,Ba.a.rk(1),null,null,!0,Db.ia(1042)));
Y.a.Yw()?(this.vB=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Af+hb.UCc),this.YA=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Af+hb.Jfc)):(this.kUd=Va.hec(hb.UCc,hb.UCc,Ea,"",""),this.vB=this.kUd.domElement,this.Hgd=Va.hec(hb.Jfc,hb.Jfc,Aa,"",""),this.YA=this.Hgd.domElement);this.vB.appendChild(this.cSb);this.YA.appendChild(this.PBb);Y.a.Yw()?da.EwaSettings.isChangeGateEnabled("OfficeVSO:8486552_FormulaBarFluentCellEdit")?requestAnimationFrame(()=>{this.vB&&this.YA&&
(this.vB.classList.add(u.VR),this.YA.classList.add(u.VR),I.DOMElementExtensions.toggleCssClass(this.vB,u.JCa,!this.$.isEditMode),I.DOMElementExtensions.toggleCssClass(this.YA,u.JCa,!this.$.isEditMode))}):(this.vB.classList.add(u.VR),this.YA.classList.add(u.VR),I.DOMElementExtensions.toggleCssClass(this.vB,u.JCa,!this.$.isEditMode),I.DOMElementExtensions.toggleCssClass(this.YA,u.JCa,!this.$.isEditMode)):(this.vB.appendChild(this.bSb),this.YA.appendChild(this.OBb));this.gridView.cellTextEditBox.jr(this.hk);
this.gridView.cellTextEditBox.Wr(this.Yi);Y.a.Yw()&&Ca.ea.aM(this.JK);P.a.instance.va(d.a.click,this.vB,this.P4f);m.KeyInputManager.instance.va(d.a.Hf,this.vB,this.Q4f);ka.a.instance.va(d.a.yg,this.vB,this.onPointerDown);P.a.instance.va(d.a.click,this.YA,this.NZf);m.KeyInputManager.instance.va(d.a.Hf,this.YA,this.QZf);ka.a.instance.va(d.a.yg,this.YA,this.onPointerDown);this.bN&&this.gridView.udh(this.nig)}dispose(){this.gridView&&this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.$q(this.hk),
this.gridView.cellTextEditBox.Zq(this.Yi));this.gridView&&this.bN&&(this.gridView.HUj(this.nig),this.Pxc&&(this.gridView.dP.$q(this.hk),this.gridView.dP.Zq(this.Yi),this.Pxc=!1));this.vB&&(P.a.instance.Da(d.a.click,this.vB,this.P4f),m.KeyInputManager.instance.Da(d.a.Hf,this.vB,this.Q4f),ka.a.instance.Da(d.a.yg,this.vB,this.onPointerDown),this.vB=null);this.YA&&(P.a.instance.Da(d.a.click,this.YA,this.NZf),m.KeyInputManager.instance.Da(d.a.Hf,this.YA,this.QZf),ka.a.instance.Da(d.a.yg,this.YA,this.onPointerDown),
this.YA=null);Y.a.Yw()||(n.a.Sa(this.kUd),this.kUd=null,n.a.Sa(this.Hgd),this.Hgd=null);Y.a.Yw()&&this.$&&this.$.ea.UK(this.JK);Y.a.Yw()||(I.DOMElementExtensions.Lj(this.OBb),this.OBb=null,I.DOMElementExtensions.Lj(this.bSb),this.bSb=null);super.dispose()}cwk(Va){Object(Na.b)(()=>{this.vB&&this.YA&&(I.DOMElementExtensions.toggleCssClass(this.vB,u.JCa,Va),I.DOMElementExtensions.toggleCssClass(this.YA,u.JCa,Va))},this.$.qa)}iDc(Va,Db,Ca=null){const cb=this.gridView.lm;if(Ca){const hb=this.gridView.ov?
"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let ya;ya=[Object(Sa.a)(this.gridView.cellTextEditBox.Ja.TJa)];Sa.b(this.$).pL(Ca.rawEvent,hb,ya)}this.Pxc&&this.gridView.dP.OJ?this.gridView.dP.endEdit(Va,Db,0):cb.endEdit(Va,Db,0);this.gridView.focus();return!0}nGg(Va){if(Y.a.Yw())da.EwaSettings.isChangeGateEnabled("OfficeVSO:8486552_FormulaBarFluentCellEdit")?requestAnimationFrame(()=>{var Db,Ca,cb,hb;Va?(null===(Db=this.vB)||void 0===Db?void 0:Db.classList.remove(u.VR),null===
(Ca=this.YA)||void 0===Ca?void 0:Ca.classList.remove(u.VR)):(null===(cb=this.vB)||void 0===cb?void 0:cb.classList.add(u.VR),null===(hb=this.YA)||void 0===hb?void 0:hb.classList.add(u.VR))}):Va?(this.vB.classList.remove(u.VR),this.YA.classList.remove(u.VR)):(this.vB.classList.add(u.VR),this.YA.classList.add(u.VR));else{const Db=Va?"block":"none",Ca=Va?"none":"block";this.cSb.style.display=Db;this.PBb.style.display=Db;this.bSb.style.display=Ca;this.OBb.style.display=Ca}}}Object(B.a)(Ka,"OkCancelEditControl",
A.a,[]);var nb=a(306),Qb=a(318),jb=a(75),qb=a(201),ab=a(13),xb=a(268),Tb=a(210),Cc=a(305),lb=a(149),Ya=a(161),Hb=a(52),Lb=a(401),qc=a(285),mc=a(169);class Ta extends h.a{constructor(Va,Db=null){super(ba.h(Va));this.wFg=null;this.xSd=["nameBox","nameBoxData"];this.bue=this.cB=this.clearContentNotifier=this.nameBox=this.ku=null;this.wle=!1;this.V_=null;this.Vvc=this.VUe=this.atc=!1;this.hk=()=>{this.wle=!1;this.W$d();this.Vvc&&this.bRc(!this.TGf)};this.Yi=()=>{this.W$d();this.Vvc&&this.bRc(!1)};this.bRc=
Ca=>{Ta.Yqa&&this.VUe!==Ca&&(Y.a.Yw()?Object(Na.b)(()=>{Ta.Yqa&&(I.DOMElementExtensions.toggleCssClass(Ta.Yqa,u.JCa,Ca),I.DOMElementExtensions.toggleCssClass(Ta.Yqa,u.VR,Ca))},this.$.qa):I.DOMElementExtensions.toggleCssClass(Ta.Yqa,u.VR,Ca),this.VUe=Ca)};this.j8f=()=>{this.De||this.Ja.disabled||this.startEdit(!0,!1,null)};this.Ir=()=>{this.jJa()};this.HT=(Ca,cb)=>{this.jJa();Ta.Yqa&&(cb.fV?Ta.Yqa.classList.add(u.VR):this.tcd())};this.$v=(Ca,cb)=>{Ca=this.grid;this.wle=!0;this.De?(this.aNb||(cb.vMb||
this.aR(null),this.raiseEvent(h.a.WBb,cb)),this.aNb||Ca.cellTextEditBox.Ja.isCursorAttached()&&!this.Ja.isCursorAttached()&&Ca.cellTextEditBox.Ja.clearCursorFormatLocation()):Ca.De&&this.jJa()};this.Mh=(Ca,cb)=>{(Ca=this.grid.ha.pa.activeCell)&&(cb=this.grid.SG(cb.wg.hash))&&Ca.Zf(cb.Mg)&&this.jJa()};this.qWd=(Ca,cb)=>{-185374993===cb.command&&this.jJa()};this.vh=()=>{this.jJa();T.TaskExtensions.Ca(L.a(this.$.ja),()=>{this.yug()},this.qa,11)};this.gka=()=>{this.yug();Hb.a.instance.gla(v.a.Tqa,["formulaButton",
"textbox","textboxData"]);Hb.a.instance.R7(v.a.Tqa,["formulaButton","textbox","textboxData"]);Hb.a.instance.Q7(v.a.Tqa,["formulaButton"])};this.onKeyDown=Ca=>{if(Ca.Ga.keyCode===b.a.bC){var cb=this.EDa();const hb=I.DOMElementExtensions.Xz(cb);cb=I.DOMElementExtensions.H5(cb);return I.DOMElementExtensions.M0a(Ca.Ga,hb,cb)}return!1};this.JK=()=>{this.tcd()};this.tLb=()=>{this.ku?(this.nameBox=new Zb(this.$,this.ku),this.eZj()):this.xmg()};Db||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");
this.bue=new La(Va);this.initialize(this.q$d(Va,Db));this.TSa.ARj();if(k.AFrameworkApplication.ra.Pa.Gh){const Ca=document.getElementById("AdditionalBarsRegion");Ca&&(Ca.style.height="")}this.vHd=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.uH=new nb.a(this.ku,1);this.HWi=da.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");this.chb=this.ZF&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:8026558_ParenthesesCoupling");
this.Fuc=new O(Va);this.Fuc.hec(v.a.lGg,v.a.lGg,v.a.$vk+" cui-TabRowRight",O.Rrh,O.Trh);this.xkf=new aa(this.Fuc,ab.a.instance,Va,Db);this.Bkj=new Ka(Y.a.Yw()?void 0:this.Fuc,ab.a.instance,Va,Db);this.wFg=qc.b(()=>{this.Wck()},1,this.$.qa,"FormulaBar.setTextBoxForActiveItem",!0);Va.sa.Vj(this.vh);Db=this.grid;Db.cellTextEditBox.jr(this.hk);Db.cellTextEditBox.Wr(this.Yi);Db.cellTextEditBox.ZOa(this.$v);Db.tJ(this.Ir);Db.ya.ot(this.Mh);Db.ya.nga(this.Mh);Db.xcc(this.qWd);Rb.a(Va).Jj.voa(this.HT);Va.ea.aM(this.JK);
kb.a(Va).Wbd(this.Ir);da.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&Va.ja.Ne(313,Ca=>{this.clearContentNotifier=Ca;this.clearContentNotifier.bcc(this.$v)});m.KeyInputManager.instance.va(d.a.Hf,this.ng,this.onKeyDown);Db=this.Ja.style;xb.c(Db,Va.isChromeRtl,"0px");Db.textAlign=this.yEf?"right":"left";this.isVisible=!1;this.vHd&&(this.Ja.isVisible=!1);z.a(this.$).aPa(this.gka);this.$.ea.UEa&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),
this.gka(null,null));this.jJa();this.tcd();this.Ja.fyg=!0;this.zOi();y.a(Va).sn(this);this.Ja.vMe(this.j8f);this.aNb=!1;this.cB=new Q(this.$,this);Y.a.xId()&&this.PMi();this.Ja.NZ(()=>{Hb.a.instance.Q7(v.a.Tqa,["textbox","textboxData"]);this.toggleEditingEvents(!1)});this.Vvc=da.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(Va){this.De?this.Ja.setPlainText(Va):super.text=Va}get De(){return super.De}set De(Va){super.De=Va;this.toggleEditingEvents(Va)}get TGf(){return this.huc||
0>=this.text.length}get b0b(){return!0}get formattedText(){return this.Ja.getFormattedText()}set formattedText(Va){this.Ja.setFormattedText(Va)}get zMb(){return this.De}get isVisible(){return I.DOMElementExtensions.isVisible(this.ku)}set isVisible(Va){this.vHd?I.DOMElementExtensions.setVisible(this.ku,Va):(I.DOMElementExtensions.setVisible(this.ku,Va),this.Ja.isVisible=Va)}get ng(){return this.ku}get nl(){return this.isVisible}get Qh(){return K.a.Iud}get TSa(){return this.bue}Wl(Va,Db){Va=!1;Db||
(Va=this.vbi());return Va}dispose(){const Va=this.$;if(Va){Va.sa.vk(this.vh);var Db=this.grid;Db.cellTextEditBox.$q(this.hk);Db.cellTextEditBox.Zq(this.Yi);Db.cellTextEditBox.B_a(this.$v);Db.VK(this.Ir);Db.ya.ys(this.Mh);Db.ya.A_a(this.Mh);Rb.a(this.$).Jj.$ua(this.HT);Va.ea.UK(this.JK);kb.a(Va).o4d(this.Ir);Db=z.a(this.$);m.KeyInputManager.instance.Da(d.a.Hf,this.ng,this.onKeyDown);this.TSa.MBk();Db&&Db.D_a(this.gka);y.a(Va).rD(this);da.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
(this.clearContentNotifier&&this.clearContentNotifier.qWb(this.$v),Va.ja.T4(313))}this.Ja&&this.Ja.zkg(this.j8f);this.nameBox&&this.$.ea.cq(this.tLb);n.a.Wf([this.uH,this.xkf,this.Bkj,this.Fuc,this.nameBox]);n.a.Sa(this.cB);this.ku&&(I.DOMElementExtensions.kM(this.ku),this.ku.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.ku=null;super.dispose()}endEdit(Va,Db,Ca,cb=null){this.Ja.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:Va,
["Caller"]:Db});this.LJa(!1);if(this.De){var hb=null;cb&&(hb=this.$.shortcutKeyManager.Qv(cb));var ya=this.grid.kf;this.De=!1;this.yJ(!0);this.CWa()&&this.grid.Uy&&this.grid.Uy.VSa&&this.grid.Uy.Pnb(v.a.$Kb);if(Va){var Pa=new C.a(this.grid.ha.pa.activeCell,ya.text,ya.text,!1,this.grid.$.sa.na);this.Heg(Pa);null!==Pa&&(ya.text=Pa.newValue)}else this.Ja.setPlainText(this.text);Pa=new x.a(this.grid.ha.pa.activeCell,ya.text,Va,cb);this.H0d(Pa);ya.endEdit(Va,`${Db}->FormulaBar.EndEdit`,Ca,cb);this.XKf(hb)||
ya.Ja.focus();this.Ja.T_b("FormulaBar.EndEdit")}else this.Ja.T_b("FormulaBar.EndEdit",{["IsEditing"]:"false"})}bia(Va,Db,Ca,cb=!0,hb=!0){super.bia(Va,Db,Ca,cb,hb);this.grid.kf.bia(Va,Db,Ca,cb,hb)}Acg(Va){const Db=this.grid.kf,Ca=this.Ja.selection;Ca.length&&Db.bia(Ca.index,Ca.length,Va,!1,!1)}Bm(Va){return I.DOMElementExtensions.Ek(this.ku,Va)}Ko(){k.AFrameworkApplication.ra.zj.cr(this.Qh)}Rp(){}ZKg(Va){this.nameBox.XDk(Va);this.xkf.ZDk(Va)}Pje(){if(this.V_){var Va=Object(mc.g)(this.text);this.atc!==
Va&&(this.bwg(Va),this.atc=Va)}}xUd(){this.Ja.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Va=this.grid.kf;Va.De&&this.De&&(Va.formattedText=this.formattedText,Va.setCaretPosition(this.Ja.caretPosition))}mTb(Va){this.Ja.disabled||(this.grid.cellTextEditBox.Ja.TM=!0,this.De||this.startEdit(!1,!0,Va),this.npa())}ikb(){this.YT&&(this.AR=this.Ja.caretPosition,this.VY=this.Ja.Mda.length);this.ZF&&this.aR(null);this.gva();this.BIg()}kua(Va){var Db=this.$.shortcutKeyManager.Qv(Va);
const Ca=this.aNb;1872288872===Db||125627505===Db||267796030===Db?super.kua(Va):Ca?jb.g(Va):this.De&&this.grid.kf.De&&(Db=this.grid.kf,Db.formattedText=this.formattedText,Db.setCaretPosition(this.Ja.caretPosition),this.DSc(),this.chb&&0===this.Ja.selection.length&&this.aR(null,null),this.HWi&&this.inRangePicker&&this.kee(),super.kua(Va))}Lg(Va,Db){this.De&&super.Lg(Va,Db)}dx(Va,Db){this.De&&super.dx(Va,Db)}PMi(){const Va=this.grid.Pe(void 0);Va?(this.atc=Va.cy||Object(mc.g)(Va.text),this.bwg(this.atc)):
c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}bwg(Va){I.DOMElementExtensions.toggleCssClass(this.V_,u.K0h,Va)}q$d(Va,Db){this.ku=Ta.ppf(Va);this.ku.classList.add(u.G0h);this.ku.classList.add(u.bcf);Y.a.Yw()&&this.ku.classList.add(u.E0h);const Ca=this.TSa.GLh(Db);Db=Ta.pmd();Ca.appendChild(Db);Ta.Yqa=Ta.JHh(Va.Af);const cb=Ta.DHh(),hb=Ta.pJh(Va.Af),ya=Ta.oJh(Va.Af),Pa=Ta.bGh(Va.Af);ya.tabIndex=-1;Pa.tabIndex=-1;hb.appendChild(Pa);hb.appendChild(ya);
hb.appendChild(Ta.Yqa);cb.appendChild(hb);cb.appendChild(Ca);Va=Ta.TIh(Va.Af);this.ku.appendChild(Va);this.ku.appendChild(cb);const wb=new Cc.a(Db,!0,!1);this.V_=Db;this.TSa.lineHeight=wb.aoi();wb.NZ(()=>{Lb.c(wb.Ii,l.a.ariaLabel,"formula bar")});wb.NZ(()=>{this.TSa.DRj()});wb.isVisible=!1;return wb}LYa(Va){this.CHc(Va);super.LYa(Va);lb.b(this.$).Gg(F.a.pci,{["Location"]:"canvas"});f.a.gk&&window.focus();const Db=this.$.shortcutKeyManager.Qv(Va);this.cIj(Va,Db);this.Ja.disabled||this.De||this.startEdit(!0,
!1,Va);let Ca;Ca={};Ca.wasEditing=this.De;Ca.formulaBar=!0;let cb=this.jn(Va,Db);!cb&&qb.d(Db,this.lgb,!0)&&(cb=this.XKf(Db)?!0:this.grid.ha.jn(Va,Db,Ca));cb||Ya.a(this.$).xPd(Va,0,7)}startEdit(Va,Db,Ca){const cb=this.grid;if(!this.De||!cb.De){this.Ja.T_b("FormulaBar.StartEdit");this.Ja.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:Va,["IsOnMouseDown"]:Db});lb.b(cb.$).Gg(F.a.oci,{["Location"]:"canvas"});this.De=this.aNb=!0;cb.sv&&cb.sv.mMc(this);cb.cellTextEditBox.yJ(!1);cb.cellTextEditBox.$5d();
this.xvg(!1);var hb=()=>{var ya=cb.$.sa.na;const Pa=cb.Pe(null);ya=new w.a(Pa,ya,void 0,void 0,void 0,this.Byd(Pa));this.I0d(ya);this.PYb(cb.cellTextEditBox.Ja.RJ);window.setTimeout(()=>{if(this.De&&cb.De){cb.De&&cb.cellTextEditBox.Ja.detachCursorFormat();if(!this.aR(null)){const Ib=cb.cellTextEditBox.formattedText;var wb=this.Ja.caretPosition;const pb=Ib.Text.length;wb=this.Ja.text.length!==pb?pb:wb;this.formattedText=Ib;this.Ja.caretPosition=wb}this.aNb=!1;this.Ja.clearHistory()}else this.De=!1},
0);cb.cellTextEditBox.yng()};if(cb.De)cb.UH=1,hb();else if(this.Ja.TM=!0,T.TaskExtensions.Ca(cb.startEdit(!1,1,Ca,!1,void 0,Db,1),ya=>{ya.result?(cb.De||(this.Ja.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.De&&cb.De?(cb.cellTextEditBox.Ja.TM=!0,ya=cb.Pe(null),this.Ja.Ujf(Number.NaN,this.Byd(ya)),Va&&this.Ja.setCaretPositionToEnd(),hb()):this.De=!1):this.De=!1},this.qa,
11),this.Ja.TM=!1,Db=cb.Pe(null),null===Db||void 0===Db?0:Db.YId)this.Ja.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=Za.HelperMethods.jDg(this.text)}}nCd(Va){super.nCd(Va);this.Vvc&&this.grid&&this.grid.De&&2===Va&&this.bRc(!this.TGf)}yh(Va,Db){super.yh(Va,Db);this.W$d()}Z0a(Va){da.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Va}`);
super.Z0a(Va)}W$d(){const Va=this.grid;Va.De&&2===Va.UH||this.jJa()}dk(){var Va=this.grid;this.De&&Va.De&&(Va=Va.kf,Va.text=this.text,Va.setCaretPosition(this.Ja.caretPosition),this.inRangePicker&&this.Ja.focus())}jJa(){this.wFg()}Wck(){if(this.Ja){var Va=this.grid;this.Ja.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.De,["TextBox.Initialized"]:this.Ja.initialized,["Grid.IsEditing"]:Va.De});if(!this.De){var Db=Rb.a(this.$).Gt();this.ku.disabled=Db||!this.$.isEditMode;
var Ca=(Db=this.$.e_===Va)&&1===Va.ha.Yh;this.Ja.initialized&&(this.Ja.disabled=this.ku.disabled||Db&&!Ca);Db=new Tb.a(this.Ja.style);var cb=!1;if(Ca)if(Va.De)this.Ja.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),Ca=Va.cellTextEditBox.text;else{cb=Va.Pe(null);Ca=new X.a(this.$.sa);if(!cb||!Ca.hOb(cb.range,Va))return;Va=Ca.Vk;Ca=cb.tk;var hb=cb.formulaBarText;const ya=cb.text;this.Ja.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",
{["sheetProtection.IsLocked"]:Va,["activeCell.IsHidden"]:Ca,["activeCell.FormulaBarText"]:!!hb,["activeCell.Text"]:!!ya});Ca=Va&&Ca?"":hb||ya;cb=cb.Bzg}else Ca="",hb=Va.ha.Ua.gf,hb=(null===hb||void 0===hb?0:hb.floatingObject)?hb.floatingObject.Ue:null,64===Va.ha.Yh&&hb&&hb.IsShapeFormulaPresent&&((Va=(Va=hb.ShapeText)?Va.substring(Va.indexOf("\nFormula:")+9,Va.indexOf(";FormulaVal:")):null)?(this.Ja.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),
Ca="="+Va):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.xvg(cb);this.Fub=this.vfc();Db.wA.direction=this.j6?t.a.rtl:t.a.zXa;Db.wA.textAlign=this.j6?t.a.right:t.a.left;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentStylingEnabled",!1)&&I.DOMElementExtensions.toggleCssClass(this.V_,u.I0h,this.j6);Db.BZ();this.text=Ca}}}yug(){var Va=this.$.e_;if(this.vHd){const Db=
!!this.grid.dP&&this.grid.dP.OJ;this.isVisible=Va=!!Va&&this.$.Kud&&!this.$.ea.ff.inEmbedView;Db||(this.Ja.isVisible=Va)}else this.isVisible=!!Va&&this.$.Kud&&!this.$.ea.ff.inEmbedView;this.$.nK(v.a.Cde);this.$.GN()}xvg(Va){I.DOMElementExtensions.toggleCssClass(this.Ja.domElement,u.H0h,Va)}EDa(){return this.ku.querySelectorAll(I.DOMElementExtensions.jE+", div[tabindex]")}Xz(){return I.DOMElementExtensions.Xz(this.EDa())}vbi(){const Va=this.Xz();return Va?(I.DOMElementExtensions.setFocus(Va),!0):!1}cIj(Va,
Db){Db=-287251124===Db||-1925065947===Db||1764140053===Db;Qb.a.Ygb()&&Db&&Va.preventDefault()}tcd(){this.bRc(!this.$.isEditMode);Y.a.Yw()&&Object(Na.b)(()=>{this.V_&&I.DOMElementExtensions.toggleCssClass(this.V_,u.JCa,!this.$.isEditMode)},this.$.qa)}PYb(Va){this.Ja.RJ=Va}toggleEditingEvents(Va){this.Ja.toggleEditingEvents(Va)}zOi(){this.ku?da.EwaSettings.isChangeGateEnabled("OfficeVSO:8232668_InitNameBoxEagerly")?this.tLb():da.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?
this.$.ea.ei?this.tLb():this.$.ea.zm(this.tLb):this.$.ea.zm(this.tLb):this.xmg()}eZj(){Hb.a.instance.gla(v.a.Tqa,this.xSd);Hb.a.instance.R7(v.a.Tqa,this.xSd);Hb.a.instance.Q7(v.a.Tqa,this.xSd)}xmg(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}XKf(Va){return!this.wle&&(125627505===Va||706199415===Va)}get text(){return super.text}static ppf(Va){return document.getElementById(Va.Af+v.a.zab)}static DHh(){const Va=document.createElement("div");
Va.className=u.A0h;Va.classList.add(u.SV);return Va}static pJh(Va){const Db=document.createElement("div");Db.id=Va+Ta.Akj;Db.className=u.zkj;Db.classList.add(u.SV);return Db}static pmd(){const Va=Qb.a.Ygb(),Db=document.createElement(Va?"div":"textarea");Db.className=u.J0h;Y.a.sZi()&&Db.classList.add(u.M0h);Db.classList.add(u.L0h);Db.classList.add(u.tij);!Y.a.Yw()||window.CSS&&window.CSS.supports&&window.CSS.supports("scrollbar-gutter","stable")||Db.classList.add(u.aij);Va?Db.id=v.a.tHb:(Db.cols=20,
Db.rows=2);return Db}static JHh(Va){const Db=document.createElement("div");Db.id=Va+v.a.sHb;Db.className=u.Ukf;I.DOMElementExtensions.ME(Db,v.a.Kz);Db.setAttribute(v.a.Ly,"insert function");Db.tabIndex=0;Db.classList.add(u.SV);return Db}static oJh(Va){const Db=document.createElement("div");Db.id=Va+Ta.UCc;Db.className=u.vYf;I.DOMElementExtensions.ME(Db,v.a.Kz);Db.setAttribute(v.a.Ly,"commit edit");Db.tabIndex=0;Db.classList.add(u.SV);return Db}static bGh(Va){const Db=document.createElement("div");
Db.id=Va+Ta.Jfc;Db.className=u.sWe;I.DOMElementExtensions.ME(Db,v.a.Kz);Db.setAttribute(v.a.Ly,"cancel edit");Db.tabIndex=0;Db.classList.add(u.SV);return Db}static TIh(Va){const Db=document.createElement("div");Db.id=Va+v.a.zkf;Db.className=u.F0h;return Db}}Ta.Akj="okCancelButtonContainer";Ta.UCc="okboxButton";Ta.Jfc="cancelboxButton";Ta.Yqa=null;Object(B.a)(Ta,"FormulaBar",h.a,[54])},1055:function(B,A,a){a.d(A,"b",function(){return n});a.d(A,"a",function(){return l});a.d(A,"c",function(){return f});
var c=a(74);B=a(0);class b{constructor(){this.yob=!1;this.fullName=this.name=this.scope=null}}Object(B.a)(b,"NamedObjectDetails",null,[]);var k=a(196),m=a(138),d=a(22);const n=(h,t,u,v=!1)=>{for(let y=0,C=h.count;y<C;y++){const x=h.getItem(y),w=2===x.type?k.a(x):x.usedRange,z=v&&2===x.type?x.usedRange:null;if((w.equals(t)||t.equals(z))&&x.sheetName===u)return x}return null},l=h=>{const t=new b;t.fullName=h;h=m.c(h.split(RegExp("[!']")),u=>!d.a.equals(u,"",!0));2===h.length?(t.yob=!0,t.scope=h[0],
t.name=h[1]):(t.yob=!1,t.scope="",t.name=h[0]);return t},f=(h,t=!1)=>h&&c.h(h)?(h.activate({disableAutoFocusOnGrid:t,scenario:"namedObject"}),!0):!1},1221:function(B,A,a){a.d(A,"d",function(){return l});a.d(A,"c",function(){return f});a.d(A,"b",function(){return h});a.d(A,"a",function(){return t});var c=a(22),b=a(1055),k=a(1222),m=a(140),d=a(141),n=a(599);const l=v=>255<v.length||!u(v)||c.a.LG(v,"_xl")?!1:!0,f=(v,y)=>{var C=y.ha;y=C.pa.Fk;C=C.pa.activeRange;return v.sa.na&&y?b.b(v.nf,C,v.sa.na.name):
null},h=v=>{let y=null;v=v.ha.Ua;v.isFloatingObjectSelected&&(y=v.gf.floatingObject);return y},t=(v,y=!0)=>{const C=k.a.getInstance(v),x=C.fsi();x&&!v.nf.uo(x)&&n.a(d.a.Tzh,[m.a.WVf],!0,!0,!1,!1,null);C.stop(y)},u=v=>{if(!v.length)return!1;for(let y=0;y<v.length;y++){const C=v.charAt(y),x=v.charCodeAt(y);if(!y){if("\\"!==C&&"_"!==C&&!c.a.isLetter(x))return!1}else if("_"!==C&&"."!==C&&!c.a.THf(x)&&!c.a.isNumeral(x))return!1}return!0}},1222:function(B,A,a){B=a(0);var c=a(15);class b{constructor(k){this.start=
m=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):(this.kk.start(),this.inProgress=!0,this.NWf=m)};this.stop=(m=!0)=>{this.inProgress&&(this.kk.stop(),m&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.kk.gg}}`),this.inProgress=!1,this.NWf=void 0)};this.fsi=()=>this.NWf;this.kk=k.Ve.wj("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=k=>{void 0===b.instance&&
(b.instance=new b(k));return b.instance};A.a=b;Object(B.a)(b,"NameBoxTelemetry",null,[])},1418:function(B,A,a){a.r(A);B={};a.r(B);a.d(B,"FormulaBarCommandHandler",function(){return bb});A=a(531);var c=a(1),b=a(11),k=a(0),m=a(793),d=a(68),n=a(41),l=a(203);a(200);var f=a(15),h=a(163),t=a(537),u=a(74),v=a(148),y=a(132),C=a(9),x=a(23),w=a(45),z=a(1055),F=a(118),J=a(312),R;(function(Na){Na[Na.NONE=0]="NONE";Na[Na.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";Na[Na.PRINT_AREA=2]="PRINT_AREA";Na[Na.DISCONTINUOUS_RANGES=
3]="DISCONTINUOUS_RANGES";Na[Na.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";Na[Na.INVALID_NAME=5]="INVALID_NAME";Na[Na.EMPTY_RANGE=6]="EMPTY_RANGE";Na[Na.GENERIC_ERROR=7]="GENERIC_ERROR"})(R||(R={}));Object(k.b)("NameBoxInvalidOperation",R);var I=a(138),O=a(33),Y=a(22),K=a(13),L=a(140),X=a(141),T=a(599),ba=a(111);class Q extends J.a{constructor(Na,Ea){super(Na,Ea);this.Qt()}get Cf(){return"NameBoxErrorDialog"}Qt(){super.Qt();const Na=this.error.Caption,Ea=this.Hmi(this.error),Aa=this.Gmi(this.error);
this.Ye=0;this.joa(Aa);this.qn(Na,Ea,2,this.z2)}Hmi(Na){return Y.a.equals(Na.MessageIdName,Q.gSc,!0)?String.format(Na.Description):Y.a.equals(Na.MessageIdName,Q.GLb,!0)?"":Na.Description}Gmi(Na){const Ea=[];Y.a.equals(Na.MessageIdName,Q.GLb,!0)&&(Na=String.format(K.a.instance.ia(2253)),Ea.push(...I.f(Na.split("-"),Aa=>Aa.trim())));return Ea}static WP(Na,Ea=null){if(Na.MessageIdName===Q.GLb)f.ULS.sendTraceTag(528053385,0,50,Na.Caption);else{let Aa=Na.Caption;Na.MessageIdName===Q.gSc&&(Aa=`Unsupported Operation: ${R[Ea]}`);
Na=new ba.a;Na.da("errorCaption",Aa);T.a(X.a.y7h,[L.a.WVf],!0,!0,!1,!1,Na)}}static Fg(Na){switch(Na){case 3:case 1:case 2:return O.a.Fg(1,0,2254,2255,0,-1280789630,Q.gSc);case 5:case 4:return O.a.Fg(1,0,2252,2253,0,875859818,Q.GLb);case 7:return O.a.Fg(1,0,0,1,0,424201999,Q.GLb);case 6:return O.a.Fg(1,0,2256,2257,0,-1280789630,Q.gSc);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}Q.gSc="NameBoxUnsupportedOperation";Q.GLb="NameBoxInvalidName";
Object(k.a)(Q,"NameBoxErrorDialog",J.a,[]);class P{constructor(){this.type=this.location=this.bottomRight=this.topLeft=this.sheetName=this.name=this.key=null}}Object(k.a)(P,"NamedObjectOption",null,[]);const ka=(Na,Ea,Aa,Ka,nb,Qb,jb)=>{const qb=new P;qb.key=Na;qb.name=Ea;qb.sheetName=Aa;qb.topLeft=Ka;qb.bottomRight=nb;qb.location=Qb;a:switch(jb){case 2:Na="Table";break a;case 3:Na=Y.a.LFb(Ea,"Print_Area")?"Print Area":"Named Range";break a;default:Na="Unknown"}qb.type=Na;return qb};var ia=a(1221),
Ba=a(19),va=a(149),W=a(1222);class S{constructor(Na,Ea){this.printArea="Print_Area";this.d2j="R";this.dAh="C";this.Agj="Value";this.$=Na;this.gridView=Ba.h(this.$);this.EGa=Ea;this.Bgj=W.a.getInstance(this.$)}NFj(){var Na=this.$.nf.items,Ea=this.$.na.name;const Aa={};for(var Ka of Na){Na=z.a(Ka.name);var nb=Na.yob;if(u.h(Ka)&&(!nb||Y.a.equals(Na.scope,Ea,!1))){var Qb=Na.name in Aa;if(!Qb||Qb&&nb)Aa[Na.name]={["namedObjectDetails"]:Na,["namedObjectItem"]:Ka}}}Ea=[];for(const jb in Aa)Na=Aa[jb],Ka=
Na.namedObjectItem,Na=Na.namedObjectDetails,nb=`${Ka.sheetName}!${Ka.usedRange.topLeft.Zz(!1)}:${Ka.usedRange.bottomRight.Zz(!1)}`,Qb=Ka.type,Ea.push(ka(Ka.name,Na.name,Ka.sheetName,Ka.usedRange.topLeft.Zz(!1),Ka.usedRange.bottomRight.Zz(!1),nb,Qb));Ea.sort((jb,qb)=>jb.name.localeCompare(qb.name));this.EGa.OFj(Ea);ia.a(this.$,!1);this.wmg(Ea.length)}eFi(Na){Na=z.a(Na[this.Agj].toString());const Ea=Na.name,Aa=Na.scope.length?Na.scope:null;var Ka=this.gxh(Na);this.J5j(Na)||(this.x9i(Na),0!==Ka?(this.EGa.$7e(this.$,
Ka),this.Eog()):ia.d(Ea)?(Ka=w.r(Ba.h(this.$).ha.pa.selectedRanges,this.$),this.EGa.UIh(this.$,Ea,Ka,Aa,S.Pkj,S.Okj),this.Bgj.start(Na.name)):(this.EGa.$7e(this.$,5),this.Eog()))}kud(){this.EGa.kud()}J5j(Na){const Ea=Na.fullName,Aa=Na.name,Ka=Na.scope;let nb,Qb,jb=!1;!({sheetName:nb,range:Qb}=w.gb(Ea,this.$.sa)).returnValue||!Qb.$C&&c.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?Y.a.equals(Aa,this.d2j,!0)?(this.K5j(Ka),this.H_a(2)):Y.a.equals(Aa,this.dAh,
!0)?(this.B5j(Ka),this.H_a(2)):this.$.nf.uo(Ea)?(this.Qrg(Ea),this.H_a(Na.yob?1:0)):this.$.nf.uo(Aa)?(this.Qrg(Aa),this.H_a(0)):jb=!0:(this.D5j(nb,Qb),this.H_a(3));return!jb}D5j(Na,Ea){Na=Na||this.$.sa.na.name;var Aa=z.b(this.$.nf,Ea,Na);z.c(Aa)||(Aa=w.v(Ea,this.$),Aa.SheetName=Na,Ba.h(this.$).Tk(Aa,Ea.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.gridView.focus())}K5j(Na=null){const Ea=this.gridView.ha.pa.activeCell;this.aXe(Na)&&(Na=new x.Range(Ea.top,0,Ea.bottom,C.a.hi,
!0,!1),this.gridView.ha.ZK([Na],0,Na,0))}B5j(Na=null){const Ea=this.gridView.ha.pa.activeCell;this.aXe(Na)&&(Na=new x.Range(0,Ea.left,C.a.oi,Ea.right,!0,!1),this.gridView.ha.ZK([Na],0,Na,0))}aXe(Na){return Na?(Na=this.$.sa.getItemByName(Na),(null===Na||void 0===Na?0:Na.visible)?(Na.activate({scenario:"namedObject"}),!0):!1):!0}Qrg(Na){Na=this.$.nf.getItemByName(Na);z.c(Na);this.gridView.focus()}gxh(Na){return this.wWi()?1:Y.a.equals(Na.name,this.printArea,!0)?2:this.YRh()?3:this.wKi(Na)?4:this.CVi()?
6:0}Eog(){var Na=ia.b(this.gridView);null!=Na?this.EGa.shd("",Na.name):(Na=ia.c(this.$,this.gridView))?this.EGa.shd(Na.name,Na.name):this.EGa.shd("",this.gridView.ha.pa.activeCell.toString())}wWi(){return!!this.gridView.ha.Ua.activeFloatingObjectControlId}YRh(){return 1<this.gridView.ha.pa.selectedRanges.length}wKi(Na){return Na.yob&&!this.$.OP(Na.scope)}CVi(){return this.gridView.Je.zFa(this.gridView.ha.pa.selectedRanges[0])}static Pkj(Na){return Ea=>{O.a.Ai(Ea.Errors)&&(Q.WP(Ea.Errors[0]),new Q(Na,
Ea.Errors[0]),W.a.getInstance(Na).stop(!1))}}static Okj(Na){return Ea=>{(Ea=F.a.Lh(Ea.data))&&0<Ea.length?(Q.WP(Ea[0]),new Q(Na,Ea[0])):(Q.WP(Q.Fg(7)),new Q(Na,Q.Fg(7)));W.a.getInstance(Na).stop(!1)}}x9i(Na){const Ea=null!=ia.c(this.$,this.gridView);Na.yob?this.H_a(Ea?7:6):this.H_a(Ea?5:4)}H_a(Na){va.b(this.$).Gg(v.a.trk,{type:Na.toString()},null,!0)}wmg(Na){va.b(this.$).Gg(v.a.dbg,{dOk:Na},null,!0)}}Object(k.a)(S,"NameBoxCommandHandler",null,[]);var da=a(395),aa=a(204),za=a(59);const qa=(Na,Ea,Aa,
Ka,nb,Qb,jb,qb,ab,xb,Tb=null)=>{Tb=Na.Oa(9,Tb);Tb.name=Ea;Tb.selectedRanges=Aa;Tb.sheetName=Ka;Tb.formula=nb;Tb.comment=Qb;return za.h(Na,"AddDefinedName",Tb,jb,qb,ab,xb,0)};var ta=a(252),Xa=a(152),oa;(function(Na){Na[Na.EMPTY_RANGE=0]="EMPTY_RANGE";Na[Na.RANGE_CREATED=1]="RANGE_CREATED"})(oa||(oa={}));Object(k.b)("NameBoxStatusCalloutType",oa);class ha{tSh(){this.b4e();appChrome.renderNameBoxStatusCallout(ha.uPc,oa.EMPTY_RANGE)}zSh(Na,Ea){this.b4e();const Aa=Object(w.D)(Ea.Ranges[0]);appChrome.renderNameBoxStatusCallout(ha.uPc,
oa.RANGE_CREATED,Na,Ea.SheetName,`${Aa.topLeft.toString()}:${Aa.bottomRight.toString()}`)}b4e(){null==ha.uPc&&(ha.uPc=document.createElement("div"))}OFj(Na){Xa.c()&&appChrome.populateNameBoxMenu(Na)}UIh(Na,Ea,Aa,Ka,nb,Qb){const jb=()=>this.zSh(Ea,Aa);da.a(Na.userOperationManager,(qb,ab,xb)=>qa(Na.oa.ua,Ea,Aa,Ka,"","",ta.b(qb,nb(Na),c.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")?jb:void 0),ta.a(ab,Qb(Na)),xb,Na),qb=>new aa.a(1020,0,qb),null)}$7e(Na,Ea){Q.WP(Q.Fg(Ea),
Ea);c.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")&&6===Ea?this.tSh():new Q(Na,Q.Fg(Ea))}kud(){appChrome.updateNameBoxState({["focus"]:!0})}shd(Na,Ea){appChrome.setNamedObjectOrActiveCellRange(Na,Ea)}}ha.uPc=null;Object(k.a)(ha,"NamedObjectsService",null,[266]);var Za=a(201),Fa=a(64),La=a(6),xa=a(8),db=a(146);let bb=class{constructor(Na,Ea){this.$=Na;this.gridView=Ba.h(this.$);this.Wa=Ea;this.wSd=new S(Na,new ha)}Uf(){return!1}executeCommand(Na,Ea,Aa){Ea=Ea.command;
Na=null;switch(Ea){case 1726517890:this.wSd.eFi(Aa);break;case 2045896573:Aa=y.a(this.$);(null===Aa||void 0===Aa?0:Aa.TSa)?Aa.TSa.Vgf():f.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.wSd.kud();break;case -1790328692:Aa=y.a(this.$);Ea=!this.$.KMb;Aa.isVisible=Ea;Aa.Ja.isVisible=Ea;this.$.KMb=Ea;this.$.Tj();try{h.a.UB(La.a.QGf,Ea.toString(),t.AFrame.Zwa)}catch(Ka){f.ULS.sendTraceTag(509216780,
0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${Ka.message}`)}break;default:Na=Za.a(Ea)}return Na||Fa.Task.Ra(!0)}Kf(Na,Ea,Aa){Na=!1;switch(Ea.command){case 1726517890:Na=!!Aa;break;case -1003645154:case 2045896573:Na=!0;break;case -1790328692:Na=c.EwaSettings.isChangeGateEnabled("OfficeVSO:8235335_DisplaySettings")}return Na}Yf(Na,Ea){if("PopulateNameBoxMenu"!==Ea)return!1;Na=this.$.Ve.Sf("UserAction","PopulateNameBoxMenuTimer");this.wSd.NFj();Na.stop();return!0}wmg(Na){Na=
{["NamedObjectsCount"]:Na};va.b(this.$).Gg(v.a.dbg,Na,null,!0)}};bb=Object(l.__decorate)([Object(db.d)(xa.Lb),Object(l.__param)(0,Object(xa.nb)()),Object(l.__param)(1,Object(xa.Bd)())],bb);Object(k.a)(bb,"FormulaBarCommandHandler",null,[165]);var kb=a(94);class Rb extends m.a{constructor(Na){super(Na)}lj(){n.TaskExtensions.Ca(xa.Bd.$e()?Object(kb.d)(db.a.resolve(xa.Bd,{Aa:this.$a})):d.GetServiceTaskFactory.create(this.$.ja,102,this.$.qa,this.$a),Na=>{this.Gi([new bb(this.$,Na.result)])},this.$.qa)}static ta(Na){m.a.Kk(280,
new Rb(Na))}}Object(k.a)(Rb,"FormulaBarCommandHandlerFactory",m.a,[]);l=a(299);var zb=a(1036),nc=a(52),Zb=a(796);class Sa extends l.a{constructor(Na){super();this.$=Na;this.Dg()}create(){nc.a.instance.zla(La.a.Tqa);const Na=d.GetServiceTaskFactory.vf(this.$.ja,388,387,this.$a);n.TaskExtensions.Ca(n.TaskExtensions.Dh([Na],this.qa),()=>{this.Df(Object(Zb.a)(this.$.ja,172,()=>new zb.FormulaBar(this.$,Na.result)))},this.$.qa,3)}}Object(k.a)(Sa,"FormulaBarFactory",l.a,[]);A.a.Rl('.ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-new-theme,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107c41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#f5f5f5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #d1d1d1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .okbox:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover{background-color:#f5f5f5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .okbox:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus{background-color:#e0e0e0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled{pointer-events:none;background-color:#fff !important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path{fill:#bdbdbd}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #d1d1d1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:4px}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie.no-scrollbar-gutter-support .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;scrollbar-gutter:stable;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:#808080;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within{outline:none;border:1px solid #d1d1d1;border-bottom-style:none}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:4px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:3px solid #107c41;clip-path:inset(calc(100% - 3px) 0 0)}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-disabled{border:1px solid #d1d1d1;border-radius:4px;background-color:#f5f5f5}.ewa-fb-fluent .cancelbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .okbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .functionbox.button-disabled.ewa-fb-disabled{background-color:#f5f5f5 !important}.ewa-root-ltr .ewa-fb-rtl .ewa-rteLine{padding-right:20px !important}.ewa-fb-fluent .ql-editor *::selection{background:#616161;color:#fff}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}');
(()=>{b.a.Na(Na=>{Na.ja.$c(186,new Sa(Na));c.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateFormulaBarCommandHandler")||Rb.ta(Na)})})();String(B);window.___1699049107605_closurehack=B}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/9a3aadc8d42067624bc6c9c1e2675b23/EwaTS.vrd.js.map