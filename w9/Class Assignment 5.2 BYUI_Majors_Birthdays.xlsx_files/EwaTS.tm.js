'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1015:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);class c{}c.qpd="stid";c.opd="iid";c.ppd="DynamicImageProvider.aspx";c.isEwaJsSplitEnabled="IsEwaJsSplitEnabled";Object(B.a)(c,"WebServiceConstants",null,[])},1046:function(B,A,a){a.d(A,"a",function(){return h});B=a(0);var c=a(15);A=a(832);var b=a(536),k=a(5),m=a(16),d=a(116);class n{constructor(t,u,v,y){this.origin=t;this.data=u;this.source=v;this.Ga=
void 0===y?null:y}}Object(B.a)(n,"MessageEventArgs",null,[]);class l{constructor(t,u){this.BOa=null;this.CZd=v=>this.kna?this.kna(new n(v.origin,v.data,v.source,v.Ga)):!1;this.e$c=t;this.sh=u;this.kna=null}get Hwa(){return this.e$c.value}get UQ(){return this.sh.value}AAb(t,u){this.kna=t;this.BOa=this.CZd;this.Hwa.addHandler(m.a.message,this.BOa,u)}LEb(){this.kna=null;this.Hwa.removeHandler(m.a.message,this.BOa)}ofb(t,u){const v=new d.a(0,1,1,()=>{t(u)},7);this.UQ.Li(v)}oGd(t,u){const v=new d.a(0,
1,1,()=>{t(u)},7);this.UQ.Li(v)}static get instance(){return l.cTa()}static cTa(){return new l(new b.a(()=>k.AFrameworkApplication.Hwa),new b.a(()=>k.AFrameworkApplication.jl))}}Object(B.a)(l,"MessageEventHandler",null,[227]);var f=a(889);class h extends A.a{constructor(t,u,v){super(t,u,(void 0===v?null:v)||l.instance,h.AFd)}static AFd(){f.a.sendTraceTag=h.h9d;f.a.debugAssertTag=h.xnd}static h9d(t,u,v,...y){c.ULS.sendTraceTag.apply(null,[t,204,h.umd(u),v].concat(y))}static xnd(){}static umd(t){switch(t){case 0:return 200;
case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}h.cHc="wdPreviousSession";h.ojc="wdUserSession";Object(B.a)(h,"CommonCrossDocumentMessenger",A.a,[])},1053:function(B,A,a){a.r(A);a.d(A,"RenderingFidelityTracker",function(){return h});B=a(203);A=a(0);var c=a(15),b=a(112),k=a(82),m=a(12),d=a(299);class n extends d.a{constructor(t){super();this.$=t;this.Dg()}create(){const {RenderingFidelityTracker:t}=a(1053);let u=this.$.ja.Qa(462);u||(u=this.$.ja.$c(462,new t));
this.Df(u)}}Object(A.a)(n,"RenderingFidelityTrackerFactory",d.a,[]);var l=a(52);d=a(8);var f=a(146);let h=class extends k.a{constructor(){super();this.ofj=3E4;this.hqb={};this.Xke={};this.fTe={};b.Health.instance.addQosPillar("Fidelity")}static ta(t){t.ja.$c(463,new n(t))}OOe(t,u,v,y){if(!(l.a.instance.xba(new Date)<this.ofj)){var C=m.HelperMethods.zK(()=>{var x=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(u),w=Object.keys(x),z=this.fTe[t];for(var F=0;F<w.length;F++){var J=w[F];
this.Xke[J]||(null===z||void 0===z?0:z[J])&&this.hqb[J]&&(this.hqb[J]-=z[J])}this.fTe[t]=x;for(F=0;F<w.length;F++)if(z=w[F],!this.Xke[z])if(J=x[z],this.hqb[z]&&(J+=this.hqb[z]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(z,J)){this.Xke[z]=!0;x=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(z);w=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(z);F=!("ThickBorder"===z||"MediumBorder"===z);x&&w&&F&&b.Health.instance.recordQosError(x,
[w],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+z+", isHC:"+v+", scaleFactor:"+y+"}");break}else this.hqb[z]=J});1<C&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${C}`)}}};h=Object(B.__decorate)([Object(f.d)(d.yd)],h);Object(A.a)(h,"RenderingFidelityTracker",k.a,[386,2])},1188:function(B,A,a){a.d(A,"a",function(){return b});B=a(0);var c=a(15);class b{static eRa(k){k=
new Date(k);return c.ULS.U_e([b.lah(k.getUTCFullYear()),"-",b.J7a(k.getUTCMonth()+1),"-",b.J7a(k.getUTCDate()),"T",b.J7a(k.getUTCHours()),":",b.J7a(k.getUTCMinutes()),":",b.J7a(k.getUTCSeconds()),".",b.SKe(k.getUTCMilliseconds()),"Z"])}static lah(k){return 1E3>k?"0"+b.SKe(k):k.toString()}static SKe(k){return 100>k?"0"+b.J7a(k):k.toString()}static J7a(k){return 10>k?"0"+k:k.toString()}}Object(B.a)(b,"UlsUtils",null,[])},1383:function(B,A,a){function c(wa){var sa=wa.replace(/-.*/g,()=>"");sa=jd.get(sa);
return null!==sa&&void 0!==sa?sa:wa.startsWith("ooux")?"ooux":"other"}function b(wa){switch(!0){case wa.nB:return Kc.MergedCell;case wa.EP:return Kc.TQg;case wa.cy:return Kc.Formula;case wa.hasAutoFilter:return Kc.AutoFilter;case wa.tia:return Kc.PivotFilter;case !!wa.pGc:return Kc.PivotTable;case wa.Mra:return Kc.Comment;case wa.veb:return Kc.Sparkline;case wa.reb:return Kc.InCellImage;case wa.hasRichText:return Kc.NSg;default:return""}}a.r(A);var k={};a.r(k);a.d(k,"PageLoadEngagementInfo",function(){return Xd});
var m={};a.r(m);var d={};a.r(d);a.d(d,"JsSelfProfilerManager",function(){return mb});var n={};a.r(n);a.d(n,"InteractivityTrackerService",function(){return Pd});var l={};a.r(l);a.d(l,"GridActionTelemetryManager",function(){return td});var f={};a.r(f);a.d(f,"DocumentVisibilityObserver",function(){return Oe});var h={};a.r(h);a.d(h,"ValidationTelemetryManager",function(){return Ud});var t=a(0),u=a(15);class v{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=
this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(t.a)(v,"BrowserInfo",
null,[]);class y{constructor(){this.Version=this.Name=null}}Object(t.a)(y,"PluginInfo",null,[]);var C=a(5),x=a(35);class w{static WOd(){if(C.AFrameworkApplication.fa.la("LogBrowserInfoIsEnabled")){var wa=w.zdi();try{const sa=JSON.stringify(wa);u.ULS.sendTraceTag(6903563,102,50,sa)}catch(sa){u.ULS.sendTraceTag(6903564,102,15,sa.message)}}else u.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static Rti(){const wa=window.navigator.plugins;if(!wa||!wa.length)return null;
const sa=[];for(let fc=0;fc<wa.length;fc++){const yd=wa[fc].name,Sd=wa[fc].version;Array.add(sa,Object.assign(new y,{Name:yd,Version:Sd}))}return sa}static zdi(){const wa=new v,sa=new Sys.StringBuilder;w.Zx(fc=>{wa.DocElemClientHeight=fc},()=>document.documentElement.clientHeight,sa);w.Zx(fc=>{wa.DocElemClientWidth=fc},()=>document.documentElement.clientWidth,sa);w.Zx(fc=>{wa.DocElemOffsetHeight=fc},()=>document.documentElement.offsetHeight,sa);w.Zx(fc=>{wa.DocElemOffsetWidth=fc},()=>document.documentElement.offsetWidth,
sa);w.Zx(fc=>{wa.ScreenAvailHeight=fc},()=>window.screen.availHeight,sa);w.Zx(fc=>{wa.ScreenAvailWidth=fc},()=>window.screen.availWidth,sa);w.Zx(fc=>{wa.ScreenWidth=fc},()=>window.screen.width,sa);w.Zx(fc=>{wa.ScreenHeight=fc},()=>window.screen.height,sa);w.Zx(fc=>{wa.ScreenLogicalXdpi=fc},()=>window.screen.logicalXDPI,sa);w.Zx(fc=>{wa.ScreenLogicalYdpi=fc},()=>window.screen.logicalYDPI,sa);w.Zx(fc=>{wa.ScreenDeviceXdpi=fc},()=>window.screen.deviceXDPI,sa);w.Zx(fc=>{wa.ScreenDeviceYdpi=fc},()=>window.screen.deviceYDPI,
sa);w.Zx(fc=>{wa.WinInnerHeight=fc},()=>window.self.innerHeight,sa);w.Zx(fc=>{wa.WinInnerWidth=fc},()=>window.self.innerWidth,sa);w.Zx(fc=>{wa.WinOuterHeight=fc},()=>window.self.outerHeight,sa);w.Zx(fc=>{wa.WinOuterWidth=fc},()=>window.self.outerWidth,sa);w.Zx(fc=>{wa.WinOrientation=fc},()=>window.self.orientation,sa);w.Zx(fc=>{wa.WinDevicePixelRatio=fc},()=>window.self.devicePixelRatio,sa);w.Zx(fc=>{wa.SupportsTouch=fc},()=>x.a.aQc,sa);w.Zx(fc=>{wa.NavAppName=fc},()=>window.navigator.appName,sa);
w.Zx(fc=>{wa.NavAppVersion=fc},()=>window.navigator.appVersion,sa);w.Zx(fc=>{wa.NavLanguage=fc},()=>window.navigator.browserLanguage||window.navigator.language,sa);w.Zx(fc=>{wa.NavUserAgent=fc},()=>window.navigator.userAgent,sa);w.Zx(fc=>{wa.NavPlatform=fc},()=>window.navigator.platform,sa);w.Zx(fc=>{wa.NavPlugins=fc},w.Rti,sa);w.Zx(fc=>{wa.CalculatedDevicePixelRatio=fc},()=>w.devicePixelRatio,sa);wa.Error=sa.toString();return wa}static get devicePixelRatio(){const wa=window.devicePixelRatio;return isNaN(wa)?
window.screen.deviceXDPI/window.screen.logicalXDPI:wa}static Zx(wa,sa,fc){try{const yd=sa();wa(yd)}catch(yd){fc.isEmpty()||fc.append(" | "),fc.append(yd.message||"null")}}}Object(t.a)(w,"BrowserInfoLogger",null,[]);var z=a(262);class F{get name(){return"Common.App.BrowserInfoLogger"}dl(){}init(){w.WOd()}dispose(){}static main(){z.a.instance.Ul(new F)}}Object(t.a)(F,"BrowserInfoLoggerPackage",null,[4,5]);var J=a(77);class R{constructor(wa){this.cWc=wa}JFf(wa){if(!this.cWc)return!0;wa=J.a.vyd(wa);if(!wa)return!1;
wa=wa.toLowerCase();for(let sa=0;sa<this.cWc.length;sa++)if(wa.endsWith(this.cWc[sa]))return!0;return!1}}Object(t.a)(R,"DomainAllowListManager",null,[]);class I{constructor(wa,sa){this.l_=null;this.k9c=wa;this.url=sa}get Zje(){return J.a.O1(this.url)}get xv(){return this.k9c}Gge(){const wa={},sa=this.xv;wa.a=this.Zje;wa.b=this.round(sa.navigationStart);wa.c=this.round(sa.unloadEventStart);wa.d=this.round(sa.unloadEventEnd);wa.e=this.round(sa.redirectStart);wa.f=this.round(sa.redirectEnd);wa.g=this.round(sa.fetchStart);
wa.h=this.round(sa.domainLookupStart);wa.i=this.round(sa.domainLookupEnd);wa.j=this.round(sa.connectStart);wa.k=this.round(sa.connectEnd);wa.l=void 0!==sa.secureConnectionStart&&null!==sa.secureConnectionStart?this.round(sa.secureConnectionStart):0;wa.m=this.round(sa.requestStart);wa.n=this.round(sa.responseStart);wa.o=this.round(sa.responseEnd);wa.q=this.round(sa.domInteractive);wa.r=this.round(sa.domContentLoadedEventStart);wa.s=this.round(sa.domContentLoadedEventEnd);wa.t=this.round(sa.domComplete);
wa.u=this.round(sa.loadEventStart);wa.v=this.round(sa.loadEventEnd);wa.w=this.l_;return wa}round(wa){return Math.round(1E3*wa)/1E3}}Object(t.a)(I,"PerformanceTimingEntry",null,[]);const O=(wa,sa)=>{var fc,yd;const Sd={};let Ie=null;switch(wa){case 0:Ie="ResourceTiming";wa=sa.a;null!=wa&&(Sd.Url=wa);wa=sa.b;null!=wa&&(Sd.InitiatorType=wa);wa=null==sa.c?null:sa.c.toString();null!=wa&&(Sd.RedirectStart=wa);wa=null==sa.d?null:sa.d.toString();null!=wa&&(Sd.RedirectEnd=wa);wa=null==sa.e?null:sa.e.toString();
null!=wa&&(Sd.FetchStart=wa);wa=null==sa.f?null:sa.f.toString();null!=wa&&(Sd.DomainLookupStart=wa);wa=null==sa.g?null:sa.g.toString();null!=wa&&(Sd.DomainLookupEnd=wa);wa=null==sa.h?null:sa.h.toString();null!=wa&&(Sd.ConnectStart=wa);wa=null==sa.i?null:sa.i.toString();null!=wa&&(Sd.ConnectEnd=wa);wa=null==sa.j?null:sa.j.toString();null!=wa&&(Sd.SecureConnectionStart=wa);wa=null==sa.k?null:sa.k.toString();null!=wa&&(Sd.RequestStart=wa);wa=null==sa.l?null:sa.l.toString();null!=wa&&(Sd.ResponseStart=
wa);wa=null==sa.m?null:sa.m.toString();null!=wa&&(Sd.ResponseEnd=wa);wa=sa.n;null!=wa&&(Sd.CustomText=wa);wa=null==sa.o?null:sa.o.toString();null!=wa&&(Sd.DecodedBodySize=wa);wa=null==sa.p?null:sa.p.toString();null!=wa&&(Sd.EncodedBodySize=wa);wa=null==sa.q?null:sa.q.toString();null!=wa&&(Sd.TransferSize=wa);sa=null!==(yd=null===(fc=sa.r)||void 0===fc?void 0:fc.toString())&&void 0!==yd?yd:null;null!=sa&&(Sd.responseStatus=sa);break;case 1:Ie="PerformanceTiming",fc=sa.a,null!=fc&&(Sd.Url=fc),fc=null==
sa.b?null:sa.b.toString(),null!=fc&&(Sd.NavigationStart=fc),fc=null==sa.c?null:sa.c.toString(),null!=fc&&(Sd.UnloadEventStart=fc),fc=null==sa.d?null:sa.d.toString(),null!=fc&&(Sd.UnloadEventEnd=fc),fc=null==sa.e?null:sa.e.toString(),null!=fc&&(Sd.RedirectStart=fc),fc=null==sa.f?null:sa.f.toString(),null!=fc&&(Sd.RedirectEnd=fc),fc=null==sa.g?null:sa.g.toString(),null!=fc&&(Sd.FetchStart=fc),fc=null==sa.h?null:sa.h.toString(),null!=fc&&(Sd.DomainLookupStart=fc),fc=null==sa.i?null:sa.i.toString(),null!=
fc&&(Sd.DomainLookupEnd=fc),fc=null==sa.j?null:sa.j.toString(),null!=fc&&(Sd.ConnectStart=fc),fc=null==sa.k?null:sa.k.toString(),null!=fc&&(Sd.ConnectEnd=fc),fc=null==sa.l?null:sa.l.toString(),null!=fc&&(Sd.SecureConnectionStart=fc),fc=null==sa.m?null:sa.m.toString(),null!=fc&&(Sd.RequestStart=fc),fc=null==sa.n?null:sa.n.toString(),null!=fc&&(Sd.ResponseStart=fc),fc=null==sa.o?null:sa.o.toString(),null!=fc&&(Sd.ResponseEnd=fc),fc=null==sa.p?null:sa.p.toString(),null!=fc&&(Sd.DomLoading=fc),fc=null==
sa.q?null:sa.q.toString(),null!=fc&&(Sd.DomInteractive=fc),fc=null==sa.r?null:sa.r.toString(),null!=fc&&(Sd.DomContentLoadedEventStart=fc),fc=null==sa.s?null:sa.s.toString(),null!=fc&&(Sd.DomContentLoadedEventEnd=fc),fc=null==sa.t?null:sa.t.toString(),null!=fc&&(Sd.DomComplete=fc),fc=null==sa.u?null:sa.u.toString(),null!=fc&&(Sd.LoadEventStart=fc),fc=null==sa.v?null:sa.v.toString(),null!=fc&&(Sd.LoadEventEnd=fc),sa=sa.w,null!=sa&&(Sd.CustomText=sa)}Sd.Table=Ie;return Sys.Serialization.JavaScriptSerializer.serialize(Sd)};
var Y=a(51),K=a(166),L=a(449);class X{constructor(wa,sa,fc){this.HD=wa;this.Yje=this;this.QZg=(void 0===sa?null:sa)||(()=>window.location.href);this.eZc=new R(void 0===fc?null:fc)}HQ(){if(X.p4(window.performance))try{const Sd=this.QZg();if(X.B7g.exec(Sd)&&this.eZc.JFf(Sd)){var wa=new I(window.performance.timing,Sd);L.a.instance.AOj(wa.xv.fetchStart);L.a.instance.BOj(wa.xv.navigationStart);L.a.instance.RQb(Y.a.zci,"connectStart","requestStart");L.a.instance.RQb(Y.a.Hci,"requestStart","responseStart");
L.a.instance.RQb(Y.a.Kci,"responseStart","responseEnd");this.Yje.Fi(1,wa.Gge());this.HD.Uo(Y.a.hDa,wa.xv.fetchStart);this.HD.Uo(Y.a.Eci,wa.xv.domainLookupStart);this.HD.Uo(Y.a.Dci,wa.xv.domainLookupEnd);this.HD.Uo(Y.a.Bci,wa.xv.connectStart);this.HD.Uo(Y.a.Lci,wa.xv.secureConnectionStart);this.HD.Uo(Y.a.Aci,wa.xv.connectEnd);this.HD.Uo(Y.a.Ici,wa.xv.requestStart);this.HD.Uo(Y.a.vHb,wa.xv.responseStart);this.HD.Uo(Y.a.Fci,wa.xv.responseEnd-wa.xv.responseStart);this.HD.Uo(Y.a.Jci,wa.xv.responseStart-
wa.xv.requestStart);var sa=0,fc=0,yd=0;(()=>{let Ie=this.Kzk(Sd);({transferSize:sa,aqd:fc,Bnd:yd}=Ie);return Ie})().returnValue&&(this.HD.Uo(Y.a.Mci,sa),this.HD.Uo(Y.a.Cci,yd),this.HD.Uo(Y.a.Gci,fc));this.HD.Uo(Y.a.Sud,wa.xv.navigationStart)}}catch(Sd){u.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Sd)}}Kzk(wa){let sa,fc,yd;yd=fc=sa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:sa,
aqd:fc,Bnd:yd};wa=window.performance.getEntriesByName(wa,"navigation");if(void 0===wa||null===wa||1!==wa.length)return{returnValue:!1,transferSize:sa,aqd:fc,Bnd:yd};wa=wa[0];var Sd=wa.transferSize;void 0!==sa&&null!==sa&&(sa=Sd);Sd=wa.decodedBodySize;void 0!==Sd&&null!==Sd&&(yd=Sd);wa=wa.encodedBodySize;void 0!==wa&&null!==wa&&(fc=wa);return{returnValue:!0,transferSize:sa,aqd:fc,Bnd:yd}}Fi(wa,sa){u.ULS.sendTraceTag(4551815,306,50,O(wa,sa))}static get instance(){return X.Ka||(X.Ka=new X(K.a.instance,
null,C.AFrameworkApplication.fa.la("PerfTimingLoggerFilterDomainsIsEnabled")?C.AFrameworkApplication.fa.Pw("ResourceLoggerDomainAllowList"):null))}static p4(wa){return!(void 0===wa||null===wa)&&!(void 0===wa.timing||null===wa.timing)}}X.Ka=null;X.B7g=RegExp("^https?://.*","i");Object(t.a)(X,"PerformanceTimingLogger",null,[442]);var T=a(109),ba=a(137);class Q{constructor(wa,sa){this.l_=null;this.k9c=wa;this.behavior=sa;this.url=this.xv.name}get Zje(){return 2===this.behavior?this.url:J.a.O1(this.url)}get xv(){return this.k9c}Gge(){const wa=
{},sa=this.xv;wa.a=this.Zje;wa.b=sa.initiatorType;wa.c=this.round(sa.redirectStart);wa.d=this.round(sa.redirectEnd);wa.e=this.round(sa.fetchStart);wa.f=this.round(sa.domainLookupStart);wa.g=this.round(sa.domainLookupEnd);wa.h=this.round(sa.connectStart);wa.i=this.round(sa.connectEnd);wa.j=void 0!==sa.secureConnectionStart&&null!==sa.secureConnectionStart?this.round(sa.secureConnectionStart):0;wa.k=this.round(sa.requestStart);wa.l=this.round(sa.responseStart);wa.m=this.round(sa.responseEnd);wa.o=this.round(Q.vra(sa,
"decodedBodySize"));wa.p=this.round(Q.vra(sa,"encodedBodySize"));wa.q=this.round(Q.vra(sa,"transferSize"));wa.n=this.l_;wa.r=Q.vra(sa,"responseStatus")||0;return wa}round(wa){return Math.round(1E3*wa)/1E3}static vra(wa,sa){return wa[sa]}}Object(t.a)(Q,"ResourceTimingEntry",null,[475]);var P=a(112),ka=a(194),ia=a(44),Ba=a(104);class va{constructor(wa,sa,fc){this.Koe=wa;this.N$b=void 0===sa?null:sa;this.Fxa={};this.zWg=void 0===fc?100:fc;this.voe=C.AFrameworkApplication&&C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",
!1)}Uyk(wa){var sa=wa.name.toLowerCase();const fc=J.a.uba(sa);this.bog(fc,sa)&&(fc in this.Fxa?u.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",fc):(sa={},sa.fetchstart=wa.fetchStart,sa.responseend=wa.responseEnd,sa.iscached=this.rLf(wa),sa.encodedsize=Q.vra(wa,"encodedBodySize"),sa.decodedsize=Q.vra(wa,"decodedBodySize"),this.Fxa[fc]=sa))}Vyk(wa){var sa=wa.name.toLowerCase();const fc=J.a.uba(sa);this.t0j(fc,sa)&&(fc in this.Fxa?u.ULS.sendTraceTag(508925201,
306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",fc):(sa={},sa.fetchstart=wa.fetchStart,sa.responseend=wa.responseEnd,sa.iscached=this.rLf(wa),sa.encodedsize=Q.vra(wa,"encodedBodySize"),sa.decodedsize=Q.vra(wa,"decodedBodySize"),sa.it=wa.initiatorType,sa.ress=wa.responseStart,sa.cs=wa.connectStart,sa.ce=wa.connectEnd,sa.dls=wa.domainLookupStart,sa.dle=wa.domainLookupEnd,sa.rs=wa.redirectStart,sa.re=wa.redirectEnd,sa.reqs=wa.requestStart,sa.scs=wa.secureConnectionStart,
this.Fxa[fc]=sa))}bog(wa,sa){if(this.Koe)return Array.contains(this.Koe,wa);if(this.N$b)for(wa=J.a.yP(sa),sa=0;sa<this.N$b.length;sa++)if(this.N$b[sa]&&wa.endsWith(this.N$b[sa]))return!0;return!1}t0j(wa,sa){return this.bog(wa,sa)?wa.endsWith(".js")||wa.endsWith(".css"):!1}rLf(wa){try{const sa=Q.vra(wa,"transferSize");if(void 0!==sa&&null!==sa)return!sa;u.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return wa.responseEnd-wa.fetchStart<
this.zWg}catch(sa){u.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",sa.message)}return!1}bPj(){if(Ba.a.$j(this.Fxa))u.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var wa=C.AFrameworkApplication.flightId?C.AFrameworkApplication.flightId.split(";"):[],sa=Object.assign({},{extendedProperties:ka.a.fu()});sa.extendedProperties.set("Flights",ia.c(wa));this.q$i(sa,this.Fxa,
P.Health.instance)}}Tvd(wa){let sa=0,fc=0,yd=0,Sd=0,Ie=0;const pf=this.Fxa;for(const hg in pf){var If=hg,bg=pf[hg];If.endsWith(".js")&&(bg=Object(ba.a)(Object,bg),bg.responseend<wa&&(sa+=1,fc+=bg.decodedsize,Sd+=bg.encodedsize,yd+=bg.iscached?0:bg.encodedsize,If=If.toLowerCase(),this.voe&&(C.AFrameworkApplication.fa.Ta("Slice1Name").toLowerCase().endsWith(If)?Ie|=1:If.endsWith(".common.js")||If.endsWith(".othercommon.js")||If.endsWith(".ext.js")?Ie|=2:If.endsWith("common50.min.js")&&(Ie|=4))))}wa=
{};wa.filesLoaded=sa;wa.decodedBytes=fc;wa.transferredBytes=yd;wa.encodedBytes=Sd;this.voe&&(wa.lazyChunksLoaded=Ie);return wa}q$i(wa,sa,fc){if(sa){var yd=0,Sd=0,Ie=0,pf=0,If=0,bg=0,hg=0,dg=0,pg=0,Ug=0,$g=0;for(const Zf in sa){var ih=sa[Zf];try{const gh=Object(ba.a)(Object,ih);if(!gh)continue;const Zg=gh.iscached?Boolean.parse(gh.iscached.toString()):!1,Sg=gh.fetchstart?this.parseFloat(gh.fetchstart.toString()):0,Ah=(gh.responseend?this.parseFloat(gh.responseend.toString()):0)-Sg,rh=gh.encodedsize?
this.parseFloat(gh.encodedsize.toString()):0,Oa=gh.decodedsize?this.parseFloat(gh.decodedsize.toString()):0;yd+=Ah;pf+=rh;hg+=Oa;Ug++;Zg?(Ie+=Ah,bg+=rh,pg+=Oa,$g++):(Sd+=Ah,If+=rh,dg+=Oa)}catch(gh){u.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",gh.message)}}wa.extendedProperties.set("StaticResources",ia.c(sa));wa.extendedProperties.set("TotalResourceDownloadLatency",yd.toString());wa.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
Sd.toString());wa.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Ie.toString());wa.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",pf.toString());wa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",If.toString());wa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",bg.toString());wa.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",hg.toString());wa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",dg.toString());
wa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",pg.toString());wa.extendedProperties.set("TotalNumberOfResourcesDownloaded",Ug.toString());wa.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",$g.toString());fc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);fc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",wa)}}parseFloat(wa){if(!wa)return 0;wa=parseFloat(wa);return isNaN(wa)?0:wa}}Object(t.a)(va,"AppStaticResourceManager",
null,[]);class W extends Sys.EventArgs{constructor(wa){super();this.entries=wa}}Object(t.a)(W,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var S=a(116);class da{constructor(wa,sa,fc,yd,Sd,Ie){fc=void 0===fc?null:fc;yd=void 0===yd?null:yd;Sd=void 0===Sd?100:Sd;Ie=void 0===Ie?!1:Ie;this.r2c=!1;this.ym=null;this.Tsb=0;this.Za=new T.a;this.pLa=null;this.UU=!1;this.tHe=0;this.sh=wa;this.Gre=0;this.Yje=this;this.eZc=new R(fc);this.Iz=sa;yd&&(this.pLa=new va(null,yd,Sd));this.dVg=Ie}get NTe(){try{return!(void 0===
this.Iz||null===this.Iz)&&!(void 0===this.Iz.getEntriesByType||null===this.Iz.getEntriesByType)}catch(wa){return u.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",wa),!1}}get cOh(){return this.Gre}get isActive(){return this.UU}get uge(){return this.tHe}Ddh(wa){this.Za.addHandler(da.Eqd,wa)}OUj(wa){this.Za.removeHandler(da.Eqd,wa)}dl(wa,sa){const fc=this.uge!==wa;this.tHe=wa;this.isActive&&this.sh&&fc&&(this.At(),this.Li());this.Gre=
sa}activate(){!this.isActive&&this.NTe&&(this.Li(),this.UU=!0)}deactivate(wa){this.isActive&&(this.At(),wa&&this.flush(),this.UU=!1)}flush(){if(this.isActive&&this.NTe)try{var wa=window.performance.getEntriesByType("resource");0<wa.length-this.Tsb&&u.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",wa.length-this.Tsb);const sa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);
sa&&(window.performance.clearResourceTimings(),this.Tsb=0);const fc=[];for(let yd=this.Tsb;yd<wa.length;yd++)this.eZc.JFf(wa[yd].name)&&(this.pLa&&(this.dVg?this.pLa.Vyk(wa[yd]):this.pLa.Uyk(wa[yd])),fc.push(new Q(wa[yd],this.cOh)));sa||(this.Tsb=wa.length);this.Za.raiseEvent(da.Eqd,new W(fc));for(wa=0;wa<fc.length;wa++)0!==fc[wa].behavior&&2!==fc[wa].behavior||this.Yje.Fi(0,fc[wa].Gge());0<fc.length&&u.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
fc.length)}catch(sa){u.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",sa)}}Fi(wa,sa){u.ULS.sendTraceTag(4310804,306,50,O(wa,sa))}zOj(){this.pLa.bPj()}Tvd(wa){return this.pLa.Tvd(wa)}Li(){this.sh&&0<this.uge&&(this.ym=new S.a(3,2,1E3*this.uge,()=>{this.flush()},5),this.sh.Li(this.ym),this.r2c=!0)}At(){this.r2c&&(this.sh.At(this.ym),this.ym=null,this.r2c=!1)}}da.Eqd="EntriesAvailable";Object(t.a)(da,"ResourceTimingLogger",null,[420,442]);var aa=a(130);class za{constructor(){this.$b=
null}get name(){return"Common.ResourceTiming"}init(){this.$b.resolve("Common.NetworkTiming.IResourceTimingLogger");X.instance.HQ()}dispose(){}dl(wa){this.$b=wa;let sa=null;if(C.AFrameworkApplication.fa.la("ResourceLoggerFilterDomainsIsEnabled"))try{sa=C.AFrameworkApplication.fa.Pw("ResourceLoggerDomainAllowList")}catch(Ie){u.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const fc=[];fc.push(J.a.yP(aa.a.oU).toLowerCase());fc.push(J.a.yP(aa.a.uob).toLowerCase());
const yd=C.AFrameworkApplication.fa.Ng("AppStaticResourceMonitorCacheThresholdInMs",100),Sd=C.AFrameworkApplication.fa.la("PPTAggregateResourceTimingV2Enabled");wa.register(420,"Common.NetworkTiming.IResourceTimingLogger").If().Rf(()=>new da(C.AFrameworkApplication.jl,window.performance,sa,fc,yd,Sd))}static main(){z.a.instance.Ul(new za)}}Object(t.a)(za,"ResourceTimingPackage",null,[4,5]);var qa=a(128);class ta extends Sys.EventArgs{constructor(wa,sa){super();this.luk=wa;this.actualValue=sa}}Object(t.a)(ta,
"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var Xa=a(122);class oa{constructor(){this.y4a=[];this.dre=this.zYc=0;this.Fma=null;this.Za=new T.a;this.WEh=(wa,sa)=>{Xa.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.UGh(sa.luk,sa.actualValue))}}init(wa,sa,fc){this.Fma=wa;this.zYc=sa;this.dre=fc;this.Fma.VMe(Object(qa.a)(this,this.Tnj,"onCpuMeterFrameAvailable"));this.Xeh(this.WEh)}Tnj(wa,sa){sa.CWf&&(Array.enqueue(this.y4a,sa.CWf.CP),this.y4a.length>this.dre&&
(Array.dequeue(this.y4a),this.Lwh()))}Lwh(){var wa=this.y4a.length;let sa=0;for(let fc=0;fc<wa;fc++){const yd=Array.dequeue(this.y4a);sa+=yd;Array.enqueue(this.y4a,yd)}wa=sa/wa;wa>this.zYc&&this.Za.raiseEvent("CPTTE",new ta(this.zYc,wa))}Xeh(wa){this.Za.addHandler("CPTTE",wa)}UGh(wa,sa){const fc={};fc.ThresholdValue=wa;fc.ActualValue=sa;return fc}}Object(t.a)(oa,"CpuMeterMonitor",null,[518]);var ha=a(184);class Za{constructor(){this.S=this.T=this.M=this.C=0}}Object(t.a)(Za,"ProfileInformation",null,
[]);var Fa=a(16),La=a(48),xa=a(270);class db{constructor(wa,sa){this.L0c=!1;this.wMa={};this.W7b=void 0===wa?0:wa;this.e8b=void 0===sa?0:sa;this.A9c=0;La.a.addHandler(window.self,Fa.a.Ghh,()=>{this.L0c=!0});La.a.addHandler(window.self,Fa.a.Hhh,()=>{this.L0c=!1})}oOe(wa,sa,fc){const yd=db.generateKey(sa,fc);yd in this.wMa?sa=this.wMa[yd]:(sa=new Za,sa.S=fc?1:0,this.wMa[yd]=sa,this.A9c++);sa.C++;sa.M=wa>sa.M?wa:sa.M;sa.T+=wa}sga(wa,sa){this.oOe(wa,sa,!1);this.L0c&&this.oOe(wa,sa,!0)}getData(){if(0<
this.e8b&&this.A9c>this.e8b)return this.Gki();const wa=0<this.W7b,sa={},fc=this.wMa;for(const Sd in fc){var yd=Sd;const Ie=fc[Sd];this.opg(Ie);wa&&Ie.T>=this.W7b&&(sa[yd]=Ie)}return wa?Ba.a.$j(sa)?null:sa:this.wMa}Gki(){var wa=0<this.W7b,sa=[];const fc=this.wMa;for(const yd in fc){const Sd={key:yd,value:fc[yd]},Ie=Sd.value;(!wa||Ie.T>=this.W7b)&&Array.add(sa,Sd)}if(sa.length>this.e8b)sa.sort((yd,Sd)=>Sd.value.T-yd.value.T),sa=sa.slice(0,this.e8b);else if(!sa.length)return null;wa={};for(const yd of sa)sa=
yd.value,this.opg(sa),wa[yd.key]=sa;return wa}opg(wa){wa.M=xa.a.Gda(wa.M,0);wa.T=xa.a.Gda(wa.T,0)}reset(){this.wMa={};this.A9c=0}static generateKey(wa,sa){return sa?wa+" [it]":wa}}Object(t.a)(db,"FunctionCallAggregator",null,[440]);class bb{}bb.enh="BatchedOperation";bb.pYj="Replication";bb.rAk="25";bb.qYj="9_"+bb.enh+"_"+bb.pYj;Object(t.a)(bb,"CpuMeterConstants",null,[]);class kb{}Object(t.a)(kb,"CpuMeterFrame",null,[]);class Rb extends Sys.EventArgs{constructor(wa){super();this.CWf=wa}}Object(t.a)(Rb,
"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class zb{}Object(t.a)(zb,"MiniTaskItemInfo",null,[]);class nc{}Object(t.a)(nc,"TaskItemInfo",null,[]);var Zb=a(536),Sa=a(111);class Na{static LBi(){if(!Na.O3b&&(Na.O3b=new Sa.a,C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.Zr("AggregatorIdDisabledList"))){const wa=C.AFrameworkApplication.fa.Pw("AggregatorIdDisabledList");for(let sa=0;sa<wa.length;sa++)Na.O3b.da(wa[sa],!0)}return Na.O3b}}Na.O3b=null;Object(t.a)(Na,"DisabledAggregatorListStore",
null,[]);var Ea=a(273);class Aa{constructor(wa,sa,fc,yd,Sd,Ie,pf){Ie=void 0===Ie?!0:Ie;pf=void 0===pf?null:pf;this.m3=this.KGe=this.Cxe=!1;this.sh=null;if(!wa)throw Ea.a.argument("taskManagerLazy");if(!Sd)throw Ea.a.argument("dataAggregator");this.S6g=wa;this.R4c=sa;this._id=fc;this.Qve=6E4*yd;this.d5b=Sd;this.PDe=Ie;this.Twb=pf;Na.LBi().$d(this._id.toString())&&(this.m3=!0)}get UQ(){return this.sh||(this.sh=this.S6g.value)}track(wa,sa){sa=void 0===sa?null:sa;this.m3||(this.uYh(),this.k4j(),this.d5b.sga(wa,
sa))}k4j(){!this.Cxe&&0<this.Qve&&(this.Cxe=!0,this.irg())}irg(){const wa=new S.a(5,1,this.Qve,()=>{this.o6j()},19,this._id.toString());this.UQ.Li(wa)}o6j(){!this.Twb||this.Twb.Ufk()?this.osg():this.PDe&&this.d5b.reset();this.irg()}osg(){const wa=this.d5b.getData();if(wa){const sa=parseInt(String(wa.length));if(isNaN(sa)||0<sa)this.RLc(wa),this.PDe&&this.d5b.reset()}}RLc(wa){u.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:wa})}uYh(){this.KGe||(this.R4c(()=>
{this.osg()}),this.KGe=!0)}static uS(wa,sa,fc,yd,Sd){return new Aa(new Zb.a(()=>C.AFrameworkApplication.jl),C.AFrameworkApplication.b2a,wa,sa,fc,yd,Sd)}static Zcb(wa,sa,fc){return Aa.uS(wa,sa,fc,!0,null)}}Object(t.a)(Aa,"Aggregator",null,[445]);class Ka{constructor(wa){wa=void 0===wa?null:wa;this.Gq=null;this.reset();this.Twb=wa}sga(wa,sa){if(!this.Twb||this.Twb.Ufk())sa in this.Gq||(this.Gq[sa]=[]),this.Gq[sa].push(wa)}getData(){return Ba.a.count(this.Gq)?this.Gq:null}reset(){this.Gq={}}}Object(t.a)(Ka,
"NamedValuesAggregator",null,[440]);var nb=a(232);class Qb{constructor(wa,sa,fc,yd,Sd){this.fOa=0;this.mJ=null;this.U9b=this.tGe=0;this.FEe=!1;this.Z4a=0;this.Nub=!1;this.dza=null;this.R6b=0;this.tBe=new T.a;this.Q6g=[];this.nR=wa;this.H3c=sa;this.z_c=fc;this.Gze=yd;C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.la("WrapSetTimeoutForTelemetryIsEnabled")&&this.xMd();this.XYg=Sd;this.A_c=new db(100);this.Z1g=Aa.Zcb(1,5,new Ka)}VMe(wa){this.tBe.addHandler("OnCpuMeterFrameAvailable",wa)}ylb(wa,
sa,fc,yd){fc=(yd=void 0===yd?null:yd)?yd.priority:7;const Sd=this.nR();this.start(sa,fc);try{wa()}finally{this.stop(sa,yd),wa=this.nR()-Sd,this.Gze.track(wa,sa)}}B1(wa,sa){const fc=this.nR();try{wa()}finally{wa=this.nR()-fc,this.z_c.sga(wa,sa),0<this.fOa&&this.A_c.sga(wa,sa),this.Gze.track(wa,sa)}}dXd(wa){const sa=new nc;sa.TN=wa.IAc;sa.TP=wa.priority;this.sfg(1,sa)}Gib(wa){this.R6b|=wa}start(wa,sa){if(!this.fOa){this.A_c.reset();const fc=this.JLf(wa);fc&&this.VQd(1);this.mJ=new nc;this.mJ.TN=wa;
this.mJ.TP=sa;this.mJ.ST=(new Date).toISOString();this.mJ.STS=xa.a.Gda(this.nR(),2);fc?this.mJ.UI=1:this.aZi(wa)?this.mJ.UI=2:this.mJ.UI=0}this.fOa++}VQd(wa){this.Z4a|=wa}$hd(wa,sa){this.Z4a=void 0===wa||wa?0:this.Z4a&~(void 0===sa?0:sa)}stop(wa,sa){sa=void 0===sa?null:sa;let fc;this.fOa--;0>=this.fOa&&this.mJ&&(fc=this.nR()-this.mJ.STS,this.U9b+=fc,this.H3c.sga(fc,wa),this.JLf(wa)&&this.$hd(!1,1),this.mJ.TRT=xa.a.Gda(fc,2),sa&&(this.mJ.TQT=xa.a.Gda(sa.UKj,2),this.mJ.TDT=xa.a.Gda(sa.iNf,2)),this.XYg&&
(this.sfg(0,this.mJ),this.cZj()),this.fOa=0);0<=wa.indexOf(bb.rAk)&&this.Gib(2);0<=wa.indexOf(bb.qYj)&&this.Gib(4);1===(this.Z4a&1)&&this.Gib(1);2===(this.Z4a&2)&&this.Gib(8)}cZj(){var wa=this.mJ.TRT;if(750<wa){let fc=this.A_c.getData();if(fc){const yd={};for(const Sd in fc){var sa=fc[Sd];const Ie=Sd;Ie.startsWith("SiOp_")||Ie.endsWith("[it]")||(yd[Ie]=Math.round(100*sa.T/wa))}fc=yd}wa=Object.assign(new zb,{B:this.mJ.STS,T:wa,S:fc});this.Z1g.track(wa,this.mJ.TN)}}mok(){var wa=this.nR()-this.tGe,sa=
xa.a.Gda(this.U9b/wa*100,2);wa=new kb;wa.CP=sa;wa.II=this.R6b;sa=this.H3c.getData();Ba.a.count(sa)&&(wa.LRT=sa);sa=this.z_c.getData();Ba.a.count(sa)&&(wa.FP=sa);this.tBe.raiseEvent("OnCpuMeterFrameAvailable",new Rb(wa));this.YBg()}YBg(){this.H3c.reset();this.z_c.reset();this.U9b=this.fOa=0;this.tGe=this.nR();this.R6b=0;this.mJ=null}HQ(){this.FEe?this.mok():(this.YBg(),this.FEe=!0);this.dza?this.dza(Object(qa.a)(this,this.HQ,"run"),1E3):window.setTimeout(Object(qa.a)(this,this.HQ,"run"),1E3)}sfg(wa,
sa){wa=this.Q6g[wa];if(!nb.a.$j(wa))for(let yd=0;yd<wa.length;yd++){var fc=wa[yd];const Sd=fc[0];fc=fc[1];Sd&&!Sd(sa)||fc(sa)}}xMd(){if(!this.Nub){const wa=window.setTimeout;this.dza=(sa,fc)=>wa(sa,fc);this.Nub=!0}}JLf(wa){return wa.startsWith("key")||wa.startsWith("input")}aZi(wa){return wa.startsWith("click")||wa.startsWith("mouse")||wa.startsWith("pointer")}}Object(t.a)(Qb,"CpuMeter",null,[84]);class jb{constructor(wa){this.Rsb=null;this.ro=new ha.a;this.nR=wa}initialize(wa,sa,fc,yd){this.Rsb||
(this.Rsb=new Qb(this.nR,wa,sa,fc,void 0===yd?!1:yd),this.ro.setResult(this.Rsb));return this.Rsb}}Object(t.a)(jb,"CpuMeterProvider",null,[441]);class qb{constructor(wa){this.pC=[];this.l5b=[];this._count=void 0===wa?1:wa}n$h(){let wa=0;for(let sa=0;sa<this.pC.length;sa++)this.pC[sa]<this.pC[wa]&&(wa=sa);return wa}sga(wa,sa){wa=xa.a.Gda(wa,2);if(this.pC.length<this._count)Array.add(this.pC,wa),Array.add(this.l5b,sa);else{var fc=this.n$h();wa>this.pC[fc]&&(this.pC[fc]=wa,this.l5b[fc]=sa)}}getData(){return this.pC.length?
{["Vals"]:this.pC,["Desc"]:this.l5b}:null}reset(){this.pC=[];this.l5b=[]}}Object(t.a)(qb,"MaxDataAggregator",null,[440]);var ab=a(55),xb=a(81);class Tb{get name(){return"Common.App.CpuMeter"}dl(wa){wa.register(jb,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").If().Rf(()=>new jb(ab.a.Yg));wa.register(oa,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").If().Rf(()=>new oa)}init(){const wa=C.AFrameworkApplication.fa;if(wa.la("CpuMeterIsEnabled")){const sa=
xb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");L.a.instance.pPe.continueWith(()=>{Tb.yNi(wa,sa)})}}dispose(){}static yNi(wa,sa){const fc=Aa.Zcb(10,5,new db(wa.Ng("TaskManagerLoggingThreshold",0),wa.Ng("CpuMeterMaximumEntriesToLog",0)));sa=sa.initialize(new qb(5),new db,fc,wa.la("CPUMeterExposeTaskDetailsIsEnabled"));wa.la("WordEditorInteractivePerfDisableCpuMeterFrames")||(sa.HQ(),wa.la("CpuMeterMonitorIsEnabled")&&xb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(sa,
wa.nba("CpuMeterAverageCpuPercentThreshold",80),wa.Ng("CpuMeterRollingAverageFramesCount",15)));Xa.a(16827671,306,50,"Initializing CpuMeter")}static main(){z.a.instance.Ul(new Tb)}}Object(t.a)(Tb,"CpuMeterPackage",null,[4,5]);var Cc=a(1041);class lb{get name(){return"Common.App.EventsCachePackage"}dl(){}init(){Cc.a.instance.init()}dispose(){}static main(){z.a.instance.Ul(new lb)}}Object(t.a)(lb,"EventsCachePackage",null,[4,5]);var Ya=a(11),Hb=a(299),Lb=a(1046),qc=a(175),mc=a(538),Ta=a(223),Va=a(243),
Db=a(60),Ca=a(91),cb=a(1),hb=a(22),ya=a(161),Pa=a(832);class wb extends Lb.a{constructor(wa,sa,fc){super(sa,fc);this.Va=new T.a;this.GJi=yd=>{if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Sd=yd.Values.m_Origin;C.AFrameworkApplication.wopiHostOriginFromPostMessage||(C.AFrameworkApplication.wopiHostOriginFromPostMessage=Sd)}switch(yd.MessageId){case qc.a.fEd:ya.a(this.$).Cxf(yd);break;case qc.a.zOd:Va.a.ltas(null);break;case qc.a.Ttc:this.Ksj();break;case qc.a.jEd:this.Jsj(yd)}};
this.$=wa;fc!==Pa.a.zZ&&this.kZ(fc);this.QOi();this.ZNi();wa=this.GJi;this.Dn(qc.a.fEd,wa);this.Dn(qc.a.zOd,wa);this.Dn(qc.a.Ttc,wa);this.Dn(qc.a.jEd,wa)}dispose(){this.$=null;super.dispose()}QOi(){this.rp(qc.a.yVe);this.rp(qc.a.fEd);this.rp(qc.a.Ttc);this.rp(qc.a.jEd);this.H7a(qc.a.zOd);this.rp(qc.a.iEd)}ZNi(){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8203392_VersionHistoryIRMErrorCancelBehaviorFix")&&this.hV("App_EwrWorkbookNotSupportedCancelResponse");this.hV(qc.a.eyb);this.hV(qc.a.Z4);this.hV("App_CloseTab");
this.hV(qc.a.z3a);this.hV(qc.a.A3a);this.hV(qc.a.zAf);this.hV(qc.a.Qtc);this.hV("App_ModifyURLState")}Ksj(){const wa={};wa.hostMessageReceived=(new Date).getTime();u.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");C.AFrameworkApplication.pyc=!0;wa.appUnloadStart=(new Date).getTime();wa.sendBeaconFlight=C.AFrameworkApplication.fa.la("SendBeaconOnShuttingDownRequestsEnabled");wa.sendBeaconSupported=Db.a.xla();Db.a.zPe();wa.appUnloadEnd=(new Date).getTime();wa.appMessageSent=(new Date).getTime();
this.sendMessage(qc.a.ajh,wa)}Jsj(wa){u.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");wa.Values&&mc.a.bTd in wa.Values&&hb.a.equals(wa.Values[mc.a.bTd],Ta.a.edit,!0)&&!this.$.isEditMode&&(u.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${wa.Values[mc.a.bTd]}`),wa=new Ca.a(-8805455,0,1,0,null),this.$.Ha.Me(wa))}}Object(t.a)(wb,"EwaHostMessenger",Lb.a,[439,229,2]);class Ib extends Hb.a{constructor(wa){super();this.M_e=!1;this.$=wa;this.Dg()}create(){const wa=
this.$.ja,sa=xb.a.instance;if(!this.M_e){this.M_e=!0;let fc;fc=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.xa.DocumentHostInfo.PostMessageOrigin||Pa.a.zZ:C.AFrameworkApplication.DZd||Pa.a.zZ;sa.register(wb,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").If().Rf(()=>new wb(this.$,window.parent,fc,C.AFrameworkApplication.fa.la("HostSendReadyToAcceptPostMessage")))}this.Df(wa.Qa(21)||wa.$c(21,sa.resolve("Postmessage.IHostPostmessenger")))}}
Object(t.a)(Ib,"HostMessengerFactory",Hb.a,[]);var pb=a(120),xc=a(179),ua=a(759),U=a(584),na=a(82),ob=a(148),bc=a(50),oc=a(285),Yb=a(343),Fc=a(342),ld=a(457),qd=a(6),fe=a(56),ge=a(65);class Wd{constructor(wa,sa,fc){this.correlations=this.properties=this.operation=null;this.operation=wa;this.properties=sa;this.correlations=fc}static P7h(wa,sa,fc){const yd={},Sd=fe.b();switch(wa.command){case -1537138325:yd.Action=sa.LabelText;break;case -1104934572:yd.PrevTab=Sd.hm(parseInt(sa.OldContextCommand,10));
yd.NextTab=Sd.hm(parseInt(sa.NewContextCommand,10));break;case 802602464:yd.Origin=sa[qd.a.XH];break;case -1027730316:case -1059615499:yd.MenuType=sa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in sa&&(yd.SqmControlId=sa.SqmControlId);break;case 1371713064:case 875133075:ge.a.ig in sa&&(yd.SampleTableId=sa[ge.a.ig])}yd.InputMethod=Yb.a[wa.method];yd.Location=Fc.a[wa.Ch];yd.Mode=ld.a[wa.mode];yd.ParentName=wa.tabName;
yd.IsSystemInitiated="IsSystemInitiated"in sa?sa.IsSystemInitiated:!1;yd.NoReporting="NoReporting"in sa?sa.NoReporting:!1;"ControlIdToLog"in sa&&(yd.ControlId=sa.ControlIdToLog);"TerminalParentControlIdToLog"in sa&&(yd.TerminalParentControlId=sa.TerminalParentControlIdToLog);for(const Ie of Object.keys(fc))yd[Ie]=fc[Ie];return yd}}Object(t.a)(Wd,"InteractivityRecord",null,[]);class Zd extends Wd{constructor(wa,sa,fc){super(wa.operation,wa.properties,wa.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=
0;this.timeFromAppInteractive=sa;this.timeFromNavigationStart=fc}}Object(t.a)(Zd,"FirstUserInteractivityRecord",Wd,[]);var ke=a(692);class ne{constructor(){this.commandSurface=this.triggerMethod=pb.a.Eqb}static PNi(){ne.ncb||(ne.ncb=new ke.a(U.a.Ki()),ne.ncb.add("InputMethod"),ne.ncb.add("Location"),ne.ncb.add("Mode"))}}ne.ncb=null;Object(t.a)(ne,"ExcelUserAction",null,[]);var se=a(205),Cb=a(52),ib=a(456),ac=a(155),Lc=a(146),ad=a(8),te=a(108);class Ma extends na.a{constructor(wa){super();this.lDf=
0;this.fjf=!1;this.fNd=Array(Ma.Lib);this.ijc=0;this.$=wa;this.eLf=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");pb.a.hti();this.Oia={};Ma.Vac||(Ma.Vac=new ua.a(U.a.Ki()),Ma.UMi(Ma.Vac));ne.PNi();if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(wa=0;wa<Ma.Lib;wa++)this.fNd[wa]="NA"}dispose(){this.$=this.Oia=null;super.dispose()}dmg(wa,sa,fc){const yd=fe.b().hm(wa.command),Sd=JSON.stringify(wa);yd||u.ULS.sendTraceTag(537155555,
3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${yd}, command: ${wa.command}, commandInfo: ${Sd}`);sa=Wd.P7h(wa,sa,fc);fc=!!sa&&(!("IsSystemInitiated"in sa)||!sa.IsSystemInitiated);this.$&&this.$.ea.ei&&fc&&Cc.a.instance.Rgg("OtelUserAction",new ib.a(yd,wa.tabName,Date.now()));this.rmg(yd,sa,null,!0,!0)}Gg(wa,sa,fc,yd){this.rmg(wa,sa,void 0===fc?null:fc,!1,void 0===yd?!1:yd)}jPc(wa){if(this.Oia){++this.lDf;this.Oia[wa]||(this.Oia[wa]=[]);var sa=this.lDf.toString();
this.Oia[wa].push(sa);u.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${wa}', correlation=${sa}`)}else u.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${wa}] == null`)}yPc(wa){if(this.Oia&&this.Oia[wa]){var sa=this.Oia[wa],fc=sa.pop().toString();sa.length||delete this.Oia[wa];u.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${wa}', correlation=${fc}`)}else u.ULS.shipAssertTag(537155552,
0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${wa}] == null`)}KV(wa,sa,fc){fc=void 0===fc?!1:fc;return oc.b(yd=>{this.Gg(wa,yd(),void 0,fc)},Ma.nuk,this.qa,bc.a.RQi,!1,!sa)}i5d(){let wa="";for(let sa=0;sa<Ma.Lib;sa++)wa+=this.fNd[(this.ijc+Ma.Lib-sa-1)%Ma.Lib]+",";u.ULS.sendTraceTag(557188890,0,15,`Last operations ${wa}`)}IEk(wa){wa&&(this.fNd[this.ijc]=wa,this.ijc=(this.ijc+1)%Ma.Lib)}m$i(wa,sa,fc){C.AFrameworkApplication.cmc();const yd=wa.operation,
Sd=wa.properties;void 0!==fc?void Lc.a.resolve(ad.Uc,{Aa:0}).then(Ie=>{Ie.dPj(yd,Sd,fc)}):this.BAk(wa);this.CAk(wa);this.sBj(sa,Sd,yd)}BAk(wa){this.qnk(wa)||(this.fjf=!0,wa=new Zd(wa,Cb.a.instance.xba(new Date),Object(te.b)()),wa=Sys.Serialization.JavaScriptSerializer.serialize(wa),u.ULS.sendTraceTag(458261331,0,50,`${wa}`))}qnk(wa){const sa=wa.properties;wa=wa.operation;return this.fjf||void 0===wa||null===wa||wa===ob.a.P$c||wa===ob.a.Q8d||wa===ob.a.f_d||Db.a.bKd(wa)||!!sa&&"IsSystemInitiated"in
sa&&sa.IsSystemInitiated}CAk(wa){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.IEk(wa.operation);wa=Sys.Serialization.JavaScriptSerializer.serialize(wa);u.ULS.sendTraceTag(21542793,0,50,`${wa}`)}sBj(wa,sa,fc){pb.a.$sa()&&(sa?"NoReporting"in sa&&sa.NoReporting||"IsSystemInitiated"in sa&&sa.IsSystemInitiated||!wa&&!this.eLf||((wa=pb.a.Bl(sa,Ma.Vac,ne.ncb))?(sa=Ma.Z7h(sa))?xc.a.sendUserActionEvent(pb.a.Ric(fc,null,sa.triggerMethod,sa.commandSurface,wa)):
u.ULS.sendTraceTag(537155550,0,50,"user action was null"):u.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):u.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${fc}`))}rmg(wa,sa,fc,yd,Sd){const Ie=se.a(this.$);if(this.eLf){let If=null;hb.a.equals(wa,ob.a.BLc,!0)&&sa&&"InputMethod"in sa&&(If=ob.a.okf(wa,sa.InputMethod));Ie.TWb(If||wa,fc)}else hb.a.equals(wa,ob.a.BLc,!0)&&sa&&"InputMethod"in sa&&(wa=ob.a.okf(wa,
sa.InputMethod)),Ie.TWb(wa,fc);sa&&(sa.IsCommand=yd);const pf="ActionRelativeTime"in sa?sa.ActionRelativeTime:Object(te.b)();Object(ac.d)(()=>{const If=new Wd(wa,sa,this.Oia);this.m$i(If,Sd,pf)},this.$.qa,50)}static Z7h(wa){if(!wa)return null;const sa=new ne;"InputMethod"in wa&&(sa.triggerMethod=wa.InputMethod);"Location"in wa&&(sa.commandSurface=wa.Location);return sa}static UMi(wa){wa?(wa.add("Origin",2),wa.add("InputMethod",2),wa.add("ButtonType",2),wa.add("selectedRange",2),wa.add("SelectedRanges",
2),wa.add("editRange",2),wa.add("Location",2),wa.add("Mode",2),wa.add("CurrentSelectionMode",2),wa.add("Action",2),wa.add("type",2),wa.add("floatingObjectType",2),wa.add("PrevTab",2),wa.add("NextTab",2),wa.add("DialogName",2),wa.add("dx",3),wa.add("dy",3),wa.add("NumberOfSelectedRanges",3),wa.add("IsCommand",1),wa.add("IsInFormulaBarEdit",1),wa.add("isLink",1),wa.add("isSheetRef",1),wa.add("isEmptyText",1),wa.add("isFormula",1),wa.add("IsResizingHiddenHeader",1)):u.ULS.sendTraceTag(537155547,0,15,
"InitTypeSpecifier was passed in a null dictionary")}}Ma.nuk=1E3;Ma.Lib=40;Ma.Vac=null;Object(t.a)(Ma,"InteractivityLogger",na.a,[14]);var V=a(203),fa=a(2),ub=a(98),rb=a(54);class hd{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(t.a)(hd,"ActionData",null,[]);class Eb{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(t.a)(Eb,"BlockedEngagementInfo",null,[]);class kc extends hd{constructor(){super();this.inputMethod=null;this.isCommand=
!1}}Object(t.a)(kc,"SuccessfulActionData",hd,[]);class zc{constructor(){this.successfulActions=[]}}Object(t.a)(zc,"SuccessfulEngagementInfo",null,[]);var Nc=a(47),Fd;let Xd=Fd=class{constructor(wa){this.KSa=new Set;this.$_b=null;this.ejf=this.FDg=!1;this.qkb=(sa,fc)=>{this.XAb.hasBlockedActions=!0;sa=this.XAb.blockedActions.length;const yd=fc.details?fc.actionName+"_"+fc.details:fc.actionName;fc=Object(fa.a)(new hd,{order:sa+1,name:yd,componentName:fc.componentName,timeFromNavigationStart:fc.timeFromNavigationStart});
this.XAb.blockedActions.push(fc)};this.el=()=>{Nc.a(this.$).wWb(this.qkb);this.f9i();this.$_b=rb.a.instance.create(()=>{this.dQb()},Fd.Irk,bc.a.dQb)};this.sg=()=>{this.dQb()};this.T0d=()=>{this.$.Lf(2009315810,-1,0,null);this.Mbe=!1};this.XAb=new Eb;this.XAb.hasBlockedActions=!1;this.ypb=new zc;this.q9h();this.$=wa;this.$.ea.zm(this.el);this.$.Sm(this.sg);this.Lrk=0;this.Mbe=!1;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.k1e=new Promise(sa=>
{this.vEh=sa}));Nc.a(this.$).wcc(this.qkb)}dispose(){this.$.ea&&this.$.ea.cq(this.el);this.$.ar(this.sg);ub.a.Sa(this.$_b);this.$=this.$_b=null}dPj(wa,sa,fc){if(void 0!==wa&&null!==wa&&sa){var yd=this.ypb.successfulActions.length+1,Sd="InputMethod"in sa?sa.InputMethod:"",Ie="IsCommand"in sa&&sa.IsCommand;if(this.$2i(wa,sa,Sd,Ie)){++this.Lrk===Fd.vHk?(this.Mbe=!0,this.XDj=rb.a.instance.create(this.T0d,5E3,bc.a.T0d)):this.Mbe&&this.XDj.tv();if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const pf=
!Ie&&wa;this.ejf||pf===ob.a.vOg||pf===ob.a.wOg||pf===ob.a.sOg||pf===ob.a.tOg||(this.ejf=!0,this.vEh(void 0))}yd>Fd.XTf||(wa=Object(fa.a)(new kc,{order:yd,name:wa,componentName:"Location"in sa?sa.Location:"",timeFromNavigationStart:fc,inputMethod:Sd,isCommand:Ie}),this.ypb.successfulActions.push(wa),1===yd?this.Y9i():yd===Fd.XTf&&this.dQb())}}}f9i(){u.ULS.sendTraceTag(254546634,0,50,`${ia.c(this.XAb)}`)}Y9i(){Cb.a.instance.xba(new Date)>Fd.A9h?u.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${ia.c(this.ypb.successfulActions[0])}`):
u.ULS.sendTraceTag(254563592,0,50,`${ia.c(this.ypb.successfulActions[0])}`)}dQb(){!this.FDg&&this.ypb.successfulActions.length&&(this.FDg=!0,ub.a.Sa(this.$_b),this.$_b=null,this.$.sendBeaconTraceTag(254559496,50,!1,ia.c(this.ypb)))}q9h(){this.KSa.add(ob.a.P$c);this.KSa.add(ob.a.Q8d);this.KSa.add(ob.a.f_d);this.KSa.add(ob.a.fcg);this.KSa.add(ob.a.hcg);this.KSa.add(ob.a.jcg)}$2i(wa,sa,fc,yd){fc=!fc||"unknown"===fc;const Sd="IsSystemInitiated"in sa&&sa.IsSystemInitiated;sa="NoReporting"in sa&&sa.NoReporting;
const Ie=this.KSa.has(wa);wa=hb.a.equals(wa,ob.a.BLc,!0)&&fc;return!Sd&&!sa&&!Ie&&!wa&&!(yd&&fc)}};Xd.XTf=10;Xd.A9h=6E4;Xd.Irk=12E4;Xd.vHk=25;Xd=Fd=Object(V.__decorate)([Object(Lc.d)(ad.Uc),Object(V.__param)(0,Object(ad.nb)())],Xd);Object(t.a)(Xd,"PageLoadEngagementInfo",null,[]);var ie=a(809);Object(Lc.b)(ad.Lc)(()=>Lo(function*(){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?yield Object(ie.a)("officeOnlineCpuProfiling",{Aa:0}):yield Lc.a.resolve(ad.hb,{Aa:0}).then(wa=>
wa("officeOnlineCpuProfiling"));return officeOnlineCpuProfiling}));var Ee=a(495),He=a(9),gd=a(63);class Bd{constructor(wa){this.Wnk=wa}getCustomProperties(wa){const sa=new Map;if(wa.hasOwnProperty("startTimeInMs")&&wa.hasOwnProperty("totalExecutionTimeInMs")){const fc=wa.startTimeInMs;wa=this.Wnk.retrieveSlowActionsBetweenTimeRange(fc,fc+wa.totalExecutionTimeInMs);sa.set("actions",gd.a.Vf(wa))}return sa}}Object(t.a)(Bd,"CallTreeCustomPropertiesRetriever",null,[525]);class ue{constructor(){this.customProperties=
new Map}addCustomProperty(wa,sa){this.customProperties.set(wa,sa)}getCustomProperties(){return this.customProperties}}Object(t.a)(ue,"CustomPropertiesRetriever",null,[524]);class ye{isFeatureEnabled(wa,sa){return cb.EwaSettings.getBooleanFeatureGate(wa,sa)}}Object(t.a)(ye,"ExcelFeatureChecker",null,[523]);class Ue{isProfilingEnabled(){return!0}}Object(t.a)(Ue,"ExcelProfilingFeatureChecker",null,[522]);class Sb{constructor(wa,sa){this.ryj=wa;this.tyj=sa}onProfilerEvent(wa){switch(wa.eventId){case 1:this.ryj(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));
break;case 0:this.tyj();break;default:u.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${wa.eventId}`)}}}Object(t.a)(Sb,"JSCPUProfilerObserver",null,[521]);class cd{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(t.a)(cd,"JSCPUProfilerInitOptions",null,[]);class Xc{constructor(){this.profilerTraceLoggingChunkSize=this.shouldLogRawProfilerTrace=this.shouldRecordFrameCounts=
this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=
this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=
this.appName=null}}Object(t.a)(Xc,"JSCPUProfilingPackageInitOptions",null,[]);class fd{filter(wa){var sa,fc,yd;const Sd=!Cb.a.instance.TTSI||(null===(sa=wa.serializedFrames[0])||void 0===sa?void 0:sa.startTimeInMs)<Cb.a.instance.nAk;sa=(null===(fc=wa.propertyBag)||void 0===fc?void 0:fc.actions)&&"[]"!==wa.propertyBag.actions;wa=0<(null===(yd=wa.serializedFrames[0])||void 0===yd?void 0:yd.totalExecutionTimeInMs);return Sd&&wa||sa}}Object(t.a)(fd,"CallTreeCustomFilterer",null,[416]);let mb=class{constructor(wa,
sa){this.mDf=this.gCg=this.f0d=this.zlb=this.g0d=this.Hdg=this.Jdg=null;this.vJj=new Set([1,0]);u.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=wa;this.mDf=sa;this.NOi();this.MOi();this.B4i=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingSampleIntervalInMs",16);this.profilingIntervalInMs=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.K0e=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",
3E5);this.PBj=cb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.cqk()}dispose(){u.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");ub.a.Sa(this.gCg);this.f0d=this.$=null;this.g0d.clear();this.zlb.clear()}tpk(){const wa=Math.random()*this.K0e;u.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${wa}`);this.gCg=rb.a.instance.create(()=>{this.esf("ExcelOnlineContinuousSessionProfiler",2).start()},wa,bc.a.Zek,
!0)}Gpk(){u.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.esf("ExcelOnlineFullSessionProfiler",3).start()}Idg(wa){return this.zlb.has(wa)}cqk(){cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.Gpk():this.tpk()}createProfiler(wa,sa,fc,yd,Sd,Ie){u.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const pf=new cd;pf.samplingIntervalInMs=sa;pf.maximumNumberOfSamplesToTake=
fc;pf.idleIntervalInMs=yd;pf.profilingIntervalInMs=Sd;return this.cKh(wa,Ie,pf)}MOi(){const wa=new Ue,sa=new Xc;sa.ulsInstance=new Ee.a;sa.deObfuscationEndpoint="ProfilerReporting.ashx";sa.shouldCompressSerializedCallTrees=!1;sa.shouldKeepSamplesOutsideOfProfilingInterval=!1;sa.shouldSendAllCallTreesFromProfileInASingleRequest=!cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);sa.shouldUseSendBeaconForSendingCallTrees=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",
!1);sa.callTreeFilteringThresholdInMs=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);sa.frameTotalExecutionTimeFilteringThresholdInMs=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerFrameTotalExecutionTimeFilteringThresholdInMs",0);sa.shouldRecordFrameCounts=!1;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8083064_profilerCounters")&&(sa.callTreeFilteringThresholdInMs=-1,sa.frameTotalExecutionTimeFilteringThresholdInMs=-1,sa.shouldRecordFrameCounts=
!0);sa.deObfuscationRequestQueryParamsRetriever=this.MGh();sa.deObfuscationRequestBodyPropertiesRetriever=this.LGh();sa.featureEnabledChecker=new ye;sa.useMainEventLoopForProfilerTraceProcessing=!1;sa.profilerTraceProcessingWebWorkerSourceURL=this.$.xa.JSProfilerProcessingWebWorkerJsScriptUrl;sa.shouldProcessProfileCapturedWhileUserIsIdle=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldLogRawProfilerTrace",
!1)&&(sa.shouldLogRawProfilerTrace=!0,sa.profilerTraceLoggingChunkSize=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ProfilerTraceLoggingChunkSize",30));this.f0d=this.Jdg.retrievePackage(wa,sa).retrieveProfilerFactory()}MGh(){const wa=new ue;wa.addCustomProperty(He.a.teg,C.AFrameworkApplication.userType);wa.addCustomProperty(C.AFrameworkApplication.HKa,C.AFrameworkApplication.userSessionId);wa.addCustomProperty(He.a.lTd,this.$.xa.SkipAuthentication?He.a.UWf:null);wa.addCustomProperty(He.a.C0d,
this.$.xa.MachineCluster);return wa}LGh(){const wa=new ue;wa.addCustomProperty("appName","Excel");wa.addCustomProperty("buildVersion",C.AFrameworkApplication.buildVersion);wa.addCustomProperty("shouldUseSourceMaps","true");wa.addCustomProperty("shouldFilterSensitiveResources","true");wa.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","false");return wa}cKh(wa,sa,fc){const yd=new ue;yd.addCustomProperty("ProfilerName",wa);this.Hdg.set(wa,yd);sa=this.f0d.createProfiler(sa,fc,yd);this.zlb.set(wa,
sa);wa=this.oIh(wa);sa.subscribeProfilerObserver(wa,this.vJj);wa=new fd;sa.subscribeCallTreeCustomFilterer(wa);return sa}Kui(wa){return this.Idg(wa)?this.zlb.get(wa):(u.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${wa}) does not exist`),null)}esf(wa,sa){var fc=void 0===fc?null:fc;wa=this.PBj||wa;if(this.Idg(wa))return this.Kui(wa);const yd=this.B4i;return this.createProfiler(wa,yd,null!=fc&&0<yd?fc/yd:2E6,2===sa?this.K0e:null,0===sa?null:this.profilingIntervalInMs,
sa)}oIh(wa){var sa=this.mDf;if(sa){const fc=sa.Y3e();if(fc){sa=this.zlb.get(wa);const yd=new Bd(fc);sa.subscribeCallTreeCustomPropertiesRetriever(yd);sa=new Sb(Sd=>{fc.startCollectingSlowActions(Sd)},Object(qa.a)(fc,fc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.g0d.set(wa,sa);return sa}u.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}u.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");
return null}NOi(){this.Jdg=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.Hdg=new Map;this.g0d=new Map;this.zlb=new Map}};mb=Object(V.__decorate)([Object(Lc.d)(ad.rc),Object(V.__param)(0,Object(ad.nb)()),Object(V.__param)(1,Object(ad.qc)()),Object(V.__param)(2,Object(ad.Lc)())],mb);Object(t.a)(mb,"JsSelfProfilerManager",null,[391,2]);class Oc{constructor(){this.appInfoProperties=this.appState=null}}Object(t.a)(Oc,"CurrentAppInfo",null,[]);const jd=new Map;[{name:"keyboard_selection",
actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])},{name:"scroll_animation",actions:new Set(["viewport_scroll"])}].forEach(wa=>{wa.actions.forEach(sa=>{jd.set(sa,wa.name)})});class ud{constructor(){this.value=this.key=null}}Object(t.a)(ud,"AppInfoProperty",null,[]);class pd{constructor(wa){this.$=wa}getAppState(){const wa=Cb.a.instance.xba(new Date);return-1===wa?"boot":3E4>wa?"postboot":"steady"}isChangeGateEnabled(wa){return cb.EwaSettings.isChangeGateEnabled(wa)}getBooleanFeatureGate(wa,sa){return cb.EwaSettings.getBooleanFeatureGate(wa,
sa)}getCurrentAppInfo(){return Object(fa.a)(new Oc,{appState:this.getAppState(),appInfoProperties:[Object(fa.a)(new ud,{key:"coauthCount",value:this.$.ea.Zo.length.toString()})]})}sendBeaconTraceTag(wa,sa,fc,yd){this.$.sendBeaconTraceTag(wa,sa,fc,yd)}getActionBucket(wa){return c(wa)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.oej}`}logSlowActionsHandler(){return""}}Object(t.a)(pd,"InteractivityTrackerCallbacks",null,[415]);class id{constructor(){this.events=null;this.durationThresholdInMs=
0;this.asyncUiTracking=this.animationTracking=this.periodicReport=this.patchTaskScheduling=this.callbacks=null}}Object(t.a)(id,"InteractivityTrackerOptions",null,[]);const Ed=(wa,sa)=>Lo(function*(){return cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?Object(ie.a)("interactivity",sa):Lc.a.resolve(ad.hb,sa).then(fc=>fc("interactivity"))});Object(Lc.b)(ad.qc,{nn:"singleton"})(wa=>Lo(function*(){const sa=yield Lc.a.resolve(ad.nb,wa);yield Ed(sa,wa);const fc=interactivity.InteractivityTrackerFactoryGlobal.create();
return new Pd(sa,fc)}));class Pd{constructor(wa,sa){this.LS=void 0===sa?null:sa;Pd.HHf?u.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(wa),Pd.HHf=!0)}initialize(wa){u.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.LS){var sa=new id;cb.EwaSettings.CLd()&&Pd.WPc.push(Fa.a.bpa);Pd.WPc.push("mouseup");Pd.WPc.push("touchstart");sa.events=Pd.WPc;sa.durationThresholdInMs=
Pd.durationThresholdInMs;sa.callbacks=new pd(wa);sa.patchTaskScheduling=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);wa=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReport",!1);const fc=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReportPassiveTest",!1),yd=cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PeriodicReportIntervalMs",6E4);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncUI",
!1)&&(sa.asyncUiTracking={slowUiEventThresholdMs:cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowUIEventThresholdMs",300),asyncUiEventTimeoutMs:cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AsyncUIEventTimeoutMs",3E4)});if(wa||fc)sa.periodicReport={isPassiveTestEnabled:fc,intervalMs:yd};cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimation",!1)&&(sa.animationTracking={chunkDurationMs:cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationChunkDurationMs",
100),minFramesPerChunk:cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationMinFramesPerChunk",3),animationTimeoutMs:cb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.animationTimeoutMs",5E3)});sa=this.LS.start(sa);sa.started?u.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):u.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+sa.failureReason)}else u.ULS.sendTraceTag(537155541,
0,15,"InteractivityTrackerService: InteractivityTracker not created")}pL(wa,sa,fc,yd){if(this.LS)return this.LS.trackInteraction(wa,sa,fc,yd);u.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${sa}`)}Y3e(){return this.LS?this.LS.createActionsRetriever():(u.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.LS&&
(this.LS.stop(),this.LS=null)}addContext(wa,sa,fc){this.LS?this.LS.addContext(wa,sa,fc):u.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}startTrackAnimation(wa,sa){return this.LS?this.LS.startTrackAnimation(wa,sa):(u.ULS.sendTraceTag(508343192,0,15,"InteractivityTrackerService.startTrackAnimation: interactivityTracker not initialized."),!1)}stopTrackAnimation(wa){this.LS?this.LS.stopTrackAnimation(wa):u.ULS.sendTraceTag(508343191,0,
15,"InteractivityTrackerService.endTrackAnimation: interactivityTracker not initialized.")}}Pd.durationThresholdInMs=100;Pd.WPc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");Pd.HHf=!1;Object(t.a)(Pd,"InteractivityTrackerService",null,[241]);var lc=a(19);const Kc={MergedCell:"MergedCell",TQg:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",NSg:"RichText"};
let td=class{constructor(wa){this.sg=()=>{const sa=JSON.stringify(this.YZe),fc=JSON.stringify(this.XZe);u.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${sa}}`);u.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${fc}}`)};this.$=wa;this.YZe=[];this.XZe=[];cb.EwaSettings.QMb()&&this.$.Sm(this.sg)}dispose(){this.$=null}oLe(wa,sa){this.YZe.push({commandName:sa,rowColCount:wa.toString()})}qad(wa,
sa){if(wa&&0!==wa.length){var fc=[];const yd={};for(const Sd of wa)Sd.ETi()&&(wa=b(Sd),""!==wa&&(yd[wa]=yd[wa]?yd[wa]+1:1));for(const Sd of Object.keys(yd))fc.push({cellType:Sd,count:yd[Sd]});0!==fc.length&&this.XZe.push({commandName:sa,complexCellTypes:fc})}}qKe(wa,sa,fc,yd){const Sd=lc.h(this.$);var Ie=Sd.ya.Jmf();let pf=[],If=!1;"UnhideColumn"!==wa&&"UnhideRow"!==wa&&"insertColumns"!==wa&&"insertRows"!==wa||(If=!0);for(const Ug of Ie){{Ie=Ug.Mg;var bg=yd,hg=fc,dg=sa,pg=If;let $g=null;if(bg&&Ie||
!cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))pg?Ie.Zf(bg)&&($g=Ie,dg?$g.top=$g.bottom-hg+1:$g.left=$g.right-hg+1):Ie.Zf(bg)||($g=Ie,dg?$g.bottom=$g.top+hg-1:$g.right=$g.left+hg-1);Ie=$g}Ie&&(Ie=Sd.ya.x5(Ie))&&(pf=[...pf,...Ie])}this.qad(pf,wa+"Cascade")}};td=Object(V.__decorate)([Object(Lc.d)(ad.Wb),Object(V.__param)(0,Object(ad.nb)())],td);Object(t.a)(td,"GridActionTelemetryManager",null,[389,2]);var zd=a(68),me=a(86),Ae=a(147),ze=a(535),Ne=a(40),hf=a(89),
rf=a(337),df=a(41),Af=a(42),Pc=a(250);class eb extends Sys.EventArgs{constructor(wa){super();this.XJ=wa}}Object(t.a)(eb,"ErrorDataArgs",Sys.EventArgs,[]);var gc=a(698),Qc=a(124),Vc=a(29);class Id{constructor(wa,sa){this.B4b=null;this.Ejc=this.aEd=!1;this.REe=this.SEe=null;this.Jeb=this.Ieb=0;this.qrg=wa;this.$Be=sa}get k$f(){return this.$Be}get WXb(){return this.SEe}get prg(){return this.REe}get z4i(){return this.nVe(this.qrg.getTime())}get oCj(){return this.nVe(this.prg.getTime())}get Vxg(){return!(this.Ejc||
void 0===window.bsqmXLSPageLoadStartTime)}get Hid(){try{return this.B4b||(this.B4b=Qc.toUtc(window.bsqmXLSPageLoadStartTime)),this.B4b}catch(wa){return null}}set Hid(wa){this.B4b=wa}jck(wa){this.Ejc||(this.SEe=wa,this.REe=Qc.toUtc(this.WXb))}MJi(wa){if(wa.Values&&(!this.Ieb||!this.Jeb))try{mc.a.EAf in wa.Values&&(this.Ieb=parseInt(wa.Values[mc.a.EAf].toString(),10));mc.a.FAf in wa.Values&&(this.Jeb=parseInt(wa.Values[mc.a.FAf].toString(),10));const sa=L.a.instance;0<this.Ieb&&(this.yQf(this.Ieb,"PageLoadFromHostClick"),
sa.fPj(this.Ieb));0<this.Jeb&&(this.yQf(this.Jeb,"PageLoadFromHostFrameCreation"),sa.gPj(this.Jeb));const fc=wa.Values[mc.a.PJi]||0,yd=wa.Values[mc.a.NJi]||wa.Values[mc.a.OJi]||0;0<yd&&sa.LOj(yd);sa.MOj(fc)}catch(sa){}}I_j(){this.qrg=this.Hid=Vc.a.Ae.yf;this.$Be=0;this.aEd=this.Ejc=!1}nVe(wa){const sa=this.Hid.getTime();return sa>=wa?0:wa-sa+this.k$f}yQf(wa,sa){if(wa){const fc=fe.b();fc.lPc("UserAction",sa,sa,Vc.a.EQd(wa),gc.EcmaDateClock.instance.appStart);fc.$lc(sa,Qc.toTimestamp(this.WXb))}}}Object(t.a)(Id,
"PageLoadPerfInfo",null,[]);var be=a(75);class Vb{constructor(wa,sa,fc){this.n8c=wa.keyCode;this.HYb(wa.ctrlKey,1);this.HYb(wa.shiftKey,2);this.HYb(wa.altKey,4);this.HYb(be.b(wa),8);this.HYb(fc,16);this.n8c=this.opb|sa<<24}get opb(){return this.n8c}get keyCode(){return this.opb&65535}HYb(wa,sa){wa&&(this.n8c=this.opb|sa<<16)}}Object(t.a)(Vb,"ShortcutSqmData",null,[]);class Gc{constructor(){this.EPd=null;this.lAh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.Fng()}evh(wa,sa,fc){0===
fc&&(fc=this.lAh[sa.toString()]);return Gc.Sxg(wa,fc)&&(wa=new Vb(wa,fc,x.a.isMac),!Af.a.Sj(this.EPd,wa.opb.toString()))?(this.EPd[wa.opb.toString()]=!0,wa):null}Fng(){this.EPd={}}static VWi(wa){return 112<=wa&&123>=wa||61440<=wa&&61451>=wa}static FYi(wa){return 17!==wa&&18!==wa&&16!==wa&&91!==wa&&93!==wa}static Sxg(wa,sa){let fc=wa.ctrlKey||wa.altKey||be.b(wa);wa=wa.keyCode;fc=Gc.VWi(wa)||fc;fc=Gc.FYi(wa)&&fc;return 0!==sa&&fc}}Object(t.a)(Gc,"UnhandledShortcutLogger",null,[]);class Bb{constructor(wa){this.lhc=
[];this.$ih=null;this.sqmManager=wa}Bbc(wa){this.lhc.push(wa)}O6(wa,sa,fc){try{if(sa)sa.endTime=fc,this.sqmManager.oKe(sa);else for(let yd=0,Sd=this.lhc.length;yd<Sd;yd++){const Ie=this.lhc[yd];wa?(Ie.endTime=Ie.startTime,Ie.ZZe=0):Ie.endTime=fc;this.sqmManager.oKe(Ie)}}catch(yd){}finally{this.lhc.length=0}}}Object(t.a)(Bb,"UserInteractionPerfInfo",null,[]);var uc=a(38),Dc=a(76),kd=a(246);class xd extends na.a{constructor(wa,sa){super();this.TCd=this.WWb=!1;this.Yxg=!0;this.Va=new Ne.a;this.CYc=!1;
this.sg=()=>{const fc=Dc.a(this.$).Ig.activityState,yd=Af.a.Sj(fc,uc.a.SJe);Af.a.Sj(fc,uc.a.xyb)||yd||this.upload()};this.$=wa;this.pIb=sa;this.ea=wa.ea;this.$.Sm(this.sg);this.aJg=new Gc;this.cZa=new Id(Db.a.X7d,wa.xa.PageGenerationMetrics.TimeToCompleteFirstFlush);this.zTc=new Bb(this)}mbd(wa){this.Va.addHandler("EREK",wa)}N3d(wa){this.Va.removeHandler("EREK",wa)}get NMh(){return this.CYc}get CQi(){return this.$.frame.MW?He.a.EQi:He.a.DQi}get workbookContext(){return this.$.workbookContext}get KZ(){xd.dsb||
(xd.dsb=this.raf());xd.zfd||(xd.zfd=!0,this.rCf());return xd.dsb}set KZ(wa){xd.dsb=wa;xd.dsb||(xd.zfd=!1)}get N$(){return hf.a(this.$.xa,3)}dispose(){this.NMh&&C.AFrameworkApplication.Rr&&C.AFrameworkApplication.Rr.disable();this.$&&this.$.ar(this.sg);this.$=this.zTc=this.cZa=this.KZ=null;super.dispose()}Cxf(wa){this.cZa.MJi(wa);this.d$i()}E9d(wa){this.setDw(9415,wa)}Bbc(wa){this.zTc.Bbc(wa)}O6(wa,sa,fc){this.zTc.O6(wa,sa,fc)}bPd(wa){this.N$&&(wa=this.$.isEditMode||wa&&this.ea.workbookContext.Options&
512?2:this.ea.ff.inEmbedView?14:1,this.setDw(8721,wa),this.vai(wa),this.CYc=!1)}OQf(){const wa=this.cZa;this.N$&&wa.Vxg&&(this.setDw(9450,wa.k$f),this.setDw(9085,wa.z4i))}PQf(wa){if(!this.WWb){this.WWb=!0;const sa=this.cZa;let fc=0;this.N$&&sa.Vxg?(sa.jck(wa),this.zTc.$ih=sa.prg,this.setDw(9086,sa.oCj),sa.Ejc=!0,fc=this.cZa.WXb.getTime()):fc=wa.getTime();df.TaskExtensions.Ca(this.pIb.value,yd=>{yd.result.sendMessage(qc.a.Uih,{[mc.a.Vih]:fc})},this.qa,3)}}oKe(wa){this.N$&&wa&&1!==wa.Tla&&this.roa(8327,
Pc.b(wa),Pc.l(wa),Pc.a(wa),2,wa.ZZe,Pc.m(wa),Pc.d(wa),Pc.e(wa))}e5d(wa,sa){wa&&wa.MessageIdHash&&this.d5d(wa.MessageIdHash,wa.MessageIdName,wa.MessageId,wa.ErrorCause?wa.ErrorCause:me.a.URc,!1,sa,wa,null)}d5d(wa,sa,fc,yd,Sd,Ie,pf,If){xd.Ucd||(xd.Ucd=!0,Ae.a.get_instance().isCompleted(13)||(Ae.a.get_instance().jx(13),u.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));wa=this.Ebb(wa);const bg=!!pf,hg={};hg.ErrorName=sa;hg.ErrorHashCode=wa.toString();hg.ErrorId=
fc.toString();hg.ErrorCause=yd.toString();hg.ErrorType=0===Ie?"ErrorDialog":"BusinessBar";hg.BusinessBarEntryName=If||"null";hg.ServerCorrelationId=bg?pf.CorrelationId:"null";hg.WebMethodName=bg?pf.WebMethodName:"null";hg.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";hg.WfeServerId=bg?pf.WfeServerId:"null";sa=gd.a.Vf(hg);this.Va.raiseEvent("EREK",new eb(hg));u.ULS.sendTraceTag(1881314,0,15,sa);this.N$&&(ka.a.Ugg(wa.toString()),this.roa(9134,wa,yd,me.a.kie),
this.ea.hy||Sd||(this.setDw(10459,wa),this.bPd(!0),this.TCd=!0,this.upload(),this.rCf()))}Ebb(wa){return 5439488|(wa>>>16^wa&65535)&65535}xPd(wa,sa,fc){wa=this.aJg.evh(wa,sa,fc);this.N$&&wa&&this.roa(11007,wa.opb)}upload(){!this.N$||!this.WWb&&!this.TCd||x.a.hj&&C.AFrameworkApplication.Oi?x.a.hj&&C.AFrameworkApplication.Oi&&u.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.KZ.U1b(),this.CYc=!0);C.AFrameworkApplication.Rr=this.KZ=null;this.cZa.I_j();this.WWb=!1;C.AFrameworkApplication.Rr=
this.KZ=this.raf();this.aJg.Fng()}d$i(){const wa=this.cZa;if(this.N$&&!wa.aEd){var sa=wa.Ieb,fc=wa.Jeb,yd=wa.WXb.getTime();C.AFrameworkApplication.iS=wa.WXb;sa&&this.setDw(10324,sa>yd?0:yd-sa);fc&&this.setDw(10325,fc>yd?0:yd-fc);wa.aEd=!0}}roa(wa,...sa){this.N$&&this.KZ.roa(wa,...sa)}setDw(wa,sa){this.N$&&this.KZ.setDw(wa,sa)}raf(){rf.a.Qaf(this.$.xa);return C.AFrameworkApplication.Rr}vai(wa){let sa;try{sa=Object(ba.a)(Object,gd.a.qm(C.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(fc){u.ULS.sendTraceTag(537151311,
0,15,`Couldn't parse SessionStartInfoJson. Message: ${fc.message}`);return}if(sa){let fc=Object(ba.a)(String,sa.ApplicationModeExtended),yd=Object(ba.a)(String,sa.ApplicationMode);fc&&yd&&(fc=fc.toUpperCase(),2!==wa&&16!==wa||"VIEW"!==fc&&"UNIFIED"!==fc?1!==wa||"EDIT"!==fc&&"UNIFIED"!==fc||(fc="VIEW",yd="View"):(fc="EDIT",yd="Edit"),sa.ApplicationModeExtended=fc,sa.ApplicationMode=yd,C.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=gd.a.Vf(sa))}}rCf(){const wa=this.$.xa;this.KZ.dT=!0;this.KZ.c3a(wa.BWsaStartTime);
this.setDw(59,83);this.WWb=!1;if(this.N$){const sa=wa.DocumentHostInfo;this.uLh();this.setDw(8491,this.$.RI);this.setDw(9236,wa.RequestedUILcid);this.setDw(8473,wa.WacHostId);this.setDw(9902,Pc.c(sa.ClusterId));cb.EwaSettings.Ia(398)?this.KZ.lug(""):this.KZ.lug(wa.FlightHolder?wa.FlightHolder.FlightId:"");this.E9d(this.ea.ff.inEmbedView?1:0);this.TCd=!1;this.setDw(9104,Pc.c(sa.FileSourceId));this.setDw(10309,this.CQi);this.qek();C.AFrameworkApplication.Oe.D2d(ze.a.getInstance(!1))}}qek(){L.a.instance.$Mi(this.KZ);
if(this.Yxg){const wa=L.a.instance;wa.GOj();wa.aPj();wa.YOj();wa.XOj();wa.ROj();this.Yxg=!1}}uLh(){this.createStream(8327,1,kd.a.DOh,kd.a.Eab);this.createStream(9134,1,3,kd.a.Eab);this.createStream(11007,1,1,kd.a.Eab)}createStream(wa,sa,fc,yd){this.KZ.createStream(wa,sa,fc,yd)}}xd.dsb=null;xd.zfd=!1;xd.Ucd=!1;Object(t.a)(xd,"SqmManager",na.a,[413,414]);var Pb=a(825);class Ec{constructor(wa,sa){this.entryTypes=null;this.buffered=!1;this.entryTypes=wa;this.buffered=void 0===sa?!1:sa}}Object(t.a)(Ec,
"PerformanceObserverInit",null,[]);class ed extends Sys.EventArgs{constructor(wa){super();this.Taf=wa}}Object(t.a)(ed,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Td extends Sys.EventArgs{constructor(wa){super();this.Guc=wa}}Object(t.a)(Td,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class Rd{constructor(wa){this.Va=new Ne.a;this.W0c=!1;this.el=()=>{if(x.a.Br){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.pbj)).observe(new Ec([He.a.IPd])),
this.W0c=!0)}catch(sa){this.W0c=!1,u.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${sa}`)}this.Va.raiseEvent("ltpoiek",new Td(this.Guc))}};this.pbj=sa=>{this.Va.raiseEvent("ltoek",new ed(sa))};this.$=wa;this.$.ea.ei?this.el(this,Sys.EventArgs.Empty):this.$.ea.zm(this.el)}get Guc(){return this.W0c}MMe(wa){this.Va.addHandler("ltoek",wa)}LVj(wa){this.Va.removeHandler("ltoek",wa)}Ieh(wa){this.Va.addHandler("ltpoiek",wa)}MVj(wa){this.Va.removeHandler("ltpoiek",wa)}dispose(){this.$.ea.cq(this.el);
ub.a.Sa(this.Va);this.$=this.Va=null}}Object(t.a)(Rd,"LongTaskPerformanceObserver",null,[2]);var Ke=a(168);class $d{constructor(wa,sa){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===wa?0:wa;this.longTaskDuration=void 0===sa?0:sa}get JPd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}z3i(wa){return 100*this.JPd>wa}$bh(wa){this.HLe(wa.longTaskDuration);this.abd(wa.activeSessionDuration)}HLe(wa){this.longTaskDuration+=wa}abd(wa){this.activeSessionDuration+=
wa}}Object(t.a)($d,"LongTaskPerformanceData",null,[]);class we{constructor(wa,sa,fc,yd,Sd){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=wa;this.entireSessionData=sa;this.worstWindowData=fc;this.postBootWindowData=yd;this.maxUsersCount=Sd}get reportName(){return"LongTaskPerformance"}static get MWh(){return new we(!1,new $d,new $d,new $d,0)}}Object(t.a)(we,"LongTaskPerformanceDataStatistics",null,[480]);class bf extends Sys.EventArgs{constructor(wa){super();
this.KPd=wa}}Object(t.a)(bf,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var $e=a(404),$a=a(309);class Ia{constructor(wa,sa){this.Va=new Ne.a;this.VWa=this.Cca=this.pY=this.ph=null;this.$Mf=this.Zbe=this.Jyc=!1;this.wXa=null;this.maxUsersCount=0;this.iEc=(fc,yd)=>{fc=yd.Taf.getEntriesByType(He.a.IPd);for(const Sd of fc)this.ph.jI(Sd.duration)||C.AFrameworkApplication.zWa||(this.pY.HLe(Sd.duration),this.Va.raiseEvent("lttek",new bf(Sd)),fc={},fc.LongTaskDuration=Sd.duration,fc.LongTaskStartTime=Sd.startTime,
u.ULS.sendTraceTag(187982418,0,50,JSON.stringify(fc)))};this.el=()=>{this.Zbe=!0;this.P_b()};this.kA=(fc,yd)=>{yd&&(this.maxUsersCount=Math.max(this.maxUsersCount,yd.dNg));this.Cca.maxUsersCount=this.maxUsersCount};this.Xg=()=>{this.P_b()};this.sg=()=>{this.S_b()};this.V3f=(fc,yd)=>{yd.Guc&&this.P_b()};this.uRf=()=>{this.pY.abd(Qc.getElapsedMilliseconds(this.VWa,Vc.a.Ae.yf));this.fee(!0);var fc=!1;this.Cca.postBootWindowData.activeSessionDuration?(!this.$Mf&&cb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(fe.b().umg(2),P.Health.instance.recordKpiUsage($a.a.longJsTask,0,$e.a.A4i,null),this.$Mf=!0),!this.Cca.isVetoSession&&this.pY.z3i(this.gOg)&&(this.Cca.isVetoSession=!0,cb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(fe.b().vmg(2,this.nbj),P.Health.instance.recordKpiFailure($a.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.Cca.worstWindowData.JPd<=this.pY.JPd&&(this.Cca.worstWindowData=this.pY),this.Cca.entireSessionData.$bh(this.pY)):(this.Cca.postBootWindowData=
new $d(this.pY.activeSessionDuration,this.pY.longTaskDuration),fc=!0);const yd={};yd.LastWindowScore=this.pY;yd.postBootWindow=fc;yd.CoauthersNumber=this.$.ea.Zo.length;fc=JSON.stringify(yd);u.ULS.sendTraceTag(20779346,0,50,fc);this.pY=new $d};this.aDc=()=>{this.ph.tk||C.AFrameworkApplication.zWa||this.fee(!1)};this.$Cc=()=>{this.pY.abd(Qc.getElapsedMilliseconds(this.VWa,Vc.a.Ae.yf));this.VWa=null;this.wXa.cancel()};this.$=wa;this.gOg=wa.xa.LongTaskPerformanceVetoThreshold;this.nbj="PercentageOver_"+
this.gOg.toString();this.LPd=wa.xa.LongTaskPerformanceWindowDurationInMs;this.jT=sa;cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Lc.a.resolve(ad.db).then(fc=>{this.ph=fc;this.P_b()}):this.$.ja.Ne(291,fc=>{this.ph=fc;this.P_b()});this.$.ea.ei?this.el(this,Sys.EventArgs.Empty):this.$.ea.zm(this.el);this.jT.Ieh(this.V3f);this.$.Go(this.Xg);this.$.Sm(this.sg)}Jeh(wa){this.Va.addHandler("lttek",wa)}NVj(wa){this.Va.removeHandler("lttek",
wa)}dispose(){this.Zbe=!1;this.S_b();this.$.Hp(this.Xg);this.$.ar(this.sg);this.jT.MVj(this.V3f);ub.a.Sa(this.wXa);this.jT=this.$=this.wXa=null;void 0!==this.ph&&null!==this.ph&&ub.a.Sa(this.ph)}P_b(){void 0===this.ph||null===this.ph?u.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.jT.Guc?this.Jyc?u.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.Zbe?(this.Jyc=!0,this.Cca=we.MWh,this.pY=new $d,this.$.ea.r$(this.kA),this.maxUsersCount=this.$.ea.Zo.length,this.jT.MMe(this.iEc),this.ph.Y3(this.$Cc),this.ph.rZ(this.aDc),C.AFrameworkApplication.gbd(this.$Cc),C.AFrameworkApplication.hbd(this.aDc),this.wXa=rb.a.instance.create(this.uRf,this.LPd,bc.a.DQf,!1),se.a(this.$).oZ(this.Cca),this.ph.tk||C.AFrameworkApplication.zWa||this.fee(!0),u.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):u.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):u.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}S_b(){this.Jyc&&(this.Jyc=!1,this.$.ea.cq(this.el),this.jT.LVj(this.iEc),this.$.ea.P1(this.kA),void 0!==this.ph&&null!==this.ph&&(this.ph.C_a(this.$Cc),this.ph.sIa(this.aDc)),C.AFrameworkApplication.bkg(this.$Cc),
C.AFrameworkApplication.ckg(this.aDc),this.wXa.cancel(),this.VWa=this.pY=this.Cca=null,this.maxUsersCount=0)}fee(wa){wa||void 0===this.VWa||null===this.VWa?(this.VWa=Vc.a.Ae.yf,this.wXa=Ke.AsyncMethodContext.QDb(this.uRf,wa?this.LPd:this.LPd-this.pY.activeSessionDuration,bc.a.DQf,this.wXa)):u.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(t.a)(Ia,
"LongTaskPerformanceTracker",null,[2]);var gb=a(27);class Nb extends Ne.a{constructor(wa,sa){super();this.statusBarManager=this.ph=null;this.W3f=(fc,yd)=>{yd.KPd&&yd.KPd.duration>=this.qbj&&(this.MRf++,this.BNf=yd.KPd.duration)};this.$=wa;this.$.ja.Ne(29,fc=>{this.statusBarManager=fc;fc.YL(this)});cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Lc.a.resolve(ad.db).then(fc=>{this.ph=fc}):this.$.ja.Ne(291,fc=>{this.ph=fc});this.BNf=this.MRf=
0;this.qbj=wa.xa.LongTaskThresholdMs;this.sib=sa;this.sib.Jeh(this.W3f)}$t(wa){this.addHandler("LTSCEK",wa)}Eu(wa){this.removeHandler("LTSCEK",wa)}gA(){this.wq("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Ov(wa,sa){if("QueryLongTasksCount"!==wa)return!1;this.DFi(sa);return!0}wq(){return cb.EwaSettings.Ia(505)}dispose(){this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null);this.sib.NVj(this.W3f);super.dispose()}DFi(wa){const sa=`Long Tasks: ${this.MRf} | Last Task Duration: ${Math.round(this.BNf)}ms`;
gb.a.An(this.$)?(wa.LabelText=sa,wa.Visible=!0):wa.Value=sa}}Object(t.a)(Nb,"LongTasksStatusBarManager",Ne.a,[2,256,169]);var ec=a(12);class Bc{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(t.a)(Bc,"NetworkInfoData",null,[]);class Wc extends Ne.a{constructor(wa){super();this.statusBarManager=null;this.Kad=!1;this.tXf=()=>{this.raiseEvent("NetworkInformation")};this.$=wa;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.vN=this.Phe("connection")||this.Phe("mozConnection")||this.Phe("webkitConnection"))&&cb.EwaSettings.Ia(410)&&wa.ja.Ne(29,sa=>{this.statusBarManager=sa;sa.YL(this);this.vN.addEventListener("change",this.tXf);this.Kad=!0})}$t(wa){this.addHandler("NetworkInformation",wa)}Eu(wa){this.removeHandler("NetworkInformation",wa)}OTa(){return this.vN?Object(fa.a)(new Bc,{bandwidthMps:this.vN.downlink,rttMs:this.vN.rtt,connectionType:this.vN.type,effectiveConnection:this.vN.effectiveType,downlinkMaxMps:this.vN.downlinkMax}):
null}Ov(wa,sa){if("QueryNetworkInformation"!==wa)return!1;this.EFi(sa);return!0}wq(){return this.Kad}dispose(){this.Kad&&(this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null),this.vN&&this.vN.removeEventListener("change",this.tXf));this.$=null;super.dispose()}Phe(wa){return ec.HelperMethods.Cr(window.navigator,wa)?window.navigator[wa]:null}EFi(wa){const sa="Network: "+this.vN.downlink.toString()+" Mbps, "+this.vN.rtt.toString()+" ms";gb.a.An(this.$)?(wa.LabelText=sa,
wa.Visible=!0):wa.Value=sa}}Object(t.a)(Wc,"NetworkInformationManager",Ne.a,[256,169]);var od=a(200);class G{constructor(wa,sa,fc,yd,Sd,Ie,pf,If,bg,hg){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===wa?"":wa;this.startTime=void 0===sa?-1:sa;this.startToNextFrame=void 0===fc?-1:fc;this.startToResponseRenderEnd=
void 0===yd?-1:yd;this.wasHidden=void 0===Sd?!1:Sd;this.isUserOperation=void 0===Ie?!0:Ie;this.isGroupBreaking=void 0===pf?!0:pf;this.operationThatLedToLogging=void 0===bg?"":bg;this.startToOperationThatLedToLogging=void 0===hg?-1:hg;this.isPartOfGroup=void 0===If?!1:If}}Object(t.a)(G,"OperationStatisticsData",null,[]);var pa=a(88);class Ra{constructor(){this.operationsGroups=null;this.nMi()}isGroup(wa,sa,fc){const yd=new od.a;yd.addRange(wa);yd.addRange(sa);for(let Sd=0;Sd<this.operationsGroups.count;Sd++)if(this.k_i(this.operationsGroups.ka(Sd),
yd,fc))return u.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${fc}' is part of a group ( operationsList: ${this.U9f(wa)} , frameOperationsList: ${this.U9f(sa)})`),!0;u.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${fc}' is NOT part of a group.`);return!1}k_i(wa,sa,fc){let yd=0;for(let Sd=0;Sd<sa.count;Sd++)if(sa.ka(Sd).isGroupBreaking){if(wa.count<=yd||!hb.a.equals(sa.ka(Sd).name,wa.ka(yd),!0))return!1;yd++}return wa.count>yd&&hb.a.equals(fc,wa.ka(yd),
!0)}U9f(wa){wa=pa.select(wa,sa=>sa.name);return`[${pa.toArray(wa).join(", ")}]`}nMi(){this.operationsGroups=new od.a;this.K7a(new od.a(["Paste","SelectingRange_unknown"]));this.K7a(new od.a(["AutoSum","SelectingRange_unknown"]));this.K7a(new od.a(["ChangeSheetDirection","ActiveItemChanged"]));this.K7a(new od.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.K7a(new od.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.K7a(new od.a(["EditBoxEndEdit",
"SetCell","SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}K7a(wa){this.operationsGroups.add(wa)}}Object(t.a)(Ra,"OperationsGroupDetector",null,[]);var yb=a(24);class ic{constructor(wa,sa,fc,yd){this.framePerformanceTracker=this.KWb=this.o7=this.s8=null;this.QYj=()=>{this.Qcd=-1;const Sd=ec.HelperMethods.Ze();this.lGk(Sd);this.dYb&&(u.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.L1b(this.MJ,
Sd),this.dYb=!1);this.Vwc&&(this.L1b(this.LK,Sd),this.dYb||this.L1b(this.MJ,Sd));window.setTimeout(this.b$i,0)};this.b$i=()=>{var Sd=[];const Ie=this.$.xa.OperationToPrevOperationThreshold;for(var pf=0;pf<this.MJ.count;pf++){var If=this.MJ.ka(pf);pf<Ie&&Sd.push(If);this.LK.add(If)}lc.h(this.$)&&lc.h(this.$).ya?((pf=this.sessionStatisticsManager.fxd(0))?(If=JSON.stringify(this.kQb),Sd=JSON.stringify(Sd),u.ULS.sendTraceTag(237798547,1,50,`DOM count: (${pf.ffj}, ${pf.Nmh}, ${pf.Sdj}), long tasks: ${If}, operations count: ${this.MJ.count}, operations: ${Sd}`)):
u.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.MJ.count>Ie&&u.ULS.sendTraceTag(537153875,1,50,`More than ${Ie} operations are in the operationsList. count: ${this.MJ.count}`),this.MJ.clear(),this.kQb.clear()):u.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.iEc=(Sd,Ie)=>{this.obj(Ie.Taf)};this.$=wa;this.RN=sa;this.ol=this.ol||Vc.a.Ae;this.LK=new od.a;this.MJ=new od.a;this.Qcd=this.yhb=-1;this.kQb=new od.a;this.iBj=new Ra;
this.dYb=this.Vwc=!1;this.NMi();this.pMi();this.oMi();this.sessionStatisticsManager=fc;this.jT=yd;this.jT.MMe(this.iEc);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveXlfpsTag",!1)||this.$.ja.Ne(263,Sd=>{this.framePerformanceTracker=Sd})}TWb(wa,sa){var fc=ec.HelperMethods.Ze();const yd=this.iBj.isGroup(this.LK,this.MJ,wa);(this.Vwc=this.IZi(wa))&&0<this.LK.count&&!yd&&(this.jFk(),this.iFk(wa,fc),this.abi());this.yhb=-1;if(lc.h(this.$)&&lc.h(this.$).ya){var Sd=!this.s8.contains(wa);
fc=new G(wa,fc,void 0,void 0,void 0,Sd,this.Vwc,yd);this.MJ.add(fc);this.framePerformanceTracker&&this.framePerformanceTracker.Upk(fc.name,sa);!this.dYb&&this.KWb.contains(wa)&&(this.dYb=!0);-1===this.Qcd&&(this.Qcd=window.requestAnimationFrame(this.QYj))}else u.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}PJc(){this.yhb=ec.HelperMethods.Ze()}WJc(){this.LK.count||this.MJ.count?(this.L1b(this.MJ,this.yhb),this.L1b(this.LK,this.yhb)):u.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistent when no operations in the list. Last block render time: ${this.yhb}`);
this.yhb=-1}IZi(wa){return!this.o7.contains(wa)&&!wa.includes("Menu")&&!wa.includes("TellMe")}abi(){for(let wa=0;wa<this.LK.count;wa++){const sa=this.LK.ka(wa);this.RN.S8g(sa);this.H$i(sa)}this.LK.clear()}lGk(wa){for(let sa=0;sa<this.MJ.count;sa++)this.MJ.ka(sa).startToNextFrame=this.tzd(this.MJ.ka(sa).startTime,wa),this.MJ.ka(sa).wasHidden=Pb.a.jI(this.MJ.ka(sa).startToNextFrame)}iFk(wa,sa){for(let fc=0;fc<this.LK.count;fc++)-1===this.LK.ka(fc).startToResponseRenderEnd&&(this.LK.ka(fc).operationThatLedToLogging=
wa,this.LK.ka(fc).startToOperationThatLedToLogging=this.tzd(this.LK.ka(fc).startTime,sa))}jFk(){var wa=!1;for(const sa of this.LK)if(sa.isPartOfGroup){wa=!0;break}if(wa)for(wa=0;wa<this.LK.count;wa++)this.LK.ka(wa).isPartOfGroup=this.LK.ka(wa).isGroupBreaking}L1b(wa,sa){for(let fc=0;fc<wa.count;fc++)wa.ka(fc).startToResponseRenderEnd=this.tzd(wa.ka(fc).startTime,sa),wa.ka(fc).wasHidden=Pb.a.jI(wa.ka(fc).startToResponseRenderEnd)}H$i(wa){wa=JSON.stringify(wa);u.ULS.sendTraceTag(2020372336,1,50,`${wa}`)}tzd(wa,
sa){return-1===wa?-1:-1===sa?-2:sa-wa}obj(wa){wa=wa.getEntriesByType(He.a.IPd);for(let sa=0;sa<wa.length;sa++)if(30>this.kQb.count)if(this.MJ.count)this.kQb.add(this.VDj(wa[sa]));else{const fc=wa[sa];if(null===fc||void 0===fc?0:fc.attribution)void 0!==fc.attribution.containerSrc&&null!==fc.attribution.containerSrc&&(fc.attribution.containerSrc=""),void 0!==fc.attribution.containerId&&null!==fc.attribution.containerId&&(fc.attribution.containerId=""),void 0!==fc.attribution.containerName&&null!==fc.attribution.containerName&&
(fc.attribution.containerName="");u.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{u.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${wa.length} First long task: ${this.kQb.ka(0)}`);break}}VDj(wa){return`name:${wa.name}, startTime:${wa.startTime}, duration:${wa.duration}`}NMi(){this.s8||(this.s8=new ke.a(U.a.Ki()),this.s8.add("ActiveItemChanged"),this.s8.add(fe.b().hm(-1398645260)),
this.s8.add(fe.b().hm(722290388)),this.s8.add(fe.b().hm(974713501)),this.s8.add(yb.a.mW(yb.a.bhc)),this.s8.add(yb.a.mW(yb.a.ahc)),this.s8.add(yb.a.mW(yb.a.JCb)),this.s8.add(yb.a.mW(yb.a.ceg)),this.s8.add(yb.a.mW(yb.a.lla)))}pMi(){this.o7||(this.o7=new ke.a(U.a.Ki()),this.o7.add("PromptEditInBrowser"),this.o7.add(fe.b().hm(-1398645260)),this.o7.add(fe.b().hm(722290388)),this.o7.add(fe.b().hm(974713501)),this.o7.add(yb.a.mW(yb.a.bhc)),this.o7.add(yb.a.mW(yb.a.ahc)),this.o7.add(yb.a.mW(yb.a.JCb)),this.o7.add(yb.a.mW(yb.a.ceg)),
this.o7.add(yb.a.mW(yb.a.lla)))}oMi(){this.KWb||(this.KWb=new ke.a(U.a.Ki()),this.KWb.add("SelectingRange_keyboard"),this.KWb.add("SelectingRange_mouse"))}}Object(t.a)(ic,"OperationStatistics",null,[]);var bd=a(619);class Nd{constructor(wa,sa){this.messageIdName=null;this.errorCause=0;this.messageIdName=wa;this.errorCause=sa}}Object(t.a)(Nd,"RequestError",null,[]);class ce{constructor(wa,sa,fc,yd,Sd,Ie,pf,If,bg,hg,dg,pg,Ug,$g,ih,Zf,gh){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=
this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=
0;this.requestName=wa;this.isUserTriggeredRequest=ce.Xpi(wa);this.isFullyLoggedKPIRequest=ce.Npi(wa);this.isPromotedUTRRequest=ce.Ppi(wa);this.requestDuration=sa;this.totalOperationDuration=fc;this.requestTimeInQueue=yd;this.requestInvokedTime=Sd;this.ecsOperationDuration=Ie.EcsOperationDuration;this.EcsRequestDuration=Ie.EcsRequestDuration;this.WfeRequestDuration=Ie.WfeRequestDuration;this.TimeFromLastEcsFreeze=Ie.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Ie.DuringLoadOnDemand;this.correlationID=
pf;this.errors=ce.ECh(If);this.httpStatus=bg;this.requestResourceTiming=hg;this.communicationErrorRetryCount=dg;this.successfulCall=pg;this.isDocumentHidden=Ug;this.coauthorsCount=$g;this.responseSize=ih;this.networkInfoData=Zf;this.responseToCallbackTime=gh}static ECh(wa){if(!wa)return[];const sa=[];for(const fc of wa)sa.push(new Nd(fc.MessageIdName,fc.ErrorCause));return sa}static Xpi(wa){return!ce.iij.contains(wa)}static ssi(){const wa=new ke.a(U.a.Ki());wa.add("CheckPersistedContentUpdate");wa.add("GetContentBundle");
wa.add("GetSessionStatus");wa.add("GetStatusBarAggregates");wa.add("PollSessionStatus");wa.add("UpdatePresenceUsers");wa.add("UploadLatencyTelemetry");return wa}static Npi(wa){return ce.cdi.contains(wa)}static Ppi(wa){return ce.CJj.contains(wa)}static joi(){const wa=new ke.a(U.a.Ki());wa.add("SetRichTextCell");wa.add("Copy");wa.add("FormatCells");wa.add("PasteRange");wa.add("FindCell");wa.add("ApplyToRangesV2");wa.add("ResizeRowsColumns");wa.add("InsertDeleteCells");wa.add("FillRange");wa.add("PasteHtmlContent");
wa.add("ApplyFilter");wa.add("PasteString");wa.add("Undo");wa.add("LineageUpdateView");wa.add("FindAll");wa.add("ApplyHyperlink");wa.add("AutoFit");wa.add("GetPrintSettings");wa.add("GetEdgeCell");wa.add("Paste");wa.add("MoveAndResizeFloatingObject");wa.add("FindRange");wa.add("SetCustomFilter");wa.add("RenameSheet");wa.add("ApplyThreadedComment");wa.add("SortFilterColumn");wa.add("InsertCopiedCutCellsV2");wa.add("InsertSheet");wa.add("ToggleAutoFilter");wa.add("ReorderSheets");wa.add("SetOutlineLevel");
wa.add("RefreshAll");wa.add("LineageOpenPaneOrChangeFilter");wa.add("ApplySlicerSelection");wa.add("GetCardViewCardByCell");wa.add("AutoSum");wa.add("LineageClosePane");wa.add("Sort");wa.add("ClearAutoFilter");wa.add("DeleteSheet");wa.add("Redo");cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(wa.add("RemovePageBreak"),wa.add("InsertPageBreak"),wa.add("SetPrintArea"),wa.add("ClearPrintArea"));wa.add("PasteStringV2");return wa}static Qpi(){const wa=new ke.a(U.a.Ki());
wa.add("DeleteConditionalFormattingRules");wa.add("GetConditionalFormattingRules");wa.add("AddConditionalFormattingRule");wa.add("QuickEditConditionalFormattingRule");wa.add("GetPrintSettings");wa.add("UpdatePresenceUsers");wa.add("GetThemeInfo");wa.add("InsertCopiedCutCellsV2");wa.add("PasteRange");wa.add("FillRange");wa.add("InsertCopiedCutCellsCrossSession");cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(wa.add("LineageOpenPaneOrChangeFilter"),wa.add("LineageUpdateView"),
wa.add("LineageRefreshView"),wa.add("LineageLoadMore"));wa.add("PasteStringV2");return wa}}ce.iij=ce.ssi();ce.cdi=ce.joi();ce.CJj=ce.Qpi();Object(t.a)(ce,"RequestStatisticsData",null,[]);class le{constructor(wa,sa,fc){this.$=wa;this.RN=sa;this.Dta=fc}$Jc(wa,sa,fc,yd,Sd,Ie,pf,If,bg,hg,dg,pg,Ug,$g){pg=bd.a(pg);wa=new ce(wa,sa,fc,yd,Sd,Ie,pf,If,bg,pg,hg,dg,Pb.a.jI(sa),this.Nyd(null),Ug,this.Dta.OTa(),$g);this.J5d(wa)}uk(wa,sa){wa="UnknownMethodName";var fc=-1;void 0!==sa.context&&null!==sa.context&&
(wa=sa.context.methodName,fc=sa.context.communicationErrorRetryCount);let yd,Sd={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};sa.Jg?(yd=sa.Jg.Errors||[],this.RN.HYj(sa.Jg.EditSessionIsDirty),void 0!==sa.Jg.RequestTelemetryData&&null!==sa.Jg.RequestTelemetryData&&(Sd=sa.Jg.RequestTelemetryData)):yd=[];const Ie=sa.duration,pf=bd.a(sa.url);wa=new ce(wa,Ie,sa.totalOperationDuration,sa.kge,sa.sK,Sd,sa.m9d,yd,sa.httpStatus,pf,fc,!0,
Pb.a.jI(Ie),this.Nyd(sa.Jg),sa.responseSize,this.Dta.OTa(),sa.responseToCallbackTime);this.J5d(wa);wa.requestResourceTiming&&(fc=wa.requestResourceTiming.totalDuration-wa.WfeRequestDuration,fc>=this.$.xa.LongNetworkTimeTelemetryThresholdInMilliseconds&&sa.responseHeaders&&u.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${wa.requestName}, requestDuration = ${wa.requestDuration}, networkTime = ${fc},  ServerCorrelation = ${wa.correlationID}, msEdgeHeader = ${He.a.lRb in
sa.responseHeaders?sa.responseHeaders[He.a.lRb]:""}, backendDatacenter = ${He.a.aUd in sa.responseHeaders?sa.responseHeaders[He.a.aUd]:""}, proxyDatacenter = ${He.a.cUd in sa.responseHeaders?sa.responseHeaders[He.a.cUd]:""}`))}Fp(wa,sa){wa="UnknownMethodName";let fc=-1;void 0!==sa.context&&null!==sa.context&&(wa=sa.context.methodName,fc=sa.context.communicationErrorRetryCount);const yd=sa.duration,Sd=bd.a(sa.url);sa=new ce(wa,yd,sa.totalOperationDuration,sa.kge,sa.sK,{EcsOperationDuration:-1,EcsRequestDuration:-1,
WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},sa.m9d,sa.errors||[],sa.httpStatus,Sd,fc,!1,Pb.a.jI(yd),this.Nyd(null),-1,this.Dta.OTa(),sa.responseToCallbackTime);this.J5d(sa)}J5d(wa){this.RN.Lhh(wa);if(cb.EwaSettings.Ia(212)){var sa=wa.requestName;if(sa!==He.a.YDa&&"SetCell"!==sa&&"FindRange"!==sa&&"FindAll"!==sa&&"FindCell"!==sa)return}sa=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===wa.requestName||null===wa.requestName)&&wa.isPromotedUTRRequest;
le.IUh(wa,sa);this.RN.T8g(wa)}Nyd(wa){var sa;if(null===(sa=null===wa||void 0===wa?void 0:wa.CollaborationResult)||void 0===sa?0:sa.Users)return wa.CollaborationResult.Users.length;wa=this.$.ea.Zo.length;return 0<wa?wa:1}static IUh(wa,sa){sa?fe.b().TLc(388829456,0,15,wa):(sa=Sys.Serialization.JavaScriptSerializer.serialize(wa),u.ULS.sendTraceTag(388829456,0,50,sa));if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==wa.requestName&&null!==wa.requestName&&wa.isFullyLoggedKPIRequest){sa=
new Map;sa.set("isUserTriggeredRequest",wa.isUserTriggeredRequest.toString());sa.set("requestDuration",wa.requestDuration.toString());sa.set("totalOperationDuration",wa.totalOperationDuration.toString());sa.set("requestTimeInQueue",wa.requestTimeInQueue.toString());sa.set("requestInvokedTime",wa.requestInvokedTime.toString());sa.set("ecsOperationDuration",wa.ecsOperationDuration.toString());sa.set("ecsRequestDuration",wa.EcsRequestDuration.toString());sa.set("wfeRequestDuration",wa.WfeRequestDuration.toString());
sa.set("timeFromLastEcsFreeze",wa.TimeFromLastEcsFreeze.toString());sa.set("duringLoadOnDemand",wa.DuringLoadOnDemand.toString());sa.set("correlationID",wa.correlationID);sa.set("errors",wa.errors.toString());sa.set("httpStatus",wa.httpStatus.toString());if(wa.networkInfoData){var fc=wa.networkInfoData;sa.set("networkInfoData_bandwidthMps",void 0===fc.bandwidthMps||null===fc.bandwidthMps?"NA":fc.bandwidthMps.toString());sa.set("networkInfoData_rttMs",void 0===fc.rttMs||null===fc.rttMs?"NA":fc.rttMs.toString());
sa.set("networkInfoData_effectiveConnection",void 0===fc.effectiveConnection||null===fc.effectiveConnection?"NA":fc.effectiveConnection)}wa.requestResourceTiming&&(fc=wa.requestResourceTiming,sa.set("requestResourceTiming_fetchStart",void 0===fc.downloadDuration||null===fc.downloadDuration?"NA":fc.downloadDuration.toString()));sa.set("communicationErrorRetryCount",wa.communicationErrorRetryCount.toString());sa.set("successfulCall",wa.successfulCall.toString());sa.set("isDocumentHidden",wa.isDocumentHidden.toString());
sa.set("coauthorsCount",wa.coauthorsCount.toString());sa.set("responseSize",wa.responseSize.toString());sa.set("responseToCallbackTime",wa.responseToCallbackTime.toString());fe.b().XJc(wa.requestName,wa.successfulCall,sa)}}}Object(t.a)(le,"RequestStatistics",null,[]);var Le=a(224),Ve=a(59),Ub=a(281);class Mc{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=
null}}Object(t.a)(Mc,"OperationTypeStatisticsData",null,[]);class Kd{constructor(wa,sa){this.data=new Mc;this.data.operationName=wa;this.data.isUserOperation=sa;this.data.totalCount=0;this.pCg=[];this.qCg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Gg(wa){this.data.totalCount<Kd.kpd&&(this.pCg.push(wa.startToNextFrame),this.qCg.push(wa.startToResponseRenderEnd));this.data.totalCount++;
this.data.longestStartToNextFrame<wa.startToNextFrame&&(this.data.longestStartToNextFrame=wa.startToNextFrame);this.data.longestStartToResponse<wa.startToResponseRenderEnd&&(this.data.longestStartToResponse=wa.startToResponseRenderEnd)}gtd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.psf(this.pCg),this.data.startToResponsePercentiles=this.psf(this.qCg))}psf(wa){wa.sort(ec.HelperMethods.EK);let sa;sa="("+Pb.a.jra(wa,25).toString();sa=sa+", "+Pb.a.jra(wa,50).toString();sa=sa+
", "+Pb.a.jra(wa,75).toString();sa=sa+", "+Pb.a.jra(wa,95).toString();return sa+")"}}Kd.kpd=1E3;Object(t.a)(Kd,"OperationTypeStatistics",null,[]);class je{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=
this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(t.a)(je,"RequestTypeStatisticsData",null,[]);class qe{constructor(wa){this.data=new je;this.data.requestName=wa;this.data.totalCount=0;this.Pmb=[];this.khe=this.che=this.dhe=this.hhe=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=
-1;this.data.requestDurationPercentile95=-1}qZj(wa){this.data.totalCount<qe.kpd&&this.Pmb.push(wa.requestDuration);this.data.totalCount++;this.hhe+=wa.requestDuration;this.dhe+=qe.Qvd(wa.ecsOperationDuration);this.che+=qe.Qvd(wa.EcsRequestDuration);this.khe+=qe.Qvd(wa.WfeRequestDuration);0<wa.TimeFromLastEcsFreeze&&wa.TimeFromLastEcsFreeze<qe.Qci&&this.data.callsDuringEcsFreeze++;wa.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;wa.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;
if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<wa.requestDuration)this.data.longestRequest=wa}gtd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.hhe/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.dhe/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.che/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.khe/this.data.successfulCalls)):
(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Pmb.sort(ec.HelperMethods.EK),this.data.requestDurationPercentile25=Pb.a.jra(this.Pmb,25),this.data.requestDurationPercentile50=Pb.a.jra(this.Pmb,50),this.data.requestDurationPercentile75=Pb.a.jra(this.Pmb,75),this.data.requestDurationPercentile95=Pb.a.jra(this.Pmb,95))}static Qvd(wa){return 0>wa?0:wa}}qe.Qci=3E3;qe.kpd=1E3;Object(t.a)(qe,"RequestTypeStatistics",null,[]);class Fe{constructor(wa,
sa,fc,yd,Sd,Ie,pf,If){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=wa;this.ocsCapable=sa;this.endedBySplashScreen=fc;this.dirtySessionOnLastRecordedRequest=yd;this.loadOnDemandCount=Sd;this.maxCoauthorsCount=Ie;this.everConnectedToOcs=pf;wa=[];for(const bg in If)sa=If[bg],sa.gtd(),wa.push(sa.data);this.requests=wa}}Object(t.a)(Fe,"SessionStatisticsData",
null,[]);class We{constructor(wa){this.dirtySessionOnLastRecordedRequest=this.$de=!1;this.hPf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=wa;this.gyb={};this.fyb={};this.Wmd={}}sg(){var wa=this.rMh();if(Db.a.xla()){var sa={};sa.xlendJson=wa;this.$.xva(Le.a.ZLk,sa,!1)}else Ve.O(this.$.oa.ua,wa,null,null,null,null,null);wa=this.sMh();Db.a.xla()?(sa={},sa.xlenoJson=wa,this.$.xva(Le.a.$Lk,sa,!1)):u.ULS.sendTraceTag(388776782,0,50,wa);wa=this.IGh();Db.a.xla()?(sa={},sa.xlencJson=wa,this.$.xva(Le.a.YLk,
sa,!1)):u.ULS.sendTraceTag(388776770,0,50,wa);this.YZj()}Myc(){this.everConnectedToOcs=this.$.ea.dhb||this.everConnectedToOcs;P.Health.instance&&P.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}el(){const wa=new Ub.a;let sa="";const fc=!this.$.isAnonymousUser(),yd=wa.Xi();if(yd){if(fc){wa.aZb("UMI_Linkable","true");return}sa=wa.KTa("UMI_Linkable")}fc||u.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${yd}, UMIIsLinkable:${!!sa}`)}Nmb(){this.$de=
!0}HYj(wa){this.dirtySessionOnLastRecordedRequest=wa}Lhh(wa){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,wa.coauthorsCount);P.Health.instance&&P.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}T8g(wa){if(!(wa.requestName in this.gyb)){const sa=new qe(wa.requestName);this.gyb[wa.requestName]=sa}this.gyb[wa.requestName].qZj(wa)}S8g(wa){if(!(wa.name in this.fyb)){const sa=new Kd(wa.name,wa.isUserOperation);this.fyb[wa.name]=sa}this.fyb[wa.name].Gg(wa)}oZ(wa){this.Wmd[wa.reportName]=
wa}YZj(){this.dirtySessionOnLastRecordedRequest=this.$de=!1;this.hPf=this.$.ea.vOd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.gyb={};this.fyb={};this.Wmd={}}rMh(){const wa=new Fe(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.$de,this.dirtySessionOnLastRecordedRequest,this.$.ea.vOd-this.hPf,this.maxCoauthorsCount,this.everConnectedToOcs,this.gyb);return Sys.Serialization.JavaScriptSerializer.serialize(wa)}sMh(){var wa=new od.a;const sa=this.fyb;for(const fc in sa){const yd=
sa[fc];yd.gtd();wa.add(yd.data)}wa=wa.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(wa)}IGh(){return Sys.Serialization.JavaScriptSerializer.serialize(this.Wmd)}}Object(t.a)(We,"SessionStatistics",null,[]);class mf extends na.a{constructor(wa){super();this.hva=this.qua=null;this.$4e=Array(1);this.G3c=this.MPd=null;this.uk=(sa,fc)=>{cb.EwaSettings.Ia(39)&&(this.hva=this.hva||new le(this.$,this.RN,this.Dta),this.hva.uk(sa,fc))};this.Fp=(sa,fc)=>{cb.EwaSettings.Ia(39)&&(this.hva=this.hva||
new le(this.$,this.RN,this.Dta),this.hva.Fp(sa,fc))};this.sg=(sa,fc)=>{cb.EwaSettings.Ia(39)&&this.RN.sg(sa,fc)};this.el=(sa,fc)=>{cb.EwaSettings.Ia(39)&&this.RN.el(sa,fc)};this.Myc=(sa,fc)=>{cb.EwaSettings.Ia(39)&&this.RN.Myc(sa,fc)};this.$=wa;cb.EwaSettings.Ia(39)&&(Pb.a.iCf(this.$),this.jT=new Rd(this.$),this.GIh(),cb.EwaSettings.Ia(505)&&this.sib&&(this.MPd=new Nb(this.$,this.sib)),this.RN=new We(this.$),this.Dta=new Wc(this.$),this.$.Sm(this.sg),this.$.oa.rt(this.uk),this.$.oa.Iy(this.Fp),this.$.ea.DMe(this.Myc),
cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.zm(this.el))}get sib(){return this.G3c}dispose(){this.$&&cb.EwaSettings.Ia(39)&&(this.$.ar(this.sg),this.$.oa.Gu(this.uk),this.$.oa.rz(this.Fp),this.$.ea.Gkg(this.Myc),cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.cq(this.el));ub.a.Sa(this.Dta);ub.a.Sa(this.sib);this.G3c=null;ub.a.Sa(this.jT);this.jT=null;ub.a.Sa(this.MPd);this.$=this.MPd=null;super.dispose()}Nmb(){cb.EwaSettings.Ia(39)&&
this.RN.Nmb()}$Jc(wa,sa,fc,yd,Sd,Ie,pf,If,bg,hg,dg,pg,Ug,$g){cb.EwaSettings.Ia(39)&&(this.hva=this.hva||new le(this.$,this.RN,this.Dta),this.hva.$Jc(wa,sa,fc,yd,Sd,Ie,pf,If,bg,hg,dg,pg,Ug,$g))}TWb(wa,sa){cb.EwaSettings.Ia(39)&&(this.qua=this.qua||new ic(this.$,this.RN,this,this.jT),this.qua.TWb(wa,sa))}PJc(){cb.EwaSettings.Ia(39)&&(this.qua=this.qua||new ic(this.$,this.RN,this,this.jT),this.qua.PJc())}WJc(){cb.EwaSettings.Ia(39)&&(this.qua=this.qua||new ic(this.$,this.RN,this,this.jT),this.qua.WJc())}oZ(wa){cb.EwaSettings.Ia(39)&&
this.RN.oZ(wa)}fxd(wa){return cb.EwaSettings.Ia(39)?this.$4e[wa]:null}Rtg(wa){wa&&(this.$4e[wa.type]=wa)}OTa(){return this.Dta.OTa()}GIh(){x.a.Br&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.G3c=new Ia(this.$,this.jT))}}Object(t.a)(mf,"SessionStatisticsManager",na.a,[12]);var qf=a(105),Ga=a(1174),Ob=a(143),e=a(153);class sb{constructor(wa,sa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=wa;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=sa}Dge(){return gd.a.Vf(this)}}Object(t.a)(sb,"AppUnloadInfo",null,[]);var dc=a(788),N=a(127),Da=a(598);class fb{constructor(wa){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=wa.oZe+wa.QIg;this.dataLossReason=wa.uVe;this.Nsh(wa.qke)}Nsh(wa){const sa=new dc.a(Da.a.AP());let fc=0,yd=0;for(const Sd of wa)sa.$d(Sd)||sa.da(Sd,0),wa=sa.da(Sd,sa.ka(Sd)+1),wa>fc&&
(fc=wa,yd=Sd);fc>this.mostCommonOperationCount&&(this.mostCommonOperationName=N.a(yd),this.mostCommonOperationCount=fc)}}Object(t.a)(fb,"DataLossInfo",null,[]);var Wb=a(67);class Jc{constructor(wa){this.Zcd="AppUnloadInfo";this.Jp=this.$=this.workbookHashedId=this.ND=null;this.Doe=this.ase=!1;this.Ti=null;this.IBf=0;this.oka=(sa,fc)=>{this.IBf=fc.SQc};this.$8f=(sa,fc)=>{fc.qke.length&&this.$.QS&&(this.ND.dataLossInfo=new fb(fc),this.ND.wasDataLostDuringUnload=!0,this.xnb())};this.el=()=>{this.KLc();
this.$.ea.cq(this.el)};this.jD=()=>{this.KLc();this.$.ea.CX(this.jD)};this.kYa=()=>{this.ND.wasUpdatedOnBeforeUnload=!0;this.ND.inactivityDurationBeforeUnloadSeconds=this.Ti.Upb<Jc.jej?this.IBf:this.Ti.Upb;this.ALg()};this.qTb=()=>{this.ND.wasUpdatedOnUnload=!0;this.ALg();Sys.Application.remove_unload(this.qTb)};this.$Ec=()=>{this.ND.lastSilentReopenStartTime=Vc.a.Ae.yf;this.ND.lastSilentReopenEndTime=null;this.xnb();this.$.Go(this.iTb)};this.iTb=()=>{this.ND.lastSilentReopenEndTime=Vc.a.Ae.yf;this.xnb();
this.$.Hp(this.iTb)};this.localStorage=new Ub.a;this.localStorage.Xi()&&(this.$=wa,this.workbookHashedId=Wb.a(this.$),this.ND=new sb(this.workbookHashedId,this.$.xa.UserSessionId),this.Jp=e.a.instance.qM(),this.Jp.ta("beforeunload",this.kYa),this.$.userOperationManager.ygh(this.$8f),cb.EwaSettings.ho("AppUnloadTelemetryManager")?wa.ea.nv?this.KLc():this.$.ea.IO(this.jD):wa.ea.ei?this.KLc():this.$.ea.zm(this.el),this.Ti=this.$.ea.Ti,this.Ti.hAa(this.oka),Sys.Application.add_unload(this.qTb),this.$.ea.szb(this.$Ec))}get dialogPromptedOnUnload(){return this.ase}set dialogPromptedOnUnload(wa){this.ase=
wa;this.ND?(this.ND.dialogPromptedOnUnload=wa,this.xnb()):this.localStorage.Xi()&&u.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Xi()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.Doe}set apiBeforeCloseNotificationEnabledOnUnload(wa){this.Doe=wa;this.ND?(this.ND.apiBeforeCloseNotificationEnabledOnUnload=wa,this.xnb()):this.localStorage.Xi()&&u.ULS.sendTraceTag(537151057,0,
10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Xi()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.sXj(this.$8f);this.Ti&&(this.Ti.vIa(this.oka),this.Ti=null);this.Jp.TJ();this.$=this.Jp=null}ALg(){this.bdk();this.xnb()}bdk(){this.ND.wasOfflineDuringUnload=this.$.ni.gca;this.ND.timeFromLastConnectivity=Ob.a(Vc.a.Ae,this.$.ni.YNf);this.ND.timeFromLastDisconnectionStart=Ob.a(Vc.a.Ae,this.$.ni.n5i);
this.ND.disconnectionSource=Enum.toString(Ga.a,this.$.ni.disconnectionSource);this.ND.hadConnectivityIssuesDuringUnload=this.$.ni.Bsa;this.ND.timeFromLastStatusCode0=Ob.a(Vc.a.Ae,this.$.ni.XNf)}xnb(){this.ND.timestamp=Date.now();this.localStorage.aZb(this.Zcd,this.ND.Dge())}KLc(){const wa=this.localStorage.KTa(this.Zcd);if(wa)try{const sa=gd.a.qm(wa);this.localStorage.tjg(this.Zcd);const fc=this.ucj(sa);u.ULS.sendTraceTag(574677456,0,50,fc)}catch(sa){u.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${sa.message}`)}else u.ULS.sendTraceTag(574677457,
0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}ucj(wa){const sa={};sa.WACSessionID=wa.wacSessionId;sa.wasRefreshed=this.$wh(wa,this.$.xa.MaxAppReloadDurationIndicatingRefresh);sa.closedWithDialogConfirmation=wa.dialogPromptedOnUnload;sa.wasOfflineDuringUnload=wa.wasOfflineDuringUnload;sa.TimeFromLastConnectivityMs=wa.timeFromLastConnectivity;sa.TimeFromLastDisconnectionStart=wa.timeFromLastDisconnectionStart;sa.wasDataLostDuringUnload=wa.wasDataLostDuringUnload;
sa.DataLossInfo=wa.dataLossInfo;sa.flushedOnUnload=wa.wasUpdatedOnUnload;sa.flushedOnBeforeUnload=wa.wasUpdatedOnBeforeUnload;sa.InactivityDurationBeforeUnload=wa.inactivityDurationBeforeUnloadSeconds;sa.DisconnectionSource=wa.disconnectionSource;sa.hadConnectivityIssuesDuringUnload=wa.hadConnectivityIssuesDuringUnload;sa.TimeFromLastStatusCode0=wa.timeFromLastStatusCode0;sa.LastSilentReopenStartTime=wa.lastSilentReopenStartTime;sa.LastSilentReopenEndTime=wa.lastSilentReopenEndTime;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&
(sa.ApiBeforeCloseNotificationEnabledOnUnload=wa.apiBeforeCloseNotificationEnabledOnUnload);return ia.c(sa)}$wh(wa,sa){const fc=window.performance.timing.navigationStart-wa.timestamp;(wa=this.workbookHashedId===wa.workbookHashedId&&fc<sa)&&u.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return wa}static ta(wa){wa.ea.ff.inWebPart||wa.ja.$c(410,new Jc(wa))}}Jc.jej=10;Object(t.a)(Jc,"AppUnloadTelemetryManager",null,[526,2]);var md=a(13);class sd{constructor(wa){this.N5e=
!1;this.P5e=null;this.Lg=()=>{this.A2j();lc.h(this.$).ha&&lc.h(this.$).ha.O7(this.Lg)};this.Hm=(sa,fc)=>{fc.na&&!this.Zfe.has(fc.na.name)&&(this.Zfe.add(fc.na.name),lc.h(this.$).ha&&(lc.h(this.$).ha.O7(this.Lg),lc.h(this.$).ha.b4(this.Lg)))};this.$=wa;this.aFg=new Set;this.Zfe=new Set;this.$.sa&&this.$.sa.na&&this.Zfe.add(this.$.sa.na.name);lc.h(this.$).ha.b4(this.Lg);this.$.sa.Vj(this.Hm)}dispose(){this.$=null}A2j(){this.P5e||this.Ysh();const wa=lc.d(lc.h(this.$));if(!this.N5e){const sa=md.a.instance.za(281).split(",");
wa.push(...sa);this.N5e=!0}for(const sa of wa)sa&&!this.aFg.has(sa)&&(this.$9i(sa),this.aFg.add(sa))}$9i(wa){this.suh(wa)}Ysh(){this.P5e=sd.FDa("monospace");sd.FDa("sans-serif");sd.FDa("serif")}suh(wa){sd.FDa(`${wa},${"monospace"}`);sd.FDa(`${wa},${"sans-serif"}`);sd.FDa(`${wa},${"serif"}`)}static ta(wa){if(cb.EwaSettings.Ia(61)){const sa=new sd(wa);wa.ja.$c(210,sa)}}static FDa(wa){const sa=document.createElement("div"),fc=document.createElement("div");sa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";
sd.Pck(fc,wa);document.body.appendChild(sa);sa.appendChild(fc);fc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";wa=fc.offsetWidth+"x"+fc.offsetHeight;document.body.removeChild(fc.parentNode);return wa}static Pck(wa,sa){wa.style.cssText="display: inline; visibility: hidden;";wa.style.fontSize="100px";wa.style.fontWeight="normal";wa.style.fontStyle="normal";wa.style.letterSpacing="normal";wa.style.lineHeight="normal";wa.style.whiteSpace="nowrap";wa.style.fontFamily=
sa}}Object(t.a)(sd,"FontTelemetryManager",null,[2]);var Od=a(249),Ce=a(174),Qe;(function(wa){wa[wa.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";wa[wa.reactSingleLineRibbon=1]="reactSingleLineRibbon";wa[wa.reactMultiLineRibbon=2]="reactMultiLineRibbon";wa[wa.invalid=3]="invalid"})(Qe||(Qe={}));Object(t.b)("RibbonMode",Qe);var lf=a(126);let Oe=class extends Ne.a{constructor(){super();this.vR=!1;this.jye=this.iye=null;this.hVd=()=>{this.lLg()};this.nWd=()=>{ub.a.Sa(this.Y4);ub.a.Sa(this.Jp)};this.Y4=
e.a.instance.jRa();this.Jp=e.a.instance.qM();this.Y4.ta("visibilitychange",this.hVd);this.Jp.ta("pagehide",this.nWd);this.lLg()}get tk(){return this.vR}get jNf(){return this.iye}get nzc(){return this.jye}Y3(wa){this.addHandler("ekdh",wa)}C_a(wa){this.removeHandler("ekdh",wa)}rZ(wa){this.addHandler("ekduh",wa)}sIa(wa){this.removeHandler("ekduh",wa)}jI(wa){return this.tk?!0:this.nzc?Qc.getElapsedMilliseconds(this.nzc,Vc.a.Ae.yf)<wa:!1}dispose(){ub.a.Sa(this.Y4);ub.a.Sa(this.Jp);super.dispose()}lLg(){this.vR=
"hidden"===window.document.visibilityState;this.tk?(this.raiseEvent("ekdh"),this.iye=Vc.a.Ae.yf):(this.raiseEvent("ekduh"),this.jye=Vc.a.Ae.yf)}};Oe=Object(V.__decorate)([Object(Lc.d)(ad.db)],Oe);Object(t.a)(Oe,"DocumentVisibilityObserver",Ne.a,[388,2]);var ag=a(138);class xg{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(t.a)(xg,"FramePerformanceData",null,
[]);class Yf{constructor(wa){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new xg;this.l2FramePerformanceData=new xg;this.l3FramePerformanceData=new xg;this.name=wa}}Object(t.a)(Yf,"FramePerformanceDataGroup",null,[]);class Wa{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(t.a)(Wa,"FramePerformanceSessionEndsReport",null,[480]);class vb{constructor(wa){this.IXd=
{};this.Doa=null;this.Qqb=(sa,fc)=>{sa.longFramesOverThresholdOps++;sa.maxLongFrameDuration=Math.max(sa.maxLongFrameDuration,fc)};this.Ih=new Wa;this.rJh();wa.ja.Ne(276,()=>{se.a(wa).oZ(this.Ih)})}rJh(){this.Doa=new Yf("AllGridOperationsData");this.Ih.operationsGroups.push(this.Doa);this.IDb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.IDb("DragScroll",["DragScroll"]);this.IDb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.IDb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.IDb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}iZj(wa,sa,fc,yd){const Sd=this.eoi(wa);Sd&&(ag.b(this.Ih.operationsGroups,Ie=>hb.a.equals(Ie.name,Sd.name,!1))||this.Ih.operationsGroups.push(Sd),Sd.count++,this.USc(sa,Sd),this.QSc(fc,Sd),this.Doa.count++,
this.USc(sa,this.Doa),this.QSc(fc,this.Doa),0<yd&&this.PEk(yd,Sd),0<=sa&&this.$Dk(sa,Sd))}tFk(){for(const wa of this.Ih.operationsGroups)vb.iEk(wa)}IDb(wa,sa){wa=new Yf(wa);for(const fc of sa)this.IXd[fc]=wa}eoi(wa){return wa in this.IXd?this.IXd[wa]:null}$Dk(wa,sa){30>wa&&this.Jie(fc=>{fc.l1FramePerformanceData.fpsUnderThresholdOps++},sa);15>wa&&this.Jie(fc=>{fc.l2FramePerformanceData.fpsUnderThresholdOps++},sa);5>wa&&this.Jie(fc=>{fc.l3FramePerformanceData.fpsUnderThresholdOps++},sa)}PEk(wa,sa){100<=
wa&&(this.Rqb(sa.l1FramePerformanceData,wa,this.Qqb),this.Rqb(this.Doa.l1FramePerformanceData,wa,this.Qqb));300<=wa&&(this.Rqb(sa.l2FramePerformanceData,wa,this.Qqb),this.Rqb(this.Doa.l2FramePerformanceData,wa,this.Qqb));600<=wa&&(this.Rqb(sa.l3FramePerformanceData,wa,this.Qqb),this.Rqb(this.Doa.l3FramePerformanceData,wa,this.Qqb))}Jie(wa,sa){sa&&(wa(sa),wa(this.Doa))}Rqb(wa,sa,fc){wa&&fc(wa,sa)}USc(wa,sa){sa.minFPS=-1===sa.minFPS?wa:Math.min(sa.minFPS,wa)}QSc(wa,sa){sa.maxFPS=Math.max(sa.maxFPS,
wa)}static iEk(wa){vb.nje(wa.l1FramePerformanceData,wa.count);vb.nje(wa.l2FramePerformanceData,wa.count);vb.nje(wa.l3FramePerformanceData,wa.count)}static nje(wa,sa){wa.fpsUnderThresholdOpsPercentage=100*wa.fpsUnderThresholdOps/sa;wa.longFramesOverThresholdOpsPercentage=100*wa.longFramesOverThresholdOps/sa}}Object(t.a)(vb,"FramePerformanceSessionEndsReportManager",null,[]);class cc{constructor(){this.f=null}}Object(t.a)(cc,"FpsDataWrapper",null,[]);class Ic{constructor(wa,sa){this.duration=this.startSecond=
0;this.startSecond=void 0===wa?-1:wa;this.duration=void 0===sa?-1:sa}}Object(t.a)(Ic,"LongFrameData",null,[]);var dd=a(370);class Cd{constructor(wa,sa,fc,yd,Sd,Ie,pf,If,bg,hg){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===wa?null:wa;this.count=void 0===sa?0:sa;this.start=void 0===fc?-1:fc;this.end=void 0===yd?-1:yd;this.Avg=void 0===Sd?0:Sd;this.Max=void 0===Ie?-1:Ie;this.Min=
dd.a.sRg;this.longFrameCount=void 0===pf?0:pf;this.coauth=(void 0===If?-1:If)||1;this.tfAppInt=void 0===bg?-1:bg;this.Props=void 0===hg?null:hg;this.LFrame=null}}Object(t.a)(Cd,"OperationFPSData",null,[]);var ae=a(79),Be=a(302),oe=a(860);class Te extends na.a{constructor(wa,sa){super();this.Qzb=-1;this.dNd=0;this.ZFa=new Date(0);this.t4=null;this.Tpa={};this.zCa=new od.a;this.Q6d=this.Fhb=!1;this.Gcb=null;this.GQc=this.Hta=0;this.isSynthetic=!1;this.Hkf=()=>{const fc=new Date;var yd=fc.getMinutes();
const Sd=fc.getSeconds();this.gPb&&fc.getTime()-this.gPb.getTime()>this.kuk?(this.stop(),this.$td(fc)):(yd!==this.dNd&&(this.$td(fc),this.dNd=yd),this.Fhb&&(this.ph.tk?this.t4[Sd]=Te.Hkc:(this.y7e(Sd),this.Fhb=!1,this.zCa.clear(),this.Tpa={})),this.t4[Sd]!==Te.Hkc&&(this.t4[Sd]++,yd=fc.getTime()-this.ZFa.getTime(),yd>this.IRf&&this.v$i(this.ZFa,yd)),this.Qzb=window.requestAnimationFrame(this.Hkf),this.ZFa=fc)};this.HK=()=>{this.Fhb=!0};this.SYf=()=>{this.pause()};this.TYf=()=>{this.Q6d&&this.resume()};
this.zl=()=>{this.ya.w0()&&this.YEk()};this.zoom=sa;this.gPb=new Date;this.ph=new Oe;this.ph.Y3(this.HK);C.AFrameworkApplication.gbd(this.SYf);C.AFrameworkApplication.hbd(this.TYf);this.$=wa;this.IRf=wa.xa.LongFrameThresholdMs;this.mbj="MoreThan_"+this.IRf.toString()+"_Ms";this.juk=wa.xa.ThresholdToEndOperationTrackingSeconds;this.kuk=wa.xa.ThresholdToStopFPSTrackingMS;this.ya=lc.h(this.$).ya;C.AFrameworkApplication.pf&&C.AFrameworkApplication.pf.IsSynthetic&&(this.isSynthetic=hb.a.compare(C.AFrameworkApplication.pf[He.a.isSynthetic],
"True",!0)?!1:!0);this.ya.Uu(this.zl);this.g6d()}get zoomManager(){return cb.EwaSettings.Pi()?this.zoom.zoomManager:ae.a(this.$)}start(){this.Q6d=!0;this.resume()}stop(){this.Q6d=!1;this.pause()}dispose(){this.stop();this.ph.C_a(this.HK);C.AFrameworkApplication.bkg(this.SYf);C.AFrameworkApplication.ckg(this.TYf);ub.a.Sa(this.ph);this.ya.Ot(this.zl);super.dispose()}Upk(wa,sa){const fc=wa in this.Tpa?this.Tpa[wa]:null;this.gPb=new Date;this.start();const yd=this.gPb.getSeconds(),Sd=yd+this.juk;fc&&
yd<=fc.end?(fc.count++,fc.end=Sd):(fc&&yd>fc.end&&this.zCa.add(fc),this.Tpa[wa]=new Cd(wa,1,yd,Sd,void 0,void 0,void 0,this.$.ea.Zo.length,Cb.a.instance.xba(this.gPb),sa))}GHh(){this.Gcb||(this.$td(new Date),this.Gcb=new vb(this.$))}resume(){this.mGf()||!this.ya.$T||this.isSynthetic||(this.Fhb=this.ph.tk,this.ZFa=new Date,this.dNd=this.ZFa.getMinutes(),this.g6d(),this.y7e(this.ZFa.getSeconds()),this.Qzb=window.requestAnimationFrame(this.Hkf))}mGf(){return 0<=this.Qzb}pause(){this.mGf()&&(this.Fhb||
(this.z7e((new Date).getSeconds()),u.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.t4.toString()}`)),window.cancelAnimationFrame(this.Qzb),this.Qzb=-1)}$td(wa){if(wa.getTime()-this.ZFa.getTime()<Te.afj&&(this.Fhb&&this.z7e(this.ZFa.getSeconds()),this.jXh(),0<this.zCa.count&&(wa={},wa.NonEmptyCellsCount=this.Hta,wa.TextCellsCount=this.GQc,wa.xlfpsJson=Object(fa.a)(new cc,{f:this.zCa.toArray()}),wa.memoryInfo=this.wej(),wa.zoom=this.zoomManager?this.zoomManager.zoom:1,wa.RibbonMode=Ce.a(this.$)?Qe[Ce.a(this.$).cU]:
Te.invalid,wa.deviceMemory=navigator.deviceMemory||0,wa.hardwareConcurrency=navigator.hardwareConcurrency||0,wa=JSON.stringify(wa),u.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.t4.toString()}`),!this.isSynthetic))){if(Db.a.xla()){var sa={};sa.xlfpsJson=wa;this.$.xva(Le.a.aMk,sa,!1)}else u.ULS.sendTraceTag(388781010,0,50,`${wa}`);for(const fc of this.zCa){sa=1E3>=this.Hta?"0_1000":3E3>=this.Hta?"1000_3000":"3000_inf";const yd=new Map;yd.set("Operation",fc.Op);yd.set("BucketOfRenderedCells",sa);P.Health.instance.recordKpiUsage($a.a.longFrame,
0,$e.a.canvas,yd);0<fc.longFrameCount&&P.Health.instance.recordKpiFailure($a.a.longFrame,"LongFrame",!1,!0,Object(fa.a)(new Be.a,{extendedProperties:yd}));3E4<fc.tfAppInt&&(0<fc.longFrameCount?fe.b().smg(0,this.mbj,yd):fe.b().tmg(0,yd))}u.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${wa.length}`)}this.reset()}wej(){const wa={};if(window.performance){const sa=window.performance.memory;sa&&(wa.jsHeapSizeLimit=sa.jsHeapSizeLimit,wa.usedJSHeapSize=sa.usedJSHeapSize,wa.totalJSHeapSize=
sa.totalJSHeapSize)}return wa}reset(){this.zCa.clear();this.Tpa={};this.g6d()}jXh(){var wa=!0;wa=void 0===wa?!0:wa;if(this.t4){for(const sa of oe.a(this.Tpa)){const fc=this.Tpa[sa];fc.end=Math.min(this.t4.length-1,fc.end);this.zCa.add(fc)}this.vth(this.zCa,this.t4,wa)}}vth(wa,sa,fc){fc=void 0===fc?!0:fc;for(const yd of wa){let Sd=wa=0;if(yd.end<sa.length){for(let Ie=yd.start;Ie<=yd.end;Ie++){const pf=sa[Ie];0<=pf&&(yd.Max=Math.round(Math.max(yd.Max,pf)),yd.Min=Math.round(Math.min(yd.Min,pf)),wa+=
pf,Sd++)}0<Sd&&(yd.Avg=Math.round(wa/Sd));fc&&this.Gcb&&this.Gcb.iZj(yd.Op,yd.Min,yd.Max,yd.LFrame?yd.LFrame.duration:-1);yd.Props&&(this.Hzk(yd),yd.Props=null)}}fc&&this.Gcb&&this.Gcb.tFk()}g6d(){this.t4=Array(60).fill(0)}y7e(wa){wa++;for(let sa=0;sa<wa;sa++)this.t4[sa]=Te.Hkc}z7e(wa){for(;60>wa;wa++)this.t4[wa]=Te.Hkc}v$i(wa,sa){wa=wa.getSeconds();var fc=oe.a(this.Tpa);if(0<fc.length)for(const yd of fc)if(fc=this.Tpa[yd],wa>=fc.start&&wa<fc.end)fc.LFrame?fc.LFrame.duration<sa&&(fc.LFrame.startSecond=
wa,fc.LFrame.duration=sa,fc.longFrameCount++):(fc.LFrame=new Ic(wa,sa),fc.longFrameCount++)}YEk(){this.GQc=this.Hta=0;for(const wa of lc.h(this.$).Jr){const sa=wa.u3a;for(const fc in sa){const yd=this.ya.Dl(sa[fc].hashCode);if(null===yd||void 0===yd?0:yd.nm)this.Hta+=yd.gh.NonEmptyCellsCount,this.GQc+=yd.gh.TextValueCellsCount}}}Hzk(wa){const sa=wa.Props;if(qd.a.IZb in sa&&sa[qd.a.IZb]&&qd.a.z0b in sa){let fc;(fc=Object(ba.a)(Od.a,sa[qd.a.z0b]))&&fc.continueWith(yd=>{lf.TextEditorTelemetry.instance.jah(wa.Op,
wa.Min,!!wa.LFrame,wa.LFrame?wa.LFrame.duration:0,yd.result)})}}}Te.Hkc=-1;Te.afj=6E4;Te.invalid="Invalid";Object(t.a)(Te,"FramePerformanceTracker",na.a,[438,2]);class wf extends Hb.a{constructor(wa){super();this.$=wa;this.Dg()}create(){let wa=this.$.ja.Qa(263);cb.EwaSettings.Pi()?void Lc.a.resolve(ad.ze).then(sa=>{wa||(wa=this.$.ja.$c(263,new Te(this.$,sa)));this.Df(wa)}):(wa||(wa=this.$.ja.$c(263,new Te(this.$,null))),this.Df(wa))}static ta(wa){cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveXlfpsTag",
!1)||wa.ja.$c(264,new wf(wa))}}Object(t.a)(wf,"FramePerformanceTrackerFactory",Hb.a,[]);var fg=a(1053),Og=a(1045);class yf{wj(wa,sa){return new Og.a(wa,sa)}Sf(wa,sa){wa=this.wj(wa,sa);wa.start();return wa}}Object(t.a)(yf,"DefaultStopwatchBuilder",null,[724]);class Sf{constructor(){this.qya=new yf}wj(wa,sa){return this.qya.wj(wa,sa)}Sf(wa,sa){return this.qya.Sf(wa,sa)}}Object(t.a)(Sf,"StopwatchBuilder",null,[724]);var Wf=a(334),ng=a(1015),Me=a(1188),Dg;(function(wa){wa[wa.actions=0]="actions";wa[wa.correlationStart=
1]="correlationStart";wa[wa.reorderSheetOp=2]="reorderSheetOp";wa[wa.formatCellOp=3]="formatCellOp";wa[wa.copyOp=4]="copyOp";wa[wa.pasteOp=5]="pasteOp";wa[wa.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";wa[wa.instantaneousSetData=7]="instantaneousSetData";wa[wa.immediateSetData=8]="immediateSetData";wa[wa.dependentCellsCalc=9]="dependentCellsCalc";wa[wa.dependentCellsGraphStat=10]="dependentCellsGraphStat";wa[wa.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";wa[wa.getRangeContentPrefetchFailures=
12]="getRangeContentPrefetchFailures";wa[wa.gridBlockUpdates=13]="gridBlockUpdates";wa[wa.browserAppStart=14]="browserAppStart";wa[wa.linkedObjects=15]="linkedObjects";wa[wa.longFrames=16]="longFrames";wa[wa.task=17]="task";wa[wa.conflictInEditing=18]="conflictInEditing";wa[wa.incomingPresenceData=19]="incomingPresenceData";wa[wa.editorTableDelay=20]="editorTableDelay";wa[wa.presenceStartup=21]="presenceStartup";wa[wa.presenceDelete=22]="presenceDelete";wa[wa.editorEvent=23]="editorEvent";wa[wa.editorTime=
24]="editorTime";wa[wa.gridScreenReaderOps=25]="gridScreenReaderOps";wa[wa.sendPresenceToService=26]="sendPresenceToService";wa[wa.IME=27]="IME";wa[wa.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";wa[wa.customizeStatusBar=29]="customizeStatusBar";wa[wa.clientWebRequests=30]="clientWebRequests";wa[wa.showCommentTaskPane=31]="showCommentTaskPane";wa[wa.applyThreadedCommentChange=32]="applyThreadedCommentChange";wa[wa.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";wa[wa.findNextOrPreviousComment=
34]="findNextOrPreviousComment";wa[wa.goto=35]="goto";wa[wa.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";wa[wa.richApiInvocation=37]="richApiInvocation";wa[wa.fxLibrary=38]="fxLibrary";wa[wa.embeddedApiSession=39]="embeddedApiSession";wa[wa.numberFormattingCalculator=40]="numberFormattingCalculator";wa[wa.requestDataAfterSend=41]="requestDataAfterSend";wa[wa.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";wa[wa.copy=43]="copy";wa[wa.paste=44]="paste";wa[wa.dragDrop=45]="dragDrop";
wa[wa.clearCopyState=46]="clearCopyState";wa[wa.webWorkerRecalcStats=47]="webWorkerRecalcStats";wa[wa.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";wa[wa.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";wa[wa.customSort=50]="customSort";wa[wa.namedSheetViewUserAction=51]="namedSheetViewUserAction";wa[wa.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";wa[wa.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";wa[wa.namedSheetViewOptionsDialog=
54]="namedSheetViewOptionsDialog";wa[wa.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";wa[wa.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";wa[wa.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";wa[wa.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";wa[wa.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(Dg||(Dg={}));Object(t.b)("UsageTable",Dg);var Tg=a(448),gg=a(499),Rg=a(641),qh=a(700),ug=a(286);class Dh extends Sys.EventArgs{constructor(){super();
this.xhj=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(t.a)(Dh,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class zg{constructor(wa,sa){this.H7d=void 0===sa?1:sa;this.total=wa}get average(){return this.total/this.H7d}gAh(wa){return new zg(this.total+wa.total,this.H7d+wa.H7d)}static jqh(wa,sa){return`${wa}_${sa}`}}Object(t.a)(zg,"StopwatchAverage",null,[]);var Eg;(function(wa){wa[wa.longFrame=0]="longFrame";wa[wa.longGetRange=1]="longGetRange";wa[wa.longJsTask=2]="longJsTask";
wa[wa.viewportCalculationLoops=3]="viewportCalculationLoops"})(Eg||(Eg={}));Object(t.b)("UtrKpiVeto",Eg);class Lg{static Vdb(wa){return Enum.toString(Eg,wa)}}Lg.IKa="UTR";Object(t.a)(Lg,"KpiConstants",null,[]);class jg{}jg.qNg="UTRVetoName";jg.iNg="UTRErrorName";jg.mNg="UTROperationName";jg.CTc="UTRDuration";jg.oNg="UTREndedInPhase";jg.tke="UTRMessage";jg.pNg="UtrUnavailabilityType";jg.operationName="OperationName";jg.duration="Duration";jg.message="Message";Object(t.a)(jg,"UtrAdditionalData",null,
[]);class hh{}hh.WJk="VetoLike";hh.G9e="E2EOperationPerf";hh.NZj="RequestPerf";hh.GAk="UnavailabilityDurations";Object(t.a)(hh,"UtrTypes",null,[]);class Jh{RWb(wa,sa,fc){fc=void 0===fc?null:fc;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(fc=fc?Object(fa.a)(new Be.a,{extendedProperties:fc}):null,wa=Lg.Vdb(wa),P.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+wa,sa,!1,!0,"",fc))}vYb(wa,sa,fc,yd,Sd,Ie){Ie[Lg.IKa]=hh.WJk;Ie[jg.qNg]=Lg.Vdb(yd);Ie[jg.iNg]=Sd;u.ULS.sendTraceTag(wa,
sa,fc,gd.a.Vf(Ie));delete Ie[Lg.IKa];delete Ie[jg.qNg];delete Ie[jg.iNg]}}Object(t.a)(Jh,"UtrKpiVetoReporter",null,[]);class uh{G5d(wa,sa){sa=void 0===sa?null:sa;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||P.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Lg.Vdb(wa),0,"",sa)}RWb(wa,sa,fc){fc=void 0===fc?null:fc;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(wa=Lg.Vdb(wa),P.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+wa,sa,!1,!0,this.$kd(fc)))}WYj(wa,
sa){sa=void 0===sa?null:sa;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||P.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Lg.Vdb(wa),"",this.$kd(sa))}VYj(wa,sa,fc){fc=void 0===fc?null:fc;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(wa=Lg.Vdb(wa),P.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+wa,sa,!1,!0,"",this.$kd(fc)))}$kd(wa){return wa?Object(fa.a)(new Be.a,{extendedProperties:wa}):null}}Object(t.a)(uh,"UtrKpiVetoUsageReporter",
null,[]);class Ja{QJc(wa,sa,fc){fc=void 0===fc?null:fc;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||P.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+wa,"",Object(fa.a)(new Be.a,{extendedProperties:fc,durationMs:sa}))}XJc(wa,sa,fc){fc=void 0===fc?null:fc;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(sa?P.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+wa,"",Object(fa.a)(new Be.a,{extendedProperties:fc})):P.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+
wa,"",!1,!1,"",Object(fa.a)(new Be.a,{extendedProperties:fc})))}sYb(wa,sa,fc,yd,Sd,Ie,pf,...If){pf=String.format(pf,...If);If={};If[Lg.IKa]=hh.G9e;If[jg.mNg]=yd;If[jg.oNg]=Sd;If[jg.CTc]=Ie;If[jg.tke]=pf;u.ULS.sendTraceTag(wa,sa,fc,gd.a.Vf(If))}SLc(wa,sa,fc,yd,Sd,Ie,pf){const If={};If[Lg.IKa]=hh.G9e;If[jg.mNg]=yd;If[jg.oNg]=Sd;If[jg.CTc]=Ie;If[jg.tke]=pf;u.ULS.sendTraceTag(wa,sa,fc,gd.a.Vf(If))}uYb(wa,sa,fc,yd,Sd,Ie){this.hwg(Ie,yd,Sd);u.ULS.sendTraceTag(wa,sa,fc,gd.a.Vf(Ie));this.DPh(Ie)}tYb(wa,sa,
fc,yd,Sd,Ie,...pf){Ie=String.format(Ie,...pf);pf={};this.hwg(pf,yd,Sd,Ie);u.ULS.sendTraceTag(wa,sa,fc,gd.a.Vf(pf))}TLc(wa,sa,fc,yd){yd[Lg.IKa]=hh.NZj;u.ULS.sendTraceTag(wa,sa,fc,gd.a.Vf(yd));delete yd[Lg.IKa]}hwg(wa,sa,fc,yd){yd=void 0===yd?null:yd;wa[Lg.IKa]=hh.GAk;wa[jg.pNg]=sa;wa[jg.CTc]=fc;yd&&(wa[jg.tke]=yd)}DPh(wa){delete wa[Lg.IKa];delete wa[jg.pNg];delete wa[jg.CTc]}}Object(t.a)(Ja,"UtrOperationPerfReporter",null,[]);class Fb extends Ne.a{constructor(wa,sa,fc,yd,Sd,Ie){fc=void 0===fc?null:
fc;yd=void 0===yd?null:yd;Sd=void 0===Sd?null:Sd;Ie=void 0===Ie?!1:Ie;super();this.I6h=[qd.a.tTe,qd.a.Bbf,qd.a.Cbf,qd.a.uuc,qd.a.jAc,qd.a.v8i,qd.a.renderCachedContent,qd.a.renderServerContent,qd.a.Sic,qd.a.K3j,qd.a.Mqg,qd.a.Nqg,qd.a.B7j];this.Owb=this.QLa=this.X1b=this.erb=this.wze=this.xSe=this.m6a=this.CGe=null;this.$$f=this.rTe=!1;this.lNg=this.kNg=this.nNg=this.U5d=this.DOg=null;this.k6f=(pf,If)=>{for(pf=0;pf<If.entries.length;pf++){const pg=If.entries[pf];pg.url=J.a.removeParameter(pg.url,C.AFrameworkApplication.pH);
var bg=J.a.O1(pg.url);!cb.EwaSettings.Ia(426)&&this.e0i(pg.url,bg)&&(pg.behavior=1);if("img"===pg.xv.initiatorType&&bg.endsWith(ng.a.ppd)){var hg=J.a.vba(pg.url,ng.a.opd),dg=J.a.vba(pg.url,ng.a.qpd);pg.l_=`${pg.l_}imageID=${hg}, imgStateID=${dg}`}"css"===pg.xv.initiatorType&&"responseStatus"in pg.xv&&(hg=`responseStatus=${pg.xv.JYk}`,pg.l_=pg.l_?`${pg.l_},${hg}`:hg);hg=pg.xv.transferSize;let Ug;dg=pg.xv.decodedBodySize;void 0!==hg&&null!==hg&&void 0!==dg&&null!==dg?Ug=0===hg&&0<dg:void 0!==hg&&null!==
hg&&(Ug=0===hg);Cb.a.instance.obh(bg,Math.round(pg.xv.fetchStart),Math.round(pg.xv.responseEnd),Ug,this.N1i);hb.a.contains(bg,qd.a.richTextEditor,!0)&&(bg=lf.TextEditorTelemetry.instance,bg.$L(qd.a.p0j,Math.round(pg.xv.fetchStart)),bg.$L(qd.a.r0j,Math.round(pg.xv.responseEnd)))}};this.HK=()=>{const pf=this.lea;for(const If in pf)pf[If].h=!0};this.userSessionId=wa;this.X$a=fc=fc||new Rg.a;this.ol=yd||Vc.a.Ae;this.Oqk=Sd||this;this.N1i=Ie;this.H5e=fc.Eib();cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Lc.a.resolve(ad.db).then(pf=>{this.ph=pf;this.ph.Y3(this.HK)}):(this.ph=new Oe,this.ph.Y3(this.HK),sa.$c(291,this.ph))}get lea(){return this.CGe||(this.CGe={})}get K4e(){return this.erb||this.H5e}get V4e(){return this.QLa||Fb.TWf}get Nee(){return this.xSe=this.xSe||{}}get gGc(){return this.m6a||"undefined"===typeof Stw?this.m6a:this.m6a=Stw.swpc}get CRf(){return this.wze=this.wze||{}}get GIa(){return this.Owb||(this.Owb=xb.a.instance.We("Common.NetworkTiming.IResourceTimingLogger"))}get jNg(){return this.kNg||
(this.kNg=new Jh)}get n3a(){return this.nNg||(this.nNg=new Ja)}get DTc(){return this.lNg||(this.lNg=new uh)}lPc(wa,sa,fc,yd,Sd){Sd=void 0===Sd?null:Sd;if(this.lea[fc])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.lea[fc]=this.c4e(wa,sa,fc,yd,Sd)}$lc(wa,sa){const fc=this.lea[wa];fc&&(this.J_e(fc,sa),this.ECk(fc),delete this.lea[wa])}Qjg(wa){delete this.lea[wa]}rCg(wa,sa){this.erb||this.fCg(wa,sa)}ZBg(){this.rCg(Fb.aCd,this.ol.zh)}jaf(wa,sa){sa=void 0===sa?!1:sa;
if(this.erb){if(this.QLa===Fb.aYd||this.QLa===Fb.aCd){const fc=L.a.instance;fc.userSessionId=this.userSessionId;if(this.QLa===Fb.aYd){this.rTe||(this.pta(wa.m,Object(qa.a)(fc,fc.FOj,"recordContentFetchEnd")),this.rTe=!0);if(sa){this.$$f||(this.pta(wa.m,Object(qa.a)(fc,fc.SOj,"recordPerceivedContentDisplayed")),this.$$f=!0);return}this.pta(wa.m,Object(qa.a)(fc,fc.EOj,"recordContentDisplayed"))}else this.QLa===Fb.aCd&&(sa=this.lea[this.X1b])&&this.pta(ug.a(wa,sa.s),Object(qa.a)(fc,fc.NOj,"recordInteractivityContentDisplayed"),
!1)}this.$lc(this.X1b,wa);this.X1b=this.QLa=this.erb=null}}pta(wa,sa,fc){fc=void 0===fc?!0:fc;L.a.p4&&Object(Wf.a)(qh.PerformanceClock,Vc.a.Ae)&&fc&&(wa+=window.performance.timing.navigationStart);sa(wa)}hm(wa){return Tg.a(wa)}Fi(wa,sa,fc){fc=void 0===fc?!1:fc;try{if(this.CRf[Dg[wa]]=!0,fc){var yd=u.ULS,Sd=yd.sendTraceTag;const nd={};let Cg=null;switch(wa){case 0:Cg="Actions";var Ie=sa.a;null!=Ie&&(nd.Id=Ie);var pf=null==sa.b?null:sa.b;null!=pf&&(nd.Operation=pf);var If=sa.c;null!=If&&(nd.Target=
If);var bg=null==sa.d?null:sa.d.toString();null!=bg&&(nd.StartTime=bg);var hg=null==sa.e?null:sa.e.toString();null!=hg&&(nd.Duration=hg);var dg=sa.f;null!=dg&&(nd.CorrelationId=dg);var pg=sa.g;null!=pg&&(nd.ParentAction=pg);var Ug=null==sa.h?null:sa.h.toString();null!=Ug&&(nd.DocumentHidden=Ug);break;case 1:Cg="CorrelationStart";var $g=sa.a;null!=$g&&(nd.CorrelationId=$g);var ih=sa.b;null!=ih&&(nd.UserSessionId=ih);var Zf=sa.c;null!=Zf&&(nd.UserAction=Zf);break;case 2:Cg="ReorderSheetOp";var gh=sa.a;
null!=gh&&(nd.UserSessionId=gh);var Zg=null==sa.b?null:sa.b.toString();null!=Zg&&(nd.IsDragReorder=Zg);var Sg=null==sa.c?null:sa.c.toString();null!=Sg&&(nd.DocumentUp=Sg);var Ah=null==sa.d?null:sa.d.toString();null!=Ah&&(nd.OldIndex=Ah);var rh=null==sa.e?null:sa.e.toString();null!=rh&&(nd.NewIndex=rh);var Oa=null==sa.f?null:sa.f.toString();null!=Oa&&(nd.TotalSheets=Oa);break;case 3:Cg="FormatCellOp";var Mb=sa.a;null!=Mb&&(nd.UserSessionId=Mb);var sc=null==sa.b?null:sa.b.toString();null!=sc&&(nd.TaskId=
sc);var vc=null==sa.c?null:sa.c.toString();null!=vc&&(nd.NumberOfRanges=vc);var vd=sa.d;null!=vd&&(nd.Ranges=vd);var Qd=sa.e;null!=Qd&&(nd.ActiveCell=Qd);var de=null==sa.f?null:sa.f.toString();null!=de&&(nd.ActionId=de);var xe=sa.g;null!=xe&&(nd.CommandParameters=xe);var ef=sa.h;null!=ef&&(nd.UserActionStopwatchId=ef);break;case 4:Cg="CopyOp";var Ff=sa.a;null!=Ff&&(nd.UserSessionId=Ff);var xf=null==sa.b?null:sa.b.toString();null!=xf&&(nd.IsChrome=xf);var cg=null==sa.c?null:sa.c.toString();null!=cg&&
(nd.IsIE=cg);var Bf=null==sa.d?null:sa.d.toString();null!=Bf&&(nd.IsFromUI=Bf);var Mf=null==sa.e?null:sa.e.toString();null!=Mf&&(nd.IsCopyInLoadedRange=Mf);var ah=null==sa.f?null:sa.f.toString();null!=ah&&(nd.IsRepeatedCopy=ah);var Eh=null==sa.g?null:sa.g.toString();null!=Eh&&(nd.IsClipboarAccessSupported=Eh);var Uh=null==sa.h?null:sa.h.toString();null!=Uh&&(nd.IsClipboarAccessInstallationSupported=Uh);var sh=null==sa.i?null:sa.i.toString();null!=sh&&(nd.RibbonCommand=sh);var oh=null==sa.j?null:sa.j.toString();
null!=oh&&(nd.CutCopyPasteFlags=oh);var Wh=null==sa.k?null:sa.k.toString();null!=Wh&&(nd.IsDrag=Wh);var vh=null==sa.l?null:sa.l.toString();null!=vh&&(nd.IsIeBeforeAlowDenyPopUp=vh);var Qh=sa.m;null!=Qh&&(nd.IsPasteMatchCopy=Qh);var yh=sa.n;null!=yh&&(nd.WaitMessageInClipboard=yh);var Kh=null==sa.o?null:sa.o.toString();null!=Kh&&(nd.CallCount=Kh);break;case 5:Cg="PasteOp";var jh=sa.a;null!=jh&&(nd.UserSessionId=jh);var Xh=null==sa.b?null:sa.b.toString();null!=Xh&&(nd.IsChrome=Xh);var Tf=null==sa.c?
null:sa.c.toString();null!=Tf&&(nd.IsIE=Tf);var Ag=null==sa.d?null:sa.d.toString();null!=Ag&&(nd.IsCopyActive=Ag);var Bh=null==sa.e?null:sa.e.toString();null!=Bh&&(nd.IsFromUI=Bh);var ea=null==sa.f?null:sa.f.toString();null!=ea&&(nd.IsClipboarAccessSupported=ea);var Ab=null==sa.g?null:sa.g.toString();null!=Ab&&(nd.IsClipboarAccessInstallationSupported=Ab);var pc=null==sa.h?null:sa.h.toString();null!=pc&&(nd.RibbonCommand=pc);var wc=null==sa.i?null:sa.i.toString();null!=wc&&(nd.CutCopyPasteFlags=wc);
var Ld=sa.j;null!=Ld&&(nd.WaitMessageInClipboard=Ld);var ee=sa.k;null!=ee&&(nd.PopupDialog=ee);var Pe=sa.l;null!=Pe&&(nd.SimplePopupMessage=Pe);var cf=sa.m;null!=cf&&(nd.DialogCloseButton=cf);var vf=sa.n;null!=vf&&(nd.UserPressedInstallLink=vf);var Ef=null==sa.o?null:sa.o.toString();null!=Ef&&(nd.CallCount=Ef);break;case 6:Cg="GetNumberViewModelDataOp";var ca=sa.a;null!=ca&&(nd.UserSessionId=ca);var ra=sa.b;null!=ra&&(nd.NumberFormatOptionsPreviousOutputJson=ra);var Gb=sa.c;null!=Gb&&(nd.NumberFormatOptionsNewInputJson=
Gb);break;case 7:Cg="InstantaneousSetData";var tc=sa.a;null!=tc&&(nd.Id=tc);var wd=null==sa.b?null:sa.b.toString();null!=wd&&(nd.WasEmpty=wd);var he=null==sa.c?null:sa.c.toString();null!=he&&(nd.ValueNotChanged=he);var Re=sa.d;null!=Re&&(nd.Source=Re);var ff=null==sa.e?null:sa.e.toString();null!=ff&&(nd.ProcessingCompleted=ff);break;case 8:Cg="ImmediateSetData";var jf=sa.a;null!=jf&&(nd.ClientStopwatchId=jf);var zf=sa.b;null!=zf&&(nd.Operation=zf);var Qf=sa.c;null!=Qf&&(nd.Parameters=Qf);var Kf=null==
sa.d?null:sa.d.toString();null!=Kf&&(nd.WasUpdatedByImmediate=Kf);var Gf=null==sa.e?null:sa.e.toString();null!=Gf&&(nd.areHtmlElementsEqualClientComparison=Gf);var lg=null==sa.f?null:sa.f.toString();null!=lg&&(nd.WasDecisionMadeByHtmlComparison=lg);var Hf=null==sa.g?null:sa.g.toString();null!=Hf&&(nd.IsNumeric=Hf);var Of=null==sa.h?null:sa.h.toString();null!=Of&&(nd.IsDateTime=Of);var Yg=null==sa.i?null:sa.i.toString();null!=Yg&&(nd.HasCurrencySymbol=Yg);var eh=null==sa.j?null:sa.j.toString();null!=
eh&&(nd.HasPercentSymbol=eh);var Hg=null==sa.k?null:sa.k.toString();null!=Hg&&(nd.IsFunc=Hg);var Pg=null==sa.l?null:sa.l.toString();null!=Pg&&(nd.DiffInWrappingWhitespace=Pg);var Fg=sa.m;null!=Fg&&(nd.ImmediatePattern=Fg);var Ch=null==sa.n?null:sa.n.toString();null!=Ch&&(nd.TextAlignmentMatch=Ch);var Vg=null==sa.o?null:sa.o.toString();null!=Vg&&(nd.FontColorMatch=Vg);var wh=null==sa.p?null:sa.p.toString();null!=wh&&(nd.FormulaTextMatch=wh);var kh=null==sa.q?null:sa.q.toString();null!=kh&&(nd.isFormula=
kh);var Vh=sa.r;null!=Vh&&(nd.FormulaText=Vh);var $h=sa.s;null!=$h&&(nd.InstantaneousPattern=$h);var Mg=null==sa.t?null:sa.t.toString();null!=Mg&&(nd.AreHtmlInnerTextElementsEqualClientComparison=Mg);var Ye=sa.u;null!=Ye&&(nd.HtmlComparisonDecision=Ye);break;case 9:Cg="DependentCellsCalc";var E=sa.a;null!=E&&(nd.CalcStatus=E);var ja=null==sa.b?null:sa.b.toString();null!=ja&&(nd.SuccessfullyCalculatedRanges=ja);var Ha=null==sa.c?null:sa.c.toString();null!=Ha&&(nd.RangesSkipped=Ha);var Jb=null==sa.d?
null:sa.d.toString();null!=Jb&&(nd.TotalErrors=Jb);var jc=null==sa.e?null:sa.e.toString();null!=jc&&(nd.Partial=jc);var Uc=null==sa.f?null:sa.f.toString();null!=Uc&&(nd.Canceled=Uc);var Rc=null==sa.g?null:sa.g.toString();null!=Rc&&(nd.Aggregate=Rc);var Dd=null==sa.h?null:sa.h.toString();null!=Dd&&(nd.Unknown=Dd);var Yd=null==sa.i?null:sa.i.toString();null!=Yd&&(nd.UnavailableData=Yd);var Jd=null==sa.j?null:sa.j.toString();null!=Jd&&(nd.Cycle=Jd);var Md=null==sa.k?null:sa.k.toString();null!=Md&&(nd.NotImplemented=
Md);var Je=null==sa.l?null:sa.l.toString();null!=Je&&(nd.InvalidInput=Je);var af=null==sa.m?null:sa.m.toString();null!=af&&(nd.AreDepCells=af);break;case 10:Cg="DependentCellsGraphStat";var gf=null==sa.a?null:sa.a.toString();null!=gf&&(nd.ParsedFormulas=gf);var of=null==sa.b?null:sa.b.toString();null!=of&&(nd.GraphNodes=of);var Cf=null==sa.c?null:sa.c.toString();null!=Cf&&(nd.GraphArcs=Cf);var Df=null==sa.d?null:sa.d.toString();null!=Df&&(nd.AnalyzedBlocks=Df);var Vf=null==sa.e?null:sa.e.toString();
null!=Vf&&(nd.IterationId=Vf);var qg=sa.f;null!=qg&&(nd.UniqueId=qg);var Gg=null==sa.g?null:sa.g.toString();null!=Gg&&(nd.Aborted=Gg);break;case 11:Cg="DependentCellsGraphSectionStat";var eg=null==sa.a?null:sa.a.toString();null!=eg&&(nd.IterationId=eg);var Jf=sa.b;null!=Jf&&(nd.BlockHash=Jf);var Rf=sa.c;null!=Rf&&(nd.Functions=Rf);var Kg=sa.d;null!=Kg&&(nd.Operators=Kg);var Uf=null==sa.e?null:sa.e.toString();null!=Uf&&(nd.CrossDocRefs=Uf);var nh=null==sa.f?null:sa.f.toString();null!=nh&&(nd.CrossSheetRefs=
nh);var zh=null==sa.g?null:sa.g.toString();null!=zh&&(nd.ErrRefs=zh);var Ph=null==sa.h?null:sa.h.toString();null!=Ph&&(nd.LargeRanges=Ph);var ii=null==sa.i?null:sa.i.toString();null!=ii&&(nd.NameRefs=ii);var Fh=null==sa.j?null:sa.j.toString();null!=Fh&&(nd.ParserErrors=Fh);var ji=null==sa.k?null:sa.k.toString();null!=ji&&(nd.RowRefs=ji);var Ii=null==sa.l?null:sa.l.toString();null!=Ii&&(nd.ColumnRefs=Ii);var mg=null==sa.m?null:sa.m.toString();null!=mg&&(nd.TableRefs=mg);var li=sa.n;null!=li&&(nd.UniqueId=
li);var Mh=null==sa.o?null:sa.o.toString();null!=Mh&&(nd.UnreachableReferences=Mh);break;case 12:Cg="GetRangeContentPrefetchFailures";var Ci=sa.a;null!=Ci&&(nd.UserSessionId=Ci);var oi=sa.b;null!=oi&&(nd.ClientStopwatchId=oi);var Wg=null==sa.c?null:sa.c.toString();null!=Wg&&(nd.StateId=Wg);break;case 13:Cg="GridBlockUpdates";var Rh=sa.a;null!=Rh&&(nd.UserSessionId=Rh);var Di=sa.b;null!=Di&&(nd.CorrelationId=Di);var xh=sa.c;null!=xh&&(nd.Operation=xh);var fh=null==sa.d?null:sa.d.toString();null!=fh&&
(nd.PerformanceType=fh);var bi=sa.e;null!=bi&&(nd.BlockHash=bi);var ei=null==sa.f?null:sa.f.toString();null!=ei&&(nd.DurationInMs=ei);break;case 14:Cg="BrowserAppStart";var Xf=null==sa.a?null:Me.a.eRa(sa.a.getTime());null!=Xf&&(nd.ScriptExecutionStart=Xf);var lh=sa.b;null!=lh&&(nd.UserSessionId=lh);var Ei=sa.c;null!=Ei&&(nd.ClockMechanism=Ei);var wi=null==sa.d?null:sa.d.toString();null!=wi&&(nd.ScreenDPI=wi);var yi=null==sa.e?null:sa.e.toString();null!=yi&&(nd.NavigationToScriptExecutionDelta=yi);
break;case 15:Cg="LinkedObjects";var Ji=sa.a;null!=Ji&&(nd.ChildId=Ji);var Ki=sa.b;null!=Ki&&(nd.ParentId=Ki);var zi=sa.c;null!=zi&&(nd.ChildTable=zi);var ig=sa.d;null!=ig&&(nd.ParentTable=ig);break;case 16:Cg="LongFrames";var ch=null==sa.a?null:Me.a.eRa(sa.a.getTime());null!=ch&&(nd.StartTime=ch);var Li=null==sa.b?null:sa.b.toString();null!=Li&&(nd.DurationInMs=Li);break;case 17:Cg="Task";var Vi=sa.a;null!=Vi&&(nd.StopwatchId=Vi);var Si=null==sa.b?null:sa.b.toString();null!=Si&&(nd.Status=Si);var Mi=
null==sa.c?null:sa.c.toString();null!=Mi&&(nd.CreateTime=Mi);var Ti=null==sa.d?null:sa.d.toString();null!=Ti&&(nd.TaskId=Ti);break;case 18:Cg="ConflictInEditing";var Ni=sa.a;null!=Ni&&(nd.OtherUserState=Ni);var Oi=sa.b;null!=Oi&&(nd.UserSessionId=Oi);var Ai=null==sa.c?null:Me.a.eRa(sa.c.getTime());null!=Ai&&(nd.ConflictTime=Ai);break;case 19:Cg="IncomingPresenceData";var Bi=sa.a;null!=Bi&&(nd.UserSessionId=Bi);var Yh=sa.b;null!=Yh&&(nd.UserId=Yh);var vi=null==sa.c?null:sa.c.toString();null!=vi&&(nd.Disconnected=
vi);var ki=null==sa.d?null:Me.a.eRa(sa.d.getTime());null!=ki&&(nd.ReceivedTime=ki);break;case 20:Cg="EditorTableDelay";var Pi=sa.a;null!=Pi&&(nd.UserSessionId=Pi);var gi=sa.b;null!=gi&&(nd.UserId=gi);var Qi=null==sa.c?null:sa.c.toString();null!=Qi&&(nd.Received=Qi);var ph=null==sa.d?null:sa.d.toString();null!=ph&&(nd.DurationInMs=ph);var Nh=null==sa.e?null:sa.e.toString();null!=Nh&&(nd.NotAloneAtLogTime=Nh);var Oh=null==sa.f?null:Me.a.eRa(sa.f.getTime());null!=Oh&&(nd.Time=Oh);break;case 21:Cg="PresenceStartup";
var Sh=sa.a;null!=Sh&&(nd.UserSessionId=Sh);var Z=null==sa.b?null:sa.b.toString();null!=Z&&(nd.EverReceived=Z);var tb=null==sa.c?null:sa.c.toString();null!=tb&&(nd.NotAloneOnOpen=tb);var $b=null==sa.d?null:sa.d.toString();null!=$b&&(nd.NotAloneAtLogTime=$b);var Yc=null==sa.e?null:sa.e.toString();null!=Yc&&(nd.EditorCount=Yc);var rd=null==sa.f?null:sa.f.toString();null!=rd&&(nd.WorkbookOpenToFirstReceivedInMs=rd);break;case 22:Cg="PresenceDelete";var Vd=sa.a;null!=Vd&&(nd.UserSessionId=Vd);var pe=
sa.b;null!=pe&&(nd.UserId=pe);var Ze=sa.c;null!=Ze&&(nd.Context=Ze);var tf=sa.d;null!=tf&&(nd.Reason=tf);var Nf=null==sa.e?null:Me.a.eRa(sa.e.getTime());null!=Nf&&(nd.Time=Nf);break;case 23:Cg="EditorEvent";var Bg=sa.a;null!=Bg&&(nd.UserSessionId=Bg);var Ng=sa.b;null!=Ng&&(nd.UserId=Ng);var sg=sa.c;null!=sg&&(nd.Context=sg);var wg=null==sa.d?null:Me.a.eRa(sa.d.getTime());null!=wg&&(nd.Time=wg);break;case 24:Cg="EditorTime";var vg=sa.a;null!=vg&&(nd.UserSessionId=vg);var si=sa.b;null!=si&&(nd.UserId=
si);var Lh=null==sa.c?null:sa.c.toString();null!=Lh&&(nd.DurationInMs=Lh);break;case 25:Cg="GridScreenReaderOps";var di=sa.a;null!=di&&(nd.UserSessionId=di);var ai=sa.b;null!=ai&&(nd.CommandTaskId=ai);var ci=null==sa.c?null:sa.c.toString();null!=ci&&(nd.CommandId=ci);var fi=null==sa.d?null:sa.d.toString();null!=fi&&(nd.ClientSideOnly=fi);var Jg=null==sa.e?null:sa.e.toString();null!=Jg&&(nd.DurationInMS=Jg);var Hh=null==sa.f?null:sa.f.toString();null!=Hh&&(nd.ReachedMaxReadoutCells=Hh);var D=null==
sa.g?null:sa.g.toString();null!=D&&(nd.RequstedCellCount=D);var ma=null==sa.h?null:sa.h.toString();null!=ma&&(nd.NonEmptyCellCount=ma);var Ua=null==sa.i?null:sa.i.toString();null!=Ua&&(nd.Succeeded=Ua);var Xb=null==sa.j?null:sa.j.toString();null!=Xb&&(nd.Canceled=Xb);var yc=sa.k;null!=yc&&(nd.ErrorType=yc);break;case 26:Cg="SendPresenceToService";var Tc=sa.a;null!=Tc&&(nd.UserSessionId=Tc);var Sc=null==sa.b?null:sa.b.toString();null!=Sc&&(nd.TotalCount=Sc);var Gd=null==sa.c?null:sa.c.toString();null!=
Gd&&(nd.SendCount=Gd);break;case 27:Cg="IME";var De=sa.a;null!=De&&(nd.UserSessionId=De);break;case 28:Cg="FreezePaneFloatingObjects";var ve=sa.a;null!=ve&&(nd.UserSessionId=ve);var Xe=null==sa.b?null:sa.b.toString();null!=Xe&&(nd.ObjectType=Xe);var nf=sa.c;null!=nf&&(nd.ObjectID=nf);var uf=null==sa.d?null:sa.d.toString();null!=uf&&(nd.SpannedPanesCount=uf);break;case 29:Cg="CustomizeStatusBar";var rg=sa.a;null!=rg&&(nd.UserSessionId=rg);var $f=sa.b;null!=$f&&(nd.UIControlName=$f);var og=null==sa.c?
null:sa.c.toString();null!=og&&(nd.IsControlVisible=og);break;case 30:Cg="ClientWebRequests";var bh=sa.a;null!=bh&&(nd.Path=bh);var mi=sa.b;null!=mi&&(nd.ProxyStopwatchId=mi);var ni=sa.c;null!=ni&&(nd.RequestStatus=ni);var Ui=null==sa.d?null:sa.d.toString();null!=Ui&&(nd.ResponseSizeInBytes=Ui);var Uj=sa.e;null!=Uj&&(nd.ClientRequestId=Uj);var Fj=null==sa.f?null:sa.f.toString();null!=Fj&&(nd.StateId=Fj);break;case 31:Cg="ShowCommentTaskPane";var xj=sa.a;null!=xj&&(nd.UserSessionId=xj);var aj=null==
sa.b?null:sa.b.toString();null!=aj&&(nd.IsFromKeyboardShortcut=aj);var Th=null==sa.c?null:sa.c.toString();null!=Th&&(nd.IsShowPane=Th);var mk=null==sa.d?null:sa.d.toString();null!=mk&&(nd.ShowForDeepLink=mk);var Vj=null==sa.e?null:sa.e.toString();null!=Vj&&(nd.DeepLinkFound=Vj);break;case 32:Cg="ApplyThreadedCommentChange";var pi=sa.a;null!=pi&&(nd.UserSessionId=pi);var fj=null==sa.b?null:sa.b.toString();null!=fj&&(nd.Operation=fj);var Fi=sa.c;null!=Fi&&(nd.CommentId=Fi);var Wj=null==sa.d?null:sa.d.toString();
null!=Wj&&(nd.CommentsCount=Wj);break;case 33:Cg="UpgradeLegacyCommentsChange";var gj=sa.a;null!=gj&&(nd.UserSessionId=gj);var Gj=null==sa.b?null:sa.b.toString();null!=Gj&&(nd.OperationSuccessful=Gj);break;case 34:Cg="FindNextOrPreviousComment";var nk=sa.a;null!=nk&&(nd.UserSessionId=nk);var hi=null==sa.b?null:sa.b.toString();null!=hi&&(nd.Succeeded=hi);break;case 35:Cg="Goto";var Hj=sa.a;null!=Hj&&(nd.UserSessionId=Hj);var hj=null==sa.b?null:sa.b.toString();null!=hj&&(nd.IsSucceeded=hj);var ok=null==
sa.c?null:sa.c.toString();null!=ok&&(nd.IsNOVMode=ok);break;case 36:Cg="LaunchOfficeAddInDialog";var Zh=sa.a;null!=Zh&&(nd.UserSessionId=Zh);var Qg=sa.b;null!=Qg&&(nd.SourceId=Qg);var Xj=sa.c;null!=Xj&&(nd.SourceLabel=Xj);var ij=sa.d;null!=ij&&(nd.Flight=ij);var jj=sa.e;null!=jj&&(nd.Experiment=jj);var bj=sa.f;null!=bj&&(nd.UICultureTag=bj);var Wi=null==sa.g?null:sa.g.toString();null!=Wi&&(nd.UICultureTagLcid=Wi);var Yj=null==sa.h?null:sa.h.toString();null!=Yj&&(nd.WacHostId=Yj);break;case 37:Cg=
"RichApiInvocation";var Ij=sa.a;null!=Ij&&(nd.UserSessionId=Ij);var kj=null==sa.b?null:sa.b.toString();null!=kj&&(nd.Succeeded=kj);var yj=sa.c;null!=yj&&(nd.ErrorType=yj);var zj=sa.d;null!=zj&&(nd.ResultInfo=zj);var Gh=sa.e;null!=Gh&&(nd.Source=Gh);break;case 38:Cg="FxLibrary";var cj=sa.a;null!=cj&&(nd.EntityName=cj);var Zj=null==sa.b?null:sa.b.toString();null!=Zj&&(nd.EntryPoint=Zj);var Jj=null==sa.c?null:sa.c.toString();null!=Jj&&(nd.Action=Jj);var lj=null==sa.d?null:sa.d.toString();null!=lj&&(nd.InsertLocation=
lj);break;case 39:Cg="EmbeddedApiSession";var mj=sa.a;null!=mj&&(nd.UserSessionId=mj);break;case 40:Cg="NumberFormattingCalculator";var ti=sa.a;null!=ti&&(nd.Id=ti);var Kj=sa.b;null!=Kj&&(nd.CounterName=Kj);var Lj=sa.c;null!=Lj&&(nd.Values=Lj);break;case 41:Cg="RequestDataAfterSend";var xi=sa.a;null!=xi&&(nd.ClientStopwatchId=xi);var ak=sa.b;null!=ak&&(nd.RequestStatus=ak);var Gi=null==sa.c?null:sa.c.toString();null!=Gi&&(nd.SendDuration=Gi);var Aj=null==sa.d?null:sa.d.toString();null!=Aj&&(nd.RequestId=
Aj);break;case 42:Cg="FloatingObjectsStopwatchData";var bk=sa.a;null!=bk&&(nd.StopMessage=bk);var nj=null==sa.b?null:sa.b.toString();null!=nj&&(nd.Type=nj);var qi=sa.c;null!=qi&&(nd.GUID=qi);var ck=null==sa.d?null:sa.d.toString();null!=ck&&(nd.Pane=ck);var Mj=null==sa.e?null:sa.e.toString();null!=Mj&&(nd.IsAboveGrid=Mj);var oj=sa.f;null!=oj&&(nd.StartCorrelation=oj);var pj=sa.g;null!=pj&&(nd.LoadImageCorrelation=pj);var qj=null==sa.h?null:sa.h.toString();null!=qj&&(nd.SkippedGetEffectsExtents=qj);
var dk=null==sa.i?null:sa.i.toString();null!=dk&&(nd.Version=dk);break;case 43:Cg="Copy";var ek=sa.a;null!=ek&&(nd.UserSessionId=ek);var fk=sa.b;null!=fk&&(nd.Trigger=fk);var Bj=sa.c;null!=Bj&&(nd.RibbonCommandName=Bj);var gk=sa.d;null!=gk&&(nd.SourceItem=gk);var pk=null==sa.e?null:sa.e.toString();null!=pk&&(nd.SourceRangeCellCount=pk);var rj=sa.f;null!=rj&&(nd.ClientSideStopwatchId=rj);var Nj=sa.g;null!=Nj&&(nd.CopyOperationId=Nj);var Oj=null==sa.h?null:sa.h.toString();null!=Oj&&(nd.IsAsync=Oj);
var Xi=null==sa.i?null:sa.i.toString();null!=Xi&&(nd.IsFromCache=Xi);var Cj=null==sa.j?null:sa.j.toString();null!=Cj&&(nd.IsSuccessiveCopy=Cj);var sj=null==sa.k?null:sa.k.toString();null!=sj&&(nd.IsSelectionAllowed=sj);var Yi=null==sa.l?null:sa.l.toString();null!=Yi&&(nd.IsSuccess=Yi);var dj=null==sa.m?null:sa.m.toString();null!=dj&&(nd.IsExpectedError=dj);var Dj=sa.n;null!=Dj&&(nd.ExpectedErrorReason=Dj);var tj=sa.o;null!=tj&&(nd.ErrorMessage=tj);var Pj=null==sa.p?null:sa.p.toString();null!=Pj&&
(nd.ClientSideCopyTimeInMs=Pj);var Qj=null==sa.q?null:sa.q.toString();null!=Qj&&(nd.TotalTimeInMs=Qj);var hk=null==sa.r?null:sa.r.toString();null!=hk&&(nd.PlainTextPayloadSize=hk);var Rj=sa.s;null!=Rj&&(nd.CopyPasteTargetType=Rj);var Sj=null==sa.t?null:sa.t.toString();null!=Sj&&(nd.ShadowWorkbookPayloadSize=Sj);var Zi=null==sa.u?null:sa.u.toString();null!=Zi&&(nd.HtmlPayloadSize=Zi);var Tj=null==sa.v?null:sa.v.toString();null!=Tj&&(nd.HtmlSizeExceedsLimit=Tj);var Ej=null==sa.w?null:sa.w.toString();
null!=Ej&&(nd.CopyTotalSizeExceedsLimit=Ej);var uj=null==sa.x?null:sa.x.toString();null!=uj&&(nd.ErrorReason=uj);var mh=sa.y;null!=mh&&(nd.ErrorName=mh);var ik=null==sa.z?null:sa.z.toString();null!=ik&&(nd.IsSucceededWithAlert=ik);var jk=null==sa.ba?null:sa.ba.toString();null!=jk&&(nd.EncounteredDeploymentErrors=jk);var vj=null==sa.bb?null:sa.bb.toString();null!=vj&&(nd.ShadowWorkbookSizeExceedsLimit=vj);var ej=sa.bc;null!=ej&&(nd.CopyPasteTargetName=ej);var Hi=sa.bd;null!=Hi&&(nd.CCPSliceName=Hi);
var wj=sa.be;null!=wj&&(nd.SyncClipboardItemsKeys=wj);var Ri=sa.bf;null!=Ri&&(nd.AsyncClipboardItemsKeys=Ri);var qk=sa.bg;null!=qk&&(nd.CopyPasteHandlerName=qk);var dh=sa.bh;null!=dh&&(nd.SucceededPopulatingSystemClipboardSync=dh);var kk=sa.bi;null!=kk&&(nd.SucceededPopulatingSystemClipboardAsync=kk);var rk=sa.bj;null!=rk&&(nd.Location=rk);var tg=sa.bk;null!=tg&&(nd.CopyContextId=tg);var $i=null==sa.bl?null:sa.bl.toString();null!=$i&&(nd.ServerRequestTimeInMs=$i);var ui=null==sa.bm?null:sa.bm.toString();
null!=ui&&(nd.EcsOperationDuration=ui);var H=null==sa.bn?null:sa.bn.toString();null!=H&&(nd.EcsRequestDuration=H);var r=null==sa.bo?null:sa.bo.toString();null!=r&&(nd.WfeRequestDuration=r);var M=null==sa.bp?null:sa.bp.toString();null!=M&&(nd.OriginalSourceRangesCountExceedsLimit=M);var la=null==sa.bq?null:sa.bq.toString();null!=la&&(nd.UploadToClipServiceAttempted=la);var Qa=null==sa.br?null:sa.br.toString();null!=Qa&&(nd.FloatingObjectType=Qa);var Kb=null==sa.bs?null:sa.bs.toString();null!=Kb&&(nd.IsCopyWithAsyncClipboardAPI=
Kb);break;case 44:Cg="Paste";var hc=sa.a;null!=hc&&(nd.UserSessionId=hc);var Ac=sa.b;null!=Ac&&(nd.Trigger=Ac);var Zc=sa.c;null!=Zc&&(nd.RibbonCommandName=Zc);var Ad=null==sa.d?null:sa.d.toString();null!=Ad&&(nd.PasteTypeFlagValue=Ad);var re=sa.e;null!=re&&(nd.PasteOperationId=re);var Ge=sa.f;null!=Ge&&(nd.CopyOperationId=Ge);var kf=sa.g;null!=kf&&(nd.ClientSideStopwatchId=kf);var sf=sa.h;null!=sf&&(nd.OriginalDestinationRange=sf);var Lf=sa.i;null!=Lf&&(nd.ExpandDestinationRange=Lf);var Pf=sa.j;null!=
Pf&&(nd.SourceItem=Pf);var kg=null==sa.k?null:sa.k.toString();null!=kg&&(nd.SourceRangeCellCount=kg);var yg=null==sa.l?null:sa.l.toString();null!=yg&&(nd.IsSuccess=yg);var Xg=null==sa.m?null:sa.m.toString();null!=Xg&&(nd.IsExpectedError=Xg);var Ig=sa.n;null!=Ig&&(nd.ClipboardFormatReadTimeInMs=Ig);var th=sa.o;null!=th&&(nd.ClipboardFormatReadStatus=th);var Ih=null==sa.p?null:sa.p.toString();null!=Ih&&(nd.ClipboardReadPermissionPromptShown=Ih);var ri=null==sa.q?null:sa.q.toString();null!=ri&&(nd.AsyncApiReadTimedOut=
ri);var lk=sa.r;null!=lk&&(nd.ExpectedErrorReason=lk);var sk=sa.s;null!=sk&&(nd.ErrorMessage=sk);var tk=null==sa.t?null:sa.t.toString();null!=tk&&(nd.TotalTimeInMs=tk);var zk=null==sa.u?null:sa.u.toString();null!=zk&&(nd.PlainTextPayloadSize=zk);var Ak=null==sa.v?null:sa.v.toString();null!=Ak&&(nd.ShadowWorkbookPayloadSize=Ak);var Bk=null==sa.w?null:sa.w.toString();null!=Bk&&(nd.HtmlPayloadSize=Bk);var Ck=sa.x;null!=Ck&&(nd.CopyPasteTargetType=Ck);var Dk=null==sa.y?null:sa.y.toString();null!=Dk&&
(nd.IsLastCopyWasExternal=Dk);var Ek=null==sa.z?null:sa.z.toString();null!=Ek&&(nd.IsClipboardDataContainShadowWorkbook=Ek);var Fk=null==sa.ba?null:sa.ba.toString();null!=Fk&&(nd.IsShadowWorkbookParsedSuccessfully=Fk);var Gk=sa.bb;null!=Gk&&(nd.ActiveSelectionType=Gk);var Hk=sa.bc;null!=Hk&&(nd.PasteResult=Hk);var Ik=null==sa.bd?null:sa.bd.toString();null!=Ik&&(nd.ErrorReason=Ik);var Jk=sa.be;null!=Jk&&(nd.ErrorName=Jk);var Kk=null==sa.bf?null:sa.bf.toString();null!=Kk&&(nd.IsSucceededWithAlert=Kk);
var Lk=null==sa.bg?null:sa.bg.toString();null!=Lk&&(nd.IsAfterCut=Lk);var Mk=null==sa.bh?null:sa.bh.toString();null!=Mk&&(nd.EncounteredDeploymentErrors=Mk);var Nk=null==sa.bi?null:sa.bi.toString();null!=Nk&&(nd.IsCrossSession=Nk);var Ok=null==sa.bj?null:sa.bj.toString();null!=Ok&&(nd.ShadowWorkbookSizeExceedsLimit=Ok);var Pk=null==sa.bk?null:sa.bk.toString();null!=Pk&&(nd.ClipboardContainXLOPayload=Pk);var Qk=sa.bl;null!=Qk&&(nd.CopyPasteTargetName=Qk);var Rk=sa.bm;null!=Rk&&(nd.ChromeExtensionId=
Rk);var Sk=sa.bn;null!=Sk&&(nd.PayloadOrigin=Sk);var Tk=sa.bo;null!=Tk&&(nd.PayloadType=Tk);var Uk=sa.bp;null!=Uk&&(nd.CCPSliceName=Uk);var Vk=sa.bq;null!=Vk&&(nd.ClipboardItemsKeys=Vk);var Wk=sa.br;null!=Wk&&(nd.CopyPasteHandlerName=Wk);var Xk=null==sa.bs?null:sa.bs.toString();null!=Xk&&(nd.IsSourceItemOriginSameSession=Xk);var Yk=sa.bt;null!=Yk&&(nd.Location=Yk);var Zk=sa.bu;null!=Zk&&(nd.ExternalAppSource=Zk);var $k=sa.bv;null!=$k&&(nd.PasteContextId=$k);var al=null==sa.bw?null:sa.bw.toString();
null!=al&&(nd.ServerRequestTimeInMs=al);var bl=null==sa.bx?null:sa.bx.toString();null!=bl&&(nd.IndicationDisplayScheduled=bl);var cl=sa.by;null!=cl&&(nd.PasteIndicationDisplayStatus=cl);var dl=null==sa.bz?null:sa.bz.toString();null!=dl&&(nd.PasteRecoveryUIDisplayed=dl);var el=null==sa.ca?null:sa.ca.toString();null!=el&&(nd.IsFromPasteRecoveryUI=el);var fl=null==sa.cb?null:sa.cb.toString();null!=fl&&(nd.EcsOperationDuration=fl);var gl=null==sa.cc?null:sa.cc.toString();null!=gl&&(nd.EcsRequestDuration=
gl);var hl=null==sa.cd?null:sa.cd.toString();null!=hl&&(nd.WfeRequestDuration=hl);var il=null==sa.ce?null:sa.ce.toString();null!=il&&(nd.OriginalSourceRangesCountExceedsLimit=il);var jl=sa.cf;null!=jl&&(nd.PasteRecoveryUndoStopwatchId=jl);var kl=null==sa.cg?null:sa.cg.toString();null!=kl&&(nd.PasteRecoveryUndoTimeInMs=kl);var ll=null==sa.ch?null:sa.ch.toString();null!=ll&&(nd.PasteCSEPerformed=ll);var ml=null==sa.ci?null:sa.ci.toString();null!=ml&&(nd.CSEStatus=ml);var nl=null==sa.cj?null:sa.cj.toString();
null!=nl&&(nd.IsFromEnterShortcut=nl);var ol=null==sa.ck?null:sa.ck.toString();null!=ol&&(nd.pasteDestinationHasMergedCells=ol);var pl=sa.cl;null!=pl&&(nd.ArtSourceItemType=pl);var ql=null==sa.cm?null:sa.cm.toString();null!=ql&&(nd.IsPasteWithAsyncClipboardAPI=ql);var rl=null==sa.cn?null:sa.cn.toString();null!=rl&&(nd.IsPasteWithChromiumExtension=rl);break;case 45:Cg="DragDrop";var sl=sa.a;null!=sl&&(nd.UserSessionId=sl);var tl=sa.b;null!=tl&&(nd.Trigger=tl);var ul=sa.c;null!=ul&&(nd.RibbonCommandName=
ul);var vl=sa.d;null!=vl&&(nd.OperationId=vl);var wl=sa.e;null!=wl&&(nd.ClientSideStopwatchId=wl);var xl=sa.f;null!=xl&&(nd.SourceRange=xl);var yl=sa.g;null!=yl&&(nd.DestinationRange=yl);var zl=sa.h;null!=zl&&(nd.CutCopyType=zl);var Al=null==sa.i?null:sa.i.toString();null!=Al&&(nd.IsShiftKeyDown=Al);var Bl=null==sa.j?null:sa.j.toString();null!=Bl&&(nd.IsDragInsert=Bl);var Cl=null==sa.k?null:sa.k.toString();null!=Cl&&(nd.IsSuccess=Cl);var Dl=null==sa.l?null:sa.l.toString();null!=Dl&&(nd.IsExpectedError=
Dl);var El=sa.m;null!=El&&(nd.ExpectedErrorReason=El);var Fl=sa.n;null!=Fl&&(nd.ErrorMessage=Fl);var Gl=null==sa.o?null:sa.o.toString();null!=Gl&&(nd.TotalTimeInMs=Gl);var Hl=sa.p;null!=Hl&&(nd.ErrorName=Hl);var Il=null==sa.q?null:sa.q.toString();null!=Il&&(nd.IsSucceededWithAlert=Il);var Jl=sa.r;null!=Jl&&(nd.CopyPasteTargetType=Jl);var Kl=null==sa.s?null:sa.s.toString();null!=Kl&&(nd.EncounteredDeploymentErrors=Kl);var Ll=null==sa.t?null:sa.t.toString();null!=Ll&&(nd.IsHeaderDrag=Ll);break;case 46:Cg=
"ClearCopyState";var Ml=sa.a;null!=Ml&&(nd.UserSessionId=Ml);var Nl=sa.b;null!=Nl&&(nd.ClientSideStopwatchId=Nl);var Ol=sa.c;null!=Ol&&(nd.Trigger=Ol);var Pl=null==sa.d?null:sa.d.toString();null!=Pl&&(nd.IsClearClipboard=Pl);var Ql=null==sa.e?null:sa.e.toString();null!=Ql&&(nd.IsExplicit=Ql);var Rl=null==sa.f?null:sa.f.toString();null!=Rl&&(nd.IsSuccess=Rl);var Sl=sa.g;null!=Sl&&(nd.ErrorMessage=Sl);var Tl=sa.h;null!=Tl&&(nd.ErrorName=Tl);var Ul=null==sa.i?null:sa.i.toString();null!=Ul&&(nd.TotalTimeInMs=
Ul);var Vl=sa.j;null!=Vl&&(nd.CopyPasteTargetType=Vl);break;case 47:Cg="WebWorkerRecalcStats";var Wl=null==sa.a?null:sa.a.toString();null!=Wl&&(nd.SuccessCount=Wl);var Xl=null==sa.b?null:sa.b.toString();null!=Xl&&(nd.FailureCount=Xl);var Yl=null==sa.c?null:sa.c.toString();null!=Yl&&(nd.ValueTypeMismatchCount=Yl);var Zl=null==sa.d?null:sa.d.toString();null!=Zl&&(nd.CellValueMismatchCount=Zl);var $l=null==sa.e?null:sa.e.toString();null!=$l&&(nd.IfmtMismatchCount=$l);var am=null==sa.f?null:sa.f.toString();
null!=am&&(nd.FormattedTextMismatchCount=am);var bm=null==sa.g?null:sa.g.toString();null!=bm&&(nd.CellValueStringMismatchCount=bm);var cm=null==sa.h?null:sa.h.toString();null!=cm&&(nd.CellValueNumberMismatchCount=cm);var dm=null==sa.i?null:sa.i.toString();null!=dm&&(nd.CellValueBooleanMismatchCount=dm);var em=null==sa.j?null:sa.j.toString();null!=em&&(nd.CellValueBlankMismatchCount=em);var fm=null==sa.k?null:sa.k.toString();null!=fm&&(nd.CellValueErrorMismatchCount=fm);var gm=null==sa.l?null:sa.l.toString();
null!=gm&&(nd.FormattedTextStringMismatchCount=gm);var hm=null==sa.m?null:sa.m.toString();null!=hm&&(nd.FormattedTextNumberMismatchCount=hm);var im=null==sa.n?null:sa.n.toString();null!=im&&(nd.FormattedTextBooleanMismatchCount=im);var jm=null==sa.o?null:sa.o.toString();null!=jm&&(nd.FormattedTextBlankMismatchCount=jm);var km=null==sa.p?null:sa.p.toString();null!=km&&(nd.FormattedTextErrorMismatchCount=km);var lm=null==sa.q?null:sa.q.toString();null!=lm&&(nd.StringMismatchCount=lm);var mm=null==sa.r?
null:sa.r.toString();null!=mm&&(nd.NumericMismatchCount=mm);var nm=null==sa.s?null:sa.s.toString();null!=nm&&(nd.ErrorMismatchCount=nm);var om=null==sa.t?null:sa.t.toString();null!=om&&(nd.StringValuesCount=om);var pm=null==sa.u?null:sa.u.toString();null!=pm&&(nd.NumericValuesCount=pm);var qm=null==sa.v?null:sa.v.toString();null!=qm&&(nd.BooleanValuesCount=qm);var rm=null==sa.w?null:sa.w.toString();null!=rm&&(nd.BlankValuesCount=rm);var sm=null==sa.x?null:sa.x.toString();null!=sm&&(nd.ErrorValuesCount=
sm);var tm=null==sa.y?null:sa.y.toString();null!=tm&&(nd.NumericValuesDiffAverage=tm);var um=sa.z;null!=um&&(nd.NumericEvaluatedValuesMismatchSamples=um);var vm=sa.ba;null!=vm&&(nd.NumericFormattedTextMismatchSamples=vm);var wm=sa.bb;null!=wm&&(nd.NumericMismatchSamples=wm);var xm=sa.bc;null!=xm&&(nd.CellValueTypeMismatchSamples=xm);var ym=sa.bd;null!=ym&&(nd.IfmtMismatchSamples=ym);var zm=sa.be;null!=zm&&(nd.BlockHashCode=zm);break;case 48:Cg="DataValidationEditOpenDialog";var Am=sa.a;null!=Am&&
(nd.ServerCommand=Am);var Bm=null==sa.b?null:sa.b.toString();null!=Bm&&(nd.SubDialogOpened=Bm);var Cm=sa.c;null!=Cm&&(nd.SubDialogButtonClicked=Cm);var Dm=null==sa.d?null:sa.d.toString();null!=Dm&&(nd.DialogOpened=Dm);var Em=sa.e;null!=Em&&(nd.RuleType=Em);var Fm=sa.f;null!=Fm&&(nd.ConditionType=Fm);var Gm=null==sa.g?null:sa.g.toString();null!=Gm&&(nd.LowerBoundaryFilled=Gm);var Hm=null==sa.h?null:sa.h.toString();null!=Hm&&(nd.UpperBoundaryFilled=Hm);var Im=null==sa.i?null:sa.i.toString();null!=Im&&
(nd.IgnoreBlank=Im);var Jm=null==sa.j?null:sa.j.toString();null!=Jm&&(nd.InCellDropdown=Jm);var Km=null==sa.k?null:sa.k.toString();null!=Km&&(nd.ShowInputMessage=Km);var Lm=null==sa.l?null:sa.l.toString();null!=Lm&&(nd.InputTitleFilled=Lm);var Mm=null==sa.m?null:sa.m.toString();null!=Mm&&(nd.InputMessageFilled=Mm);var Nm=null==sa.n?null:sa.n.toString();null!=Nm&&(nd.ShowErrorAlert=Nm);var Om=null==sa.o?null:sa.o.toString();null!=Om&&(nd.AlertBlocking=Om);var Pm=null==sa.p?null:sa.p.toString();null!=
Pm&&(nd.AlertTitleFilled=Pm);var Qm=null==sa.q?null:sa.q.toString();null!=Qm&&(nd.AlertMessageFilled=Qm);var Rm=sa.r;null!=Rm&&(nd.StopWatchId=Rm);break;case 49:Cg="DataValidationEditSubmitRule";var Sm=sa.a;null!=Sm&&(nd.RuleType=Sm);var Tm=sa.b;null!=Tm&&(nd.ConditionType=Tm);var Um=null==sa.c?null:sa.c.toString();null!=Um&&(nd.LowerBoundaryFilled=Um);var Vm=null==sa.d?null:sa.d.toString();null!=Vm&&(nd.UpperBoundaryFilled=Vm);var Wm=null==sa.e?null:sa.e.toString();null!=Wm&&(nd.IgnoreBlank=Wm);
var Xm=null==sa.f?null:sa.f.toString();null!=Xm&&(nd.InCellDropdown=Xm);var Ym=null==sa.g?null:sa.g.toString();null!=Ym&&(nd.ShowInputMessage=Ym);var Zm=null==sa.h?null:sa.h.toString();null!=Zm&&(nd.InputTitleFilled=Zm);var $m=null==sa.i?null:sa.i.toString();null!=$m&&(nd.InputMessageFilled=$m);var an=null==sa.j?null:sa.j.toString();null!=an&&(nd.ShowErrorAlert=an);var bn=null==sa.k?null:sa.k.toString();null!=bn&&(nd.AlertBlocking=bn);var cn=null==sa.l?null:sa.l.toString();null!=cn&&(nd.AlertTitleFilled=
cn);var dn=null==sa.m?null:sa.m.toString();null!=dn&&(nd.AlertMessageFilled=dn);var en=null==sa.n?null:sa.n.toString();null!=en&&(nd.ClearAllPressed=en);var fn=sa.o;null!=fn&&(nd.ActionStatus=fn);var gn=sa.p;null!=gn&&(nd.Error=gn);var hn=sa.q;null!=hn&&(nd.StopWatchId=hn);var jn=null==sa.r?null:sa.r.toString();null!=jn&&(nd.InsertDropdownButton=jn);break;case 50:Cg="CustomSort";var kn=sa.a;null!=kn&&(nd.RangeType=kn);var ln=null==sa.b?null:sa.b.toString();null!=ln&&(nd.HasHeaders=ln);var mn=null==
sa.c?null:sa.c.toString();null!=mn&&(nd.SortTopToBottom=mn);var nn=null==sa.d?null:sa.d.toString();null!=nn&&(nd.ColumnCount=nn);var on=null==sa.e?null:sa.e.toString();null!=on&&(nd.RowCount=on);var pn=null==sa.f?null:sa.f.toString();null!=pn&&(nd.RangeLimitExceeded=pn);var qn=null==sa.g?null:sa.g.toString();null!=qn&&(nd.CaseSensitive=qn);var rn=null==sa.h?null:sa.h.toString();null!=rn&&(nd.GetSortInfoDuration=rn);var sn=null==sa.i?null:sa.i.toString();null!=sn&&(nd.LevelCount=sn);var tn=null==sa.j?
null:sa.j.toString();null!=tn&&(nd.SortOnValuesCount=tn);var un=null==sa.k?null:sa.k.toString();null!=un&&(nd.SortOnCellColorCount=un);var vn=null==sa.l?null:sa.l.toString();null!=vn&&(nd.SortOnFontColorCount=vn);var wn=null==sa.m?null:sa.m.toString();null!=wn&&(nd.SortOnIconCount=wn);var xn=null==sa.n?null:sa.n.toString();null!=xn&&(nd.CustomOrderCount=xn);var yn=null==sa.o?null:sa.o.toString();null!=yn&&(nd.AvgCellColorCount=yn);var zn=null==sa.p?null:sa.p.toString();null!=zn&&(nd.MaxCellColorCount=
zn);var An=null==sa.q?null:sa.q.toString();null!=An&&(nd.AvgFontColorCount=An);var Bn=null==sa.r?null:sa.r.toString();null!=Bn&&(nd.MaxFontColorCount=Bn);var Cn=null==sa.s?null:sa.s.toString();null!=Cn&&(nd.AvgIconsCount=Cn);var Dn=null==sa.t?null:sa.t.toString();null!=Dn&&(nd.MaxIconsCount=Dn);var En=null==sa.u?null:sa.u.toString();null!=En&&(nd.Executed=En);break;case 51:Cg="NamedSheetViewUserAction";var Fn=sa.a;null!=Fn&&(nd.UserSessionId=Fn);var Gn=sa.b;null!=Gn&&(nd.UserActionName=Gn);var Hn=
null==sa.c?null:sa.c.toString();null!=Hn&&(nd.UserActionSource=Hn);var In=sa.d;null!=In&&(nd.UserActionData=In);var Jn=sa.e;null!=Jn&&(nd.OtherData=Jn);break;case 52:Cg="NamedSheetViewTeachingCallout";var Kn=sa.a;null!=Kn&&(nd.UserSessionId=Kn);var Ln=null==sa.b?null:sa.b.toString();null!=Ln&&(nd.TeachingCalloutSequence=Ln);var Mn=null==sa.c?null:sa.c.toString();null!=Mn&&(nd.TeachingCalloutIndex=Mn);var Nn=null==sa.d?null:sa.d.toString();null!=Nn&&(nd.UserActionName=Nn);var On=sa.e;null!=On&&(nd.UserActionData=
On);var Pn=null==sa.f?null:sa.f.toString();null!=Pn&&(nd.DurationInMs=Pn);break;case 53:Cg="NamedSheetViewTeachingDialog";var Qn=sa.a;null!=Qn&&(nd.UserSessionId=Qn);var Rn=sa.b;null!=Rn&&(nd.UserActionName=Rn);var Sn=sa.c;null!=Sn&&(nd.ButtonClicked=Sn);var Tn=null==sa.d?null:sa.d.toString();null!=Tn&&(nd.DurationInMs=Tn);var Un=null==sa.e?null:sa.e.toString();null!=Un&&(nd.IsNewTeachingDialog=Un);break;case 54:Cg="NamedSheetViewOptionsDialog";var Vn=sa.a;null!=Vn&&(nd.UserSessionId=Vn);var Wn=null==
sa.b?null:sa.b.toString();null!=Wn&&(nd.OptionsAction=Wn);var Xn=sa.c;null!=Xn&&(nd.OptionsActionData=Xn);var Yn=sa.d;null!=Yn&&(nd.OptionsOtherData=Yn);var Zn=null==sa.e?null:sa.e.toString();null!=Zn&&(nd.DurationInMs=Zn);break;case 55:Cg="NamedSheetViewTempViewSaveDialog";var $n=sa.a;null!=$n&&(nd.UserSessionId=$n);var ao=sa.b;null!=ao&&(nd.TriggeredFrom=ao);var bo=sa.c;null!=bo&&(nd.ButtonClicked=bo);var co=null==sa.d?null:sa.d.toString();null!=co&&(nd.NameUpdated=co);var eo=null==sa.e?null:sa.e.toString();
null!=eo&&(nd.DurationInMs=eo);break;case 56:Cg="TemporaryViewStartedDataRestore";var fo=sa.a;null!=fo&&(nd.UserSessionId=fo);var go=null==sa.b?null:sa.b.toString();null!=go&&(nd.CountOfTempViews=go);break;case 57:Cg="TemporaryViewFetchedVersion";var ho=sa.a;null!=ho&&(nd.UserSessionId=ho);var io=null==sa.b?null:sa.b.toString();null!=io&&(nd.NumberOfBytes=io);break;case 58:Cg="RaiseEventsAndGenerateBlockRequests";var jo=null==sa.a?null:sa.a.toString();null!=jo&&(nd.ReturnContentStatus=jo);var ko=
null==sa.b?null:sa.b.toString();null!=ko&&(nd.CacheState=ko);var lo=null==sa.c?null:sa.c.toString();null!=lo&&(nd.FromXhrCallback=lo);var mo=null==sa.d?null:sa.d.toString();null!=mo&&(nd.AreGeneralErrorsPresent=mo);var no=sa.e;null!=no&&(nd.BlockCacheItemHash=no);var oo=sa.f;null!=oo&&(nd.StopwatchId=oo);var po=sa.g;null!=po&&(nd.BlockCacheItemProcessingStopwatchId=po);var qo=null==sa.h?null:sa.h.toString();null!=qo&&(nd.StateId=qo);var ro=null==sa.i?null:sa.i.toString();null!=ro&&(nd.IsHighPriority=
ro);var so=null==sa.j?null:sa.j.toString();null!=so&&(nd.CalcComplete=so);var to=null==sa.k?null:sa.k.toString();null!=to&&(nd.EditedCellsUpdatedByCse=to);var uo=null==sa.l?null:sa.l.toString();null!=uo&&(nd.DependentCellsUpdatedByCse=uo);var vo=null==sa.m?null:sa.m.toString();null!=vo&&(nd.Revision=vo);var wo=null==sa.n?null:sa.n.toString();null!=wo&&(nd.SheetProcessedDataVersion=wo);var xo=null==sa.o?null:sa.o.toString();null!=xo&&(nd.RefCount=xo);var yo=null==sa.p?null:sa.p.toString();null!=yo&&
(nd.ExistsInView=yo);var zo=null==sa.q?null:sa.q.toString();null!=zo&&(nd.ContentSource=zo);break;case 59:Cg="LaunchMakerCodeEditor";var Ao=sa.a;null!=Ao&&(nd.SessionId=Ao);var Bo=sa.b;null!=Bo&&(nd.Command=Bo);var Co=null==sa.c?null:sa.c.toString();null!=Co&&(nd.IsPreviewGallery=Co);var Do=sa.d;null!=Do&&(nd.MenuItemId=Do);var Eo=sa.e;null!=Eo&&(nd.ScriptId=Eo);var Fo=sa.f;null!=Fo&&(nd.ShareId=Fo);var Go=null==sa.g?null:sa.g.toString();null!=Go&&(nd.IsOwner=Go);var Ho=null==sa.h?null:sa.h.toString();
null!=Ho&&(nd.PublishedScriptCount=Ho);var Io=null==sa.i?null:sa.i.toString();null!=Io&&(nd.RecentScriptCount=Io);var Jo=null==sa.j?null:sa.j.toString();null!=Jo&&(nd.WorkbookScriptCount=Jo)}nd.Table=Cg;var Po=Sys.Serialization.JavaScriptSerializer.serialize(nd);Sd.call(yd,3704927,0,50,Po)}}catch(nd){u.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${wa} exception: ${nd}`)}}eqd(wa,sa,fc){if(this.gGc){const yd=this.m6a[wa+sa];yd&&(yd.e=fc,this.htd(yd));delete this.m6a[wa+sa]}}NOd(wa,
sa){Dg[wa]in this.CRf||this.Fi(wa,sa)}gEj(){this.ol.appStart&&this.fCg(Fb.aYd,this.ol.appStart)}Laj(wa){const sa={};sa.a=wa.i;sa.b=wa.o;sa.c=wa.t;sa.d=ug.a(wa.s,wa.p||this.ol.appStart);sa.e=ug.a(wa.e,wa.s);sa.f=wa.c;sa.g=wa.a;sa.h=wa.h;this.Fi(0,sa,this.JZi(sa.b,sa.c))}JZi(wa,sa){return["CommandTask","QueuedTask","Task"].includes(wa)&&!this.I6h.includes(sa)?!1:!0}vF(wa,sa,fc,yd,Sd){if(wa&&sa){const Ie={};Ie.a=wa;Ie.b=sa;Ie.c=fc.toString();Ie.d=yd.toString();this.Fi(15,Ie,void 0===Sd?!0:Sd)}}kRf(wa,
sa,fc,yd){const Sd={};wa&&(Sd.c=ug.a(wa,this.ol.appStart));Sd.b=sa;Sd.a=fc;Sd.d=yd;this.Fi(17,Sd)}dispose(){this.GIa.execute(wa=>{wa.deactivate(!0);wa.OUj(this.k6f)});this.ph&&this.ph.C_a(this.HK);super.dispose()}Nvf(){return this.DOg=this.DOg||new Sf}c4e(wa,sa,fc,yd,Sd){const Ie={};Ie.o=wa;Ie.t=sa;Ie.p=void 0===Sd?null:Sd;Ie.s=(void 0===yd?null:yd)||this.ol.zh;this.KFd(Ie,void 0===fc?null:fc);return Ie}J_e(wa,sa){wa&&(wa.e=(void 0===sa?null:sa)||this.ol.zh,wa.i=wa.i||this.X$a.Eib(),wa.c=wa.c||this.K4e,
wa.a=wa.a||this.V4e,wa.h=void 0!==wa.h&&null!==wa.h?wa.h:this.ph?this.ph.tk:!1,this.htd(wa))}tRf(wa){const sa=wa.context;wa.duration>Fb.OUh&&(sa.methodName===He.a.fJb||sa.methodName===He.a.YDa)&&this.TJc(1,Fb.dvi);if("GetSessionStatus"!==sa.methodName){const fc={};fc.a=sa.methodName;fc.b=sa.stopwatch.id;fc.c=wa.eKc;fc.d=wa.responseSize;fc.e=sa.CQa;fc.f=wa.Jg?wa.Jg.StateId:He.a.gie;this.Fi(30,fc,!0);this.vF(fc.b,wa.Jg.ServerCorrelationId,"clientWebRequests","ServerActions")}}UCg(){if(this.gGc){const wa=
this.m6a.LoadingUIShownSplashScreen;wa&&Cb.a.instance.Gak(wa.s)}}TJc(wa,sa){this.jNg.RWb(wa,sa,null)}tmg(wa,sa){this.DTc.WYj(wa,void 0===sa?null:sa)}smg(wa,sa,fc){this.DTc.VYj(wa,sa,void 0===fc?null:fc)}umg(wa){this.DTc.G5d(wa,null)}vmg(wa,sa){this.DTc.RWb(wa,sa,null)}QJc(wa,sa,fc){this.n3a.QJc(wa,sa,void 0===fc?null:fc)}XJc(wa,sa,fc){this.n3a.XJc(wa,sa,void 0===fc?null:fc)}sYb(wa,sa,fc,yd,Sd,Ie,pf,...If){this.n3a.sYb(wa,sa,fc,yd,Sd,Ie,pf,...If)}SLc(wa,sa,fc,yd,Sd,Ie,pf){this.n3a.SLc(wa,sa,fc,yd,
Sd,Ie,pf)}uYb(wa,sa,fc,yd,Sd,Ie){this.n3a.uYb(wa,sa,fc,yd,Sd,Ie)}tYb(wa,sa,fc,yd,Sd,Ie,...pf){this.n3a.tYb(wa,sa,fc,yd,Sd,Ie,...pf)}vYb(wa,sa,fc,yd,Sd,Ie){this.jNg.vYb(wa,sa,fc,yd,Sd,Ie)}TLc(wa,sa,fc,yd){this.n3a.TLc(wa,sa,fc,yd)}htd(wa){this.Oqk.Laj(wa)}hEj(){if(this.gGc){Stw.swpc=null;const wa=this.gGc;for(const sa in wa)this.KFd(wa[sa])}}L9h(){const wa=window[gg.a.namespace];if(wa){const sa=wa[gg.a.HZe];sa&&(delete wa[gg.a.HZe],sa.forEach(fc=>{this.KFd(fc);this.htd(fc)}))}}e0i(wa,sa){if("about:blank"===
wa||"renamehandler.ashx"===sa&&"2"===J.a.$x(wa,"u"))return!0;for(wa=0;wa<this.U5d.length;wa++)if(sa.endsWith(this.U5d[wa]))return!0;return!1}h9i(){this.GIa.execute(wa=>{wa.dl(Fb.Amh,0);wa.Ddh(this.k6f);wa.activate()})}$8i(){const wa={};wa.a=new Date(gc.EcmaDateClock.instance.appStart.m);wa.b=this.userSessionId;wa.c=this.ol.VFg;wa.d=Fb.eOh*w.devicePixelRatio;wa.e=Vc.a.Ae.appStart.m;this.Fi(14,wa,!0);this.pta(Vc.a.Ae.appStart.m,Object(qa.a)(L.a.instance,L.a.instance.vOj,"recordAppInitStart"))}fCg(wa,
sa){this.erb=this.X$a.Eib();this.X1b=this.X$a.Eib();this.QLa=wa;this.lPc("UserAction",wa,this.X1b,sa);this.fQf(wa,this.erb)}jtk(){const wa=window[gg.a.namespace];wa&&!Fb.k2e&&(wa[gg.a.Opk]=(sa,fc)=>this.c4e(sa,fc),wa[gg.a.lXh]=sa=>{this.J_e(sa)},Fb.k2e=!0)}ECk(wa){const sa=zg.jqh(wa.o,wa.t),fc=new zg(ug.a(wa.e,wa.s)),yd=sa in this.Nee?this.Nee[sa].gAh(fc):fc;this.Nee[sa]=yd;if(fc===yd||fc.average!==yd.average)wa=Object(fa.a)(new Dh,{operation:wa.o,target:wa.t,xhj:yd.average,sender:this}),this.raiseEvent(sa,
wa)}fQf(wa,sa){const fc={};fc.a=sa;fc.b=this.userSessionId;fc.c=wa;this.Fi(1,fc,!0)}KNi(){this.U5d=[He.a.pSj,He.a.getSessionStatus,He.a.YDa,He.a.Uzh,He.a.Kwh,He.a.Wqb,He.a.$qc,He.a.getObjectMetadata,He.a.Gsi,He.a.setRichTextCell,He.a.cEa,He.a.bHk,He.a.pollSessionStatus,He.a.qyi,He.a.pwi,He.a.Fpi]}KFd(wa,sa){wa.i=(void 0===sa?null:sa)||this.X$a.Eib();wa.a=this.V4e;wa.c=this.K4e;wa.h=this.ph?this.ph.tk:!1}static ta(wa){const sa=new Fb(wa.xa.UserSessionId,wa.ja,void 0,void 0,void 0,!0);sa.fQf(Fb.TWf,
sa.H5e);u.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");sa.h9i();sa.jtk();sa.gEj();sa.$8i();sa.L9h();sa.hEj();sa.KNi();Fb.h9j(wa);qf.a.Tq.$c(41,sa)}static h9j(wa){const sa=w.devicePixelRatio;1<sa&&wa.ff.tA(!0,2<=sa?8388608:4194304)}}Fb.TWf="UnassignedUserAction";Fb.aYd="PageLoad";Fb.aCd="GridUpdateOperation";Fb.OUh=5E3;Fb.dvi="MoreThan_5000_Ms";Fb.eOh=96;Fb.Amh=30;Fb.k2e=!1;Object(t.a)(Fb,"TelemetryManager",Ne.a,[10,11,411,412]);var rc=a(219),
Hc=a(115);class $c{constructor(wa,sa,fc){this.uJk=wa;this.K_=sa;this.name=fc}}Object(t.a)($c,"Validation",null,[]);var Hd;let Ud=Hd=class{constructor(wa){this.zjb=()=>{this.fag(this.sjf)};this.zl=()=>{this.fag(this.Lnh)};this.$=wa;this.Lnh=new od.a;this.sjf=new od.a;lc.h(this.$).ya.Uu(this.zl);lc.h(this.$).ya.WLe(this.zjb)}Ead(wa,sa,fc,yd,Sd){if(wa&&yd){const Ie=rc.a.cE(sa,fc);this.Gbc(()=>!!Hc.a(wa).lv(Ie),yd.StateId,Sd)}}Gbc(wa,sa,fc){this.mch(this.sjf,wa,sa,fc)}mch(wa,sa,fc,yd){wa&&sa&&fc!==He.a.th&&
wa.add(new $c(sa,fc,yd))}fag(wa){if(wa){var sa=new od.a;for(const fc of wa){if(fc.K_===this.$.ea.uh)try{fc.uJk()||u.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${fc.name}]`)}catch(yd){u.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${fc.name}]. Exception: [${yd}]`)}sa.add(fc)}for(const fc of sa)wa.remove(fc)}else u.ULS.shipAssertTag(537151011,
0,!!wa,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){lc.h(this.$)&&lc.h(this.$).ya&&(lc.h(this.$).ya.Ot(this.zl),lc.h(this.$).ya.E3d(this.zjb));this.$=null}static ta(wa){const sa=new Hd(wa);wa.ja.$c(277,sa)}};Ud=Hd=Object(V.__decorate)([Object(Lc.d)(ad.re),Object(V.__param)(0,Object(ad.nb)())],Ud);Object(t.a)(Ud,"ValidationTelemetryManager",null,[387,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");F.main();Type.registerNamespace("CNT");
za.main();Type.registerNamespace("CACPU");Tb.main();Type.registerNamespace("Common.App.EventsCacheManager");lb.main();(()=>{Ya.a.Na(wa=>{wa.ja.$c(137,new Ib(wa))})})();(()=>{Ya.a.Na(wa=>{wa.ja.$c(37,new Ma(wa))})})();(()=>{Ya.a.Na(wa=>{wa.ja.$c(40,new xd(wa,new Zb.a(()=>zd.GetServiceTaskFactory.create(wa.ja,137,wa.qa,1))))})})();(()=>{Ya.a.Na(wa=>{wa.ja.$c(276,new mf(wa))})})();(()=>{Ya.a.Na(wa=>{qf.a.Tq.Ne(135,()=>{Fb.ta(wa);sd.ta(wa);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")||
Ud.ta(wa);wf.ta(wa);Jc.ta(wa);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateRenderingFidelityTracker",!1)||fg.RenderingFidelityTracker.ta(wa)})})})();String(k);String(m);String(d);String(n);String(l);String(f);String(h);String(fg);window.___1699049107586_closurehack=k;window.___1699049107586_closurehack=m;window.___1699049107586_closurehack=d;window.___1699049107586_closurehack=n;window.___1699049107586_closurehack=l;window.___1699049107586_closurehack=f;window.___1699049107586_closurehack=
h;window.___1699049107586_closurehack=fg},809:function(B,A,a){function c(d,n){n=void 0===n?{}:n;return b.AFrameworkApplication.fa.la("IsWebpack5RibbonEnabled")?runtime.loadChunk(d):k.a.resolve(m.hb,n).then(l=>l(d))}a.d(A,"a",function(){return c});var b=a(5),k=a(146),m=a(8)},825:function(B,A,a){a.d(A,"a",function(){return m});B=a(0);var c=a(1),b=a(146),k=a(8);class m{static iCf(d){m.$=d;c.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void b.a.resolve(k.db).then(n=>
{m.ph=n}):m.$.ja.Ne(291,n=>{m.ph=n})}static jra(d,n){return d[Math.round((d.length-1)*n/100)]}static jI(d){return m.ph?m.ph.jI(d):!1}}m.ph=null;m.$=null;Object(B.a)(m,"SessionStatisticsManagerHelper",null,[])},832:function(B,A,a){a.d(A,"a",function(){return u});B=a(0);var c=a(5),b=a(77),k=a(35),m=a(32),d=a(185);class n{constructor(v,y){this.message=v;this.lSa=y}}Object(B.a)(n,"CrossDocumentEventArgs",null,[]);var l=a(859),f=a(538),h=a(272),t=a(889);class u{constructor(v,y,C,x){this._name="";this.vL=
{};this.iNa=null;this.ackMessageHandler=w=>{w=w.CorrelationId;""!==w&&w in this.vL&&(t.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.vL[w],w),this.vL[w]="ACK_RECEIVED")};this.HRd=w=>{const z=this.dzd(w);if(!z)return!1;if(this.FD[z.MessageId])return this.D9.ofb(this.FD[z.MessageId],z),!0;if(this.HL[z.MessageId]){const F=this.HL[z.MessageId];w=new n(z,w);this.D9.oGd(F,w);return!0}return!1};this.Q9=[];this.r9=[];this.s9=[];this.N9=[];this.Exb=v;this.Dxb=y;this.FD={};
this.HL={};this.D9=C;u._id++;x&&x();this.wx=this.enable()}get targetOrigin(){return this.Dxb}get p0b(){return this.Exb}enable(){if(!h.a())return t.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.gGd();t.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.wx}gGd(){t.a.debugAssertTag(5018253,!!this.D9,null);this.iNa=this.HRd;this.D9.AAb(this.iNa,null)}disable(){this.wx=!1;this.Q9=[];this.r9=[];this.s9=[];this.N9=[];this.Exb=null;this.Dxb="";this.D9.LEb(this.iNa);
this.FD={};this.HL={}}dispose(){this.disable()}oNb(v){return!!this.Q9&&Array.contains(this.Q9,v)||this.nNb(v)}nNb(v){return!!this.r9&&Array.contains(this.r9,v)}rp(v){t.a.debugAssertTag(5018259,!!this.Q9,null);Array.add(this.Q9,v);t.a.sendTraceTag(5018260,2,"Allow receiving : {0}",v)}H7a(v){t.a.debugAssertTag(5018261,!!this.r9,null);Array.add(this.r9,v);t.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",v)}lJd(v){return!!this.s9&&Array.contains(this.s9,v)}hV(v){t.a.debugAssertTag(5018263,!!this.s9,
null);Array.add(this.s9,v);t.a.sendTraceTag(5018264,2,"Allow free sending: {0}",v)}DJd(v){v=b.a.c0(v);return!!v&&!!this.N9&&Array.contains(this.N9,v)}kZ(v){t.a.debugAssertTag(5018265,!!this.N9,null);if(v===u.zZ)return t.a.debugAssertTag(5018266,!1,null),!1;let y=b.a.c0(v);if(!y)return t.a.sendTraceTag(5018267,4,"Get origin fail:{0}",v),!1;c.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(y=m.a.Po(y));Array.add(this.N9,y);t.a.sendTraceTag(5018268,
2,"Add origin:{0}",y);return!0}send(v,y){y=void 0===y?null:y;let C=this.targetOrigin;if(y){y=b.a.c0(y);if(!y)return!1;C=y}return this.Bva(v,this.p0b,C)}sendMessage(v,y,C){C=(C=void 0===C?"":C)&&""!==C?C:d.a.create().toString();return this.send(this.bZa(v,y,C,c.AFrameworkApplication.userSessionId))}postMessage(v){const y=d.a.create().toString();if(!c.AFrameworkApplication.fa.la("RetryablePostMessagingIsEnabled")||!v.awa)return this.send(this.bZa(v.messageId,v.values,y,v.userSessionId));this.FD[v.Tza]||
(this.rp(v.Tza),this.Dn(v.Tza,this.ackMessageHandler));this.vL[y]="";return this.wUb(v,y,1)}wUb(v,y,C){if(""!==y&&y in this.vL&&"ACK_RECEIVED"===this.vL[y])return delete this.vL[y],!0;if(C>v.bQ)return t.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',v.Tza,y),delete this.vL[y],!1;t.a.sendTraceTag(40716251,1<C?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',v.bQ-C,v.messageId,y);C++;window.setTimeout(()=>{this.wUb(v,
y,C)},v.aJe);v.values[f.a.$Ie]=!0;return this.send(this.bZa(v.messageId,v.values,y,v.userSessionId))}bZa(v,y,C,x){v=new l.a(v);v.CorrelationId=C;y&&(v.Values=y);v.Values.wdUserSession=x;return v}Bva(v,y,C){t.a.debugAssertTag(5018269,!!v,null);if(!this.wx)return!1;t.a.debugAssertTag(5018270,!!y,null);t.a.debugAssertTag(5018271,!!C,null);if(!y||!C)return t.a.debugAssertTag(5018272,!1,null),!1;if(C===u.zZ&&!this.lJd(v.MessageId))return t.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:v.MessageId}),
!1;v.SendTime=(new Date).getTime();let x="";try{x=Sys.Serialization.JavaScriptSerializer.serialize(v)}catch(w){return t.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:w.message}),!1}y=u.sendMessage(y,x,C);t.a.sendTraceTag(5018275,2,"Send {0}. {1}",y?"succeeded":"failed",{["id"]:v.MessageId,["origin"]:C});return y}Dn(v,y){t.a.debugAssertTag(5018304,!!y,null);t.a.debugAssertTag(5018305,!!this.FD&&!!this.HL,null);if(!this.wx)return!1;if(!this.oNb(v))return t.a.sendTraceTag(5018306,2,"Not allow receiving {0}",
{["id"]:v}),!1;this.FD[v]!==y&&(t.a.debugAssertTag(5018307,!this.FD[v]&&!this.HL[v],null),this.FD[v]=y,delete this.HL[v]);return!0}iY(v){this.wx&&(this.FD[v]&&delete this.FD[v],this.HL[v]&&delete this.HL[v])}dzd(v){const y=new Date;this.kPd(v);if(!v.origin||!v.source||void 0===v.data||null===v.data)return t.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const C=this.vMd(v.data);if(!C)return null;if(!this.DJd(v.origin)){if(!this.nNb(C.MessageId))return t.a.sendTraceTag(5018309,
1,"{0}",{["id"]:C.MessageId}),null;if(!k.a.r6&&v.source!==this.p0b)return t.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}t.a.debugAssertTag(5018311,!!C.Values,null);C.Values.m_Source=v.source;C.Values.m_Origin=v.origin;C.Values.m_ReceivedTime=y.getTime();return C}vMd(v){if(!v)return null;let y=null;try{y=Sys.Serialization.JavaScriptSerializer.deserialize(v,!0)}catch(w){return 2>u.gtb&&(t.a.sendTraceTag(5018312,2,"Deser failed"),u.gtb++),null}if(!y)return t.a.debugAssertTag(5018313,
!1,null),null;for(v=0;v<u.Qpa.length;v++)if(!y[u.Qpa[v]])return"MessageId"!==u.Qpa[v]&&t.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",u.Qpa[v]),null;if(y.Values)try{y.Values}catch(w){return t.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",w.message),null}else t.a.sendTraceTag(41502556,2,"No values in message");v=y.MessageId;if(!this.oNb(v))return t.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:v}),null;const C=y.SendTime,x=(new Date).getTime()-C;if(0>C)return t.a.sendTraceTag(520435660,
2,"{0}",{["t"]:C,["id"]:v}),null;6E4<x&&t.a.sendTraceTag(520435659,2,"{0}",{["t"]:C,["delta"]:x,["id"]:v});-300>x&&t.a.sendTraceTag(520435658,2,"{0}",{["t"]:C,["delta"]:x,["id"]:v});v=new l.a;v.MessageId=y.MessageId;v.SendTime=y.SendTime;v.CorrelationId=y.CorrelationId;y.Values&&(v.Values=y.Values);t.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",v.MessageId,v.SendTime,v.CorrelationId);return v}kPd(v){t.a.sendTraceTag(5018318,1,String.format("Received: {0}",
{["origin"]:v.origin,["data"]:v.data,["source"]:v.source}))}static sendMessage(v,y,C){if(!h.a())return t.a.debugAssertTag(5018319,!1,null),!1;try{return v.postMessage(y,C),!0}catch(x){t.a.sendTraceTag(5018320,4,"{0}",{["exception"]:x.message})}return!1}}u.Qpa=["MessageId","SendTime"];u.zZ="*";u._id=0;u.gtb=0;Object(B.a)(u,"CrossDocumentMessenger",null,[2,229])},859:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";
this.Values={}}}Object(B.a)(c,"CrossDocumentMessage",null,[])},860:function(B,A,a){a.d(A,"a",function(){return c});const c=b=>{if(Object.keys)b=Object.keys(b);else{const k=[];for(const m in b)k.push(m);b=k}return b}},889:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);class c{static i9d(){}static ynd(){}}c.sendTraceTag=c.i9d;c.debugAssertTag=c.ynd;Object(B.a)(c,"BULS",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/2bc136aec71a776c96fa2d63ff85d5ee/EwaTS.tm.js.map