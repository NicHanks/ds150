(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[34],{1509:function(e,t,n){"use strict";n.d(t,"d",(function(){return Et})),n.d(t,"e",(function(){return kt})),n.d(t,"f",(function(){return Ot})),n.d(t,"a",(function(){return It})),n.d(t,"h",(function(){return wt})),n.d(t,"i",(function(){return _t})),n.d(t,"b",(function(){return Pt})),n.d(t,"c",(function(){return Rt})),n.d(t,"g",(function(){return Dt}));var o=n(2),r=n(0),i=n(45),a=n(2476),s=n(144),l=n(2017),c=n(170),u=n(234),d=n(269),p=n(4),h=n(96),g=n(440),m=n(1938),f=n(12),b=n(112),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;return r.createElement(d.a,null,(function(t){var n=e.props.styles,i=function(e){return{root:Object(p.eb)(e.root),icon:Object(p.eb)(e.icon),title:Object(p.eb)(e.title),message:Object(p.eb)(e.message)}}(function(e,t){var n=Object(h.a)(e),o=Object(b.c)()?e.palette.neutralLight:g.a.hoverBackgroundColor,r={root:[p.f.small,{border:"1px solid ".concat(o),borderRadius:"2px",boxShadow:m.a.depth8,color:n.textColor,display:"flex",lineHeight:"16px",margin:"2px",padding:"8px 12px 8px 12px",backgroundColor:n.defaultBackgroundColor}],icon:{height:16,width:16,paddingRight:8},title:{fontWeight:"bold",paddingRight:5,commonHighContrastCanvasStyles:f.k},message:{commonHighContrastCanvasStyles:f.k}};return Object(p.I)(r,t)}(t,"function"==typeof n?n(e.props):n)),a=e.props.contentRendererFunction&&e.props.contentRendererFunction()||e.getToastContent(i);return r.createElement("div",{className:i.root},e.props.icon&&r.createElement(c.a,Object(o.__assign)({},Object(u.a)(e.props.icon),{className:i.icon})),a)}))},t.prototype.getToastContent=function(e){var t=this.props,n=t.title,o=t.message;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:e.title},n),o&&r.createElement("span",{className:e.message},o))},t}(r.PureComponent);function y(e){return r.createElement(v,Object(o.__assign)({},e))}var x=n(2315),C=n(13);var S,E={appear:"appear",appearActive:"appearActive",appearDone:"appearDone",enter:"enter",enterActive:"enterActive",enterDone:"enterDone",exit:"exit",exitActive:"exitActive",exitDone:"exitDone"},k=Object(C.c)((function(e){var t,n={animations:{selectors:(t={},t["&.appear"]=e.appear,t["&.appearActive"]=e.appearActive,t["&.enter"]=e.enter,t["&.enterActive"]=e.enterActive,t["&.enterDone"]=e.enterDone,t["&.exit"]=e.exit,t["&.exitActive"]=e.exitActive,t["&.exitDone"]=e.exitDone,t)}};return Object(p.db)(n)})),O=n(54),T=Object(C.c)((function(e){return Object(p.db)({root:{display:"flex",flexDirection:"row",justifyContent:"flex-end",whiteSpace:"nowrap"},hidden:{display:"inline-block",position:"absolute",opacity:0}},e)})),I=Math.max(250,100),w=function(e){return e?f.F:350+I},_=Object(C.c)((function(e,t){if(t)return{};var n="transform ".concat(250,"ms ease-out"),o="opacity ".concat(100,"ms linear"),r="width ".concat(250,"ms linear"),i=I+100,a={width:0,opacity:0,transform:"scale(0,0)"},s={width:e,opacity:1,transform:"scale(1,1)",transition:"".concat(r,", ").concat(n," ").concat(350,"ms, ").concat(o," ").concat(350,"ms")};return{appear:a,appearActive:s,enter:a,enterActive:s,exit:{width:e,opacity:1,transform:"scale(1,1)"},exitActive:{width:0,opacity:0,transform:"scale(0,0)",transition:"".concat(n,", ").concat(o,", ").concat(r," ").concat(i,"ms")},exitDone:a}})),P=function(e){function t(t){var n=e.call(this,t)||this;return n.getDeleteToastCallback=function(e){return function(){n.setState((function(t){var n=Object(s.e)(t.toasts,(function(t){return t.key===e}));if(n>=0){var r={toasts:Object(o.__spreadArray)([],t.toasts,!0)};return r.toasts.splice(n,1),r}return t}))}},n.state={toasts:[]},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.afterComponentRender()},t.prototype.componentDidUpdate=function(){this.afterComponentRender()},t.prototype.render=function(){var e=this,t=T(this.props.styles);return r.createElement("div",{ref:this.props.containerRef,className:t.root,"aria-live":"polite","aria-relevant":"additions","aria-atomic":"false"},this.state.toasts.filter((function(e){return!e.width})).map((function(e){return r.createElement("div",{key:e.key,ref:e.ref,className:t.hidden,"aria-hidden":!0},y(e.toastProps))})),this.state.toasts.filter((function(e){return e.width})).map((function(t){var n,i,a,s,c,u=(n=t.width,i=Object(O.isReducedAnimations)(),{transitionClassNames:k(_(n,i)),timeout:w(i)}),d=r.createElement("div",{ref:t.ref,className:u.transitionClassNames.animations},y(t.toastProps));return r.createElement(l.a,Object(o.__assign)({key:t.key},t.notificationProps),(a=d,s=u,c={key:t.key,onExited:e.getDeleteToastCallback(t.key),appear:!0,in:!t.isLeaving},r.createElement(x.a,Object(o.__assign)({},c,{classNames:E,timeout:s.timeout||0}),a)))})))},t.prototype.addToast=function(e,n){var i=Object(s.d)(this.state.toasts,(function(t){return t.toastProps===e}));if(i)return i.key;var a=t.toastCounter.toString();return t.toastCounter+=1,this.setState((function(t){return{toasts:Object(o.__spreadArray)(Object(o.__spreadArray)([],t.toasts,!0),[{key:a,toastProps:e,notificationProps:n,ref:r.createRef(),isLeaving:!1}],!1)}})),a},t.prototype.updateToast=function(e,t){this.setState((function(n){var r=Object(s.e)(n.toasts,(function(t){return t.key===e}));if(r>=0){var i={toasts:Object(o.__spreadArray)([],n.toasts,!0)};return i.toasts[r]=Object(o.__assign)(Object(o.__assign)({},i.toasts[r]),{toastProps:t}),i}return n}))},t.prototype.removeToast=function(e){this.setState((function(t){var n=Object(s.e)(t.toasts,(function(t){return t.key===e}));if(n>=0){var r={toasts:Object(o.__spreadArray)([],t.toasts,!0)};return r.toasts[n].isLeaving=!0,r}return t}))},t.prototype.afterComponentRender=function(){var e=this;requestAnimationFrame((function(){e.setState((function(e){var t=!1,n={toasts:Object(o.__spreadArray)([],e.toasts,!0)};return n.toasts.forEach((function(e){!e.width&&e.ref.current&&(e.width=e.ref.current.clientWidth+1,t=!0)})),t?n:e}))}))},t.toastCounter=0,t}(r.PureComponent),R=n(148),D=n(557),j=n(938),B=n(1976),F=Object(C.c)((function(e,t,n){var o=[];e&&o.push(e),n&&o.push(n);var r={root:{width:o.length?Math.max.apply(Math,o):void 0,selectors:{img:{display:"block",marginLeft:"auto",marginRight:"auto",height:t}}}};return Object(p.db)(r)})),L=function(e){function t(t){var n=e.call(this,t)||this;return n.imgWrapperRef=r.createRef(),n.onLoadingStateChange=function(e){if(e===R.c.loaded&&!n.props.imageWidth&&n.imgWrapperRef.current){var t=n.imgWrapperRef.current.querySelector("img");t&&t.width&&n.setState({imageWidth:t.clientWidth})}},n.state={imageWidth:t.imageWidth},n}return Object(o.__extends)(t,e),t.prototype.componentDidUpdate=function(e){e.imageWidth!==this.props.imageWidth&&this.props.imageWidth!==this.state.imageWidth&&this.setState({imageWidth:this.props.imageWidth})},t.prototype.render=function(){var e=this,t=this.props,n=t.paragraphs,i=t.image,a=Object(o.__assign)(Object(o.__assign)({},i),{onLoadingStateChange:this.getOnloadingStateChangecallback()}),s=F(this.state.imageWidth,this.props.imageHeight,this.props.parentContainerMinWidth);return r.createElement("div",{className:s.root},(Array.isArray(n)?n:[n]).map((function(t,n){return e.renderParagraph(n,t)})),r.createElement("div",{ref:this.imgWrapperRef},r.createElement(D.a,Object(o.__assign)({},a))))},t.prototype.renderParagraph=function(e,t){if("string"==typeof t)return r.createElement("p",{key:e},t);switch(t.type){case"AppLinkProps":return r.createElement("p",{key:e},r.createElement(B.a,Object(o.__assign)({},t)));default:Object(j.a)(t.type)}},t.prototype.getOnloadingStateChangecallback=function(){var e=this;return function(t){e.props.image.onLoadingStateChange&&e.props.image.onLoadingStateChange(t),e.onLoadingStateChange(t)}},t}(r.PureComponent),M=n(383),A=Object(C.c)((function(e){var t=Object(h.a)(e),n={root:{backgroundColor:t.defaultBackgroundColor,height:"58px",width:"234px",display:"flex",marginTop:"8px"},rootRow:{display:"flex",flexDirection:"row",alignItems:"center"},rootColumn:{display:"flex",flexDirection:"column"},countNumber:{color:t.defaultBackgroundColor,fontFamily:"Bahnschrift, Segoe UI, Helvetica Neue",fontSize:"20px",height:"40px",letterSpacing:"0px",lineHeight:"46px",textAlign:"center",verticalAlign:"middle",width:"40px"},countBox:{background:"linear-gradient(-225deg, #3355ff 0%, #7160e8 100%)",borderRadius:"2px",height:"42px",width:"40px",marginRight:"20px"},messageBody:{width:"166px",height:"40px",color:t.textSecondaryColor,fontSize:"12px",fontFamily:"Segoe UI, Helvetica Neue",lineHeight:"18px"}};return Object(p.db)(n)})),N=function(e){function t(t){var n=e.call(this,t)||this;return n.createButton=function(e,t){return void 0===e||0===e.length?r.createElement(r.Fragment,null," "):r.createElement(M.a,Object(o.__assign)({type:"AppButtonProps",onExecute:e[0].onExecute,label:e[0].label,id:e[0].label,styles:t},e))},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.numberOfWritingIssuesFound,o=t.buttonPropsList,i=t.ideasProactiveCalloutMessageSingular,a=t.ideasProactiveCalloutMessagePlural,s=n<100?n:"99+",l=1===n?i.replace("{0}",n.toString()):a.replace("{0}",n.toString());return r.createElement(d.a,null,(function(t){var n=A(t);return r.createElement("div",{className:n.root},r.createElement("div",{className:n.rootRow},r.createElement("div",{className:n.countBox},r.createElement("div",{className:n.countNumber},s))),r.createElement("div",{className:n.rootColumn},r.createElement("div",{className:n.messageBody},l),e.createButton(o,function(){var e;return{root:{border:"0px",padding:"0px",minWidth:"94px",maxWidth:"166px",height:"18px",backgroundColor:"transparent",selectors:(e={},e[f.b]={backgroundColor:"transparent"},e)},rootHovered:{backgroundColor:"transparent"},rootPressed:{backgroundColor:"transparent"},flexContainer:{padding:"0px",margin:"0px"},textContainer:{color:"#7160E8",fontSize:"12px",fontFamily:"Segoe UI, Helvetica Neue",lineHeight:"18px",margin:"0px",padding:"0px"},label:{margin:"0px",padding:"0px",selectors:{":hover":{color:"#5648b0",textDecoration:"underline"},":active":{color:"#403582",textDecoration:"underline"}}}}}())))}))},t}(r.PureComponent),W=function(e){return function(){return r.createElement(N,Object(o.__assign)({},e))}},H=n(370),z=n(645),V=Object(C.c)((function(){return Object(p.db)({root:{height:"flex",width:"700px",display:"flex",marginTop:"flex",marginBottom:"-10px"},rootRow:{display:"flex",flexDirection:"row",alignItems:"center"},spinnerId:{fontSize:"20px",height:"40px",letterSpacing:"0px",lineHeight:"46px",textAlign:"center",verticalAlign:"middle",width:"40px"},title:{fontSize:20,lineHeight:28,marginBottom:12},spinnerBox:{borderRadius:"2px",height:"32px",width:"30px",marginRight:"8px",marginLeft:"-10px",marginTop:"-15px",marginBottom:"20px"},messageBody:{width:"536px",height:"flex",display:"block",fontSize:"12px",lineHeight:"flex",marginTop:"-15px",marginRight:"445px",marginBottom:"5px"},messageTextStyle:{marginTop:"5px",marginRight:"-25px"}})})),G={shade30:"#000000",shade20:"#002050",shade10:"#005a9e",primary:"#0078d7",tint10:"#c7e0f4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1"},U=n(1978),q=n(2419),Q=function(e){function t(t){var n=e.call(this,t)||this;return n.renderSpinner=function(){return r.createElement("div",{style:Object(q.b)()},r.createElement(U.a,{type:"AppSpinnerProps",id:"DeferredBlobSpinner",spinnerSize:H.a.small,appColors:G}))},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=V(),n=this.props,o=n.title,i=n.messageText;return r.createElement("div",null,r.createElement("div",{className:t.title},o),r.createElement("div",{className:t.root},r.createElement("div",{className:t.rootRow},r.createElement("div",{className:t.spinnerBox,"aria-hidden":!0},r.createElement("div",{className:t.spinnerId},this.renderSpinner()))),r.createElement("div",{className:t.messageBody,"aria-live":"polite",role:"status"},(Array.isArray(i)?i:[i]).map((function(t,n){return e.renderMessage(n,t)})))))},t.prototype.renderMessage=function(e,t){var n=V();if("string"==typeof t)return r.createElement(z.a,{delay:50},r.createElement("p",{className:n.messageTextStyle},t));switch(t.type){case"AppLinkProps":return r.createElement(z.a,{delay:50},r.createElement("p",{className:n.messageTextStyle},t,r.createElement(B.a,Object(o.__assign)({},t))));default:Object(j.a)(t.type)}},t}(r.PureComponent),K=function(e){return function(t){return r.createElement(Q,Object(o.__assign)({},e,{parentContainerMinWidth:t&&t.minWidth}))}},J=n(2420);!function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Side=2]="Side"}(S||(S={}));var Z,Y=Object(C.c)((function(e,t,n){void 0===t&&(t=S.None);var o={root:{display:"flex",flexDirection:t===S.Side?"row":"column"},imageContainer:{display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:t===S.Top?20:0,paddingRight:t===S.Side?20:0},contentContainer:{maxWidth:300},title:{fontWeight:p.l.semibold,marginBottom:14,fontSize:e?p.k.mediumPlus:p.k.xLarge,paddingRight:24},buttonsContainer:{display:"inline-block",paddingLeft:12},footer:{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center"},message:{selectors:{p:{marginTop:"1em",marginBottom:"1em"},"p:first-child":{marginTop:0,paddingRight:n?void 0:24}}}};return Object(p.db)(o)})),X=Object(C.c)((function(){return Object(p.db)({feedbackBarContainer:{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:"12px"},feedbackButtonContainer:{},message:{marginRight:"8px"}})})),$=Object(C.c)((function(e){var t,n,o,r,i,a,s=e.palette,l="svg > path.OfficeIconColors_m20",c=Object(f.x)(e),u={root:(t={padding:"0 4px",marginLeft:"6px",width:"20px",height:"20px"},t["svg > path.OfficeIconColors_m22"]={fill:s.neutralLighter},t[l]={fill:"transparent"},t[":first-child"]={marginLeft:"0px"},t),rootHovered:(n={backgroundColor:"transparent"},n[l]={fill:s.neutralLighter},n),rootPressed:(o={backgroundColor:"transparent"},o[l]={fill:s.neutralLight},o),rootChecked:(r={backgroundColor:"transparent"},r[l]={fill:s.neutralLight},r),rootCheckedHovered:(i={backgroundColor:"transparent"},i[l]={fill:s.neutralLighter},i),rootCheckedPressed:(a={backgroundColor:"transparent"},a[l]={fill:s.neutralLight},a)};return{thumbButtons:Object(p.I)(c,u)}})),ee=Object(C.c)((function(e,t){var n={position:"relative"},r={root:Object(o.__assign)({},n)},i={root:Object(o.__assign)(Object(o.__assign)({},n),{marginLeft:8})},a=Object(J.a)(e,t,{primaryButton:r,secondaryButton:i});return{primaryButton:a.primaryButton,secondaryButton:a.secondaryButton}})),te=n(202),ne=n(1947),oe=n(2347),re=n(247),ie=n.n(re),ae=function(e){var t;return e.showFeedbackBar&&(null!==(t=e.feedbackBarProps)&&void 0!==t||(e.feedbackBarProps={feedbackPrompt:NotificationStrings.FeedbackBarPrompt,feedbackResponsePrompt:NotificationStrings.FeedbackBarResponse,positiveFeedbackButton:{icon:ie.a.ThumbsUp_16,label:NotificationStrings.FeedbackBarPositiveTooltip,onExecute:e.positiveFeedbackAction},negativeFeedbackButton:{icon:ie.a.ThumbsDown_16,label:NotificationStrings.FeedbackBarNegativeTooltip,onExecute:e.negativeFeedbackAction}})),function(){return r.createElement(le,Object(o.__assign)({},e))}};!function(e){e[e.PositiveFeedback=0]="PositiveFeedback",e[e.NegativeFeedback=1]="NegativeFeedback"}(Z||(Z={}));var se,le=function(e){function t(t){var n=e.call(this,t)||this;return n.getFeedbackMessage=function(){if(!n.props.feedbackBarProps)return"";var e=n.props.feedbackBarProps,t=e.feedbackPrompt,o=e.feedbackResponsePrompt;return n.state.feedbackSubmitted&&o||t},n.onFeedbackButtonClick=function(e,t){var o=n.state.positiveFeedbackChecked,r=n.state.negativeFeedbackChecked,i=!1;switch(e){case Z.PositiveFeedback:o||(o=!0,r=!1,i=!0);break;case Z.NegativeFeedback:r||(o=!1,r=!0,i=!0)}i&&(n.setState({positiveFeedbackChecked:o,negativeFeedbackChecked:r,feedbackSubmitted:o||r}),t&&t())},n.onLoadingStateChange=function(e){e===R.c.error&&n.setState({hideImage:!0})},n.state={hideImage:!1,feedbackSubmitted:!1,positiveFeedbackChecked:!1,negativeFeedbackChecked:!1},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.image,n=e.positionImageAtLeft,i=e.smallHeadline,a=e.message,s=e.footer,l=e.title,c=e.feedbackBarProps,u=e.showLearnMoreHref,d=e.learnMoreHref,p=e.learnMoreDisplayText,h=t?n?S.Side:S.Top:S.None,g=Array.isArray(a)?a:[a],m=Y(!!i,h,!!l);return r.createElement("div",{className:m.root},t&&!this.state.hideImage&&r.createElement("div",{className:m.imageContainer},r.createElement(D.a,Object(o.__assign)({},t,{className:m.image,onLoadingStateChange:this.onLoadingStateChange}))),r.createElement("div",{className:m.contentContainer},l&&r.createElement("div",{className:m.title,role:"heading","aria-level":1},l),r.createElement("div",{className:m.message},g.map((function(e,t){return r.createElement("p",{key:t},e)}))),u&&r.createElement("a",{className:"LearnMoreLink",href:d,target:"_blank",rel:"noreferrer","aria-label":p,role:"button"},p),r.createElement("div",{className:m.footer},s&&r.createElement("span",null,s),this.renderButtons(m)),c&&this.renderFeedbackBar(c)))},t.prototype.renderButtons=function(e){var t=this.props,n=t.primaryButtonProps,i=t.secondaryButtonProps,a=t.appColors,s=Object(te.a)("FloodgateCallout");return r.createElement(d.a,null,(function(t){var l=ee(t,a);return(n||i)&&r.createElement("span",{className:e&&e.buttonsContainer},n&&r.createElement(M.a,Object(o.__assign)({},n,{id:s+"-primaryButton",type:"AppButtonProps",styles:l&&l.primaryButton})),i&&r.createElement(M.a,Object(o.__assign)({},i,{id:s+"-secondaryButton",type:"AppButtonProps",styles:l&&l.secondaryButton})))}))},t.prototype.renderFeedbackBar=function(e){var t=this,n=Object(te.a)("FloodgateCallout"),o=e.positiveFeedbackButton.label,i=e.negativeFeedbackButton.label,a=function(){t.onFeedbackButtonClick(Z.PositiveFeedback,e.positiveFeedbackButton.onExecute)},s=function(){t.onFeedbackButtonClick(Z.NegativeFeedback,e.negativeFeedbackButton.onExecute)};return r.createElement(d.a,null,(function(l){var c=X(),d=$(l);return r.createElement("div",{className:c.feedbackBarContainer},r.createElement("span",{className:c.message},t.getFeedbackMessage()),r.createElement("span",{className:c.feedbackButtonContainer},r.createElement(ne.a,null,r.createElement(oe.a,{id:n+"-positiveFeedbackButton",role:"button",styles:d.thumbButtons,iconProps:Object(u.a)(e.positiveFeedbackButton.icon),label:o,ariaLabel:o,customTooltip:o,checked:t.state.positiveFeedbackChecked,onClick:a}),r.createElement(oe.a,{id:n+"-negativeFeedbackButton",role:"button",styles:d.thumbButtons,iconProps:Object(u.a)(e.negativeFeedbackButton.icon),label:i,ariaLabel:i,customTooltip:i,checked:t.state.negativeFeedbackChecked,onClick:s}))))}))},t}(r.PureComponent),ce=n(67),ue=n(70),de=n(181),pe=n(134),he=n(648),ge=n(495),me=Object(C.c)((function(e,t,n){var o=Object(h.a)(e),r={borderRadius:2,height:32,fontWeight:p.l.semibold,letterSpacing:"0",textAlign:"center",position:"relative"},i={root:{background:o.defaultBackgroundColor,minWidth:250},radioButtonsContainer:{display:"inline-flex",justifyContent:"center",marginBottom:23},prompt:{marginBottom:13,marginTop:0,fontSize:p.k.medium,color:Object(b.c)()?e.palette.black:pe.a.black},question:{marginBottom:23,color:Object(he.a)(e).primaryTextColor,fontSize:p.k.large,fontWeight:"bold",maxWidth:null!=n?n:"100%"},disclaimer:{color:o.textDisclaimerColor,fontSize:p.k.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},disclaimerText:{margin:0},privacyLink:{marginLeft:5},buttonsContainer:{marginTop:21},subComponentStyles:{submitButton:Object(p.I)({root:[{marginRight:12},r]},Object(ge.d)(Object(ge.b)(t),ge.a)),cancelButton:Object(p.I)({root:r},Object(ge.d)(Object(ge.f)(e),ge.a))}};return Object(p.db)(i)})),fe=Object(C.c)((function(){return{flexContainer:{display:"flex",marginLeft:18,height:24}}})),be=Object(C.c)((function(e,t){var n=Object(b.c)()?e.palette.themePrimary:t.primary;return{root:{minHeight:18,marginRight:18,marginTop:7},field:{right:1,width:18,selectors:{":hover::before":{borderColor:n},":hover::after":{borderColor:n,backgroundColor:n},":after":{borderColor:n}}},choiceFieldWrapper:{selectors:{".is-checked::before":{borderColor:n}}}}})),ve=n(768),ye=n(1133),xe=n(1493),Ce=function(e){function t(t){var n=e.call(this,t)||this;return n.radioButtonContainerRef=r.createRef(),n.getOptions=function(e,t,n){var o=be(e,t);return n.map((function(e,t){return{key:"".concat(t),text:"",ariaLabel:e,styles:o}}))},n.handleOnUserSelection=function(e){n.setState({selectedRating:parseInt(e.key,10)}),ce.a.sendTraceTag(590653001,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"User has selected a rating on NpsOneClickRadioButton")},n.renderButtons=Object(C.c)((function(e,t,o){return r.createElement(r.Fragment,null,r.createElement(xe.a,{type:"AppLabelProps",forId:"rating labels",label:o[0],id:"leading anchor"}),r.createElement(ye.a,{id:n.id,key:n.id,type:"AppChoiceGroupProps",label:"",options:n.getOptions(e,t,o),styles:fe(),onChange:n.handleOnUserSelection}),r.createElement(xe.a,{type:"AppLabelProps",forId:n.id,label:o[o.length-1],id:"trailing anchor"}))})),n.handleSubmit=function(){n.hasSelectedRating()&&n.props.npsOneClickCommonProps.ratingSendButtonProps.onExecute(n.state.selectedRating),n.props.updateCurrentPageNumber(se.Verbatim),ce.a.sendTraceTag(590700805,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"User has submitted a rating of ".concat(n.state.selectedRating," on NpsOneClickRadioButton"))},n.handleCancel=function(){n.props.npsOneClickCommonProps.cancelButtonProps.onExecute(),ce.a.sendTraceTag(590653002,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"User has dismissed the NpsOneClickRadioButton")},n.state={},n.id=Object(te.a)("NpsOneClickRadioButton"),n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.afterComponentRender(),ce.a.sendTraceTag(590700804,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"NpsOneClickRadioButton has been displayed")},t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,i=t.npsOneClickCommonProps,a={href:i.privacyStatementLink,target:"_blank"};return r.createElement(d.a,null,(function(t){var s=me(t,n,e.state.radioButtonContainerWidth);return r.createElement("div",{className:s.root},i.prompt&&r.createElement("p",{className:s.prompt},i.prompt),i.question&&r.createElement("p",{className:s.question},i.question),r.createElement("div",{className:s.radioButtonsContainer,ref:e.radioButtonContainerRef},e.renderButtons(t,n,i.ratingLabels)),r.createElement("div",{className:s.disclaimer},r.createElement("p",{className:s.disclaimerText},i.disclaimer,r.createElement("span",{className:s.privacyLink},r.createElement(B.a,{handler:a,type:"AppLinkProps",id:"privacy link",text:i.verbatimPrivacyStatement})))),r.createElement("div",{className:s.buttonsContainer},r.createElement(ve.a,Object(o.__assign)({},i.ratingSendButtonProps,{styles:s.subComponentStyles.submitButton(),disabled:!e.hasSelectedRating(),onClick:e.handleSubmit})),r.createElement(ve.a,Object(o.__assign)({},i.cancelButtonProps,{styles:s.subComponentStyles.cancelButton(),onClick:e.handleCancel}))))}))},t.prototype.afterComponentRender=function(){this.radioButtonContainerRef.current&&!this.state.radioButtonContainerWidth&&this.setState({radioButtonContainerWidth:this.radioButtonContainerRef.current.clientWidth})},t.prototype.hasSelectedRating=function(){return void 0!==this.state.selectedRating},t}(r.PureComponent),Se=Object(C.c)((function(e,t,n){var o=Object(h.a)(e),r=Object(he.a)(e),i={borderRadius:2,height:32,fontWeight:p.l.semibold,letterSpacing:"0",textAlign:"center",position:"relative"},a={frame:{background:o.defaultBackgroundColor,maxWidth:400},verbatimPrompt:{top:8,left:13,fontStyle:"normal",fontWeight:600,fontSize:p.k.medium,lineHeight:20,color:r.primaryTextColor},verbatimDisclaimer:{marginBottom:13,marginTop:5,color:o.textDisclaimerColor,fontSize:p.k.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},email:{marginBottom:13,marginTop:0,fontSize:p.k.medium,color:e.palette.black},submissionDisclaimer:{color:o.textDisclaimerColor,fontSize:p.k.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},submissionDisclaimerText:{margin:0},privacyLink:{color:r.primaryTextColor,fontSize:p.k.small,fontStyle:"normal",fontWeight:"normal",marginLeft:5},buttonsContainer:{marginTop:21},subComponentStyles:{submitButton:Object(p.I)({root:[{marginRight:12},i]},Object(ge.d)(Object(ge.c)(e,t),ge.a)),cancelButton:Object(p.I)({root:i},Object(ge.d)(Object(ge.f)(e),ge.a))}};return Object(p.db)(a)})),Ee=Object(C.c)((function(e,t){return{root:{width:"100%"},fieldGroup:{borderColor:Object(b.c)()?e.palette.themePrimary:t.primary}}})),ke=Object(C.c)((function(e,t,n){var o=Object(b.c)()?e.palette.themePrimary:t.primary;return{root:{padding:0,border:"none"},checkmark:[n&&[{fill:o}]],checkbox:[n&&[{borderColor:o}],!n&&[{borderColor:Object(b.c)()?e.palette.black:pe.a.black}]]}})),Oe=Object(C.c)((function(e,t){return{root:{width:"100%",backgroundColor:Object(h.a)(e).defaultBackgroundColor},fieldGroup:{borderColor:Object(b.c)()?e.palette.themePrimary:t.primary},errorMessage:{color:Object(b.c)()?e.palette.black:pe.a.black}}})),Te=(Object(C.c)((function(){return{flexContainer:{display:"flex",marginLeft:18,height:24}}})),n(2256)),Ie=n(2362),we=n(49),_e=function(e){function t(t){var n=e.call(this,t)||this;return n.preventArrowKeysFromChangingFocus=function(e){[we.a.left,we.a.right,we.a.up,we.a.down].includes(e.keyCode)&&e.stopPropagation()},n.validateEmail=function(e){void 0!==e&&/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())?n.setState({isEmailValid:!0,errorMessage:""}):n.setState({isEmailValid:!1,errorMessage:n.props.npsOneClickCommonProps.emailValidationErrorMessage})},n.onUserInputChange=function(e){n.setState({userVerbatim:e})},n.onUserEmailInputChange=function(e){n.setState({userEmail:e}),n.validateEmail(e)},n.onContactBoxChange=function(e){e.checked?n.validateEmail(n.state.userEmail):n.setState({userEmail:"",isEmailValid:!1,errorMessage:""}),n.setState({allowEmailContact:e.checked})},n.handleSubmit=function(){var e=JSON.stringify({surveyStrings:JSON.stringify({prompt:Object(o.__assign)({},n.props.npsOneClickCommonProps.promptComponent.data),rating:[Object(o.__assign)({},n.props.npsOneClickCommonProps.ratingComponent.data)]})}),t=n.state.allowEmailContact?n.state.userEmail:"",r=[n.state.userVerbatim,t,e];n.props.npsOneClickCommonProps.verbatimSendButtonProps.onExecute(r),n.props.updateCurrentPageNumber(se.ThankyouPage),ce.a.sendTraceTag(587511237,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"User has submitted input on NpsVerbatim text box")},n.handleCancel=function(){n.props.updateCurrentPageNumber(se.ThankyouPage),ce.a.sendTraceTag(587511238,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"User has clicked the cancel button to dismiss the NpsVerbatim")},n.state={allowEmailContact:!1,userVerbatim:void 0,isEmailValid:!1},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){ce.a.sendTraceTag(587511235,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"NpsVerbatim has been displayed")},t.prototype.componentWillUnmount=function(){ce.a.sendTraceTag(587511236,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"NpsVerbatim has been dismissed")},t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,i=t.npsOneClickCommonProps,a={href:i.privacyStatementLink,target:"_blank"};return r.createElement(d.a,null,(function(t){var s=Se(t,n);return r.createElement("div",{className:s.frame},r.createElement("div",{className:s.verbatimPrompt},i.verbatimPrompt),r.createElement("div",{className:s.verbatimDisclaimer},i.verbatimDisclaimer),r.createElement(Ie.a,{styles:Ee(t,n),multiline:!0,value:e.state.userVerbatim,onChange:e.onUserInputChange,onKeyDown:e.preventArrowKeysFromChangingFocus,resizable:!0,type:"AppInputProps",id:"Verbatim Textbox"}),!i.isCommercialHost&&r.createElement("div",{className:s.email},r.createElement(Te.a,{label:i.emailLabel,checked:e.state.allowEmailContact,onExecute:e.onContactBoxChange,styles:ke(t,n,e.state.allowEmailContact),checkmarkIcon:e.props.checkmarkIcon,type:"AppCheckboxProps",id:"Email Checkbox"}),r.createElement(Ie.a,{styles:Oe(t,n),multiline:!1,value:e.state.allowEmailContact?e.state.userEmail:"",onChange:e.onUserEmailInputChange,disabled:!e.state.allowEmailContact,placeholder:i.emailPlaceHolder,type:"AppInputProps",id:"Email Textbox",errorMessage:e.state.errorMessage})),r.createElement("div",{className:s.submissionDisclaimer},r.createElement("p",{className:s.submissionDisclaimerText},i.submissionDisclaimer,r.createElement("span",{className:s.privacyLink},r.createElement(B.a,{handler:a,type:"AppLinkProps",id:"privacy link",text:i.verbatimPrivacyStatement})))),r.createElement("div",{className:s.buttonsContainer},r.createElement(ve.a,Object(o.__assign)({},i.verbatimSendButtonProps,{styles:s.subComponentStyles.submitButton(),onClick:e.handleSubmit,disabled:!e.enableSubmit()})),r.createElement(ve.a,Object(o.__assign)({},i.cancelButtonProps,{styles:s.subComponentStyles.cancelButton(),onClick:e.handleCancel}))))}))},t.prototype.enableSubmit=function(){return this.state.allowEmailContact?this.state.userEmail&&this.state.isEmailValid:this.state.userVerbatim},t}(r.PureComponent),Pe=Object(C.c)((function(e,t){var n={frame:{background:Object(h.a)(e).defaultBackgroundColor,minWidth:400,fontSize:p.k.large,lineHeight:24,color:Object(he.a)(e,t).primaryTextColor}};return Object(p.db)(n)})),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;setTimeout((function(){return e.props.cancelButtonProps.onExecute()}),3e3),ce.a.sendTraceTag(587511233,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"Thankyou Page has been displayed with a 3s timer to auto dismiss")},t.prototype.componentWillUnmount=function(){ce.a.sendTraceTag(587511234,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"Thankyou Page has been dismissed")},t.prototype.render=function(){var e=this;return r.createElement(d.a,null,(function(t){var n=Pe(t,e.props.appColors);return r.createElement("div",{className:n.frame},e.props.thankyouText)}))},t}(r.PureComponent);!function(e){e[e.Rating=0]="Rating",e[e.Verbatim=1]="Verbatim",e[e.ThankyouPage=2]="ThankyouPage"}(se||(se={}));var De=function(e){function t(t){var n=e.call(this,t)||this;return n.updateCurrentPageNumber=function(e){n.setState({currentPage:e})},n.state={currentPage:n.props.npsOneClickCommonProps.currentPage},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){ce.a.sendTraceTag(587511239,ue.a.msoulscat_Wac_Telemetry,de.a.Info,"NpsOneClickSurvey is currently displaying page # ".concat(this.state.currentPage))},t.prototype.render=function(){var e=r.createElement(r.Fragment,null);if(this.state.currentPage===se.Rating){var t="NPSOneClickRadioButton";e=r.createElement(Ce,Object(o.__assign)({},this.props,{type:t,updateCurrentPageNumber:this.updateCurrentPageNumber}))}else if(this.state.currentPage===se.Verbatim){t="NPSVerbatim";e=r.createElement(_e,Object(o.__assign)({},this.props,{type:t,updateCurrentPageNumber:this.updateCurrentPageNumber,checkmarkIcon:this.props.checkmarkIcon}))}else this.state.currentPage===se.ThankyouPage&&(e=r.createElement(Re,{thankyouText:this.props.npsOneClickCommonProps.thankyouText,appColors:this.props.appColors,cancelButtonProps:this.props.npsOneClickCommonProps.cancelButtonProps}));return e},t}(r.PureComponent),je=function(e){return function(){return r.createElement(De,Object(o.__assign)({},e))}},Be=Object(C.c)((function(e,t){var n={premiumIconContainer:{height:28,marginBottom:12},premiumIcon:{width:20,height:28,cursor:"default"},title:{fontSize:20,lineHeight:28,marginBottom:12,color:e.palette.neutralPrimary,cursor:"default"},contentContainer:{fontSize:12,lineHeight:16,marginBottom:20,color:e.palette.neutralPrimary},contentImageContainer:{lineHeight:16,marginBottom:20},message:{marginBottom:12},image:{display:"block",marginLeft:"auto",marginRight:"auto",height:t},screenReaderText:p.ab};return Object(p.db)(n)})),Fe=n(2475),Le=function(e){function t(t){return e.call(this,t)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.content,i=e.titleId,a=e.imageProps,s=e.appColors;return r.createElement(d.a,null,(function(e){var l=Be(e),d=Object(he.a)(e,s);return r.createElement("div",null,r.createElement("div",{className:l.contentImageContainer},a&&r.createElement("div",null,r.createElement(D.a,Object(o.__assign)({},a,{className:l.image})))),r.createElement("div",{className:l.premiumIconContainer},r.createElement(c.a,Object(o.__assign)({},Object(u.a)("UpgradeProductGlyphColorless_16",d.primaryTextColor),{className:l.premiumIcon})),r.createElement("span",{className:l.screenReaderText},Fe.NotificationStrings.PremiumFeatureDiamond)),r.createElement("div",{className:l.title,id:i,role:"heading","aria-level":1},t),r.createElement("div",{className:l.contentContainer},r.createElement("div",{className:l.message},n)))}))},t}(r.PureComponent),Me=function(e){return function(){return r.createElement(Le,Object(o.__assign)({},e))}},Ae=function(e){if(!e)return!1;switch(e.type){case"NPSOneClick1":case"NPSOneClick2":case"NPSOneClickRadioButton":case"FloodgateTeachingCallout":return!0;case"IdeasCallout":case"TextAboveImage":case"DeferredContentType":default:return!1}},Ne=n(2358),We=function(e,t){var n=Object(h.a)(e),o={subComponentStyles:{callout:{calloutMain:[p.f.small,{padding:"8px 12px",backgroundColor:n.defaultBackgroundColor,color:n.textColor,lineHeight:16,maxWidth:310}]}}};return Object(p.I)(o,t)},He=6*Math.sqrt(2),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;return r.createElement(d.a,null,(function(t){return r.createElement(Ne.a,Object(o.__assign)({},e.props,{calloutProps:Object(o.__assign)({beakWidth:He},e.props.calloutProps),styles:We(t,e.props.styles)}))}))},t}(r.PureComponent),Ve=n(417),Ge=n(2421),Ue=n(2425),qe=n(220),Qe=function(e){function t(t){var n=e.call(this,t)||this;return n.keyId=0,n.state={entries:{}},Object(qe.a)(n),t.componentRef.current=n,n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=[];for(var t in this.state.entries){var n=this.state.entries[t];e.push(this.props.renderItem(t,n))}return e},t.prototype.canRender=function(e){return this.props.canRender(e)},t.prototype.contains=function(e){return!!this.state.entries[e]},t.prototype.add=function(e){if(this.canRender(e)){var t=this.props.keyPrefix+this.keyId;return this.keyId+=1,this.setState((function(n){var r=Object(o.__assign)({},n.entries);return r[t]=Object(o.__assign)({key:t},e),{entries:r}})),t}},t.prototype.remove=function(e){this.state.entries[e]&&this.setState((function(t){var n=Object(o.__assign)({},t.entries);return delete n[e],{entries:n}}))},t.prototype.update=function(e,t){this.state.entries[e]&&this.setState((function(n){var r=Object(o.__assign)({},n.entries);return r[e]=t,{entries:r}}))},t}(r.Component),Ke=n(1199),Je=n(2423),Ze=n(267),Ye=n(2198),Xe=n(60),$e=Object(C.c)((function(e){return function(){var t={type:"calloutClosed",correlation:e};Object(Ye.a)().emit("calloutClosed",t)}})),et=Object(C.c)((function(e,t,n){var r=n.onTargetResolved,i=tt(e,t),a=r?function(e,t){r(e,t),i(e,t)}:i;return Object(o.__assign)(Object(o.__assign)({},n),{onTargetResolved:a})})),tt=Object(C.c)((function(e,t){return function(n,o){if(Object(Xe.b)()){var r={type:"shouldShowCallout",id:e,targetElement:n};Object(Ye.a)().emitWaitUntil("shouldShowCallout",r).then((function(){var e,r,i;e=n,r=t,i=function(t){Object(Ze.a)(t.detail.element,e)&&(r(),Object(Ye.a)().removeListener("elementExit",i))},Object(Ye.a)().addListener("elementExit",i),o()}),(function(e){}))}else o()}}));var nt=n(2239),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canRender=function(e){var t=e.contentProps.type;return"CalloutProps"===t||"SimpleCalloutProps"===t||"TeachingCalloutProps"===t},t.renderItem=Object(C.c)((function(e,n){var i,a=t.props.hostElement,s=a&&"function"==typeof a?a():a,c=t.addFocusCallback(n),u=c.contentProps,d=c.notificationProps,p=null===(i=(u=t.ensureDismissCallback(e,{contentProps:u},Object(Xe.b)()?[$e(e)]:[]).contentProps).calloutProps)||void 0===i?void 0:i.onDismiss;return u=et(e,p,u),r.createElement(l.a,Object(o.__assign)({key:e,hostElement:s},d),t.renderCallout(u))})),t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props.rendererRef;return r.createElement(nt.a,null,r.createElement(Qe,{componentRef:e,keyPrefix:"callout",canRender:this.canRender,renderItem:this.renderItem}))},t.prototype.renderCallout=function(e){var t,n,i=this.props.appCustomizations,a=i.augmentContentProps,s=i.appColors,l=i.appStrings,c=i.icons,u=void 0,d=e;if(e.content){var h=function(e,t,n){var i,a=(null==n?void 0:n.checkmark)||"";switch(e.type){case"TextAboveImage":return{contentRendererCallback:(i=e,function(e){return r.createElement(L,Object(o.__assign)({},i,{parentContainerMinWidth:e&&e.minWidth}))})};case"DeferredContentType":return{contentRendererCallback:K(e),calloutPropsUpdate:function(e){var t;return Object(o.__assign)(Object(o.__assign)({},e),{calloutProps:Object(o.__assign)(Object(o.__assign)({},e.calloutProps),{style:Object(o.__assign)(Object(o.__assign)({},null===(t=e.calloutProps)||void 0===t?void 0:t.style),{border:"1px solid ".concat(Object(p.Y)().semanticColors.inputText)})})})}};case"NPSOneClickRadioButton":return{contentRendererCallback:je(Object(o.__assign)(Object(o.__assign)({},e),{appColors:t,checkmarkIcon:a}))};case"IdeasCallout":return{contentRendererCallback:W(e)};case"FloodgateTeachingCallout":return{contentRendererCallback:ae(Object(o.__assign)(Object(o.__assign)({},e),{appColors:t}))};case"PremiumUpsellCallout":var s=Object(te.a)("PremiumUpsellCalloutTitle");return{contentRendererCallback:Me(Object(o.__assign)(Object(o.__assign)({},e),{appColors:t,titleId:s})),calloutPropsUpdate:function(e){return Object(o.__assign)(Object(o.__assign)({},e),{calloutProps:Object(o.__assign)(Object(o.__assign)({},e.calloutProps),{ariaLabelledBy:s})})}};default:return Object(j.a)(e)}}(a?a(e.content):e.content,s,c);u=h.contentRendererCallback,h.calloutPropsUpdate&&(d=h.calloutPropsUpdate(e))}switch(d.type){case"SimpleCalloutProps":return r.createElement(ze,Object(o.__assign)({},d));case"CalloutProps":return r.createElement(Ge.a,Object(o.__assign)({},d,{appColors:s,closeButtonProps:d.closeButtonProps||{icon:c.closeDark,label:d.customCloseLabel||l.closeLabel},contentRendererFunction:u,hasDynamicSizing:null!==(t=d.hasDynamicSizing)&&void 0!==t?t:Ae(d.content),jumpToCalloutTargetButtonProps:d.jumpToCalloutTargetButtonEnabled&&c.jumpToTargetDark?{icon:c.jumpToTargetDark,label:Je.a.JumpToCalloutTarget}:void 0}));case"TeachingCalloutProps":return r.createElement(Ue.a,Object(o.__assign)({},d,{appColors:s,closeButtonProps:d.closeButtonProps||{icon:c.closeLight,label:d.customCloseLabel||l.closeLabel},contentRendererFunction:u,hasDynamicSizing:null!==(n=d.hasDynamicSizing)&&void 0!==n?n:Ae(d.content),useCoachmark:d.useCoachmark,jumpToCalloutTargetButtonProps:d.jumpToCalloutTargetButtonEnabled&&c.jumpToTargetLight?{icon:c.jumpToTargetLight,label:Je.a.JumpToCalloutTarget}:void 0}));default:return Object(j.a)(d)}},t.prototype.ensureDismissCallback=function(e,t,n){var r=this,i=t.contentProps;return{contentProps:Object(o.__assign)(Object(o.__assign)({},i),{calloutProps:Object(o.__assign)(Object(o.__assign)({},i.calloutProps),{onDismiss:function(t){var o,a=r.props.rendererRef;i.calloutProps&&i.calloutProps.onDismiss&&i.calloutProps.onDismiss(t),"SimpleCalloutProps"!==i.type&&Object(Ke.b)(e,Ve.b.Dismiss,{key:"HasActionButtons",value:"".concat(!(!i.primaryButtonProps&&!i.secondaryButtonProps))}),null===(o=a.current)||void 0===o||o.remove(e),n&&n.forEach((function(e){return e()}))}})})}},t.prototype.addFocusCallback=function(e){var t,n=e.contentProps,r=e.notificationProps,i=n.componentRef;if(!i)return e;var a,s=n;"function"==typeof i?(s=Object(o.__assign)(Object(o.__assign)({},n),{componentRef:function(e){i(e),a=e}}),t=function(){return a&&a.focus()}):t=function(){return i.current&&i.current.focus()};return{contentProps:s,notificationProps:Object(o.__assign)(Object(o.__assign)({},r),{focus:t,isActionable:!0})}},t}(r.Component),rt=function(e){function t(t){var n=e.call(this,t)||this;return n.state={renderers:t.rendererFactory.map((function(e){var t=r.createRef();return{rendererRef:t,rendererElement:e(t)}}))},Object(qe.a)(n),t.componentRef.current=n,n}return Object(o.__extends)(t,e),t.prototype.render=function(){return Object(o.__spreadArray)([],this.state.renderers.map((function(e){return e.rendererElement})),!0)},t.prototype.canRender=function(e){var t;return!!(null===(t=this.getRendererRefForProps(e))||void 0===t?void 0:t.current)},t.prototype.contains=function(e){return this.state.renderers.some((function(t){var n;return null===(n=t.rendererRef.current)||void 0===n?void 0:n.contains(e)}))},t.prototype.add=function(e){var t,n;return null===(n=null===(t=this.getRendererRefForProps(e))||void 0===t?void 0:t.current)||void 0===n?void 0:n.add(e)},t.prototype.remove=function(e){var t,n;null===(n=null===(t=this.getRendererRefForKey(e))||void 0===t?void 0:t.current)||void 0===n||n.remove(e)},t.prototype.update=function(e,t){var n,o;null===(o=null===(n=this.getRendererRefForKey(e))||void 0===n?void 0:n.current)||void 0===o||o.update(e,t)},t.prototype.getRendererRefForProps=function(e){var t;return null===(t=Object(s.d)(this.state.renderers,(function(t){var n;return!!(null===(n=t.rendererRef.current)||void 0===n?void 0:n.canRender(e))})))||void 0===t?void 0:t.rendererRef},t.prototype.getRendererRefForKey=function(e){var t;return null===(t=Object(s.d)(this.state.renderers,(function(t){var n;return!!(null===(n=t.rendererRef.current)||void 0===n?void 0:n.contains(e))})))||void 0===t?void 0:t.rendererRef},t}(r.Component),it=function(e){return r.createElement(Qe,{key:"toast",componentRef:e,keyPrefix:"toast",canRender:at,renderItem:st})},at=function(e){return"ToastProps"===e.contentProps.type},st=Object(C.c)((function(e,t){return r.createElement(a.a,Object(o.__assign)({key:e},t.notificationProps,{toastProps:t.contentProps}))})),lt=function(e){return r.createElement(Qe,{key:"external",componentRef:e,keyPrefix:"external",canRender:ct,renderItem:ut})},ct=function(e){return"ExternalNotificationProps"===e.contentProps.type},ut=Object(C.c)((function(e,t){return r.createElement(l.a,Object(o.__assign)({key:e},t.notificationProps),r.createElement(r.Fragment,null))})),dt=n(16),pt=n(422),ht=n(48),gt=n(1114),mt=n(1130),ft=n(764),bt=n(97);function vt(e,t,n){for(var o,r,i,a="#".concat(null!=t?t:e),s=null===(o=document.getElementById(mt.b))||void 0===o?void 0:o.querySelectorAll(a),l=0;s&&l<s.length;l++){var c=s.item(l);if(Object(bt.p)(c))return c}return null!==(i=null!==(r=document.querySelector("#".concat(n,"-").concat(ft.b)))&&void 0!==r?r:document.querySelector("#".concat(ft.d,"-").concat(ft.b)))&&void 0!==i?i:document.querySelector("#".concat(n))}var yt,xt=n(933),Ct=n(642),St=r.createRef();function Et(e){var t=document.createElement("div");document.body.appendChild(t),i.render(r.createElement(rt,{componentRef:St,rendererFactory:[function(t){var n;return n={rendererRef:t,hostElement:yt||function(){return yt},appCustomizations:e},r.createElement(ot,Object(o.__assign)({key:"callout"},n))},it,lt]}),t)}function kt(e){ce.a.shipAssertTag(594072578,ue.a.msoulscat_Wac_Telemetry,!yt,"Callout notifications initialized multiple times"),yt=e}function Ot(e,t){var n=function(e){e?a.a.setDefaultContainer(e):ce.a.sendTraceTag(594060812,ue.a.msoulscat_Wac_Telemetry,de.a.Error,"Failed to set default container for ToastNotification. toastContainerRef.current is undefined.")},o=r.createElement(P,{ref:n});if(Object(dt.b)("Microsoft.Office.SharedOnline.LimitedAppStateNotificationsEnabled",!1)){o=r.createElement(P,{ref:t?function(e){e&&t&&a.a.addToastContainer(t.containerId,e)}:n,styles:null==t?void 0:t.styles})}i.render(o,e)}function Tt(e,t,n,o,r){return e?function(e,t,n,o){var r;return n.target=t,St.current&&e?(St.current.update(e,{contentProps:n,notificationProps:o}),e):(null===(r=St.current)||void 0===r?void 0:r.add({contentProps:n,notificationProps:o}))||null}(r,e,t,n):function(e,t,n,o){var r,i,a,s;return t.target=null!==(r=null==n?void 0:n.fallBackTarget)&&void 0!==r?r:t.target,t.title=null!==(i=null==n?void 0:n.fallBackTitle)&&void 0!==i?i:t.title,t.message=null!==(a=null==n?void 0:n.fallBackMessage)&&void 0!==a?a:t.message,St.current&&e?(St.current.update(e,{contentProps:t}),e):(null===(s=St.current)||void 0===s?void 0:s.add({contentProps:t,notificationProps:o}))||null}(r,t,o)}function It(e,t){if(!St.current)return ce.a.sendTraceTag(594072579,ue.a.msoulscat_Wac_Telemetry,de.a.Warning,"Area:ReactNotifications. NotificationsAPI.addNotification called before renderer initialized"),null;var n,r=null,i=function(){return r&&wt(r)},a=t&&function(e){var t=e.expirationOptions,n=e.onShow,o=e.telemetryId;return{onShow:n,telemetryId:o,expirationSettings:t}}(function(e,t){if(t.expirationOptions){var n=t.expirationOptions.onExpire;return Object(o.__assign)(Object(o.__assign)({},t),{expirationOptions:Object(o.__assign)(Object(o.__assign)({},t.expirationOptions),{onExpire:function(){n&&n(),e()}})})}return t}((function(){return i}),t)),s=null==t?void 0:t.navigationalOptions;s&&s.controlToFindByRibbonMode&&(n="SingleLine"===Object(ht.cb)(pt.a.getState())?s.controlToFindByRibbonMode.singleLineId:s.controlToFindByRibbonMode.multiLineId);var l=null!=n?n:null==s?void 0:s.controlToFind;if(l&&"TeachingCalloutProps"===e.type&&a){var c=pt.a.getState(),u=Object(ht.ab)(c,l),d=u.hostingTabId,p=u.hostingParentId,h=u.hostingGroupId,g=Object(ht.ib)(pt.a.getState())===d;if(d&&!g)!function(e,t,n,o){if(e!==t()){var r=document.getElementById(e),i=new MutationObserver((function(e){"true"===r.getAttribute("aria-selected")&&(i.disconnect(),Object(gt.a)(o))}));i.observe(r,{attributes:!0,attributeFilter:["aria-selected"]}),n()}else o()}(d,(function(){return Object(ht.ib)(pt.a.getState())}),(function(){return Object(Ct.a)(Object(xt.a)(d))}),(function(){var n=vt(l,p,h);r=Tt(n,e,t,t.navigationalOptions,r)}));else{var m=d?vt(l,p,h):null;r=Tt(m,e,t,t.navigationalOptions,r)}}return r||(r=St.current.add({contentProps:e,notificationProps:a})||null),r}function wt(e){var t;null===(t=St.current)||void 0===t||t.remove(e)}function _t(e,t){var n;null===(n=St.current)||void 0===n||n.update(e,{contentProps:t})}function Pt(e){var t=e.primaryButtonProps,n=e.secondaryButtonProps,i=e.showCloseIcon,a=e.target,s=e.title,l=e.hasFocusableControls,c=e.content,u=e.useTeachingStyles,d=Object(o.__rest)(e,["hasFocusableControls","content","useTeachingStyles"]);if("string"==typeof c&&!(s||u||l||(t||n||i)))return{type:"SimpleCalloutProps",target:a,message:c};var p=Object(o.__assign)(Object(o.__assign)({type:"CalloutProps"},d),{componentRef:r.createRef(),hasDynamicSizing:d.hasDynamicSizing});return"string"==typeof c?p.message=c:p.content=c,u?Object(o.__assign)(Object(o.__assign)({},p),{type:"TeachingCalloutProps"}):p}function Rt(){return{type:"ExternalNotificationProps"}}function Dt(e){return function(e){switch(e.type){case"TextAboveImage":case"DeferredContentType":case"NPSOneClick1":case"NPSOneClick2":case"NPSOneClickRadioButton":case"IdeasCallout":case"FloodgateTeachingCallout":case"PremiumUpsellCallout":return!0;default:return!1}}(e)}},2381:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(270),r=n(204),i=function(e){return Object(o.b)(e,r.b.Floatie)}},2387:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var o=n(4),r=n(13),i=n(460),a=Object(r.c)((function(e){return Object(o.db)({root:{height:i.a.floatieRowHeight,padding:"0 3px",fontSize:12}},e)})),s={root:{height:i.a.floatieLargeControlHeight,minWidth:i.a.minimumFloatieLargeControlWidth,padding:"2px 2px 0px 2px",fontSize:12},flexContainer:{flexDirection:"column"},icon:{width:i.a.floatieLargeIconSize,height:i.a.floatieLargeIconSize,padding:"2px 12px 2px 12px"},textContainer:{padding:"2px 2px 0px 2px",fontSize:14,width:"max-content"}},l={root:{height:i.a.floatieRowHeight,minWidth:i.a.floatieRowHeight,padding:"2px 2px 0px 2px",fontSize:12},flexContainer:{flexDirection:"row"},icon:{width:i.a.menuButtonWidth,height:i.a.menuButtonWidth,padding:"0px 10px 0px 0px"},textContainer:{fontSize:14,fontWeight:400}}},2388:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(0),r={display:"inline-block",lineHeight:"14px",fontSize:"12px"};function i(e){if(e){var t=e.split(" ");return t.length>1?function(){return o.createElement("div",{style:r},o.createElement("div",null,t[0]),o.createElement("div",null,t.slice(1).join(" ")))}:function(){return o.createElement("span",{style:r},e)}}}},2402:function(e,t){e.exports={WebWarning_192x192:"WebWarning_192x192",SearchFilter_192x192:"SearchFilter_192x192",TextCard_192x192:"TextCard_192x192"}},2403:function(e,t,n){"use strict";const o=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+o+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",i=new RegExp("^"+r+"$");t.isExist=function(e){return void 0!==e},t.isEmptyObject=function(e){return 0===Object.keys(e).length},t.merge=function(e,t,n){if(t){const o=Object.keys(t),r=o.length;for(let i=0;i<r;i++)e[o[i]]="strict"===n?[t[o[i]]]:t[o[i]]}},t.getValue=function(e){return t.isExist(e)?e:""},t.isName=function(e){const t=i.exec(e);return!(null==t)},t.getAllMatches=function(e,t){const n=[];let o=t.exec(e);for(;o;){const r=[];r.startIndex=t.lastIndex-o[0].length;const i=o.length;for(let e=0;e<i;e++)r.push(o[e]);n.push(r),o=t.exec(e)}return n},t.nameRegexp=r},2404:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return g})),n.d(t,"d",(function(){return m}));var o=n(2),r=n(131),i=n(48),a=n(869),s=function(e){return e.floatieGroupModels},l=function(e){return e.activeFloatieGroups},c=function(e){return e.contextualUILayoutModel.floatieLayout},u=function(e){return!!e.contextualUILayoutModel.floatieLayout},d=Object(r.a)([l,s],(function(e,t){return e.length<=0?[]:e.map((function(e){var n=t[e];if(void 0!==n)switch(n.type){case"MultiRowFloatieGroupModel":return Object(o.__spreadArray)(Object(o.__spreadArray)([],n.topControlsRow,!0),n.bottomControlsRow,!0);case"SingleRowFloatieGroupModel":return n.controls;case"SingleControlFloatieGroupModel":return[n.control]}return[]})).reduce((function(e,t){return e.concat.apply(e,t)}))})),p=Object(r.a)([d,u],(function(e,t){return e.length<=0||!t?[]:e})),h=Object(r.a)([d,i.u],(function(e,t){if(e.length<=0)return{};var n={};return e.forEach((function(e){var o=Object(i.p)(t,e);n[e]=o.modelType})),n}));function g(){Object(a.c)((function(e){return p(e)}))}function m(e){return{getFloatieOnlyControlsMap:function(){return h(e.getState())}}}},2405:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v}));var o=n(2),r=n(4),i=n(13),a=n(96),s=n(294),l=n(327),c=n(460),u=Object(i.c)((function(e,t){return Object(r.eb)({display:e?"none":"flex"},t)})),d=Object(i.c)((function(e,t){return Object(r.db)({wrapper:{position:"relative",maxWidth:"490px"},container:Object(r.eb)(p,h),leftFade:Object(r.eb)(g,m(e,t)),rightFade:Object(r.eb)(g,f(e,t))})})),p={display:"inline-flex",width:"100%",overflowX:"scroll",whiteSpace:"nowrap",MsOverflowStyle:"none",selectors:{"::-webkit-scrollbar":{display:"none"}}},h={"scrollbar-width":"none"},g={position:"absolute",top:0,width:"25px",height:"100%",zIndex:1,pointerEvents:"none"},m=Object(i.c)((function(e,t){var n=Object(a.a)(e);return{left:0,backgroundImage:"linear-gradient(to right, ".concat(n.menuBackgroundColor," 20%, transparent)"),visibility:t?"visible":"hidden"}})),f=Object(i.c)((function(e,t){var n=Object(a.a)(e);return{right:0,backgroundImage:"linear-gradient(to left,  ".concat(n.menuBackgroundColor," 20%, transparent)"),visibility:t?"hidden":"visible"}})),b=Object(i.c)((function(e,t,n,i){var l=Object(a.a)(e);return Object(r.db)({root:Object(o.__assign)({animation:"none",border:"none",lineHeight:"14px"},Object(s.e)()?{display:"inline"}:{}),calloutMain:{background:l.menuBackgroundColor,display:"inline-flex",alignItems:"center",padding:"3px 4px"},container:t?{opacity:0}:{opacity:n}},i)})),v=Object(i.c)((function(e){return Object(r.db)(Object(l.c)(e),{divider:{height:c.a.floatieDividerHeight},wrapper:{padding:"0 5px"}})}))},2419:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c}));var o=n(4),r=n(13),i=n(284),a=n(495),s=Object(r.c)((function(e,t,n,r){var s,l,c,u="path[class*='OfficeIconColors_m']:not(.OfficeIconColors_HighContrast)",d={backgroundColor:e?"highlight":void 0},p={root:(s={width:"36px",minWidth:"36px",height:"30px",border:"none",marginLeft:"0px",borderRadius:"0px",padding:"0px"},s[o.m]=d,s),rootDisabled:{border:"none"},icon:(l={},l[u]={fill:e&&!t?Object(a.e)(r).textColor:Object(a.f)(r).textColor},l[o.m]={selectors:(c={},c[u]={fill:e?"highlighttext":"transparent"},c)},l.width="18px",l.height="18px",l.margin="0px",l),label:{display:"none"}};return Object(o.db)(e?Object(i.o)(r):Object(i.p)(r),Object(a.d)(e?Object(a.c)(r,n):Object(a.f)(r),a.a),p)})),l=Object(r.c)((function(){return{margin:"auto 10px"}})),c=Object(r.c)((function(){return{bodyContainer:{width:i.a},bodyItemContainer:{marginBottom:"15px"},label:{root:{padding:"0px"}},input:{root:{"*::-ms-reveal":{display:"none"}},field:{padding:"8px 6px"},suffix:{backgroundColor:"inherit",padding:"0px",flexShrink:0,height:"100%"}}}}))},2420:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(2),r=n(112),i=n(134),a=n(648),s=n(495),l=n(445),c=n(13),u=function(e,t){if(!Object(r.c)())return function(e){return{defaultBackgroundColor:i.a.white,textColor:e.primary,textHoverColor:e.shade10,textPressedColor:e.shade20,hoverBackgroundColor:e.tint40,pressedBackgroundColor:e.tint30,disabledBackgroundColor:e.primary,textDisabledColor:e.tint30,focusDisabledBackgroundColor:e.primary,disabledBorderColor:e.tint30,focusedBackgroundColor:i.a.white,focusedBorderColor:e.primary,focusDisabledBorderColor:e.primary,toggledBackgroundColor:e.tint40,borderColor:"transparent"}}(t);var n=Object(a.a)(e);return{defaultBackgroundColor:n.controlBackgroundColorForPrimaryBackground,textColor:n.primaryTextColor,textHoverColor:n.primaryTextHoverColor,textPressedColor:n.primaryTextActiveColor,hoverBackgroundColor:n.controlHoverBackgroundColorForPrimaryBackground,pressedBackgroundColor:n.controlPressedBackgroundColorForPrimaryBackground,disabledBackgroundColor:e.palette.themePrimary,textDisabledColor:e.palette.themeLight,focusDisabledBackgroundColor:e.palette.themePrimary,disabledBorderColor:e.palette.themeLight,focusedBackgroundColor:e.palette.white,focusedBorderColor:e.palette.themePrimary,focusDisabledBorderColor:e.palette.themePrimary,toggledBackgroundColor:e.palette.themeLighter,borderColor:"transparent"}},d=function(e,t){if(!Object(r.c)())return function(e){return{defaultBackgroundColor:e.primary,textColor:i.a.white,hoverBackgroundColor:e.shade10,pressedBackgroundColor:e.shade20,disabledBackgroundColor:e.primary,textDisabledColor:e.tint30,focusDisabledBackgroundColor:e.primary,disabledBorderColor:e.tint30,focusedBackgroundColor:e.primary,focusedBorderColor:i.a.white,focusDisabledBorderColor:i.a.white,toggledBackgroundColor:e.shade20,borderColor:i.a.white}}(t);var n=Object(a.a)(e);return{defaultBackgroundColor:n.primaryDefaultBackgroundColor,textColor:n.defaultTextLabelColorForPrimaryBackground,hoverBackgroundColor:n.primaryHoverBackgroundColor,pressedBackgroundColor:n.primaryPressedBackgroundColor,disabledBackgroundColor:e.palette.themePrimary,textDisabledColor:e.palette.themeLight,focusDisabledBackgroundColor:e.palette.themePrimary,disabledBorderColor:e.palette.themeLight,focusedBackgroundColor:e.palette.themePrimary,focusedBorderColor:n.primaryFocusBorderColor,focusDisabledBorderColor:n.primaryFocusDisabledBorderColor,toggledBackgroundColor:e.palette.themeDark,borderColor:n.primaryFocusBorderColor}},p=Object(c.c)((function(e,t,n){var c=u(e,t),p=d(e,t),h=Object(a.a)(e,t),g=Object(r.c)(),m=Object(o.__assign)(Object(o.__assign)({},p),{disabledBorderColor:"transparent",borderColor:void 0}),f={title:{color:h.defaultTextLabelColorForPrimaryBackground},mainContent:{color:h.defaultTextLabelColorForPrimaryBackground},closeButton:Object(s.d)(m),jumpToCalloutTargetButton:Object(s.d)(m),primaryButton:Object(s.d)(c,{borderWidth:2,gapBetweenOuter:1}),secondaryButton:Object(s.d)(p,s.a),coachmark:{color:h.primaryTextColor,beaconColorOne:h.primaryDefaultBackgroundColor,beaconColorTwo:h.primaryDefaultBackgroundColor},subComponentStyles:{callout:{beakCurtain:{backgroundColor:h.primaryDefaultBackgroundColor},beak:{backgroundColor:h.primaryDefaultBackgroundColor},calloutMain:{backgroundColor:h.primaryDefaultBackgroundColor,color:h.defaultTextLabelColorForPrimaryBackground,selectors:{"a:link, a:visited":{color:h.defaultTextLabelColorForPrimaryBackground},"a:hover":{color:g?e.palette.neutralLighterAlt:i.a.gray10},"a:active":{color:g?e.palette.neutralLighterAlt:i.a.gray20}}}}}};return Object(l.h)(f,n)}))},2421:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(2),r=n(0),i=n(648),a=n(495),s=n(269),l=n(445),c=n(2422),u=n(1153),d=n(2424),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,p=t.styles,h=t.calloutProps,g=function(e){var t=Object(i.a)(e);return{primaryButton:Object(a.d)(Object(a.c)(e,n),a.a),subComponentStyles:{callout:{calloutMain:{selectors:{"a:link, a:visited":{color:t.primaryTextColor},"a:hover":{color:t.primaryTextHoverColor},"a:active":{color:t.primaryTextActiveColor}}}}}}},m=Object(o.__assign)(Object(o.__assign)({},h),Object(c.b)(this.props));return r.createElement(s.a,null,(function(t){return r.createElement(d.a,Object(o.__assign)({},e.props,{calloutProps:m,externalDismissCommandHandler:u.a,actionableAnnouncement:Object(c.a)(e.props),styles:Object(l.h)(g(t),p)}))}))},t}(r.PureComponent)},2422:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var o=n(2423);function r(e){return{"aria-roledescription":"TeachingCalloutProps"===e.type?o.a.TeachingNotification:o.a.Notification}}function i(e){return e.primaryButtonProps||e.secondaryButtonProps||e.firstFocusElement?o.a.Actionable:void 0}},2423:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o=NotificationStrings},2424:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(2),r=n(0),i=n(2030),a=n(67),s=n(70),l=n(181),c=n(1131),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onFullRenderCompleted=function(e){void 0===e&&(e=!1);var t=window.performance.now()-n.firstRenderStartMs;e===!!n.props.useCoachmark&&a.a.sendTraceTag(593371728,s.a.msoulscat_Wac_Ribbon,l.a.Info,"".concat(e?"Coachmark":"Callout"," first render time: ").concat(t," ms")),n.props.onFullRenderCompleted&&n.props.onFullRenderCompleted(e)},n.firstRenderStartMs=window.performance.now(),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=Object(c.a)().shieldSettings().isCalloutInsertFirstFixEnabled()?Object(o.__assign)(Object(o.__assign)({},this.props),{calloutProps:Object(o.__assign)(Object(o.__assign)({},this.props.calloutProps),{layerProps:Object(o.__assign)({insertFirst:!0},null===(e=this.props.calloutProps)||void 0===e?void 0:e.layerProps)})}):this.props;return r.createElement(i.a,Object(o.__assign)({},t,{onFullRenderCompleted:this.onFullRenderCompleted}))},t}(r.PureComponent)},2425:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(2),r=n(0),i=n(2420),a=n(2422),s=n(1153),l=n(2424),c=n(269),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,u=t.styles,d=t.calloutProps,p=Object(o.__assign)(Object(o.__assign)({},d),Object(a.b)(this.props));return r.createElement(c.a,null,(function(t){return r.createElement(l.a,Object(o.__assign)({},e.props,{calloutProps:p,externalDismissCommandHandler:s.a,actionableAnnouncement:Object(a.a)(e.props),styles:Object(i.a)(t,n,u)}))}))},t}(r.PureComponent)},2426:function(e,t,n){var o=n(2483),r=n(2484),i={float:"cssFloat"},a=n(2487);function s(e,t,n){var s=i[t];if(void 0===s&&(s=function(e){var t=r(e),n=o(t);return i[t]=i[e]=i[n]=n,n}(t)),s){if(void 0===n)return e.style[s];e.style[s]=a(s,n)}}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&s(e,n,t[n])}function c(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:l(arguments[0],arguments[1]):s(arguments[0],arguments[1],arguments[2])}e.exports=c,e.exports.set=c,e.exports.get=function(e,t){return Array.isArray(t)?t.reduce((function(t,n){return t[n]=s(e,n||""),t}),{}):s(e,t||"")}},2427:function(e,t,n){"use strict";const o=n(2403),r={allowBooleanAttributes:!1,unpairedTags:[]};function i(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function a(e,t){const n=t;for(;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{const o=e.substr(n,t-n);if(t>5&&"xml"===o)return p("InvalidXml","XML declaration allowed only at the start of the document.",g(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function s(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let n=1;for(t+=8;t<e.length;t++)if("<"===e[t])n++;else if(">"===e[t]&&(n--,0===n))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}t.validate=function(e,t){t=Object.assign({},r,t);const n=[];let c=!1,h=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let r=0;r<e.length;r++)if("<"===e[r]&&"?"===e[r+1]){if(r+=2,r=a(e,r),r.err)return r}else{if("<"!==e[r]){if(i(e[r]))continue;return p("InvalidChar","char '"+e[r]+"' is not expected.",g(e,r))}{let f=r;if(r++,"!"===e[r]){r=s(e,r);continue}{let b=!1;"/"===e[r]&&(b=!0,r++);let v="";for(;r<e.length&&">"!==e[r]&&" "!==e[r]&&"\t"!==e[r]&&"\n"!==e[r]&&"\r"!==e[r];r++)v+=e[r];if(v=v.trim(),"/"===v[v.length-1]&&(v=v.substring(0,v.length-1),r--),m=v,!o.isName(m)){let t;return t=0===v.trim().length?"Invalid space after '<'.":"Tag '"+v+"' is an invalid name.",p("InvalidTag",t,g(e,r))}const y=l(e,r);if(!1===y)return p("InvalidAttr","Attributes for '"+v+"' have open quote.",g(e,r));let x=y.value;if(r=y.index,"/"===x[x.length-1]){const n=r-x.length;x=x.substring(0,x.length-1);const o=u(x,t);if(!0!==o)return p(o.err.code,o.err.msg,g(e,n+o.err.line));c=!0}else if(b){if(!y.tagClosed)return p("InvalidTag","Closing tag '"+v+"' doesn't have proper closing.",g(e,r));if(x.trim().length>0)return p("InvalidTag","Closing tag '"+v+"' can't have attributes or invalid starting.",g(e,f));{const t=n.pop();if(v!==t.tagName){let n=g(e,t.tagStartPos);return p("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+v+"'.",g(e,f))}0==n.length&&(h=!0)}}else{const o=u(x,t);if(!0!==o)return p(o.err.code,o.err.msg,g(e,r-x.length+o.err.line));if(!0===h)return p("InvalidXml","Multiple possible root nodes found.",g(e,r));-1!==t.unpairedTags.indexOf(v)||n.push({tagName:v,tagStartPos:f}),c=!0}for(r++;r<e.length;r++)if("<"===e[r]){if("!"===e[r+1]){r++,r=s(e,r);continue}if("?"!==e[r+1])break;if(r=a(e,++r),r.err)return r}else if("&"===e[r]){const t=d(e,r);if(-1==t)return p("InvalidChar","char '&' is not expected.",g(e,r));r=t}else if(!0===h&&!i(e[r]))return p("InvalidXml","Extra text at the end",g(e,r));"<"===e[r]&&r--}}}var m;return c?1==n.length?p("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",g(e,n[0].tagStartPos)):!(n.length>0)||p("InvalidXml","Invalid '"+JSON.stringify(n.map(e=>e.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):p("InvalidXml","Start tag expected.",1)};function l(e,t){let n="",o="",r=!1;for(;t<e.length;t++){if('"'===e[t]||"'"===e[t])""===o?o=e[t]:o!==e[t]||(o="");else if(">"===e[t]&&""===o){r=!0;break}n+=e[t]}return""===o&&{value:n,index:t,tagClosed:r}}const c=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function u(e,t){const n=o.getAllMatches(e,c),r={};for(let e=0;e<n.length;e++){if(0===n[e][1].length)return p("InvalidAttr","Attribute '"+n[e][2]+"' has no space in starting.",m(n[e]));if(void 0!==n[e][3]&&void 0===n[e][4])return p("InvalidAttr","Attribute '"+n[e][2]+"' is without value.",m(n[e]));if(void 0===n[e][3]&&!t.allowBooleanAttributes)return p("InvalidAttr","boolean attribute '"+n[e][2]+"' is not allowed.",m(n[e]));const o=n[e][2];if(!h(o))return p("InvalidAttr","Attribute '"+o+"' is an invalid name.",m(n[e]));if(r.hasOwnProperty(o))return p("InvalidAttr","Attribute '"+o+"' is repeated.",m(n[e]));r[o]=1}return!0}function d(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let n=/\d/;for("x"===e[t]&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(n))break}return-1}(e,++t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(";"===e[t])break;return-1}return t}function p(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function h(e){return o.isName(e)}function g(e,t){const n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function m(e){return e.startIndex+e[1].length}},2475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationStrings=void 0,t.NotificationStrings={Actionable:"Actionable",JumpToCalloutTarget:"JumpToCalloutTarget",Notification:"Notification",TeachingNotification:"TeachingNotification",PremiumFeatureDiamond:"PremiumFeatureDiamond",FeedbackBarPrompt:"FeedbackBarPrompt",FeedbackBarResponse:"FeedbackBarResponse",FeedbackBarPositiveTooltip:"FeedbackBarPositiveTooltip",FeedbackBarNegativeTooltip:"FeedbackBarNegativeTooltip"}},2476:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2),r=n(0),i=function(e){function t(n){var o,r,i=this;i=e.call(this,n)||this;var a=n.toastProps.toastContainerId;return a&&(null===(o=t._toastContainers)||void 0===o?void 0:o.has(a))?i.state={container:null===(r=t._toastContainers)||void 0===r?void 0:r.get(a)}:t._defaultContainer?i.state={container:t._defaultContainer}:(i.state={},t._waitingToastCallbacks.push((function(e){return i.setState({container:e})}))),i}return Object(o.__extends)(t,e),t.setDefaultContainer=function(e){this._defaultContainer=e,this._waitingToastCallbacks.length&&(this._waitingToastCallbacks.forEach((function(t){return t(e)})),this._waitingToastCallbacks=[])},t.addToastContainer=function(e,t){var n;null===(n=this._toastContainers)||void 0===n||n.set(e,t)},t.prototype.componentWillUnmount=function(){this.removeToast()},t.prototype.componentDidUpdate=function(e,t){var n=this.props.toastProps,o=this.state.container;!t.container&&this.state.container&&this.ensureRegisteredWithContainer(),this.toastKey&&o&&e.toastProps!==n&&o.updateToast(this.toastKey,n)},t.prototype.componentDidMount=function(){this.ensureRegisteredWithContainer()},t.prototype.render=function(){return this.state.container?r.createElement(r.Fragment,null):null},t.prototype.ensureRegisteredWithContainer=function(){var e=this,t=this.props,n=t.toastProps,r=Object(o.__rest)(t,["toastProps"]);if(this.state.container&&!this.toastKey){var i=Object(o.__assign)(Object(o.__assign)({},r),{onHide:function(){e.removeToast(),r.onHide&&r.onHide()},telemetryId:this.props.telemetryId||"toast"});this.toastKey=this.state.container.addToast(n,i)}},t.prototype.removeToast=function(){var e=this.state.container;this.toastKey&&e&&e.removeToast(this.toastKey),this.toastKey=void 0},t.defaultProps={showExclusively:!1},t._toastContainers=new Map,t._waitingToastCallbacks=[],t}(r.PureComponent)},2477:function(e,t){function n(e,t,n,o){var r,i=null==(r=o)||"number"==typeof r||"boolean"==typeof r?o:n(o),a=t.get(i);return void 0===a&&(a=e.call(this,o),t.set(i,a)),a}function o(e,t,n){var o=Array.prototype.slice.call(arguments,3),r=n(o),i=t.get(r);return void 0===i&&(i=e.apply(this,o),t.set(r,i)),i}function r(e,t,n,o,r){return n.bind(t,e,o,r)}function i(e,t){return r(e,this,1===e.length?n:o,t.cache.create(),t.serializer)}function a(){return JSON.stringify(arguments)}function s(){this.cache=Object.create(null)}s.prototype.has=function(e){return e in this.cache},s.prototype.get=function(e){return this.cache[e]},s.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new s}};e.exports=function(e,t){var n=t&&t.cache?t.cache:l,o=t&&t.serializer?t.serializer:a;return(t&&t.strategy?t.strategy:i)(e,{cache:n,serializer:o})},e.exports.strategies={variadic:function(e,t){return r(e,this,o,t.cache.create(),t.serializer)},monadic:function(e,t){return r(e,this,n,t.cache.create(),t.serializer)}}},2478:function(e){e.exports=JSON.parse('{"name":"@ms/centro-hvc-loader","version":"2.0.4","description":"Project Centro high value component loader","sideEffects":"**/*.redux.ts","license":"UNLICENSED","devDependencies":{"@types/webpack-env":"1.15.1","typescript":"4.2.3-gauri-patch-3"},"homepage":"https://office.visualstudio.com/OC/_git/M365AdminUX?path=%2Fmodules%2Fhvc-loader","bugs":{"url":"https://office.visualstudio.com/OC/_workitems/edit/2364251","email":"centroinfo@microsoft.com"},"author":"MAC Platform Team <macplat@microsoft.com>","main":"./dist/hvc-loader/index.js","module":"./dist/hvc-loader/index.js","typings":"./dist/hvc-loader/index.d.ts","scripts":{"build":"tsc -p ./tsconfig.json"},"dependencies":{"tslib":"^2.1.0"}}')},2479:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scrollbars=void 0;var o,r=n(2480),i=(o=r)&&o.__esModule?o:{default:o};t.default=i.default,t.Scrollbars=i.default},2480:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2481),a=b(i),s=b(n(2426)),l=n(0),c=b(n(672)),u=b(n(2488)),d=b(n(2489)),p=b(n(2490)),h=b(n(2491)),g=b(n(2492)),m=n(2493),f=n(2494);function b(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var x=function(e){function t(e){var n;v(this,t);for(var o=arguments.length,r=Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];var a=y(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this,e].concat(r)));return a.getScrollLeft=a.getScrollLeft.bind(a),a.getScrollTop=a.getScrollTop.bind(a),a.getScrollWidth=a.getScrollWidth.bind(a),a.getScrollHeight=a.getScrollHeight.bind(a),a.getClientWidth=a.getClientWidth.bind(a),a.getClientHeight=a.getClientHeight.bind(a),a.getValues=a.getValues.bind(a),a.getThumbHorizontalWidth=a.getThumbHorizontalWidth.bind(a),a.getThumbVerticalHeight=a.getThumbVerticalHeight.bind(a),a.getScrollLeftForOffset=a.getScrollLeftForOffset.bind(a),a.getScrollTopForOffset=a.getScrollTopForOffset.bind(a),a.scrollLeft=a.scrollLeft.bind(a),a.scrollTop=a.scrollTop.bind(a),a.scrollToLeft=a.scrollToLeft.bind(a),a.scrollToTop=a.scrollToTop.bind(a),a.scrollToRight=a.scrollToRight.bind(a),a.scrollToBottom=a.scrollToBottom.bind(a),a.handleTrackMouseEnter=a.handleTrackMouseEnter.bind(a),a.handleTrackMouseLeave=a.handleTrackMouseLeave.bind(a),a.handleHorizontalTrackMouseDown=a.handleHorizontalTrackMouseDown.bind(a),a.handleVerticalTrackMouseDown=a.handleVerticalTrackMouseDown.bind(a),a.handleHorizontalThumbMouseDown=a.handleHorizontalThumbMouseDown.bind(a),a.handleVerticalThumbMouseDown=a.handleVerticalThumbMouseDown.bind(a),a.handleWindowResize=a.handleWindowResize.bind(a),a.handleScroll=a.handleScroll.bind(a),a.handleDrag=a.handleDrag.bind(a),a.handleDragEnd=a.handleDragEnd.bind(a),a.state={didMountUniversal:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.addListeners(),this.update(),this.componentDidMountUniversal()}},{key:"componentDidMountUniversal",value:function(){this.props.universal&&this.setState({didMountUniversal:!0})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){this.removeListeners(),(0,i.cancel)(this.requestFrame),clearTimeout(this.hideTracksTimeout),clearInterval(this.detectScrollingInterval)}},{key:"getScrollLeft",value:function(){return this.view?this.view.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.view?this.view.scrollTop:0}},{key:"getScrollWidth",value:function(){return this.view?this.view.scrollWidth:0}},{key:"getScrollHeight",value:function(){return this.view?this.view.scrollHeight:0}},{key:"getClientWidth",value:function(){return this.view?this.view.clientWidth:0}},{key:"getClientHeight",value:function(){return this.view?this.view.clientHeight:0}},{key:"getValues",value:function(){var e=this.view||{},t=e.scrollLeft,n=void 0===t?0:t,o=e.scrollTop,r=void 0===o?0:o,i=e.scrollWidth,a=void 0===i?0:i,s=e.scrollHeight,l=void 0===s?0:s,c=e.clientWidth,u=void 0===c?0:c,d=e.clientHeight,p=void 0===d?0:d;return{left:n/(a-u)||0,top:r/(l-p)||0,scrollLeft:n,scrollTop:r,scrollWidth:a,scrollHeight:l,clientWidth:u,clientHeight:p}}},{key:"getThumbHorizontalWidth",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,o=this.view,r=o.scrollWidth,i=o.clientWidth,a=(0,h.default)(this.trackHorizontal),s=Math.ceil(i/r*a);return a===s?0:t||Math.max(s,n)}},{key:"getThumbVerticalHeight",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,o=this.view,r=o.scrollHeight,i=o.clientHeight,a=(0,g.default)(this.trackVertical),s=Math.ceil(i/r*a);return a===s?0:t||Math.max(s,n)}},{key:"getScrollLeftForOffset",value:function(e){var t=this.view,n=t.scrollWidth,o=t.clientWidth;return e/((0,h.default)(this.trackHorizontal)-this.getThumbHorizontalWidth())*(n-o)}},{key:"getScrollTopForOffset",value:function(e){var t=this.view,n=t.scrollHeight,o=t.clientHeight;return e/((0,g.default)(this.trackVertical)-this.getThumbVerticalHeight())*(n-o)}},{key:"scrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollLeft=e)}},{key:"scrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollTop=e)}},{key:"scrollToLeft",value:function(){this.view&&(this.view.scrollLeft=0)}},{key:"scrollToTop",value:function(){this.view&&(this.view.scrollTop=0)}},{key:"scrollToRight",value:function(){this.view&&(this.view.scrollLeft=this.view.scrollWidth)}},{key:"scrollToBottom",value:function(){this.view&&(this.view.scrollTop=this.view.scrollHeight)}},{key:"addListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,o=this.thumbHorizontal,r=this.thumbVertical;e.addEventListener("scroll",this.handleScroll),(0,d.default)()&&(t.addEventListener("mouseenter",this.handleTrackMouseEnter),t.addEventListener("mouseleave",this.handleTrackMouseLeave),t.addEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.addEventListener("mouseenter",this.handleTrackMouseEnter),n.addEventListener("mouseleave",this.handleTrackMouseLeave),n.addEventListener("mousedown",this.handleVerticalTrackMouseDown),o.addEventListener("mousedown",this.handleHorizontalThumbMouseDown),r.addEventListener("mousedown",this.handleVerticalThumbMouseDown),window.addEventListener("resize",this.handleWindowResize))}}},{key:"removeListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,o=this.thumbHorizontal,r=this.thumbVertical;e.removeEventListener("scroll",this.handleScroll),(0,d.default)()&&(t.removeEventListener("mouseenter",this.handleTrackMouseEnter),t.removeEventListener("mouseleave",this.handleTrackMouseLeave),t.removeEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.removeEventListener("mouseenter",this.handleTrackMouseEnter),n.removeEventListener("mouseleave",this.handleTrackMouseLeave),n.removeEventListener("mousedown",this.handleVerticalTrackMouseDown),o.removeEventListener("mousedown",this.handleHorizontalThumbMouseDown),r.removeEventListener("mousedown",this.handleVerticalThumbMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.teardownDragging())}}},{key:"handleScroll",value:function(e){var t=this,n=this.props,o=n.onScroll,r=n.onScrollFrame;o&&o(e),this.update((function(e){var n=e.scrollLeft,o=e.scrollTop;t.viewScrollLeft=n,t.viewScrollTop=o,r&&r(e)})),this.detectScrolling()}},{key:"handleScrollStart",value:function(){var e=this.props.onScrollStart;e&&e(),this.handleScrollStartAutoHide()}},{key:"handleScrollStartAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleScrollStop",value:function(){var e=this.props.onScrollStop;e&&e(),this.handleScrollStopAutoHide()}},{key:"handleScrollStopAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleWindowResize",value:function(){this.update()}},{key:"handleHorizontalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientX,o=t.getBoundingClientRect().left,r=this.getThumbHorizontalWidth(),i=Math.abs(o-n)-r/2;this.view.scrollLeft=this.getScrollLeftForOffset(i)}},{key:"handleVerticalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientY,o=t.getBoundingClientRect().top,r=this.getThumbVerticalHeight(),i=Math.abs(o-n)-r/2;this.view.scrollTop=this.getScrollTopForOffset(i)}},{key:"handleHorizontalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientX,o=t.offsetWidth,r=t.getBoundingClientRect().left;this.prevPageX=o-(n-r)}},{key:"handleVerticalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientY,o=t.offsetHeight,r=t.getBoundingClientRect().top;this.prevPageY=o-(n-r)}},{key:"setupDragging",value:function(){(0,s.default)(document.body,m.disableSelectStyle),document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.handleDragEnd),document.onselectstart=p.default}},{key:"teardownDragging",value:function(){(0,s.default)(document.body,m.disableSelectStyleReset),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleDragEnd),document.onselectstart=void 0}},{key:"handleDragStart",value:function(e){this.dragging=!0,e.stopImmediatePropagation(),this.setupDragging()}},{key:"handleDrag",value:function(e){if(this.prevPageX){var t=e.clientX,n=-this.trackHorizontal.getBoundingClientRect().left+t-(this.getThumbHorizontalWidth()-this.prevPageX);this.view.scrollLeft=this.getScrollLeftForOffset(n)}if(this.prevPageY){var o=e.clientY,r=-this.trackVertical.getBoundingClientRect().top+o-(this.getThumbVerticalHeight()-this.prevPageY);this.view.scrollTop=this.getScrollTopForOffset(r)}return!1}},{key:"handleDragEnd",value:function(){this.dragging=!1,this.prevPageX=this.prevPageY=0,this.teardownDragging(),this.handleDragEndAutoHide()}},{key:"handleDragEndAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleTrackMouseEnter",value:function(){this.trackMouseOver=!0,this.handleTrackMouseEnterAutoHide()}},{key:"handleTrackMouseEnterAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleTrackMouseLeave",value:function(){this.trackMouseOver=!1,this.handleTrackMouseLeaveAutoHide()}},{key:"handleTrackMouseLeaveAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"showTracks",value:function(){clearTimeout(this.hideTracksTimeout),(0,s.default)(this.trackHorizontal,{opacity:1}),(0,s.default)(this.trackVertical,{opacity:1})}},{key:"hideTracks",value:function(){var e=this;if(!this.dragging&&!this.scrolling&&!this.trackMouseOver){var t=this.props.autoHideTimeout;clearTimeout(this.hideTracksTimeout),this.hideTracksTimeout=setTimeout((function(){(0,s.default)(e.trackHorizontal,{opacity:0}),(0,s.default)(e.trackVertical,{opacity:0})}),t)}}},{key:"detectScrolling",value:function(){var e=this;this.scrolling||(this.scrolling=!0,this.handleScrollStart(),this.detectScrollingInterval=setInterval((function(){e.lastViewScrollLeft===e.viewScrollLeft&&e.lastViewScrollTop===e.viewScrollTop&&(clearInterval(e.detectScrollingInterval),e.scrolling=!1,e.handleScrollStop()),e.lastViewScrollLeft=e.viewScrollLeft,e.lastViewScrollTop=e.viewScrollTop}),100))}},{key:"raf",value:function(e){var t=this;this.requestFrame&&a.default.cancel(this.requestFrame),this.requestFrame=(0,a.default)((function(){t.requestFrame=void 0,e()}))}},{key:"update",value:function(e){var t=this;this.raf((function(){return t._update(e)}))}},{key:"_update",value:function(e){var t=this.props,n=t.onUpdate,o=t.hideTracksWhenNotNeeded,r=this.getValues();if((0,d.default)()){var i=r.scrollLeft,a=r.clientWidth,l=r.scrollWidth,c=(0,h.default)(this.trackHorizontal),u=this.getThumbHorizontalWidth(),p={width:u,transform:"translateX("+i/(l-a)*(c-u)+"px)"},m=r.scrollTop,f=r.clientHeight,b=r.scrollHeight,v=(0,g.default)(this.trackVertical),y=this.getThumbVerticalHeight(),x={height:y,transform:"translateY("+m/(b-f)*(v-y)+"px)"};if(o){var C={visibility:l>a?"visible":"hidden"},S={visibility:b>f?"visible":"hidden"};(0,s.default)(this.trackHorizontal,C),(0,s.default)(this.trackVertical,S)}(0,s.default)(this.thumbHorizontal,p),(0,s.default)(this.thumbVertical,x)}n&&n(r),"function"==typeof e&&e(r)}},{key:"render",value:function(){var e=this,t=(0,d.default)(),n=this.props,r=(n.onScroll,n.onScrollFrame,n.onScrollStart,n.onScrollStop,n.onUpdate,n.renderView),i=n.renderTrackHorizontal,a=n.renderTrackVertical,s=n.renderThumbHorizontal,c=n.renderThumbVertical,p=n.tagName,h=(n.hideTracksWhenNotNeeded,n.autoHide),g=(n.autoHideTimeout,n.autoHideDuration),f=(n.thumbSize,n.thumbMinSize,n.universal),b=n.autoHeight,v=n.autoHeightMin,y=n.autoHeightMax,x=n.style,C=n.children,S=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(n,["onScroll","onScrollFrame","onScrollStart","onScrollStop","onUpdate","renderView","renderTrackHorizontal","renderTrackVertical","renderThumbHorizontal","renderThumbVertical","tagName","hideTracksWhenNotNeeded","autoHide","autoHideTimeout","autoHideDuration","thumbSize","thumbMinSize","universal","autoHeight","autoHeightMin","autoHeightMax","style","children"]),E=this.state.didMountUniversal,k=o({},m.containerStyleDefault,b&&o({},m.containerStyleAutoHeight,{minHeight:v,maxHeight:y}),x),O=o({},m.viewStyleDefault,{marginRight:t?-t:0,marginBottom:t?-t:0},b&&o({},m.viewStyleAutoHeight,{minHeight:(0,u.default)(v)?"calc("+v+" + "+t+"px)":v+t,maxHeight:(0,u.default)(y)?"calc("+y+" + "+t+"px)":y+t}),b&&f&&!E&&{minHeight:v,maxHeight:y},f&&!E&&m.viewStyleUniversalInitial),T={transition:"opacity "+g+"ms",opacity:0},I=o({},m.trackHorizontalStyleDefault,h&&T,(!t||f&&!E)&&{display:"none"}),w=o({},m.trackVerticalStyleDefault,h&&T,(!t||f&&!E)&&{display:"none"});return(0,l.createElement)(p,o({},S,{style:k,ref:function(t){e.container=t}}),[(0,l.cloneElement)(r({style:O}),{key:"view",ref:function(t){e.view=t}},C),(0,l.cloneElement)(i({style:I}),{key:"trackHorizontal",ref:function(t){e.trackHorizontal=t}},(0,l.cloneElement)(s({style:m.thumbHorizontalStyleDefault}),{ref:function(t){e.thumbHorizontal=t}})),(0,l.cloneElement)(a({style:w}),{key:"trackVertical",ref:function(t){e.trackVertical=t}},(0,l.cloneElement)(c({style:m.thumbVerticalStyleDefault}),{ref:function(t){e.thumbVertical=t}}))])}}]),t}(l.Component);t.default=x,x.propTypes={onScroll:c.default.func,onScrollFrame:c.default.func,onScrollStart:c.default.func,onScrollStop:c.default.func,onUpdate:c.default.func,renderView:c.default.func,renderTrackHorizontal:c.default.func,renderTrackVertical:c.default.func,renderThumbHorizontal:c.default.func,renderThumbVertical:c.default.func,tagName:c.default.string,thumbSize:c.default.number,thumbMinSize:c.default.number,hideTracksWhenNotNeeded:c.default.bool,autoHide:c.default.bool,autoHideTimeout:c.default.number,autoHideDuration:c.default.number,autoHeight:c.default.bool,autoHeightMin:c.default.oneOfType([c.default.number,c.default.string]),autoHeightMax:c.default.oneOfType([c.default.number,c.default.string]),universal:c.default.bool,style:c.default.object,children:c.default.node},x.defaultProps={renderView:f.renderViewDefault,renderTrackHorizontal:f.renderTrackHorizontalDefault,renderTrackVertical:f.renderTrackVerticalDefault,renderThumbHorizontal:f.renderThumbHorizontalDefault,renderThumbVertical:f.renderThumbVerticalDefault,tagName:"div",thumbMinSize:30,hideTracksWhenNotNeeded:!1,autoHide:!1,autoHideTimeout:1e3,autoHideDuration:200,autoHeight:!1,autoHeightMin:0,autoHeightMax:200,universal:!1}},2481:function(e,t,n){(function(t){for(var o=n(2482),r="undefined"==typeof window?t:window,i=["moz","webkit"],a="AnimationFrame",s=r["request"+a],l=r["cancel"+a]||r["cancelRequest"+a],c=0;!s&&c<i.length;c++)s=r[i[c]+"Request"+a],l=r[i[c]+"Cancel"+a]||r[i[c]+"CancelRequest"+a];if(!s||!l){var u=0,d=0,p=[];s=function(e){if(0===p.length){var t=o(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout((function(){var e=p.slice(0);p.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return p.push({handle:++d,callback:e,cancelled:!1}),d},l=function(e){for(var t=0;t<p.length;t++)p[t].handle===e&&(p[t].cancelled=!0)}}e.exports=function(e){return s.call(r,e)},e.exports.cancel=function(){l.apply(r,arguments)},e.exports.polyfill=function(e){e||(e=r),e.requestAnimationFrame=s,e.cancelAnimationFrame=l}}).call(this,n(419))},2482:function(e,t,n){(function(t){(function(){var n,o,r,i,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},o=t.hrtime,i=(n=function(){var e;return 1e9*(e=o())[0]+e[1]})(),s=1e9*t.uptime(),a=i-s):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(this,n(1508))},2483:function(e,t){var n=null,o=["Webkit","Moz","O","ms"];e.exports=function(e){n||(n=document.createElement("div"));var t=n.style;if(e in t)return e;for(var r=e.charAt(0).toUpperCase()+e.slice(1),i=o.length;i>=0;i--){var a=o[i]+r;if(a in t)return a}return!1}},2484:function(e,t,n){var o=n(2485);e.exports=function(e){return o(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))}},2485:function(e,t,n){var o=n(2486);e.exports=function(e){return o(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()}},2486:function(e,t){e.exports=function(e){return n.test(e)?e.toLowerCase():o.test(e)?(function(e){return e.replace(i,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():r.test(e)?function(e){return e.replace(a,(function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()};var n=/\s/,o=/(_|-|\.|:)/,r=/([a-z][A-Z]|[A-Z][a-z])/;var i=/[\W_]+(.|$)/g;var a=/(.)([A-Z]+)/g},2487:function(e,t){var n={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};e.exports=function(e,t){return"number"!=typeof t||n[e]?t:t+"px"}},2488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e}},2489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!1!==a)return a;if("undefined"!=typeof document){var e=document.createElement("div");(0,i.default)(e,{width:100,height:100,position:"absolute",top:-9999,overflow:"scroll",MsOverflowStyle:"scrollbar"}),document.body.appendChild(e),a=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else a=0;return a||0};var o,r=n(2426),i=(o=r)&&o.__esModule?o:{default:o};var a=!1},2490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!1}},2491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientWidth,n=getComputedStyle(e),o=n.paddingLeft,r=n.paddingRight;return t-parseFloat(o)-parseFloat(r)}},2492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientHeight,n=getComputedStyle(e),o=n.paddingTop,r=n.paddingBottom;return t-parseFloat(o)-parseFloat(r)}},2493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.containerStyleDefault={position:"relative",overflow:"hidden",width:"100%",height:"100%"},t.containerStyleAutoHeight={height:"auto"},t.viewStyleDefault={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"scroll",WebkitOverflowScrolling:"touch"},t.viewStyleAutoHeight={position:"relative",top:void 0,left:void 0,right:void 0,bottom:void 0},t.viewStyleUniversalInitial={overflow:"hidden",marginRight:0,marginBottom:0},t.trackHorizontalStyleDefault={position:"absolute",height:6},t.trackVerticalStyleDefault={position:"absolute",width:6},t.thumbHorizontalStyleDefault={position:"relative",display:"block",height:"100%"},t.thumbVerticalStyleDefault={position:"relative",display:"block",width:"100%"},t.disableSelectStyle={userSelect:"none"},t.disableSelectStyleReset={userSelect:""}},2494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.renderViewDefault=function(e){return a.default.createElement("div",e)},t.renderTrackHorizontalDefault=function(e){var t=e.style,n=s(e,["style"]),r=o({},t,{right:2,bottom:2,left:2,borderRadius:3});return a.default.createElement("div",o({style:r},n))},t.renderTrackVerticalDefault=function(e){var t=e.style,n=s(e,["style"]),r=o({},t,{right:2,bottom:2,top:2,borderRadius:3});return a.default.createElement("div",o({style:r},n))},t.renderThumbHorizontalDefault=function(e){var t=e.style,n=s(e,["style"]),r=o({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return a.default.createElement("div",o({style:r},n))},t.renderThumbVerticalDefault=function(e){var t=e.style,n=s(e,["style"]),r=o({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return a.default.createElement("div",o({style:r},n))};var r,i=n(0),a=(r=i)&&r.__esModule?r:{default:r};function s(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}},2495:function(e,t,n){"use strict";const o=n(2427),r=n(2496),i=n(2503);e.exports={XMLParser:r,XMLValidator:o,XMLBuilder:i}},2496:function(e,t,n){const{buildOptions:o}=n(2497),r=n(2498),{prettify:i}=n(2502),a=n(2427);e.exports=class{constructor(e){this.externalEntities={},this.options=o(e)}parse(e,t){if("string"==typeof e);else{if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(t){!0===t&&(t={});const n=a.validate(e,t);if(!0!==n)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const n=new r(this.options);n.addExternalEntities(this.externalEntities);const o=n.parseXml(e);return this.options.preserveOrder||void 0===o?o:i(o,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}}},2497:function(e,t){const n={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,n){return e}};t.buildOptions=function(e){return Object.assign({},n,e)},t.defaultOptions=n},2498:function(e,t,n){"use strict";const o=n(2403),r=n(2499),i=n(2500),a=n(2501);"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,o.nameRegexp);function s(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const o=t[n];this.lastEntities[o]={regex:new RegExp("&"+o+";","g"),val:e[o]}}}function l(e,t,n,o,r,i,a){if(void 0!==e&&(this.options.trimValues&&!o&&(e=e.trim()),e.length>0)){a||(e=this.replaceEntitiesValue(e));const o=this.options.tagValueProcessor(t,e,n,r,i);if(null==o)return e;if(typeof o!=typeof e||o!==e)return o;if(this.options.trimValues)return x(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?x(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function c(e){if(this.options.removeNSPrefix){const t=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=n+t[1])}return e}const u=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function d(e,t,n){if(!this.options.ignoreAttributes&&"string"==typeof e){const n=o.getAllMatches(e,u),r=n.length,i={};for(let e=0;e<r;e++){const o=this.resolveNameSpace(n[e][1]);let r=n[e][4],a=this.options.attributeNamePrefix+o;if(o.length)if(this.options.transformAttributeName&&(a=this.options.transformAttributeName(a)),"__proto__"===a&&(a="#__proto__"),void 0!==r){this.options.trimValues&&(r=r.trim()),r=this.replaceEntitiesValue(r);const e=this.options.attributeValueProcessor(o,r,t);i[a]=null==e?r:typeof e!=typeof r||e!==r?e:x(r,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[a]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=i,e}return i}}const p=function(e){e=e.replace(/\r\n?/g,"\n");const t=new r("!xml");let n=t,o="",a="";for(let s=0;s<e.length;s++){if("<"===e[s])if("/"===e[s+1]){const t=b(e,">",s,"Closing Tag is not closed.");let r=e.substring(s+2,t).trim();if(this.options.removeNSPrefix){const e=r.indexOf(":");-1!==e&&(r=r.substr(e+1))}this.options.transformTagName&&(r=this.options.transformTagName(r)),n&&(o=this.saveTextToParentTag(o,n,a));const i=a.substring(a.lastIndexOf(".")+1);if(r&&-1!==this.options.unpairedTags.indexOf(r))throw new Error(`Unpaired tag can not be used as closing tag: </${r}>`);let l=0;i&&-1!==this.options.unpairedTags.indexOf(i)?(l=a.lastIndexOf(".",a.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=a.lastIndexOf("."),a=a.substring(0,l),n=this.tagsNodeStack.pop(),o="",s=t}else if("?"===e[s+1]){let t=v(e,s,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(o=this.saveTextToParentTag(o,n,a),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{const e=new r(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,a,t.tagName)),this.addChild(n,e,a)}s=t.closeIndex+1}else if("!--"===e.substr(s+1,3)){const t=b(e,"--\x3e",s+4,"Comment is not closed.");if(this.options.commentPropName){const r=e.substring(s+4,t-2);o=this.saveTextToParentTag(o,n,a),n.add(this.options.commentPropName,[{[this.options.textNodeName]:r}])}s=t}else if("!D"===e.substr(s+1,2)){const t=i(e,s);this.docTypeEntities=t.entities,s=t.i}else if("!["===e.substr(s+1,2)){const t=b(e,"]]>",s,"CDATA is not closed.")-2,r=e.substring(s+9,t);if(o=this.saveTextToParentTag(o,n,a),this.options.cdataPropName)n.add(this.options.cdataPropName,[{[this.options.textNodeName]:r}]);else{let e=this.parseTextData(r,n.tagname,a,!0,!1,!0);null==e&&(e=""),n.add(this.options.textNodeName,e)}s=t+2}else{let i=v(e,s,this.options.removeNSPrefix),l=i.tagName,c=i.tagExp,u=i.attrExpPresent,d=i.closeIndex;this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&o&&"!xml"!==n.tagname&&(o=this.saveTextToParentTag(o,n,a,!1));const p=n;if(p&&-1!==this.options.unpairedTags.indexOf(p.tagname)&&(n=this.tagsNodeStack.pop(),a=a.substring(0,a.lastIndexOf("."))),l!==t.tagname&&(a+=a?"."+l:l),this.isItStopNode(this.options.stopNodes,a,l)){let t="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)s=i.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(l))s=i.closeIndex;else{const n=this.readStopNodeData(e,l,d+1);if(!n)throw new Error("Unexpected end of "+l);s=n.i,t=n.tagContent}const o=new r(l);l!==c&&u&&(o[":@"]=this.buildAttributesMap(c,a,l)),t&&(t=this.parseTextData(t,l,a,!0,u,!0,!0)),a=a.substr(0,a.lastIndexOf(".")),o.add(this.options.textNodeName,t),this.addChild(n,o,a)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===l[l.length-1]?(l=l.substr(0,l.length-1),a=a.substr(0,a.length-1),c=l):c=c.substr(0,c.length-1),this.options.transformTagName&&(l=this.options.transformTagName(l));const e=new r(l);l!==c&&u&&(e[":@"]=this.buildAttributesMap(c,a,l)),this.addChild(n,e,a),a=a.substr(0,a.lastIndexOf("."))}else{const e=new r(l);this.tagsNodeStack.push(n),l!==c&&u&&(e[":@"]=this.buildAttributesMap(c,a,l)),this.addChild(n,e,a),n=e}o="",s=d}}else o+=e[s]}return t.child};function h(e,t,n){const o=this.options.updateTag(t.tagname,n,t[":@"]);!1===o||("string"==typeof o?(t.tagname=o,e.addChild(t)):e.addChild(t))}const g=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){const n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function m(e,t,n,o){return e&&(void 0===o&&(o=0===Object.keys(t.child).length),void 0!==(e=this.parseTextData(e,t.tagname,n,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,o))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function f(e,t,n){const o="*."+n;for(const n in e){const r=e[n];if(o===r||t===r)return!0}return!1}function b(e,t,n,o){const r=e.indexOf(t,n);if(-1===r)throw new Error(o);return r+t.length-1}function v(e,t,n,o=">"){const r=function(e,t,n=">"){let o,r="";for(let i=t;i<e.length;i++){let t=e[i];if(o)t===o&&(o="");else if('"'===t||"'"===t)o=t;else if(t===n[0]){if(!n[1])return{data:r,index:i};if(e[i+1]===n[1])return{data:r,index:i}}else"\t"===t&&(t=" ");r+=t}}(e,t+1,o);if(!r)return;let i=r.data;const a=r.index,s=i.search(/\s/);let l=i,c=!0;if(-1!==s&&(l=i.substr(0,s).replace(/\s\s*$/,""),i=i.substr(s+1)),n){const e=l.indexOf(":");-1!==e&&(l=l.substr(e+1),c=l!==r.data.substr(e+1))}return{tagName:l,tagExp:i,closeIndex:a,attrExpPresent:c}}function y(e,t,n){const o=n;let r=1;for(;n<e.length;n++)if("<"===e[n])if("/"===e[n+1]){const i=b(e,">",n,t+" is not closed");if(e.substring(n+2,i).trim()===t&&(r--,0===r))return{tagContent:e.substring(o,n),i:i};n=i}else if("?"===e[n+1]){n=b(e,"?>",n+1,"StopNode is not closed.")}else if("!--"===e.substr(n+1,3)){n=b(e,"--\x3e",n+3,"StopNode is not closed.")}else if("!["===e.substr(n+1,2)){n=b(e,"]]>",n,"StopNode is not closed.")-2}else{const o=v(e,n,">");if(o){(o&&o.tagName)===t&&"/"!==o.tagExp[o.tagExp.length-1]&&r++,n=o.closeIndex}}}function x(e,t,n){if(t&&"string"==typeof e){const t=e.trim();return"true"===t||"false"!==t&&a(e,n)}return o.isExist(e)?e:""}e.exports=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"}},this.addExternalEntities=s,this.parseXml=p,this.parseTextData=l,this.resolveNameSpace=c,this.buildAttributesMap=d,this.isItStopNode=f,this.replaceEntitiesValue=g,this.readStopNodeData=y,this.saveTextToParentTag=m,this.addChild=h}}},2499:function(e,t,n){"use strict";e.exports=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}},2500:function(e,t,n){const o=n(2403);function r(e,t){let n="";for(;t<e.length&&"'"!==e[t]&&'"'!==e[t];t++)n+=e[t];if(n=n.trim(),-1!==n.indexOf(" "))throw new Error("External entites are not supported");const o=e[t++];let r="";for(;t<e.length&&e[t]!==o;t++)r+=e[t];return[n,r,t]}function i(e,t){return"!"===e[t+1]&&"-"===e[t+2]&&"-"===e[t+3]}function a(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"N"===e[t+3]&&"T"===e[t+4]&&"I"===e[t+5]&&"T"===e[t+6]&&"Y"===e[t+7]}function s(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"L"===e[t+3]&&"E"===e[t+4]&&"M"===e[t+5]&&"E"===e[t+6]&&"N"===e[t+7]&&"T"===e[t+8]}function l(e,t){return"!"===e[t+1]&&"A"===e[t+2]&&"T"===e[t+3]&&"T"===e[t+4]&&"L"===e[t+5]&&"I"===e[t+6]&&"S"===e[t+7]&&"T"===e[t+8]}function c(e,t){return"!"===e[t+1]&&"N"===e[t+2]&&"O"===e[t+3]&&"T"===e[t+4]&&"A"===e[t+5]&&"T"===e[t+6]&&"I"===e[t+7]&&"O"===e[t+8]&&"N"===e[t+9]}function u(e){if(o.isName(e))return e;throw new Error("Invalid entity name "+e)}e.exports=function(e,t){const n={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let o=1,d=!1,p=!1,h="";for(;t<e.length;t++)if("<"!==e[t]||p)if(">"===e[t]){if(p?"-"===e[t-1]&&"-"===e[t-2]&&(p=!1,o--):o--,0===o)break}else"["===e[t]?d=!0:h+=e[t];else{if(d&&a(e,t))t+=7,[entityName,val,t]=r(e,t+1),-1===val.indexOf("&")&&(n[u(entityName)]={regx:RegExp(`&${entityName};`,"g"),val:val});else if(d&&s(e,t))t+=8;else if(d&&l(e,t))t+=8;else if(d&&c(e,t))t+=9;else{if(!i)throw new Error("Invalid DOCTYPE");p=!0}o++,h=""}if(0!==o)throw new Error("Unclosed DOCTYPE")}return{entities:n,i:t}}},2501:function(e,t){const n=/^[-+]?0x[a-fA-F0-9]+$/,o=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const r={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};e.exports=function(e,t={}){if(t=Object.assign({},r,t),!e||"string"!=typeof e)return e;let i=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(i))return e;if(t.hex&&n.test(i))return Number.parseInt(i,16);{const n=o.exec(i);if(n){const o=n[1],r=n[2];let a=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),e;return e}(n[3]);const s=n[4]||n[6];if(!t.leadingZeros&&r.length>0&&o&&"."!==i[2])return e;if(!t.leadingZeros&&r.length>0&&!o&&"."!==i[1])return e;{const n=Number(i),l=""+n;return-1!==l.search(/[eE]/)||s?t.eNotation?n:e:-1!==i.indexOf(".")?"0"===l&&""===a||l===a||o&&l==="-"+a?n:e:r?a===l||o+a===l?n:e:i===l||i===o+l?n:e}}return e}}},2502:function(e,t,n){"use strict";function o(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const n=t[e];if(":@"!==n)return n}}function r(e,t,n,o){if(t){const r=Object.keys(t),i=r.length;for(let a=0;a<i;a++){const i=r[a];o.isArray(i,n+"."+i,!0,!0)?e[i]=[t[i]]:e[i]=t[i]}}}function i(e,t){const{textNodeName:n}=t,o=Object.keys(e).length;return 0===o||!(1!==o||!e[n]&&"boolean"!=typeof e[n]&&0!==e[n])}t.prettify=function(e,t){return function e(t,n,a){let s;const l={};for(let c=0;c<t.length;c++){const u=t[c],d=o(u);let p="";if(p=void 0===a?d:a+"."+d,d===n.textNodeName)void 0===s?s=u[d]:s+=""+u[d];else{if(void 0===d)continue;if(u[d]){let t=e(u[d],n,p);const o=i(t,n);u[":@"]?r(t,u[":@"],p,n):1!==Object.keys(t).length||void 0===t[n.textNodeName]||n.alwaysCreateTextNode?0===Object.keys(t).length&&(n.alwaysCreateTextNode?t[n.textNodeName]="":t=""):t=t[n.textNodeName],void 0!==l[d]&&l.hasOwnProperty(d)?(Array.isArray(l[d])||(l[d]=[l[d]]),l[d].push(t)):n.isArray(d,p,o)?l[d]=[t]:l[d]=t}}}"string"==typeof s?s.length>0&&(l[n.textNodeName]=s):void 0!==s&&(l[n.textNodeName]=s);return l}(e,t)}},2503:function(e,t,n){"use strict";const o=n(2504),r={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function i(e){this.options=Object.assign({},r,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=l),this.processTextOrObjNode=a,this.options.format?(this.indentate=s,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function a(e,t,n){const o=this.j2x(e,n+1);return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextValNode(e[this.options.textNodeName],t,o.attrStr,n):this.buildObjectNode(o.val,t,o.attrStr,n)}function s(e){return this.options.indentBy.repeat(e)}function l(e){return!(!e.startsWith(this.options.attributeNamePrefix)||e===this.options.textNodeName)&&e.substr(this.attrPrefixLen)}i.prototype.build=function(e){return this.options.preserveOrder?o(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)},i.prototype.j2x=function(e,t){let n="",o="";for(let r in e)if(void 0===e[r])this.isAttribute(r)&&(o+="");else if(null===e[r])this.isAttribute(r)?o+="":"?"===r[0]?o+=this.indentate(t)+"<"+r+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+r+"/"+this.tagEndChar;else if(e[r]instanceof Date)o+=this.buildTextValNode(e[r],r,"",t);else if("object"!=typeof e[r]){const i=this.isAttribute(r);if(i)n+=this.buildAttrPairStr(i,""+e[r]);else if(r===this.options.textNodeName){let t=this.options.tagValueProcessor(r,""+e[r]);o+=this.replaceEntitiesValue(t)}else o+=this.buildTextValNode(e[r],r,"",t)}else if(Array.isArray(e[r])){const n=e[r].length;let i="";for(let a=0;a<n;a++){const n=e[r][a];void 0===n||(null===n?"?"===r[0]?o+=this.indentate(t)+"<"+r+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+r+"/"+this.tagEndChar:"object"==typeof n?this.options.oneListGroup?i+=this.j2x(n,t+1).val:i+=this.processTextOrObjNode(n,r,t):i+=this.buildTextValNode(n,r,"",t))}this.options.oneListGroup&&(i=this.buildObjectNode(i,r,"",t)),o+=i}else if(this.options.attributesGroupName&&r===this.options.attributesGroupName){const t=Object.keys(e[r]),o=t.length;for(let i=0;i<o;i++)n+=this.buildAttrPairStr(t[i],""+e[r][t[i]])}else o+=this.processTextOrObjNode(e[r],r,t);return{attrStr:n,val:o}},i.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'},i.prototype.buildObjectNode=function(e,t,n,o){if(""===e)return"?"===t[0]?this.indentate(o)+"<"+t+n+"?"+this.tagEndChar:this.indentate(o)+"<"+t+n+this.closeTag(t)+this.tagEndChar;{let r="</"+t+this.tagEndChar,i="";return"?"===t[0]&&(i="?",r=""),!n&&""!==n||-1!==e.indexOf("<")?!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===i.length?this.indentate(o)+`\x3c!--${e}--\x3e`+this.newLine:this.indentate(o)+"<"+t+n+i+this.tagEndChar+e+this.indentate(o)+r:this.indentate(o)+"<"+t+n+i+">"+e+r}},i.prototype.closeTag=function(e){let t="";return-1!==this.options.unpairedTags.indexOf(e)?this.options.suppressUnpairedNode||(t="/"):t=this.options.suppressEmptyNode?"/":"></"+e,t},i.prototype.buildTextValNode=function(e,t,n,o){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(o)+`<![CDATA[${e}]]>`+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(o)+`\x3c!--${e}--\x3e`+this.newLine;if("?"===t[0])return this.indentate(o)+"<"+t+n+"?"+this.tagEndChar;{let r=this.options.tagValueProcessor(t,e);return r=this.replaceEntitiesValue(r),""===r?this.indentate(o)+"<"+t+n+this.closeTag(t)+this.tagEndChar:this.indentate(o)+"<"+t+n+">"+r+"</"+t+this.tagEndChar}},i.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const n=this.options.entities[t];e=e.replace(n.regex,n.val)}return e},e.exports=i},2504:function(e,t){function n(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const n=t[e];if(":@"!==n)return n}}function o(e,t){let n="";if(e&&!t.ignoreAttributes)for(let o in e){let r=t.attributeValueProcessor(o,e[o]);r=i(r,t),!0===r&&t.suppressBooleanAttributes?n+=" "+o.substr(t.attributeNamePrefix.length):n+=` ${o.substr(t.attributeNamePrefix.length)}="${r}"`}return n}function r(e,t){let n=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let o in t.stopNodes)if(t.stopNodes[o]===e||t.stopNodes[o]==="*."+n)return!0;return!1}function i(e,t){if(e&&e.length>0&&t.processEntities)for(let n=0;n<t.entities.length;n++){const o=t.entities[n];e=e.replace(o.regex,o.val)}return e}e.exports=function(e,t){let a="";return t.format&&t.indentBy.length>0&&(a="\n"),function e(t,a,s,l){let c="",u=!1;for(let d=0;d<t.length;d++){const p=t[d],h=n(p);let g="";if(g=0===s.length?h:`${s}.${h}`,h===a.textNodeName){let e=p[h];r(g,a)||(e=a.tagValueProcessor(h,e),e=i(e,a)),u&&(c+=l),c+=e,u=!1;continue}if(h===a.cdataPropName){u&&(c+=l),c+=`<![CDATA[${p[h][0][a.textNodeName]}]]>`,u=!1;continue}if(h===a.commentPropName){c+=l+`\x3c!--${p[h][0][a.textNodeName]}--\x3e`,u=!0;continue}if("?"===h[0]){const e=o(p[":@"],a),t="?xml"===h?"":l;let n=p[h][0][a.textNodeName];n=0!==n.length?" "+n:"",c+=t+`<${h}${n}${e}?>`,u=!0;continue}let m=l;""!==m&&(m+=a.indentBy);const f=o(p[":@"],a),b=l+`<${h}${f}`,v=e(p[h],a,g,m);-1!==a.unpairedTags.indexOf(h)?a.suppressUnpairedNode?c+=b+">":c+=b+"/>":v&&0!==v.length||!a.suppressEmptyNode?v&&v.endsWith(">")?c+=b+`>${v}${l}</${h}>`:(c+=b+">",v&&""!==l&&(v.includes("/>")||v.includes("</"))?c+=l+a.indentBy+v+l:c+=v,c+=`</${h}>`):c+=b+"/>",u=!0}return c}(e,t,"",a)}},2505:function(e,t){e.exports={ReadAloud_20:"ReadAloud_20",Play_20:"Play_20",CancelGlyph_20:"CancelGlyph_20",MicrophoneGlyph_24:"MicrophoneGlyph_24",MicrophonePaused_24:"MicrophonePaused_24",LeftChevronMedium_20:"LeftChevronMedium_20",ellipsis_20:"ellipsis_20",Pause_20:"Pause_20",Gear_24:"Gear_24",MicrophoneGlyphRed_24:"MicrophoneGlyphRed_24",OfficeAssistant_24:"OfficeAssistant_24",LanguageCommandsFlyoutAnchor_20:"LanguageCommandsFlyoutAnchor_20",PersonSpeakingSettings_24:"PersonSpeakingSettings_24",Info_20:"Info_20",FirstRecord_20:"FirstRecord_20",LastRecord_20:"LastRecord_20",VoicedictationGray_24:"VoicedictationGray_24",VolumePillGray:"VolumePillGray",VolumePillBlue:"VolumePillBlue",Voicedictation_24:"Voicedictation_24",VoiceDictation_Recording_20:"VoiceDictation_Recording_20",GearWithoutOfficeIconColorsM22_24:"GearWithoutOfficeIconColorsM22_24"}},2671:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var o=n(2),r=n(131),i=n(743),a=n(48),s=n(158),l=n(2404),c=n(204),u=Object(s.a)((function(e,t,n,o,r){return{type:"MultiRowFloatieGroup",id:e,topControlsRow:t.topControlsRow.map((function(e){return Object(i.c)(n,o,e,r,void 0,void 0,c.b.Floatie)})),bottomControlsRow:t.bottomControlsRow.map((function(e){return Object(i.c)(n,o,e,r,void 0,void 0,c.b.Floatie)}))}})),d=Object(s.a)((function(e,t,n,r,s){return{type:"SingleRowFloatieGroup",id:e,controls:t.controls.map((function(e){var t=Object(i.c)(n,r,e,s,void 0,void 0,c.b.Floatie),l=Object(a.v)(n,r,e);switch(l.type){case"ButtonModel":case"ToggleButtonModel":case"FlyoutAnchorModel":case"SplitButtonModel":case"StatefulSplitButtonModel":return Object(o.__assign)(Object(o.__assign)({},t),{icon:l.iconSet&&l.iconSet.icon24||l.iconSet&&l.iconSet.default});case"PreviewGalleryModel":return Object(o.__assign)(Object(o.__assign)({},t),{flyoutAnchorProps:{icon:l.flyoutAnchorIconSet&&l.flyoutAnchorIconSet.icon24||l.flyoutAnchorIconSet&&l.flyoutAnchorIconSet.default,label:l.flyoutAnchorLabel}})}return t})),preventAutoDismiss:t.preventAutoDismiss}})),p=Object(s.a)((function(e,t,n,o,r){return{type:"SingleControlFloatieGroup",id:e,control:h(n,o,t.control,r),preventAutoDismiss:t.preventAutoDismiss}})),h=function(e,t,n,r){var s=Object(i.c)(e,t,n,r,void 0,void 0,c.b.Floatie),l=Object(a.v)(e,t,n);switch(l.type){case"FlyoutAnchorModel":return Object(o.__assign)(Object(o.__assign)({},s),{icon:l.iconSet&&l.iconSet.icon16||l.iconSet&&l.iconSet.default})}return s},g=function(e){return Object(r.a)([l.a,l.b,a.U,a.u,a.bb],(function(t,n,o,r,i){var a=[];return(null!=e?e:t).map((function(e){var t=n[e];if(void 0!==t)switch(t.type){case"MultiRowFloatieGroupModel":a.push(u(e,t,o,r,i));break;case"SingleRowFloatieGroupModel":a.push(d(e,t,o,r,i));break;case"SingleControlFloatieGroupModel":a.push(p(e,t,o,r,i));break;default:throw new Error("The floatie group type can't be placed in the floatie")}})),a}))}},2672:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var o=n(2),r=n(0),i=n(1966),a=n(2387),s=n(2388),l=n(2381),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(i.a,Object(o.__assign)({},this.props,{id:Object(l.a)(this.props.id),useLegacyButton:!0,hideLabel:!0,styles:Object(a.b)(this.props.styles),variant:"floatieButton",dataAutomationType:"FloatieButton",keytipProps:void 0}))},t}(r.PureComponent),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(i.a,Object(o.__assign)({},this.props,{id:Object(l.a)(this.props.id),useLegacyButton:!0,styles:a.a,variant:"floatieLargeButton",dataAutomationType:"FloatieLargeButton",onRenderText:Object(s.a)(this.props.label),keytipProps:void 0}))},t}(r.PureComponent)},2673:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var o=n(2),r=n(0),i=n(1974),a=n(2387),s=n(2388),l=n(2381),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(i.a,Object(o.__assign)({},this.props,{id:Object(l.a)(this.props.id),useLegacyButton:!0,hideLabel:!0,styles:Object(a.b)(this.props.styles),variant:"floatieButton",dataAutomationType:"FloatieToggleButton",keytipProps:void 0}))},t}(r.PureComponent),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(i.a,Object(o.__assign)({},this.props,{id:Object(l.a)(this.props.id),useLegacyButton:!0,styles:a.a,variant:"floatieLargeButton",dataAutomationType:"FloatieLargeToggleButton",onRenderText:Object(s.a)(this.props.hideLabel?void 0:this.props.label),keytipProps:void 0}))},t}(r.PureComponent)},2674:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return x}));var o=n(2),r=n(0),i=n(13),a=n(4),s=n(170),l=n(96),c=n(234),u=n(654),d=n(269),p=n(112),h=n(1963),g=n(460),m=n(2387),f=n(2388),b=n(2381),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(h.a,Object(o.__assign)({},this.props,{id:Object(b.a)(this.props.id),useLegacyButton:!0,directionalHintFixed:!1,hideLabel:!0,variant:"floatieMenuButton",styles:Object(m.b)(this.props.styles),dataAutomationType:"FloatieFlyoutAnchor",keytipProps:void 0}))},t}(r.PureComponent),y=Object(i.c)((function(e,t,n){var o={root:{height:g.a.floatieLargeControlHeight,padding:"2px 2px 0px 2px"},flexContainer:{flexDirection:"column"},label:{margin:0,textAlign:"center"}},r={height:g.a.floatieSingleRowFlyoutAnchorDefaultLabelHeight,padding:"2px 2px 0px 2px",whiteSpace:"nowrap"},i={height:g.a.floatieSingleRowFlyoutAnchorLabelHeight,padding:"2px 2px 0px 2px"};return o.textContainer=n?r:i,Object(a.I)(e,o,t)})),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderIcon=function(e){return function(){var n,i=t.props,l=i.icon,d=i.iconColor,p=i.styles,h=i.disabled,g=null!=l?l:{display:"none"},m=null==p?void 0:p.icon,f=null==p?void 0:p.menuIcon,b=null===(n=t.props.hideChevron)||void 0===n||n;return r.createElement("div",{className:Object(a.eb)(C)},r.createElement(s.a,Object(o.__assign)({},Object(c.a)(l,d,void 0,void 0,h),{className:Object(a.eb)(E,g,m)})),b&&r.createElement(s.a,Object(o.__assign)({iconName:"ChevronDown"},Object(c.a)(Object(u.a)(t.props),void 0,void 0,void 0,h),{className:Object(a.eb)(S(e),f)})))}},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=this,n=null===(e=this.props.hideChevron)||void 0===e||e;return r.createElement(d.a,null,(function(e){return r.createElement(h.a,Object(o.__assign)({},t.props,{id:Object(b.a)(t.props.id),styles:y(m.a,t.props.styles,t.props.isDefaultLabelRendering),dataAutomationType:"FloatieSingleRowFlyoutAnchor",directionalHintFixed:!1,useLegacyButton:!0,onRenderText:t.props.isDefaultLabelRendering?void 0:Object(f.a)(t.props.hideLabel?void 0:t.props.label),onRenderIcon:t._onRenderIcon(e),hideChevron:n,keytipProps:void 0}))}))},t}(r.PureComponent),C={display:"flex",alignItems:"center"},S=function(e){return{height:12,lineHeight:12,width:12,fill:Object(p.c)()?Object(l.a)(e).textColor:"#444444",padding:"6px 0px"}},E={width:g.a.floatieLargeIconSize,height:g.a.floatieLargeIconSize,padding:2,lineHeight:20,margin:0}},2675:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var o=n(2),r=n(0),i=n(4),a=n(13),s=n(415),l=n(2246),c=n(460),u=n(2381),d=Object(a.c)((function(e,t){return Object(i.db)({container:[{height:c.a.floatieRowHeight,display:"inline-flex"},Object(s.b)(0,e)],root:{paddingRight:c.a.menuButtonWidth,height:28}},t)})),p=Object(a.c)((function(e){return Object(i.db)({root:{width:c.a.menuButtonWidth,height:28}},e)})),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(l.a,Object(o.__assign)({},this.props,{id:Object(u.a)(this.props.id),dataAutomationType:"FloatieComboBox",styles:d(this.props.pinToPreviousComboBox,this.props.styles),caretDownButtonStyles:p(this.props.caretDownButtonStyles),keytipProps:void 0,shadowRenderMenu:!1,directionalHintDynamic:!0,preventCalloutDismissOnScroll:!0}))},t}(r.PureComponent)},2676:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(2),r=n(0);var i=void 0;function a(){var e;return void 0===i&&(i=!("undefined"==typeof window||((null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||[]).indexOf("element")<0)&&"elementTiming"in new Image),i}var s=function(e){function t(t){return e.call(this,t)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.elementTimingId,n=e.hidden,o=void 0!==n&&n,i=e.interactivityTrackerContext;return!o&&Boolean(t)&&a()?r.createElement("p",{elementtiming:t,"data-ui-mutation-time":performance.now(),"data-ui-mutation-context-value":null!=i?i:"",style:{position:"fixed",top:0,left:0,color:"transparent",fontSize:"1px",userSelect:"none",overflow:"hidden",zIndex:-1,"pointer-events":"none"}},"."):null},t}(r.PureComponent)},2678:function(e,t,n){"use strict";n.r(t);var o=n(2425);n.d(t,"TeachingCallout",(function(){return o.a}));var r=n(2421);n.d(t,"OfficeStandardCallout",(function(){return r.a}));var i=n(2017);n.d(t,"Notification",(function(){return i.a}));var a=n(2476);n.d(t,"ToastNotification",(function(){return a.a}));var s=n(2030);n.d(t,"StandardCallout",(function(){return s.a}))},2687:function(e,t,n){"use strict";n.r(t),n.d(t,"notifications",(function(){return E})),n.d(t,"taskPane",(function(){return NC})),n.d(t,"contextualUI",(function(){return bI})),n.d(t,"dialog",(function(){return BO})),n.d(t,"messageBar",(function(){return LI})),n.d(t,"statusBar",(function(){return dD})),n.d(t,"renderDatePicker",(function(){return SD})),n.d(t,"hideDatePicker",(function(){return ED})),n.d(t,"renderTableTotalRowOptions",(function(){return qI})),n.d(t,"renderSheetDropdownMenu",(function(){return YI})),n.d(t,"renderTextToColumnsContextualUI",(function(){return dw})),n.d(t,"renderFormulaSuggestionCard",(function(){return bw})),n.d(t,"renderX10PlaygroundCard",(function(){return Cw})),n.d(t,"renderProactiveSuggestionCard",(function(){return Fw})),n.d(t,"renderProactiveSuggestionDebugPane",(function(){return Nw})),n.d(t,"renderExcelIntelligenceSuggestionCard",(function(){return Ow})),n.d(t,"renderNameBoxStatusCallout",(function(){return ID})),n.d(t,"showRenameFileCallout",(function(){return RD})),n.d(t,"isRenameCalloutVisible",(function(){return DD})),n.d(t,"ocvFeedbackModal",(function(){return hD})),n.d(t,"liveMeeting",(function(){return NI}));var o,r=n(1509);!function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Spinner=4]="Spinner",e[e.Custom=5]="Custom"}(o||(o={}));var i=n(67),a=n(70),s=n(181),l=n(25),c=n.n(l),u=n(46),d=n.n(u),p=n(59),h=n.n(p),g=n(200),m=n.n(g),f=n(114),b=n(457),v=!1;function y(){v||(Object(r.d)({appColors:Object(f.a)(),appStrings:Object(b.a)(),icons:{closeDark:c.a.CancelGlyph_16,closeLight:c.a.CancelGlyphWhite_16,jumpToTargetDark:c.a.AccessMoveUpSection_16,jumpToTargetLight:c.a.AccessMoveUpSectionWhite_16,checkmark:c.a.Checkmark_16}}),v=!0)}function x(e){if(e)switch(e.icon){case o.Error:return m.a.CancelRequest_16;case o.Warning:return m.a.Risks_16;case o.Info:return m.a.Info_16;case o.Custom:var t=function(e){var t=e.customIconName||e.iconPath;return t&&(C(d.a,t)||C(h.a,t))}(e);if(!t){var n=e.customIconName||e.iconPath,r=n?"Icon ".concat(n," not found in excel icons"):"No value specified for customIconName";i.a.sendTraceTag(523801940,a.a.msoulscat_Wac_Ribbon,s.a.Warning,r)}return t;case o.Spinner:return m.a.MissingIcon_20;case o.None:default:return}}function C(e,t){return e[t]}var S,E={initializeCalloutNotifications:function(e){y(),Object(r.e)(e)},initializeToastNotifications:function(e){y(),Object(r.f)(e)},isCustomContentSupported:r.g,addNotification:r.a,removeNotification:r.h,updateNotification:r.i,externalNotification:r.c,toast:function(e){return{type:"ToastProps",message:e.message,icon:x(e.icon),styles:{message:{fontSize:"14px",fontWeight:"bold"}}}},callout:r.b},k=n(2),O=n(0),T=n(45),I=n(1161),w=n(1103),_=n(2e3),P=n(1128),R=n(2352),D=n(1435),j=n(746),B={shimmerGradient:{animationDirection:"reverse"}},F=n(132),L=n(294),M=function(){function e(){}return e.updateData=function(t){var n,o,r,s;t.callbacks?(i.a.shipAssertTag(595711942,a.a.msoulscat_ES_EWAJS,null!=t.callbacks.onRuleFilteringOptionsChange,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleFilteringOptionsChange not set"),i.a.shipAssertTag(595357775,a.a.msoulscat_ES_EWAJS,null!=t.callbacks.onRuleDelete,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleDelete not set"),i.a.shipAssertTag(538027297,a.a.msoulscat_ES_EWAJS,null!=t.callbacks.onRuleDuplicate,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleDuplicate not set"),i.a.shipAssertTag(573850571,a.a.msoulscat_ES_EWAJS,null!=t.callbacks.getFormulaErrorType,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: getFormulaErrorType not set")):i.a.shipAssertTag(595402902,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: callbacks object is not set"),e.firstPaneElementId=(null===(n=t.UIElementsIds)||void 0===n?void 0:n.firstPaneElementId)||t.firstPaneElementId||"",e.ruleManagerId=(null===(o=t.UIElementsIds)||void 0===o?void 0:o.ruleManagerId)||"ConditionalFormattingTaskPaneRuleManagerId",e.loadingRuleListId=(null===(r=t.UIElementsIds)||void 0===r?void 0:r.loadingRuleListId)||"ConditionalFormattingTaskPaneLoadingRuleListId",e.ruleListId=(null===(s=t.UIElementsIds)||void 0===s?void 0:s.ruleListId)||"ConditionalFormattingTaskPaneRuleListId",e.colorPickerButtonController=t.colorPickerButtonController||{},e.borderMenuController=t.borderMenuController||void 0,e.onRuleFilteringOptionsChange=t.callbacks.onRuleFilteringOptionsChange||function(){},e.onRuleHoverStateChange=t.callbacks.onRuleHoverStateChange||function(){},e.onRuleDelete=t.callbacks.onRuleDelete||function(){},e.onRuleDuplicate=t.callbacks.onRuleDuplicate||function(){},e.setFocusOnToolbarFirstElement=t.callbacks.setFocusOnToolbarFirstElement||function(){},e.onTaskPaneViewChange=t.callbacks.changeTaskPaneView||function(){},e.onDeleteRulesByFilter=t.callbacks.onDeleteRulesByFilter||function(){},e.onRuleAdded=t.callbacks.onRuleAdded||function(){},e.onRuleEdited=t.callbacks.onRuleEdited||function(){},e.addNewRuleFromTaskPane=t.callbacks.addNewRuleFromTaskPane||function(){},e.getFormulaErrorType=t.callbacks.getFormulaErrorType||function(){return 1},e.getRangeError=t.callbacks.getRangeError||function(){return 2},e.rangePickerController=t.rangePickerController||{startPicker:function(){},stopPicker:function(){},disposeRangePicker:function(){},getGridDomElementId:function(){return""},getSheetName:function(){return""}}},e.setFocusOnPaneFirstElement=function(){if(e.firstPaneElementId){var t=document.getElementById(e.firstPaneElementId);t&&t.focus()}},e.getRequiredFirstPaneElementId=function(){return e.firstPaneElementId},e.getRequiredRuleManagerId=function(){return e.ruleManagerId},e.getRequiredLoadingRuleListId=function(){return e.loadingRuleListId},e.getRequiredRuleListId=function(){return e.ruleListId},e.isRuleReorderWithDnDSupported=function(){return!Object(L.e)()},e.getColorPickerButtonController=function(){return e.colorPickerButtonController},e.getBorderMenuController=function(){return e.borderMenuController},e}(),A=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){if(this.props.isPlaceholder){var e=Object(k.__assign)({},Me);return Object(F.a)()&&(e=Object(k.__assign)(Object(k.__assign)({},e),{rtlShimmerStyles:B})),O.createElement(j.a,{style:{marginTop:"7px"},styles:e})}return i.a.shipAssertTag(595357774,a.a.msoulscat_ES_EWAJS,null!=this.props.ruleName&&""!==this.props.ruleName,"ConditionalFormattingTaskPaneReact.RulePreview.Render: rule name is empty."),O.createElement(D.a,{value:this.props.ruleName,styles:Me,borderless:!0,readOnly:!0,tabIndex:-1,"data-is-focusable":!1,ariaLabel:this.props.ruleName,style:{cursor:M.isRuleReorderWithDnDSupported()?"grab":"default"}})},t}(O.Component),N=n(26),W=n.n(N),H=n(170),z=n(49),V=n(4),G=function(){return q(!0)},U=function(e){return e?"rgb(96, 94, 92)":"rgb(184, 0, 0)"},q=function(e){return{borderColor:U(e),borderStyle:"solid"}},Q=function(e){var t={root:{height:"26px"}};return{contentRoot:Object(k.__assign)(Object(k.__assign)({},q(e)),{maxWidth:"287px"}),pickingIcon:t,cancelButton:t,applyButton:t}},K=function(e,t){var n;return void 0===e&&(e=!0),void 0===t&&(t=!1),(n={outline:"none !important",borderWidth:(t?"2px":"1px")+" !important",borderColor:U(e)+" !important",borderStyle:"solid"})[V.m]={outline:"highlighttext dashed 2px !important",outlineOffset:"-2px",color:"highlight",borderColor:"highlight !important"},n},J={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Z=n(1490),Y=n(84);function X(e){return"CondFmtEditRuleIconId-".concat(e)}function $(e){return"CondFmtDeleteRuleIconId-".concat(e)}function ee(e){return"CondFmtDuplicateRuleIconId-".concat(e)}!function(e){e[e.Edit=0]="Edit",e[e.Duplicate=1]="Duplicate",e[e.Delete=2]="Delete"}(S||(S={}));var te=function(e){function t(t){var n=e.call(this,t)||this;return n.editRuleOnKeyDown=n.editRuleOnKeyDown.bind(n),n.duplicateRuleOnKeyDown=n.duplicateRuleOnKeyDown.bind(n),n.deleteRuleOnKeyDown=n.deleteRuleOnKeyDown.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return this.props.showCommands?O.createElement("div",null,O.createElement(Z.a,{content:this.props.enableEdit?ExcelRibbonStrings.ConditionalFormattingRuleEdit:ExcelRibbonStrings.ConditionalFormattingEditingRuleNotSupportedTooltipContent,directionalHint:Y.a.bottomCenter},O.createElement(H.a,{id:X(this.props.ruleId),role:"button",iconName:W.a.EditGeneric_24,styles:this.getCommandIconStyle(this.props.enableEdit),onClick:this.props.enableEdit?this.props.editRule:void 0,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.editRuleOnKeyDown,"aria-label":this.props.enableEdit?ExcelRibbonStrings.ConditionalFormattingRuleEdit:void 0})),this.getDuplicateRuleButton(),O.createElement(Z.a,{content:ExcelRibbonStrings.ConditionalFormattingRuleDelete,directionalHint:Y.a.bottomCenter},O.createElement(H.a,{id:$(this.props.ruleId),role:"button",iconName:W.a.TrashCan_16,styles:this.getCommandIconStyle(),onClick:this.props.onRuleDelete,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.deleteRuleOnKeyDown,"aria-label":ExcelRibbonStrings.ConditionalFormattingRuleDelete}))):O.createElement("div",null)},t.prototype.getDuplicateRuleButton=function(){return O.createElement(Z.a,{content:ExcelRibbonStrings.ConditionalFormattingRuleDuplicate,directionalHint:Y.a.bottomCenter},O.createElement(H.a,{id:ee(this.props.ruleId),role:"button",iconName:W.a.Duplicate_24,styles:this.getCommandIconStyle(),onClick:this.props.onRuleDuplicate,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.duplicateRuleOnKeyDown,"aria-label":ExcelRibbonStrings.ConditionalFormattingRuleDuplicate}))},t.prototype.editRuleOnKeyDown=function(e){this.ruleCommandOnKeyDown(e,S.Edit)},t.prototype.deleteRuleOnKeyDown=function(e){this.ruleCommandOnKeyDown(e,S.Delete)},t.prototype.duplicateRuleOnKeyDown=function(e){this.ruleCommandOnKeyDown(e,S.Duplicate)},t.prototype.ruleCommandOnKeyDown=function(e,t){var n=null;switch(e.keyCode){case z.a.tab:n=this.getNextOrPreviousFocusElementFromCommand(e,t);break;case z.a.escape:n=document.getElementById(this.props.ruleId);break;case z.a.enter:switch(t){case S.Edit:this.props.editRule(),e.preventDefault();break;case S.Duplicate:this.props.onRuleDuplicate(),e.stopPropagation();break;case S.Delete:this.props.onRuleDelete(),e.stopPropagation()}}n&&(e.stopPropagation(),e.preventDefault(),n.focus())},t.prototype.getNextOrPreviousFocusElementFromCommand=function(e,t){var n=null;switch(t){case S.Edit:if(e.shiftKey){n=document.getElementById(this.props.ruleRangeId);break}n=document.getElementById(ee(this.props.ruleId));break;case S.Delete:if(!e.shiftKey){n=document.getElementById(this.props.ruleRangeId);break}n=document.getElementById(ee(this.props.ruleId));break;case S.Duplicate:if(e.shiftKey){if(this.props.enableEdit){n=document.getElementById(X(this.props.ruleId));break}n=document.getElementById(this.props.ruleRangeId);break}n=document.getElementById($(this.props.ruleId))}return n},t.prototype.getCommandIconStyle=function(e){var t;return void 0===e&&(e=!0),{root:{height:"16px",width:"16px",marginTop:"2px",marginLeft:"1px",padding:"3px",opacity:e?void 0:"0.3",pointerEvents:e?void 0:"none",cursor:e?"pointer":"default",selectors:{":hover":(t={background:"#E1DFDD"},t[V.m]=e?K():{color:"GrayText"},t),":focus":K(),":focus:after":{border:"none",outline:"none"},":active":{border:"none",outline:"none"}}}}},t}(O.Component),ne=n(1221),oe=function(e){return"".concat(e,"-ErrorTooltip")},re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tooltipStyle={calloutProps:{backgroundColor:"rgb(184, 0, 0)",styles:{beakCurtain:{backgroundColor:"rgb(184, 0, 0)"}}},styles:{content:{color:"white"}}},t.getErrorMessage=function(){return t.props.errorMessage||void 0},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Z.a,{id:oe(this.props.childComponentId),content:this.getErrorMessage(),tooltipProps:this.tooltipStyle,setAriaDescribedBy:!1,role:"alert"},this.props.children)},t}(O.Component),ie=function(e){function t(t){var n=e.call(this,t)||this;return n.getRangePickerProps=function(){var e=Object(k.__assign)({rangePickerController:M.rangePickerController},n.props);return void 0!==e.editingStyles?(e.editingStyles=Object(k.__assign)({},e.editingStyles),e.editingStyles.contentRoot=Object(V.I)(n.getPickingStyle(),e.editingStyles.contentRoot)):e.editingStyles={contentRoot:n.getPickingStyle()},e},n.getPickingStyle=function(){return K(!n.props.error,!0)},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",null,O.createElement("div",{role:"alert","aria-label":this.props.error}),O.createElement(re,{errorMessage:this.props.error,childComponentId:this.props.id},O.createElement(ne.a,Object(k.__assign)({},this.getRangePickerProps(),{disableApplyChanges:!!this.props.error&&this.props.disableApplyingChangesOnError}))))},t}(O.Component),ae=function(){function e(e){this.wasModified=!1,this.data=e,this.originalData=Object(k.__assign)({},e)}return Object.defineProperty(e.prototype,"rangeString",{get:function(){return this.data.rangeString},set:function(e){this.data.rangeString=e,this.wasModified=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheetName",{get:function(){return this.data.sheetName},set:function(e){this.data.sheetName=e,this.wasModified=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeCell",{get:function(){return this.data.activeCell},set:function(e){this.data.activeCell=e,this.wasModified=!0},enumerable:!1,configurable:!0}),e.prototype.update=function(e){"rangeString"in e&&(this.rangeString=e.rangeString),"sheetName"in e&&(this.sheetName=e.sheetName),"activeCell"in e&&(this.activeCell=e.activeCell)},Object.defineProperty(e.prototype,"initialData",{get:function(){return Object(k.__assign)({},this.originalData)},enumerable:!1,configurable:!0}),e.prototype.isDirty=function(){return this.wasModified},e.prototype.getErrorType=function(e,t){var n=M.getRangeError(this.rangeString,this.sheetName);return 0!==n?n:this.rangeString&&this.rangeString.length>1e3?3:e||null==this.sheetName||this.sheetName===this.originalData.sheetName?this.sheetName&&t.length>0&&t.indexOf(this.sheetName)>=0?5:0:4},e.prototype.getErrorMessage=function(e,t){switch(this.getErrorType(e,t)){case 1:case 2:return ExcelRibbonStrings.ConditionalFormattingInvalidRangeError;case 3:return ExcelRibbonStrings.ConditionalFormattingValueTooLongError.replace("{0}",1e3.toString());case 4:return ExcelRibbonStrings.ConditionalFormattingChangeRangeSheetNameError;case 5:return ExcelRibbonStrings.ConditionalFormattingSheetDeletedError;case 6:return ExcelRibbonStrings.ConditionalFormattingProtecedSheetRangePickerErrorMessage;default:return null}},e.prototype.isValid=function(e,t){return 0===this.getErrorType(e,t)},e.prototype.onSheetRename=function(e){var t,n;this.sheetName===e.oldSheetName&&(this.sheetName=null!==(t=e.newSheetName)&&void 0!==t?t:this.sheetName),this.initialData.sheetName===e.oldSheetName&&(this.originalData.sheetName=null!==(n=e.newSheetName)&&void 0!==n?n:this.originalData.sheetName)},e}();function se(e){return"ConditionalFormattingRuleRange.".concat(e)}var le,ce,ue=function(e){function t(t){var n=e.call(this,t)||this;return n.mouseOver=function(){n.setState({hovering:!0})},n.mouseOut=function(){n.setState({hovering:!1})},n.onStartPicking=function(){n.setState({picking:!0,rangeData:new ae({rangeString:n.props.range,sheetName:n.props.sheetName||void 0})})},n.onChange=function(e,t){var o;n.state.rangeData.update({rangeString:e||"",sheetName:t||void 0}),n.setState({rangeData:n.state.rangeData}),n.props.updatePickerState(!0,!!(null===(o=n.state.rangeData)||void 0===o?void 0:o.getErrorMessage(!1,[])),e,t)},n.onStopPicking=function(e,t){n.setState({rangeData:void 0,picking:!1,hovering:!1}),n.props.updatePickerState(!1,!1,e,t)},n.onApplyChanges=function(e,t){n.onStopPicking(e,t)},n.onCancelChanges=function(e,t){n.onStopPicking(e,t)},n.state={hovering:!1,picking:!1},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e;if(this.props.isPlaceholder){var t=Object(k.__assign)({},Me);return Object(F.a)()&&(t=Object(k.__assign)(Object(k.__assign)({},t),{rtlShimmerStyles:B})),O.createElement(j.a,{style:{marginTop:"7px"},styles:t})}i.a.shipAssertTag(595357773,a.a.msoulscat_ES_EWAJS,null!=this.props.range&&""!==this.props.range,"ConditionalFormattingTaskPaneReact.RulePreview.Render: rule range is empty.");var n=null===(e=this.state.rangeData)||void 0===e?void 0:e.getErrorMessage(!1,[]);return O.createElement("div",{onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut},O.createElement(ie,{id:se(this.props.ruleId),value:this.props.range,sheetName:this.props.sheetName||void 0,onStartPicking:this.onStartPicking,onCancelChanges:this.onCancelChanges,onApplyChanges:this.onApplyChanges,onChange:this.onChange,supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!0,error:n||void 0,disableApplyingChangesOnError:!0,styles:{contentRoot:{width:"180px",border:this.state.hovering||this.state.picking?void 0:"none"},textField:{field:{padding:"2px"}},pickingIcon:this.state.hovering||this.state.picking?{}:{root:{visibility:"hidden"}}},editingStyles:{contentRoot:{width:"100%"},textField:{field:{padding:"2px"}}}}))},t}(O.Component),de=n(795);function pe(e,t,n,o){if(t.length<=e||n.length<=e||0===t[e])return"none";var r=o+"px";switch(t[e]){case 3:case 9:case 11:r+=" dashed";break;case 7:case 4:r+=" dotted";break;default:r+=" solid"}return n[e]?r+=" "+n[e]:(r+=" ",r+="#000000"),r}function he(e){var t="";return(e.isTextUnderlined||e.isTextDoubleUnderlined)&&(t="underline "),e.isTextStrikethrough&&(t+="line-through"),t||"none"}!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right"}(le||(le={})),function(e){e[e.Bottom=1]="Bottom",e[e.Top=2]="Top",e[e.Left=4]="Left",e[e.Right=8]="Right",e[e.AllBorders=15]="AllBorders"}(ce||(ce={}));var ge=new Map;function me(){return{position:ce.AllBorders,lineStyle:[0,0,0,0],color:["#000000","#000000","#000000","#000000"],themeColor:[null,null,null,null]}}ge.set(0,"to right"),ge.set(180,"to left"),ge.set(90,"to bottom"),ge.set(270,"to top"),ge.set(45,"to right bottom"),ge.set(225,"to left top"),ge.set(135,"to left bottom"),ge.set(315,"to right top");var fe=function(e){function t(t){var n=e.call(this,t)||this;return n.previewBorderWidth=1,n.rulePreviewStyle={width:"72px",height:"16px",border:n.previewBorderWidth+"px solid #d2d0ce",borderRadius:"1px"},n}return Object(k.__extends)(t,e),t.prototype.render=function(){if(this.props.rule.isPlaceholder)return O.createElement(j.a,{style:Object(k.__assign)(Object(k.__assign)({},this.rulePreviewStyle),this.props.style),styles:Object(F.a)()?B:void 0});switch(this.props.rule.ruleType){case 3:return this.renderCustomFormatPreview();case 0:return this.renderColorScalePreview();case 1:return this.renderDataBarPreview();case 2:return this.renderIconSetPreview();default:return i.a.shipAssertTag(595702673,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RulePreview.Render: unexpected rule type received."),O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)({},this.rulePreviewStyle),this.props.style)})}},t.prototype.renderCustomFormatPreview=function(){return O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},this.rulePreviewStyle),this.getCustomFormatStyle()),this.props.style),"aria-hidden":"true"},ExcelRibbonStrings.ConditionalFormattingCustomStylePreviewSampleText)},t.prototype.renderColorScalePreview=function(){var e=this.props.rule.colorScaleFormat;i.a.shipAssertTag(595706326,a.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderColorScalePreview: colorScaleFormat not set"),i.a.shipAssertTag(595706327,a.a.msoulscat_ES_EWAJS,null!=e.minimumColor&&""!==e.minimumColor&&null!=e.maximumColor&&""!==e.maximumColor,"ConditionalFormattingTaskPaneReact.RulePreview.renderColorScalePreview: colorScaleFormat values not set correctly");var t={};return t=e.midpointColor?{background:"linear-gradient(to right, "+e.minimumColor+", "+e.midpointColor+", "+e.maximumColor+")"}:{background:"linear-gradient(to right, "+e.minimumColor+", "+e.maximumColor+")"},O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},this.rulePreviewStyle),t),this.props.style)})},t.prototype.renderIconSetPreview=function(){var e=this.props.rule.iconSetFormat;return i.a.shipAssertTag(595706328,a.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderIconSetPreview: IconSetFormat not set"),i.a.shipAssertTag(595706329,a.a.msoulscat_ES_EWAJS,null!=e.icons,"ConditionalFormattingTaskPaneReact.RulePreview.renderIconSetPreview: ruleIconSetFormat values not set correctly"),O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},this.rulePreviewStyle),{display:"flex",border:"none",flexBasis:"100%",justifyContent:"space-between",direction:"ltr"}),this.props.style)},de.a.getIconNamesArray(e.icons,e.isReverseIconsOrder).map((function(e,t){return O.createElement(H.a,{iconName:e,key:t,style:{height:"13px",width:"13px"}})})))},t.prototype.renderDataBarPreview=function(){var e=this.props.rule.dataBarFormat;i.a.shipAssertTag(595706330,a.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderDataBarPreview: dataBarFormat not set"),i.a.shipAssertTag(595706331,a.a.msoulscat_ES_EWAJS,null!=e.fillColor&&""!==e.fillColor,"ConditionalFormattingTaskPaneReact.RulePreview.renderDataBarPreview: dataBarFormat values not set correctly");var t={};t=e.isGradientFill?{backgroundImage:"linear-gradient(to "+(e.isLTRDirection?"right":"left")+", "+e.fillColor+" , white)"}:{backgroundColor:e.fillColor};var n={};return e.borderColor&&(n={border:"0.7px solid "+e.borderColor}),O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},this.rulePreviewStyle),{display:"flex",padding:"0.5px",flexDirection:e.isLTRDirection?"row":"row-reverse",direction:"ltr"}),this.props.style)},O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},t),{width:"80%"}),n)}))},t.prototype.getCustomFormatStyle=function(){var e;if(!this.props.rule.customFormat)return i.a.shipAssertTag(595706332,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RulePreview.getCustomFormatStyle: ruleCustomFormat not set"),{};var t,n=this.props.rule.customFormat,o={};n.borderFormat&&n.borderFormat.color&&n.borderFormat.lineStyle&&((t=n.borderFormat.lineStyle).length>=4&&(0!==t[le.Top]||0!==t[le.Bottom]||0!==t[le.Left]||0!==t[le.Right]))&&(o={border:null,borderTop:pe(le.Top,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth),borderBottom:pe(le.Bottom,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth),borderRight:pe(le.Right,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth),borderLeft:pe(le.Left,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth)});var r=null!==(e=function(e){if(!e||!e.gradientStops)return null;if(e.isLinearGradient){var t=e.gradientStops.join(",");return{background:"linear-gradient("+(n=e.degree,(ge.get(n)||"")+", ")+t+")"}}var n,o,r,i;return e.radialGradientPosition&&2===e.gradientStops.length?e.radialGradientPosition.isCenter?{background:"radial-gradient("+e.gradientStops[0]+", "+e.gradientStops[1]+" 70%)"}:{background:(o=e.radialGradientPosition,r=e.gradientStops[0]||"",i=e.gradientStops[1]||"","radial-gradient(farthest-side, "+r+" , "+i+(o.isBottom?") top ":") bottom ")+(o.isRight?"left":"right")+"/200% 200%")}:null}(n.gradientFill))&&void 0!==e?e:{backgroundColor:n.backgroundColor||"#FFFFFF"};return Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},r),{textAlign:"center",fontWeight:n.isTextBold?"bold":"normal",fontStyle:n.isTextItalic?"italic":"normal",color:n.textColor||"#000000",textDecorationLine:he(n),textDecorationStyle:n.isTextDoubleUnderlined?"double":"solid",fontSize:"12px"}),o)},t}(O.Component),be=n(605);function ve(e){var t=document.getElementById(Io);(null==t?void 0:t.firstChild)&&t.removeChild(t.firstChild);var n=document.createElement("div");n.setAttribute("role","status"),n.setAttribute("aria-label",e),n.setAttribute("aria-live","assertive"),null==t||t.appendChild(n)}var ye=function(e){function t(t){var n=e.call(this,t)||this;return n.onDeleteAllRulesSelected=n.onDeleteAllRulesSelected.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Z.a,{content:ExcelRibbonStrings.ConditionalFormattingDeleteAllRulesTooltip,directionalHint:Y.a.bottomCenter},O.createElement(be.a,{id:"CondFmtDeleteAllRulesButton","aria-label":ExcelRibbonStrings.ConditionalFormattingDeleteAllRulesTooltip,disabled:this.props.isDisabled,styles:pt(),iconProps:{iconName:W.a.TrashCan_16,style:{width:"16px",height:"16px"}},onClick:this.onDeleteAllRulesSelected}))},t.prototype.onDeleteAllRulesSelected=function(e){M.onDeleteRulesByFilter(),ve(ExcelRibbonStrings.ConditionalFormattingAllRulesDeleted),this.props.onDeleteAllRules()},t}(O.Component),xe=n(384),Ce=function(){function e(e,t,n,o,r,i,a,s){void 0===t&&(t=null),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=null),void 0===s&&(s=null),this.ruleInputData=e,this.stopIfTrue=o,this.guid=t,this.range=new ae(Object(k.__assign)({},n)),this.ruleFormat=r,this.dataBarFormat=i,this.colorScaleFormat=a,this.iconSetFormat=s}return e.prototype.getRuleInputData=function(){return this.ruleInputData},e.prototype.setRuleInputData=function(e){this.ruleInputData=e},e.prototype.getGuid=function(){return this.guid},e.prototype.setGuid=function(e){this.guid=e},e.prototype.getRange=function(){return this.range},e.prototype.updateRange=function(e){null==this.range?this.range=new ae(Object(k.__assign)({},e)):this.range.update(e)},e.prototype.getStopIfTrue=function(){return this.stopIfTrue},e.prototype.setStopIfTrue=function(e){this.stopIfTrue=e},e.prototype.getFormatInputData=function(){return this.ruleFormat},e.prototype.setFormatInputData=function(e){this.ruleFormat=e},e.prototype.isNewRule=function(){return null===this.getGuid()||void 0===this.getGuid()},e.prototype.canFocusOnRuleInput=function(){return this.getRuleInputData().canFocusOnRuleInput()},e.prototype.getDataBarFormat=function(){return this.dataBarFormat},e.prototype.getColorScaleFormat=function(){return this.colorScaleFormat},e.prototype.getIconSetFormat=function(){return this.iconSetFormat},e}(),Se="#FFC7CE",Ee="#9C0006",ke="#FFEB9C",Oe="#9C5700",Te="#C6EFCE",Ie="#006100",we=function(e){return{isTextBold:!1,isTextItalic:!1,isTextStrikethrough:!1,isTextUnderlined:!1,isTextDoubleUnderlined:!1,backgroundColor:e.backgroundColor?e.backgroundColor:null,textColor:e.textColor?e.textColor:null,borderFormat:e.borderColor?{position:ce.AllBorders,lineStyle:[1,1,1,1],color:[e.borderColor,e.borderColor,e.borderColor,e.borderColor],thickness:[1,1,1,1]}:{position:ce.AllBorders,lineStyle:[0,0,0,0],color:["#000000","#000000","#000000","#000000"],thickness:[0,0,0,0]}}},_e=[{key:0,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedFillRedText,customFormat:we({textColor:Ee,backgroundColor:Se})},{key:1,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatYellowFillYellowText,customFormat:we({textColor:Oe,backgroundColor:ke})},{key:2,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatGreenFillGreenText,customFormat:we({textColor:Ie,backgroundColor:Te})},{key:3,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedFill,customFormat:we({backgroundColor:Se})},{key:4,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedText,customFormat:we({textColor:Ee})},{key:5,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedBorder,customFormat:we({borderColor:Ee})}];function Pe(e,t){var n,o;if(e&&t){if(e.backgroundColor!==t.backgroundColor||e.textColor!==t.textColor||e.isTextBold!==t.isTextBold||e.isTextItalic!==t.isTextItalic||e.isTextStrikethrough!==t.isTextStrikethrough||e.isTextUnderlined!==t.isTextUnderlined||e.isTextDoubleUnderlined!==t.isTextDoubleUnderlined)return!1;if(e.borderFormat&&t.borderFormat){if(e.borderFormat.lineStyle&&t.borderFormat.lineStyle)for(var r=0;r<e.borderFormat.lineStyle.length;r+=1)if(e.borderFormat.lineStyle[r]!==t.borderFormat.lineStyle[r])return!1;if(e.borderFormat.color&&t.borderFormat.color)for(r=0;r<e.borderFormat.color.length;r+=1)if((null===(n=e.borderFormat.color[r])||void 0===n?void 0:n.toLowerCase())!==(null===(o=t.borderFormat.color[r])||void 0===o?void 0:o.toLowerCase()))return!1;if(e.borderFormat.thickness&&t.borderFormat.thickness)for(r=0;r<e.borderFormat.thickness.length;r+=1)if(e.borderFormat.thickness[r]!==t.borderFormat.thickness[r])return!1}else if(e.borderFormat&&!t.borderFormat||!e.borderFormat&&t.borderFormat)return!1;if(e.gradientFill)return!1}return!0}var Re=n(16),De=function(){function e(e,t){this.quickFormat=e,this.customFormat=t,this.hasCustomFormatChanges=!1}return e.prototype.getQuickFormat=function(){return this.quickFormat},e.prototype.setQuickFormat=function(e){if(Object(Re.h)("HighlightWhenNewPaneExperiment")&&6===e&&!this.hasCustomFormat()){var t=Object(k.__assign)({},this.getSelectedFormat());this.setCustomFormat(t)}this.quickFormat=e},e.prototype.getCustomFormat=function(){return this.customFormat},e.prototype.getSelectedFormat=function(){return this.isQuickFormat()?_e[this.quickFormat].customFormat:this.customFormat},e.prototype.setCustomFormat=function(e){this.customFormat=e,this.isQuickFormat()&&(this.customFormat.preserveBackgroundColor=!1,this.customFormat.preserveTextColor=!1),this.quickFormat=6,this.hasCustomFormatChanges=!0},e.prototype.hasChanges=function(){return this.isQuickFormat()||this.hasCustomFormatChanges},e.prototype.hasCustomFormat=function(){return null!=this.customFormat},e.prototype.isQuickFormat=function(){return-1!==this.quickFormat&&6!==this.quickFormat},e}();function je(e,t,n){var o,r,s;void 0===n&&(n=null);var l=null,c={rangeString:null!==(o=t.range)&&void 0!==o?o:void 0,sheetName:null!==(r=t.ruleRangeSheetName)&&void 0!==r?r:void 0,activeCell:null!==(s=t.activeCell)&&void 0!==s?s:void 0};if(t.addRuleType){var u=function(e){var t=Be.get(e);if(t)return t;throw new Error("Unsupported ruleType")}(t.addRuleType);if(l=e.createRuleInputData(u),n&&n.isNewRule()&&n.getRuleInputData()){var d=n.getRuleInputData().getRuleInputValue();return l.getInputType()===n.getRuleInputData().getInputType()&&d&&l.setRuleInputValue(d),new Ce(l,t.guid,c,n.getStopIfTrue(),n.getFormatInputData())}}else t.guid&&(t.options&&t.options.command?l=e.createRuleInputData(t.options.command,t.options,t.dataBarFormat):(t.dataBarFormat||t.colorScaleFormat||t.iconSetFormat)&&(l=e.createRuleInputData(0,t.options,t.dataBarFormat,t.colorScaleFormat,t.iconSetFormat)));l||(i.a.shipAssertTag(573687755,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingHelper.createRuleData: RuleInputData is null"),l=e.createDefaultRuleInputDataByRuleTypeOption(null));var p=new De(t.customFormat?6:0,t.customFormat||null);return new Ce(l,t.guid,c,!!t.stopIfTrue&&t.stopIfTrue,p,t.dataBarFormat||null,t.colorScaleFormat||null,t.iconSetFormat||null)}var Be=new Map;function Fe(e){return{guid:e.ruleId,ruleRangeSheetName:e.ruleRangeSheetName,options:{command:0,quickFormat:-1},stopIfTrue:e.stopIfTrue,priority:-1,newJSApiPriority:-1}}function Le(e){var t=e.customFormat||null;return t&&(t.preserveBackgroundColor=!0,t.preserveTextColor=!0,t.borderFormat||(t.borderFormat=me()),t.borderFormat.position=0),{guid:e.ruleId,addRuleType:null,range:e.ruleRange,ruleRangeSheetName:e.ruleRangeSheetName,options:e.editOptions,stopIfTrue:e.stopIfTrue,customFormat:t,dataBarFormat:e.dataBarFormat||null,colorScaleFormat:e.colorScaleFormat||null,iconSetFormat:e.iconSetFormat||null,newJSApiPriority:-1}}Be.set("HighlightCellsGT",1),Be.set("HighlightCellsLT",2),Be.set("HighlightCellsBetween",3),Be.set("HighlightCellsEQ",4),Be.set("HighlightCellsContains",5),Be.set("HighlightCellsDate",6),Be.set("HighlightCellsDupe",7),Be.set("HighlightCellsNoBlanks",65),Be.set("TopBottomTop10",8),Be.set("TopBottomBot10",10),Be.set("TopBottomTop10P",9),Be.set("TopBottomBot10P",11),Be.set("TopBottomAA",12),Be.set("TopBottomBA",13);var Me={root:{width:"170px",height:"28px"},field:{color:"#252423",fontSize:"12px",padding:"0px"}},Ae=function(e){return"CondFmtRule"+e},Ne=function(e){function t(t){var n,o=e.call(this,t)||this;return o.ruleCardStyle={root:{minWidth:"262px",minHeight:"58px",maxWidth:"262px",maxHeight:"58px",marginTop:"9px",marginBottom:"9px",padding:"8px 11px 8px 11px",borderRadius:"2px",boxShadow:"0px 1px 3px 0px #eaeaea",cursor:o.isCursorShouldBeGrab()?"grab":"default",selectors:{":hover":(n={borderColor:"#c8c8c8",borderStyle:"solid"},n[V.m]={borderColor:"Highlight"},n),":focus,:focus-within,:focus:after":K()}}},o.ruleCardLineStyle={display:"flex",height:"28px"},o.stopConditionalStyle={alignSelf:"center",height:"14px"},o.stopConditionalIconStyle={height:"12px",width:"12px",paddingRight:"3px"},o.shouldShowCommands=function(){var e=o.state.hovering||o.state.focused,t=o.props.rule.isPlaceholder||o.state.pickerState.isPicking;return e&&!t},o.mouseOver=function(){(o.state.pickerState.isPicking||o.props.onRuleHoverStateChanged(!0,o.props.rule))&&o.setState((function(e){return e.hovering?null:{hovering:!0,ownUpdate:!0}}))},o.mouseOut=function(){o.state.hovering&&o.props.onRuleHoverStateChanged(!1,o.props.rule)&&o.setState({hovering:!1,ownUpdate:!0})},o.onFocus=function(){o.setState((function(e){return e.focused?null:{focused:!0,ownUpdate:!0}}))},o.onBlur=function(){o.state.focused&&o.setState({focused:!1,ownUpdate:!0})},o.onRuleCommandsKeyDown=function(e){var t=null;e.keyCode===z.a.escape&&(t=document.getElementById(Ae(o.props.index))),t&&(e.preventDefault(),e.stopPropagation(),t.focus())},o.onRuleRangeKeyDown=function(e){var t,n,r=null;switch(e.keyCode){case z.a.tab:if(o.state.pickerState.isPicking){e.shiftKey?(null===(t=document.activeElement)||void 0===t?void 0:t.id)===o.getFirstPickerButtonElementId()&&(r=document.getElementById(o.getLastPickerButtonElementId())):(null===(n=document.activeElement)||void 0===n?void 0:n.id)===o.getLastPickerButtonElementId()&&(r=document.getElementById(o.getFirstPickerButtonElementId()));break}var i=Ae(o.props.index);if(r=document.getElementById(X(i)),e.shiftKey){r=document.getElementById($(i));break}if(!o.isRuleEditable()||!r){r=document.getElementById(ee(i));break}break;case z.a.escape:case z.a.enter:r=document.getElementById(Ae(o.props.index))}r&&(e.preventDefault(),e.stopPropagation(),r.focus())},o.getLastPickerButtonElementId=function(){return Object(xe.d)(se(o.props.rule.ruleId),o.state.pickerState.hasError?xe.c.cancelButton:xe.c.applyButton)},o.getFirstPickerButtonElementId=function(){return Object(xe.d)(se(o.props.rule.ruleId),xe.c.textField)},o.state={hasError:!1,hovering:!1,pickerState:{isPicking:!1,hasError:!1},focused:!1,ownUpdate:!0},o.onRuleDelete=o.onRuleDelete.bind(o),o.onRuleDuplicate=o.onRuleDuplicate.bind(o),o.updatePickerState=o.updatePickerState.bind(o),o.updatePickerStateDeprecated=o.updatePickerStateDeprecated.bind(o),o.editRule=o.editRule.bind(o),o.onKeyDown=o.onKeyDown.bind(o),o}return Object(k.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0,ownUpdate:!0}},t.getDerivedStateFromProps=function(e,t){return t.ownUpdate?{ownUpdate:!1}:{hasError:!1}},t.prototype.componentDidCatch=function(e,t){i.a.sendTraceTag(595706333,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingTaskPaneReact.Rule: Rule component failed to render: ".concat(e.toString()," , ").concat(t.componentStack))},t.prototype.componentWillUnmount=function(){this.mouseOut()},t.prototype.render=function(){return this.state.hasError?O.createElement("div",null):O.createElement(R.a,{tabIndex:0===this.props.index?0:-1,"data-is-focusable":!0,styles:this.ruleCardStyle,onMouseOver:this.mouseOver,onMouseLeave:this.mouseOut,onFocus:this.onFocus,onBlur:this.onBlur,id:Ae(this.props.index),onKeyDown:this.onKeyDown,"aria-label":this.prepareRuleLabel(),role:"listitem"},O.createElement("div",{style:Object(k.__assign)(Object(k.__assign)({},this.ruleCardLineStyle),{marginBottom:"4px"})},O.createElement("div",{style:this.stopConditionalStyle},!this.props.rule.isPlaceholder&&this.props.rule.stopIfTrue?O.createElement(Z.a,{content:ExcelRibbonStrings.ConditionalFormattingStopIfTrueText},O.createElement(H.a,{iconName:W.a.StopConditional_12,style:this.stopConditionalIconStyle})):null),O.createElement("div",{style:{flexGrow:2}},O.createElement(A,{ruleName:this.props.rule.ruleName,isPlaceholder:this.props.rule.isPlaceholder||!1})),O.createElement("div",{style:{marginTop:"8px"}},O.createElement(fe,{rule:this.props.rule})," ")),O.createElement("div",{style:this.ruleCardLineStyle,onKeyDown:this.onRuleCommandsKeyDown},O.createElement("div",{style:{flexGrow:2},onKeyDown:this.onRuleRangeKeyDown},O.createElement(ue,{ruleId:this.props.rule.ruleId,range:this.props.rule.ruleRange,sheetName:this.props.rule.ruleRangeSheetName,isPlaceholder:this.props.rule.isPlaceholder||!1,updatePickerState:this.updatePickerState})),O.createElement(te,{showCommands:this.shouldShowCommands(),enableEdit:this.isRuleEditable(),onRuleDelete:this.onRuleDelete,editRule:this.editRule,onRuleDuplicate:this.onRuleDuplicate,ruleId:Ae(this.props.index),ruleRangeId:se(this.props.rule.ruleId)})))},t.prototype.updatePickerState=function(e,t,n,o){var r=e!==this.state.pickerState.isPicking,l=r&&e,c=r&&!e,u=n!==this.props.rule.ruleRange;if(l||c){var d=Object(k.__assign)({},this.props.rule);c&&u&&(this.props.onRuleRangeChanged(this.props.rule,n,o),d.ruleRange=n,i.a.sendTraceTag(542914069,a.a.msoulscat_ES_EWAJS,s.a.Info,"Rule.onRuleRangeChanged: Conditional Formatting Rule range was modified via the Rule Manager")),this.state.hovering&&this.props.onRuleHoverStateChanged(!e,d)}this.setState({pickerState:{isPicking:e,hasError:t},ownUpdate:!0})},t.prototype.updatePickerStateDeprecated=function(e,t){this.setState({pickerState:{isPicking:e,hasError:t},ownUpdate:!0})},t.prototype.isRuleEditable=function(){return i.a.shipAssertTag(573933140,a.a.msoulscat_ES_EWAJS,this.props.rule.isPlaceholder||3===this.props.rule.ruleType||null!==this.props.rule.dataBarFormat||null!==this.props.rule.colorScaleFormat||null!==this.props.rule.iconSetFormat,"ConditionalFormattingTaskPaneReact.Rule.isRuleEditable: rule does not have custom format."),null!=this.props.rule.editOptions||3!==this.props.rule.ruleType},t.prototype.editRule=function(){this.isRuleEditable()&&this.props.editRule(this.props.rule)},t.prototype.prepareRuleLabel=function(){var e;if(this.props.rule.isPlaceholder)return ExcelRibbonStrings.ConditionalFormattingLoadingRule;var t=(this.props.rule.stopIfTrue?ExcelRibbonStrings.ConditionalFormattingRuleAppliesToRangeHasStopIfTrue:ExcelRibbonStrings.ConditionalFormattingRuleAppliesToRange).replace("{0}",this.props.rule.ruleName).replace("{1}",this.props.rule.ruleRange),n=3;return n+=this.isRuleEditable()?1:0,t=t.concat(null===(e=ExcelRibbonStrings.ConditionalFormattingRuleHasMultipleOptions)||void 0===e?void 0:e.replace("{0}",""+n)),this.isRuleEditable()||(t=t.concat(ExcelRibbonStrings.ConditionalFormattingEditingRuleNotSupportedTooltipContent)),t=t.concat(ExcelRibbonStrings.ConditionalFormattingCanReorderRules)},t.prototype.onRuleDelete=function(){var e=this;ve(ExcelRibbonStrings.ConditionalFormattingRuleDeleted),this.props.rule.isPlaceholder?i.a.shipAssertTag(593826331,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.Rule.onRuleDelete: rule is a place holder."):(this.props.onRuleHoverStateChanged(!1,this.props.rule),setTimeout((function(){e.setFocusAfterDelete(e.props.isLastRule?e.props.index-1:e.props.index)}),100),this.props.onRuleDelete(this.props.rule.ruleId,this.props.index))},t.prototype.onRuleDuplicate=function(){if(ve(ExcelRibbonStrings.ConditionalFormattingRuleDuplicated),this.props.rule.isPlaceholder)i.a.shipAssertTag(538063968,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.Rule.onRuleDuplicate: rule is a place holder.");else{var e=function(e){var t=Le(e);if(t.customFormat&&(t.customFormat.preserveBackgroundColor=!1),t.dataBarFormat||t.iconSetFormat||t.colorScaleFormat){var n=t.dataBarFormat?77:t.iconSetFormat?79:t.colorScaleFormat?78:0;t.options={command:n,quickFormat:6}}else t.options||(t.options={quickFormat:6});return t}(this.props.rule);this.props.onRuleDuplicate(e)}},t.prototype.setFocusAfterDelete=function(e){var t=document.getElementById(Ae(e));t?t.focus():M.setFocusOnPaneFirstElement()},t.prototype.onKeyDown=function(e){if(!this.state.pickerState.isPicking){var t=null;switch(e.keyCode){case z.a.up:e.ctrlKey?this.props.onMoveRuleWithKeyboard(this.props.rule,this.props.index,!0):0!==this.props.index&&(t=document.getElementById(Ae(this.props.index-1)));break;case z.a.down:e.ctrlKey?this.props.onMoveRuleWithKeyboard(this.props.rule,this.props.index,!1):this.props.isLastRule||(t=document.getElementById(Ae(this.props.index+1)));break;case z.a.tab:e.shiftKey?t=document.getElementById("CondFmtDeleteAllRulesButton"):M.setFocusOnToolbarFirstElement(),e.stopPropagation(),e.preventDefault();break;case z.a.del:this.onRuleDelete(),e.preventDefault();break;case z.a.enter:if(!(t=document.getElementById(se(this.props.rule.ruleId)))){var n=Ae(this.props.index);(t=document.getElementById(X(n)))&&this.isRuleEditable()||(t=document.getElementById($(n)))}}t&&t.focus()}},t.prototype.isCursorShouldBeGrab=function(){return M.isRuleReorderWithDnDSupported()&&!this.props.rule.isPlaceholder},t}(O.Component),We=n(2479),He=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderTrackVertical=function(){var e,n=t.props.trackWidth,o=void 0===n?10:n,r=((e={position:"absolute",bottom:"2px"})[Object(F.a)()?"left":"right"]="3px",e.top="10px",e.width=o,e.cursor="default",e);return O.createElement("div",{style:r})},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(We.Scrollbars,{autoHide:!1,style:this.props.containerStyle,renderView:this.renderView,renderThumbHorizontal:this.renderThumbHorizontal,renderThumbVertical:this.renderThumbVertical,renderTrackVertical:this.renderTrackVertical},this.props.children)},t.prototype.renderView=function(){return O.createElement("div",{className:Object(V.eb)({overflow:"scroll",position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px","-ms-overflow-style":"none","scrollbar-width":"none",selectors:{"::-webkit-scrollbar":{display:"none"}}})})},t.prototype.renderThumbHorizontal=function(){return O.createElement("div",{style:{display:"hidden"}})},t.prototype.renderThumbVertical=function(){return O.createElement("div",{style:{display:"block",width:"6px",backgroundColor:"#C8C6C4",borderRadius:"3px"}})},t}(O.Component),ze=void 0,Ve=function(e){function t(t){var o=e.call(this,t)||this;return ze||(ze=O.lazy((function(){return n.e(27).then(n.bind(null,2694))}))),o.renderRuleComponent=o.renderRuleComponent.bind(o),o.onRenderItem=o.onRenderItem.bind(o),o}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=Object.keys(this.props.rules).length,n=O.createElement("div",{role:"list",id:this.getRuleListId()},this.props.rules.map((function(n,o){return M.isRuleReorderWithDnDSupported()&&!n.isPlaceholder?O.createElement(ze,{key:n.ruleId,id:n.ruleId,index:o,onRenderItem:e.onRenderItem,onReorderItemPreview:e.props.onReorderRuleCardPreview,onCommitReorderItem:e.props.onCommitReorderRuleCard,onCancelReorderItem:e.props.onCancelReorderRuleCard}):e.renderRuleComponent(n,o,o===t-1)})));return O.createElement(He,{containerStyle:{minWidth:"304px"}},O.createElement("div",{style:{position:"absolute",display:"flex",flexDirection:"column",overflow:"hidden"}},n))},t.prototype.getRuleListId=function(){return this.props.rules&&0!==this.props.rules.length&&this.props.rules[0].isPlaceholder?M.getRequiredLoadingRuleListId():M.getRequiredRuleListId()},t.prototype.onRenderItem=function(e,t){return this.renderRuleComponent(this.props.rules[t],t,t===Object.keys(this.props.rules).length-1)},t.prototype.renderRuleComponent=function(e,t,n){return O.createElement(Ne,{key:e.ruleId,index:t,rule:e,onRuleDelete:this.props.onRuleDelete,onRuleDuplicate:this.props.onRuleDuplicate,onRuleHoverStateChanged:this.props.onRuleHoverStateChanged,editRule:this.props.editRule,onMoveRuleWithKeyboard:this.props.onMoveRuleWithKeyboard,onRuleRangeChanged:this.props.onRuleRangeChanged,isLastRule:n})},t}(O.Component),Ge=n(378),Ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.emptyContainerLabelStyle=Object(k.__assign)(Object(k.__assign)({},ut),{paddingTop:"16px",fontWeight:400}),t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Ge.a,{"aria-label":ExcelRibbonStrings.ConditionalFormattingEmptyPane,style:this.emptyContainerLabelStyle,id:"EmptyRuleContainerLabel"},ExcelRibbonStrings.ConditionalFormattingEmptyPane)},t}(O.Component),qe=n(1971),Qe=n(448),Ke={backgroundColor:"transparent",fontSize:"12px"},Je={dropdown:{border:"1px solid transparent",width:"max-content",color:"#217346",fontSize:"12px",selectors:{":focus":K(),":focus:after":{outline:"none",border:"1px solid transparent"}}},title:{border:"none",color:"#217346 !important",backgroundColor:"transparent",height:"22px",marginBottom:"5px",paddingLeft:"4px",lineHeight:"23px"},root:{color:"#217346"},dropdownOptionText:Ke,caretDownWrapper:{maxHeight:"12px",lineHeight:"23px"},dropdownItem:{minHeight:"24px",color:"#252423"},dropdownItemSelected:{minHeight:"24px"},dropdownItems:{overflow:"hidden"}},Ze={alignItems:"baseline",marginTop:"9px"},Ye=n(1157),Xe=function(e){function t(t){var n=e.call(this,t)||this;return n.onUpdateFilteringOption=n.onUpdateFilteringOption.bind(n),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){M.setFocusOnPaneFirstElement()},t.prototype.render=function(){return O.createElement(Qe.a,{style:Ze,horizontal:!0,tokens:{childrenGap:2},verticalAlign:"end"},O.createElement(Ge.a,{style:{fontSize:"12px",paddingTop:"0px",paddingBottom:"0px",marginBottom:"8px"},id:"ConditionalFormattingFilterMenuPrefix"},ExcelRibbonStrings.ConditionalFormattingFilterMenuPrefix),O.createElement(qe.a,{role:"combobox",options:t.filterOptions,selectedKey:this.props.ruleFilterOption,styles:Je,onRenderCaretDown:Ye.a,onChange:this.onUpdateFilteringOption,"aria-labelledby":"EmptyRuleContainerLabel ConditionalFormattingFilterMenuPrefix",id:M.getRequiredFirstPaneElementId()}))},t.prototype.onUpdateFilteringOption=function(e,t){if(!t)throw new Error("undefined filtering option.");var n;if(0===t.key)n=0;else{if(1!==t.key)throw new Error("RuleManager.onUpdateFilteringOption Unknown filtering type.");n=1}M.onRuleFilteringOptionsChange(n)},t.filterOptions=[{key:1,text:ExcelRibbonStrings.ConditionalFormattingFilterMenuSheet},{key:0,text:ExcelRibbonStrings.ConditionalFormattingFilterMenuSelection}],t}(O.Component),$e=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isLoading:!1},n.timeout=null,n}return Object(k.__extends)(t,e),t.prototype.render=function(){return this.state.isLoading?this.props.loadingElement():O.createElement("div",null)},t.prototype.componentDidMount=function(){var e=this;this.state.isLoading||(this.timeout=setTimeout((function(){e.setState({isLoading:!0})}),this.props.showLoadingAfter))},t.prototype.componentWillUnmount=function(){clearTimeout(this.timeout)},t}(O.Component),et=n(1219),tt={marginLeft:"9px"},nt=Object(k.__assign)(Object(k.__assign)({},tt),{color:"#252423",paddingTop:"16px"}),ot=Object(k.__assign)(Object(k.__assign)({},tt),{fontSize:"12px",color:"#252423",fontWeight:400,paddingBottom:"16px"}),rt={root:tt},it=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",null,O.createElement(Ge.a,{style:nt},this.props.errorTitle),O.createElement(Ge.a,{style:ot},this.props.errorMsg),this.props.infoLink&&this.props.infoLinkText?O.createElement(et.a,{href:this.props.infoLink,target:"_blank",styles:rt},this.props.infoLinkText):"")},t}(O.Component),at=new Map;at.set(1,{errorTitle:ExcelRibbonStrings.ConditionalFormattingTooManyRulesErrorTitle,errorMsg:ExcelRibbonStrings.ConditionalFormattingTooManyRulesErrorMessage,infoLink:"https://support.office.com/article/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f",infoLinkText:ExcelRibbonStrings.ConditionalFormattingInfoURLText}),at.set(3,{errorTitle:ExcelRibbonStrings.ConditionalFormattingCantDisplayRulesErrorTitle,errorMsg:ExcelRibbonStrings.ConditionalFormattingProtecedSheetRuleManagerErrorMessage,infoLink:"https://support.office.com/article/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f",infoLinkText:ExcelRibbonStrings.ConditionalFormattingInfoURLText});var st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Z.a,{content:ExcelRibbonStrings.ConditionalFormattingNewRuleTooltip,directionalHint:Y.a.bottomCenter},O.createElement(be.a,{"aria-label":ExcelRibbonStrings.ConditionalFormattingNewRuleTooltip,disabled:this.props.isDisabled,styles:pt(),iconProps:{iconName:W.a.plussignglyph_16,styles:lt},onClick:this.onAddNewRuleSelected}))},t.prototype.onAddNewRuleSelected=function(e){M.addNewRuleFromTaskPane()},t}(O.Component),lt={root:{width:"16px",height:"16px",selectors:{"svg > path.OfficeIconColors_DynamicColor":{fill:"buttonText"}}}},ct=n(587),ut={color:"#252423",fontSize:"12px"},dt={background:"Highlight",color:"HighlightText",fill:"HighlightText","svg > path.OfficeIconColors_DynamicColor":{fill:"highlighttext"}},pt=function(){var e,t;return{root:{paddingRight:"4px",selectors:{":hover":(e={background:"#E1DFDD"},e[V.m]=dt,e),":focus":(t={},t[V.m]=dt,t)}},rootDisabled:{opacity:"0.3",":hover":{background:"transparent"},pointerEvents:"none"}}},ht=null,gt=void 0,mt=function(e){function t(n){var o=e.call(this,n)||this;return o.AnnounceRuleReorder=function(e,t){ve(ExcelRibbonStrings.ConditionalFormattingReorderRulesCompleted.replace("{0}",""+e).replace("{1}",""+t))},o.createLoadingElement=function(){return o.getRulesContainerComponent(o.createPlaceholderRulesList())},o.state={rules:t.copyRulesArray(o.props.rules),isInReorder:!1,hasPendingChanges:!1,ownUpdate:!0},o.onRuleDelete=o.onRuleDelete.bind(o),o.onRuleDuplicate=o.onRuleDuplicate.bind(o),o.editRule=o.editRule.bind(o),o.onDeleteAllRules=o.onDeleteAllRules.bind(o),o.onRuleHoverStateChanged=o.onRuleHoverStateChanged.bind(o),o.onReorderRuleCardPreview=o.onReorderRuleCardPreview.bind(o),o.onCommitReorderRuleCard=o.onCommitReorderRuleCard.bind(o),o.onCancelReorderRuleCard=o.onCancelReorderRuleCard.bind(o),o.restoreRulesFromProps=o.restoreRulesFromProps.bind(o),o.onMoveRuleWithKeyboard=o.onMoveRuleWithKeyboard.bind(o),o.commitRuleReorderKeyboardEvent=o.commitRuleReorderKeyboardEvent.bind(o),o.onRuleRangeChanged=o.onRuleRangeChanged.bind(o),o}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,n){return n.ownUpdate?{ownUpdate:!1}:n.isInReorder?{hasPendingChanges:!0}:{rules:t.copyRulesArray(e.rules),hasPendingChanges:!1,ownUpdate:!1}},t.prototype.render=function(){return O.createElement("div",{id:M.getRequiredRuleManagerId(),style:Object(k.__assign)({position:"absolute",height:"100%",display:"flex",flexDirection:"column"},{marginLeft:"17px",marginRight:"17px",right:"0px",left:"0px"})},O.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},O.createElement(Xe,{ruleFilterOption:this.props.ruleFilterOption}),O.createElement("div",null,O.createElement(st,{isDisabled:this.isAddNewRuleButtonDisabled()}),O.createElement(ye,{onDeleteAllRules:this.onDeleteAllRules,isDisabled:this.isDeleteAllRulesButtonDisabled()}))),this.getRulesContent())},t.prototype.getRulesContent=function(){return this.props.error?O.createElement(it,Object(k.__assign)({},at.get(this.props.error))):this.props.isLoading?O.createElement($e,{showLoadingAfter:To,loadingElement:this.createLoadingElement}):0===Object.keys(this.state.rules).length?O.createElement(Ue,null):this.getRulesContainerComponent(this.state.rules)},t.prototype.isDeleteAllRulesButtonDisabled=function(){var e=0===Object.keys(this.state.rules).length&&!(1===this.props.error);return 3===this.props.error||e},t.prototype.isAddNewRuleButtonDisabled=function(){return 3===this.props.error},t.prototype.getRulesContainerComponent=function(e){return O.createElement(Ve,{rules:e,onRuleDelete:this.onRuleDelete,onRuleDuplicate:this.onRuleDuplicate,editRule:this.editRule,onRuleHoverStateChanged:this.onRuleHoverStateChanged,onMoveRuleWithKeyboard:this.onMoveRuleWithKeyboard,onReorderRuleCardPreview:this.onReorderRuleCardPreview,onCommitReorderRuleCard:this.onCommitReorderRuleCard,onCancelReorderRuleCard:this.onCancelReorderRuleCard,onRuleRangeChanged:this.onRuleRangeChanged})},t.prototype.onRuleDelete=function(e,t){var n=this.state.rules;n.splice(t,1),this.setState({rules:n,ownUpdate:!0}),M.onRuleDelete(e)},t.prototype.onRuleDuplicate=function(e){var t=this.state.rules;t.unshift(this.createPlaceholderRule(ct())),this.setState({rules:t,ownUpdate:!0},(function(){var e;null===(e=document.getElementById(Ae(0)))||void 0===e||e.focus()})),M.onRuleDuplicate(e)},t.prototype.onDeleteAllRules=function(){this.setState({rules:[],ownUpdate:!0})},t.prototype.editRule=function(e){this.props.onChangeViewRequest(2,e)},t.prototype.onRuleRangeChanged=function(e,t,n){M.onRuleEdited(Object(k.__assign)(Object(k.__assign)({},Fe(e)),{range:t,ruleRangeSheetName:n}));var o=this.state.rules,r=o.indexOf(e);if(r>=0){var i=Object(k.__assign)({},o[r]);i.ruleRange=t,o[r]=i,this.setState({rules:o,ownUpdate:!0})}},t.prototype.restoreRulesFromProps=function(){this.setState({rules:t.copyRulesArray(this.props.rules),isInReorder:!1,hasPendingChanges:!1,ownUpdate:!0})},t.prototype.onReorderRuleCardPreview=function(e,t){var n=this.state.rules;this.moveRuleToIndex(n,e,t),this.setState({rules:n,isInReorder:!0,ownUpdate:!0})},t.prototype.onCommitReorderRuleCard=function(e,t){var n=this,o=this.state.rules,r=Object.keys(o).length;if(!(r<=1)){var s=o.filter((function(t){return"".concat(t.ruleId)===e}))[0];if(!s||s.isPlaceholder)return i.a.shipAssertTag(556660762,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RuleManager: invalid rule for reorder."),void this.restoreRulesFromProps();var l=o.indexOf(s);if(t!==l){var c=-1;if(c=l===r-1?o[l-1].priority+1:o[l+1].priority,s.priority!==c)if(M.onRuleEdited(Object(k.__assign)(Object(k.__assign)({},Fe(s)),{priority:c,newJSApiPriority:l})),this.state.hasPendingChanges)this.restoreRulesFromProps();else{s.priority=c;for(var u=l+1;u<r;u+=1)o[u].priority+=1;this.setState({rules:o,hasPendingChanges:!1,isInReorder:!1,ownUpdate:!0},(function(){n.AnnounceRuleReorder(l+1,r)}))}}else this.state.hasPendingChanges&&this.restoreRulesFromProps()}},t.prototype.onMoveRuleWithKeyboard=function(e,t,n){var o=this;if(this.isMoveRuleWithKeyboardEnabled(e,t,n)){var r=this.state.rules,s=Object.keys(r).length;ht&&(clearTimeout(ht),gt?gt.rule.ruleId!==e.ruleId&&this.commitRuleReorderKeyboardEvent():i.a.shipAssertTag(555266245,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.onMoveRuleWithKeyboard: reorderEvent is undefined."));var l={rule:e,newPriority:-1,newIndex:-1};n?(l.newIndex=t-1,l.newPriority=r[l.newIndex].priority,r[t]=r[l.newIndex],r[l.newIndex]=e):(l.newIndex=t+1,l.newIndex===s-1?l.newPriority=r[l.newIndex].priority+1:l.newPriority=r[l.newIndex+1].priority,r[t]=r[l.newIndex],r[l.newIndex]=e),gt=l,ht=setTimeout((function(){o.commitRuleReorderKeyboardEvent(),ht=null}),1e3),this.setState({rules:r,ownUpdate:!0},(function(){var e;null===(e=document.getElementById(Ae(l.newIndex)))||void 0===e||e.focus({preventScroll:!1})}))}},t.prototype.isMoveRuleWithKeyboardEnabled=function(e,t,n){var o=this.state.rules,r=Object.keys(o).length;return!e.isPlaceholder&&(!(r<=1)&&(!(0===t&&n||t===r-1&&!n)&&!(n&&o[t-1].isPlaceholder||!n&&o[t+1].isPlaceholder)))},t.prototype.commitRuleReorderKeyboardEvent=function(){if(gt){M.onRuleEdited(Object(k.__assign)(Object(k.__assign)({},Fe(gt.rule)),{priority:gt.newPriority,newJSApiPriority:gt.newIndex}));var e=this.state.rules,t=Object.keys(e).length;if(gt.newIndex<t&&e[gt.newIndex].ruleId===gt.rule.ruleId){gt.rule.priority=gt.newPriority;for(var n=gt.newIndex+1;n<t;n+=1)e[n].priority+=1}this.AnnounceRuleReorder(gt.newIndex+1,t),gt=void 0}else i.a.shipAssertTag(555266246,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.commitRuleReorderKeyboardEvent: reorderEvent is undefined.")},t.prototype.onCancelReorderRuleCard=function(e,t){if(this.state.hasPendingChanges)this.restoreRulesFromProps();else{var n=this.state.rules;this.moveRuleToIndex(n,e,t),this.setState({rules:n,isInReorder:!1,hasPendingChanges:!1,ownUpdate:!0})}},t.prototype.moveRuleToIndex=function(e,t,n){if(n<0||n>=Object.keys(e).length)i.a.shipAssertTag(556660763,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RuleManager: invalid index for rule reorder.");else{var o=e.filter((function(e){return"".concat(e.ruleId)===t}))[0];if(o){var r=e.indexOf(o);e.splice(r,1),e.splice(n,0,o)}else i.a.shipAssertTag(556660764,a.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RuleManager: invalid rule for reorder.")}},t.prototype.onRuleHoverStateChanged=function(e,t){return!t.isPlaceholder&&!this.state.isInReorder&&(M.onRuleHoverStateChange(e,t.ruleId,t.ruleRange),!0)},t.prototype.createPlaceholderRule=function(e){return{isPlaceholder:!0,ruleName:"",ruleType:0,ruleRange:"",ruleId:e,priority:0,stopIfTrue:!1,colorScaleFormat:null,dataBarFormat:null,customFormat:null,iconSetFormat:null}},t.prototype.createPlaceholderRulesList=function(){for(var e=[],t=0;t<4;t+=1)e.push(this.createPlaceholderRule(t.toString()));return e},t.copyRulesArray=function(e){var t=[];if(e)for(var n=Object.keys(e).length,o=0;o<n;o+=1)t.push(e[o]);return t},t}(O.Component);var ft,bt,vt,yt=n(31);!function(e){e[e.CellValue=0]="CellValue",e[e.SpecificText=1]="SpecificText",e[e.DateOccurring=2]="DateOccurring",e[e.DuplicateValues=3]="DuplicateValues",e[e.UniqueValues=4]="UniqueValues",e[e.Blanks=5]="Blanks",e[e.NoBlanks=6]="NoBlanks",e[e.Errors=7]="Errors",e[e.NoErrors=8]="NoErrors"}(ft||(ft={})),function(e){e[e.HighlightCellsWith=0]="HighlightCellsWith",e[e.TopBottom=1]="TopBottom",e[e.DataBars=2]="DataBars",e[e.ColorScales=3]="ColorScales",e[e.IconSets=4]="IconSets",e[e.Formula=5]="Formula"}(bt||(bt={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.AboveAverage=2]="AboveAverage",e[e.BelowAverage=3]="BelowAverage",e[e.EqualOrAboveAverage=4]="EqualOrAboveAverage",e[e.EqualOrBelowAverage=5]="EqualOrBelowAverage"}(vt||(vt={}));var xt=function(){function e(e,t){this.command=e,this.inputValue=t,this.shouldShowErrorWhenInvalid=!0,this.inputWasChanged=!1}return e.prototype.getCommandType=function(){return this.command},e.prototype.setCommandType=function(e){this.command=e},e.prototype.getRuleInputValue=function(){return this.inputValue},e.prototype.setRuleInputValue=function(e){this.setShouldShowErrorWhenInvalid(!0),this.inputValue=e},e.prototype.shouldShowError=function(){return this.shouldShowErrorWhenInvalid&&!this.isValid()},e.prototype.getShouldShowErrorWhenInvalid=function(){return this.shouldShowErrorWhenInvalid},e.prototype.setShouldShowErrorWhenInvalid=function(e){this.shouldShowErrorWhenInvalid=e},e.prototype.wasChanged=function(){return this.inputWasChanged},e.prototype.setWasChanged=function(){this.inputWasChanged=!0},e.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!0},e.prototype.getError=function(){return null},e.prototype.canFocusOnRuleInput=function(){return!1},e}(),Ct=function(e){function t(t,n){void 0===n&&(n=null);var o=e.call(this,t,n)||this;return o.minValue=1,o.percentMaxValue=100,o.maxValue=1e3,o.defaultInputValue=10,o.isAverageRule()||null!==n||o.setRuleInputValue(o.getDefaultValue()),o}return Object(k.__extends)(t,e),t.prototype.isPercentRule=function(){return 9===this.getCommandType()||11===this.getCommandType()},t.prototype.getInputType=function(){return bt.TopBottom},t.prototype.isAverageRule=function(){return 12===this.getCommandType()||13===this.getCommandType()||75===this.getCommandType()||76===this.getCommandType()},t.prototype.isTopRule=function(){return 8===this.getCommandType()||9===this.getCommandType()},t.prototype.isBottomRule=function(){return 10===this.getCommandType()||11===this.getCommandType()},t.prototype.isValid=function(){if(this.isAverageRule())return!0;var e=this.getRuleInputValue();if(!isNaN(e)&&null!=e){var t=parseInt(e,10);if(t.toString()===e.toString()&&t>=this.getMinValue()&&t<=this.getMaxValue())return!0}return!1},t.prototype.getError=function(){return i.a.shipAssertTag(587310853,a.a.msoulscat_ES_EWAJS,!this.isAverageRule(),"TopBottomRuleInput.getErrorMessage: Average rule has no input value."),this.isValid()?null:ExcelRibbonStrings.ConditionalFormattingTopBottomValueTextboxOnError.replace("{0}",this.getMinValue().toString()).replace("{1}",this.getMaxValue().toString())},t.prototype.getMinValue=function(){return this.minValue},t.prototype.getMaxValue=function(){return this.isPercentRule()?this.percentMaxValue:this.maxValue},t.prototype.updateConditionalFormattingOptions=function(e){e.value=this.getRuleInputValue(),e.command=this.getCommandType()},t.prototype.getDefaultValue=function(){return this.defaultInputValue},t.prototype.canFocusOnRuleInput=function(){return!this.isAverageRule()},t}(xt),St=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.defaultInputValue="",o.ruleFormulaValueMaxLength=255,null==n&&o.setRuleInputValue(o.getDefaultValue()),o.shouldShowErrorWhenInvalid=!1,o}return Object(k.__extends)(t,e),t.prototype.getInputType=function(){return 63===this.getCommandType()?bt.Formula:bt.HighlightCellsWith},t.prototype.canFocusOnRuleInput=function(){return!0},t.prototype.isValid=function(){return this.isValidValue(this.getRuleInputValue())},t.prototype.getError=function(){return this.getErrorForValue(this.getRuleInputValue())},t.prototype.getErrorIfNeeded=function(){return this.shouldShowErrorWhenInvalid?this.getError():null},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType(),this.updateFormulaValueOptions(e)},t.prototype.updateFormulaValueOptions=function(e){e.formula1=this.getRuleInputValue(),e.formula2=null},t.prototype.isValidValue=function(e){return 0===this.getErrorTypeForValue(e)},t.prototype.getErrorForValue=function(e){switch(this.getErrorTypeForValue(e)){case 1:return this.getInputType()===bt.Formula?ExcelRibbonStrings.ConditionalFormattingFormulaValueTextboxError:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueTextboxOnError;case 2:return ExcelRibbonStrings.ConditionalFormattingValueTooLongError.replace("{0}",this.ruleFormulaValueMaxLength.toString());case 3:return ExcelRibbonStrings.ConditionalFormattingFormulaRepresentingRangeError;default:return null}},t.prototype.getDefaultValue=function(){return this.defaultInputValue},t.prototype.getErrorTypeForValue=function(e){return e&&e.length>this.ruleFormulaValueMaxLength?2:M.getFormulaErrorType(e)},t}(xt),Et=function(e){function t(t,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var r=e.call(this,t,[n,o])||this,i=n,a=o;return null===n&&(i=r.getDefaultValue()),r.isTwoInputValuesRuleType()&&null===o&&(a=r.getDefaultValue()),i===n&&a===o||r.setRuleInputValue([i,a]),r.shouldShowErrorWhenInvalid=!1,r}return Object(k.__extends)(t,e),t.prototype.isTwoInputValuesRuleType=function(){return 3===this.getCommandType()||70===this.getCommandType()},t.prototype.isValid=function(){return!!this.isValidValue(this.getRuleInputValue()[0])&&!(this.isTwoInputValuesRuleType()&&!this.isValidValue(this.getRuleInputValue()[1]))},t.prototype.getError=function(){var e=this;return this.getRuleInputValue().map((function(t){return e.getErrorForValue(t)}))},t.prototype.getErrorIfNeeded=function(){return this.shouldShowErrorWhenInvalid?this.getError():this.getRuleInputValue().map((function(){return null}))},t.prototype.updateFormulaValueOptions=function(e){e.formula1=this.getRuleInputValue()[0],this.isTwoInputValuesRuleType()?e.formula2=this.getRuleInputValue()[1]:e.formula2=null},t}(St),kt=function(e){function t(t,n){return void 0===n&&(n=!0),e.call(this,t,n)||this}return Object(k.__extends)(t,e),t.prototype.getInputType=function(){return bt.HighlightCellsWith},t.prototype.isValid=function(){return!0},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType(),7===this.getCommandType()&&(e.unique=!this.getRuleInputValue())},t}(xt),Ot=function(e){function t(t,n){return void 0===n&&(n=1),e.call(this,t,n)||this}return Object(k.__extends)(t,e),t.prototype.getInputType=function(){return bt.HighlightCellsWith},t.prototype.isValid=function(){return!0},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType(),e.timePeriod=this.getRuleInputValue()},t}(xt),Tt=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return Object(k.__extends)(t,e),t.prototype.getInputType=function(){return bt.DataBars},t.prototype.isValid=function(){return!0},t.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!1},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType()},t}(xt),It=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return Object(k.__extends)(t,e),t.prototype.getInputType=function(){return bt.ColorScales},t.prototype.isValid=function(){return!0},t.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!1},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType()},t}(xt),wt=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return Object(k.__extends)(t,e),t.prototype.getInputType=function(){return bt.IconSets},t.prototype.isValid=function(){return!0},t.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!1},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType()},t}(xt),_t=function(){function e(){}return e.prototype.createRuleInputData=function(e,t,n,o,r){switch(void 0===t&&(t=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=null),e){case 8:case 10:case 9:case 11:case 12:case 13:case 75:case 76:return new Ct(e,t?t.value:null);case 1:case 2:case 4:case 68:case 69:case 71:return new Et(e,t?t.formula1:null);case 3:case 70:return new Et(e,t?t.formula1:null,t?t.formula2:null);case 5:case 72:case 73:case 74:return new St(e,t?t.formula1:null);case 7:return new kt(7,!t||!t.unique||!t.unique);case 64:case 65:case 66:case 67:return new kt(e);case 6:return new Ot(6,t&&null!==t.timePeriod&&void 0!==t.timePeriod?t.timePeriod:void 0);case 15:return new Tt(15,n);case 28:return new It(28,o);case 39:return new wt(39,r);case 63:return new St(63,t?t.formula1:null);case 0:if(null!==n)return new Tt(0,n);if(null!==o)return new It(0,o);if(null!==r)return new wt(0,r);throw new Error("Unsupported ConditionalFormattingCommandType.Nil with no dataBarFormat");default:throw new Error("Unsupported ConditionalFormattingCommandType")}},e.prototype.createDefaultRuleInputDataByRuleTypeOption=function(e,t){var n;switch(void 0===e&&(e=null),void 0===t&&(t=null),e){case bt.TopBottom:(n=this.createRuleInputData(8)).setWasChanged();break;case bt.HighlightCellsWith:(n=this.createRuleInputData(1)).setWasChanged();break;case bt.DataBars:(n=null!=t?this.createRuleInputData(0,null,t):this.createRuleInputData(15)).setWasChanged();break;case bt.ColorScales:(n=null!=t?this.createRuleInputData(0,null,null,t):this.createRuleInputData(28)).setWasChanged();break;case bt.IconSets:(n=null!=t?this.createRuleInputData(0,null,null,null,t):this.createRuleInputData(39)).setWasChanged();break;case bt.Formula:(n=this.createRuleInputData(63)).setWasChanged();break;case null:n=this.createRuleInputData(1);break;default:throw new Error("Unsupported RuleTypeOption")}return n},e.prototype.createDefaultRuleInputDataByHighlightCellsWithOption=function(e){var t;switch(e){case ft.CellValue:t=this.createRuleInputData(1);break;case ft.SpecificText:t=this.createRuleInputData(5);break;case ft.DateOccurring:t=this.createRuleInputData(6);break;case ft.DuplicateValues:t=this.createRuleInputData(7);break;case ft.UniqueValues:t=this.createRuleInputData(7,{unique:!0});break;case ft.Blanks:t=this.createRuleInputData(64);break;case ft.NoBlanks:t=this.createRuleInputData(65);break;case ft.Errors:t=this.createRuleInputData(66);break;case ft.NoErrors:t=this.createRuleInputData(67)}return t.setWasChanged(),t},e}(),Pt={lineHeight:"normal",width:"100%"},Rt={lineHeight:"normal",marginTop:"4px"};function Dt(e){var t,n=e.isOpen?K(!0,!0):{};return{label:{fontSize:"12px",height:"14px",marginBottom:"4px",padding:"0px"},title:Object(k.__assign)(Object(k.__assign)({},n),{height:"28px",lineHeight:"normal",selectors:{":active:hover":{borderColor:"#217344"},":active:not(:hover)":{borderColor:"#217344"}}}),dropdown:{maxWidth:"287px",fontSize:"12px",selectors:(t={":active":{outline:"none"},":focus::after":K(!0,!0)},t[V.m]={":focus .ms-Dropdown-title":{color:"unset"},":hover .ms-Dropdown-title":{borderColor:"unset"}},t)},dropdownItem:{direction:Object(F.a)()?"rtl":"ltr",minHeight:"28px",fontSize:"12px"},dropdownItemSelected:{direction:Object(F.a)()?"rtl":"ltr",minHeight:"28px",fontSize:"12px"}}}var jt,Bt=function(e){function t(t){var n=e.call(this,t)||this;return n.onRenderOption=function(e){return e?O.createElement("div",{style:Pt},O.createElement(Ft,{text:e.text,item:e.data&&e.data.item})):(i.a.sendTraceTag(591927251,a.a.msoulscat_ES_EWAJS,s.a.Warning,"ConditionalFormattingTaskPaneReact.CFDropdown.RenderOption: option is undefined."),O.createElement("div",null))},n.onRenderTitle=function(e){return e&&e[0]?O.createElement("div",{style:Rt},O.createElement(Ft,{text:e[0].text,item:e[0].data&&e[0].data.item})):(i.a.sendTraceTag(591927252,a.a.msoulscat_ES_EWAJS,s.a.Warning,"ConditionalFormattingTaskPaneReact.CFDropdown.RenderTitle: options list is "+(void 0===e?"undefined.":"empty.")),O.createElement("div",null))},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(qe.a,{role:"combobox listbox",id:this.props.id,label:this.props.label,ariaLabel:this.props.ariaLabel||this.props.label,options:this.props.options,styles:Dt,onRenderOption:this.onRenderOption,onRenderTitle:this.onRenderTitle,onRenderCaretDown:Ye.a,onChange:this.props.onChange?this.props.onChange:void 0,selectedKey:void 0===this.props.selectedKey||null===this.props.selectedKey?this.props.options[0].key:this.props.selectedKey,disabled:this.props.disabled})},t}(O.Component),Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{display:"flex"}},O.createElement("div",null,this.props.item),O.createElement("span",{style:(e=!!this.props.item,t=e?"10px":"1px",Object(F.a)()?Object(k.__assign)({marginRight:t},J):Object(k.__assign)({marginLeft:t},J))},this.props.text));var e,t},t}(O.Component),Lt=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:this.props.id,label:ExcelRibbonStrings.ConditionalFormattingRuleTypeMenuPrefix,options:At,onChange:this.onChange,selectedKey:this.props.selectedKey?this.props.selectedKey:At[0].key})},t.getDropdownElementId=function(e){return e?"ConditionalFormatting.RuleEditor.RuleTypeDropdown":M.getRequiredFirstPaneElementId()},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(O.Component),Mt={height:"24px",width:"24px",marginTop:"-3px"},At=[{key:bt.HighlightCellsWith,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeHighlightCellsWith,data:{item:O.createElement(H.a,{iconName:W.a.FlyoutAnchorCFHighlightCells_32,style:Mt})}},{key:bt.TopBottom,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeTopBottom,data:{item:O.createElement(H.a,{iconName:W.a.FormattingRuleTop10_32,style:Mt})}},{key:bt.DataBars,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeDataBars,data:{item:O.createElement(H.a,{iconName:W.a.FormattingRuleDataBar_32,style:Mt})}},{key:bt.ColorScales,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeColorScale,data:{item:O.createElement(H.a,{iconName:W.a.FormattingRuleGrad3_32,style:Mt})}},{key:bt.IconSets,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeIconSets,data:{item:O.createElement(H.a,{iconName:W.a.FormattingRuleIconSet_32,style:Mt})}},{key:bt.Formula,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeFormula,data:{item:O.createElement(H.a,{iconName:W.a.ShapeSheetShowFormulas_32,style:Mt})}}],Nt=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:"ConditionalFormatting.RuleEditor.TopBottomDropdown",options:Wt,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingOperatorDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(O.Component),Wt=[{key:vt.Top,text:ExcelRibbonStrings.ConditionalFormattingTopBottomTop},{key:vt.Bottom,text:ExcelRibbonStrings.ConditionalFormattingTopBottomBottom},{key:vt.AboveAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomAverageAbove},{key:vt.BelowAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomAverageBelow},{key:vt.EqualOrAboveAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomEqualOrAboveAverage},{key:vt.EqualOrBelowAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomEqualOrBelowAverage}],Ht=n(1333),zt=n(344),Vt=n(2327),Gt=function(e){function t(t){var n=e.call(this,t)||this;return n.inputElementsMarginLeft="5px",n.spinButtonHight="28px",n.spinButtonMinWidth="70px",n.checkBoxMarginTop="4px",n.topBottomDropdownMinWidth="130px",n.onIncrement=function(e){var t=parseInt(e,10);n.onInputValueChanged(isNaN(t)?n.props.ruleInputData.getMinValue().toString():(t+1).toString()),ve(ExcelRibbonStrings.ConditionalFormattingSpinButtonValueIncreased)},n.onDecrement=function(e){var t=parseInt(e,10);n.onInputValueChanged(isNaN(t)?n.props.ruleInputData.getMinValue().toString():(t-1).toString()),ve(ExcelRibbonStrings.ConditionalFormattingSpinButtonValueDecreased)},n.onTopBottomChange=n.onTopBottomChange.bind(n),n.onPercentChange=n.onPercentChange.bind(n),n.onIncrement=n.onIncrement.bind(n),n.onDecrement=n.onDecrement.bind(n),n.onInput=n.onInput.bind(n),n.onInputValueChanged=n.onInputValueChanged.bind(n),n.getTopBottomInputContent=n.getTopBottomInputContent.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},O.createElement("div",{style:{display:"flex",flexDirection:"row",marginTop:"4px",flexWrap:"wrap"}},this.getTopBottomDropdown(),this.getTopBottomInputContent()))},t.prototype.getTopBottomDropdown=function(){return O.createElement("div",{style:{minWidth:this.topBottomDropdownMinWidth}},O.createElement(Nt,{selectedKey:this.getTopBottomOption(this.props.ruleInputData.getCommandType()),onChange:this.onTopBottomChange}))},t.prototype.getTopBottomInputContent=function(){return this.props.ruleInputData.isAverageRule()?O.createElement("div",null):O.createElement(O.Fragment,null,this.getTopBottomSpinButton(),this.getTopBottomPercentCheckbox())},t.prototype.getTopBottomPercentCheckbox=function(){var e={root:{marginLeft:this.inputElementsMarginLeft,marginTop:this.checkBoxMarginTop},checkbox:{borderRadius:"0%"},label:{fontSize:"12px"}};return O.createElement(Ht.a,{styles:e,checked:this.props.ruleInputData.isPercentRule(),onChange:this.onPercentChange,label:ExcelRibbonStrings.ConditionalFormattingTopBottomPercent,theme:Object(zt.a)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}})})},t.prototype.getTopBottomSpinButton=function(){var e=this.props.ruleInputData.isValid(),t=q(e),n={width:this.spinButtonMinWidth,marginLeft:this.inputElementsMarginLeft},o={root:{minWidth:this.spinButtonMinWidth,height:this.spinButtonHight},input:{fontSize:"12px",minWidth:"0px"},spinButtonWrapper:{selectors:{"::after":t,":hover::after":t,":focus::after":t,"&&":{selectors:{"::after":{borderColor:U(e)}}}}}},r=this.props.ruleInputData.getRuleInputValue().toString(),i=this.props.ruleInputData.getError();return O.createElement("div",{style:n},O.createElement(re,{errorMessage:i||"",childComponentId:"TopBottomSpinButton"},O.createElement(Vt.a,{id:"TopBottomSpinButton",style:{minWidth:this.spinButtonMinWidth,height:this.spinButtonHight},styles:o,value:r,min:this.props.ruleInputData.getMinValue(),max:this.props.ruleInputData.getMaxValue(),onIncrement:this.onIncrement,onDecrement:this.onDecrement,onInput:this.onInput,theme:Object(zt.a)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}}),inputProps:{id:this.props.isNewRule?M.getRequiredFirstPaneElementId():"TopBottomValueInput"},"aria-labelledby":"ConditionalFormatting.RuleEditor.TopBottomDropdown-option "+oe("TopBottomSpinButton"),incrementButtonAriaLabel:ExcelRibbonStrings.ConditionalFormattingIncreaseSpinButton,decrementButtonAriaLabel:ExcelRibbonStrings.ConditionalFormattingDecreaseSpinButton})))},t.prototype.onInput=function(e){this.onInputValueChanged(e.target.value)},t.prototype.onInputValueChanged=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onPercentChange=function(e,t){if(null!=t){var n=this.props.ruleInputData;n.isTopRule()?this.onCommandTypeChange(t?9:8):n.isBottomRule()&&this.onCommandTypeChange(t?11:10)}},t.prototype.onTopBottomChange=function(e){var t=this.props.ruleInputData;this.onCommandTypeChange(this.getCommandType(e,t.isPercentRule()))},t.prototype.onCommandTypeChange=function(e){var t=this.props.ruleInputData,n=new Ct(e,t.getRuleInputValue());n.setWasChanged(),this.props.onInputChange(n)},t.prototype.getCommandType=function(e,t){switch(e){case vt.Top:return t?9:8;case vt.Bottom:return t?11:10;case vt.AboveAverage:return 12;case vt.BelowAverage:return 13;case vt.EqualOrAboveAverage:return 75;case vt.EqualOrBelowAverage:return 76}},t.prototype.getTopBottomOption=function(e){switch(e){case 8:case 9:return vt.Top;case 10:case 11:return vt.Bottom;case 12:return vt.AboveAverage;case 13:return vt.BelowAverage;case 75:return vt.EqualOrAboveAverage;case 76:return vt.EqualOrBelowAverage;default:throw Error("getTopBottomOption: Unsupported Command Type")}},t}(O.Component),Ut=n(1123),qt=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:"ConditionalFormatting.RuleEditor.QuickFormatDropdown",label:ExcelRibbonStrings.ConditionalFormatWithMenuPrefix,options:this.createFormatOptionsList(),onChange:this.onChange,selectedKey:this.props.selectedFormat.getQuickFormat()})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t.prototype.createFormatOptionsList=function(){var e=[];_e.forEach((function(t){e.push({key:t.key,text:t.text,data:{item:Qt(t.customFormat)}})}));var t=this.props.selectedFormat.getCustomFormat();if(Object(Re.h)("HighlightWhenNewPaneExperiment"))e.push({key:"customFormatDivider",text:"-",itemType:Ut.a.Divider},{key:6,text:ExcelRibbonStrings.ConditionalFormattingCustomFormatText});else if(t){var n=function(e){for(var t=0;t<_e.length;t+=1)if(Pe(e,_e[t].customFormat))return t;return-1}(t);-1!==n?e[n].key=6:e.push({key:"customFormatDivider",text:"-",itemType:Ut.a.Divider},{key:6,text:ExcelRibbonStrings.ConditionalFormattingCustomFormatText})}return e},t}(O.Component),Qt=function(e){return O.createElement(fe,{rule:{ruleType:3,customFormat:e}})},Kt=n(748),Jt=n(300),Zt=n(233),Yt=n(134),Xt=n(2331),$t=n(383),en=null,tn=null,nn=function(e){function t(t){var n,o,r,i,a,s,l=e.call(this,t)||this;l.menuSections=[],l.dismissMenu=function(){},l.ref=O.createRef(),l.hoverDelay=250,l.retryDelay=500,l.caretDownIconProps={iconName:W.a.CommonControlChevronDown_12,style:{width:"8px",height:"8px",lineHeight:"5px"}},l.caretRightIconProps={styles:{root:(n={},n[V.m]={"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText !important"}},n)},iconName:Object(F.a)()?c.a.CommonControlChevronLeft_12:c.a.CommonControlChevronRight_12,style:{width:"12px",height:"12px",lineHeight:"12px"}},l.menuSectionStyles={root:{paddingLeft:"5px",paddingRight:"5px",overflow:"hidden"},header:{color:Yt.a.gray130,padding:"0px",height:"25px"}},l.mainButtonStyle={root:(o={backgroundColor:Yt.a.gray30,border:"none",outline:"none",height:"30px",minWidth:"32px",padding:"5px 1px 5px 1px",cursor:"default"},o[V.m]={margin:"0px 2px 0px 2px","svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"},":focus, :focus::after, :active":{borderStyle:"dashed","svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"}}},o),rootHovered:(r={backgroundColor:Yt.a.gray40},r[V.m]={backgroundColor:"Highlight",color:"HighlightText","svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText !important"},outline:"2px dashed ButtonText !important"},r)},l.subMenuButtonStyle={root:(i={border:"none",outline:"none",cursor:"default",height:"35px",width:"100%",fontSize:"12px",padding:"0px 4px 0px 0px"},i[V.m]={"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"},":hover, :active":{backgroundColor:"Highlight !important",color:"HighlightText !important",fill:"HighlightText !important","svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText !important"}}},i),rootFocused:(a={},a[V.m]={background:"none !important",border:"2px dashed Highlight !important","svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}},a),textContainer:{textAlign:"left"},label:(s={},s[V.m]={":hover, :focus, :active, :focus::after":{background:"HighlightText !important",color:"Highlight"}},s)},l.colorCellsProps={colorCell:{height:"24px",width:"24px"},svg:{height:"16px",width:"16px"}},l.onRenderMenuSectionItem=l.onRenderMenuSectionItem.bind(l),l.renderColorSwatch=l.renderColorSwatch.bind(l),l.renderMenuButton=l.renderMenuButton.bind(l),l.changeToDefaultColor=l.changeToDefaultColor.bind(l),l.showMoreColorsDialog=l.showMoreColorsDialog.bind(l),l.notifyColorUsed=l.notifyColorUsed.bind(l),l.selectColorAndNotify=l.selectColorAndNotify.bind(l),l.selectThemeColorAndNotify=l.selectThemeColorAndNotify.bind(l),l.selectColor=l.selectColor.bind(l),l.selectThemeColor=l.selectThemeColor.bind(l),l.getColorCellProps=l.getColorCellProps.bind(l),l.onMouseEnter=l.onMouseEnter.bind(l),l.onMouseLeave=l.onMouseLeave.bind(l),l.openColorSubMenu=l.openColorSubMenu.bind(l),l.prepareMenuSections=l.prepareMenuSections.bind(l),l.updateMenuSections=l.updateMenuSections.bind(l),l.buildMenuProps=l.buildMenuProps.bind(l);var u=l.prepareMenuSections();return l.state={menuProps:l.buildMenuProps(u)},l}return Object(k.__extends)(t,e),t.prototype.componentWillUnmount=function(){en&&clearTimeout(en),tn&&clearTimeout(tn)},t.prototype.render=function(){var e;e=this.props.isSubMenuButton?{text:this.props.buttonLabel,styles:this.subMenuButtonStyle,menuIconProps:this.caretRightIconProps,componentRef:this.ref,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave}:{styles:this.mainButtonStyle,menuIconProps:this.caretDownIconProps,split:!0};var t=O.createElement(Kt.a,Object(k.__assign)({"aria-label":this.props.buttonLabel,role:"button",iconProps:{iconName:this.props.buttonIconName,styles:{root:{fill:this.props.selectedColor||this.props.defaultColor,height:"18px",width:"18px"}}},menuProps:this.state.menuProps},e));return this.props.isSubMenuButton?t:O.createElement(Z.a,{content:this.props.buttonLabel,directionalHint:Y.a.bottomCenter},t)},t.prototype.prepareMenuSections=function(){var e=this,t=this.props.colorPickerController.getColorPickerButtonMenuProps(this.props.modifiers);if(!t||!t.sections)return i.a.sendTraceTag(545116672,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton: getColorPickerButtonMenuProps returned null."),[];if(this.menuSections=t.sections||[],this.menuSections.length<1)return tn=setTimeout(this.updateMenuSections,this.retryDelay),[];var n=[];return this.menuSections.forEach((function(t,o){n.push({key:"ColorPickerButtonSection"+o,itemType:Jt.a.Section,sectionProps:{topDivider:0!==o,bottomDivider:o!==e.menuSections.length-1,title:t.title,items:[{key:"ColorPickerButtonSectionItem"+o,data:o,onRender:e.onRenderMenuSectionItem}]}})})),n},t.prototype.updateMenuSections=function(){var e=this.prepareMenuSections();e&&e.length>0&&this.setState({menuProps:this.buildMenuProps(e)})},t.prototype.buildMenuProps=function(e){return{items:e,styles:this.menuSectionStyles,focusZoneProps:{direction:Zt.a.bidirectional}}},t.prototype.onRenderMenuSectionItem=function(e,t){this.dismissMenu=t;var n=this.menuSections[e.data];if(!n)return i.a.sendTraceTag(545116673,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton.onRenderMenuSectionItem: menuSection is null."),O.createElement("div",null);switch(n.type){case 1:if(n.colorSwatchProps)return this.renderColorSwatch(n.colorSwatchProps);break;case 2:if(n.buttonProps)return this.renderMenuButton(n.buttonProps)}return i.a.sendTraceTag(545116674,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton.onRenderMenuSectionItem: Unknown menu section type."),O.createElement("div",null)},t.prototype.selectColor=function(e,t){void 0===t&&(t=void 0),this.props.onChange(e.color||null,t),this.dismissMenu()},t.prototype.selectThemeColor=function(e){this.selectColor(e,this.props.colorPickerController.getThemeColor(e.color)||void 0)},t.prototype.selectThemeColorAndNotify=function(e){this.notifyColorUsed(e),this.selectThemeColor(e)},t.prototype.selectColorAndNotify=function(e){this.notifyColorUsed(e),this.selectColor(e)},t.prototype.notifyColorUsed=function(e){e.color&&this.props.colorPickerController.onColorUsed(e.color)},t.prototype.renderColorSwatch=function(e){var t,n=this.selectColor;return e.isThemeColorSection?n=e.notifyOnColorUsed?this.selectThemeColorAndNotify:this.selectThemeColor:e.notifyOnColorUsed&&(n=this.selectColorAndNotify),O.createElement(Xt.a,{type:"AppColorPickerProps",columnCount:10,id:"ColorPickerButton",colorCells:e.colors,selectedId:(null===(t=this.props.selectedColor)||void 0===t?void 0:t.toLowerCase())||void 0,cellStyles:this.getColorCellProps,onExecute:n})},t.prototype.getColorCellProps=function(){return this.colorCellsProps},t.prototype.renderMenuButton=function(e){var t,n=void 0,o=void 0,r=!1;switch(e.type){case 1:n=this.showMoreColorsDialog,o=d.a.MoreColors_20;break;case 3:n=this.changeToDefaultColor,o=d.a.Automatic_16,r=null==this.props.selectedColor;break;case 2:n=this.changeToDefaultColor,o=d.a.SwatchNoColorSquare_20,r=null==this.props.selectedColor;break;case 4:default:return i.a.sendTraceTag(545116675,a.a.msoulscat_ES_EWAJS,s.a.Error,"ColorPickerButton.renderMenuButton: Unknown button type."),O.createElement("div",null)}return O.createElement($t.a,{type:"AppButtonProps",label:e.label,id:"ColorPickerSectionButton",icon:o,onExecute:n,styles:{root:(t={fontSize:"12px",height:"30px",width:"100%",border:"none",backgroundColor:r?Yt.a.gray20:void 0},t[V.m]={background:r?"Highlight":void 0,color:r?"HighlightText !important":void 0,"svg > path.OfficeIconColors_HighContrast":{fill:r?"HighlightText !important":void 0}},t),icon:{height:"16px",width:"16px"}}})},t.prototype.changeToDefaultColor=function(){this.props.onChange(null),this.dismissMenu()},t.prototype.showMoreColorsDialog=function(){var e=this;this.props.colorPickerController.showMoreColorsDialog(this.props.selectedColor||"#FFFFFF",(function(t,n){t&&e.props.onChange("#"+n)}))},t.prototype.onMouseEnter=function(){en=setTimeout(this.openColorSubMenu,this.hoverDelay)},t.prototype.onMouseLeave=function(){en&&clearTimeout(en)},t.prototype.openColorSubMenu=function(){var e;null===(e=this.ref.current)||void 0===e||e.openMenu(!1,!1),this.props.onSubMenuOpened&&this.props.onSubMenuOpened()},t}(O.Component),on=n(1974),rn=n(334),an=n(5),sn=n.n(an);!function(e){e[e.NoBorder=1]="NoBorder",e[e.BottomBorder=2]="BottomBorder",e[e.TopBorder=3]="TopBorder",e[e.LeftBorder=4]="LeftBorder",e[e.RightBorder=5]="RightBorder",e[e.AllBorders=6]="AllBorders",e[e.OutsideBorders=7]="OutsideBorders",e[e.ThickOutsideBorders=8]="ThickOutsideBorders",e[e.BottomDoubleBorders=9]="BottomDoubleBorders",e[e.ThickBottomBorders=10]="ThickBottomBorders",e[e.TopAndBottomBorders=11]="TopAndBottomBorders",e[e.TopAndThickBottomBorders=12]="TopAndThickBottomBorders",e[e.TopAndDoubleBottomBorders=13]="TopAndDoubleBottomBorders",e[e.InsideBorders=14]="InsideBorders",e[e.InsideHorizontalBorders=15]="InsideHorizontalBorders",e[e.InsideVerticalBorders=16]="InsideVerticalBorders"}(jt||(jt={}));var ln={root:{width:"20px",height:"20px",padding:"2px"}},cn={root:{height:"40px",width:"40px"}},un=new Map;un.set(jt.NoBorder,{type:"AppGalleryButtonProps",id:"NoBorder",index:jt.NoBorder,fullIconProps:{iconName:sn.a.NoBorder_20,styles:ln},title:ExcelRibbonStrings.NoBorder,style:cn}),un.set(jt.BottomBorder,{type:"AppGalleryButtonProps",id:"BottomBorder",index:jt.BottomBorder,fullIconProps:{iconName:h.a.BottomBorder_20,styles:ln},title:ExcelRibbonStrings.BottomBorder,style:cn}),un.set(jt.TopBorder,{type:"AppGalleryButtonProps",id:"TopBorder",index:jt.TopBorder,fullIconProps:{iconName:sn.a.TopBorder_20,styles:ln},title:ExcelRibbonStrings.TopBorder,style:cn}),un.set(jt.LeftBorder,{type:"AppGalleryButtonProps",id:"LeftBorder",index:jt.LeftBorder,fullIconProps:{iconName:sn.a.LeftBorder_20,styles:ln},title:ExcelRibbonStrings.LeftBorder,style:cn}),un.set(jt.RightBorder,{type:"AppGalleryButtonProps",id:"RightBorder",index:jt.RightBorder,fullIconProps:{iconName:sn.a.RightBorder_20,styles:ln},title:ExcelRibbonStrings.RightBorder,style:cn}),un.set(jt.AllBorders,{type:"AppGalleryButtonProps",id:"AllBorders",index:jt.AllBorders,fullIconProps:{iconName:sn.a.AllBorders_20,styles:ln},title:ExcelRibbonStrings.AllBorders,style:cn}),un.set(jt.OutsideBorders,{type:"AppGalleryButtonProps",id:"OutsideBorders",index:jt.OutsideBorders,fullIconProps:{iconName:sn.a.BoxBorder_20,styles:ln},title:ExcelRibbonStrings.OutsideBorders,style:cn}),un.set(jt.ThickOutsideBorders,{type:"AppGalleryButtonProps",id:"ThickOutsideBorders",index:jt.ThickOutsideBorders,fullIconProps:{iconName:sn.a.ThickOutsideBorder_20,styles:ln},title:ExcelRibbonStrings.ThickOutsideBorders,style:cn}),un.set(jt.BottomDoubleBorders,{type:"AppGalleryButtonProps",id:"BottomDoubleBorders",index:jt.BottomDoubleBorders,fullIconProps:{iconName:sn.a.DoubleBottomBorder_20,styles:ln},title:ExcelRibbonStrings.BottomDoubleBorders,style:cn}),un.set(jt.ThickBottomBorders,{type:"AppGalleryButtonProps",id:"ThickBottomBorders",index:jt.ThickBottomBorders,fullIconProps:{iconName:sn.a.ThickBottomBorder_20,styles:ln},title:ExcelRibbonStrings.ThickBottomBorders,style:cn}),un.set(jt.TopAndBottomBorders,{type:"AppGalleryButtonProps",id:"TopAndBottomBorders",index:jt.TopAndBottomBorders,fullIconProps:{iconName:sn.a.TopAndBottomBorder_20,styles:ln},title:ExcelRibbonStrings.TopAndBottomBorders,style:cn}),un.set(jt.TopAndThickBottomBorders,{type:"AppGalleryButtonProps",id:"TopAndThickBottomBorders",index:jt.TopAndThickBottomBorders,fullIconProps:{iconName:sn.a.TopAndThickBottomBorder_20,styles:ln},title:ExcelRibbonStrings.TopAndThickBottomBorders,style:cn}),un.set(jt.TopAndDoubleBottomBorders,{type:"AppGalleryButtonProps",id:"TopAndDoubleBottomBorders",index:jt.TopAndDoubleBottomBorders,fullIconProps:{iconName:sn.a.TopAndDoubleBottomBorder_20,styles:ln},title:ExcelRibbonStrings.TopAndDoubleBottomBorders,style:cn}),un.set(jt.InsideBorders,{type:"AppGalleryButtonProps",id:"InsideBorders",index:jt.InsideBorders,fullIconProps:{iconName:sn.a.InsideBorder_20,styles:ln},title:ExcelRibbonStrings.InsideBorders,style:cn}),un.set(jt.InsideHorizontalBorders,{type:"AppGalleryButtonProps",id:"InsideHorizontalBorders",index:jt.InsideHorizontalBorders,fullIconProps:{iconName:sn.a.InsideHorizontalBorder_20,styles:ln},title:ExcelRibbonStrings.InsideHorizontalBorder,style:cn}),un.set(jt.InsideVerticalBorders,{type:"AppGalleryButtonProps",id:"InsideVerticalBorders",index:jt.InsideVerticalBorders,fullIconProps:{iconName:sn.a.InsideVerticalBorder_20,styles:ln},title:ExcelRibbonStrings.InsideVerticalBorder,style:cn});var dn,pn=n(2264),hn=n(1950),gn=function(e){function t(t){var n,o,r,i,a=e.call(this,t)||this;a.dismissMenu=function(){},a.defaultBorderColor="#000000",a.lineStyleMenuRef=O.createRef(),a.caretDownIconProps={iconName:W.a.CommonControlChevronDown_12,style:{width:"8px",height:"8px",lineHeight:"5px",padding:"0px"}},a.menuSectionStyles={root:{paddingLeft:"5px",paddingRight:"5px"},header:{color:Yt.a.gray130,padding:"0px",height:"25px"}},a.hoverHCStyle={backgroundColor:"Highlight",color:"HighlightText"},a.mainButtonStyle={root:{backgroundColor:Yt.a.gray30,border:"none",outline:"none",height:"30px",minWidth:"32px",padding:"5px 1px 5px 1px",cursor:"default"},rootHovered:(n={backgroundColor:Yt.a.gray40},n[V.m]=a.hoverHCStyle,n),splitButtonContainerHovered:(o={backgroundColor:Yt.a.gray40},o[V.m]=a.hoverHCStyle,o),splitButtonMenuButton:{border:"none",outline:"none",width:"8px",cursor:"default",":hover":(r={backgroundColor:Yt.a.gray40},r[V.m]=a.hoverHCStyle,r)},splitButtonDivider:{width:"0px"},splitButtonContainer:{":hover, :active, :focus, :focus::after":(i={},i[V.m]={border:"2px dashed ButtonText !important",outline:"none !important"},i)}},a.state={currentBorderOption:t.defaultBorderOption||jt.NoBorder,color:t.defaultColor||a.defaultBorderColor,themeColor:void 0,lineStyle:null},a.onRenderBorderOptionsSection=a.onRenderBorderOptionsSection.bind(a),a.onBorderOptionSelectedFromMenu=a.onBorderOptionSelectedFromMenu.bind(a),a.onDefaultBorderOptionSelected=a.onDefaultBorderOptionSelected.bind(a),a.onBorderOptionSelected=a.onBorderOptionSelected.bind(a),a.renderColorMenuButton=a.renderColorMenuButton.bind(a),a.onColorChanged=a.onColorChanged.bind(a),a.onRenderLineStyleIcon=a.onRenderLineStyleIcon.bind(a),a.onLineStyleSelected=a.onLineStyleSelected.bind(a),a.onColorMenuOpened=a.onColorMenuOpened.bind(a),a.getSupportedLineStyles=a.getSupportedLineStyles.bind(a);var s=[];s.push({key:"BorderMenuBorderOptionsSection",itemType:Jt.a.Section,sectionProps:{bottomDivider:!0,items:[{key:"BorderMenuBorderOptionsSection",onRender:a.onRenderBorderOptionsSection}]}}),s.push({key:"BorderMenuBorderColorSection",itemType:Jt.a.Section,sectionProps:{items:[{key:"BorderMenuBorderColorSectionItem",onRender:a.renderColorMenuButton}]}});var l=a.getSupportedLineStyles();return l&&l.length>0&&s.push({key:"BorderMenuBorderLineStyleSection",itemType:Jt.a.Section,sectionProps:{items:[{key:"BorderMenuBorderLineStyleSection",iconProps:{iconName:d.a.DashStyle_16,styles:{root:{margin:"0px"}}},text:ExcelRibbonStrings.BorderLineStyle,role:"button",subMenuProps:{items:l,calloutProps:{calloutWidth:128}},submenuIconProps:{iconName:Object(F.a)()?c.a.CommonControlChevronLeft_12:c.a.CommonControlChevronRight_12,style:{width:"12px",height:"12px",lineHeight:"12px"}},itemProps:{styles:{root:{cursor:"default"},label:{fontSize:"12px",marginLeft:"10px"}}},componentRef:a.lineStyleMenuRef}]}}),a.menuProps={items:s,styles:a.menuSectionStyles,focusZoneProps:{direction:Zt.a.bidirectional}},a.gallerySections=[{galleryButtons:a.getSupportedBorderOptions(t.supportedBorderOptions)}],a}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Z.a,{content:ExcelRibbonStrings.Borders,directionalHint:Y.a.bottomCenter},O.createElement(rn.a,{split:!0,"aria-label":ExcelRibbonStrings.Borders,"aria-roledescription":ExcelRibbonStrings.SplitButtonRoleDescription,styles:this.mainButtonStyle,iconProps:un.get(this.state.currentBorderOption).fullIconProps,menuProps:this.menuProps,menuIconProps:this.caretDownIconProps,onClick:this.onDefaultBorderOptionSelected}))},t.prototype.onRenderBorderOptionsSection=function(e,t){return this.dismissMenu=t,O.createElement(pn.a,{columns:5,type:"AppIconFullGalleryProps",defaultWidth:212,onGalleryButtonExecute:this.onBorderOptionSelectedFromMenu,id:"BorderMenuBorderOptionsGallery",getGalleryButtonComponent:hn.a,gallerySections:this.gallerySections})},t.prototype.onRenderLineStyleIcon=function(e){var t,n=this.state.lineStyle?e.key===this.state.lineStyle:0===e.itemIndex;return O.createElement($t.a,{id:e.key,type:"AppButtonProps",label:e.iconTitle,hideLabel:!0,icon:e.iconName,onExecute:this.onLineStyleSelected,styles:{root:(t={border:"none",backgroundColor:n?Yt.a.gray20:void 0},t[V.m]={background:n?"Highlight":void 0,fill:n?"HighlightText":void 0,svg:{color:n?"HighlightText !important":void 0,fill:n?"HighlightText !important":void 0}},t.margin="4px",t.padding="0px",t),icon:{width:"120px",height:"20px"}}})},t.prototype.onBorderOptionSelectedFromMenu=function(e){this.onBorderOptionSelected(this.gallerySections[0].galleryButtons[e.galleryButton.index].index)},t.prototype.onBorderOptionSelected=function(e){this.dismissMenu(),this.setState({currentBorderOption:e}),this.props.onBorderOptionSelected(e,this.state.lineStyle,this.state.color,this.state.themeColor)},t.prototype.onDefaultBorderOptionSelected=function(){this.onBorderOptionSelected(this.state.currentBorderOption)},t.prototype.onColorChanged=function(e,t){this.setState({color:e||this.defaultBorderColor,themeColor:t}),this.dismissMenu()},t.prototype.onLineStyleSelected=function(e){this.setState({lineStyle:e.id}),this.dismissMenu()},t.prototype.renderColorMenuButton=function(){return O.createElement(nn,{buttonIconName:d.a.TableBorderColorSplitDropdown_20,buttonLabel:ExcelRibbonStrings.BorderColor,colorPickerController:this.props.colorPickerController,modifiers:{automaticColor:!0,clearColor:!1,highlightWhen:!1,moreColors:!0},selectedColor:this.state.color,defaultColor:this.defaultBorderColor,onChange:this.onColorChanged,isSubMenuButton:!0,onSubMenuOpened:this.onColorMenuOpened})},t.prototype.getSupportedBorderOptions=function(e){var t=[];return un.forEach((function(n,o){e&&-1===e.indexOf(o)||t.push(n)})),t},t.prototype.getSupportedLineStyles=function(){if(!this.props.borderMenuController)return[];var e=this.props.borderMenuController.getBorderLineStyleProps();if(!e)return i.a.sendTraceTag(540645599,a.a.msoulscat_ES_EWAJS,s.a.Error,"BorderMenuButton: getBorderLineStyleProps returned null."),[];for(var t=[],n=0;n<e.length;n++)null!=this.props.supportedLineStyles&&-1===this.props.supportedLineStyles.indexOf(e[n].key)||t.push({itemIndex:t.length,key:e[n].key,iconTitle:e[n].title||void 0,iconName:e[n].iconName,onRender:this.onRenderLineStyleIcon});return t},t.prototype.onColorMenuOpened=function(){var e;null===(e=this.lineStyleMenuRef.current)||void 0===e||e.dismissSubMenu()},t}(O.Component),mn=function(e){function t(t){var n=e.call(this,t)||this;return n.cfSupportedBorderTypes=[jt.NoBorder,jt.BottomBorder,jt.TopBorder,jt.LeftBorder,jt.RightBorder,jt.OutsideBorders,jt.TopAndBottomBorders],n.cfSupportedLineStyles=["BorderStyleSolidLine","BorderStyleDashedLine","BorderStyleDottedLine"],n.formatButtonStyle={root:{height:"30px",width:"24px",maxWidth:"24px",padding:"1px",marginLeft:"1px",selectors:{":hover":{background:"#E1DFDD"}}},rootChecked:{background:"#E1DFDD"},icon:{height:"18px",width:"18px"}},n.getFormatDropdown=n.getFormatDropdown.bind(n),n.getCustomFormatPanel=n.getCustomFormatPanel.bind(n),n.renderToggleButton=n.renderToggleButton.bind(n),n.renderToggleButtons=n.renderToggleButtons.bind(n),n.renderColorPickerButtons=n.renderColorPickerButtons.bind(n),n.renderPreview=n.renderPreview.bind(n),n.renderBorderButton=n.renderBorderButton.bind(n),n.onDropdownOptionChanged=n.onDropdownOptionChanged.bind(n),n.onCustomFormatChanged=n.onCustomFormatChanged.bind(n),n.onFontColorChanged=n.onFontColorChanged.bind(n),n.onBackgroundColorChanged=n.onBackgroundColorChanged.bind(n),n.onBoldButtonClicked=n.onBoldButtonClicked.bind(n),n.onItalicButtonClicked=n.onItalicButtonClicked.bind(n),n.onTextUnderlinedButtonClicked=n.onTextUnderlinedButtonClicked.bind(n),n.onTextDoubleUnderlinedButtonClicked=n.onTextDoubleUnderlinedButtonClicked.bind(n),n.onTextStrikethroughButtonClicked=n.onTextStrikethroughButtonClicked.bind(n),n.onBorderChanged=n.onBorderChanged.bind(n),n.getDefaultBorderColor=n.getDefaultBorderColor.bind(n),n.getLineStyle=n.getLineStyle.bind(n),n.defaultSelectedBorderColor=n.getDefaultBorderColor(),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{marginTop:"12px"}},this.getFormatDisplayComponents())},t.prototype.getFormatDisplayComponents=function(){return O.createElement("div",null,this.getFormatDropdown(),this.getCustomFormatPanel())},t.prototype.getFormatDropdown=function(){return O.createElement(qt,{selectedFormat:this.props.selectedFormat,onChange:this.onDropdownOptionChanged})},t.prototype.getCustomFormatPanel=function(){return Object(Re.h)("HighlightWhenNewPaneExperiment")&&6!==this.props.selectedFormat.getQuickFormat()?O.createElement("div",{style:{height:"20px"}}):O.createElement("div",{style:{marginTop:"12px"}},O.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},this.renderToggleButtons(),this.renderColorPickerButtons(),this.renderBorderButton()),this.renderPreview())},t.prototype.renderToggleButtons=function(){return O.createElement(O.Fragment,null,this.renderToggleButton("ConditionalFormattingFormatInputBoldButton",ExcelRibbonStrings.Bold,h.a.Bold_20,this.props.selectedFormat.getSelectedFormat().isTextBold,this.onBoldButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputItalicButton",ExcelRibbonStrings.Italic,h.a.Italic_20,this.props.selectedFormat.getSelectedFormat().isTextItalic,this.onItalicButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputUnderlineButton",ExcelRibbonStrings.Underline,h.a.Underline_20,this.props.selectedFormat.getSelectedFormat().isTextUnderlined,this.onTextUnderlinedButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputDoubleUnderlineButton",ExcelRibbonStrings.DoubleUnderline,h.a.DoubleUnderline_20,this.props.selectedFormat.getSelectedFormat().isTextDoubleUnderlined,this.onTextDoubleUnderlinedButtonClicked),this.renderToggleButton("ConditionalFormattingFormatInputStrikethroughButton",ExcelRibbonStrings.Strikethrough,h.a.Strikethrough2_20,this.props.selectedFormat.getSelectedFormat().isTextStrikethrough,this.onTextStrikethroughButtonClicked))},t.prototype.renderToggleButton=function(e,t,n,o,r){return O.createElement(on.a,{type:"AppToggleButtonProps",useLegacyButton:!0,id:e,styles:this.formatButtonStyle,hideLabel:!0,label:ExcelRibbonStrings.ConditionalFormatWithMenuPrefix+t,icon:n,toggled:o,onExecute:r,customTooltip:t})},t.prototype.renderColorPickerButtons=function(){return O.createElement("span",null,O.createElement(nn,{buttonIconName:h.a.FillColorSplitDropdown_20,buttonLabel:ExcelRibbonStrings.FillColor,colorPickerController:M.getColorPickerButtonController(),modifiers:{automaticColor:!1,clearColor:!0,highlightWhen:!1,moreColors:!0},selectedColor:this.props.selectedFormat.getSelectedFormat().backgroundColor||null,defaultColor:"transparent",onChange:this.onBackgroundColorChanged}),O.createElement(nn,{buttonIconName:h.a.FontColor_20,buttonLabel:ExcelRibbonStrings.FontColor,colorPickerController:M.getColorPickerButtonController(),modifiers:{automaticColor:!0,clearColor:!1,highlightWhen:!1,moreColors:!0},selectedColor:this.props.selectedFormat.getSelectedFormat().textColor||null,defaultColor:"#000000",onChange:this.onFontColorChanged}))},t.prototype.renderPreview=function(){return O.createElement(fe,{rule:{ruleType:3,customFormat:this.props.selectedFormat.getSelectedFormat()},style:{height:"33px",lineHeight:"33px",width:"100%",marginTop:"12px",fontSize:"20px"}})},t.prototype.renderBorderButton=function(){return O.createElement(gn,{defaultColor:this.defaultSelectedBorderColor,colorPickerController:M.getColorPickerButtonController(),borderMenuController:M.getBorderMenuController(),supportedBorderOptions:this.cfSupportedBorderTypes,supportedLineStyles:this.cfSupportedLineStyles,onBorderOptionSelected:this.onBorderChanged})},t.prototype.onDropdownOptionChanged=function(e){var t=this.props.selectedFormat;t.setQuickFormat(e),this.props.onChange(t)},t.prototype.onCustomFormatChanged=function(e){var t=this.props.selectedFormat;t.setCustomFormat(e),this.props.onChange(t)},t.prototype.onFontColorChanged=function(e,t){var n=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());n.textColor=e,n.textColorThemeInfo=t,n.preserveTextColor=!1,this.onCustomFormatChanged(n)},t.prototype.onBackgroundColorChanged=function(e,t){var n=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());n.backgroundColor=e,n.backgroundColorThemeInfo=t,n.preserveBackgroundColor=!1,n.gradientFill=null,this.onCustomFormatChanged(n)},t.prototype.onBoldButtonClicked=function(){var e=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());e.isTextBold=!e.isTextBold,this.onCustomFormatChanged(e)},t.prototype.onItalicButtonClicked=function(){var e=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());e.isTextItalic=!e.isTextItalic,this.onCustomFormatChanged(e)},t.prototype.onTextUnderlinedButtonClicked=function(){var e=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());e.isTextUnderlined?e.isTextUnderlined=!1:(e.isTextUnderlined=!0,e.isTextDoubleUnderlined=!1),this.onCustomFormatChanged(e)},t.prototype.onTextDoubleUnderlinedButtonClicked=function(){var e=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());e.isTextDoubleUnderlined?e.isTextDoubleUnderlined=!1:(e.isTextDoubleUnderlined=!0,e.isTextUnderlined=!1),this.onCustomFormatChanged(e)},t.prototype.onTextStrikethroughButtonClicked=function(){var e=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());e.isTextStrikethrough=!e.isTextStrikethrough,this.onCustomFormatChanged(e)},t.prototype.onBorderChanged=function(e,t,n,o){var r,i,a,s=Object(k.__assign)({},this.props.selectedFormat.getSelectedFormat());s.borderFormat?s.borderFormat={position:s.borderFormat.position,lineStyle:null===(r=s.borderFormat.lineStyle)||void 0===r?void 0:r.slice(),color:null===(i=s.borderFormat.color)||void 0===i?void 0:i.slice(),themeColor:(null===(a=s.borderFormat.themeColor)||void 0===a?void 0:a.slice())||[null,null,null,null]}:s.borderFormat=me(),this.setBorderFormatProperties(s.borderFormat,e,t,n,o),this.onCustomFormatChanged(s)},t.prototype.setBorderFormatProperties=function(e,t,n,o,r){var l=this.getLineStyle(n);switch(t){case jt.NoBorder:e.position=ce.AllBorders,e.lineStyle=[0,0,0,0],e.color=["#000000","#000000","#000000","#000000"],e.themeColor=[null,null,null,null];break;case jt.BottomBorder:e.position=e.position|ce.Bottom,this.setBorderProperties(e,le.Bottom,l,o,r);break;case jt.TopBorder:e.position=e.position|ce.Top,this.setBorderProperties(e,le.Top,l,o,r);break;case jt.LeftBorder:e.position=e.position|ce.Left,this.setBorderProperties(e,le.Left,l,o,r);break;case jt.RightBorder:e.position=e.position|ce.Right,this.setBorderProperties(e,le.Right,l,o,r);break;case jt.OutsideBorders:e.position=ce.AllBorders,e.lineStyle=[l,l,l,l],e.color=[o,o,o,o],e.themeColor=[r,r,r,r];break;case jt.TopAndBottomBorders:e.position=e.position|ce.Top|ce.Bottom,this.setBorderProperties(e,le.Top,l,o,r),this.setBorderProperties(e,le.Bottom,l,o,r);break;default:i.a.sendTraceTag(541193945,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingFormatInput.setBorderProperties: Unsupported BorderOptionType.")}},t.prototype.setBorderProperties=function(e,t,n,o,r){e.lineStyle[t]=n,e.color[t]=o,e.themeColor[t]=r},t.prototype.getLineStyle=function(e){if(null==e)return 1;switch(e){case"BorderStyleSolidLine":return 1;case"BorderStyleDashedLine":return 3;case"BorderStyleDottedLine":return 4}return i.a.sendTraceTag(540553687,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingFormatInput.setBorderProperties: Unsupported line style type."),1},t.prototype.getDefaultBorderColor=function(){var e=this.props.selectedFormat.getSelectedFormat().borderFormat;if(e&&e.color&&e.lineStyle){if(0!==e.lineStyle[le.Top])return e.color[le.Top]||void 0;if(0!==e.lineStyle[le.Bottom])return e.color[le.Bottom]||void 0;if(0!==e.lineStyle[le.Left])return e.color[le.Left]||void 0;if(0!==e.lineStyle[le.Right])return e.color[le.Right]||void 0}},t}(O.Component),fn=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:"ConditionalFormatting.RuleEditor.CellValueDropdown",options:bn,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingOperatorDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(O.Component),bn=[{key:1,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueGreaterThan},{key:2,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueLessThan},{key:3,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueBetween},{key:4,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueEqualTo},{key:68,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueGreaterThanOrEqualsTo},{key:69,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueLessThanOrEqualsTo},{key:70,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueNotBetween},{key:71,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueNotEqualTo}],vn=function(e){function t(t){var n=e.call(this,t)||this;return n.onCellValueChange=n.onCellValueChange.bind(n),n.onFirstValueChange=n.onFirstValueChange.bind(n),n.onSecondValueChange=n.onSecondValueChange.bind(n),n.getCellValueInputContent=n.getCellValueInputContent.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.getCellValueDropdown(),O.createElement("div",{style:{marginTop:"4px"}},this.getCellValueInputContent()))},t.getCellValueFormulaFirstElementId=function(e){return e?M.getRequiredFirstPaneElementId():"CellValueRuleInput"},t.prototype.getCellValueDropdown=function(){return O.createElement(fn,{selectedKey:this.props.ruleInputData.getCommandType(),onChange:this.onCellValueChange})},t.prototype.getCellValueInputContent=function(){return this.props.ruleInputData.isTwoInputValuesRuleType()?O.createElement("div",{style:{display:"flex",flexDirection:"row"}},O.createElement("div",{style:{flexGrow:1,width:"100%"}},this.getCellValueInputComponent(0,this.onFirstValueChange,ExcelRibbonStrings.ConditionalFormattingFormula1TextBox,t.getCellValueFormulaFirstElementId(this.props.isNewRule))),this.getTwoInputValuesLabel(),O.createElement("div",{style:{flexGrow:1,width:"100%"}},this.getCellValueInputComponent(1,this.onSecondValueChange,ExcelRibbonStrings.ConditionalFormattingFormula2TextBox,"CellValueRuleSecondInput","CellValueTwoInputTextField"))):this.getCellValueInputComponent(0,this.onFirstValueChange,ExcelRibbonStrings.ConditionalFormattingFormulaTextBox,t.getCellValueFormulaFirstElementId(this.props.isNewRule))},t.prototype.getTwoInputValuesLabel=function(){var e={root:{height:"14px",fontSize:"12px",padding:"9px",flexShrink:0}};return O.createElement(Ge.a,{styles:e},ExcelRibbonStrings.ConditionalFormattingHighlightCellValueBetweenAnd)},t.prototype.getCellValueInputComponent=function(e,t,n,o,r){void 0===r&&(r="CellValueTextField");var i=this.props.ruleInputData.getErrorIfNeeded()[e],a=o+"CellValueRuleError";return O.createElement("div",{"aria-labelledby":"ConditionalFormatting.RuleEditor.CellValueDropdown "+a},O.createElement(ie,{id:o,name:r,autoApply:!0,value:this.props.ruleInputData.getRuleInputValue()[e],sheetName:this.props.sheetName,styles:Q(null===i),onChange:t,onCancelChanges:t,error:i||void 0,ariaLabel:n}))},t.prototype.onFirstValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue([e,t.getRuleInputValue()[1]]),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onSecondValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue([t.getRuleInputValue()[0],e]),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onCellValueChange=function(e){var t=this.props.ruleInputData,n=new Et(e,t.getRuleInputValue()[0],t.getRuleInputValue()[1]);n.setWasChanged(),this.props.onInputChange(n)},t}(O.Component),yn=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:"ConditionalFormatting.RuleEditor.DateOccurringDropdown",options:xn,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingDateDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(O.Component),xn=[{key:1,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateYesterday},{key:0,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateToday},{key:6,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateTomorrow},{key:2,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateLast7Days},{key:4,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateLastWeek},{key:3,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateThisWeek},{key:7,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateNextWeek},{key:5,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateLastMonth},{key:9,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateThisMonth},{key:8,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateNextMonth}],Cn=function(e){function t(t){var n=e.call(this,t)||this;return n.onDateOccurringValueChange=n.onDateOccurringValueChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(yn,{selectedKey:this.props.ruleInputData.getRuleInputValue(),onChange:this.onDateOccurringValueChange})},t.prototype.onDateOccurringValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t}(O.Component),Sn=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:"ConditionalFormatting.RuleEditor.HighlightCellsWithDropdown",options:En,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingValueDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(O.Component),En=[{key:ft.CellValue,text:ExcelRibbonStrings.ConditionalFormattingHighlightWithCellValue},{key:ft.SpecificText,text:ExcelRibbonStrings.ConditionalFormattingHighlightSpecificText},{key:ft.DateOccurring,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateOccurring},{key:ft.DuplicateValues,text:ExcelRibbonStrings.ConditionalFormattingHighlightDuplicateValues},{key:ft.UniqueValues,text:ExcelRibbonStrings.ConditionalFormattingHighlightDuplicateValuesUnique},{key:ft.Blanks,text:ExcelRibbonStrings.ConditionalFormattingHighlightBlanks},{key:ft.NoBlanks,text:ExcelRibbonStrings.ConditionalFormattingHighlightNoBlanks},{key:ft.Errors,text:ExcelRibbonStrings.ConditionalFormattingHighlightErrors},{key:ft.NoErrors,text:ExcelRibbonStrings.ConditionalFormattingHighlightNoErrors}],kn=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Bt,{id:"ConditionalFormatting.RuleEditor.SpecificTextDropdown",options:On,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingOperatorDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(O.Component),On=[{key:5,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextContaining},{key:72,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextNotContaining},{key:73,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextBeginningWith},{key:74,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextEndingWith}],Tn=function(e){function t(t){var n=e.call(this,t)||this;return n.onSpecificTextChange=n.onSpecificTextChange.bind(n),n.onTextValueChange=n.onTextValueChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.getSpecificTextDropdown(),O.createElement("div",{style:{marginTop:"4px"}},this.getTextField(this.props.ruleInputData.getRuleInputValue(),this.onTextValueChange)))},t.prototype.getSpecificTextDropdown=function(){return O.createElement(kn,{selectedKey:this.props.ruleInputData.getCommandType(),onChange:this.onSpecificTextChange})},t.prototype.getTextField=function(e,t){var n=this.props.ruleInputData.getErrorIfNeeded();return O.createElement("div",{"aria-labelledby":"ConditionalFormatting.RuleEditor.SpecificTextDropdown ConditionalFormattingSpecificTextRuleError"},O.createElement(ie,{id:this.props.isNewRule?M.getRequiredFirstPaneElementId():"TextRuleValueInput",name:"SpecificTextTextField",autoApply:!0,value:e,sheetName:this.props.sheetName,styles:Q(null===n),onChange:t,onCancelChanges:t,error:n||void 0,ariaLabel:ExcelRibbonStrings.ConditionalFormattingTextBoxName}))},t.prototype.onTextValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onSpecificTextChange=function(e){var t=this.props.ruleInputData,n=new St(e,t.getRuleInputValue());n.setWasChanged(),this.props.onInputChange(n)},t}(O.Component),In=function(e){function t(t){var n=e.call(this,t)||this;return n.getHighlightCellsWithInputContent=n.getHighlightCellsWithInputContent.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},O.createElement("div",{style:{marginTop:"4px"}},this.getHighlightCellsWithDropdown(),O.createElement("div",{style:{marginTop:"4px"}},this.getHighlightCellsWithInputContent())))},t.prototype.getHighlightCellsWithDropdown=function(){return O.createElement(Sn,{selectedKey:this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType()),onChange:this.props.onHighlightCellsWithChange})},t.prototype.getHighlightCellsWithInputContent=function(){switch(this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType())){case ft.CellValue:return O.createElement(vn,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,sheetName:this.props.sheetName});case ft.SpecificText:return O.createElement(Tn,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,sheetName:this.props.sheetName});case ft.DateOccurring:return O.createElement(Cn,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case ft.DuplicateValues:case ft.UniqueValues:case ft.Blanks:case ft.NoBlanks:case ft.Errors:case ft.NoErrors:return O.createElement("div",null)}},t.prototype.getHighlightCellsWithOption=function(e){switch(e){case 1:case 2:case 4:case 3:case 68:case 69:case 71:case 70:return ft.CellValue;case 5:case 72:case 73:case 74:return ft.SpecificText;case 6:return ft.DateOccurring;case 7:return!0===this.props.ruleInputData.getRuleInputValue()?ft.DuplicateValues:ft.UniqueValues;case 64:return ft.Blanks;case 65:return ft.NoBlanks;case 66:return ft.Errors;case 67:return ft.NoErrors;default:throw Error("getHighlightCellsWithOption: Unsupported ConditionalFormattingCommandType")}},t}(O.Component),wn=n(699),_n=n(267),Pn="conditionalFormatting-GalleryDropdownBlockItem-",Rn=function(e){function t(t){var n=e.call(this,t)||this;return n.onInnerItemClick=n.onInnerItemClick.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e,t,n,o=Pn+this.props.commandType,r={root:{cursor:"pointer",display:"flex",border:"none",padding:"3px",outline:"none",height:"auto",width:this.props.width?this.props.width:void 0,minWidth:"auto",justifyContent:this.props.justifyContent?this.props.justifyContent:"center",backgroundColor:this.props.selectedItemId===o?"rgb(237, 235, 233)":"unset",selectors:(e={":focus::after":{outline:"none",border:"none"},":focus,:focus-within,:active":(t={},t[V.m]={background:"Highlight"},t)},e[V.m]={border:"none"},e)},flexContainer:{width:"100%"},rootHovered:(n={backgroundColor:"rgb(243, 242, 241)"},n[V.m]={background:"Highlight"},n)};return O.createElement(Z.a,{content:this.props.hideTooltip?void 0:this.props.text,directionalHint:Y.a.bottomCenter},O.createElement(rn.a,{id:o,styles:r,onClick:this.onInnerItemClick,ariaLabel:this.props.text+(this.props.blockLabel||"")},this.props.data))},t.prototype.onInnerItemClick=function(){this.props.onItemClick(this.props.commandType)},t}(O.Component),Dn=n(2342),jn=function(e){function t(t){var n=e.call(this,t)||this;return n.getItemRowsGenerator=function(e,t){var n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:n=0,o.label=1;case 1:return n<e.length?[4,e.slice(n,n+t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n+=t,[3,1];case 4:return[2]}}))},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.props.itemsNumberInLine<1)throw new Error("itemsNumberInLine is less than 1");var t={content:{},root:{padding:"4px 0px 0px 0px",marginBottom:"-4px",selectors:{"::before":{backgroundColor:"#d2d0ce"}}}};return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.props.label?O.createElement(Ge.a,{"aria-label":this.props.label},this.props.label):O.createElement("div",null),this.getItemRows(this.props.itemsProps,this.props.itemsNumberInLine).map((function(t,n){return O.createElement("div",{key:n,style:{display:"flex",justifyContent:"space-between",flexDirection:"row",marginTop:"4px"}},t.map((function(t,o){return O.createElement(Rn,Object(k.__assign)({},t,{blockLabel:e.props.label,key:n+"."+o}))})))})),this.props.seperatorAfterBlock?O.createElement(Dn.a,{styles:t}):O.createElement("div",null))},t.prototype.getItemRows=function(e,t){var n=this.getItemRowsGenerator(e,t),o=[];if(n)for(var r=n.next();!r.done;)o.push(r.value),r=n.next();return o},t}(O.Component),Bn=function(e){function t(t){var n=e.call(this,t)||this;return n.dismissCallout=function(){},n.populateMenu=function(e,t){n.dismissCallout=t;var o=e.props;return O.createElement(wn.a,{role:"dialog",target:".".concat(o.buttonArea),style:{display:"flex"},styles:{root:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 3.2px 7.2px 0px, rgba(0, 0, 0, 0.11) 0px 0.6px 1.8px 0px",backgroundColor:"white",width:"285px",maxHeight:"285px",overflowY:"auto"}},directionalHint:Y.a.bottomCenter,isBeakVisible:!1,tabIndex:-1,onKeyDown:n.onKeyDown,onKeyDownCapture:n.onKeyDownCapture,setInitialFocus:!0,onFocus:n.setFocus},O.createElement("div",{onClick:t,role:"list",id:"ConditionalFormattingGalleryDropdownBlockList",style:{display:"flex",flexDirection:"column",justifyContent:"space-between",overflowX:"hidden",overflowY:"hidden",width:"270px",margin:"8px"}},n.props.itemsDropdownBlocksProps.map((function(e){return O.createElement(jn,Object(k.__assign)({},e,{key:e.id}))}))))},n.setFocus=function(e){var t;Object(_n.a)(e.currentTarget,e.relatedTarget)||null===(t=document.getElementById(n.props.selectedItem.id))||void 0===t||t.focus()},n.getBlock=function(e){return n.props.itemsDropdownBlocksProps[e]},n.getItem=function(e){return n.getBlock(e.blockIndex).itemsProps[e.itemIndexInBlock]},n.onKeyDown=n.onKeyDown.bind(n),n.populateMenu=n.populateMenu.bind(n),n.onKeyDownCapture=n.onKeyDownCapture.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e,t={root:Object(k.__assign)(Object(k.__assign)({},J),{fontSize:"12px",fontWeight:"normal",height:"24px",border:"none",textAlign:"left",padding:"0px",paddingTop:"5px",cursor:"pointer",selectors:{":active":{outline:"none",border:"none"},":focus":{outline:"none",border:"none"},":focus::after":{outline:"none",border:"none"}}})},n={height:"28px",width:"285px",cursor:"pointer",padding:"0px",paddingRight:Object(F.a)()?"0px":"3px",paddingLeft:Object(F.a)()?"3px":"0px",selectors:(e={":focus::after":{outline:"none",border:"none"},"svg > path.OfficeIconColors_HighContrast":{fill:"buttonText !important"}},e[V.m]={color:"unset !important",borderColor:"unset !important"},e)},o={root:n,rootHovered:[n,Object(k.__assign)(Object(k.__assign)({},G()),{background:"white"})],rootExpanded:[n,Object(k.__assign)(Object(k.__assign)({},G()),{background:"white"})],rootFocused:[n,K(!0,!0)],rootPressed:[n,Object(k.__assign)(Object(k.__assign)({},G()),{background:"white"})],menuIcon:{height:"14px",width:"12px"}},r=Object(V.db)({buttonArea:{height:"28px"}});return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},O.createElement("div",{className:r.buttonArea},O.createElement(rn.a,{role:"combobox listbox",styles:o,menuProps:{items:[{key:"ConditionalFormattingGalleryDropdownMenuItem",onRender:this.populateMenu,props:r}]},menuIconProps:{iconName:W.a.CommonControlChevronDown_12},ariaLabel:ExcelRibbonStrings.ConditionalFormattingFormatDropdownType},O.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"left",paddingLeft:"8px",height:"28px",width:"255px"}},this.props.selectedItem.preview?O.createElement("div",{style:{marginTop:"5px",marginRight:"8px"}},this.props.selectedItem.preview):O.createElement("div",null),O.createElement(Ge.a,{id:this.props.id+"-label",styles:t,tabIndex:-1,"data-is-focusable":!1},this.props.selectedItem.text)))))},t.prototype.onKeyDown=function(e){if(document.activeElement){var t=document.activeElement.id,n=void 0,o=null;switch(e.keyCode){case z.a.up:n=this.getItemIdToFocus(t,dn.up),e.preventDefault();break;case z.a.down:n=this.getItemIdToFocus(t,dn.down),e.preventDefault();break;case z.a.right:n=this.getItemIdToFocus(t,Object(F.a)()?dn.prev:dn.next),e.preventDefault();break;case z.a.left:n=this.getItemIdToFocus(t,Object(F.a)()?dn.next:dn.prev),e.preventDefault();break;case z.a.tab:n=e.shiftKey?this.props.prevFocusableElementId:this.props.nextFocusableElementId,e.preventDefault()}n&&(o=document.getElementById(n))&&o.focus()}else i.a.sendTraceTag(573415824,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingTaskPaneReact.GalleryDropdown: couldn't find  activeElement")},t.prototype.onKeyDownCapture=function(e){e.keyCode===z.a.escape&&this.dismissCallout()},t.prototype.getItemIdToFocus=function(e,n){var o=this.getItemPosition(e,this.props.selectedItem.id);if(o)switch(n){case dn.down:return this.getLineDownItemId(o);case dn.up:return this.getLineUpItemId(o);case dn.prev:var r=this.getItem(this.getPrevItemPosition(o));return t.getItemIdFromCommand(r.commandType);case dn.next:var s=this.getItem(this.getNextItemPosition(o));return t.getItemIdFromCommand(s.commandType)}return i.a.shipAssertTag(573413458,a.a.msoulscat_ES_EWAJS,!1,"currentItemId not found in the GalleryDropdown items. ID: "+e),this.props.selectedItem.id},t.prototype.getItemPosition=function(e,n){for(var o=null,r=0;r<this.props.itemsDropdownBlocksProps.length;r+=1)for(var i=this.props.itemsDropdownBlocksProps[r],a=0;a<i.itemsProps.length;a+=1){var s=i.itemsProps[a],l=t.getItemIdFromCommand(s.commandType);if(l===e)return{blockIndex:r,itemIndexInBlock:a};l===n&&(o={blockIndex:r,itemIndexInBlock:a})}return o},t.prototype.getNextItemPosition=function(e){var t=this.getBlock(e.blockIndex).itemsProps.length,n=this.props.itemsDropdownBlocksProps.length;return e.itemIndexInBlock+1>=t?{blockIndex:(e.blockIndex+1)%n,itemIndexInBlock:0}:{blockIndex:e.blockIndex,itemIndexInBlock:e.itemIndexInBlock+1}},t.prototype.getPrevItemPosition=function(e){var t=this.props.itemsDropdownBlocksProps.length,n=(t+e.blockIndex-1)%t,o=this.props.itemsDropdownBlocksProps[n].itemsProps.length;return e.itemIndexInBlock-1<0?{blockIndex:n,itemIndexInBlock:o-1}:{blockIndex:e.blockIndex,itemIndexInBlock:e.itemIndexInBlock-1}},t.getItemIdFromCommand=function(e){return Pn+e},t.prototype.getLineDownItemId=function(e){var n,o=this.props.itemsDropdownBlocksProps[e.blockIndex],r=e.itemIndexInBlock%o.itemsNumberInLine+1,i=o.itemsProps.length/o.itemsNumberInLine===Math.floor(o.itemsProps.length/o.itemsNumberInLine),a=Math.floor(o.itemsProps.length/o.itemsNumberInLine);if(a=i?a-1:a,Math.floor(e.itemIndexInBlock/o.itemsNumberInLine)!==a)n=e.itemIndexInBlock+o.itemsNumberInLine<=o.itemsProps.length-1?t.getItemIdFromCommand(o.itemsProps[e.itemIndexInBlock+o.itemsNumberInLine].commandType):t.getItemIdFromCommand(o.itemsProps[o.itemsProps.length-1].commandType);else{var s=e.blockIndex===this.props.itemsDropdownBlocksProps.length-1?0:e.blockIndex+1,l=this.props.itemsDropdownBlocksProps[s];n=r<=l.itemsProps.length?t.getItemIdFromCommand(l.itemsProps[r-1].commandType):t.getItemIdFromCommand(l.itemsProps[l.itemsProps.length-1].commandType)}return n},t.prototype.getLineUpItemId=function(e){var n,o=this.props.itemsDropdownBlocksProps[e.blockIndex],r=e.itemIndexInBlock%o.itemsNumberInLine+1;if(e.itemIndexInBlock-o.itemsNumberInLine>=0)n=t.getItemIdFromCommand(o.itemsProps[e.itemIndexInBlock-o.itemsNumberInLine].commandType);else{var i=0===e.blockIndex?this.props.itemsDropdownBlocksProps.length-1:e.blockIndex-1,a=this.props.itemsDropdownBlocksProps[i],s=a.itemsProps.length/a.itemsNumberInLine===Math.floor(a.itemsProps.length/a.itemsNumberInLine),l=Math.floor(a.itemsProps.length/a.itemsNumberInLine);n=(l=s?l-1:l)*a.itemsNumberInLine+r<a.itemsProps.length?t.getItemIdFromCommand(a.itemsProps[l*a.itemsNumberInLine+r-1].commandType):t.getItemIdFromCommand(a.itemsProps[a.itemsProps.length-1].commandType)}return n},t}(O.Component);!function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.next=2]="next",e[e.prev=3]="prev"}(dn||(dn={}));var Fn=function(e){function t(t){var n=e.call(this,t)||this;return n.onDataBarValueChange=n.onDataBarValueChange.bind(n),n.selectedItem={id:Pn+n.props.ruleInputData.getCommandType(),text:""},n.dataBarQuickFormatCommand=0,n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.ruleInputData.getCommandType();return 0===e&&(this.dataBarQuickFormatCommand=function(e){for(var t=0;t<Gn.length;t+=1)if(Un(e,Gn[t].customFormat))return Gn[t].key;return null}(this.props.ruleInputData.getRuleInputValue())||this.dataBarQuickFormatCommand),this.selectedItem.id=Pn+this.props.ruleInputData.getCommandType(),this.selectedItem.text=Ln.get(e||this.dataBarQuickFormatCommand),this.selectedItem.preview=this.getDataBarFormatPreviewElement(e?function(e){for(var t=0;t<Gn.length;t+=1)if(e===Gn[t].key)return Gn[t].customFormat;return null}(e):this.props.ruleInputData.getRuleInputValue()),O.createElement("div",{style:{marginTop:"4px"}},O.createElement(Bn,{id:"ConditionalFormattingDataBarDropdown",nextFocusableElementId:this.props.nextFocusableElementId,prevFocusableElementId:this.props.prevFocusableElementId,itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))},t.prototype.onDataBarValueChange=function(e){var t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.createItemsDropdownBlockPropsList=function(){var e=[this.getIconItemProps(15,W.a.DataBarBlueGradient_32),this.getIconItemProps(16,W.a.DataBarGreenGradient_32),this.getIconItemProps(17,W.a.DataBarRedGradient_32),this.getIconItemProps(18,W.a.DataBarOrangeGradient_32),this.getIconItemProps(19,W.a.DataBarLightBlueGradient_32),this.getIconItemProps(20,W.a.DataBarPurpleGradient_32)],t={id:"ConditionalFormattingGradientDataBarBlock",label:ExcelRibbonStrings.GradientFill,itemsProps:e,itemsNumberInLine:3},n=[this.getIconItemProps(21,W.a.DataBarBlueSolid_32),this.getIconItemProps(22,W.a.DataBarGreenSolid_32),this.getIconItemProps(23,W.a.DataBarRedSolid_32),this.getIconItemProps(24,W.a.DataBarOrangeSolid_32),this.getIconItemProps(25,W.a.DataBarLightBlueSolid_32),this.getIconItemProps(26,W.a.DataBarPurpleSolid_32)],o=[t,{id:"ConditionalFormattingSolidDataBarBlock",label:ExcelRibbonStrings.SolidFill,itemsProps:n,itemsNumberInLine:3}];if(null!==this.props.ruleInputData.getRuleInputValue()&&0===this.dataBarQuickFormatCommand){var r=this.getItemProps(0,this.getDataBarFormatPreview(),!0);r.justifyContent="left",r.width="100%";var i={id:"ConditionalFormattingPreviewDataBarBlock",itemsProps:[r],itemsNumberInLine:1,seperatorAfterBlock:!0};o.unshift(i)}return o},t.prototype.getIconItemProps=function(e,t){return this.getItemProps(e,this.getItemIconContent(t))},t.prototype.getItemProps=function(e,t,n){void 0===n&&(n=!1);var o=e;return 0!==this.dataBarQuickFormatCommand&&this.dataBarQuickFormatCommand===e&&(o=0),{commandType:o,text:Ln.get(e),data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onDataBarValueChange,hideTooltip:n}},t.prototype.getItemIconContent=function(e){return O.createElement(H.a,{iconName:e,style:{height:"50px",width:"50px"}})},t.prototype.getDataBarFormatPreview=function(){var e=Object(k.__assign)({fontSize:"12px",marginRight:Object(F.a)()?"10px":void 0,marginLeft:Object(F.a)()?void 0:"10px"},J);if(null!=this.props.ruleInputData.getRuleInputValue())return O.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},O.createElement("div",null,this.getDataBarFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),O.createElement("span",{style:e},ExcelRibbonStrings.ConditionalFormattingCustomFormatText));throw new Error("Data bar input value is null")},t.prototype.getDataBarFormatPreviewElement=function(e){return null!=e?O.createElement(fe,{rule:{ruleType:1,dataBarFormat:e}}):O.createElement("div",null)},t}(O.Component),Ln=new Map;Ln.set(0,ExcelRibbonStrings.ConditionalFormattingCustomFormatText),Ln.set(15,ExcelRibbonStrings.ConditionalFormattingDataBarsBlueDataBar),Ln.set(16,ExcelRibbonStrings.ConditionalFormattingDataBarsGreenDataBar),Ln.set(17,ExcelRibbonStrings.ConditionalFormattingDataBarsRedDataBar),Ln.set(18,ExcelRibbonStrings.ConditionalFormattingDataBarsOrangeDataBar),Ln.set(19,ExcelRibbonStrings.ConditionalFormattingDataBarsLightBlueDataBar),Ln.set(20,ExcelRibbonStrings.ConditionalFormattingDataBarsPurpleDataBar),Ln.set(21,ExcelRibbonStrings.ConditionalFormattingDataBarsBlueDataBar),Ln.set(22,ExcelRibbonStrings.ConditionalFormattingDataBarsGreenDataBar),Ln.set(23,ExcelRibbonStrings.ConditionalFormattingDataBarsRedDataBar),Ln.set(24,ExcelRibbonStrings.ConditionalFormattingDataBarsOrangeDataBar),Ln.set(25,ExcelRibbonStrings.ConditionalFormattingDataBarsLightBlueDataBar),Ln.set(26,ExcelRibbonStrings.ConditionalFormattingDataBarsPurpleDataBar);var Mn="#638EC6",An="#63C384",Nn="#FF555A",Wn="#FFB628",Hn="#008AEF",zn="#D6007B",Vn=function(e){return{isGradientFill:e.isGradientFill,borderColor:e.borderColor,fillColor:e.fillColor,isLTRDirection:!0,IsNegativeValuesFillColorCustom:!1,NegativeValuesFillColor:e.fillColor,IsNegativeValuesBorderColorCustom:!1,NegativeValuesBorderColor:e.borderColor,IsShowValueEnabled:!0,AxisColor:"#000000",AxisPositionType:0}},Gn=[{key:15,customFormat:Vn({isGradientFill:!0,borderColor:Mn,fillColor:Mn})},{key:16,customFormat:Vn({isGradientFill:!0,borderColor:An,fillColor:An})},{key:17,customFormat:Vn({isGradientFill:!0,borderColor:Nn,fillColor:Nn})},{key:18,customFormat:Vn({isGradientFill:!0,borderColor:Wn,fillColor:Wn})},{key:19,customFormat:Vn({isGradientFill:!0,borderColor:Hn,fillColor:Hn})},{key:20,customFormat:Vn({isGradientFill:!0,borderColor:zn,fillColor:zn})},{key:21,customFormat:Vn({isGradientFill:!1,borderColor:null,fillColor:Mn})},{key:22,customFormat:Vn({isGradientFill:!1,borderColor:null,fillColor:An})},{key:23,customFormat:Vn({isGradientFill:!1,borderColor:null,fillColor:Nn})},{key:24,customFormat:Vn({isGradientFill:!1,borderColor:null,fillColor:Wn})},{key:25,customFormat:Vn({isGradientFill:!1,borderColor:null,fillColor:Hn})},{key:26,customFormat:Vn({isGradientFill:!1,borderColor:null,fillColor:zn})}];function Un(e,t){return!(!e||!t)&&(e.isGradientFill===t.isGradientFill&&e.borderColor===t.borderColor&&e.fillColor===t.fillColor)}var qn=function(e){function t(t){var n=e.call(this,t)||this;return n.onColorScaleValueChange=n.onColorScaleValueChange.bind(n),n.selectedItem={id:Pn+n.props.ruleInputData.getCommandType(),text:""},n.colorScaleQuickFormatCommand=0,n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.ruleInputData.getCommandType();return 0===e&&(this.colorScaleQuickFormatCommand=function(e){for(var t=0;t<to.length;t+=1)if(no(e,to[t].customFormat))return to[t].key;return null}(this.props.ruleInputData.getRuleInputValue())||this.colorScaleQuickFormatCommand),this.selectedItem.id=Pn+this.props.ruleInputData.getCommandType(),this.selectedItem.text=Qn.get(e||this.colorScaleQuickFormatCommand),this.selectedItem.preview=this.getColorScaleFormatPreviewElement(e?function(e){for(var t=0;t<to.length;t+=1)if(e===to[t].key)return to[t].customFormat;return null}(e):this.props.ruleInputData.getRuleInputValue()),O.createElement("div",{style:{marginTop:"4px"}},O.createElement(Bn,{id:"ConditionalFormattingColorScaleDropdown",nextFocusableElementId:this.props.nextFocusableElementId,prevFocusableElementId:this.props.prevFocusableElementId,itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))},t.prototype.onColorScaleValueChange=function(e){var t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.createItemsDropdownBlockPropsList=function(){var e=[{id:"ConditionalFormattingColorScaleBlock",itemsProps:[this.getIconItemProps(28,W.a.ColorScaleGYR_32),this.getIconItemProps(27,W.a.ColorScaleRYG_32),this.getIconItemProps(29,W.a.ColorScaleGWR_32),this.getIconItemProps(30,W.a.ColorScaleRWG_32),this.getIconItemProps(31,W.a.ColorScaleBWR_32),this.getIconItemProps(32,W.a.ColorScaleRWB_32),this.getIconItemProps(35,W.a.ColorScaleWR_32),this.getIconItemProps(36,W.a.ColorScaleRW_32),this.getIconItemProps(38,W.a.ColorScaleGW_32),this.getIconItemProps(37,W.a.ColorScaleWG_32),this.getIconItemProps(33,W.a.ColorScaleGY_32),this.getIconItemProps(34,W.a.ColorScaleYG_32)],itemsNumberInLine:4}];if(null!=this.props.ruleInputData.getRuleInputValue()&&0===this.colorScaleQuickFormatCommand){var t=this.getItemProps(0,this.getColorScaleFormatPreview(),!0);t.justifyContent="left",t.width="100%";var n={id:"ConditionalFormattingPreviewColorScaleBlock",itemsProps:[t],itemsNumberInLine:1,seperatorAfterBlock:!0};e.unshift(n)}return e},t.prototype.getIconItemProps=function(e,t){return this.getItemProps(e,this.getItemIconContent(t))},t.prototype.getItemProps=function(e,t,n){void 0===n&&(n=!1);var o=e;return 0!==this.colorScaleQuickFormatCommand&&this.colorScaleQuickFormatCommand===e&&(o=0),{commandType:o,text:Qn.get(e),data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onColorScaleValueChange,hideTooltip:n}},t.prototype.getItemIconContent=function(e){return O.createElement(H.a,{iconName:e,style:{height:"50px",width:"50px"}})},t.prototype.getColorScaleFormatPreview=function(){var e=Object(k.__assign)({fontSize:"12px",marginRight:Object(F.a)()?"10px":void 0,marginLeft:Object(F.a)()?void 0:"10px"},J);if(null!=this.props.ruleInputData.getRuleInputValue())return O.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},O.createElement("div",null,this.getColorScaleFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),O.createElement("span",{style:e},ExcelRibbonStrings.ConditionalFormattingCustomFormatText));throw new Error("Color scale input value is null")},t.prototype.getColorScaleFormatPreviewElement=function(e){return null!=e?O.createElement(fe,{rule:{ruleType:0,colorScaleFormat:e}}):O.createElement("div",null)},t}(O.Component),Qn=new Map;Qn.set(0,ExcelRibbonStrings.ConditionalFormattingCustomFormatText),Qn.set(27,ExcelRibbonStrings.ConditionalFormattingColorScalesRYG),Qn.set(28,ExcelRibbonStrings.ConditionalFormattingColorScalesGYR),Qn.set(29,ExcelRibbonStrings.ConditionalFormattingColorScalesGWR),Qn.set(30,ExcelRibbonStrings.ConditionalFormattingColorScalesRWG),Qn.set(31,ExcelRibbonStrings.ConditionalFormattingColorScalesBWR),Qn.set(32,ExcelRibbonStrings.ConditionalFormattingColorScalesRWB),Qn.set(33,ExcelRibbonStrings.ConditionalFormattingColorScalesGY),Qn.set(34,ExcelRibbonStrings.ConditionalFormattingColorScalesYG),Qn.set(35,ExcelRibbonStrings.ConditionalFormattingColorScalesWR),Qn.set(36,ExcelRibbonStrings.ConditionalFormattingColorScalesRW),Qn.set(37,ExcelRibbonStrings.ConditionalFormattingColorScalesWG),Qn.set(38,ExcelRibbonStrings.ConditionalFormattingColorScalesGW);var Kn="#5A8AC6",Jn="#63BE7B",Zn="#F8696B",Yn="#FFEB84",Xn="#FFEF9C",$n="#FCFCFF",eo=function(e){return{maximumColor:e.maximumColor,midpointColor:e.midpointColor,minimumColor:e.minimumColor}},to=[{key:27,customFormat:eo({maximumColor:Zn,midpointColor:Yn,minimumColor:Jn})},{key:28,customFormat:eo({maximumColor:Jn,midpointColor:Yn,minimumColor:Zn})},{key:29,customFormat:eo({maximumColor:Jn,midpointColor:$n,minimumColor:Zn})},{key:30,customFormat:eo({maximumColor:Zn,midpointColor:$n,minimumColor:Jn})},{key:31,customFormat:eo({maximumColor:Kn,midpointColor:$n,minimumColor:Zn})},{key:32,customFormat:eo({maximumColor:Zn,midpointColor:$n,minimumColor:Kn})},{key:33,customFormat:eo({maximumColor:Jn,midpointColor:null,minimumColor:Xn})},{key:34,customFormat:eo({maximumColor:Xn,midpointColor:null,minimumColor:Jn})},{key:35,customFormat:eo({maximumColor:$n,midpointColor:null,minimumColor:Zn})},{key:36,customFormat:eo({maximumColor:Zn,midpointColor:null,minimumColor:$n})},{key:37,customFormat:eo({maximumColor:$n,midpointColor:null,minimumColor:Jn})},{key:38,customFormat:eo({maximumColor:Jn,midpointColor:null,minimumColor:$n})}];function no(e,t){return!(!e||!t)&&(e.maximumColor===t.maximumColor&&e.midpointColor===t.midpointColor&&e.minimumColor===t.minimumColor)}var oo=function(e){function t(t){var n=e.call(this,t)||this;return n.onIconSetValueChange=n.onIconSetValueChange.bind(n),n.selectedItem={id:Pn+n.props.ruleInputData.getCommandType(),text:""},n.iconSetQuickFormatCommand=0,n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props.ruleInputData.getCommandType();0===n&&(this.iconSetQuickFormatCommand=(e=this.props.ruleInputData.getRuleInputValue(),t=null,de.b.forEach((function(n){(function(e,t){if(e&&t&&void 0!==e.icons&&null!==e.icons){if(e.icons.length!==t.icons.length)return!1;for(var n=0;n<t.icons.length;n+=1)if(e.icons[n].iconSet!==t.icons[n].iconSet||e.icons[n].index!==t.icons[n].index)return!1;return!0}return!1})(e,ro(n.iconFormats))&&(t=n.command)})),t||this.iconSetQuickFormatCommand));var o=io(n||this.iconSetQuickFormatCommand);return this.selectedItem.id=Pn+this.props.ruleInputData.getCommandType(),this.selectedItem.text=o.text,this.selectedItem.preview=this.getIconSetFormatPreviewElement(n?ro(o.iconFormats):this.props.ruleInputData.getRuleInputValue()),O.createElement("div",{style:{marginTop:"4px"}},O.createElement(Bn,{id:"ConditionalFormattingIconSetDropdown",nextFocusableElementId:this.props.nextFocusableElementId,prevFocusableElementId:this.props.prevFocusableElementId,itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))},t.prototype.onIconSetValueChange=function(e){var t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.createItemsDropdownBlockPropsList=function(){var e=[this.getIconItemProps(39),this.getIconItemProps(40),this.getIconItemProps(57),this.getIconItemProps(48),this.getIconItemProps(47),this.getIconItemProps(53),this.getIconItemProps(52)],t={id:"ConditionalFormattingDirectionalIconSetBlock",label:ExcelRibbonStrings.IconSetsDirectional,itemsProps:e,itemsNumberInLine:2},n=[this.getIconItemProps(42),this.getIconItemProps(43),this.getIconItemProps(44),this.getIconItemProps(51),this.getIconItemProps(49)],o={id:"ConditionalFormattingShapesIconSetBlock",label:ExcelRibbonStrings.IconSetsShapes,itemsProps:n,itemsNumberInLine:2},r=[this.getIconItemProps(45),this.getIconItemProps(46),this.getIconItemProps(41)],i={id:"ConditionalFormattingIndicatorsIconSetBlock",label:ExcelRibbonStrings.IconSetsIndicators,itemsProps:r,itemsNumberInLine:2},a=[this.getIconItemProps(56),this.getIconItemProps(50),this.getIconItemProps(55),this.getIconItemProps(54),this.getIconItemProps(58)],s=[t,o,i,{id:"ConditionalFormattingRatingsIconSetBlock",label:ExcelRibbonStrings.IconSetsRatings,itemsProps:a,itemsNumberInLine:2}];if(null!=this.props.ruleInputData.getRuleInputValue()&&0===this.iconSetQuickFormatCommand){var l=this.getItemProps(0,this.getIconSetFormatPreview(),!0);l.justifyContent="left",l.width="100%";var c={id:"ConditionalFormattingPreviewIconSetBlock",itemsProps:[l],itemsNumberInLine:1,seperatorAfterBlock:!0};s.unshift(c)}return s},t.prototype.getIconItemProps=function(e){return this.getItemProps(e,this.getItemContent(e))},t.prototype.getItemProps=function(e,t,n){void 0===n&&(n=!1);var o=e;return 0!==this.iconSetQuickFormatCommand&&this.iconSetQuickFormatCommand===e&&(o=0),{commandType:o,text:io(e).text,data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onIconSetValueChange,hideTooltip:n}},t.prototype.getItemContent=function(e){var t=[];return io(e).icons.forEach((function(e){t.push(e)})),t.reverse(),O.createElement("div",{style:{display:"flex",border:"none",flexBasis:"100%",direction:"ltr",height:"20px",width:"110px"}},t.map((function(e){return O.createElement(H.a,{iconName:e,style:{height:"20px",width:"20px",marginLeft:"1px",marginRight:"1px"}})})))},t.prototype.getIconSetFormatPreview=function(){var e=Object(k.__assign)({fontSize:"12px",marginRight:Object(F.a)()?"10px":void 0,marginLeft:Object(F.a)()?void 0:"10px"},J);if(null!=this.props.ruleInputData.getRuleInputValue())return O.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},O.createElement("div",null,this.getIconSetFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),O.createElement("span",{style:e},ExcelRibbonStrings.ConditionalFormattingCustomFormatText));throw new Error("Icon set input value is null")},t.prototype.getIconSetFormatPreviewElement=function(e){return null!=e?O.createElement("div",{style:{display:"flex",maxWidth:"100px",padding:"0px"}},O.createElement(fe,{rule:{ruleType:2,iconSetFormat:e}})):O.createElement("div",null)},t}(O.Component),ro=function(e){return{icons:e,isReverseIconsOrder:!1}};function io(e){var t=null;return de.b.forEach((function(n){e===n.command&&(t=n)})),t}var ao,so=function(e){function t(t){var n=e.call(this,t)||this;return n.onFormulaValueChange=n.onFormulaValueChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.ruleInputData.getErrorIfNeeded();return O.createElement(O.Fragment,null,O.createElement(Ge.a,{id:"ConditionalFormattingFormulaRuleLabel",style:{fontSize:"12px"}},ExcelRibbonStrings.ConditionalFormattingFormatFormulaTrue),O.createElement("div",{"aria-labelledby":"ConditionalFormattingFormulaRuleLabel ConditionalFormattingFormulaRuleError"},O.createElement(ie,{id:this.props.isNewRule?M.getRequiredFirstPaneElementId():"FormulaValueInput",name:"FormulaRuleTextField",autoApply:!0,value:this.props.ruleInputData.getRuleInputValue(),sheetName:this.props.sheetName,styles:Q(null===e),onChange:this.onFormulaValueChange,onCancelChanges:this.onFormulaValueChange,error:e||void 0,ariaLabel:ExcelRibbonStrings.ConditionalFormattingFormulaTextBox})))},t.prototype.onFormulaValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t}(O.Component),lo=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{marginTop:"12px",marginLeft:"2px"}},O.createElement(Lt,{selectedKey:this.props.ruleInputData.getInputType(),onChange:this.props.onRuleTypeChange,id:this.props.ruleTypeElementId}),this.getInputContent(),this.getFormatContent())},t.prototype.getInputContent=function(){switch(this.props.ruleInputData.getInputType()){case bt.TopBottom:return O.createElement("div",{style:{marginTop:"4px"}},O.createElement(Gt,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange}));case bt.HighlightCellsWith:return O.createElement(In,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,onHighlightCellsWithChange:this.props.onHighlightCellsWithChange,sheetName:this.props.sheetName});case bt.DataBars:return O.createElement(Fn,{nextFocusableElementId:this.props.doneButtonElementId,prevFocusableElementId:this.props.ruleTypeElementId,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case bt.ColorScales:return O.createElement(qn,{nextFocusableElementId:this.props.doneButtonElementId,prevFocusableElementId:this.props.ruleTypeElementId,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case bt.IconSets:return O.createElement(oo,{nextFocusableElementId:this.props.doneButtonElementId,prevFocusableElementId:this.props.ruleTypeElementId,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case bt.Formula:return O.createElement(so,{isNewRule:this.props.isNewRule,ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,sheetName:this.props.sheetName})}return O.createElement("div",null)},t.prototype.getFormatContent=function(){return this.props.ruleInputData.doesSupportStopIfTrueOrFormatInput()?O.createElement(mn,{selectedFormat:this.props.ruleFormat,onChange:this.props.onFormatChange}):O.createElement("div",null)},t}(O.Component),co=n(234),uo=n(1198),po=n(2347),ho=function(e){function t(t){var n=e.call(this,t)||this;return n.beforeYouGoCloseButtonId="ConditionalFormattingBeforeYouGoDialogCloseButton",n.beforeYouGoApplyButtonId="ConditionalFormattingBeforeYouGoDialogApplyButton",n.beforeYouGoDiscardButtonId="ConditionalFormattingBeforeYouGoDialogDiscardButton",n.onKeyDownCloseButtonBeforeYouGo=n.onKeyDownCloseButtonBeforeYouGo.bind(n),n.onKeyDownDiscardButtonBeforeYouGo=n.onKeyDownDiscardButtonBeforeYouGo.bind(n),n.onKeyDownApplyButtonBeforeYouGo=n.onKeyDownApplyButtonBeforeYouGo.bind(n),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){var e;null===(e=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===e||e.focus()},t.prototype.render=function(){return O.createElement(wn.a,{role:"dialog",onDismiss:this.props.rejectViewChange,directionalHint:Y.a.topCenter,coverTarget:!0,target:this.props.beforeYouGoRef.current,isBeakVisible:!1,shouldRestoreFocus:!1,styles:{root:{boxShadow:"rgba(0, 0, 0, 0.22) 0px 25.6px 57.6px 0px, rgba(0, 0, 0, 0.18) 0px 4.8px 14.4px 0px",backgroundColor:"white",overflow:"hidden"}}},O.createElement("div",{style:{minHeight:"150px",width:"270px",display:"flex",flexDirection:"column",justifyContent:"space-between",overflowY:"hidden",overflowX:"hidden"}},O.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},O.createElement(uo.a,{styles:{root:{fontSize:"22px",color:"#217346",margin:"20px",marginBottom:"15px"}}},ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogTitle),O.createElement(Z.a,{content:ExcelRibbonStrings.Close,directionalHint:Y.a.leftTopEdge},O.createElement(po.a,{type:"AppIconButtonProps",iconProps:Object(co.a)(c.a.CancelGlyph_16),onClick:this.props.rejectViewChange,id:this.beforeYouGoCloseButtonId,"aria-label":ExcelRibbonStrings.Close,onKeyDown:this.onKeyDownCloseButtonBeforeYouGo}))),O.createElement("div",{style:{marginLeft:"20px",marginRight:"20px"}},O.createElement(uo.a,{styles:{root:{fontSize:"14px",color:"rgb(133, 133, 133)"}}},ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogMessage)),O.createElement("div",{style:{display:"flex",alignSelf:"flex-end",margin:"15px"}},O.createElement(rn.a,{id:this.beforeYouGoApplyButtonId,styles:this.props.primaryButtonStyle,onClick:this.props.applyChangesAndConfirmViewChange,text:ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogApplyChanges,onKeyDown:this.onKeyDownApplyButtonBeforeYouGo,autoFocus:!0}),O.createElement(rn.a,{id:this.beforeYouGoDiscardButtonId,styles:{root:this.props.buttonStyle},style:{marginLeft:"10px"},onClick:this.props.resetChangesAndConfirmViewChange,text:ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogDiscardChanges,onKeyDown:this.onKeyDownDiscardButtonBeforeYouGo}))))},t.prototype.onKeyDownDiscardButtonBeforeYouGo=function(e){var t,n;"Tab"===e.key?(e.shiftKey?null===(t=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===t||t.focus():null===(n=document.getElementById(this.beforeYouGoCloseButtonId))||void 0===n||n.focus(),e.preventDefault()):"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.resetChangesAndConfirmViewChange())},t.prototype.onKeyDownCloseButtonBeforeYouGo=function(e){var t,n;"Tab"===e.key?(e.shiftKey?null===(t=document.getElementById(this.beforeYouGoDiscardButtonId))||void 0===t||t.focus():null===(n=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===n||n.focus(),e.preventDefault()):"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.rejectViewChange())},t.prototype.onKeyDownApplyButtonBeforeYouGo=function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.applyChangesAndConfirmViewChange())},t}(O.Component),go=n(79),mo=n(21),fo=Object(yt.isChangeGateEnabled)("OfficeVSO:5780548_CFRuleEditorSupportForDeletedSheet_V2"),bo=Object(yt.isChangeGateEnabled)("OfficeVSO:7153738_CFRuleEditorLogging"),vo=function(e){function t(n){var o,r=e.call(this,n)||this;return r.showingDialog=!1,r.inputChangeMade=!1,r.rangeChangeMade=!1,r.rangeErrorMessageId="CondFmtRangeErrorMessage",r.beforeYouGoRef=O.createRef(),r.buttonStyle={fontSize:"12px",height:"28px"},r.primaryButtonStyle={root:Object(k.__assign)(Object(k.__assign)({},r.buttonStyle),(o={backgroundColor:"#217346",color:"white"},o[":focus:after"]={outlineColor:"white !important"},o)),rootHovered:{backgroundColor:"#0e5c2f",color:"white"}},r.getDefaultSheetName=function(){if(r.state.ruleData.isNewRule()){var e=r.state.ruleData.getRange().sheetName;return!fo||e&&r.state.deletedSheets.indexOf(e)<0?e:void 0}return r.state.ruleData.getRange().initialData.sheetName},r.state={ruleData:je(t.RuleInputFactory,n.rule),deletedSheets:[],allowDiscardingDeletedSheets:!0,ownUpdate:!0},r.applyChanges=r.applyChanges.bind(r),r.applyChangesAndConfirmViewChange=r.applyChangesAndConfirmViewChange.bind(r),r.resetChangesAndConfirmViewChange=r.resetChangesAndConfirmViewChange.bind(r),r.applyChangesAndMoveToManagerView=r.applyChangesAndMoveToManagerView.bind(r),r.resetChangesAndMoveToManagerView=r.resetChangesAndMoveToManagerView.bind(r),r.getBeforeYouGoDialog=r.getBeforeYouGoDialog.bind(r),r.rejectViewChange=r.rejectViewChange.bind(r),r.onTypeChange=r.onTypeChange.bind(r),r.onHighlightCellsWithChange=r.onHighlightCellsWithChange.bind(r),r.onInputChange=r.onInputChange.bind(r),r.setRuleInputOnState=r.setRuleInputOnState.bind(r),r.onFormatChange=r.onFormatChange.bind(r),r.onStartRangePicker=r.onStartRangePicker.bind(r),r.onRangeChanged=r.onRangeChanged.bind(r),r.onRangeChangesAccepted=r.onRangeChangesAccepted.bind(r),r.onRangeChangesDiscarded=r.onRangeChangesDiscarded.bind(r),r.onStopIfTrueChange=r.onStopIfTrueChange.bind(r),r.getDoneButtonElementId=r.getDoneButtonElementId.bind(r),r.getRuleTypeElementId=r.getRuleTypeElementId.bind(r),r}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,n){var o,r,i=n.ruleData;if(!n.ownUpdate&&i&&e.notification){var a={ruleData:i,deletedSheets:n.deletedSheets,ownUpdate:!1};return(null===(o=e.notification.sheetRenameEvent)||void 0===o?void 0:o.newSheetName)&&i.getRange().onSheetRename(e.notification.sheetRenameEvent),fo&&(null===(r=e.notification.sheetDeletedEvent)||void 0===r?void 0:r.sheetName)&&i.isNewRule()&&(a.deletedSheets.push(e.notification.sheetDeletedEvent.sheetName),a.allowDiscardingDeletedSheets=!1),a}return n.ownUpdate||!e.rule||e.showConfirmation?{ruleData:n.ruleData,ownUpdate:!1}:{ruleData:je(t.RuleInputFactory,e.rule),ownUpdate:!1}},t.prototype.componentDidMount=function(){M.setFocusOnPaneFirstElement()},t.prototype.render=function(){return O.createElement("div",{id:"ConditionalFormattingTaskPaneRuleEditorId",style:Object(k.__assign)({position:"absolute",height:"100%"},{marginLeft:"17px",marginRight:"17px",right:"0px",left:"0px"})},O.createElement(He,{containerStyle:{minWidth:"304px"}},O.createElement("div",{style:{position:"absolute",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",marginRight:Object(F.a)()?"0px":"17px",marginLeft:Object(F.a)()?"17px":"0px",right:"0px",left:"0px"}},O.createElement("div",null,O.createElement(et.a,{styles:{root:{padding:"2px",color:"#217346",fontSize:"12px",selectors:{":hover":{color:"#0e5c2f"},":focus":Object(k.__assign)(Object(k.__assign)({},K()),{color:"#217346",boxShadow:"none !important",borderRadius:"0px"}),":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},onClick:this.resetChangesAndMoveToManagerView},ExcelRibbonStrings.ConditionalFormattingGoToManageRules),this.getRuleEditorDisplayComponents(),this.getBeforeYouGoDialog()),O.createElement("div",{id:"ConditionalFormattingRuleEditorFooter",style:{alignSelf:"flex-end",marginBottom:"15px",marginTop:"15px"}},O.createElement(rn.a,{id:this.getDoneButtonElementId(),styles:this.primaryButtonStyle,style:{marginLeft:"8px",marginRight:"8px"},onClick:this.applyChangesAndMoveToManagerView,text:ExcelRibbonStrings.ConditionalFormattingRuleEditWindowDone,disabled:this.shouldDisableDoneButton()}),O.createElement(rn.a,{styles:{root:this.buttonStyle},onClick:this.resetChangesAndMoveToManagerView,text:ExcelRibbonStrings.ConditionalFormattingRuleEditWindowCancel})))))},t.prototype.componentDidCatch=function(e,t){i.a.sendTraceTag(579736727,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingTaskPaneReact.RuleEditor: RuleEditor component failed to render: ".concat(e.toString()," , ").concat(t.componentStack))},t.prototype.getRuleRangeContent=function(){var e,t={root:{height:"14px",fontSize:"12px",padding:"0px"}},n=this.state.ruleData.getRange().getErrorMessage(this.state.ruleData.isNewRule(),this.state.deletedSheets);return O.createElement("div",{style:{marginTop:"12px"}},O.createElement(Ge.a,{styles:t,htmlFor:"ConditionalFormattingRuleRangeTextField"},ExcelRibbonStrings.ConditionalFormattingApplyToRange),O.createElement("div",{style:{marginTop:"4px"}},O.createElement(ie,{id:"ConditionalFormattingRuleRangeTextField",supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!this.state.ruleData.isNewRule(),value:this.state.ruleData.getRange().rangeString,sheetName:this.getDefaultSheetName(),onChange:this.onRangeChanged,onCancelChanges:fo?this.onRangeChangesDiscarded:this.onRangeChanged,onApplyChanges:fo?this.onRangeChangesAccepted:this.onRangeChanged,styles:{contentRoot:Object(k.__assign)({},q(null===n))},error:n||void 0,sheetRenameEvent:null===(e=this.props.notification)||void 0===e?void 0:e.sheetRenameEvent,onStartPicking:fo?this.onStartRangePicker:void 0,"aria-label":ExcelRibbonStrings.ConditionalFormattingApplyToRange+(n||"")})))},t.prototype.getStopIfTrueCheckbox=function(){var e;if(!this.state.ruleData.getRuleInputData().doesSupportStopIfTrueOrFormatInput())return O.createElement("div",{style:{height:"20px"}});var t={root:{height:"16px",width:"16px",padding:"3px",selectors:{":hover":{cursor:"help"},":focus":K(),":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},n={checkbox:{borderRadius:"0%",height:"16px",width:"16px",marginTop:"1px",marginLeft:"1px"},text:{fontSize:"12px"},root:[(e={},e[V.m]={":focus,:focus-within,:active,:focus:after":K()},e)]};return O.createElement("div",{style:{marginTop:"4px",display:"flex",flexDirection:"row",marginLeft:"3px"}},O.createElement(Ht.a,{styles:n,checked:this.state.ruleData.getStopIfTrue(),onChange:this.onStopIfTrueChange,label:ExcelRibbonStrings.ConditionalFormattingStopIfTrue,theme:Object(zt.a)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}})}),O.createElement(Z.a,{content:ExcelRibbonStrings.ConditionalFormattingStopIfTrueTooltipContent,styles:{root:{width:"16px",height:"16px",marginLeft:"3px"}}},O.createElement(H.a,Object(k.__assign)({role:"tooltip"},Object(co.a)(W.a.Info_20),{styles:t,"aria-label":"".concat(ExcelRibbonStrings.ConditionalFormattingStopIfTrueInfoRole,", ").concat(ExcelRibbonStrings.ConditionalFormattingStopIfTrueTooltipContent),tabIndex:0}))))},t.prototype.getRuleInputContent=function(){return O.createElement(lo,{isNewRule:this.state.ruleData.isNewRule(),ruleTypeElementId:this.getRuleTypeElementId(),doneButtonElementId:this.getDoneButtonElementId(),ruleInputData:this.state.ruleData.getRuleInputData(),sheetName:this.state.ruleData.getRange().sheetName||this.getDefaultSheetName(),ruleFormat:this.state.ruleData.getFormatInputData(),onRuleTypeChange:this.onTypeChange,onHighlightCellsWithChange:this.onHighlightCellsWithChange,onInputChange:this.onInputChange,onFormatChange:this.onFormatChange})},t.prototype.isRuleRangeValid=function(){return this.state.ruleData.getRange().isValid(this.state.ruleData.isNewRule(),this.state.deletedSheets)},t.prototype.isRuleDataValid=function(){return this.state.ruleData.getRuleInputData().isValid()&&this.isRuleRangeValid()},t.prototype.wasRuleInputChanged=function(){return this.state.ruleData.getRuleInputData().wasChanged()},t.prototype.shouldDisableDoneButton=function(){var e,t=this.isRuleRangeValid(),n=!(null===(e=this.state.ruleData.getRuleInputData())||void 0===e?void 0:e.shouldShowError());return!t||!n},t.prototype.applyChangesAndConfirmViewChange=function(){this.applyChanges()?this.props.onConfirmationResponse(!0):this.rejectViewChange(),this.showingDialog=!1},t.prototype.resetChangesAndConfirmViewChange=function(){bo&&Object(go.logActivityForExperiment)("CFRuleCancelled_FromBeforeYouGo"),this.rangeChangeMade=!1,this.inputChangeMade=!1,this.props.onConfirmationResponse(!0),this.showingDialog=!1},t.prototype.rejectViewChange=function(){this.props.onConfirmationResponse(!1),this.rangeChangeMade=!1,this.inputChangeMade=!1,this.showingDialog=!1},t.prototype.applyChangesAndMoveToManagerView=function(){this.applyChanges()&&this.props.onChangeViewRequest(1)},t.prototype.resetChangesAndMoveToManagerView=function(){bo&&Object(go.logActivityForExperiment)("CFRuleCancelled"),this.props.onChangeViewRequest(1),this.rangeChangeMade=!1,this.inputChangeMade=!1},t.prototype.applyChanges=function(){if(this.isRuleDataValid()){var e={},t=!this.state.ruleData.isNewRule(),n=this.state.ruleData.getRuleInputData(),o=null;n.doesSupportStopIfTrueOrFormatInput()&&this.state.ruleData.getFormatInputData().hasChanges()?this.state.ruleData.getFormatInputData().isQuickFormat()?e.quickFormat=this.state.ruleData.getFormatInputData().getQuickFormat():(e.quickFormat=6,o=this.state.ruleData.getFormatInputData().getCustomFormat()):e.quickFormat=-1,t&&!this.wasRuleInputChanged()?e.command=0:n&&n.updateConditionalFormattingOptions(e);var r={guid:this.state.ruleData.getGuid(),range:this.state.ruleData.getRange().isDirty()||!t?this.state.ruleData.getRange().rangeString:null,ruleRangeSheetName:this.state.ruleData.getRange().sheetName,activeCell:this.state.ruleData.getRange().activeCell,stopIfTrue:n.doesSupportStopIfTrueOrFormatInput()&&this.state.ruleData.getStopIfTrue(),options:e,customFormat:o};return t?(M.onRuleEdited(r),null!=r.range&&(i.a.sendTraceTag(542914070,a.a.msoulscat_ES_EWAJS,s.a.Info,"RuleEditor.applyChanges: Conditional Formatting Rule range was modified via the Rule Editor"),bo&&Object(go.logActivityForExperiment)("CFRuleAppliedExisting"))):(M.onRuleAdded(r),r.stopIfTrue&&i.a.sendTraceTag(539890389,a.a.msoulscat_ES_EWAJS,s.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: New rule added with stopIfTrue"),r.customFormat&&i.a.sendTraceTag(539890390,a.a.msoulscat_ES_EWAJS,s.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: New rule added with customFormat"),bo&&Object(go.logActivityForExperiment)("CFRuleAppliedNew"),this.rangeChangeMade=!1,this.inputChangeMade=!1),ve(ExcelRibbonStrings.ConditionalFormattingRuleEditWindowDoneActionMessage),!0}if(!this.shouldDisableDoneButton()){i.a.sendTraceTag(575501088,a.a.msoulscat_ES_EWAJS,s.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: Apply changes while in initial view on ".concat(null!=this.state.ruleData.getGuid()?"exsiting":"new"," rule"));var l=this.state.ruleData.getRuleInputData();l.setShouldShowErrorWhenInvalid(!0),this.setRuleInputOnState(l)}return!1},t.prototype.getBeforeYouGoDialog=function(){return this.props.showConfirmation?(this.showingDialog||(this.showingDialog=!0),this.wasRuleInputChanged()?O.createElement(ho,{beforeYouGoRef:this.beforeYouGoRef,rejectViewChange:this.rejectViewChange,applyChangesAndConfirmViewChange:this.applyChangesAndConfirmViewChange,resetChangesAndConfirmViewChange:this.resetChangesAndConfirmViewChange,primaryButtonStyle:this.primaryButtonStyle,buttonStyle:this.buttonStyle}):(this.resetChangesAndConfirmViewChange(),O.createElement("div",null))):(this.showingDialog=!1,O.createElement("div",null))},t.prototype.onTypeChange=function(e){bo&&Object(go.logActivityForExperiment)("CFRuleTypeChange");var n=null;if(!this.state.ruleData.isNewRule())switch(e){case bt.DataBars:n=this.state.ruleData.getDataBarFormat();break;case bt.ColorScales:n=this.state.ruleData.getColorScaleFormat();break;case bt.IconSets:n=this.state.ruleData.getIconSetFormat()}this.setRuleInputOnState(t.RuleInputFactory.createDefaultRuleInputDataByRuleTypeOption(e,n))},t.prototype.onHighlightCellsWithChange=function(e){bo&&Object(go.logActivityForExperiment)("CFRuleHighlightTypeChange"),this.setRuleInputOnState(t.RuleInputFactory.createDefaultRuleInputDataByHighlightCellsWithOption(e))},t.prototype.onStopIfTrueChange=function(e,t){if(null!=t){bo&&Object(go.logActivityForExperiment)("CFRuleStopIfChange");var n=this.state.ruleData;n.setStopIfTrue(t),this.setState({ruleData:n,ownUpdate:!0})}},t.prototype.onInputChange=function(e){bo&&!this.inputChangeMade&&(Object(go.logActivityForExperiment)("CFRuleInputChange"),this.inputChangeMade=!0),this.setRuleInputOnState(e)},t.prototype.setRangeErrorMessageAlert=function(){var e=document.getElementById(this.rangeErrorMessageId);if(e){e.setAttribute("aria-label",""),e.setAttribute("role","");var t=this.state.ruleData.getRange().getErrorMessage(this.state.ruleData.isNewRule(),this.state.deletedSheets);t&&(e.setAttribute("aria-label",t),e.setAttribute("role","alert"))}},t.prototype.onStartRangePicker=function(){this.state.deletedSheets.length>0&&this.setState({allowDiscardingDeletedSheets:!0,ownUpdate:!0})},t.prototype.onRangeChanged=function(e,t,n){var o=this;void 0===n&&(n=!1),bo&&!this.rangeChangeMade&&(Object(go.logActivityForExperiment)("CFRuleRangeChange"),this.rangeChangeMade=!0);var r=this.state.ruleData;r.updateRange({rangeString:e,sheetName:t,activeCell:null}),this.setState({ruleData:r,allowDiscardingDeletedSheets:!0,deletedSheets:n?[]:this.state.deletedSheets,ownUpdate:!0},(function(){return o.setRangeErrorMessageAlert()}))},t.prototype.onRangeChangesAccepted=function(e,t){this.onRangeChanged(e,t||this.state.ruleData.getRange().sheetName,this.state.allowDiscardingDeletedSheets)},t.prototype.onRangeChangesDiscarded=function(e,t){this.onRangeChanged(e,t||this.state.ruleData.getRange().sheetName)},t.prototype.onFormatChange=function(e){bo&&Object(go.logActivityForExperiment)("CFRuleFormatChange");var t=this.state.ruleData;t.setFormatInputData(e),this.setState({ruleData:t,ownUpdate:!0})},t.prototype.setRuleInputOnState=function(e){var t=this.state.ruleData;t.setRuleInputData(e),this.setState({ruleData:t,ownUpdate:!0})},t.prototype.getDoneButtonElementId=function(){return this.state.ruleData.canFocusOnRuleInput()||!this.state.ruleData.isNewRule()?"ConditionalFormattingRuleEditorDoneButton":M.getRequiredFirstPaneElementId()},t.prototype.getRuleTypeElementId=function(){return Lt.getDropdownElementId(this.state.ruleData.isNewRule())},t.prototype.getRuleEditorDisplayComponents=function(){return Object(mo.e)("HighlightWhenNewPaneExperiment")?O.createElement("div",null,this.getRuleInputContent(),O.createElement("div",{ref:this.beforeYouGoRef},this.getRuleRangeContent()),this.getStopIfTrueCheckbox()):O.createElement("div",null,this.getRuleRangeContent(),this.getStopIfTrueCheckbox(),O.createElement("div",{ref:this.beforeYouGoRef},this.getRuleInputContent()))},t.RuleInputFactory=new _t,t}(O.Component),yo=!1,xo=0,Co=!1;function So(e){return xo++,new Promise((function(t,o){n.e(27).then(n.bind(null,2684)).then((function(n){t(n),Co=!0,ao=n,e&&e()})).catch((function(e){yo=!0,o(e)}))}))}function Eo(){return!Object(L.e)()&&(yo||0===xo)&&xo<5}function ko(e){return Co?new Promise((function(t,n){t(ao),e&&e()})):Eo()?So(e):new Promise((function(e,t){t("Failed to load reactdnd js after 5 retries on same session")}))}var Oo=void 0,To=400,Io="CondFmtLiveRegion",wo=function(e){function t(n){var o=e.call(this,n)||this;return o.focus=M.setFocusOnPaneFirstElement,o.state={viewType:n.taskPaneViewType,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0,ruleForEdit:n.rule||null},M.updateData(n),o.onUserConfirmationResponse=o.onUserConfirmationResponse.bind(o),o.onChangeViewRequest=o.onChangeViewRequest.bind(o),o.renderRuleManager=o.renderRuleManager.bind(o),Object(yt.isChangeGateEnabled)("OfficeVSO:7162695_UseSharedLoadDragAndDropResources")?Oo=O.lazy((function(){return ko()})):t.tryLoadingDraggablePane(),o}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,n){var o;if(n.isUpdateInitiatedFromReactSide||e.notification)return{isUpdateInitiatedFromReactSide:!1};0===n.viewType&&(Object(yt.isChangeGateEnabled)("OfficeVSO:7162695_UseSharedLoadDragAndDropResources")?Oo=O.lazy((function(){return ko()})):t.tryLoadingDraggablePane());var r,i=e.taskPaneViewType,a=null!==(o=e.rule)&&void 0!==o?o:n.ruleForEdit;return 2===n.viewType?r={viewType:n.viewType,requestedView:i,requireConfirmation:!0,ruleForEdit:a}:(r={viewType:i,requireConfirmation:!1,requestedView:null,ruleForEdit:a},function(e,t){e!==t&&M.onTaskPaneViewChange(t)}(n.viewType,i)),r},t.prototype.componentDidCatch=function(e,t){i.a.sendTraceTag(595657362,a.a.msoulscat_ES_EWAJS,s.a.Error,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: component failed to render: ".concat(e.toString()," , ").concat(t.componentStack))},t.prototype.render=function(){return O.createElement("div",{className:Object(V.eb)({background:"#EDEBE9"})},O.createElement("div",{id:Io}),this.getTaskpaneContent(this.state.viewType))},t.prototype.getTaskpaneContent=function(e){return 1===e?M.isRuleReorderWithDnDSupported()?O.createElement(O.Suspense,{fallback:this.renderRuleManager(!0)},O.createElement(Oo,{onRenderComponent:this.renderRuleManager})):this.renderRuleManager():2===e?O.createElement(vo,{rule:this.state.ruleForEdit,onChangeViewRequest:this.onChangeViewRequest,showConfirmation:this.state.requireConfirmation,onConfirmationResponse:this.onUserConfirmationResponse,notification:this.props.notification}):O.createElement("div",null)},t.prototype.renderRuleManager=function(e){var t=e?null:this.props.rules,n=function(e){return e?e.sort((function(e,t){return e.priority-t.priority})):e}(t||[]);return O.createElement(mt,{rules:n,isLoading:null==t,onChangeViewRequest:this.onChangeViewRequest,error:this.props.error||0,ruleFilterOption:this.props.ruleFilterOption})},t.prototype.onChangeViewRequest=function(e,t){void 0===t&&(t=null);var n=null;t&&(n=Le(t)),this.setState({viewType:e,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0,ruleForEdit:n}),M.onTaskPaneViewChange(e)},t.prototype.onUserConfirmationResponse=function(e){var t=this.state.requestedView;null!=t?e?(this.setState({viewType:t,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0}),M.onTaskPaneViewChange(t)):this.setState({requireConfirmation:!1,requestedView:null,ruleForEdit:null,isUpdateInitiatedFromReactSide:!0}):i.a.shipAssertTag(594872280,a.a.msoulscat_ES_EWAJS,!1,"requestedView must have value.")},t.tryLoadingDraggablePane=function(){Eo()&&(Oo=O.lazy((function(){return So()})))},t}(O.Component),_o=n(953),Po=n(13),Ro={summaryCardStyles:Object(Po.c)((function(e){return{root:{height:"80px",width:"288px",left:"17px",top:"0px",borderRadius:"4px",marginTop:"8px",marginBottom:"8px",background:e.palette.white,borderColor:"transparent",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",":hover":{borderRadius:"4px",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13)",borderColor:"transparent !important"},":hover::after":{border:"unset"}}}})),tooltipHostStyles:{root:{width:"10px",height:"10px",marginLeft:"4px"}},tooltipIconStyles:{root:{height:"10px",width:"10px"}},numberFormatIconStyles:{root:{height:"16px",width:"16px",left:"12px",top:"25px",borderRadius:"8px",position:"relative"}},cardViewIconStyles:{root:{height:"16.25px",width:"16px",left:"11px",top:"25px",position:"relative"}},summaryCardTitleStyles:{root:{fontWeight:"600",fontSize:"14px",lineHeight:"20px",height:"20px",left:"37px",top:"12px",position:"absolute"}},stackStyles:{root:{width:"inherit"}},chevronIconStyles:{root:{height:"20px",width:"12px",left:"264px",top:"24px",position:"absolute"}},rootDescriptionTextStyles:{root:{height:"16px",left:"37px",top:"40px",position:"absolute",fontSize:"12px",lineHeight:"16px"}},formattingOptionsLabelStyles:Object(Po.c)((function(e){return{root:{fontWeight:V.l.semibold,color:e.palette.neutralDark,paddingLeft:"0px",label:{position:"relative",left:"17px"}}}}))},Do=O.createContext(void 0),jo=n(1493),Bo=n(269),Fo={floatingObjectDivStyles:{marginLeft:"17px",fontStyle:"italic",width:"auto",height:"20px"}},Lo=function(){return O.createElement("div",{style:Fo.floatingObjectDivStyles},ExcelFormatcellsTaskpaneStrings.FloatingObjectSelectedDescription)};function Mo(e){var t=Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.FormatCellsTaskPane",!1),n=Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.FormatCellsTaskPaneFontItemView",!1),o=Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.FormatCellsTaskPaneBordersItemView",!1);switch(e){case 1:case 2:return t;case 3:return t&&n;case 4:return t&&o;default:return!1}}var Ao=function(e){function t(t){var n=e.call(this,t)||this;return n.cardRef=O.createRef(),n.generateSummaryCard=function(e,t,o,r,i,a,s,l){return Mo(o)?O.createElement(R.a,{componentRef:n.cardRef,styles:Ro.summaryCardStyles(l),"aria-label":e,tabIndex:0,type:_o.a.compact,onClick:function(){var e;null===(e=n.cardRef.current)||void 0===e||e.focus(),t.onItemClick(o)}},O.createElement(Qe.a,{horizontal:!0,styles:Ro.stackStyles},O.createElement(H.a,{iconName:r,styles:i}),O.createElement(Qe.a,{styles:Ro.stackStyles},O.createElement(uo.a,{styles:Ro.summaryCardTitleStyles},a),O.createElement(uo.a,{styles:Ro.rootDescriptionTextStyles},s)),O.createElement(H.a,{iconName:c.a.CommonControlChevronRight_12,styles:Ro.chevronIconStyles}))):O.createElement(O.Fragment,null)},n.state={},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(Do.Consumer,null,(function(n){return O.createElement(O.Fragment,null,e.props.isFloatingObjectSelected?O.createElement(Lo,null):O.createElement(O.Fragment,null,O.createElement(jo.a,{id:"formattingOptionsLabel",type:"AppLabelProps",forId:"formattingOptionsToolTip",label:ExcelFormatcellsTaskpaneStrings.FormattingOptionsLabel,styles:Ro.formattingOptionsLabelStyles(t)},O.createElement(Z.a,{id:"formattingOptionsToolTip",content:ExcelFormatcellsTaskpaneStrings.FormattingOptionsToolTip,styles:Ro.tooltipHostStyles},O.createElement(H.a,Object(k.__assign)({role:"tooltip"},Object(co.a)(W.a.Info_20),{styles:Ro.tooltipIconStyles,"aria-label":ExcelFormatcellsTaskpaneStrings.FormattingOptionsToolTipAriaLabel,tabIndex:0})))),e.generateSummaryCard(ExcelFormatcellsTaskpaneStrings.NumberTabCardAriaLabel,n.callbacks,1,W.a.NumberFormat_16,Ro.numberFormatIconStyles,ExcelFormatcellsTaskpaneStrings.NumberTabLabel,ExcelFormatcellsTaskpaneStrings.NumberSummaryCardDescription,t),e.generateSummaryCard(ExcelFormatcellsTaskpaneStrings.AlignmentTabCardAriaLabel,n.callbacks,2,W.a.FormatCellAlignment_16,Ro.cardViewIconStyles,ExcelFormatcellsTaskpaneStrings.AlignmentTabLabel,ExcelFormatcellsTaskpaneStrings.AlignmentSummaryCardDescription,t),e.generateSummaryCard(ExcelFormatcellsTaskpaneStrings.FontTabCardAriaLabel,n.callbacks,3,W.a.FontScheme_16,Ro.cardViewIconStyles,ExcelFormatcellsTaskpaneStrings.FontTabLabel,ExcelFormatcellsTaskpaneStrings.FontSummaryCardDescription,t),e.generateSummaryCard(ExcelFormatcellsTaskpaneStrings.BorderTabCardAriaLabel,n.callbacks,4,W.a.TopAndBottomBorder_16,Ro.cardViewIconStyles,ExcelFormatcellsTaskpaneStrings.BorderTabLabel,ExcelFormatcellsTaskpaneStrings.BorderSummaryCardDescription,t)))}))}))},t}(O.Component),No=n(854),Wo=n(1336),Ho=function(e,t){return{fontWeight:"450",fontSize:"12px",padding:"3px 0px 3px 0px",color:e?t.palette.themePrimary:t.palette.neutralDark,cursor:e?"pointer":"default"}},zo=n(179),Vo=n(3),Go=function(e){var t=O.useState(!1),n=t[0],o=t[1];return O.createElement(Bo.a,null,(function(t){return O.createElement("div",{style:{height:"40px",paddingTop:"5px"},role:"button",tabIndex:0,onClick:Uo,onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||Uo()}},O.createElement("div",{style:{display:"flex",padding:"6px 0px 6px 9px",lineHeight:"20px"}},O.createElement(H.a,{iconName:W.a.Feedback_20,style:{padding:"6px 11px 6px 1px",height:"16px",width:"16px"}}),O.createElement("span",{style:Ho(n,t),onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)}},e.giveFeedBackButtonText||ExcelRibbonStrings.GiveFeedBackButtonText)))}))},Uo=function(){Object(zo.b)(Vo.b.GiveFeedback,{modelType:"ButtonModel",payload:{type:"ButtonPayload"}})},qo=n(42),Qo=function(){var e=!Object(yt.getBooleanFeatureGate)("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled",!1)||!Object(yt.isChangeGateEnabled)("OfficeVSO:8333192_FormatCellsTaskPaneColorFix");return{backgroundTransparent:"transparent",iconButtonBackgroundRest:"transparent",iconButtonBackgroundHover:e?qo.a.gray40:"#EBEBEB",iconButtonBackgroundPressed:e?qo.a.gray50:"#E0E0E0",iconButtonBackgroundSelected:e?qo.a.gray50:"#E0E0E0",iconButtonBackgroundFocus:"transparent",iconButtonBackgroundDisabled:"transparent",iconButtonForegroundRest:e?qo.a.gray160:"#424242",iconButtonForegroundHover:e?qo.a.gray190:"#242424",iconButtonForegroundPressed:e?qo.a.gray190:"#242424",iconButtonForegroundSelected:e?qo.a.gray190:"#242424",iconButtonForegroundFocus:e?qo.a.gray160:"#424242",iconButtonForegroundDisabled:e?qo.a.gray90:"#BDBDBD"}},Ko=Object(Po.c)((function(e){return{root:{marginRight:"10px",background:Qo().backgroundTransparent},dropdown:{border:"1px solid "+e.palette.neutralLight,borderRadius:"2px",width:"140px"},caretDownWrapper:{height:"16px",paddingBottom:"2px",paddingTop:"3px",lineHeight:"unset"},title:{border:"unset",fontSize:"12px",height:"24px",lineHeight:"24px"},dropdownOptionText:{fontSize:"12px"},label:{fontWeight:V.l.semibold,fontSize:"12px",whiteSpace:"nowrap"}}})),Jo=Object(Po.c)((function(e,t){return{root:{marginBottom:e?void 0:"5px",marginTop:e?"22px":void 0,marginRight:"2px",marginLeft:t,paddingLeft:"4px",paddingRight:"4px",height:"28px",border:"unset",backgroundColor:"transparent",color:Qo().iconButtonForegroundRest},textContainer:{fontSize:"12px",fontWeight:V.l.regular,fontStyle:"normal",whiteSpace:"nowrap"},label:{marginLeft:"4px",marginRight:"4px"},icon:{height:"16px",width:"16px"},rootDisabled:{border:"unset",backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus}}})),Zo={styles:{root:{marginBottom:"5px",marginRight:"12px",paddingLeft:"4px",paddingRight:"4px",height:"28px",border:"unset",backgroundColor:"transparent",color:Qo().iconButtonForegroundRest},textContainer:{fontSize:"12px",fontWeight:V.l.regular,fontStyle:"normal",whiteSpace:"nowrap"},label:{marginLeft:"4px",marginRight:"4px"},splitButtonMenuButton:{backgroundColor:"unset"},rootDisabled:{border:"unset",backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus}}},Yo={styles:{splitButtonContainer:{padding:"0px 4px",display:"flex",height:"28px",alignItems:"center",flexShrink:0},label:{fontSize:"12px",fontWeight:V.l.regular,fontStyle:"normal",whiteSpace:"nowrap"},root:{paddingLeft:"4px",paddingRight:"4px",height:"28px",border:"unset",backgroundColor:"unset",display:"flex",alignItems:"center"},rootDisabled:{border:"unset",backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus},splitButtonDivider:{width:"0px"},splitButtonMenuButtonExpanded:{height:"28px"},splitButtonMenuButton:{backgroundColor:"unset",width:"12px",height:"28px",padding:"4px 2px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0,border:"none",outline:"none",fontWeight:V.l.regular,selectors:{"span:first-child":{height:"8px",width:"8px",lineHeight:"8px"}}},splitButtonMenuIcon:{display:"inline-block",fontSize:"8px",lineHeight:"8px",height:"unset",width:"unset"}}},Xo={root:{marginTop:"10px",paddingLeft:"0px"},label:{fontWeight:V.l.semibold,fontSize:"12px",fontStyle:"normal"}},$o=Object(Po.c)((function(e,t){return{root:{width:"140px",marginTop:"-6px",padding:"0px",marginRight:t?void 0:"10px"},spinButtonWrapper:{position:"relative",border:"1px solid "+e.palette.neutralLight,borderRadius:"2px",height:"24px"},input:{fontWeight:V.l.regular,fontSize:"12px"},labelWrapper:{marginBottom:"-8px"},label:{fontWeight:V.l.semibold,fontSize:"12px",background:Qo().backgroundTransparent}}})),er={alignmentCheckBoxStyles:Object(Po.c)((function(e){return{root:{height:"24px",marginTop:"30px",background:Qo().backgroundTransparent,padding:"0px"},label:{fontStyle:"normal",fontWeight:V.l.semilight,color:e.palette.neutralLight,whiteSpace:"nowrap"},checkbox:{height:"18px",width:"18px",borderColor:e.palette.neutralLight,borderRadius:"2px"}}})),alignmentDropDownStyles:Ko,alignmentSpinButtonStyles:$o,alignRowDivStyles:Object(Po.c)((function(e,t){return void 0===t&&(t=!1),{marginTop:e?void 0:"10px",display:"flex",justifyContent:t?"flex-start":"space-between",flexDirection:"row",marginRight:e?"20px":void 0}})),verticalOrientationDivStyles:{display:"inline-flex",flexDirection:"row"},iconButtonStyles:Jo,textControlLabelStyles:Xo,storeConnectedIconButtonsStyles:Zo,mergeSplitButtonStyles:Yo},tr=n(99),nr=n(2363),or=n(2357),rr=n(768),ir=n(142),ar={root:{height:"12px",width:"12px",marginRight:"-6px"}},sr=function(){return O.createElement(H.a,{iconName:ir.a.downChevron.icon12,styles:ar})},lr=n(2364);function cr(e,t,n){Object(w.c)(t)?(Object(w.a)(e),Object(lr.a)(e,t)):n||i.a.sendTraceTag(507905987,a.a.msoulscat_ES_EWAJS,s.a.Info,"logPanePerfTelemetry: start marker not found. ".concat(t)),Object(w.b)(e),Object(w.b)(t)}var ur=n(22),dr=n(20),pr=n(892);function hr(e){return Object(ur.a)(dr.z,{taskPanes:Object(pr.a)(e)})}function gr(e,t){return Object(ur.a)(dr.Ic,{taskPaneId:e,resizeWidth:t})}function mr(e,t){return Object(ur.a)(dr.A,{taskPaneIds:Object(pr.a)(e),location:t})}function fr(e,t){return Object(ur.a)(dr.V,{taskPaneIds:Object(pr.a)(e),location:t})}function br(e,t){return Object(ur.a)(dr.Ib,{taskPaneId:e,location:t})}function vr(e,t,n){return Object(ur.a)(dr.Z,{middleContainer:e,selectedPaneId:t,location:n})}function yr(e,t){return Object(ur.a)(dr.Sb,{taskPaneId:e,controlIdsList:t})}var xr=n(131),Cr=n(48),Sr=n(743),Er=Object(xr.a)([function(e,t){return t.controlsToRender},Cr.U,Cr.u,Cr.bb],(function(e,t,n,o){var r={};return e.forEach((function(e){var i=Object(Sr.c)(t,n,e,o);r[e]=i})),r})),kr=n(642),Or=n(1939),Tr=n(236),Ir=n(173),wr=Object(Ir.connect)((function(e,t){return Object(k.__assign)(Object(k.__assign)({},t),{controlPropsMap:Er(e,t)})}),void 0,void 0,{areStatesEqual:Object(Tr.a)("StoreConnectedTaskPaneView")})(Object(Or.a)((function(e){return O.useEffect((function(){return Object(kr.a)(yr(e.taskPaneId,e.controlsToRender)),function(){Object(kr.a)(yr(e.taskPaneId,[]))}}),[e.taskPaneId,e.controlsToRender]),e.customViewRendererFunction(e.controlPropsMap)}))),_r=n(2258),Pr=n(215),Rr=n(2023),Dr=n(2014),jr=n(1117),Br=n(2244),Fr=n(653),Lr=n(191),Mr=n(1102),Ar=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=Object(jr.a)(Lr.a.Small,Object(Mr.a)(!0,this.props.styles));return O.createElement(Bo.a,null,(function(n){return O.createElement(Br.a,Object(k.__assign)({},e.props,{styles:Object(Fr.b)(n,t),dataAutomationType:"TaskPaneActionToggleButton"}))}))}}(O.PureComponent),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Br.a,Object(k.__assign)({},this.props,{styles:Object(Mr.a)(!1,this.props.styles),dataAutomationType:"TaskPaneToggleButton"}))},t}(O.PureComponent)),Nr=n(2298),Wr=n(2246),Hr=n(2202),zr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Wr.a,Object(k.__assign)({},this.props,{dataAutomationType:"TaskPaneComboBox"},Object(Hr.a)(Lr.a.Small,this.props)))},t}(O.PureComponent),Vr=n(2222),Gr=n(1118),Ur=n(1293),qr=Object(Po.c)((function(e){var t=Object(Ur.a)(!1),n={splitButtonMenuButton:[{height:26,width:26,backgroundColor:t.defaultBackgroundColor,selectors:{":hover":{backgroundColor:t.hoverBackgroundColor},":active":{backgroundColor:t.pressedBackgroundColor}}}],splitButtonDivider:{height:13,right:26},splitButtonContainer:{height:26,selectors:{":hover button":{borderColor:t.hoverBackgroundColor},":active button":{borderColor:t.pressedBackgroundColor}}},splitButtonMenuButtonExpanded:{backgroundColor:t.toggledBackgroundColor,selectors:{":hover":{backgroundColor:t.hoverBackgroundColor}}},splitButtonMenuButtonDisabled:{backgroundColor:t.disabledBackgroundColor}};return Object(V.I)(n,e)})),Qr=Object(Po.c)((function(e,t,n,o){return Object(Gr.b)(t,Lr.a.Small,n,Object(V.I)(Object(Gr.a)(e,o),Object(Mr.a)(!0),qr()))})),Kr=Object(Po.c)((function(e){return Object(V.I)(Object(Mr.a)(!1),qr(e))})),Jr=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.label,o=t.hideLabel,r=t.styles;return O.createElement(Bo.a,null,(function(t){return O.createElement(Vr.a,Object(k.__assign)({},e.props,{styles:Qr(t,n,o,r),dataAutomationType:"TaskPaneActionSplitButton"}))}))}}(O.PureComponent),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=Kr(this.props.styles);return O.createElement(Vr.a,Object(k.__assign)({},this.props,{styles:e,dataAutomationType:"TaskPaneSplitButton"}))},t}(O.PureComponent)),Zr=n(328),Yr=n(2356),Xr=Object(Po.c)((function(e,t,n){return Object(V.I)(Object(Zr.a)(e,!!t),Object(Mr.a)(!0,n))})),$r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){var n=Object(Zr.b)(e.props,Lr.a.Small,Xr(t,e.props.hideChevron,e.props.styles));return O.createElement(Yr.a,Object(k.__assign)({},e.props,{styles:Object(Fr.b)(t,n),dataAutomationType:"TaskPaneActionFlyoutAnchor",keytipProps:void 0}))}))},t}(O.PureComponent),ei=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Yr.a,Object(k.__assign)({},this.props,{styles:Object(Mr.a)(!1,this.props.styles),dataAutomationType:"TaskPaneFlyoutAnchor",keytipProps:void 0}))},t}(O.PureComponent),ti=n(204),ni=function(e){function t(t){var n=e.call(this,t)||this;return n.renderControlFromCommandId=function(e,t){var o,r=e[t];if(!r)throw i.a.shipAssertTag(508074143,a.a.msoulscat_ES_EWAJS,!1,"ControlProps not found for commandId: ".concat(t,". Did you add it to the controlsToRender property?")),new Error("ControlProps not found for commandId: ".concat(t));var s=Object(k.__assign)(Object(k.__assign)({},r),{location:ti.b.TaskPane,shouldTakeFocus:null!==(o=n.shouldGridTakeFocus)&&void 0!==o?o:r.shouldTakeFocus});switch(s.type){case"AppToggleButtonProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(Ar,Object(k.__assign)({},s,{hideLabel:!0},n.getOverridePropsForCommandId(s.id,e)))}));case"AppButtonProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(Nr.b,Object(k.__assign)({},s,{hideLabel:!1},n.getOverridePropsForCommandId(s.id,e)))}));case"AppComboBoxProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(zr,Object(k.__assign)({},s,{downChevronIcon:ir.a.downChevron},n.getOverridePropsForCommandId(s.id,e)))}));case"AppFontPickerProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(_r.a,Object(k.__assign)({},s,{downChevronIcon:ir.a.downChevron},n.getOverridePropsForCommandId(s.id,e)))}));case"AppSplitButtonProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(Jr,Object(k.__assign)({},r,{downChevronIcon:ir.a.downChevron.icon8,controlInMenuRendererFunction:n.defaultRibbonControlInMenuRendererFunction,hideLabel:!0},n.getOverridePropsForCommandId(s.id,e)))}));case"AppIconFullGalleryProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(pn.a,Object(k.__assign)({},s,n.getOverridePropsForCommandId(s.id,e)))}));case"AppFlyoutAnchorProps":return O.createElement(Bo.a,null,(function(e){return O.createElement(ei,Object(k.__assign)({},s,{controlInMenuRendererFunction:n.defaultRibbonControlInMenuRendererFunction},n.getOverridePropsForCommandId(s.id,e)))}));default:return n.defaultRibbonControlRendererFunction(s)}},n.state={},n.defaultRibbonControlInMenuRendererFunction=Object(Pr.c)(ir.a,Object(Dr.a)()),n.defaultRibbonControlRendererFunction=Object(Rr.a)(ir.a,n.defaultRibbonControlInMenuRendererFunction),n}return Object(k.__extends)(t,e),Object.defineProperty(t.prototype,"shouldGridTakeFocus",{get:function(){return!Object(yt.isChangeGateEnabled)("OfficeVSO:8428800_FocusFixOnFontTab")&&void 0},enumerable:!1,configurable:!0}),t.prototype.render=function(){return O.createElement(wr,{taskPaneId:this.props.taskPaneId,controlsToRender:this.controlsToRender,customViewRendererFunction:this.renderTab})},t}(O.Component),oi=function(e){function t(t){var n=e.call(this,t)||this;return n.getOverridePropsForCommandId=function(e,t){switch(e){case Vo.b.Wrap:return Object(k.__assign)(Object(k.__assign)({},er.storeConnectedIconButtonsStyles),{hideLabel:!1});case Vo.b.Merge:return Object(k.__assign)(Object(k.__assign)({},er.mergeSplitButtonStyles),{hideLabel:!1});default:return{}}},n.renderTab=function(e){return O.createElement(Qe.a,{horizontal:!0},n.renderControlFromCommandId(e,Vo.b.Wrap),n.renderControlFromCommandId(e,Vo.b.Merge))},n.controlsToRender=[Vo.b.Wrap,Vo.b.Merge],n}return Object(k.__extends)(t,e),t}(ni),ri=[{text:ExcelRibbonStrings.HorizontalAlignmentOptionsGeneral,key:0},{text:ExcelRibbonStrings.HorizontalAlignmentOptionsLeft,key:1},{text:ExcelRibbonStrings.HorizontalAlignmentOptionsCenter,key:2},{text:ExcelRibbonStrings.HorizontalAlignmentOptionsRight,key:3},{text:ExcelRibbonStrings.HorizontalAlignmentOptionsCenterAcrossSelection,key:6}],ii=[{text:ExcelRibbonStrings.VerticalAlignmentOptionsTop,key:0},{text:ExcelRibbonStrings.VerticalAlignmentOptionsCenter,key:1},{text:ExcelRibbonStrings.VerticalAlignmentOptionsBottom,key:2}],ai=[{unitType:"Number",unitPlaceholder:"{0}",minValue:-90,maxValue:90,step:1}],si=[{unitType:"Number",unitPlaceholder:"{0}",minValue:0,maxValue:250,step:1}],li={negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberNegativePattern:0,numberGroupSeparator:",",numberGroupSizes:[3]},ci=function(e){function t(t){var n=e.call(this,t)||this;return n.horizontalAlignmentDropdownRef=O.createRef(),n.verticalAlignmentDropdownRef=O.createRef(),n.wrapTextButtonRef=O.createRef(),n.mergeCellsButtonRef=O.createRef(),n.flipVerticalButtonRef=O.createRef(),n.onHorizontalAlignmentChanged=function(e,t){var o;t&&n.alignmentCallbacks.onHorizontalAlignmentChange(Number(t.key)),null===(o=n.horizontalAlignmentDropdownRef.current)||void 0===o||o.focus()},n.onVerticalAlignmentChanged=function(e,t){var o;t&&n.alignmentCallbacks.onVerticalAlignmentChange(Number(t.key)),null===(o=n.verticalAlignmentDropdownRef.current)||void 0===o||o.focus()},n.onOrientationChanged=function(e){var t;t="string"==typeof e.value?parseInt(e.value,10):e.value,n.alignmentCallbacks.onOrientationChange(t)},n.onIndentationChanged=function(e){var t;t="string"==typeof e.value?parseInt(e.value,10):e.value,n.alignmentCallbacks.onIndentationChange(t)},n.state={},n.isAlignmentPaneCleanUpEnabled=Object(yt.isChangeGateEnabled)("OfficeVSO:8444537_AlignmentPaneCleanUp"),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(Do.Consumer,null,(function(n){var o;return e.alignmentModel=null===(o=null==n?void 0:n.viewModelData)||void 0===o?void 0:o.alignmentModel,e.alignmentCallbacks=null==n?void 0:n.callbacks.alignmentCallbacks,O.createElement("div",{style:{marginLeft:"17px",marginRight:"15px"}},O.createElement("div",{style:er.alignRowDivStyles(!1)},O.createElement(nr.a,{type:"AppDropdownProps",id:"HorizontalAlignment",componentRef:e.horizontalAlignmentDropdownRef,label:ExcelRibbonStrings.HorizontalAlignmentDropdownLabel,selectedKey:e.alignmentModel.horizontalAlignmentType,options:ri,styles:er.alignmentDropDownStyles(t),onChange:e.onHorizontalAlignmentChanged,onRenderCaretDown:sr,dropdownWidth:"auto"}),O.createElement(or.a,{id:"indentation",type:"AppSpinButtonProps",numberFormatInfo:li,incrementButtonIcon:W.a.CommonControlChevronUp_12,decrementButtonIcon:W.a.CommonControlChevronDown_12,label:ExcelRibbonStrings.IndentLabel,validUnits:si,styles:er.alignmentSpinButtonStyles(t,!0),unitType:si[0].unitType,value:e.alignmentModel.indent,onExecute:e.onIndentationChanged,labelPosition:tr.a.top})),O.createElement("div",{style:er.alignRowDivStyles(!1)},O.createElement(nr.a,{type:"AppDropdownProps",id:"VerticalAlignment",componentRef:e.verticalAlignmentDropdownRef,label:ExcelRibbonStrings.VerticalAlignmentDropdownLabel,selectedKey:e.alignmentModel.verticalAlignmentType,options:ii,styles:er.alignmentDropDownStyles(t),onChange:e.onVerticalAlignmentChanged,dropdownWidth:"auto",onRenderCaretDown:sr})),O.createElement(jo.a,{id:"TextControlLabel",type:"AppLabelProps",forId:"TextControl",label:ExcelRibbonStrings.TextControlLabel,styles:er.textControlLabelStyles}),O.createElement("div",{id:"TextControl",style:er.alignRowDivStyles(!0,!0),"aria-label":ExcelRibbonStrings.TextControlLabel},!e.isAlignmentPaneCleanUpEnabled&&O.createElement(rr.a,{id:"WrapTextIcon",componentRef:e.wrapTextButtonRef,iconProps:{iconName:h.a.WrapText_20},onClick:function(){var t;e.alignmentCallbacks.wrapText(!e.alignmentModel.isWrapText),null===(t=e.wrapTextButtonRef.current)||void 0===t||t.focus()},checked:e.alignmentModel.isWrapText,toggle:!0,styles:er.iconButtonStyles(!1),text:ExcelRibbonStrings.AlignmentTextControlWrapText}),!e.isAlignmentPaneCleanUpEnabled&&O.createElement(rr.a,{id:"MergeCellsIcon",componentRef:e.mergeCellsButtonRef,iconProps:{iconName:h.a.MergeCells_20},checked:e.alignmentModel.isMergeCells,disabled:e.alignmentModel.isMergeCellsDisabled,onClick:function(){var t;e.alignmentCallbacks.mergeCells(!e.alignmentModel.isMergeCells),null===(t=e.mergeCellsButtonRef.current)||void 0===t||t.focus()},toggle:!0,styles:er.iconButtonStyles(!1,"10px"),text:ExcelRibbonStrings.AlignmentTextControlMergeCells}),e.isAlignmentPaneCleanUpEnabled&&O.createElement(oi,Object(k.__assign)({},e.props))),O.createElement("div",{style:er.verticalOrientationDivStyles},O.createElement(or.a,{id:"orientaion",type:"AppSpinButtonProps",numberFormatInfo:li,incrementButtonIcon:W.a.CommonControlChevronUp_12,decrementButtonIcon:W.a.CommonControlChevronDown_12,disabled:e.alignmentModel.indent>0,label:ExcelRibbonStrings.OrientationLabel,validUnits:ai,styles:er.alignmentSpinButtonStyles(t,!1),unitType:ai[0].unitType,value:e.alignmentModel.orientation,onExecute:e.onOrientationChanged,labelPosition:tr.a.top}),O.createElement(rr.a,{id:"FlipVerticalIcon",componentRef:e.flipVerticalButtonRef,iconProps:{iconName:h.a.RotateCharacters_16},toggle:!0,checked:e.alignmentModel.isFlipVertical,styles:er.iconButtonStyles(!0),onClick:function(){var t;e.alignmentCallbacks.flipVertical(!e.alignmentModel.isFlipVertical),null===(t=e.flipVerticalButtonRef.current)||void 0===t||t.focus()},text:ExcelRibbonStrings.FlipVerticalLabel})))}))}))},t.prototype.componentDidUpdate=function(){cr("AlignmentTab::Update::End","AlignmentTab::Update::Start"),cr("AlignmentTab::CmdUpdate::End","AlignmentTab::CmdUpdate::Start",!0)},t}(O.Component),ui=n(760),di={scrollablePaneStyles:{root:{height:118,position:"relative"}},categoryIconStyles:{root:{marginRight:"8px",height:"16px",width:"16px",top:"3px",position:"relative"}},tooltipHostStyles:{root:{width:"10px",height:"10px",marginLeft:"17px"}},tooltipIconStyles:{root:{height:"10px",width:"10px"}},categoryDescriptionStyles:Object(Po.c)((function(e){return{root:{fontSize:"12px",width:"270px",marginLeft:"8px",height:"32px",display:"block",color:e.palette.neutralDark}}})),categoryDropdownStyles:Object(Po.c)((function(e){return{root:{width:"286px",height:"38px",background:"unset",marginLeft:"17px",marginBottom:"41px"},dropdown:{height:"41px"},label:{marginBottom:"5px",fontSize:"12px"},title:{height:"41px",paddingTop:"6px",paddingBottom:"6px",borderColor:"transparent",borderRadius:"4px",fontWeight:V.l.semibold,color:e.palette.neutralDark,boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",":hover":{borderColor:"transparent !important"}},caretDownWrapper:{paddingTop:"5px",paddingBottom:"5px"},callout:{width:"288px",height:"320px"}}})),categoryDivStyles:{display:"flex",flexDirection:"row",marginTop:"8px",marginLeft:"17px",marginBottom:"8px"}},pi=n(194),hi={dropdownStyles:Object(Po.c)((function(e){return{root:{width:"140px",height:"24px",marginLeft:"17px",background:"unset"},title:{height:"24px",paddingBottom:"3px",border:"unset",lineHeight:"24px"},callout:{height:"360px",borderRadius:"2px"},label:{fontSize:"12px",marginBottom:"4px",height:"16px",paddingBottom:"0px",paddingTop:"0px"},dropdown:{height:"26px",border:"1px solid "+e.palette.neutralQuaternary,borderRadius:"2px"},caretDownWrapper:{height:"16px",paddingBottom:"3px",paddingTop:"0px",lineHeight:"24px"}}})),decimalSpinnerStyles:Object(Po.c)((function(e){return{root:{left:"17px",position:"relative",paddingLeft:"0px"},spinButtonWrapper:{width:"140px",height:"24px",border:"1px solid",borderColor:e.palette.neutralQuaternary+" !important",borderRadius:"2px",background:e.palette.white},labelWrapper:{marginBottom:"4px",width:"140px",height:"16px"},label:{fontSize:"12px",fontWeight:V.l.semibold}}})),stackStyles:{root:{width:"288px"}},decimalStackItemStyles:{root:{width:"140px"}},symbolStackItemStyles:{root:{width:"140px",marginRight:"8px"}}},gi=O.memo((function(e){var t=function(t,n){var o;(o="string"==typeof(null==n?void 0:n.key)?parseInt(n.key,10):null==n?void 0:n.key)!==e.currencyType&&e.onSymbolChanged(o)},n=function(e){for(var t=[],n=0;n<((null==e?void 0:e.length)||0);n++)t.push({key:n,text:e[n]||""});return t};return O.createElement(Bo.a,null,(function(o){return O.createElement(nr.a,{type:"AppDropdownProps",id:"currencyDropdown",label:ExcelFormatcellsTaskpaneStrings.SymbolLabel,selectedKey:e.currencyType,options:n(e.currencySymbols),placeholder:ExcelRibbonStrings.NumberFormatAccountingCurrencySymbol,styles:hi.dropdownStyles(o),onChange:t,responsiveMode:ui.a.large,dropdownWidth:212,onRenderCaretDown:sr})}))}),(function(e,t){return Object(pi.e)(e.currencySymbols,t.currencySymbols)&&e.currencyType===t.currencyType})),mi=[{unitType:"Number",unitPlaceholder:"{0}",minValue:0,maxValue:30,step:1}],fi={negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberNegativePattern:0,numberGroupSeparator:",",numberGroupSizes:[3]},bi=O.memo((function(e){var t=O.useState(e.decimalPlaces),n=t[0],o=t[1];return O.useEffect((function(){o(e.decimalPlaces)}),[e.decimalPlaces]),O.createElement(Bo.a,null,(function(t){return O.createElement(or.a,{type:"AppSpinButtonProps",id:"decimalPlacesSpinner",label:ExcelFormatcellsTaskpaneStrings.DecimalPlacesLabel,labelPosition:tr.a.top,value:n,validUnits:mi,onExecute:function(t){return function(t){var n;(n="string"==typeof t.value?parseInt(t.value,10):t.value)!==e.decimalPlaces&&(o(n),e.onDecimalPlacesChanged(n))}(t)},incrementAriaLabel:ExcelFormatcellsTaskpaneStrings.DecimalPlacesIncrementAriaLabel,decrementAriaLabel:ExcelFormatcellsTaskpaneStrings.DecimalPlacesDecrementAriaLabel,styles:hi.decimalSpinnerStyles(t),unitType:mi[0].unitType,numberFormatInfo:fi,incrementButtonIcon:W.a.CommonControlChevronUp_12,decrementButtonIcon:W.a.CommonControlChevronDown_12})}))}),(function(e,t){return e.decimalPlaces===t.decimalPlaces})),vi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Do.Consumer,null,(function(t){var n,o,r,i,a,s;return O.createElement(O.Fragment,null,O.createElement(Qe.a,{horizontal:!0,styles:hi.stackStyles},e.props.isSymbolVisible&&O.createElement(Qe.a.Item,{grow:1,styles:hi.symbolStackItemStyles},O.createElement(gi,{currencyType:null===(o=null===(n=null==t?void 0:t.viewModelData)||void 0===n?void 0:n.numberFormatModel)||void 0===o?void 0:o.currencyType,currencySymbols:null===(i=null===(r=null==t?void 0:t.viewModelData)||void 0===r?void 0:r.numberFormatModel)||void 0===i?void 0:i.currencySymbols,onSymbolChanged:null==t?void 0:t.callbacks.numberFormatCallbacks.onSymbolChanged})),O.createElement(Qe.a.Item,{grow:1,styles:hi.decimalStackItemStyles},O.createElement(bi,{decimalPlaces:null===(s=null===(a=null==t?void 0:t.viewModelData)||void 0===a?void 0:a.numberFormatModel)||void 0===s?void 0:s.decimalPlaces,onDecimalPlacesChanged:null==t?void 0:t.callbacks.numberFormatCallbacks.onDecimalPlacesChanged}))))}))},t}(O.PureComponent),yi=n(2256),xi=Object(Po.c)((function(e){return{root:{left:"17px",position:"relative"},spinButtonWrapper:{width:"140px",height:"24px",border:"1px solid",borderColor:e.palette.neutralTertiaryAlt,borderRadius:"2px",background:e.palette.white},labelWrapper:{fontSize:"12px",fontWeight:V.l.semibold}}})),Ci=Object(Po.c)((function(e,t){return{root:{left:"17px",marginTop:"8px",border:"none",paddingLeft:"0px",height:"16px",borderRadius:"2px"},text:{fontSize:"12px",lineHeight:"16px",marginLeft:"8px"},checkbox:[t&&{background:e.palette.themePrimary},{marginRight:"0px"}]}})),Si=Object(Po.c)((function(e){return{root:{height:"24px",minHeight:"24px",borderBottom:"unset"},cell:{color:e,minHeight:"24px",height:"24px",paddingTop:"0px",paddingBottom:"0px",display:"flex",alignItems:"center"}}})),Ei=Object(Po.c)((function(e){return{root:{height:"24px",minHeight:"24px",borderBottom:"unset"},cell:{color:e.palette.neutralDark,minHeight:"24px",height:"24px",paddingTop:"0px",paddingBottom:"0px",display:"flex",alignItems:"center"}}})),ki={decimalButtonStyles:xi,thousandSeparatorCheckBoxStyles:Ci,detailListLabelStyles:{root:{left:"17px",position:"relative",marginTop:"11px",paddingLeft:"0px",label:{fontSize:"12px",fontWeight:V.l.semibold}}},negativeDetailListRowStyles:Si,typeDetailListStyles:Object(Po.c)((function(e,t){var n;return{root:{left:"17px",width:"288px",height:"97px",overflowX:"hidden",border:"1px solid",borderRadius:"2px",borderColor:e.palette.neutralQuaternary,selectors:(n={},n[".ms-List-cell"]={minHeight:"24px",height:"24px",paddingTop:"0px",paddingBottom:"0px"},n[".is-selected"]={background:0===t?e.palette.white:e.palette.neutralLight,fontStyle:0===t?"italic":"normal"},n)},focusZone:{},headerWrapper:{},contentWrapper:{}}})),detailListRowStyles:Ei},Oi=function(e){function t(t){var n=e.call(this,t)||this;return n.onThousandSeparatorChanged=function(e){n.props.onThousandSeparatorChanged(e.checked)},n.state={},n}return Object(k.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.isChecked!==e.isChecked},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(O.Fragment,null,O.createElement(yi.a,{type:"AppCheckboxProps",id:"thousandSeparatorCheckbox",label:ExcelFormatcellsTaskpaneStrings.ThousandsSeparatorLabel,checked:e.props.isChecked,onExecute:e.onThousandSeparatorChanged,styles:ki.thousandSeparatorCheckBoxStyles(t,e.props.isChecked),iconColor:t.palette.white,checkmarkIcon:c.a.CheckmarkWithDynamicColor_16}))}))},t}(O.Component),Ti=n(2290),Ii=n(1977),wi=n(951),_i=n(1098),Pi=n(102),Ri=Object(Ti.a)(Ii.a,Math.floor(4)-1,24),Di=function(e){function t(t){var n=e.call(this,t)||this;return n.detailsListRef=O.createRef(),n.selection=new wi.a({onSelectionChanged:function(){n.onTypeChanged()}}),n.generateLabel=function(e){return O.createElement(jo.a,{id:"typeLabel",type:"AppLabelProps",forId:"typeDetailsList",label:e,styles:ki.detailListLabelStyles})},n.onItemInvoked=function(e){n.selection.toggleIndexSelected(n.props.currentType),n.selection.toggleIndexSelected(e.key)},n.onRenderNegativeTypeRow=function(e){return O.createElement(Bo.a,null,(function(t){var o="#E41323";return e.itemIndex%2==0&&(o=t.palette.neutralDark),n.setSelectedRow(e),O.createElement(_i.a,Object(k.__assign)({},e,{styles:ki.negativeDetailListRowStyles(o)}))}))},n.onRenderRow=function(e){return O.createElement(Bo.a,null,(function(t){return n.setSelectedRow(e),O.createElement(_i.a,Object(k.__assign)({},e,{styles:ki.detailListRowStyles(t)}))}))},n.getItems=function(e){var t=[];if(e&&0!==e.length)for(var n=0;e&&n<e.length;n++)t.push({key:n,text:e[n]||"",value:e[n]||""});else t.push({key:0,text:ExcelFormatcellsTaskpaneStrings.EmptyTypeDescription,value:ExcelFormatcellsTaskpaneStrings.EmptyTypeDescription});return t},n.setSelectedRow=function(e){e.itemIndex===n.props.currentType&&e.selection.setIndexSelected(n.props.currentType,!0,!1)},n.columns=[{key:"value",name:"Value",fieldName:"value",isResizable:!1,minWidth:50}],n}return Object(k.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return!Object(pi.e)(this.props.items,e.items)||this.props.currentType!==e.currentType},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(O.Fragment,null,e.props.isNegativeNumberType?e.generateLabel(ExcelFormatcellsTaskpaneStrings.NegativeNumbersLabel):e.generateLabel(ExcelFormatcellsTaskpaneStrings.TypeLabel),O.createElement(Ri,{items:e.getItems(e.props.items),id:"typeDetailsList",type:"AppDetailsListProps",componentRef:e.detailsListRef,columns:e.columns,compact:!1,selectionMode:Pi.d.single,selectionPreservedOnEmptyClick:!0,selection:e.selection,isHeaderVisible:!1,isSelectedOnFocus:!1,ariaLabelForGrid:e.props.isNegativeNumberType?ExcelFormatcellsTaskpaneStrings.NegativeNumbersLabel:ExcelFormatcellsTaskpaneStrings.TypeLabel,role:e.props.isNegativeNumberType?ExcelFormatcellsTaskpaneStrings.NegativeNumbersLabel:ExcelFormatcellsTaskpaneStrings.TypeLabel,onItemInvoked:e.onItemInvoked,styles:ki.typeDetailListStyles(t,e.props.items?e.props.items.length:0),onRenderRow:e.props.isNegativeNumberType?e.onRenderNegativeTypeRow:e.onRenderRow}))}))},t.prototype.onTypeChanged=function(){var e,t;if(0!==this.selection.getSelectedCount()){var n=this.selection.getSelection()[0],o=void 0;(o="string"==typeof(null==n?void 0:n.key)?parseInt(n.key,10):null==n?void 0:n.key)!==this.props.currentType&&(this.props.onTypeChanged(o),Object(yt.isChangeGateEnabled)("OfficeVSO:8468791_NumberTabFocusFix")&&(null===(e=this.detailsListRef.current)||void 0===e||e.focusIndex(o))),Object(yt.isChangeGateEnabled)("OfficeVSO:8468791_NumberTabFocusFix")||null===(t=this.detailsListRef.current)||void 0===t||t.focusIndex(o)}},t}(O.Component),ji=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r,i,a,s;return O.createElement(O.Fragment,null,O.createElement(vi,{isSymbolVisible:!1}),O.createElement(Oi,{isChecked:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.isComma,onThousandSeparatorChanged:null===(o=e.callbacks.numberFormatCallbacks)||void 0===o?void 0:o.onThousandSeparatorChanged}),O.createElement(Di,{items:null===(i=null===(r=null==e?void 0:e.viewModelData)||void 0===r?void 0:r.numberFormatModel)||void 0===i?void 0:i.negativeNumberTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onNegativeNumberTypeChanged,isNegativeNumberType:!0,currentType:null===(s=null===(a=null==e?void 0:e.viewModelData)||void 0===a?void 0:a.numberFormatModel)||void 0===s?void 0:s.negativeNumberType}))}))},t}(O.Component),Bi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r;return O.createElement(O.Fragment,null,O.createElement(vi,{isSymbolVisible:!0}),O.createElement(Di,{items:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.negativeCurrencyTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onNegativeCurrencyTypeChanged,isNegativeNumberType:!0,currentType:null===(r=null===(o=null==e?void 0:e.viewModelData)||void 0===o?void 0:o.numberFormatModel)||void 0===r?void 0:r.negativeCurrencyType}))}))},t}(O.Component),Fi={infoStyle:{display:"flex",justifyContent:"space-between",marginTop:"5px"},localeStyle:{marginLeft:"17px"},calendarCheckBoxStyles:{root:{paddingTop:"10px",paddingBottom:"10px"},checkbox:{height:"18px",width:"18px",borderRadius:"2px"}},localeDropdownStyles:{root:{marginTop:"5px",marginBottom:"5px",maxWidth:"288px",background:Qo().backgroundTransparent},dropdownOptionText:{fontFamily:"Segoe UI",fontWeight:V.l.regular,fontSize:"12px"},label:{fontSize:"12px"},title:{borderColor:"transparent",fontWeight:V.l.regular,fontSize:"12px",borderRadius:"2px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",":hover":{borderColor:"transparent !important"}},dropdownItemsWrapper:{maxHeight:"196px"}},applyLocaleButtonStyles:Object(Po.c)((function(e){return{root:{marginTop:"10px",marginBottom:"10px",background:e.palette.white,borderRadius:"2px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)"}}})),learnMoreDivStyles:{marginTop:"8px",paddingBottom:"10px"}},Li=n(1976),Mi=void 0,Ai=void 0,Ni=function(e){function t(t){var n=e.call(this,t)||this;return n.calendarDropDownComponent=function(){var e,t,o;return Mi=null===(e=n.numberFormatModel)||void 0===e?void 0:e.calendarType,O.createElement(O.Fragment,null,O.createElement(nr.a,{type:"AppDropdownProps",id:"CalendarTypeDropDown",label:ExcelRibbonStrings.NumberFormatLocaleCalendarType,selectedKey:Mi,options:n.getdropdownOptions(null===(t=n.numberFormatModel)||void 0===t?void 0:t.calendarTypes),styles:Fi.localeDropdownStyles,onChange:n.onCalendarOptionChanged,onRenderCaretDown:sr}),(null===(o=n.numberFormatModel)||void 0===o?void 0:o.isInputCalendarCheckboxRequired)&&n.calendarTypeCheckbox())},n.calendarTypeCheckbox=function(){var e,t;return O.createElement(O.Fragment,null,(null===(e=n.numberFormatModel)||void 0===e?void 0:e.isGannenCheckboxRequired)&&n.gannenCheckbox(),O.createElement(yi.a,{type:"AppCheckboxProps",id:"calendarCheckBox",label:ExcelRibbonStrings.NumberFormatLocaleInputCalendarLabel,checked:null===(t=n.numberFormatModel)||void 0===t?void 0:t.isInputCalendarChecked,onExecute:n.onCalendarCheckboxChange,styles:Fi.calendarCheckBoxStyles,checkmarkIcon:ir.a.checkboxCheckmark}))},n.gannenCheckbox=function(){var e;return O.createElement(yi.a,{type:"AppCheckboxProps",id:"gannenCheckbox",label:ExcelRibbonStrings.NumberFormatLocaleGannen,checked:null===(e=n.numberFormatModel)||void 0===e?void 0:e.isGannenChecked,onExecute:n.onGannenCheckboxChange,styles:Fi.calendarCheckBoxStyles,checkmarkIcon:ir.a.checkboxCheckmark})},n.applyLocaleButtonComponent=function(e){return O.createElement($t.a,{type:"AppButtonProps",id:"OverrideLocaleButton",label:ExcelRibbonStrings.NumberFormatLocaleApplyButtonText,customTooltip:ExcelRibbonStrings.NumberFormatLocaleApplyButtonToolTip,icon:"Info",onExecute:n.numberFormatCallbacks.overrideLocale,styles:Fi.applyLocaleButtonStyles(e)})},n.getdropdownOptions=function(e){for(var t=[],n=0;n<e.length;n++)t.push({key:n,text:e[n]||""});return t},n.onCalendarOptionChanged=function(e,t){t&&Mi!==Number(t.key)&&n.numberFormatCallbacks.onCalendarTypeChanged(Number(t.key))},n.onCalendarCheckboxChange=function(e){n.numberFormatCallbacks.onInputCalendarChecked(e.checked)},n.onGannenCheckboxChange=function(e){n.numberFormatCallbacks.onGannenChecked(e.checked)},n.onLocaleOptionChanged=function(e,t){t&&Ai!==Number(t.key)&&n.numberFormatCallbacks.onLocaleChanged(Number(t.key))},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(Do.Consumer,null,(function(n){var o,r,i,a,s,l;return e.numberFormatModel=null===(o=null==n?void 0:n.viewModelData)||void 0===o?void 0:o.numberFormatModel,e.numberFormatCallbacks=null==n?void 0:n.callbacks.numberFormatCallbacks,Ai=null===(r=e.numberFormatModel)||void 0===r?void 0:r.localeIndex,O.createElement("div",{style:Fi.localeStyle},O.createElement(nr.a,{type:"AppDropdownProps",id:"LocaleDropdown",label:ExcelRibbonStrings.NumberFormatLocale,selectedKey:Ai,options:e.getdropdownOptions(null===(i=e.numberFormatModel)||void 0===i?void 0:i.localeOptions),styles:Fi.localeDropdownStyles,onChange:e.onLocaleOptionChanged,onRenderCaretDown:sr}),4===(null===(a=e.numberFormatModel)||void 0===a?void 0:a.currentCategory)&&(null===(s=e.numberFormatModel)||void 0===s?void 0:s.calendarTypes)&&e.calendarDropDownComponent(),0!==(null===(l=e.numberFormatModel)||void 0===l?void 0:l.localeIndex)&&e.applyLocaleButtonComponent(t),O.createElement("div",{style:Fi.learnMoreDivStyles},O.createElement(Li.a,{type:"AppLinkProps",id:"LearnMoreLink",text:ExcelRibbonStrings.NumberFormatLocaleLearnMore,handler:{href:"https://go.microsoft.com/fwlink/p/?linkid=2134522",target:"_blank"}})))}))}))},t}(O.Component),Wi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r;return O.createElement(O.Fragment,null,O.createElement(Di,{items:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.dateTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onDateTypeChanged,isNegativeNumberType:!1,currentType:null===(r=null===(o=null==e?void 0:e.viewModelData)||void 0===o?void 0:o.numberFormatModel)||void 0===r?void 0:r.dateType}),O.createElement(Ni,null))}))},t}(O.PureComponent),Hi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r;return O.createElement(O.Fragment,null,O.createElement(Di,{items:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.timeTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onTimeTypeChanged,isNegativeNumberType:!1,currentType:null===(r=null===(o=null==e?void 0:e.viewModelData)||void 0===o?void 0:o.numberFormatModel)||void 0===r?void 0:r.timeType}),O.createElement(Ni,null))}))},t}(O.Component),zi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r;return O.createElement(Di,{items:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.fractionTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onFractionTypeChanged,isNegativeNumberType:!1,currentType:null===(r=null===(o=null==e?void 0:e.viewModelData)||void 0===o?void 0:o.numberFormatModel)||void 0===r?void 0:r.fractionType})}))},t}(O.Component),Vi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r;return O.createElement(O.Fragment,null,O.createElement(Di,{items:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.specialTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onSpecialTypeChanged,isNegativeNumberType:!1,currentType:null===(r=null===(o=null==e?void 0:e.viewModelData)||void 0===o?void 0:o.numberFormatModel)||void 0===r?void 0:r.specialType}),O.createElement(Ni,null))}))},t}(O.Component),Gi=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Do.Consumer,null,(function(e){var t,n,o,r;return O.createElement(O.Fragment,null,O.createElement(Di,{items:null===(n=null===(t=null==e?void 0:e.viewModelData)||void 0===t?void 0:t.numberFormatModel)||void 0===n?void 0:n.customTypes,onTypeChanged:null==e?void 0:e.callbacks.numberFormatCallbacks.onCustomTypeChanged,isNegativeNumberType:!1,currentType:null===(r=null===(o=null==e?void 0:e.viewModelData)||void 0===o?void 0:o.numberFormatModel)||void 0===r?void 0:r.customType}))}))},t}(O.Component),Ui={cardStyles:Object(Po.c)((function(e){return{height:"40px",width:"288px",background:e.palette.white}})),loaderDivStyles:{marginLeft:"17px"},categoryLabelStyles:{root:{paddingLeft:"0px",label:{fontSize:"12px",fontWeight:V.l.semibold}}},shimmerStyles:Object(Po.c)((function(e){return{root:{marginLeft:"13px",top:e?"0px":"13px",marginTop:e?"13px":"0px",marginBottom:e?"8px":"13px",height:"14px",width:"101px",borderRadius:"4px",background:"#DCD9D9"}}}))},qi=function(){return O.createElement(Bo.a,null,(function(e){return O.createElement("div",{id:"shimmerNumberFormat",style:Ui.cardStyles(e)},O.createElement(j.a,{styles:Ui.shimmerStyles()}))}))},Qi=function(){return O.createElement("div",{style:Ui.loaderDivStyles},O.createElement(jo.a,{type:"AppLabelProps",id:"numberFormatShimmerLabel",forId:"shimmerNumberFormat",label:ExcelFormatcellsTaskpaneStrings.ChooseCategoryLabel,styles:Ui.categoryLabelStyles}),qi(),O.createElement(j.a,{styles:Ui.shimmerStyles(!0)}),qi(),qi(),qi())},Ki=void 0,Ji=function(e){function t(t){var n=e.call(this,t)||this;return n.categoryDropdownRef=O.createRef(),n.iconNames=[W.a.General_16,W.a.DataTypeNumber_16,W.a.InternationalCurrency_16,W.a.Accounting_16,W.a.NewCalendar_16,W.a.Clock_16,W.a.Percentage_16,W.a.Fraction_16,W.a.DataTypeScientific_16,W.a.Text_16,W.a.EditCode_16,W.a.PbiDataFormat_16],n.getToolTipDescriptions=[ExcelFormatcellsTaskpaneStrings.GeneralTooltipContent,ExcelFormatcellsTaskpaneStrings.NumberTooltipContent,ExcelFormatcellsTaskpaneStrings.CurrencyTooltipContent,ExcelFormatcellsTaskpaneStrings.AccountingTooltipContent,ExcelFormatcellsTaskpaneStrings.DateTooltipContent,ExcelFormatcellsTaskpaneStrings.TimeTooltipContent,ExcelFormatcellsTaskpaneStrings.PercentageTooltipContent,ExcelFormatcellsTaskpaneStrings.FractionTooltipContent,ExcelFormatcellsTaskpaneStrings.ScientificTooltipContent,ExcelFormatcellsTaskpaneStrings.TextTooltipContent,ExcelFormatcellsTaskpaneStrings.SpecialTooltipContent,ExcelFormatcellsTaskpaneStrings.CustomTooltipContent],n.getNumberFormatCategories=function(e){for(var t=[],o=0;o<e.length;o++)t.push({key:o,text:e[o]||"",data:{icon:n.iconNames[o]}});return t},n.onRenderDropdownOption=function(e){return O.createElement("div",null,e.data&&e.data.icon&&O.createElement(H.a,{styles:di.categoryIconStyles,iconName:e.data.icon,"aria-hidden":"true"}),O.createElement("span",null,e.text))},n.onRenderDropdownTitle=function(e){var t=e[0];return n.onRenderDropdownOption(t)},n.onCategoryChanged=function(e,t){var o,r;(r="string"==typeof(null==t?void 0:t.key)?parseInt(t.key,10):null==t?void 0:t.key)!==Ki&&n.callbacks.numberFormatCallbacks.onCategoryTypeChange(r),null===(o=n.categoryDropdownRef.current)||void 0===o||o.focus(!0)},n.state={},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(Do.Consumer,null,(function(n){var o,r,i,a,s,l,c;return e.callbacks=n.callbacks,(null===(o=n.viewModelData)||void 0===o?void 0:o.numberFormatModel)?(Ki=null===(i=null===(r=null==n?void 0:n.viewModelData)||void 0===r?void 0:r.numberFormatModel)||void 0===i?void 0:i.currentCategory,O.createElement("div",{style:{display:"flex"}},O.createElement("div",null,O.createElement(nr.a,{type:"AppDropdownProps",id:"numberFormatCategoryDropdown",componentRef:e.categoryDropdownRef,label:ExcelFormatcellsTaskpaneStrings.ChooseCategoryLabel,selectedKey:Ki,options:e.getNumberFormatCategories(null===(s=null===(a=null==n?void 0:n.viewModelData)||void 0===a?void 0:a.numberFormatModel)||void 0===s?void 0:s.categories),onRenderOption:e.onRenderDropdownOption,onRenderTitle:e.onRenderDropdownTitle,styles:di.categoryDropdownStyles(t),onChange:e.onCategoryChanged,responsiveMode:ui.a.large,onRenderCaretDown:sr}),e.renderCategoryView(Ki),O.createElement("div",{style:di.categoryDivStyles},O.createElement(Z.a,{content:e.getToolTipDescriptions[Ki]},O.createElement(H.a,Object(k.__assign)({role:"tooltip"},Object(co.a)(W.a.Info_20),{styles:di.tooltipIconStyles}))),O.createElement(uo.a,{styles:di.categoryDescriptionStyles(t)},null===(c=null===(l=null==n?void 0:n.viewModelData)||void 0===l?void 0:l.numberFormatModel)||void 0===c?void 0:c.categoryDescriptionStrings[Ki]))))):O.createElement(Qi,null)}))}))},t.prototype.renderCategoryView=function(e){switch(e){case 1:return O.createElement(ji,null);case 2:return O.createElement(Bi,null);case 3:return O.createElement(vi,{isSymbolVisible:!0});case 4:return O.createElement(Wi,null);case 5:return O.createElement(Hi,null);case 6:return O.createElement(vi,{isSymbolVisible:!1});case 7:return O.createElement(zi,null);case 8:return O.createElement(vi,{isSymbolVisible:!1});case 10:return O.createElement(Vi,null);case 11:return O.createElement(Gi,null);default:return O.createElement(O.Fragment,null)}},t.prototype.componentDidUpdate=function(){cr("NumberFormatTab::DelayedUpdate::End","NumberFormatTab::DelayedUpdate::Start",!0),cr("NumberFormatTab::InstantUpdate::End","NumberFormatTab::InstantUpdate::Start",!0)},t}(O.Component),Zi=n(111),Yi=Object(Po.c)((function(e){return{root:{marginTop:e?"5px":"10px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"3px",paddingBottom:"5px",height:"16px"},label:{fontWeight:V.l.semibold,fontSize:"12px",fontStyle:"normal",lineHeight:"16px"}}})),Xi=Object(Po.c)((function(e){return{styles:{container:{marginRight:"0px"},root:{height:"24px",marginRight:"8px",border:"1px solid ".concat(e.palette.neutralLight),borderRadius:"2px",display:"flex",justifyContent:"center",alignItems:"center",selectors:{"input[type=text]":{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px"}}},input:{height:"24px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0}},caretDownButtonStyles:{root:{height:"24px",width:Zi.a.comboBoxCaretWidth,minWidth:Zi.a.comboBoxCaretWidth},icon:{width:"12px",height:"12px",lineHeight:"12px"}}}})),$i={mostOutterDivStyling:{marginLeft:"17px",marginRight:"15px",marginBottom:"10px"},textControlLabelStyles:Yi,fontNameComboBoxStyles:Object(Po.c)((function(e){return Object(k.__assign)({width:207},Xi(e))})),fontPickerStyles:Object(Po.c)((function(e){return{width:207,styles:{root:{height:"24px"},subComponentStyles:{dropDownStyles:{},textFieldStyles:{root:{height:"24px",marginRight:"0px",border:"1px solid ".concat(e.palette.neutralLight),borderTopLeftRadius:"2px",borderBottomLeftRadius:"2px",borderTopRightRadius:"2px",borderBottomRightRadius:"2px",display:"flex",justifyContent:"center",alignItems:"center",selectors:{"input[type=text]":{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",fontSize:"12px"}}}}}}}})),fontSizeComboBoxStyles:Object(Po.c)((function(e){return Object(k.__assign)({pinToPreviousComboBox:!1,width:73,useComboBoxAsMenuWidth:!0},Xi(e))})),iconButtonsStyles:{styles:{root:{marginRight:"8px",paddingLeft:"4px",paddingRight:"4px",height:"27px",width:"32px",border:"unset",backgroundColor:Qo().iconButtonBackgroundRest,color:Qo().iconButtonForegroundRest,display:"flex",alignItems:"center",justifyContent:"center"},splitButtonMenuButton:{backgroundColor:"unset"},rootDisabled:{border:"unset",backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus}}},fontEffectsStackStyles:{root:{marginRight:"15px"}},fontColorSplitButtonStyles:{styles:{splitButtonContainer:{padding:"0px 4px",display:"flex",alignItems:"center",flexShrink:0},root:{padding:"4px 2px 4px 4px",height:"24px",width:"22px",border:"unset",backgroundColor:"unset",display:"flex",alignItems:"center"},rootDisabled:{border:"unset"},splitButtonDivider:{width:"0px"},splitButtonMenuButton:{backgroundColor:"unset",width:"12px",height:"24px",padding:"4px 2px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0,border:"none",outline:"none",selectors:{"span:first-child":{display:"flex",height:"16px"}}},splitButtonMenuIcon:{width:"8px",height:"8px",flexShrink:0}}}},ea=n(153),ta=function(e){function t(t){var n=e.call(this,t)||this;return n.getOverridePropsForCommandId=function(e,t){switch(e){case Vo.b.FontName_New:return $i.fontNameComboBoxStyles(t);case Vo.b.FontPicker:return $i.fontPickerStyles(t);case Vo.b.FontSize:return $i.fontSizeComboBoxStyles(t);case Vo.b.Bold:case Vo.b.Italic:case Vo.b.Underline:case Vo.b.DoubleUnderline:case Vo.b.Strikethrough:return $i.iconButtonsStyles;case Vo.b.FontColor:return $i.fontColorSplitButtonStyles;default:return{}}},n.renderTab=function(e){return O.createElement(Qe.a,{style:$i.mostOutterDivStyling},O.createElement(Qe.a,{horizontal:!0},O.createElement(Qe.a,null,O.createElement(jo.a,{id:"FontDropdownLabel",type:"AppLabelProps",forId:"FontDropdown",label:ExcelFormatcellsTaskpaneStrings.ChooseFontLabel,styles:$i.textControlLabelStyles(!0)}),O.createElement("div",{id:"FontDropdown"},n.renderControlFromCommandId(e,Object(ea.d)("Microsoft.Office.Excel.ModernFontPicker",!1)?Vo.b.FontPicker:Vo.b.FontName_New))),O.createElement(Qe.a,null,O.createElement(jo.a,{id:"FontSizeLabel",type:"AppLabelProps",forId:"FontSize",label:ExcelFormatcellsTaskpaneStrings.SizeLabel,styles:$i.textControlLabelStyles(!0)}),O.createElement("div",{id:"FontSize"},n.renderControlFromCommandId(e,Vo.b.FontSize)))),O.createElement(Qe.a,{horizontal:!0},O.createElement(Qe.a,{styles:$i.fontEffectsStackStyles},O.createElement(jo.a,{id:"FontEffectsLabel",type:"AppLabelProps",forId:"FontEffects",label:ExcelFormatcellsTaskpaneStrings.EffectsLabel,styles:$i.textControlLabelStyles(!1)}),O.createElement(Qe.a,{horizontal:!0,id:"FontEffects"},n.renderControlFromCommandId(e,Vo.b.Bold),n.renderControlFromCommandId(e,Vo.b.Italic),n.renderControlFromCommandId(e,Vo.b.Underline),n.renderControlFromCommandId(e,Vo.b.DoubleUnderline),n.renderControlFromCommandId(e,Vo.b.Strikethrough))),O.createElement(Qe.a,null,O.createElement(jo.a,{id:"FontColorLabel",type:"AppLabelProps",forId:"FontColor",label:ExcelFormatcellsTaskpaneStrings.ColorLabel,styles:$i.textControlLabelStyles(!1)}),O.createElement(Qe.a,{horizontal:!0,id:"FontColor"},n.renderControlFromCommandId(e,Vo.b.FontColor)))))},n.controlsToRender=[Object(ea.d)("Microsoft.Office.Excel.ModernFontPicker",!1)?Vo.b.FontPicker:Vo.b.FontName_New,Vo.b.FontSize,Vo.b.Bold,Vo.b.Italic,Vo.b.Underline,Vo.b.DoubleUnderline,Vo.b.Strikethrough,Vo.b.FontColor],n}return Object(k.__extends)(t,e),t}(ni),na={root:{marginTop:"10px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"3px",paddingBottom:"5px",height:"16px"},label:{fontWeight:V.l.semibold,fontSize:"12px",fontStyle:"normal",lineHeight:"16px"}},oa={mostOuterDivStyling:{marginLeft:"17px",marginRight:"15px",marginBottom:"10px"},borderGalleryStyles:{columns:6,defaultWidth:280,styles:{galleryButtonInExpanded:{root:{height:"20px",width:"20px",border:"0px",margin:"0px",backgroundColor:Qo().iconButtonBackgroundRest,color:Qo().iconButtonForegroundRest},rootDisabled:{border:"unset",backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus}},galleryStack:{root:{width:"280px"},inner:{gridRowGap:"20px",gridColumnGap:"32px"}}}},lineGalleryStyles:Object(Po.c)((function(e){return{defaultWidth:276,columns:2,styles:{galleryButtonInExpanded:{root:{height:"30px",width:"130px",backgroundColor:Qo().iconButtonBackgroundRest,color:Qo().iconButtonForegroundRest},rootDisabled:{backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus}},galleryStack:{root:{backgroundColor:e.palette.white,border:"1px solid ".concat(e.palette.neutralQuaternary),borderRadius:"2px"},inner:{gridRowGap:"2px",gridColumnGap:"12px"}}}}})),textControlLabelStyles:na,appButtonStyles:{styles:{root:{marginRight:"20px",paddingLeft:"4px",paddingRight:"4px",height:"26px",border:"unset",backgroundColor:Qo().iconButtonBackgroundRest,color:Qo().iconButtonForegroundRest,display:"flex",alignItems:"center",justifyContent:"center"},splitButtonMenuButton:{backgroundColor:"unset"},rootDisabled:{border:"unset",backgroundColor:Qo().iconButtonBackgroundDisabled,color:Qo().iconButtonForegroundDisabled},rootChecked:{backgroundColor:Qo().iconButtonBackgroundSelected,color:Qo().iconButtonForegroundSelected},rootHovered:{backgroundColor:Qo().iconButtonBackgroundHover,color:Qo().iconButtonForegroundHover},rootPressed:{backgroundColor:Qo().iconButtonBackgroundPressed,color:Qo().iconButtonForegroundPressed},rootFocused:{backgroundColor:Qo().iconButtonBackgroundFocus,color:Qo().iconButtonForegroundFocus},textContainer:{fontSize:V.k.size12,fontStyle:"normal",fontWeight:V.l.regular,lineheight:"16px",marginLeft:"8px",marginRight:"0px"},label:{margin:"0px"}}},splitButtonStyles:{styles:{root:{paddingLeft:"4px",paddingRight:"4px",height:"26px",border:"unset",backgroundColor:"unset",display:"flex",alignItems:"center"},rootDisabled:{border:"unset"},splitButtonDivider:{width:"0px"},splitButtonMenuButton:{backgroundColor:"unset",width:"12px",height:"24px",padding:"4px 2px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexShrink:0,border:"none",outline:"none",selectors:{"span:first-child":{display:"flex",height:"16px"}}},splitButtonMenuIcon:{width:"8px",height:"8px",flexShrink:0},textContainer:{fontSize:V.k.size12,fontStyle:"normal",fontWeight:V.l.regular,lineheight:"16px",marginLeft:"8px",marginRight:"8px"},label:{margin:"0px"},menuIcon:{margin:"0px",width:"8px",height:"8px",flexShrink:0}}}},ra=function(e){function t(t){var n=e.call(this,t)||this;return n.getOverridePropsForCommandId=function(e,t){switch(e){case Vo.b.BorderMenuGallery:return oa.borderGalleryStyles;case Vo.b.BorderStyleGallery:return oa.lineGalleryStyles(t);case Vo.b.DrawBorder:case Vo.b.DrawBorderGrid:case Vo.b.EraseBorder:return oa.appButtonStyles;case Vo.b.BorderColor:return oa.splitButtonStyles;default:return{}}},n.renderTab=function(e){return O.createElement(Qe.a,{style:oa.mostOuterDivStyling},O.createElement(Qe.a,{horizontal:!0},n.renderControlFromCommandId(e,Vo.b.BorderMenuGallery)),O.createElement(Qe.a,null,O.createElement(jo.a,{id:"BorderOptionsLabel",type:"AppLabelProps",forId:"BorderOptions",label:ExcelFormatcellsTaskpaneStrings.BorderOptionsLabel,styles:oa.textControlLabelStyles}),O.createElement("div",{id:"BorderOptions"},O.createElement(Qe.a,{horizontal:!0},n.renderControlFromCommandId(e,Vo.b.DrawBorder),n.renderControlFromCommandId(e,Vo.b.DrawBorderGrid)),O.createElement(Qe.a,{horizontal:!0},n.renderControlFromCommandId(e,Vo.b.EraseBorder),n.renderControlFromCommandId(e,Vo.b.BorderColor))),O.createElement(jo.a,{id:"BorderLineStylesLabel",type:"AppLabelProps",forId:"BorderLineStyles",label:ExcelFormatcellsTaskpaneStrings.BorderLineStyleLabel,styles:oa.textControlLabelStyles}),O.createElement("div",{id:"BorderLineStyles"},n.renderControlFromCommandId(e,Vo.b.BorderStyleGallery))))},n.controlsToRender=[Vo.b.BorderMenuGallery,Vo.b.DrawBorder,Vo.b.DrawBorderGrid,Vo.b.EraseBorder,Vo.b.BorderColor,Vo.b.BorderStyleGallery],n}return Object(k.__extends)(t,e),t}(ni),ia={pivotStyles:{root:{marginLeft:"11px",height:"24px",marginBottom:"19px"},link:{height:"24px",marginRight:"0px",paddingLeft:"6px",paddingRight:"6px",marginTop:"1px"}},pivotDivStyles:{overflowY:"auto",overflowX:"hidden"},rootDivStyles:{display:"flex",flexDirection:"column",overflow:"hidden",height:"100%"}},aa=function(e){function t(t){var n=e.call(this,t)||this;return n.pivotRef=O.createRef(),n.getItemViewPivotItem=function(e,t,o){return Mo(e)?O.createElement(No.a,{headerText:t,itemKey:e.toString()},n.props.isFloatingObjectSelected?O.createElement(Lo,null):o()):O.createElement(O.Fragment,null)},n.state={},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Do.Consumer,null,(function(t){return O.createElement("div",{style:ia.rootDivStyles},O.createElement("div",{style:ia.pivotDivStyles},O.createElement(Wo.a,{componentRef:e.pivotRef,styles:ia.pivotStyles,selectedKey:e.props.activePage.toString(),onLinkClick:function(n){var o;t.callbacks.onItemClick(parseInt(n.props.itemKey,10)),null===(o=e.pivotRef.current)||void 0===o||o.focus()}},e.getItemViewPivotItem(1,ExcelFormatcellsTaskpaneStrings.NumberTabLabel,(function(){return O.createElement(Ji,null)})),e.getItemViewPivotItem(2,ExcelFormatcellsTaskpaneStrings.AlignmentTabLabel,(function(){return O.createElement(ci,{taskPaneId:"FormatCellsTaskPane"})})),e.getItemViewPivotItem(3,ExcelFormatcellsTaskpaneStrings.FontTabLabel,(function(){return O.createElement(ta,{taskPaneId:"FormatCellsTaskPane"})})),e.getItemViewPivotItem(4,ExcelFormatcellsTaskpaneStrings.BorderTabLabel,(function(){return O.createElement(ra,{taskPaneId:"FormatCellsTaskPane"})})))),O.createElement("div",{style:{flexGrow:1}}),O.createElement(Go,{giveFeedBackButtonText:ExcelFormatcellsTaskpaneStrings.FeedbackText}))}))},t}(O.Component),sa=function(e){function t(t){var n=e.call(this,t)||this;return n.formatCellsPane=O.createRef(),n.focus=function(){var e=n.formatCellsPane.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), div[data-is-focusable="true"]');e&&e[1]&&(e[1].classList.contains("is-selected")?e[1].focus():e[0].focus())},n.state={},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e,t;return O.createElement(Do.Provider,{value:{callbacks:null!==(e=this.props.callbacks)&&void 0!==e?e:void 0,viewModelData:null!==(t=this.props.viewModelData)&&void 0!==t?t:void 0}},O.createElement("div",{ref:this.formatCellsPane,style:{height:"inherit"}},this.getTaskPaneContent()))},t.prototype.getTaskPaneContent=function(){switch(this.props.activePage){case 0:return O.createElement(Ao,{isFloatingObjectSelected:this.props.isFloatingObjectSelected});case 1:case 2:case 3:case 4:return O.createElement(aa,{activePage:this.props.activePage,isFloatingObjectSelected:this.props.isFloatingObjectSelected});default:return O.createElement(O.Fragment,null)}},t}(O.Component),la=function(){return{root:{height:"26px",width:"84px",lineHeight:"20px",fontWeight:V.l.semibold,borderRadius:"2px",fontSize:"12px"}}},ca=Object(Po.c)((function(e){return Object(V.I)(la,{root:{height:"26px",fontSize:"12px",backgroundColor:e.palette.themePrimary,color:e.palette.white,marginRight:"8px",fontWeight:V.l.semibold},rootHovered:{backgroundColor:e.palette.themeDarkAlt,color:e.palette.white},rootPressed:{backgroundColor:e.palette.themeDark,color:e.palette.white}})})),ua=n(97),da=function(e){return O.createElement("div",null,O.createElement("div",{style:{display:"flex",padding:"8px"}},O.createElement(H.a,{styles:{root:{height:"20px",width:"20px",minWidth:"20px",marginRight:"8px"}},iconName:e.iconName,ariaLabel:""}),O.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},O.createElement("span",{style:{fontWeight:"600",fontSize:"14px",lineHeight:"20px",paddingBottom:"4px"}},e.itemName),O.createElement("span",{style:{fontWeight:"400",fontSize:"12px",lineHeight:"16px",paddingBottom:"4px"}},e.itemDescription))))},pa=n(28),ha=n.n(pa),ga=function(e){function t(t){var n=e.call(this,t)||this;return n.loadBlockPane=O.createRef(),n.focus=function(){var e=n.loadBlockPane.current;Object(ua.c)(e)},n.getSubHeader=function(){return O.createElement("div",{className:Object(V.eb)({fontWeight:"600",fontSize:"14px",lineHeight:"20px",paddingBottom:"8px"})},n.props.loadBlockingFloatingObjectsTaskPaneSubHeader)},n.getInvalidFloatingObjectItems=function(){return O.createElement("div",{style:{padding:"16px 0px 16px 0px"}},n.props.containsEmptyTextBox&&O.createElement(da,{itemName:ExcelRibbonStrings.LoadBlockEmptyTextboxes,itemDescription:ExcelRibbonStrings.LoadBlockEmptyTextboxesDescription,iconName:ha.a.Textbox_32}),n.props.containsInvalidImage&&O.createElement(da,{itemName:ExcelRibbonStrings.LoadBlockInvalidImages,itemDescription:ExcelRibbonStrings.LoadBlockInvalidImagesDescription,iconName:ha.a.AutoShapes_32}),n.props.containsInvalidShape&&O.createElement(da,{itemName:ExcelRibbonStrings.LoadBlockInvalidShapes,itemDescription:ExcelRibbonStrings.LoadBlockInvalidShapesDescription,iconName:ha.a.InsertPictureSimple_32}))},n.getDirective=function(){return O.createElement("div",{className:Object(V.eb)({display:"flex",paddingTop:"12px 0 12px 0"})},O.createElement(H.a,{styles:{root:{height:"16px",width:"16px",minWidth:"16px",marginRight:"12px"}},iconName:c.a.Info_32,ariaLabel:""}),ExcelRibbonStrings.LoadBlockingFloatingObjectsDirective)},n.getActionButtons=function(e){return O.createElement("div",{className:Object(V.eb)({alignSelf:"flex-end",paddingTop:"36px"})},O.createElement($t.a,{id:"LoadBlockRemoveButtonId",type:"AppButtonProps",label:ExcelRibbonStrings.LoadBlockingFloatingObjectsRemoveButtonText,onExecute:function(){return Object(zo.b)(Vo.b.CleanLoadBlockingFloatingObjects,{modelType:"ButtonModel",payload:{type:"ButtonPayload"}})},styles:ca(e)}),n.props.isSoftBlocked&&O.createElement($t.a,{id:"LoadBlockSkipButtonId",type:"AppButtonProps",customTooltip:ExcelRibbonStrings.LoadBlockingFloatingObjectsSkipTooltipText,label:ExcelRibbonStrings.LoadBlockingFloatingObjectsSkipButtonText,icon:W.a.AlertWarning_16,onExecute:function(){n.props.allowEditingSoftBlockedFiles(!0),Object(zo.b)(Vo.b.ModeSwitcherModeEditing,{modelType:"ButtonModel",payload:{type:"ButtonPayload"}})},styles:la()}))},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement("div",{ref:e.loadBlockPane,className:Object(V.eb)({height:"100%",overflowX:"hidden",overflowY:"auto"})},O.createElement("div",{className:Object(V.eb)({height:"100%",display:"flex",flexDirection:"column"})},O.createElement("div",{className:Object(V.eb)({marginLeft:"16px",marginRight:"16px",fontStyle:"normal",fontSize:"12px",lineHeight:"16px",display:"flex",flexDirection:"column",wordSpacing:"1px"})},e.getSubHeader(),e.props.loadBlockingFloatingObjectsTaskPaneBody,e.getInvalidFloatingObjectItems(),e.getDirective(),e.getActionButtons(t)),O.createElement("div",{style:{flexGrow:1}}),O.createElement(Go,null)))}))},t}(O.PureComponent),ma=n(530),fa=Object(Po.c)((function(e){return{wrapperStackStyles:{root:{alignItems:"center",justifyContent:"center",height:"inherit",margin:"0 16px"}},headerTextStyle:{root:{fontSize:14,fontWeight:600,lineHeight:20}},descriptionTextWrapperStyle:{root:{textAlign:"center"}},descriptionTextStyle:{root:{fontSize:12,lineHeight:16}},actionButtonStyle:{root:{color:e.palette.themePrimary,fontSize:12,lineHeight:16,height:30}},createButtonWrapperStyle:{root:{marginTop:"16px"}},illustrationStackStyles:{root:{height:"192px"}}}})),ba=n(133),va=n(352),ya=n(107),xa=n(400),Ca=function(){function e(){}return e.registerMuseaIllustrationIcons=function(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:if(e.registeredMuseaIllustration)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Object(xa.a)("excel-musea-illustration-sprite")];case 2:return o.sent(),(t=window.excelMuseaIllustrationSprite)&&(Object(va.a)((function(){return Object(ya.iconSpriteToReactMap)(t)})),e.registeredMuseaIllustration=!0),[3,4];case 3:return n=o.sent(),i.a.sendTraceTag(507905862,a.a.msoulscat_ES_EWAJS,s.a.Error,"Failed to registerMuseaIllustrationIcons, ".concat(n)),[3,4];case 4:return[2]}}))}))},e.registeredMuseaIllustration=!1,e}(),Sa=function(e){var t=O.useState(!1),n=t[0],o=t[1];return O.useEffect((function(){Object(k.__awaiter)(void 0,void 0,void 0,(function(){return Object(k.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ca.registerMuseaIllustrationIcons()];case 1:return e.sent(),o(!0),[2]}}))}))}),[]),n?O.createElement(H.a,Object(k.__assign)({},e,{className:Object(V.eb)([{width:e.width,height:e.height},e.styles,e.className])})):O.createElement(j.a,{shimmerElements:[{type:ba.a.line}],styles:{root:{width:e.width,height:e.height},shimmerWrapper:{height:"100%"}}})},Ea=function(e){var t=e.headerText,n=e.descriptionText,o=e.actionButtonText,r=e.primaryButtonText,i=e.iconName,a=e.onActionButtonClick,s=e.onPrimaryButtonClick;return O.createElement(Bo.a,null,(function(e){var l=fa(e);return O.createElement(Qe.a,{styles:l.wrapperStackStyles},O.createElement(Qe.a.Item,null,O.createElement(uo.a,{styles:l.headerTextStyle},t)),O.createElement(Qe.a.Item,{styles:l.illustrationStackStyles},O.createElement(Sa,{iconName:i,width:192,height:192})),n&&O.createElement(Qe.a.Item,{styles:l.descriptionTextWrapperStyle},O.createElement(uo.a,{styles:l.descriptionTextStyle},n)),o&&O.createElement(Qe.a.Item,null,O.createElement(be.a,{styles:l.actionButtonStyle,text:o,onClick:a})),r&&O.createElement(Qe.a.Item,{styles:l.createButtonWrapperStyle},O.createElement(ma.a,{text:r,onClick:s,id:"IllustratedInfoPrimaryButton"})))}))},ka=n(2402),Oa=n.n(ka),Ta=function(e){var t=e.onRetryButtonClick;return O.createElement(Ea,{headerText:ExcelRibbonStrings.NameManagerErrorViewHeader,iconName:Oa.a.WebWarning_192x192,primaryButtonText:ExcelRibbonStrings.NameManagerErrorViewRetryButtonLabel,onPrimaryButtonClick:t})},Ia=n(287),wa=n(1972),_a=n(2328),Pa=n(649),Ra=n(1956),Da=n(656),ja=n(965),Ba=n(373),Fa=n(315),La=n(409),Ma=Object(Po.c)((function(e,t,n,o,r,i){var a;return{cardStyle:{root:{padding:"12px",borderRadius:"4px",border:e?"2px solid ".concat(r.palette.themePrimary," !important"):"1px solid ".concat(r.palette.white," !important"),boxShadow:r.effects.elevation4,selectors:Object(k.__assign)(Object(k.__assign)({},!i&&{":hover":{boxShadow:r.effects.elevation8}}),{":hover::after":{border:"none",boxShadow:"none"}}),marginTop:"8px",marginBottom:"8px",cursor:!n&&7===o||i?"default !important":"pointer"}},icon:{maxHeight:"100%"},mainText:{fontWeight:"600",color:i?r.palette.neutralSecondaryAlt:r.palette.neutralDark,display:"flex",alignItems:"center",gap:"8px",maxWidth:n?"200px":t?"150px":"230px",".nameManager-scope-text":{padding:"0 2px",borderRadius:"2px",backgroundColor:i?r.palette.neutralLighter:r.palette.neutralLight,color:i?r.palette.neutralSecondaryAlt:r.palette.neutralPrimaryAlt,fontSize:"10px",lineHeight:"12px",fontWeight:400}},subText:{fontSize:"12px",lineHeight:"16px",color:i?r.palette.neutralSecondaryAlt:r.palette.neutralSecondary,display:"flex",maxWidth:n?"200px":t?"150px":"230px",".nameManager-invalid-reference-text":{backgroundColor:r.semanticColors.warningBackground,padding:"0 2px",borderRadius:"2px",color:"#484644",display:"flex",alignItems:"center",gap:"4px"},".nameManager-reference-text":{fontSize:"12px",lineHeight:"16px",display:"flex",maxWidth:n?"200px":t?"150px":"230px"},".nameManager-reference-range":{padding:"0px 2px",borderRadius:"2px",margin:"0px 4px",fontWeight:600,fontSize:"12px",lineHeight:"16px",backgroundColor:i?r.palette.neutralLighter:r.palette.neutralLight,color:i?r.palette.neutralSecondaryAlt:r.palette.neutralPrimaryAlt,alignSelf:"center"}},actionIconContainer:{display:t?"flex":"none"},commentMinimized:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",display:"block"},commentPadding:{padding:"0px 0px 0px 28px",maxWidth:n?"200px":"230px",wordBreak:"break-word"},iconButtonStyles:{root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",borderRadius:"2px",cursor:"pointer"},rootHovered:{color:r.palette.themeDarkAlt,backgroundColor:r.palette.neutralLighter,selectors:(a={},a[V.m]={borderColor:"Highlight",color:"Highlight"},a)},flexContainer:{display:"flex",justifyContent:"center",alignItems:"center"},rootPressed:{color:r.palette.themeDark,backgroundColor:r.palette.neutralLight},rootExpanded:{color:r.palette.themeDark,backgroundColor:r.palette.neutralLight},rootChecked:{color:r.palette.themeDark,backgroundColor:r.palette.neutralLight},rootCheckedHovered:{color:r.palette.themeDark,backgroundColor:r.palette.neutralQuaternaryAlt}},namedObjectIcon:{root:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},Object(La.d)(r)),{padding:"0"}),i&&{opacity:.75})},invalidReferenceIcon:{root:{width:"12px",height:"12px"}},moreOptionsContextualMenu:{container:{width:"120px"}},moreOptionsButtonIcon:{root:{width:"16px",height:"16px"}},clippingStyle:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}})),Aa=function(e){function t(t){var n=e.call(this,t)||this;return n.moreMenuButtonRef=O.createRef(),n.cardItemClick=function(){n.props.isInMultiSelectMode||n.props.onItemClick&&n.props.onItemClick(n.props.runtimeUid)},n.deleteButtonClick=function(){n.props.onItemsDelete&&n.props.onItemsDelete([n.props.runtimeUid])},n.iconMap=Object(Po.c)((function(e){switch(e){case 0:return d.a.SelectRange_20;case 4:case 2:return c.a.Function_16;case 1:case 5:return d.a.Table_20;case 6:return d.a.FlyoutAnchorPrintArea_20;case 3:return W.a.DataTypeText_20;case 7:return W.a.CreateName_16;default:return d.a.SelectRange_20}})),n.state={isActive:!1},n}return Object(k.__extends)(t,e),t.prototype.getReferenceText=function(e,t,n,o,r,i){if(!n||!o||!r)return O.createElement("span",{className:Object(V.eb)(i.clippingStyle)},t);var a="".concat(o,":").concat(r);return 0===e||1===e||6===e?O.createElement("div",{className:"nameManager-reference-text","aria-label":"".concat(n," ").concat(a)},O.createElement("span",{className:Object(V.eb)(i.clippingStyle)},n),O.createElement("span",{className:Object(V.eb)("nameManager-reference-range",i.clippingStyle)},a)):O.createElement("span",{className:Object(V.eb)(i.clippingStyle)},t)},t.prototype.getAriaLabel=function(){var e=this.props,t=e.name,n=e.type,o=e.referenceSheetName,r=e.topLeft,i=e.bottomRight,a=e.comment,s=e.isInvalidReference,l=e.reference,c="".concat(r,":").concat(i),u=!o||!r||!i,d=s?"".concat(ExcelRibbonStrings.NameManagerInvalidReference,"\n"):"",p=l;!u&&[0,1,6].includes(n)&&(p="".concat(o," ").concat(c));var h=a?"\n".concat(a):"";return"".concat(t,"\n").concat(d).concat(p).concat(h)},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){var n=Ma(e.props.selected,e.state.isActive,e.props.isInMultiSelectMode,e.props.type,t,e.props.disabled);return O.createElement(R.a,{styles:n.cardStyle,key:e.props.runtimeUid,onMouseEnter:function(){e.setState({isActive:!0})},onMouseLeave:function(){var t;e.setState({isActive:!1}),null===(t=e.moreMenuButtonRef.current)||void 0===t||t.dismissMenu()},onFocus:function(){e.setState({isActive:!0})},onBlur:function(t){var n,o=t.relatedTarget;!o||o.classList.contains("ms-ContextualMenu-link")||o.classList.contains("ms-ContextualMenu-container")||(e.setState({isActive:!1}),null===(n=e.moreMenuButtonRef.current)||void 0===n||n.dismissMenu())},"data-is-focusable":!0,onClick:e.cardItemClick,tabIndex:e.props.selected||0===e.props.selectionIndex&&!e.props.isInMultiSelectMode?0:-1,"data-selection-index":e.props.selectionIndex,"aria-label":e.getAriaLabel(),title:e.getAriaLabel()},O.createElement(Qe.a,null,O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"space-between"},O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:8}},O.createElement(H.a,Object(k.__assign)({},Object(co.a)(e.iconMap(e.props.type)),{styles:n.namedObjectIcon})),O.createElement(Qe.a,null,O.createElement(Qe.a.Item,{className:Object(V.eb)(n.mainText)},O.createElement("span",{className:Object(V.eb)(n.clippingStyle)},e.props.name),1===e.props.scope&&O.createElement("span",{className:Object(V.eb)("nameManager-scope-text",n.clippingStyle)},e.props.referenceSheetName)),O.createElement(Qe.a.Item,{className:Object(V.eb)(n.subText)},e.props.isInvalidReference?O.createElement("div",{className:"nameManager-invalid-reference-text"},O.createElement("span",null,ExcelRibbonStrings.NameManagerInvalidReference),O.createElement(H.a,Object(k.__assign)({},Object(co.a)(W.a.AlertWarning_20),{styles:n.invalidReferenceIcon}))):e.getReferenceText(e.props.type,e.props.reference,e.props.referenceSheetName,e.props.topLeft,e.props.bottomRight,n)))),!e.props.isInMultiSelectMode&&O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:4},className:Object(V.eb)(n.actionIconContainer)},O.createElement(Ba.a,{iconProps:{iconName:W.a.EditGeneric_24},title:ExcelRibbonStrings.NameManagerEditButtonLabel,ariaLabel:ExcelRibbonStrings.NameManagerEditButtonLabel,onClick:function(){e.props.onEditIconClick(e.props)}}),1!==e.props.type&&O.createElement(Fa.a,{styles:n.iconButtonStyles,onRenderText:function(){return O.createElement(O.Fragment,null)},onRenderDescription:function(){return O.createElement(O.Fragment,null)},ref:e.moreMenuButtonRef,menuProps:{items:[{key:"Select",text:ExcelRibbonStrings.NameManagerSelectButtonLabel,iconProps:{iconName:W.a.MultiSelect_16},onClick:e.props.onMultiSelectClick},{key:"Delete",text:ExcelRibbonStrings.NameManagerDeleteButtonLabel,iconProps:{iconName:W.a.TrashCan_16},onClick:e.deleteButtonClick}],directionalHintFixed:!0,directionalHint:Y.a.bottomRightEdge,styles:n.moreOptionsContextualMenu},onRenderMenuIcon:function(){return O.createElement(O.Fragment,null)},iconProps:{iconName:W.a.ellipsis_16,styles:n.moreOptionsButtonIcon},title:ExcelRibbonStrings.NameManagerMoreOptionsButtonLabel,ariaLabel:ExcelRibbonStrings.NameManagerMoreOptionsButtonLabel}))),e.props.comment&&O.createElement("div",{className:Object(V.eb)(n.subText,n.commentPadding,e.props.selected?{}:n.commentMinimized)},e.props.comment)))}))},t}(O.PureComponent),Na=Object(Po.c)((function(e){return{boldText:{fontWeight:"600"},checkboxStyle:function(t){return{checkbox:{background:t.checked?e.palette.themePrimary:e.palette.white}}},newButtonStyles:Wa,filterDropDownStyle:Ha(e),multiDeleteStyles:{icon:{height:20,fontSize:20,lineHeight:20}}}})),Wa={root:{height:"26px",width:"73px"}},Ha=Object(Po.c)((function(e){var t,n;return{root:{height:"24px",width:"34px",background:e.palette.neutralLighter,padding:"0px 2px 0px 0px",minWidth:"fit-content",borderStyle:"none",verticalAlign:"top",marginTop:"-2px",marginRight:"1px",selectors:(t={":focus::after":{outline:"unset !important"}},t[V.n]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},t[V.o]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},t)},rootFocused:{backgroundColor:"unset",outline:"1px solid ".concat(e.palette.black)},rootHovered:{backgroundColor:e.palette.neutralLight,selectors:(n={},n[V.m]={backgroundColor:"ButtonFace",color:"ButtonText"},n)},rootExpanded:{background:e.palette.neutralLight},rootExpandedHovered:{background:e.palette.neutralLighter},rootPressed:{backgroundColor:e.palette.neutralQuaternary},menuIcon:{fontSize:"8px",margin:"0px",height:"8px",width:"8px",lineHeight:"12px"},icon:{width:"16px",height:"16px",margin:"0px 2px"},flexContainer:{paddingLeft:"2px",width:"34px"}}})),za=function(e){function t(t){var n=e.call(this,t)||this;return n.showMultiSelectManagerBar=function(e){return O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",tokens:{padding:"6px 12px"}},O.createElement(Qe.a.Item,null,O.createElement(Ht.a,{checked:n.props.isAllSelected,styles:e.checkboxStyle,onChange:n.props.onToggle,label:"Select All"})),O.createElement(Qe.a.Item,{align:"end"},O.createElement(Ba.a,{iconProps:{iconName:W.a.OLDeleteHover_20},title:"Delete",ariaLabel:"Delete",disabled:!1,onClick:function(){n.props.onMultiDelete()},styles:e.multiDeleteStyles})))},n.showCreateManagerBar=function(e){return O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",tokens:{padding:"6px 12px"}},O.createElement(Qe.a.Item,null,O.createElement(Z.a,{content:"Sample-Filter",directionalHint:Y.a.bottomCenter},O.createElement(rr.a,{type:"AppBaseButtonProps",id:"nameManager-filter","aria-label":"filter",iconProps:{iconName:sn.a.Filter_20},menuProps:{items:[{key:"sample",name:"sample",iconProps:{iconName:"Email"},onClick:function(){}}]},styles:e.filterDropDownStyle}))),O.createElement(Qe.a.Item,{align:"end"},O.createElement(Z.a,{content:"new",directionalHint:Y.a.bottomCenter},O.createElement(rn.a,{id:"nameManagerCreate","aria-label":"new",iconProps:{iconName:W.a.JotNewWindow_16},text:"New",styles:e.newButtonStyles,onClick:n.props.createDefinedName}))))},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){var n=Na(t);return e.props.showMultiSelectCommandBar?e.showMultiSelectManagerBar(n):e.showCreateManagerBar(n)}))},t}(O.PureComponent),Va=Object(Po.c)((function(e){return{scrollablePaneStyle:{height:"100%"},listContainerStyle:{margin:"0px 12px"},checkboxStyle:function(t){return{checkbox:{background:t.checked?e.palette.themePrimary:e.palette.white}}},selectionZoneStyle:{height:"calc(100% - 82px)"},focusZoneStyle:{height:"100%"}}})),Ga=n(2271),Ua=Object(Po.c)((function(e){return{searchBoxStyles:{clearButton:{".ms-Button":{borderRadius:"0 3px 3px 0"}},root:{margin:"6px 12px",borderRadius:"4px",border:"1px solid ".concat(e.palette.neutralTertiaryAlt),borderBottom:"1px solid ".concat(e.palette.neutralSecondary),selectors:{"::after":{border:"none"},":hover":{border:"1px solid ".concat(e.palette.neutralTertiaryAlt),borderBottom:"1px solid ".concat(e.palette.neutralSecondary)},"&.is-active::after":{borderBottom:"2px solid ".concat(e.palette.themePrimary),position:"absolute",bottom:"-1px",borderRadius:"4px",clipPath:"inset(94% 0px 0px 0px)"},"&.is-active":{border:"1px solid ".concat(e.palette.neutralTertiaryAlt)}}}}}})),qa=function(e){var t=e.searchText,n=e.onSearchTextChange,o=e.isDisabled,r=void 0!==o&&o,i=O.useCallback((function(e,t){n(t||"")}),[n]);return O.createElement(Bo.a,null,(function(e){var n=Ua(e);return O.createElement(Ga.a,{type:"AppSearchBoxProps",id:"NameManagerSearchBox",showIcon:!0,styles:n.searchBoxStyles,placeholder:r?"":ExcelRibbonStrings.NameManagerSearchBoxPlaceholder,icon:c.a.Search_20,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:t,onChange:i,disabled:r})}))},Qa=function(e){function t(t){var n=e.call(this,t)||this;return n.listReference=O.createRef(),n.scrollRef=O.createRef(),n.asyncInstance=new Ia.a,n.onSearchTextChange=function(e){n.setState({searchText:e}),window.requestAnimationFrame((function(){window.setTimeout((function(){n.debouncedSearch(e)}))}))},n.debouncedSearch=n.asyncInstance.debounce((function(e){var t,o;null===(o=(t=n.props).onSearch)||void 0===o||o.call(t,e)}),500,{trailing:!0}),n.createDefinedName=function(){n.props.updateView&&n.props.updateView(1,null)},n.onRenderCell=function(e){return function(t,o){if(t&&void 0!==o&&o>=0){var r=n.props.isMultiSelectView,i=n.state.selection.isIndexSelected(o);return O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:10}},r&&O.createElement(Qe.a.Item,{align:"center"},O.createElement(Ht.a,{checked:i,styles:e.checkboxStyle,onChange:function(){var e;n.state.selection.toggleIndexSelected(o),null===(e=n.listReference.current)||void 0===e||e.forceUpdate()},inputProps:{"data-is-focusable":!1},disabled:!n.state.selection.canSelectItem(t)})),O.createElement(Qe.a.Item,{grow:1,styles:{root:{minWidth:0}}},O.createElement(Aa,Object(k.__assign)({},t,{onItemsDelete:n.props.onItemsDelete,isInMultiSelectMode:r,selected:i,onEditIconClick:function(){return n.props.updateView&&n.props.updateView(1,t)},onMultiSelectClick:n.onMultiSelectClick,onItemClick:n.props.onItemClick,selectionIndex:o,disabled:!n.state.selection.canSelectItem(t)}))))}return O.createElement(O.Fragment,null)}},n.onMultiDeleteClick=function(){n.props.onItemsDelete&&n.props.onItemsDelete(n.getItemsToDelete()),n.state.selection.setAllSelected(!1)},n.onToggleClick=function(){n.state.selection.toggleAllSelected()},n.onMultiSelectClick=function(){n.props.updateView&&n.props.updateView(2,null)},n.onSelectionChanged=function(){var e;n.setState({isAllSelected:n.state.selection.isAllSelected()}),null===(e=n.listReference.current)||void 0===e||e.forceUpdate()},n.getItemsToDelete=function(){var e=n.state.selection.getSelectedIndices(),t=[];return e.forEach((function(e){t.push(n.props.items[e].runtimeUid)})),t},n.createSelectionInstance=function(){return new wi.a({onSelectionChanged:n.onSelectionChanged,items:n.props.items,getKey:function(e){return e.runtimeUid},canSelectItem:function(e){return 1!==e.type||!n.props.isMultiSelectView}})},n.state={selection:n.createSelectionInstance(),searchText:"",isAllSelected:!1},n}return Object(k.__extends)(t,e),t.prototype.isSearching=function(){return""!==this.state.searchText},t.prototype.shouldComponentUpdate=function(e,t){return e.isMultiSelectView!==this.props.isMultiSelectView||(t.searchText!==this.state.searchText||(e.items!==this.props.items||t.isAllSelected!==this.state.isAllSelected))},t.prototype.componentDidUpdate=function(e){var t;e.isMultiSelectView!==this.props.isMultiSelectView&&(this.props.isMultiSelectView||this.state.selection.setAllSelected(!1),null===(t=this.listReference.current)||void 0===t||t.forceUpdate()),e.items===this.props.items&&e.isMultiSelectView===this.props.isMultiSelectView||this.state.selection.setItems(this.props.items,!1)},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){var n=Va(t);return O.createElement(wa.a,{className:Object(V.eb)(n.scrollablePaneStyle),componentRef:e.scrollRef},O.createElement(_a.a,{stickyPosition:Pa.a.Header,isScrollSynced:!1},O.createElement(za,{onMultiDelete:e.onMultiDeleteClick,onToggle:e.onToggleClick,showMultiSelectCommandBar:e.props.isMultiSelectView,createDefinedName:e.createDefinedName,isAllSelected:e.state.isAllSelected}),!e.props.isMultiSelectView&&O.createElement(qa,{searchText:e.state.searchText,onSearchTextChange:e.onSearchTextChange})),O.createElement(Ra.a,{selection:e.state.selection,selectionMode:e.props.isMultiSelectView?Pi.d.multiple:Pi.d.single,className:Object(V.eb)(n.selectionZoneStyle)},O.createElement(Da.a,{direction:Zt.a.bidirectional,className:Object(V.eb)(n.focusZoneStyle)},0===e.props.items.length?O.createElement(Ea,{headerText:ExcelRibbonStrings.NameManagerNoSearchResults,iconName:Oa.a.SearchFilter_192x192,descriptionText:ExcelRibbonStrings.NameManagerNoSearchResultsDescription,actionButtonText:ExcelRibbonStrings.NameManagerNoSearchClearButtonLabel,onActionButtonClick:function(){e.onSearchTextChange("")}}):O.createElement(ja.a,{componentRef:e.listReference,items:e.props.items||void 0,onRenderCell:e.onRenderCell(n),className:Object(V.eb)(n.listContainerStyle)}))))}))},t}(O.Component),Ka=Object(Po.c)((function(e){return{sharedShimmerStyle:{root:{borderRadius:"4px"},shimmerWrapper:{borderRadius:"4px"}},commandBarShimmerStyle:{root:{height:"26px",display:"flex",alignItems:"center",padding:"6px 0 6px 12px"}},cardStackStyle:{root:{padding:"7px 12px"}},documentCardStyle:{root:{padding:"12px",borderRadius:"4px",boxShadow:e.effects.elevation4,height:"30px",display:"flex",alignItems:"center"}}}})),Ja=function(){return O.createElement(Bo.a,null,(function(e){var t=Ka(e);return O.createElement(j.a,{styles:t.sharedShimmerStyle,shimmerElements:[{type:ba.a.line}],width:120,height:20})}))},Za=function(){return O.createElement(Bo.a,null,(function(e){var t=Ka(e);return O.createElement(Qe.a,null,O.createElement(Qe.a.Item,{styles:t.commandBarShimmerStyle},O.createElement(Ja,null)),O.createElement(Qe.a.Item,null,O.createElement(qa,{searchText:"",onSearchTextChange:function(){},isDisabled:!0})),Object(k.__spreadArray)([],Array(4),!0).map((function(e,n){return O.createElement(Qe.a.Item,{key:n,styles:t.cardStackStyle},O.createElement(R.a,{styles:t.documentCardStyle},O.createElement(Ja,null)))})))}))},Ya=n(2362),Xa=Object(Po.c)((function(e){return{textFeildStyles:{root:{"input::placeholder, textarea::placeholder":{color:e.palette.neutralPrimaryAlt}},field:{fontSize:"12px"},fieldGroup:{background:e.palette.white,height:"28px",borderRadius:"2px",border:"1px solid ".concat(e.palette.neutralTertiary),selectors:{":focus":{borderColor:e.palette.neutralLight}}},subComponentStyles:{label:{root:{fontWeight:"600"}}}}}})),$a=function(e){var t=e.label,n=e.required,o=e.value,r=e.id,i=e.placeholder,a=e.errorMessage,s=e.onChange,l=e.multiline,c=e.resizable;return O.createElement(Bo.a,null,(function(e){var u=Xa(e);return O.createElement(Ya.a,{label:t,required:n,value:o,type:"AppInputProps",id:r,maxLength:255,styles:u.textFeildStyles,placeholder:i,onChange:function(e){s(e||"")},errorMessage:a,multiline:l,resizable:c})}))},es=Object(Po.c)((function(e,t){return void 0===t&&(t=!1),{infoIconStyle:{root:{width:"10px",height:"10px",display:"flex",padding:"2px",cursor:"pointer"}},tableInputStyle:{field:{fontSize:"12px"},fieldGroup:{height:"28px",borderRadius:"2px"},wrapper:{border:"1px solid ".concat(e.palette.neutralTertiaryAlt)}},ewaRangePickerParentStyle:{root:{"#name-manager-range-picker::placeholder":{color:e.palette.neutralPrimaryAlt},"div[role='alert']":{width:"1px",height:"1px",overflow:"hidden"},"#name-manager-range-picker-RootComponent > div.ms-Stack":{border:"1px solid",borderColor:t?e.palette.redDark:e.palette.neutralTertiary},"#name-manager-range-picker-RootComponent > div.ms-Stack:focus-within, #name-manager-range-picker-RootComponent > div.ms-Stack:hover":{border:"1px solid",borderColor:t?e.palette.redDark:e.palette.neutralSecondary}}},customErrorMessageStyle:{fontSize:12,fontWeight:400,color:e.palette.redDark,margin:0,paddingTop:5,display:"flex",alignItems:"center"}}})),ts=function(e){var t=e.value;return O.createElement(Bo.a,null,(function(e){var n=es(e);return O.createElement(Qe.a,null,O.createElement(Qe.a.Item,null,O.createElement(Qe.a,{horizontal:!0,verticalAlign:"center"},O.createElement(Qe.a.Item,null,O.createElement(Ge.a,{htmlFor:"name-manager-table-ref",required:!0},ExcelRibbonStrings.NameManagerRefersToInputTitle)),O.createElement(Qe.a.Item,null,O.createElement(Z.a,{content:ExcelRibbonStrings.NameManagerTableEditInfoMessage,directionalHint:Y.a.bottomCenter},O.createElement(H.a,{iconName:c.a.Info_20,styles:n.infoIconStyle,"aria-label":ExcelRibbonStrings.NameManagerTableEditInfoMessage,"data-is-focusable":!0,tabIndex:0}))))),O.createElement(Qe.a.Item,null,O.createElement(Ya.a,{defaultValue:t,disabled:!0,type:"AppInputProps",id:"name-manager-table-ref",styles:n.tableInputStyle})))}))},ns=function(e){var t=e.value,n=e.rangePickerController,o=e.onChange,r=e.errorMessage;return O.createElement(Bo.a,null,(function(e){var i=es(e,void 0!==r);return O.createElement(Qe.a,{styles:i.ewaRangePickerParentStyle},O.createElement(Qe.a.Item,null,O.createElement(Ge.a,{htmlFor:"name-manager-range-picker",required:!0},ExcelRibbonStrings.NameManagerRefersToInputTitle)),O.createElement(Qe.a.Item,null,O.createElement(ne.a,{rangePickerController:n,id:"name-manager-range-picker",value:t,onChange:function(e){null==o||o(e||"")},placeholder:ExcelRibbonStrings.NameManagerRefersToInputPlaceholder,useAbsoluteRef:!0,applyF2EditMode:!0,autoApply:!0,inputProps:{maxLength:255,errorMessage:r}})),r&&O.createElement(Qe.a.Item,null,O.createElement("div",{"aria-hidden":!0},O.createElement("p",{className:Object(V.eb)(i.customErrorMessageStyle,V.b.slideDownIn20)},r))))}))},os=function(e){var t=e.type,n=e.value,o=e.rangePickerController,r=e.onChange,i=e.errorMessage;return 1===t?O.createElement(ts,{value:n}):O.createElement(ns,{value:n,rangePickerController:o,onChange:r,errorMessage:i})},rs=Object(Po.c)((function(){return{actionButtonWrapper:{root:{flexGrow:1,display:"flex",justifyContent:"flex-end",alignItems:"flex-end",margin:"16px 0"}},infoIconStyle:{root:{width:"10px",height:"10px"}}}}));function is(e){var t;return e.reduce((function(e,t){var n=t.target,o=t.errorMessage;return e[n]=null!=o?o:void 0,e}),((t={})[0]=void 0,t[1]=void 0,t[2]=void 0,t))}var as=function(e){var t,n,o,r,i=e.item,a=e.rangePickerController,s=e.updateView,l=e.onItemSave,u=e.errors,d=O.useState(null!==(t=null==i?void 0:i.name)&&void 0!==t?t:""),p=d[0],h=d[1],g=O.useState(null!==(n=null==i?void 0:i.reference)&&void 0!==n?n:""),m=g[0],f=g[1],b=O.useState(null!==(o=null==i?void 0:i.comment)&&void 0!==o?o:""),v=b[0],y=b[1],x=O.useState(!1),C=x[0],S=x[1];O.useEffect((function(){S((p!==(null==i?void 0:i.name)||m!==(null==i?void 0:i.reference)||v!==(null==i?void 0:i.comment))&&p.length>0&&m.length>0)}),[p,m,v,i]);var E=O.useState(is(null!==(r=u)&&void 0!==r?r:[])),T=E[0],I=E[1],w=rs();O.useEffect((function(){var e;I(is(null!==(e=u)&&void 0!==e?e:[]))}),[u]);var _=O.useRef(p),P=O.useRef(m),R=O.useRef(v);return O.useEffect((function(){p!==_.current&&I((function(e){var t;return Object(k.__assign)(Object(k.__assign)({},e),((t={})[0]=void 0,t))})),m!==P.current&&I((function(e){var t;return Object(k.__assign)(Object(k.__assign)({},e),((t={})[1]=void 0,t))})),v!==R.current&&I((function(e){var t;return Object(k.__assign)(Object(k.__assign)({},e),((t={})[2]=void 0,t))})),_.current=p,P.current=m,R.current=v}),[p,m,v]),O.createElement(Qe.a,{tokens:{padding:"0px 16px",childrenGap:10},verticalFill:!0},O.createElement(Qe.a.Item,null,O.createElement($a,{label:ExcelRibbonStrings.NameManagerNameInputTitle,required:!0,value:p,id:"name-manager-name-input",placeholder:ExcelRibbonStrings.NameManagerNameInputPlaceholder,errorMessage:T[0],onChange:h})),O.createElement(Qe.a.Item,null,O.createElement(os,{type:null==i?void 0:i.type,value:m,rangePickerController:a,onChange:f,errorMessage:T[1]})),O.createElement(Qe.a.Item,null,O.createElement($a,{label:ExcelRibbonStrings.NameManagerCommentInputTitle,multiline:!0,required:!1,value:v,id:"name-manager-comment-input",placeholder:ExcelRibbonStrings.NameManagerCommentInputPlaceholder,errorMessage:T[2],onChange:y,resizable:!1})),O.createElement(Qe.a.Item,null,O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:4},horizontalAlign:"center",verticalAlign:"center"},O.createElement(Qe.a.Item,null,O.createElement(H.a,{iconName:c.a.Info_20,styles:w.infoIconStyle})),O.createElement(Qe.a.Item,null,O.createElement(uo.a,{variant:"small"},ExcelRibbonStrings.NameManagerScopeEditInfoMessage)))),O.createElement(Qe.a.Item,{styles:w.actionButtonWrapper},O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:10}},O.createElement(ma.a,{text:ExcelRibbonStrings.NameManagerSaveButtonLabel,id:"name-manager-save-button",onClick:function(){null==l||l(p,m,v,null==i?void 0:i.runtimeUid,null==i?void 0:i.type)},disabled:!C}),O.createElement(rn.a,{text:ExcelRibbonStrings.NameManagerCancelButtonLabel,id:"name-manager-cancel-button",onClick:function(){null==s||s(0,null)}}))))},ss=function(e){var t=e.createDefinedName;return O.createElement(Ea,{headerText:ExcelRibbonStrings.NameManagerEmptyViewHeader,iconName:Oa.a.TextCard_192x192,descriptionText:ExcelRibbonStrings.NameManagerEmptyViewDescription,actionButtonText:ExcelRibbonStrings.NameManagerEmptyViewLearnMoreLabel,primaryButtonText:ExcelRibbonStrings.NameManagerContextMenuEntryPointText,onPrimaryButtonClick:t,onActionButtonClick:function(){}})},ls=n(43),cs=n.n(ls),us=Object(Po.c)((function(e){var t;return{anchorStyles:{position:"absolute",bottom:"56px",width:"calc(100% - 24px)",height:"0px",marginLeft:"12px"},calloutStyles:{root:{boxShadow:e.effects.elevation8,borderRadius:e.effects.roundedCorner4},calloutMain:{padding:"8px 8px 8px 16px",borderRadius:e.effects.roundedCorner4,backgroundColor:e.palette.neutralPrimary}},messageStyles:{root:{fontWeight:"600",color:e.palette.neutralLighter,whiteSpace:"pre-line"}},actionButtonStyles:{root:{backgroundColor:"transparent",color:e.palette.neutralLighter,maxHeight:"24px",minWidth:"54px",padding:"initial"},rootHovered:{backgroundColor:"transparent",color:e.palette.neutralLighter}},closeButtonStyles:{root:{height:"24px",width:"24px",backgroundColor:"transparent !important"},rootHovered:{backgroundColor:"transparent !important"}},iconStyles:{root:{filter:"invert(1)",selectors:(t={},t[V.m]={filter:"invert(0)"},t)}}}})),ds=n(2318),ps=function(e){var t=e.message,n=e.actionButtonText,o=e.onActionButtonClick,r=e.sequenceNumber,i=e.autoHide,a=e.allowDismiss,s=e.onCloseButtonClick,l=O.useState(!0),c=l[0],u=l[1],d=O.useRef(null),p=O.useCallback((function(){i&&d.current&&clearTimeout(d.current)}),[d,i]),h=O.useCallback((function(){i&&(p(),d.current=setTimeout((function(){u(!0)}),5e3))}),[d,i,p]),g=O.useCallback((function(){null==o||o(),u(!0),p()}),[o,p]),m=O.useCallback((function(){u(!0),p(),null==s||s()}),[p,s]);return O.useEffect((function(){return r>0&&(u(!1),h()),function(){u(!0),p()}}),[r,h,p]),O.createElement(Bo.a,null,(function(e){var o=us(e);return O.createElement(O.Fragment,null,O.createElement("div",{id:"name-manager-toast-target",className:Object(V.eb)(o.anchorStyles)}),!c&&O.createElement(ds.a,{target:"#".concat("name-manager-toast-target"),calloutWidth:296,onMouseEnter:p,onMouseLeave:h,coverTarget:!0,directionalHint:Y.a.topLeftEdge,isBeakVisible:!1,styles:o.calloutStyles,"aria-labelledby":"name-manager-toast-message",role:"alert"},O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:6},verticalAlign:"center"},O.createElement(Qe.a.Item,{grow:1},O.createElement(uo.a,{variant:"medium",styles:o.messageStyles,id:"name-manager-toast-message"},t)),O.createElement(Qe.a.Item,null,O.createElement(rn.a,{styles:o.actionButtonStyles,onClick:g},n)),a&&O.createElement(Qe.a.Item,null,O.createElement(Ba.a,{iconProps:{iconName:cs.a.CancelGlyph_20,styles:o.iconStyles},id:"#name-manager-toast-close-button",onClick:m,styles:o.closeButtonStyles,title:"Close"})))))}))},hs=function(e){function t(t){var n=e.call(this,t)||this;return n.taskPaneContentRef=O.createRef(),n.listComponentRef=O.createRef(),n.isFocused=function(){var e;return(null===(e=n.taskPaneContentRef.current)||void 0===e?void 0:e.contains(document.activeElement))||!1},n.focus=function(){var e=0===n.props.activePage?"#NameManagerSearchBox, #IllustratedInfoPrimaryButton":"button, [href], input",t=n.taskPaneContentRef.current.querySelector(e);t&&t.focus()},n.state={page:0},n}return Object(k.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.props.showLoader||this.isFocused()||this.focus()},t.prototype.render=function(){return O.createElement("div",{style:{height:"100%"},ref:this.taskPaneContentRef},this.getTaskPaneContent(),this.props.toast&&this.getToast())},t.prototype.getToast=function(){var e,t,n,o,r,i,a,s,l,c;return O.createElement(ps,{message:null===(e=this.props.toast)||void 0===e?void 0:e.message,actionButtonText:null===(t=this.props.toast)||void 0===t?void 0:t.actionButtonText,onActionButtonClick:null===(n=this.props.toast)||void 0===n?void 0:n.onActionButtonClick,sequenceNumber:null!==(r=null===(o=this.props.toast)||void 0===o?void 0:o.sequenceNumber)&&void 0!==r?r:0,autoHide:null===(a=null===(i=this.props.toast)||void 0===i?void 0:i.autoHide)||void 0===a||a,allowDismiss:null===(l=null===(s=this.props.toast)||void 0===s?void 0:s.allowDismiss)||void 0===l||l,onCloseButtonClick:null===(c=this.props.toast)||void 0===c?void 0:c.onCloseButtonClick})},t.prototype.getTaskPaneContent=function(){var e,t,n=this;if(this.props.showLoader)return O.createElement(Za,null);if(0===(null===(e=this.props.items)||void 0===e?void 0:e.length)&&!(null===(t=this.listComponentRef.current)||void 0===t?void 0:t.isSearching()))return O.createElement(ss,{createDefinedName:function(){var e,t;null===(t=(e=n.props).updateView)||void 0===t||t.call(e,1,null)}});switch(this.props.activePage){case 0:return O.createElement(Qa,Object(k.__assign)({items:this.props.items,updateView:this.props.updateView,isMultiSelectView:!1},this.props.callbacks,{ref:this.listComponentRef}));case 1:return O.createElement(as,Object(k.__assign)({item:this.props.items&&1===this.props.items.length?this.props.items[0]:null},this.props.callbacks,{rangePickerController:this.props.rangePickerController,updateView:this.props.updateView,errors:this.props.errors}));case 2:return O.createElement(Qa,Object(k.__assign)({items:this.props.items,updateView:this.props.updateView,isMultiSelectView:!0},this.props.callbacks));case 3:return O.createElement(O.Fragment,null,"Closed");case 4:return O.createElement(Ta,{onRetryButtonClick:function(){var e,t;null===(t=(e=n.props).retryHandler)||void 0===t||t.call(e)}})}},t}(O.Component),gs={boxSizing:"content-box",fontSize:"12px",fontStretch:"normal",fontStyle:"normal",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',lineHeight:"normal",fontWeight:600,letterSpacing:"normal",textAlign:"left"};function ms(){return Object(f.a)().primary}var fs,bs,vs,ys,xs,Cs,Ss,Es,ks={color:ms(),textAlign:"center"},Os={root:{height:"50%",margin:"auto"},label:[gs,ks]},Ts=n(1970),Is={selectors:(fs={},fs[V.m]={outline:"1px solid Highlight",color:"Highlight"},fs)},ws={background:"#edebe9",border:"1px solid #c8c6c4",borderRadius:"2px",fontWeight:"normal",overflowY:"auto",height:"80%",minHeight:"31px",maxHeight:"61px",boxSizing:"border-box",color:"#252423",padding:"4px"},_s={color:"#323130",fontSize:"12px",paddingTop:"2px",marginBottom:"6px"},Ps=function(){return Object(V.eb)({display:"flex",flexDirection:"column",height:"15%",maxHeight:"85px"})},Rs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.misspelledWorBoxRootClassName=Ps(),t.misspelledWordBox=O.createRef(),t.cellContent=O.createRef(),t.misspelledWord=O.createRef(),t.scrollSelectedItemIntoView=function(){t.misspelledWord&&t.misspelledWord.current&&t.misspelledWord.current.scrollIntoView({block:"center"})},t}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.scrollSelectedItemIntoView()},t.prototype.componentDidUpdate=function(){this.scrollSelectedItemIntoView()},t.prototype.render=function(){var e=this.processSearchQuery(this.props),t=e.preMisspelledWordText,n=e.misspelledWordText,o=e.postMisspelledWordText,r=function(){var e;return{cellContent:Object(V.eb)([gs,ws,{selectors:(e={},e[":focus"]=Object(k.__assign)({outline:"none",border:"1px solid #323130 "},Is),e)}]),misspelledWord:Object(V.eb)({backgroundImage:"url('data:image/gif;base64,R0lGODlhBQAEAJECAP////8AAAAAAAAAACH5BAEAAAIALAAAAAAFAAQAAAIIlGAXCCHrTCgAOw==')",backgroundPosition:"bottom left",backgroundRepeat:"repeat-x"}),misspelledWordTitle:Object(V.eb)(gs,_s)}}(),i=1===this.props.misspelledWordType?ExcelRibbonStrings.SpellCheckRepeatedWordText:ExcelRibbonStrings.SpellCheckNotInDictionaryText;return O.createElement("div",{ref:this.misspelledWordBox,className:this.misspelledWorBoxRootClassName},O.createElement("div",{className:r.misspelledWordTitle},i),O.createElement("div",{id:"SpellCheckTaskPaneCellContentId",tabIndex:0,ref:this.cellContent,className:r.cellContent,role:"text","aria-label":ExcelRibbonStrings.SpellCheckAriaSpellingErrorText+". "+i+". "+n+". "+ExcelRibbonStrings.SpellCheckAriaOriginalSentenceText+". "+ExcelRibbonStrings.SpellCheckAriaReadOnlyText+". "+this.props.misspelledWordCellContent},t,O.createElement("span",{ref:this.misspelledWord,className:r.misspelledWord},n),o))},t.prototype.processSearchQuery=function(e){var t="",n="",o="";if(e){var r=e.misspelledWordCellContent,s=e.misspelledWordBeginIndex,l=e.misspelledWordEndIndex;t=r?r.substring(0,s):"",n=r?r.substring(s,l):"",o=r?r.substring(l):""}else i.a.shipAssertTag(595731299,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane Invalid data received.");return{preMisspelledWordText:t,misspelledWordText:n,postMisspelledWordText:o}},t.prototype.focus=function(){this.misspelledWordBox&&this.misspelledWordBox.current&&this.misspelledWordBox.current.focus()},t}(O.PureComponent),Ds=n(12),js={root:(bs={height:"26px",background:"#ffffff",border:"1px solid #bebbb8",marginRight:"8px",marginTop:"9px",minWidth:"87px",width:"auto"},bs[V.m]={MsHighContrastAdjust:"auto"},bs),rootHovered:{backgroundColor:"#e1dfdd",commonHighContrastHoverFocusStyles:Ds.o},rootPressed:{backgroundColor:"#c8c6c4"},rootFocused:{border:"1px solid #323130 ",backgroundColor:"#c8c6c4",commonHighContrastHoverFocusStyles:Ds.o},label:[gs,{marginLeft:"0px",marginRight:"0px",textAlign:"center"}]},Bs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIgnoreButtonExecute=function(){t.props.showSpinner(),t.props.onIgnoreButtonExecute?t.props.onIgnoreButtonExecute():i.a.shipAssertTag(595730589,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onIgnoreButtonExecute not set.")},t.onIgnoreAllOrDeleteButtonExecute=function(){t.props.showSpinner(),t.props.onIgnoreAllOrDeleteButtonExecute?t.props.onIgnoreAllOrDeleteButtonExecute():i.a.shipAssertTag(595730590,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onIgnoreAllButtonExecute not set.")},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{style:{height:"auto",width:"100%",marginBottom:"24px"}},O.createElement($t.a,{id:"SpellCheckTaskPaneIgnoreButtonId",type:"AppButtonProps",label:ExcelRibbonStrings.SpellCheckIgnoreButtonText,onExecute:this.onIgnoreButtonExecute,styles:js,disabled:this.props.disableButtons}),O.createElement($t.a,{id:"SpellCheckTaskPaneIgnoreAllButtonId",type:"AppButtonProps",label:1===this.props.misspelledWordType?ExcelRibbonStrings.SpellCheckDeleteRepeatedWordButtonText:ExcelRibbonStrings.SpellCheckIgnoreAllButtonText,onExecute:this.onIgnoreAllOrDeleteButtonExecute,styles:js,disabled:this.props.disableButtons}))},t}(O.PureComponent),Fs={width:"100%",color:"#323130",fontSize:"12px",background:"#edebe9"},Ls={border:"1px solid #bebbb8",boxSizing:"border-box",fontWeight:"normal",padding:"5px",textAlign:"left",width:"auto",height:"auto",background:"#ffffff",color:"#252423"},Ms={root:{borderRadius:"2px",height:"100%",width:"auto",selectors:(vs={},vs[" :focus"]={outline:"none",border:"1px solid #323130 ",selectors:(ys={},ys[" .ms-Dropdown-title"]={outline:"none",border:"none",top:"unset !important",left:"unset !important"},ys)},vs)},dropdownItem:{selectors:{":hover":{background:"#e1dfdd",commonHighContrastHoverFocusStyles:Ds.o},":active":{background:"#c8c6c4"}}},dropdownOptionText:[gs,{fontWeight:"normal"}],dropdownItemsWrapper:{border:"1px solid transparent"},dropdownItemSelected:{backgroundColor:"#edebe9"},label:[gs,Fs],title:[gs,Ls]},As=n(54),Ns=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.languageList=[],t.state={selectedItem:void 0},t.onSelectedLanguageChanged=function(e,n){t.props.showSpinner(),n&&t.setState({selectedItem:n}),t.props.onLanguageChangeExecute&&n?t.props.onLanguageChangeExecute(n.key.toString()):i.a.shipAssertTag(595730638,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane Error while changing the proofing language.")},t.onRenderCaretDown=function(){return O.createElement(H.a,{iconName:ir.a.downChevron?ir.a.downChevron.icon12:"CommonControlChevronDownGlyph_12",style:{height:"12px",width:"12px"}})},t}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return e&&e.currentLocale?{selectedItem:{key:e.currentLocale.localeId,text:e.currentLocale.localeName}}:null},t.prototype.render=function(){var e=this.state.selectedItem;return 0===this.languageList.length&&this.props.supportedLocaleInfoList&&this.props.supportedLocaleInfoList.length>0&&this.updateSupportedLanguageList(this.props),O.createElement("div",{style:this.props.isLanguageErrorTab?{boxSizing:"border-box",left:"0px",width:"100%"}:{bottom:"26px",boxSizing:"border-box",display:"inline-flex",flexDirection:"column",position:"inherit",width:"100%"}},O.createElement(qe.a,{label:ExcelRibbonStrings.SpellCheckDictionaryLanguageText,options:this.languageList,placeholder:ExcelRibbonStrings.SpellCheckLanguageListPlaceHolder,selectedKey:e?e.key:"",onChange:this.onSelectedLanguageChanged,disabled:this.props.disableList,styles:Ms,onRenderCaretDown:this.onRenderCaretDown,calloutProps:{calloutMaxHeight:180,bounds:As.getBoundingWindowWithPaddingFabric}}))},t.prototype.updateSupportedLanguageList=function(e){if(e.supportedLocaleInfoList){for(var t=0,n=e.supportedLocaleInfoList;t<n.length;t++){var o=n[t],r=o?o.localeId:null,i=o?o.localeName:null;r&&i&&this.languageList.push({key:r.toUpperCase(),text:i})}this.languageList.sort(this.compareLocale)}},t.prototype.compareLocale=function(e,t){return e.text.localeCompare(t.text)},t}(O.PureComponent),Ws={root:(xs={border:"1px solid #bebbb8",background:"#ffffff",boxShadow:"0 2px 4px -0.8px rgba(0, 0, 0, 0.1)",height:"32px",width:"100%",padding:"4px 8px"},xs[V.m]={MsHighContrastAdjust:"auto"},xs),rootHovered:{background:"#e1dfdd",commonHighContrastHoverFocusStyles:Ds.o},rootPressed:{background:"#c8c6c4"},rootDisabled:{background:"transparent !important",boxShadow:"unset",opacity:.33,border:"1px solid #bebbb8 !important"},label:[gs,{padding:"0px",textOverflow:"ellipsis",overflow:"hidden",margin:"0px"}],splitButtonContainer:{borderRadius:"2px",height:"32px",marginBottom:"9px",width:"100%"},splitButtonContainerDisabled:{selectors:{":focus":{border:"1px solid #323130 "}}},splitButtonDividerDisabled:{height:"0px",width:"0px"},splitButtonDivider:{top:"50%",transform:"translateY(-50%)"},labelDisabled:[gs,{fontWeight:"normal",padding:"0px",textOverflow:"ellipsis",overflow:"hidden",margin:"0px"}],splitButtonContainerFocused:{selectors:(Cs={},Cs[" .splitPrimaryButton"]={border:"1px solid #323130 ",borderRight:"none !important"},Cs[" .splitMenuButton"]={border:"1px solid #323130 ",borderLeft:"none !important"},Cs)},splitButtonMenuIconDisabled:{height:"0px",width:"0px"},splitButtonMenuIcon:{height:"12px",width:"12px",margin:"8px 9px"},splitButtonMenuButtonDisabled:{display:"none"},splitButtonMenuButtonExpanded:{background:"#e1dfdd",height:"32px"},textContainer:[gs],splitButtonMenuButton:{background:"#ffffff",border:"1px solid #bebbb8",boxShadow:"2px 2px 4px -0.8px rgba(0, 0, 0, 0.1)",height:"32px",selectors:(Ss={},Ss[V.m]={MsHighContrastAdjust:"auto"},Ss[":hover"]={background:"#e1dfdd",commonHighContrastHoverFocusStyles:Ds.o},Ss[":active"]={background:"#c8c6c4"},Ss),width:"auto",minWidth:"32px",marginLeft:"0px"}},Hs=n(1115),zs=n(902),Vs={marginLeft:"0px",marginRight:"0px",textAlign:"center"},Gs=Object(Po.c)((function(e){return Object(V.db)({root:{height:24,lineHeight:24,selectors:{":hover":{background:"#e1dfdd"},":active":{background:"#c8c6c4"}}},linkContent:{height:22},icon:{height:16,width:16,lineHeight:16},label:[gs,Vs],subMenuIcon:{height:12}},e)})),Us=Object(Po.c)((function(e){return function(t){var n=t.controlProps,o=t.location;return n.filter((function(e){return Object(Pr.e)(e)>0})).map((function(t){var n=Object(k.__assign)(Object(k.__assign)({},t),{location:o,appStrings:e});switch(n.type){case"AppButtonProps":return Object(zs.a)(Object(Hs.a)(n.id,n.location),Object(k.__assign)(Object(k.__assign)({},n),{shouldTakeFocus:void 0===n.shouldTakeFocus||n.shouldTakeFocus}),Gs());default:throw new Error("The control of type ".concat(n.type," is not valid in a  Box menu"))}}))}})),qs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeButtonExecute=function(){t.props.showSpinner(),t.props.onChangeButtonExecute&&t.props.suggestion?t.props.onChangeButtonExecute(t.props.suggestion.changeId):i.a.shipAssertTag(595731297,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onChangeButtonExecute not set.")},t.onChangeAllButtonExecute=function(){t.props.showSpinner(),t.props.onChangeAllButtonExecute&&t.props.suggestion?t.props.onChangeAllButtonExecute(t.props.suggestion.changeAllId):i.a.shipAssertTag(595731298,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onChangeAllButtonExecute not set.")},t.getMenuDefinition=function(){var e="SpellCheckTaskPaneChangeAllId";return t.props.suggestion&&(e+=t.props.suggestion.changeAllId),{sections:[{controls:[{type:"AppButtonProps",id:e,label:ExcelRibbonStrings.SpellCheckChangeAllButtonText,onExecute:t.onChangeAllButtonExecute}]}]}},t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.suggestion,t=e?e.suggestionText:"",n=!!this.props.disableButtons&&this.props.disableButtons;return n||t&&0!==t.length||(n=!0),O.createElement(Vr.a,{styles:Ws,id:"SpellCheckTaskPaneSuggestionButtonId",type:"AppSplitButtonProps",onExecute:this.onChangeButtonExecute,label:t||ExcelRibbonStrings.SpellCheckNoSuggestionText,hideLabel:!1,controlInMenuRendererFunction:Us(Object(b.a)()),downChevronIcon:ir.a?ir.a.downChevron:"CommonControlChevronDownGlyph_12",icon:"",menuDefinition:this.getMenuDefinition(),disabled:n,useTargetAsMinWidth:!1,ariaDescription:ExcelRibbonStrings.SpellCheckSuggestionsTitle,ariaRoleDescription:OfficeCommonStrings.SplitButtonRoleDescription,splitButtonAriaLabel:t||ExcelRibbonStrings.SpellCheckNoSuggestionText})},t}(O.PureComponent),Qs={color:"#323130",fontSize:"12px",marginTop:"17px",marginBottom:"6px"},Ks={root:{width:"100%",boxSizing:"border-box",margin:"0px",background:"#f5f5f5 !important",display:"flex",justifyContent:"center"},iconContainer:{margin:"4px 4px 4px 4px"},text:[gs,{float:"left",width:"100%",margin:"4px",color:"#201F1E",fontSize:"12px",fontWeight:"normal"}]},Js={root:Object(V.eb)({opacity:.55,background:"transparent",border:"1px solid #bebbb8",height:"136px",marginTop:"4px",marginBottom:"9px",width:"100%",selectors:(Es={},Es[":focus"]=Object(k.__assign)({outline:"none",border:"1px solid #323130 "},Is),Es)}),text:Object(V.eb)([gs,{margin:"0px",padding:"0px",position:"relative",textAlign:"center",top:"50%",transform:"translateY(-50%)"}])},Zs=n(2353),Ys=n(104),Xs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.misspelledWordBox=O.createRef(),t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.misspelledWordBoxContent,t=this.props.previousChangeAllActionInfo,n=this.props.suggestionBoxContent,o=!!n&&!!n.suggestions;return O.createElement("div",{className:Object(V.eb)([{height:"100%",display:"flex",flexDirection:"column",minHeight:"500px",overflow:"hidden",paddingLeft:"16px",paddingRight:"16px",position:"relative",animationName:Object(V.bb)({from:{opacity:0},to:{opacity:1}}),animationDuration:"0.25s",animationTimingFunction:"ease-in"}])},O.createElement(Rs,{ref:this.misspelledWordBox,misspelledWordType:e?e.misspelledWordType:0,misspelledWordBeginIndex:e?e.misspelledWordBeginIndex:0,misspelledWordEndIndex:e?e.misspelledWordEndIndex:0,misspelledWordCellContent:e?e.misspelledWordCellContent:""}),this.renderSuggestionTitle(this.props),o?this.createSuggestionsView(this.props):this.createNoSuggestionsView(),O.createElement("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"flex-start",flexGrow:1,marginBottom:"32px"}},O.createElement(Bs,Object(k.__assign)({disableButtons:this.props.disableButtons,misspelledWordType:e?e.misspelledWordType:null,showSpinner:this.props.showSpinner},this.props.userActionButtons)),t&&t.changeCount&&O.createElement("div",{style:{width:"100%",background:"#f5f5f5 !important"}},O.createElement(Zs.a,{messageBarType:Ys.a.info,styles:Ks},O.createElement("span",null,ExcelRibbonStrings.SpellCheckPreviousChangeInfoText.replace("{0}",t.changeCount.toString()).replace("{1}",t.suggestionApplied?t.suggestionApplied:""))))),O.createElement(Ns,Object(k.__assign)({disableList:this.props.disableButtons,showSpinner:this.props.showSpinner},this.props.localeInfo)))},t.prototype.renderSuggestionTitle=function(e){var t=(e.suggestionBoxContent?e.suggestionBoxContent.suggestions:null)?ExcelRibbonStrings.SpellCheckSuggestionsTitle:ExcelRibbonStrings.SpellCheckNoSuggestionsTitle;return O.createElement("div",{id:"SpellCheckTaskPaneSuggestionsTitleId",role:"heading","aria-level":1,className:Object(V.eb)([gs,Qs])},t)},t.prototype.createSuggestionsView=function(e){var t=this.props.suggestionBoxContent,n=t?t.suggestions:null;if(n){var o=n.map((function(n){return O.createElement("div",{role:"group",key:n.id},O.createElement(qs,{suggestion:n,disableButtons:e.disableButtons,onChangeButtonExecute:t?t.onChangeButtonExecute:null,onChangeAllButtonExecute:t?t.onChangeAllButtonExecute:null,showSpinner:e.showSpinner}))}));return O.createElement("div",{role:"list","aria-label":ExcelRibbonStrings.SpellCheckSuggestionsTitle},o)}return null},t.prototype.createNoSuggestionsView=function(){return O.createElement("div",{tabIndex:0,className:Js.root,"aria-label":ExcelRibbonStrings.SpellCheckSuggestionsTitle+". "+ExcelRibbonStrings.SpellCheckNoSuggestionFoundText},O.createElement("p",{className:Js.text},ExcelRibbonStrings.SpellCheckNoSuggestionFoundText))},t.prototype.focus=function(){this.misspelledWordBox&&this.misspelledWordBox.current&&this.misspelledWordBox.current.focus()},t}(O.PureComponent);function $s(){return Object(f.a)()}var el={root:{backgroundColor:"#ffffff",borderRadius:"2px",border:"1px solid #bebbb8",height:"26px",marginTop:"16px"},rootHovered:{backgroundColor:"#e1dfdd"},rootPressed:{backgroundColor:"#c8c6c4"},rootFocused:{border:"1px solid #323130 "},label:[gs,{marginLeft:"0px",marginRight:"0px",textAlign:"center"}]},tl={fontSize:"14px",fontWeight:"normal",boxSizing:"border-box",paddingLeft:"8px",width:"calc(100% - 35px)"},nl={root:{marginTop:"24px",padding:"0px",background:"#f5f5f5"},iconContainer:{marginLeft:"4px"},text:[gs,{color:"#201F1E",fontWeight:"normal",fontSize:"12px",float:"left"}]},ol={link:{color:"#0078D4",textDecoration:"none",":visited":{color:"#0078D4",textDecoration:"none"},":focus":{border:"1px solid #323130 ",outline:"none"}}},rl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onRecheckClick=function(){i.a.sendTraceTag(595718999,a.a.msoulscat_ES_EWAJS,s.a.Info,"SpellCheckTaskPane Recheck button clicked on notification on active tab ".concat(t.props.activeTab," .")),t.props.showSpinner(),t.props.onRecheckExecute?t.props.onRecheckExecute():i.a.shipAssertTag(595718812,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onRecheckExecute not set.")},t.onMessageButtonExecute=function(){i.a.sendTraceTag(595719e3,a.a.msoulscat_ES_EWAJS,s.a.Info,"SpellCheckTaskPane Message button clicked on active tab ".concat(t.props.activeTab," .")),t.props.showSpinner(),t.props.onButtonExecute?t.props.onButtonExecute(t.props.activeTab):i.a.shipAssertTag(595731296,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onMessageButtonExecute not set.")},t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=el,t=!1,n="",o=Object(V.eb)({border:"1px solid transparent",boxSizing:"border-box",fill:$s().primary,float:"left",height:"20px",width:"20px",padding:"auto",display:"inline-flex",marginTop:"1px"}),r=!!this.props.showOutOfSyncNotification&&this.props.showOutOfSyncNotification;switch(r&&5!==this.props.activeTab&&6!==this.props.activeTab&&8!==this.props.activeTab&&(r=!1,i.a.sendTraceTag(595718811,a.a.msoulscat_ES_EWAJS,s.a.Error,"SpellCheckTaskPane Error :: show out of sync notification received on incorrect tab ".concat(this.props.activeTab," ."))),this.props.activeTab){case 3:case 2:t=!0,n=W.a.Info_20;break;case 7:case 4:t=!0,n=W.a.AlertWarning_20,o=Object(V.eb)({border:"1px solid transparent",boxSizing:"border-box",fill:$s().primary,float:"left",height:"20px",width:"20px",padding:"auto",display:"inline-flex",marginTop:"0px"});break;case 6:case 5:case 8:t=!0,n=ir.a?ir.a.checkboxCheckmark:"CheckmarkWithDynamicColor_12",o=Object(V.eb)({borderRadius:"50%",border:"1px solid "+$s().primary,boxSizing:"border-box",fill:$s().primary,float:"left",height:"20px",padding:"auto",display:"inline-flex",width:"20px",marginTop:"4px"})}return O.createElement("div",{className:Object(V.eb)([{display:"flex",flexDirection:"column",justifyContent:"flex-start",marginTop:"5px",paddingLeft:"16px",paddingRight:"16px",animationName:Object(V.bb)({from:{opacity:0},to:{opacity:1}}),animationDuration:"0.25s",animationTimingFunction:"ease-in"}])},O.createElement("div",{style:{display:"flex"}},t&&O.createElement(H.a,{className:o,iconName:n}),0!==this.props.message.length&&O.createElement("div",{className:Object(V.eb)([gs,tl])},this.props.message)),O.createElement("div",null,4===this.props.activeTab&&this.showSupportedLanguageList()),this.props.showButton&&O.createElement($t.a,{id:"SpellCheckTaskPaneMessageButtonId",type:"AppButtonProps",label:this.props.buttonLabel,onExecute:this.onMessageButtonExecute,styles:e,disabled:this.props.disableButtons,role:"button",ariaDescription:this.props.message}),O.createElement("div",{role:"alert","aria-live":"polite"},r&&O.createElement(Zs.a,{messageBarType:Ys.a.info,styles:nl},O.createElement("span",{"aria-hidden":"true",id:"SpellCheckTaskPaneContentChangedId",style:{lineHeight:"normal"}},ExcelRibbonStrings.SpellCheckWorkbookContentChangedText),O.createElement("a",{href:"#",id:"SpellCheckTaskPaneCheckAgainId",onClick:this.onRecheckClick,"aria-labelledby":"SpellCheckTaskPaneContentChangedId SpellCheckTaskPaneCheckAgainId",style:ol.link,"aria-disabled":!1,role:"button"},ExcelRibbonStrings.SpellCheckCheckAgainText))))},t.prototype.showSupportedLanguageList=function(){return this.props.localeInfo&&this.props.localeInfo.supportedLocaleInfoList&&this.props.localeInfo.supportedLocaleInfoList.length||i.a.shipAssertTag(595730639,a.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane.showSupportedLanguageList Invalid supported language list received."),O.createElement("div",null,O.createElement(Ns,{disableList:this.props.disableButtons,showSpinner:this.props.showSpinner,currentLocale:{localeId:"EN-US"},supportedLocaleInfoList:this.props.localeInfo?this.props.localeInfo.supportedLocaleInfoList:null,onLanguageChangeExecute:this.props.localeInfo?this.props.localeInfo.onLanguageChangeExecute:null,isLanguageErrorTab:!0}))},t}(O.PureComponent),il=n(1334),al=n(370),sl=n(905),ll=function(e){function t(t){var n=e.call(this,t)||this;return n.spellCheck=O.createRef(),n.spellCheckPane=O.createRef(),n.showButtonMessageTab=!1,n.message="",n.buttonLabel="",n.buttonClick=!1,n.focus=function(){if(!n.state.showLoading){var e=n.spellCheckPane.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), div[data-is-focusable="true"]');e&&e[0]&&e[0].focus()}},n.showSpinner=function(e){void 0===e&&(e=!0),e&&!n.state.showLoading?n.stopWatch.reset():!e&&n.state.showLoading&&(n.buttonClick=!0),n.setState({showLoading:e,disableButtons:e})},n.state={showLoading:t.showLoadingIcon,disableButtons:!1},n.showSpinner=n.showSpinner.bind(n),n.stopWatch=Object(sl.a)("SpellCheckTaskPane.SpellCheckSpinnerDuration"),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.registerInformationIcon()},t.prototype.componentDidUpdate=function(){this.spellCheckPane&&this.spellCheckPane.current&&(this.spellCheckPane.current.scrollTop=0),this.buttonClick&&(this.focus(),this.stopWatch.stop(),this.buttonClick=!1)},t.prototype.componentWillUnmount=function(){this.unRegisterInformationIcon()},t.prototype.componentWillReceiveProps=function(e){e.showLoadingIcon!==this.state.showLoading&&this.showSpinner(e.showLoadingIcon)},t.prototype.render=function(){var e=1===this.props.activeTab;return e||this.createMessageTabTexts(this.props.activeTab,this.props.localeInfoContent?this.props.localeInfoContent.currentLocale:null,this.props.worksheetName),O.createElement("div",{ref:this.spellCheckPane,className:Object(V.eb)({height:"100%",overflowX:"hidden",overflowY:"auto",display:"contents",background:"#edebe9"})},e&&O.createElement(Xs,{ref:this.spellCheck,disableButtons:this.state.disableButtons,misspelledWordBoxContent:this.props.misspelledWordBoxContent,suggestionBoxContent:this.props.suggestionBoxContent,userActionButtons:this.props.userActionButtons,localeInfo:this.props.localeInfoContent,showSpinner:this.showSpinner,previousChangeAllActionInfo:this.props.previousChangeAllActionInfo}),!e&&O.createElement(rl,{message:this.message,disableButtons:this.state.disableButtons,activeTab:this.props.activeTab,showButton:this.showButtonMessageTab,buttonLabel:this.buttonLabel,showSpinner:this.showSpinner,localeInfo:this.props.localeInfoContent,onButtonExecute:this.props.onMessageButtonExecute,showOutOfSyncNotification:this.props.showOutOfSyncNotification,onRecheckExecute:this.props.onRecheckExecute}),this.state.showLoading&&O.createElement(Ts.a,{className:Object(V.eb)({height:"auto",zIndex:2,backgroundColor:"rgba(237, 235, 233, .8)",position:"absolute",marginTop:"44px"})},O.createElement(il.a,{styles:Os,className:Object(V.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:ms(),color:ms(),margin:"0px"}}}),size:al.a.large,label:ExcelRibbonStrings.SpellCheckSpinnerText})))},t.prototype.createMessageTabTexts=function(e,t,n){switch(this.message="",this.showButtonMessageTab=!1,this.buttonLabel="",e){case 4:var o="";t?o=t.localeName:i.a.sendTraceTag(595730640,a.a.msoulscat_ES_EWAJS,s.a.Error,"SpellCheckTaskPane invalid current locale received."),this.message=ExcelRibbonStrings.SpellCheckLanguageErrorText.replace("{0}",o);break;case 2:this.message=ExcelRibbonStrings.SpellCheckResumeText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckResumeButtonText;break;case 3:this.message=ExcelRibbonStrings.SpellCheckSwitchWorkSheetErrorText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckReCheckButtonText;break;case 6:this.message=ExcelRibbonStrings.SpellCheckCompleteText;break;case 5:this.props.worksheetName||i.a.sendTraceTag(595730641,a.a.msoulscat_ES_EWAJS,s.a.Error,"SpellCheckTaskPane invalid worksheet received."),this.message=ExcelRibbonStrings.SpellCheckSwitchWorkSheetText.replace("{0}",n||""),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckCheckOtherSheetsButtonText;break;case 8:this.message=ExcelRibbonStrings.SpellCheckCompleteOnRangeText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckReCheckButtonText;break;case 7:default:this.message=ExcelRibbonStrings.SpellCheckErrorText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckTryAgainButtonText}},t.prototype.unRegisterInformationIcon=function(){Object(V.mb)(["Info"])},t.prototype.registerInformationIcon=function(){Object(V.ib)({icons:{Info:O.createElement(H.a,{className:Object(V.eb)({boxSizing:"border-box",fill:"#605e5c",float:"left",height:"16px",width:"16px",padding:"auto",display:"inline-flex"}),iconName:W.a.Info_20})}})},t}(O.Component),cl=n(2346),ul=n(214),dl={marginLeft:"4px",display:"inline-block"},pl={float:"right",display:"flex"},hl=function(){return{root:Object(V.eb)({height:"24px",paddingLeft:"275px",background:"#edebe9",position:"fixed",zIndex:1,float:"right"},{paddingLeft:"247px"}),button:Object(V.eb)([dl])}},gl=(Object(V.eb)({marginTop:"24px",width:"303px",position:"fixed",zIndex:1,background:"#edebe9"}),Object(V.eb)({height:"24px",paddingLeft:"16px"}),{checkbox:{background:"#FFFFFF"}}),ml=Object(Po.c)((function(){return Object(V.eb)({color:Object(f.a)().primary})})),fl={root:Object(V.eb)({padding:"2px 16px"})};function bl(){return Object(f.a)().primary}var vl,yl,xl={marginLeft:"5px",display:"inline-block"},Cl="ExternalLinksContainer-root",Sl="ExternalLinksContainer-button",El=Object(Po.c)((function(e){var t,n;return Object(V.db)({root:[Cl,{height:"48px",padding:"2px 16px",selectors:(t={},t[":hover"]={background:"#e7e6e4"},t[":focus"]={outline:"none",border:"1px solid #323130"},t)}],buttonContainer:[pl],button:[Sl,dl,{visibility:"hidden",selectors:(n={},n[".".concat(Cl,":hover &")]={visibility:"visible"},n[".".concat(Cl,":focus &")]={visibility:"visible"},n[".".concat(Cl,":focus-within &")]={visibility:"visible"},n)},e&&{visibility:"visible"}],spinner:Object(V.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:bl(),color:bl(),marginTop:"3px",marginLeft:"3px"}}})})})),kl={root:Object(V.eb)({height:"24px",float:"left",marginRight:"4px",width:"76%"}),text:Object(V.eb)([xl,{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"0px",position:"relative",width:"86%"}]),icon:Object(V.eb)({height:"22px",width:"22px"})},Ol={root:Object(V.eb)({marginLeft:"28px"}),errorText:Object(V.eb)(xl),icon:Object(V.eb)({height:"16px",width:"16px"})},Tl=n(1990),Il=function(e){function t(t){var n=e.call(this,t)||this;return n.container=O.createRef(),n.getMenuDefinition=function(){var e=n.state.isServerResponsePending||n.props.link.isUpdating,t={sections:[{controls:[{type:"AppButtonProps",id:"openWorkbook-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksOpenWorkbookLabel,disabled:!n.props.link.hostEditUrl,icon:W.a.GoToWorkbook_20,onExecute:wl(n.props.link.hostEditUrl)}]}]};if(n.isChangeSourceEnabled){var o={type:"AppButtonProps",id:"changeSource-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksChangeSourceLabel,icon:W.a.EditCloud_20,onExecute:_l(n.props.link.originalUrl,n.props.link.onButtonExecuteV2),disabled:n.props.link.changeSourceDisabled};t.sections[0].controls.push(o)}var r={type:"AppButtonProps",id:"ExternalLinksTaskPaneRefreshButtonId-"+n.props.id,label:ExcelRibbonStrings.ExternalLinksRefreshButtonText,icon:W.a.Sync_20,onExecute:n.onRefreshButtonExecute,disabled:n.props.link.refreshDisabled||e};t.sections[0].controls.push(r);var i={type:"AppButtonProps",id:"breakLink-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksBreakLinksLabel,icon:W.a.DeleteHyperlink_20,onExecute:Pl(n.props.link.originalUrl,n.props.link.onButtonExecuteV2),disabled:!1};return t.sections[0].controls.push(i),t},n.externalLinksControlInMenuRendererFunction=Object(Pr.c)(ir.a,Object(b.a)()),n.onRefreshButtonExecute=function(){n.props.link&&n.props.link.onButtonExecuteV2?(n.setState({isServerResponsePending:!0}),n.props.link.onButtonExecuteV2(0,n.props.link.originalUrl,(function(){n.setState({isServerResponsePending:!1})})),i.a.sendTraceTag(595637534,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane refresh button clicked.")):i.a.shipAssertTag(595650711,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onRefreshButtonExecute not set.")},n.onFocus=function(){n.setState({showButtons:!0})},n.onBlur=function(){n.setState({showButtons:!1})},n.onKeyDown=function(e){n.props.onKeyDown(n.container,e)},n.isChangeSourceEnabled=Object(mo.e)("WebExternalLinksChangeSource"),n.state={showButtons:!1,isServerResponsePending:!1},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=El(this.state.showButtons),t=this.props.link.lastRefreshed,n=this.state.isServerResponsePending||this.props.link.isUpdating,o=t&&!isNaN(t.getTime())?O.createElement(Tl.a,{date:t,formatter:this.props.dateFormatter}):"",r=this.props.link.statusMessage;return O.createElement("div",{className:e.root,id:"ExternalLinksContainerId-"+this.props.id,ref:this.container,"data-is-focusable":!0,tabIndex:1===this.props.id?0:-1,onKeyDown:this.onKeyDown,"aria-label":this.props.link.workbookName+". "+r,"aria-describedby":this.props.link.errorLongDesc,role:"listitem"},O.createElement("div",{title:this.props.link.displayUrl,className:kl.root},O.createElement(H.a,{className:kl.icon,iconName:W.a.SaveAsExcelXlsx_20}),O.createElement(Ge.a,{className:kl.text},this.props.link.workbookName)),O.createElement("div",{className:e.buttonContainer},O.createElement("div",{className:e.button},O.createElement(Nr.a,{id:"findNextLink-"+this.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksFindNextLinkLabel,disabled:!1,type:"AppButtonProps",icon:W.a.GoToLink_20,hideLabel:!0,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onExecute:Rl(this.props.link.originalUrl,this.props.link.onButtonExecuteV2)})),O.createElement("div",{className:El(this.state.showButtons).button},O.createElement($r,{id:"ExternalLinksTaskPaneEllipsesFlyoutId-"+this.props.id,label:ExcelRibbonStrings.ExternalLinksSingleLinkMoreOptionsButtonText,type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHintFixed:!1,directionalHint:Y.a.bottomRightEdge,icon:c.a.HintBarEllipses_20,menuDefinition:this.getMenuDefinition(),onFocus:this.onFocus,onBlur:this.onBlur,onAfterMenuDismiss:this.onBlur,controlInMenuRendererFunction:this.externalLinksControlInMenuRendererFunction}))),this.props.link.errorLongDesc?O.createElement("div",{title:this.props.link.errorLongDesc,className:Ol.root},O.createElement(H.a,{className:Ol.icon,iconName:W.a.AlertWarning_16}),O.createElement("div",{className:Ol.errorText},r)):O.createElement("div",{title:this.props.link.errorLongDesc,className:Ol.root},n?this.props.busyUiString:O.createElement(O.Fragment,null,this.props.lastRefreshedUiString," ",o)))},t}(O.Component),wl=function(e){return function(){e?(window.open(e,"_blank"),i.a.sendTraceTag(595637535,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane open workbook button clicked.")):i.a.shipAssertTag(595650712,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane hostEditUrl not set.")}},_l=function(e,t){return function(){t?(t(4,e,null),i.a.sendTraceTag(572331906,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane Change Source button clicked.")):i.a.shipAssertTag(572331907,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onButtonExecuteV2 not set.")}},Pl=function(e,t){return function(){t?(t(3,e,null),i.a.sendTraceTag(593762060,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane break link button clicked.")):i.a.shipAssertTag(593762061,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onButtonExecuteV2 not set.")}},Rl=function(e,t){return function(){t?(t(7,e,null),i.a.sendTraceTag(592544162,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane find next link button clicked.")):i.a.shipAssertTag(592544163,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onButtonExecuteV2 not set.")}},Dl=function(e){function t(t){var n=e.call(this,t)||this;return n.domElement=O.createRef(),n.switchFocus=n.switchFocus.bind(n),n.onRenderListItem=n.onRenderListItem.bind(n),n}return Object(k.__extends)(t,e),t.prototype.getLearnMoreLink=function(){return"https://support.microsoft.com/office/c98d1803-dd75-4668-ac6a-d7cca2a9b95f"},t.prototype.render=function(){var e=this.getLearnMoreLink();return 0===this.props.links.length?O.createElement("div",{ref:this.domElement,className:fl.root},O.createElement("p",null,ExcelRibbonStrings.ExternalLinksNoLinkText),e&&O.createElement(et.a,{className:ml(),target:"_blank",href:e},ExcelRibbonStrings.ExternalLinksLearnToCreateText)):O.createElement("div",{ref:this.domElement},O.createElement(ja.a,{role:"list",items:this.props.links,onRenderCell:this.onRenderListItem}))},t.prototype.switchFocus=function(e,t){if(t&&this.domElement.current&&e.current)if(t.which===z.a.down){var n=Object(ua.j)(this.domElement.current,e.current,!1,!1,!0,!1,!1,!1);n&&n.focus()}else if(t.which===z.a.up){var o=Object(ul.a)(e.current,!1),r=Object(ua.j)(this.domElement.current,null!=o?o.previousElementSibling:null,!1,!1,!1,!1,!1,!1);r&&r.focus()}},t.prototype.onRenderListItem=function(e,t){if(void 0!==e)return O.createElement(Il,{link:e,id:void 0!==t?t+1:0,onKeyDown:this.switchFocus,dateFormatter:this.props.dateFormatter,busyUiString:this.props.busyUiString,lastRefreshedUiString:this.props.lastRefreshedUiString})},t}(O.Component),jl=n(779),Bl=function(e){function t(t){var n=e.call(this,t)||this;n.domElement=O.createRef(),n.onAutoRefreshExecute=function(){n.props.onAutoUpdateExecute?(n.props.onAutoUpdateExecute(6),i.a.sendTraceTag(595161494,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane auto refresh checkbox clicked.")):i.a.shipAssertTag(595161495,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onAutoUpdateExecute not set.")},n.onRefreshAllButtonExecute=function(){n.props.onRefreshAllButtonExecuteV2?(n.setState({isServerResponsePending:!0}),n.props.onRefreshAllButtonExecuteV2((function(){n.setState({isServerResponsePending:!1})})),i.a.sendTraceTag(595637536,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane RefreshAll button clicked.")):i.a.shipAssertTag(595646292,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onRefreshAllButtonExecute not set.")},n.onBreakAllLinksButtonExecute=function(){n.props.onBreakAllLinksButtonExecute?(n.props.onBreakAllLinksButtonExecute(),i.a.sendTraceTag(593356554,a.a.msoulscat_ES_EWAJS,s.a.Info,"ExternalLinksTaskPane BreakAllLinks button clicked.")):i.a.shipAssertTag(593356555,a.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onBreakAllLinksButtonExecute not set.")},n.onFocus=function(){if(n.domElement.current){var e=Object(ul.a)(n.domElement.current,!0);e&&e.classList.add("is-focusVisible","ms-Fabric--isFocusVisible")}},n.getMenuDefinition=function(){return{sections:[{controls:[{type:"AppCheckboxProps",label:ExcelRibbonStrings.ExternalLinksAutomaticRefreshCheckBoxLabel,id:"AutomaticRefreshCheckbox",title:ExcelRibbonStrings.ExternalLinksAutomaticRefreshToolTip,styles:gl,checkmarkIcon:ir.a.checkboxCheckmark,checked:n.props.autoRefreshEnabled,onExecute:n.onAutoRefreshExecute,disabled:!1},{type:"AppButtonProps",label:ExcelRibbonStrings.ExternalLinksBreakAllLinksLabel,id:"BreakLinkButton",disabled:n.props.breakAllLinksDisabled,icon:W.a.DeleteHyperlink_20,onExecute:n.onBreakAllLinksButtonExecute}]}]}},n.externalLinksControlInMenuRendererFunction=Object(Pr.c)(ir.a,Object(b.a)()),n.state={isServerResponsePending:!1};var o=t.uiCulture?t.uiCulture:"en-US",r=t.dataCulture?t.dataCulture:"en-US",l=Object(k.__assign)({},FriendlyDatesStrings),c=new jl.a(o,r,l,!0);return n.dateFormatter=c.format.bind(c),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e,t={paneBody:Object(V.eb)({height:"100%",display:"contents"}),subHeader:Object(V.eb)({height:"28px",padding:"0px 16px",fontSize:"14px",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif'})},n=this.props.externalLinkInfoList;return this.state.isServerResponsePending&&(n=null===(e=this.props.externalLinkInfoList)||void 0===e?void 0:e.map((function(e){var t=e||void 0;return t&&(t.isUpdating=!0),t}))),null!=this.props.externalLinkInfoList&&O.createElement(cl.a,null,O.createElement("div",{ref:this.domElement,className:t.paneBody},O.createElement("div",{className:hl().root},O.createElement("div",{className:hl().button},O.createElement(Nr.a,{id:"ExternalLinksTaskPaneRefreshAllButtonId",label:ExcelRibbonStrings.ExternalLinksRefreshAllButtonText,disabled:this.props.refreshAllDisabled,type:"AppButtonProps",icon:W.a.Sync_20,hideLabel:!0,onFocus:this.onFocus,onExecute:this.onRefreshAllButtonExecute})),O.createElement("div",{className:hl().button},O.createElement($r,{id:"ExternalLinksTaskPaneMainEllipsesFlyoutId",label:ExcelRibbonStrings.ExternalLinksAllLinksMoreOptionsButtonText,type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHint:Y.a.bottomRightEdge,icon:c.a.HintBarEllipses_20,menuDefinition:this.getMenuDefinition(),onFocus:this.onFocus,controlInMenuRendererFunction:this.externalLinksControlInMenuRendererFunction}))),O.createElement("div",null),O.createElement("div",{className:Object(V.eb)({paddingTop:"24px"})},O.createElement(Dl,{links:n,dateFormatter:this.dateFormatter,busyUiString:this.props.busyUiString?this.props.busyUiString:"",lastRefreshedUiString:this.props.lastRefreshedUiString?this.props.lastRefreshedUiString:""}))))},t}(O.Component),Fl={border:"1px solid #b0b0b0",selectors:{":hover":{border:"1px solid #b0b0b0"}}},Ll=Object(Po.c)((function(){return Object(V.db)({root:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"16px",paddingRight:"16px"},description:[Wl,{marginBottom:"8px"}],controlGroup:{marginBottom:"4px",display:"flex",alignItems:"center"},spinnerContainer:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}})})),Ml={root:{marginRight:"4px"},dropdown:{width:"100px",fontSize:"12px"},title:[Fl,{height:"24px",lineHeight:"24px"}],caretDownWrapper:{height:"24px",lineHeight:"24px"},dropdownItem:{minHeight:"28px",fontSize:"12px"},dropdownItemSelected:{minHeight:"28px",fontSize:"12px"}},Al=Object(Po.c)((function(){return Object(V.eb)([{marginBottom:"16px"}])})),Nl={height:"12px",width:"12px",marginLeft:"auto",cursor:"pointer"},Wl={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px"},Hl=((vl={})[V.m]={backgroundColor:"Highlight",selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},vl),zl={root:{height:"24px",minWidth:"24px",padding:0},icon:{height:"16px",width:"16px"},menuIcon:{height:"8px",width:"8px",lineHeight:"8px",margin:0},rootExpanded:{backgroundColor:"#D2D0CE",selectors:Hl},rootHovered:{backgroundColor:"#E1DFDD",selectors:Hl},rootFocused:{selectors:Hl},rootPressed:{selectors:Hl}},Vl={root:{height:"28px",lineHeight:"28px"},label:{fontSize:"12px",height:"28px",lineHeight:"28px"},icon:{height:"28px",lineHeight:"28px"},checkmarkIcon:{display:"none"}},Gl={calloutMain:{overflow:"hidden",selectors:(yl={},yl[V.m]={selectors:{"button[aria-checked='true'] svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"}}},yl)}},Ul={root:{height:"12px",width:"12px"}},ql={backgroundColor:"#F3F2F1"},Ql={outline:"1px solid #605E5C",outlineOffset:"-2px",selectors:{".fieldItemMenuIconWrapper":{visibility:"visible !important"}}},Kl={outline:"none",backgroundColor:"Highlight",color:"HightlightText",selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"},".fieldItemLabel":{color:"HighlightText",backgroundColor:"Highlight",forcedColorAdjust:"none"}}},Jl=n(1127),Zl=n(147),Yl=n(2203),Xl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(yi.a,Object(k.__assign)({},this.props,{styles:this.props.styles?Object(Yl.b)(this.props.styles,Lr.a.Small):Object(Yl.a)(Lr.a.Small)}))},t}(O.PureComponent),$l=Object(Po.c)((function(e,t,n,o,r,i){var a;return Object(V.db)({root:{display:"flex",alignItems:"center",width:"100%",height:"100%",minHeight:"18px",boxSizing:"border-box",paddingLeft:t?n?16*e+2:16*e+18:i&&!n?16:16*e,paddingRight:4,selectors:(a={":hover":ql,":focus-visible":Ql},a[V.m]={selectors:{":hover, :focus":Kl}},a)},icon:{height:"16px",width:"16px",overflow:"hidden"},hierarchicalIcon:{height:"16px",width:"16px",overflow:"hidden",marginLeft:"4px"},label:[Wl,{fontWeight:o||r?"600":"normal",padding:"0 0 0 4px",textOverflow:"ellipsis",overflow:"hidden",flex:"1",cursor:"default",whiteSpace:"nowrap"}],menuIcon:[Nl],menuIconWrapper:{visibility:"hidden",height:"18px",lineHeight:"18px"}})})),ec={root:{height:"12px",width:"12px",marginRight:"2px",marginLeft:"2px",padding:0},checkbox:{height:"12px",width:"12px"},checkmark:{fontSize:"12px",height:"12px",width:"12px"}},tc=Object(Po.c)((function(e){var t;return Object(V.db)({root:{display:"flex",alignItems:"center",width:"100%",height:"".concat(18,"px"),boxSizing:"border-box",borderTop:"".concat(1,e?"px solid #0f9900":"px solid transparent"),borderBottom:"1px solid transparent",paddingLeft:"4px",paddingRight:"4px",selectors:(t={":hover":ql,":focus-visible":Ql},t[V.m]={borderTop:"".concat(1,e?"px solid Highlight":"px solid Window"),borderBottom:"".concat(1,"px solid Window"),selectors:{":hover, :focus":Kl}},t)},label:[Wl,{padding:"0 0 0 4px",textOverflow:"ellipsis",overflow:"hidden",flex:"1",cursor:"default",whiteSpace:"nowrap"}],menuIcon:[Nl],menuIconWrapper:{visibility:"hidden",height:"".concat(18,"px"),lineHeight:"".concat(18,"px")}})})),nc=Object(Po.c)((function(e){return Object(V.db)({root:{marginBottom:e?0:"".concat(16,"px")},title:[Wl,{alignItems:"center",display:"flex",fontWeight:600,height:"".concat(16,"px"),marginBottom:"".concat(4,"px")}],titleIcon:{height:"16px",width:"16px",marginRight:"4px"},content:{background:"#FFFFFF",border:"".concat(1,"px solid #b0b0b0"),borderRadius:"2px",boxSizing:"border-box",overflowY:"auto"}})})),oc=Object(Po.c)((function(e){return{height:-1===e?"auto":18*e+2}})),rc=Object(Po.c)((function(e,t){var n;return Object(V.eb)([{height:"".concat(t?18:36,"px"),width:"100%",boxSizing:"border-box",borderTop:"".concat(1,e?"px solid #0f9900":"px solid transparent"),selectors:(n={},n[V.m]={borderTop:"".concat(1,e?"px solid Highlight":"px solid Window")},n)}])}));Object(Po.c)((function(){return Object(V.eb)([{borderTop:"1px solid #0f9900"}])}));function ic(e,t,n,o,r){if(null==e||null==e.current)return[-1,-1,-1,-1];var i=e.current.offsetHeight-64-16-48-8;i<72?(i=72,e.current.style.overflowY="auto"):e.current.style.overflowY="hidden";var a=i/18-.1,s=0===t?t+2:t+1,l=0===n?n+2:n+1,c=0===o?o+2:o+1,u=0===r?r+2:r+1,d=s+l+c+u;if(a>=d)return[-1,-1,-1,-1];var p=[{type:4,size:s},{type:2,size:l},{type:1,size:c},{type:8,size:u}];p.sort((function(e,t){return t.size-e.size}));var h=d-a,g=new Map;p[0].size-p[1].size>=h?g.set(p[0].type,p[0].size-h):(h-=p[0].size-p[1].size,2*(p[1].size-p[2].size)>=h?(g.set(p[0].type,p[1].size-h/2),g.set(p[1].type,p[1].size-h/2)):(h-=2*(p[1].size-p[2].size),3*(p[2].size-p[3].size)>=h?(g.set(p[0].type,p[2].size-h/3),g.set(p[1].type,p[2].size-h/3),g.set(p[2].type,p[2].size-h/3)):p.forEach((function(e){g.set(e.type,a/4)}))));return[4,2,1,8].forEach((function(e){g.has(e)||g.set(e,-1)})),[g.get(4),g.get(2),g.get(1),g.get(8)]}var ac,sc=function(e,t,n,o){if(null!=e&&null!=e.current){var r=t?"fieldItemOnFocus":"fieldItemOnHover";n?(e.current.classList.add(r),e.current.style.visibility="visible"):(e.current.classList.remove(r),o||e.current.classList.contains("fieldItemMenuOpen")||(e.current.style.visibility="hidden"))}},lc=Object(Po.c)((function(e){switch(e){case 2:return"fieldWellColumnsTitle";case 8:return"fieldWellDataTitle";case 1:return"fieldWellRowsTitle";case 4:return"fieldWellFilterTitle";default:return""}})),cc=function(e){return"fieldItem_".concat(e,"_MenuIcon")},uc=function(){function e(){}return e.updateData=function(t,n){e.isV2Enabled=n,e.onSaveFieldListSizePercentage=t.onSaveFieldListSizePercentage||function(){},e.onSelectedTabChanged=t.onSelectedTabChanged||function(){},e.onSortOrderChanged=t.onSortOrderChanged||function(){},e.onExpandCollapseAll=t.onExpandCollapseAll||function(){},e.onFieldMove=t.onFieldMove||function(){},e.onFieldExpandCollapse=t.onFieldExpandCollapse||function(){},e.onFieldCheckedChanged=t.onFieldCheckedChanged||function(){},e.onFieldWellItemMenuClickV2=t.onFieldWellItemMenuClickV2||function(){},e.onFieldListItemMenuClickV2=t.onFieldListItemMenuClickV2||function(){},e.onSearchInputChanged=t.onSearchInputChanged||function(){}},e}(),dc=function(e){function t(t){var n=e.call(this,t)||this;return n.itemMenuIconRef=O.createRef(),n.rootDiv=O.createRef(),n.rootComponentRef=O.createRef(),n.updateDroppingState=function(e,t){},n.getFieldListItemIconName=function(e,t){if(e.isMoreFields)return W.a.XLFieldListFieldsOpenIcon_16;switch(e.type){case 11:return t?W.a.XLFieldListWbkTableIcon_16:W.a.XLFieldListDimensionIcon_16;case 19:return W.a.XLFieldListValues_16;case 3:return c.a.Function_16;case 29:case 31:return W.a.XLFieldListKPIIcon_16;case 23:return e.isCollapsed?W.a.Folder_16:W.a.Open_16;case 13:return e.isCollapsed?W.a.XLFieldListSetsClosedIcon_16:W.a.XLFieldListSetsOpenIcon_16;case 66:return W.a.Entity_16;default:return""}},n.onFieldListItemClick=function(){n.props.item.isCollapsible&&uc.onFieldExpandCollapse(n.props.item.id)},n.onFieldListItemMenuClick=function(e){e.stopPropagation(),n.onFieldListItemMenuClickHelper(n.props.item.id,!1)},n.onFieldListItemMenuClickHelper=function(e,t){uc.onFieldListItemMenuClickV2(e,cc(e),t)},n.onCheckBoxDivClick=function(e){e.stopPropagation()},n.onFieldListItemFocus=function(){n.isFocused=!0,sc(n.itemMenuIconRef,!0,!0,!1)},n.onFieldListItemBlur=function(){n.isFocused=!1,sc(n.itemMenuIconRef,!0,!1,!1)},n.onFieldListItemMouseEnter=function(){sc(n.itemMenuIconRef,!1,!0,!1)},n.onFieldListItemMouseLeave=function(){sc(n.itemMenuIconRef,!1,!1,n.isFocused)},n.onFieldListItemKeyDown=function(e){var t=n.props.item;switch(e.key){case"Enter":e.preventDefault(),n.onFieldListItemMenuClickHelper(t.id,!0);break;case"ArrowLeft":case"ArrowRight":case"Left":case"Right":t.isCollapsible&&uc.onFieldExpandCollapse(t.id);break;case"ArrowDown":case"Down":e.altKey&&(e.preventDefault(),n.onFieldListItemMenuClickHelper(t.id,!0));break;case" ":case"Spacebar":e.preventDefault(),t.showCheckBox&&uc.onFieldCheckedChanged(t.id,!t.isChecked)}},n.onCheckboxChange=function(e){uc.onFieldCheckedChanged(n.props.item.id,e.checked)},n.updateItemCheckboxAriaLabel=function(){var e,t="fieldItem_".concat(n.props.item.id,"_checkbox"),o=document.querySelector("input[data-unique-id='".concat(t,"-input']"));o&&o.setAttribute("aria-label",null!==(e=n.props.item.name)&&void 0!==e?e:"")},n.isFocused=!1,n.events=new Zl.a(n),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.dragDropHelper;this.updateItemCheckboxAriaLabel(),e&&this.rootDiv.current?this.dragDropSubscription=e.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()):i.a.sendTraceTag(554297423,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldListItemContainer.ComponentDidMount: root div is null, failed to register drag and drop."),-1!==this.props.focusResetId&&this.props.item.id===this.props.focusResetId&&null!=this.rootComponentRef.current&&this.rootComponentRef.current.focus()},t.prototype.componentDidUpdate=function(e){this.props.item.id!==e.item.id&&this.updateItemCheckboxAriaLabel(),this.props.itemIndex===e.itemIndex&&this.props.item===e.item&&this.props.dragDropHelper===e.dragDropHelper||(this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.props.dragDropHelper&&this.rootDiv.current&&(this.dragDropSubscription=this.props.dragDropHelper.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()))),-1!==this.props.focusResetId&&this.props.focusResetId!==e.focusResetId&&this.props.item.id===this.props.focusResetId&&null!=this.rootComponentRef.current&&this.rootComponentRef.current.focus()},t.prototype.componentWillUnmount=function(){this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose()},t.prototype.render=function(){var e=this.props.item,t=this.getFieldListItemIconName(e,this.props.isDataModel),n=this.props.nestingDepth>0&&(e.isCollapsible||!e.isCollapsible&&(""===t||3===e.type)),o=$l(this.props.nestingDepth,n,e.isCollapsible,e.isChecked,e.isBolded,this.props.isRichPivotFieldList),r="fieldItem_".concat(e.id,"_label");return O.createElement(Da.a,{id:"fieldItem_".concat(e.id),"data-is-focusable":!0,role:"treeitem",elementRef:this.rootDiv,componentRef:this.rootComponentRef,className:o.root,"aria-checked":e.showCheckBox?e.isChecked:void 0,"aria-expanded":e.isCollapsible?!e.isCollapsed:void 0,"aria-haspopup":!!e.showMenu&&"menu","aria-labelledby":r,draggable:e.canDrag,allowFocusRoot:!0,onClick:this.onFieldListItemClick,onKeyDown:this.onFieldListItemKeyDown,onFocus:this.onFieldListItemFocus,onBlur:this.onFieldListItemBlur,onMouseEnter:this.onFieldListItemMouseEnter,onMouseLeave:this.onFieldListItemMouseLeave},e.isCollapsible?O.createElement(H.a,{className:o.icon,iconName:e.isCollapsed?W.a.XLFieldListExpanderPlus_16:W.a.XLFieldListExpanderMinus_16}):null,""!==t&&66!==e.type&&3!==e.type?O.createElement(H.a,{className:o.icon,iconName:t}):null,e.showCheckBox?O.createElement(Da.a,{disabled:!0},O.createElement("div",{onClick:this.onCheckBoxDivClick},O.createElement(Xl,{id:"fieldItem_".concat(e.id,"_checkbox"),type:"AppCheckboxProps",label:"",styles:ec,checked:e.isChecked,checkmarkIcon:ir.a.checkboxCheckmark,onExecute:this.onCheckboxChange}))):null,""===t||66!==e.type&&3!==e.type?null:O.createElement(H.a,{className:o.hierarchicalIcon,iconName:t}),O.createElement("div",{id:r,title:e.name?e.name:"",className:"".concat(o.label," fieldItemLabel"),"aria-hidden":!0},e.name),e.showMenu?O.createElement("div",{id:cc(e.id),role:"button","aria-labelledby":r,"aria-haspopup":"menu",className:"".concat(o.menuIconWrapper," fieldItemMenuIconWrapper"),ref:this.itemMenuIconRef,onClick:this.onFieldListItemMenuClick,"data-testid":"FieldMenuIcon"},O.createElement(H.a,{className:o.menuIcon,iconName:W.a.CommonControlChevronDown_12})):null)},t.prototype.getDragDropOptions=function(){var e=this.props,t=e.item,n=e.itemIndex,o=e.dragDropEvents;return{selectionIndex:n,context:{data:t,index:n},canDrag:o.canDrag,onDragStart:o.onDragStart,updateDropState:this.updateDroppingState,onDragEnd:o.onDragEnd}},t}(O.Component),pc=function(e){function t(n){var o=e.call(this,n)||this;return o.dragDropHelper=new Jl.a({selection:new wi.a}),o.onRenderFieldListCell=function(e,n,r){if(e&&"number"==typeof n&&n>-1){var i=e.showSeparator||11===e.type||19===e.type||29===e.type||13===e.type;return O.createElement("div",null,e.isMoreFields?null:O.createElement(dc,{item:e,itemIndex:n,nestingDepth:o.props.nestingDepth,isDataModel:o.props.isDataModel,dragDropEvents:o.dragDropEvents,dragDropHelper:o.dragDropHelper,focusResetId:o.props.focusResetId,isRichPivotFieldList:o.props.isRichPivotFieldList}),(e.isCollapsible&&!e.isCollapsed||e.isMoreFields)&&e.children&&e.children.length>0?O.createElement("div",null,O.createElement(t,{items:e.children,nestingDepth:e.isMoreFields?o.props.nestingDepth:o.props.nestingDepth+1,isDataModel:o.props.isDataModel,setDragItemInfo:o.props.setDragItemInfo,getDragItemInfo:o.props.getDragItemInfo,focusResetId:o.props.focusResetId,isRichPivotFieldList:o.props.isRichPivotFieldList})):null,i?O.createElement("div",{className:Al()}):null)}return null},o.dragDropEvents=o.getDragDropEvents(),o}return Object(k.__extends)(t,e),t.prototype.render=function(){return this.props.items?O.createElement(ja.a,{"data-testid":"fieldList",role:0===this.props.nestingDepth?"tree":"group",items:this.props.items,onRenderCell:this.onRenderFieldListCell}):null},t.prototype.getDragDropEvents=function(){var e=this;return{canDrag:function(e){return!!e&&e.canDrag},onDragStart:function(t){t?e.props.setDragItemInfo(0,t):i.a.sendTraceTag(554297424,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldList.OnDragStart: field list item is undefined.")},onDragEnd:function(){e.props.setDragItemInfo(0,null)}}},t}(O.PureComponent),hc=function(e){function t(t){var n=e.call(this,t)||this;return n.itemMenuIconRef=O.createRef(),n.rootDiv=O.createRef(),n.rootComponentRef=O.createRef(),n.updateDroppingState=function(e,t){n.state.isDraggingOver!==e&&n.setState({isDraggingOver:e})},n.onFieldWellItemMenuClickHelper=function(e,t,n){uc.onFieldWellItemMenuClickV2(e,t,cc(e),n)},n.onFieldWellItemKeyDown=function(e){("Enter"===e.key||("ArrowDown"===e.key||"Down"===e.key)&&e.altKey)&&(e.preventDefault(),n.onFieldWellItemMenuClickHelper(n.props.item.id,n.props.type,!0))},n.onFieldWellItemMenuClick=function(e){n.onFieldWellItemMenuClickHelper(n.props.item.id,n.props.type,!1)},n.onFieldWellItemFocus=function(){n.isFocused=!0,sc(n.itemMenuIconRef,!0,!0,!1)},n.onFieldWellItemBlur=function(){n.isFocused=!1,sc(n.itemMenuIconRef,!0,!1,!1)},n.onFieldWellItemMouseEnter=function(){sc(n.itemMenuIconRef,!1,!0,!1)},n.onFieldWellItemMouseLeave=function(){sc(n.itemMenuIconRef,!1,!1,n.isFocused)},n.isFocused=!1,n.events=new Zl.a(n),n.state={isDraggingOver:!1},n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.dragDropHelper;e&&this.rootDiv.current?this.dragDropSubscription=e.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()):i.a.sendTraceTag(554297419,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldWellItemContainer.ComponentDidMount: root div is null, failed to register drag and drop."),-1!==this.props.focusResetId&&this.props.item.id===this.props.focusResetId&&this.rootComponentRef.current&&this.rootComponentRef.current.focus()},t.prototype.componentDidUpdate=function(e){this.props.itemIndex===e.itemIndex&&this.props.item===e.item&&this.props.dragDropHelper===e.dragDropHelper||(this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.props.dragDropHelper&&this.rootDiv.current&&(this.dragDropSubscription=this.props.dragDropHelper.subscribe(this.rootDiv.current,this.events,this.getDragDropOptions()))),-1!==this.props.focusResetId&&this.props.focusResetId!==e.focusResetId&&this.props.item.id===this.props.focusResetId&&this.rootComponentRef.current&&this.rootComponentRef.current.focus()},t.prototype.componentWillUnmount=function(){this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose()},t.prototype.render=function(){var e=this.props.item,t=tc(this.state.isDraggingOver),n=lc(this.props.type),o="fieldItem_".concat(e.id,"_label");return O.createElement(Da.a,{id:"fieldItem_".concat(e.id),"data-is-focusable":!0,role:"listitem",elementRef:this.rootDiv,componentRef:this.rootComponentRef,className:t.root,"aria-labelledby":"".concat(n," ").concat(o),"aria-haspopup":"menu",draggable:!0,allowFocusRoot:!0,onKeyDown:this.onFieldWellItemKeyDown,onFocus:this.onFieldWellItemFocus,onBlur:this.onFieldWellItemBlur,onMouseEnter:this.onFieldWellItemMouseEnter,onMouseLeave:this.onFieldWellItemMouseLeave},O.createElement("div",{id:o,className:"".concat(t.label," fieldItemLabel"),title:e.name,"aria-hidden":!0},e.name),O.createElement("div",{id:cc(e.id),"data-testid":"fieldWellItemIcon",role:"button","aria-labelledby":"".concat(n," ").concat(o),"aria-haspopup":"menu",className:"".concat(t.menuIconWrapper," fieldItemMenuIconWrapper"),ref:this.itemMenuIconRef,onClick:this.onFieldWellItemMenuClick},O.createElement(H.a,{className:t.menuIcon,iconName:W.a.CommonControlChevronDown_12})))},t.prototype.getDragDropOptions=function(){var e=this.props,t=e.item,n=e.itemIndex,o=e.dragDropEvents;return{selectionIndex:n,context:{data:t,index:n},canDrag:o.canDrag,canDrop:o.canDrop,onDragStart:o.onDragStart,onDragEnd:o.onDragEnd,updateDropState:this.updateDroppingState,onDrop:o.onDrop}},t}(O.Component),gc=function(e){function t(t){var n=e.call(this,t)||this;return n.dragDropHelper=new Jl.a({selection:new wi.a}),n.emptyRowDiv=O.createRef(),n.getFieldWellTitleIconName=function(e){switch(e){case 4:return W.a.XLFieldListFilter_16;case 1:return W.a.XLFieldListRows_16;case 2:return W.a.XLFieldListColumns_16;case 8:return W.a.XLFieldListValues_16;default:return""}},n.onRenderListRow=function(e,t,o){return e&&"number"==typeof t&&t>-1?O.createElement(hc,{item:e,itemIndex:t,type:n.props.type,focusResetId:n.props.focusResetId,dragDropEvents:n.dragDropEvents,dragDropHelper:n.dragDropHelper}):null},n.canFieldWellEmptyRowDrop=function(){return!0},n.onFieldWellEmptyRowDrop=function(e,t){null==t||t.stopPropagation(),null==t||t.preventDefault();var o=n.props.getDragItemInfo();if(n.props.setDragItemInfo(0,null),null!=n.props.items){var r=n.props.items.length;null==o.dragItem||r>0&&n.props.items[r-1].id===o.dragItem.id||uc.onFieldMove(o.dragItem.id,o.dragItemSourceAxis,n.props.type,n.props.items.length)}},n.updateFieldWellEmptyRowDroppingState=function(e,t){n.state.isDraggingToEmptyRow!==e&&n.setState({isDraggingToEmptyRow:e})},n.dragDropEvents=n.getDragDropEvents(),n.state={isDraggingToEmptyRow:!1},n.events=new Zl.a(n),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.emptyRowDiv.current?this.dragDropSubscription=this.dragDropHelper.subscribe(this.emptyRowDiv.current,this.events,this.getEmptyRowDragDropOptions()):i.a.sendTraceTag(554297420,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldWell.ComponentDidMount: empty row div is null, failed to register drag and drop.")},t.prototype.componentWillUnmount=function(){this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose()},t.prototype.render=function(){var e=this.props,t=e.type,n=e.items,o=this.getFieldWellTitleIconName(t),r=nc(8===this.props.type);return O.createElement("div",{className:r.root,"data-testid":"fieldWell"},O.createElement("div",{className:r.title},""!==o?O.createElement(H.a,{className:r.titleIcon,iconName:o}):null,O.createElement("div",{id:lc(this.props.type)},this.props.title)),O.createElement("div",{className:"".concat(r.content," fieldWellContent"),style:oc(this.props.rowsLimitToOverflow)},O.createElement(Da.a,{direction:Zt.a.vertical,isCircularNavigation:!0},n?O.createElement(ja.a,{role:"list",items:n,onRenderCell:this.onRenderListRow}):null),O.createElement("div",{className:rc(this.state.isDraggingToEmptyRow,!!n&&n.length>0),ref:this.emptyRowDiv})))},t.prototype.getDragDropEvents=function(){var e=this;return{canDrop:function(){return!0},canDrag:function(){return!0},onDrop:function(t,n){null==n||n.stopPropagation(),null==n||n.preventDefault();var o=e.props.getDragItemInfo();if(e.props.setDragItemInfo(0,null),null!=t&&null!=e.props.items&&null!=o.dragItem&&t.id!==o.dragItem.id){var r=e.props.items.indexOf(t);uc.onFieldMove(o.dragItem.id,o.dragItemSourceAxis,e.props.type,r)}},onDragStart:function(t){t?e.props.setDragItemInfo(e.props.type,t):i.a.sendTraceTag(554297421,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldWell.OnDragStart: field well item is undefined.")},onDragEnd:function(){e.props.setDragItemInfo(0,null)}}},t.prototype.getEmptyRowDragDropOptions=function(){return{selectionIndex:0,context:{data:null,index:0},canDrop:this.canFieldWellEmptyRowDrop,onDrop:this.onFieldWellEmptyRowDrop,updateDropState:this.updateFieldWellEmptyRowDroppingState}},t}(O.PureComponent),mc=Object(Po.c)((function(e){return Object(V.db)({root:{display:"flex",flex:"1",flexDirection:"row",height:"100%",overflow:"hidden",paddingBottom:"16px"},fieldListWithSearchArea:{flex:"1",display:"flex",flexDirection:"column"},fieldListArea:{background:"#FFFFFF",border:"1px solid #b0b0b0",borderRadius:"2px",boxSizing:"border-box",flex:"1",overflowY:"auto",display:"flex",flexDirection:"column"},fieldWellsArea:{overflowY:"hidden",flex:"1",marginTop:e?"4px":0},resizeBar:{width:"".concat(10,"px"),cursor:"col-resize",boxSizing:"border-box",selectors:{":focus-visible":{outline:"1px solid #605E5C",outlineOffset:"-2px"}}},noMatchArea:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"}})})),fc=n(1491),bc={root:[Fl,{height:"24px",marginBottom:"4px"}],icon:{height:"16px",width:"16px"},field:{fontSize:"12px",padding:0},clearButton:{selectors:(ac={},ac[V.m]={selectors:{"button:hover, button:focus":{backgroundColor:"Highlight !important"}}},ac)}},vc=function(e){function t(t){var n=e.call(this,t)||this;return n.onSearchChange=function(e,t){n.state.value!==t&&(uc.onSearchInputChanged(t||""),n.setState({value:t||""}))},n.state={value:"",savedProps:n.props},n}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.savedProps!==e?e.needSearchRestore?{value:e.searchRestoreValue,savedProps:e}:e.needSearchReset?{value:"",savedProps:e}:{savedProps:e}:null},t.prototype.render=function(){return O.createElement(fc.a,{id:"fieldListSearchbox",placeholder:ExcelRibbonStrings.FieldListSearch,ariaLabel:ExcelRibbonStrings.FieldListSearchDescription,autoComplete:"off",onChange:this.onSearchChange,value:this.state.value,styles:bc,iconProps:Object(co.a)(c.a.Search_20),clearButtonProps:{title:ExcelRibbonStrings.FieldListSearchClear,ariaLabel:ExcelRibbonStrings.FieldListSearchClear,iconProps:Object(co.a)(c.a.CancelGlyph_16)}})},t}(O.PureComponent),yc=n(1156),xc=function(){function e(){}return e.prototype.register=function(e,t){if(void 0===window.ResizeObserver?this.observer=new yc.a(t):this.observer=new window.ResizeObserver(t),this.observer)for(var n=0;n<e.length;n+=1)this.observer.observe(e[n])},e.prototype.dispose=function(){this.observer&&(this.observer.disconnect(),delete this.observer)},e}(),Cc=n(2343),Sc=function(e){function t(t){var n=e.call(this,t)||this;return n.fieldListWithSearchRef=O.createRef(),n.fieldListRef=O.createRef(),n.dragDropAreaRef=O.createRef(),n.dragDropHelper=new Jl.a({selection:new wi.a}),n.setDragItemInfo=function(e,t){n.dragItemInfo={dragItemSourceAxis:e,dragItem:t}},n.getDragItemInfo=function(){return n.dragItemInfo},n.canFieldListAreaDrop=function(){return!0},n.onFieldListAreaDrop=function(e,t){null==t||t.stopPropagation(),null==t||t.preventDefault();var o=n.getDragItemInfo();n.setDragItemInfo(0,null),null!=o.dragItem&&0!==o.dragItemSourceAxis&&uc.onFieldMove(o.dragItem.id,o.dragItemSourceAxis,0,0)},n.updateDroppingState=function(e,t){},n.elementInFieldListOrWellContentArea=function(e){if(null==e)return!1;if(n.fieldListRef.current&&n.fieldListRef.current.contains(e))return!0;for(var t=document.getElementsByClassName("fieldWellContent"),o=0;o<t.length;o+=1)if(t[o].contains(e))return!0;return!1},n.onDocumentDragOver=function(e){if(null==e.target||!n.elementInFieldListOrWellContentArea(e.target)){var t=n.getDragItemInfo();null!=t.dragItem&&0!==t.dragItemSourceAxis&&(e.stopPropagation(),e.preventDefault())}},n.onDocumentDrop=function(e){if(null==e.target||!n.elementInFieldListOrWellContentArea(e.target)){var t=n.getDragItemInfo();n.setDragItemInfo(0,null),null!=t.dragItem&&0!==t.dragItemSourceAxis&&(e.stopPropagation(),e.preventDefault(),uc.onFieldMove(t.dragItem.id,t.dragItemSourceAxis,0,0))}},n.updateFieldListWidth=function(e,t){if(null!=n.fieldListWithSearchRef.current&&null!=n.dragDropAreaRef.current){var o=(Object(F.a)()?n.fieldListWithSearchRef.current.offsetWidth-e:n.fieldListWithSearchRef.current.offsetWidth+e)/(n.dragDropAreaRef.current.offsetWidth-10);if((o=Number(o.toFixed(2)))<.3&&(o=.3),o>.7&&(o=.7),n.fieldListSizePercentage=o,n.fieldListWithSearchRef.current.style.flex="none",n.fieldListWithSearchRef.current.style.width="calc((100% - ".concat(10,"px) *").concat(o,")"),t){var r=(100*o).toString(),l="";l=.3===o?ExcelRibbonStrings.FieldListResizeMinPercentage.replace("{0}",r):.7===o?ExcelRibbonStrings.FieldListResizeMaxPercentage.replace("{0}",r):ExcelRibbonStrings.FieldListResizeCurrentPercentage.replace("{0}",r),n.setState({resizeStatusMessage:l})}}else i.a.sendTraceTag(554297427,a.a.msoulscat_ES_EWAJS,s.a.Error,"DragDropArea.UpdateFieldListWidth: field list or drag drop area ref is null, failed to resize.")},n.onResizeBarKeyDown=function(e){"ArrowLeft"===e.key||"Left"===e.key?n.updateFieldListWidth(-10,!0):"ArrowRight"!==e.key&&"Right"!==e.key||n.updateFieldListWidth(10,!0)},n.onResizeBarMouseDown=function(e){n.resizeBarXPosition=e.clientX},n.onMouseMove=function(e){if(null!=n.resizeBarXPosition){var t=e.clientX-n.resizeBarXPosition;n.resizeBarXPosition=e.clientX,n.updateFieldListWidth(t,!1)}},n.onMouseUp=function(){null!=n.resizeBarXPosition&&(n.resizeBarXPosition=null)},n.dragItemInfo={dragItemSourceAxis:0,dragItem:null},n.events=new Zl.a(n),n.resizeBarXPosition=null,n.resizeObserver=new xc,n.fieldWellAreaHeight=0,n.fieldListSizePercentage=t.fieldListSizePercentage,n.state={filterWellRowsLimit:-1,columnsWellRowsLimit:-1,rowsWellRowsLimit:-1,valuesWellRowsLimit:-1,filtersWellItemsLength:-1,columnsWellItemsLength:-1,rowsWellItemsLength:-1,valuesWellItemsLength:-1,fieldWellsRef:O.createRef(),resizeStatusMessage:""},n}return Object(k.__extends)(t,e),t.prototype.componentWillUnmount=function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("dragover",this.onDocumentDragOver),document.removeEventListener("drop",this.onDocumentDrop),this.resizeObserver&&this.resizeObserver.dispose(),this.dragDropSubscription&&(this.dragDropSubscription.dispose(),delete this.dragDropSubscription),this.events.dispose(),uc.onSaveFieldListSizePercentage(this.fieldListSizePercentage)},t.prototype.componentDidMount=function(){var e=this;if(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("dragover",this.onDocumentDragOver),document.addEventListener("drop",this.onDocumentDrop),this.fieldListRef.current?this.dragDropSubscription=this.dragDropHelper.subscribe(this.fieldListRef.current,this.events,this.getFieldListAreaDragDropOptions()):i.a.sendTraceTag(554297425,a.a.msoulscat_ES_EWAJS,s.a.Error,"DragDropArea.ComponentDidMount: field list ref is null, failed to register drag and drop."),this.fieldListWithSearchRef.current&&(this.fieldListWithSearchRef.current.style.flex="none",this.fieldListWithSearchRef.current.style.width="calc((100% - ".concat(10,"px) *").concat(this.fieldListSizePercentage,")")),null!=this.state.fieldWellsRef.current){if(this.fieldWellAreaHeight=this.state.fieldWellsRef.current.offsetHeight,this.resizeObserver.register([this.state.fieldWellsRef.current],(function(){window.requestAnimationFrame((function(){if(null!=e.state.fieldWellsRef.current){var t=e.state.fieldWellsRef.current.offsetHeight;if(t!==e.fieldWellAreaHeight){e.fieldWellAreaHeight=t;var n=e.props.fieldWellsItems;if(n){var o=ic(e.state.fieldWellsRef,n.filtersWellItems.length,n.columnsWellItems.length,n.rowsWellItems.length,n.valuesWellItems.length);e.setState({filterWellRowsLimit:o[0],columnsWellRowsLimit:o[1],rowsWellRowsLimit:o[2],valuesWellRowsLimit:o[3]})}}}}))})),null!=this.props.fieldWellsItems){var t=this.props.fieldWellsItems.filtersWellItems.length,n=this.props.fieldWellsItems.columnsWellItems.length,o=this.props.fieldWellsItems.rowsWellItems.length,r=this.props.fieldWellsItems.valuesWellItems.length,l=ic(this.state.fieldWellsRef,t,n,o,r);this.setState({filterWellRowsLimit:l[0],columnsWellRowsLimit:l[1],rowsWellRowsLimit:l[2],valuesWellRowsLimit:l[3],filtersWellItemsLength:t,columnsWellItemsLength:n,rowsWellItemsLength:o,valuesWellItemsLength:r})}}else i.a.sendTraceTag(554297426,a.a.msoulscat_ES_EWAJS,s.a.Error,"DragDropArea.ComponentDidMount: field wells ref is null, failed to register resize observer.")},t.getDerivedStateFromProps=function(e,t){var n=e.fieldWellsItems;if(null==n||null==t.fieldWellsRef.current)return null;var o=n.filtersWellItems.length,r=n.columnsWellItems.length,i=n.rowsWellItems.length,a=n.valuesWellItems.length;if(t.filtersWellItemsLength===o&&t.columnsWellItemsLength===r&&t.rowsWellItemsLength===i&&t.valuesWellItemsLength===a)return null;var s=ic(t.fieldWellsRef,o,r,i,a);return{filterWellRowsLimit:s[0],columnsWellRowsLimit:s[1],rowsWellRowsLimit:s[2],valuesWellRowsLimit:s[3],filtersWellItemsLength:o,columnsWellItemsLength:r,rowsWellItemsLength:i,valuesWellItemsLength:a}},t.prototype.render=function(){var e=mc(uc.isV2Enabled),t={setDragItemInfo:this.setDragItemInfo,getDragItemInfo:this.getDragItemInfo},n=this.props,o=n.fieldListItems,r=n.fieldWellsItems;return O.createElement("div",{className:e.root,ref:this.dragDropAreaRef,"data-testid":"DragDropArea"},O.createElement("div",{className:e.fieldListWithSearchArea,ref:this.fieldListWithSearchRef},uc.isV2Enabled?O.createElement(vc,{searchRestoreValue:this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.searchRestoreValue?this.props.fieldListSearchInfo.searchRestoreValue:"",needSearchRestore:!!this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.needSearchRestore,needSearchReset:!!this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.needSearchReset}):null,O.createElement("div",{className:e.fieldListArea,ref:this.fieldListRef},uc.isV2Enabled&&this.props.fieldListSearchInfo&&this.props.fieldListSearchInfo.searchWithNoMatch?O.createElement("div",{id:"fieldListSearchNoMatch",className:e.noMatchArea,"data-testid":"fieldListSearchNoMatch"},ExcelRibbonStrings.FieldListSearchNoMatches):O.createElement(Da.a,{direction:Zt.a.vertical,isCircularNavigation:!0},O.createElement(pc,Object(k.__assign)({items:o,nestingDepth:0,isDataModel:this.props.isDataModel,focusResetId:this.props.fieldListFocusResetId},t,{isRichPivotFieldList:this.props.isRichPivotFieldList}))))),O.createElement("div",{id:"fieldListResizeBar",className:e.resizeBar,"data-testid":"fieldListResizeBar",tabIndex:0,role:"button","aria-label":ExcelRibbonStrings.FieldListResizeAriaLabel,onMouseDown:this.onResizeBarMouseDown,onKeyDown:this.onResizeBarKeyDown}),O.createElement("div",{className:e.fieldWellsArea,ref:this.state.fieldWellsRef},O.createElement(gc,Object(k.__assign)({type:4,title:ExcelRibbonStrings.FieldListFilters,rowsLimitToOverflow:this.state.filterWellRowsLimit,items:r?r.filtersWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t)),O.createElement(gc,Object(k.__assign)({type:1,title:this.props.isPivotChart?ExcelRibbonStrings.FieldListPivotChartRows:ExcelRibbonStrings.FieldListRows,rowsLimitToOverflow:this.state.rowsWellRowsLimit,items:r?r.rowsWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t)),O.createElement(gc,Object(k.__assign)({type:2,title:this.props.isPivotChart?ExcelRibbonStrings.FieldListPivotChartColumns:ExcelRibbonStrings.FieldListColumns,rowsLimitToOverflow:this.state.columnsWellRowsLimit,items:r?r.columnsWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t)),O.createElement(gc,Object(k.__assign)({type:8,title:ExcelRibbonStrings.FieldListValues,rowsLimitToOverflow:this.state.valuesWellRowsLimit,items:r?r.valuesWellItems:null,focusResetId:this.props.fieldWellFocusResetId},t))),O.createElement(Cc.a,{"aria-live":"polite",message:this.state.resizeStatusMessage}))},t.prototype.getFieldListAreaDragDropOptions=function(){return{selectionIndex:0,context:{data:null,index:0},canDrop:this.canFieldListAreaDrop,onDrop:this.onFieldListAreaDrop,updateDropState:this.updateDroppingState}},t}(O.Component),Ec=[{key:1,text:ExcelRibbonStrings.FieldListDisplayActive},{key:0,text:ExcelRibbonStrings.FieldListDisplayAll}],kc=function(e){function t(t){var n=e.call(this,t)||this;return n.onDropDownRenderCaretDown=function(){return O.createElement(H.a,{iconName:W.a.CommonControlChevronDown_12,styles:Ul})},n.onDropdownOptionChanged=function(e,t){t?uc.onSelectedTabChanged(Number(t.key)):i.a.sendTraceTag(554297422,a.a.msoulscat_ES_EWAJS,s.a.Error,"FieldListTaskPane.OnDropdownOptionChanged: selected dropdown option is undefined.")},n.getToolsButtonMenuProps=function(){return{calloutProps:{styles:Gl},items:[{id:"fieldListExpandAll",key:"fieldListExpandAll",text:ExcelRibbonStrings.FieldListExpandAll,disabled:!n.props.isOlap&&!n.state.isRichPivotFieldList,itemProps:{styles:Vl},onClick:n.onExpandAllExecute},{id:"fieldListCollapseAll",key:"fieldListCollapseAll",text:ExcelRibbonStrings.FieldListCollapseAll,disabled:!n.props.isOlap&&!n.state.isRichPivotFieldList,styles:Vl,itemProps:{styles:Vl},onClick:n.onCollapseAllExecute},{key:"fieldListToolsButtonMenuDivider",itemType:Jt.a.Divider},{id:"fieldListSortAscending",key:"fieldListSortAscending",text:ExcelRibbonStrings.FieldListSortAscending,iconProps:n.props.isOlap&&!n.state.isDataModel||!n.state.isSortAscending?void 0:Object(co.a)(ir.a.checkboxCheckmark),disabled:n.props.isOlap&&!n.state.isDataModel,canCheck:!n.props.isOlap||n.state.isDataModel,checked:(!n.props.isOlap||n.state.isDataModel)&&n.state.isSortAscending,itemProps:{styles:Vl},onClick:n.onSortAscendingExecute},{id:"fieldListSortInDataSource",key:"fieldListSortInDataSource",text:ExcelRibbonStrings.FieldListSortInDataSourceOrder,iconProps:n.props.isOlap&&!n.state.isDataModel||n.state.isSortAscending?void 0:Object(co.a)(ir.a.checkboxCheckmark),disabled:n.props.isOlap&&!n.state.isDataModel,canCheck:!n.props.isOlap||n.state.isDataModel,checked:(!n.props.isOlap||n.state.isDataModel)&&!n.state.isSortAscending,itemProps:{styles:Vl},onClick:n.onSortInDataSourceExecute}]}},n.onExpandAllExecute=function(){uc.onExpandCollapseAll(!0)},n.onCollapseAllExecute=function(){uc.onExpandCollapseAll(!1)},n.onSortAscendingExecute=function(){uc.onSortOrderChanged(!0)},n.onSortInDataSourceExecute=function(){uc.onSortOrderChanged(!1)},n.state={fieldListItems:null,fieldWellsItems:null,isDataModel:!1,isSortAscending:!1,selectedTab:-1,isLoadingData:!0,fieldListFocusResetId:-1,fieldWellFocusResetId:-1,isRichPivotFieldList:!1,fieldListSearchInfo:null},uc.updateData(t,Object(Re.h)("PivotTableReactFieldListV2")),n}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e){return 0===e.dataUpdateType?{fieldListItems:e.fieldListItems,isDataModel:e.isDataModel,isSortAscending:e.isSortAscending,selectedTab:e.selectedTab,isLoadingData:!1,fieldListFocusResetId:2===e.focusResetType?e.focusResetId:-1,isRichPivotFieldList:e.isRichPivotFieldList,fieldListSearchInfo:e.fieldListSearchInfo}:1===e.dataUpdateType?{fieldWellsItems:e.fieldWellsItems,isLoadingData:!1,fieldWellFocusResetId:3===e.focusResetType?e.focusResetId:-1}:null},t.prototype.componentDidUpdate=function(e){if(1===this.props.focusResetType&&this.props.focusResetId!==e.focusResetId){var t=this.state.isDataModel?"fieldListAllActiveDropdown":"fieldListToolsButton",n=document.getElementById(t);null==n||n.focus()}},t.prototype.render=function(){var e,t=Ll();return this.state.isLoadingData?O.createElement("div",{id:"fieldListLoadSpinner",className:t.spinnerContainer,"data-testid":"fieldListLoadSpinner"},O.createElement(il.a,{size:al.a.large})):O.createElement("div",{className:t.root},O.createElement("div",{className:t.description},ExcelRibbonStrings.FieldListDragDropAreaDescription),O.createElement("div",{className:t.controlGroup},this.state.isDataModel?O.createElement(qe.a,{id:"fieldListAllActiveDropdown","data-testid":"fieldListAllActiveDropdown",ariaLabel:ExcelRibbonStrings.FieldListDisplayModeAriaLabel,options:Ec,styles:Ml,selectedKey:this.state.selectedTab,onChange:this.onDropdownOptionChanged,onRenderCaretDown:this.onDropDownRenderCaretDown}):null,O.createElement(Z.a,{content:ExcelRibbonStrings.FieldListTools,directionalHint:Y.a.bottomCenter},O.createElement(Ba.a,{id:"fieldListToolsButton","data-testid":"fieldListToolsButton",iconProps:Object(co.a)(W.a.Gear_20),ariaLabel:ExcelRibbonStrings.FieldListTools,menuProps:this.getToolsButtonMenuProps(),menuIconProps:Object(co.a)(W.a.CommonControlChevronDown_12),styles:zl}))),O.createElement(Sc,{fieldListItems:this.state.fieldListItems,fieldWellsItems:this.state.fieldWellsItems,isDataModel:this.state.isDataModel,isPivotChart:this.props.isPivotChart,fieldListSizePercentage:null!==(e=this.props.fieldListSizePercentage)&&void 0!==e?e:.5,fieldListFocusResetId:this.state.fieldListFocusResetId,fieldWellFocusResetId:this.state.fieldWellFocusResetId,isRichPivotFieldList:this.state.isRichPivotFieldList,fieldListSearchInfo:this.state.fieldListSearchInfo}))},t}(O.Component),Oc={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif'},Tc={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',color:"#252423"},Ic={fontSize:"12px",fontWeight:400},wc={paddingTop:"4px",paddingBottom:"4px"},_c={marginTop:0,marginBottom:"4px"},Pc={marginTop:"4px",marginBottom:"24px"},Rc={fontSize:"12px",fontWeight:600,marginBottom:"4px"},Dc={marginTop:"4px",marginBottom:"16px"},jc={marginTop:"16px",marginBottom:"16px"},Bc=Object(Po.c)((function(){return Object(V.db)({firstRoot:[Dc],root:[jc],label:[Rc,wc,Tc]})})),Fc=Object(Po.c)((function(){return Object(V.eb)({marginBottom:"24px"})})),Lc=Object(Po.c)((function(){return Object(V.eb)([Ic,wc,Tc])})),Mc=Object(Po.c)((function(){return Object(V.eb)({height:"100%",paddingLeft:"16px",paddingRight:"16px",overflowY:"auto"})})),Ac=Object(Po.c)((function(e){var t,n,o;return{root:{height:"32px",backgroundColor:"transparent",borderColor:"transparent",padding:0,width:"100%",selectors:(t={},t[V.m]={selectors:{"&[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"}}},t)},rootHovered:{selectors:(n={},n[V.m]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},n)},rootFocused:{selectors:(o={},o[V.m]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},o)},icon:{height:"100%",width:"12px",flexShrink:0},label:[Oc,{fontSize:"14px",fontWeight:e?400:600,marginRight:0}]}})),Nc=Object(Po.c)((function(e){return Object(V.eb)([Pc,{marginLeft:"20px",display:e?"block":"none"}])})),Wc=Object(Po.c)((function(e){return Object(V.eb)([Pc,{width:"250px",marginLeft:"20px",display:e?"block":"none"}])})),Hc=Object(Po.c)((function(){return Object(V.eb)([Ic,Tc,Dc,{paddingTop:0,paddingBottom:0}])})),zc=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isCollapsed:t.collapse},n.onToggleDisplay=n.onToggleDisplay.bind(n),n}return Object(k.__extends)(t,e),t.prototype.componentWillUnmount=function(){this.props.onSaveSectionCollapseState&&this.props.onSaveSectionCollapseState(this.props.type,this.state.isCollapsed)},t.prototype.render=function(){return O.createElement(Nr.b,{type:"AppButtonProps",label:this.props.displayName,id:"sectionHeader_".concat(this.props.divId),onExecute:this.onToggleDisplay,ariaExpanded:!this.state.isCollapsed,styles:Ac(this.state.isCollapsed),icon:this.state.isCollapsed?Object(F.a)()?c.a.CommonControlChevronLeft_12:c.a.CommonControlChevronRight_12:c.a.CommonControlChevronDownGlyph_12})},t.prototype.onToggleDisplay=function(){var e=this.props.divId,t=document.getElementById(e);null!==t&&("none"===window.getComputedStyle(t).display?(t.style.display="block",this.setState({isCollapsed:!1})):(t.style.display="none",this.setState({isCollapsed:!0})))},t}(O.PureComponent),Vc=n(116),Gc=n(96),Uc=Object(Po.c)((function(e){return function(t){var n=t.disabled,o=t.focused,r=t.multiline,i=t.theme,a=Object(Gc.a)(i);return Object(V.db)({root:{selectors:{"input[type=text]":{padding:"0 8px"},"&& label":{cursor:"auto"}}},wrapper:{},fieldGroup:[{backgroundColor:a.inputBackgroundColor,height:24,border:"1px solid ".concat(a.inputBorderColor),borderRadius:2},r&&{height:"auto",minHeight:72},!o&&!n&&{selectors:{":hover":{borderColor:a.textFieldHoverBorderColor}}},o&&{borderColor:a.inputFocusBorderColor},n&&{backgroundColor:a.disabledBackgroundColor,borderColor:a.inputBorderColor}],field:[{fontSize:12,height:16,marginTop:3,padding:"0 8px",color:a.inputTextColor,selectors:{"::selection":{backgroundColor:a.inputSelectionBackgroundColor,color:a.inputSelectionTextColor}}},n&&{color:a.inputTextDisabledColor,selectors:{"::placeholder":{color:a.inputTextDisabledColor,opacity:1},":-ms-input-placeholder":{color:a.inputTextDisabledColor,opacity:1}}}],icon:{},description:{},errorMessage:{},prefix:{},suffix:{},subComponentStyles:{label:{root:[{fontWeight:600,fontSize:12},n&&{color:a.textFieldLabelColor}]}}},e)}})),qc=Object(Vc.a)(),Qc=O.forwardRef((function(e,t){return O.createElement(Ya.a,Object(k.__assign)({},e,{styles:Uc(qc(e.styles)),ref:t}))})),Kc={root:[_c],subComponentStyles:{label:{root:[wc,Tc]}},field:[Oc]},Jc=function(e){function t(t){var n=e.call(this,t)||this;return n.state={value:n.props.value,savedProps:n.props},n.lastCommitValue=n.props.value,n.currentValue=n.props.value,n.onTextChange=n.onTextChange.bind(n),n.onTextBlur=n.onTextBlur.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.commitCurrentValue=n.commitCurrentValue.bind(n),n}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.savedProps!==e?{value:e.value,savedProps:e}:null},t.prototype.componentDidUpdate=function(e){this.props!==e&&(this.lastCommitValue=this.props.value,this.currentValue=this.props.value)},t.prototype.render=function(){var e={role:"textbox",id:this.props.id,value:this.state.value,multiline:this.props.multiline,disabled:this.props.disabled,styles:Kc,onChange:this.onTextChange,onBlur:this.onTextBlur,onKeyDown:this.onKeyDown};return O.createElement(Qc,Object(k.__assign)({type:"AppInputProps",label:this.props.label,hideLabel:this.props.hideLabel},e))},t.prototype.onTextChange=function(e){this.currentValue=e||"",this.setState({value:e||""})},t.prototype.commitCurrentValue=function(){this.currentValue!==this.lastCommitValue&&null!=this.currentValue&&(this.props.onSettingChange?(this.lastCommitValue=this.currentValue,this.props.onSettingChange(this.props.actionType,this.currentValue,0)):this.props.onSettingChangeWithFloatV2?(this.lastCommitValue=this.currentValue,this.props.onSettingChangeWithFloatV2(this.props.actionType,this.currentValue,0,0,null)):this.props.onSettingChangeWithFloat&&(this.lastCommitValue=this.currentValue,this.props.onSettingChangeWithFloat(this.props.actionType,this.currentValue,0,0)))},t.prototype.onTextBlur=function(){this.commitCurrentValue()},t.prototype.onKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),this.commitCurrentValue())},t}(O.PureComponent),Zc=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsAltTextSectionHeader,divId:"altTextSection",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"altTextSection",className:Nc(!this.props.isCollapsed)},O.createElement(Ge.a,{className:Hc()},ExcelRibbonStrings.PivotTableSettingsAltTextSectionDescription),O.createElement(Jc,{id:"altText",label:ExcelRibbonStrings.PivotTableSettingsAltTextTitle,hideLabel:!1,value:this.props.altText,multiline:!1,disabled:!1,actionType:16,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged}),O.createElement(Jc,{id:"altTextSummary",label:ExcelRibbonStrings.PivotTableSettingsAltTextDescription,hideLabel:!1,value:this.props.altTextSummary,multiline:!0,disabled:!1,actionType:17,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})))},t}(O.PureComponent),Yc={root:[_c,{paddingLeft:"3px",paddingRight:"3px",marginRight:"4px"}],rootFocused:{borderColor:"#605E5C"},rootDisabled:{borderColor:"#BEBBB8"},label:[Oc]},Xc=function(e){function t(t){var n=e.call(this,t)||this;return n.onButtonClick=n.onButtonClick.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Nr.b,{type:"AppButtonProps",label:this.props.label,id:this.props.id,styles:Yc,onExecute:this.onButtonClick,disabled:this.props.disabled})},t.prototype.onButtonClick=function(){this.props.onSettingChange&&this.props.onSettingChange(this.props.actionType,"",this.props.valueToSet)},t}(O.PureComponent),$c={root:[_c,{height:"auto",lineHeight:"normal",minHeight:"24px",paddingLeft:0,paddingRight:0}],checkbox:{background:"#FFFFFF"},label:[Oc]},eu=function(e){function t(t){var n=e.call(this,t)||this;return n.onCheckboxChange=n.onCheckboxChange.bind(n),n.onCheckboxExecute=n.onCheckboxExecute.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Xl,{type:"AppCheckboxProps",label:this.props.label,id:this.props.id,styles:$c,checked:this.props.checked,checkmarkIcon:ir.a.checkboxCheckmark,onExecute:this.onCheckboxExecute,disabled:this.props.disabled})},t.prototype.onCheckboxChange=function(e){this.props.onSettingChange?this.props.onSettingChange(this.props.actionType,"",Number(e)):this.props.onSettingChangeWithFloatV2?this.props.onSettingChangeWithFloatV2(this.props.actionType,null,Number(e),0,null):this.props.onSettingChangeWithFloat&&this.props.onSettingChangeWithFloat(this.props.actionType,"",Number(e),0)},t.prototype.onCheckboxExecute=function(e){this.onCheckboxChange(e.checked)},t}(O.PureComponent),tu=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=Bc();return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsGrandSubTotalsSectionHeader,divId:"grandTotalsAndSubtotals",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"grandTotalsAndSubtotals",className:Nc(!this.props.isCollapsed)},O.createElement("div",{className:e.firstRoot},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsGrandTotalsGroupHeader),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsGrandTotalsShowForRows,id:"rwGrandTotalOn",checked:this.props.rwGrandTotalOn,actionType:2,onSettingChange:this.props.onSettingChange,disabled:!1}),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsGrandTotalsShowForColumns,id:"colGrandTotalOn",checked:this.props.colGrandTotalOn,actionType:3,onSettingChange:this.props.onSettingChange,disabled:!1})),O.createElement("div",{className:e.root},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsSubTotalsGroupHeader),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsSubTotalsDoNotShow,id:"subTotalsDoNotShow",actionType:18,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsSubTotalsShowOnTop,id:"subTotalsShowOnTop",actionType:18,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsSubTotalsShowOnBottom,id:"subTotalsShowOnBottom",actionType:18,valueToSet:2,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}))))},t}(O.PureComponent),nu=Object(Po.c)((function(e){return{root:[_c,{height:"auto",display:e?"flex":"block",padding:0,overflow:"auto"}],spinButtonWrapper:{width:e?"80px":"42px",minWidth:e?"80px":"42px",height:"24px",boxSizing:"border-box"},label:[Ic,Tc,{paddingTop:0,paddingBottom:0,lineHeight:"normal"}],labelWrapper:[{height:"auto",minHeight:"24px",width:e?"calc(100% - 80px)":"calc(100% - 46px)"},e?{marginRight:0}:{marginLeft:0}]}})),ou=Object(Po.c)((function(e,t,n,o){return[{unitType:e,unitPlaceholder:"Inch"===e?'{0}"':"{0}",minValue:t,maxValue:n,step:o}]})),ru=Object(Po.c)((function(e){return{negativeSign:"-",numberDecimalDigits:e,numberDecimalSeparator:".",numberNegativePattern:1,numberGroupSeparator:",",numberGroupSizes:[3]}})),iu=n(2201),au=Object(Po.c)((function(e){return Object(V.I)({root:{paddingLeft:0},spinButtonWrapper:{borderRadius:2,marginLeft:0,marginRight:0}},e)})),su=O.forwardRef((function(e,t){var n=Object(iu.a)(Lr.a.Small,au(e.styles));return O.createElement(or.a,Object(k.__assign)({},e,{ref:t,styles:n.spinButtonStyles,buttonStyles:n.buttonStyles}))})),lu=function(e){function t(t){var n=e.call(this,t)||this;return n.onExecuteSpinButton=function(e){if("number"==typeof e.value){var t=n.props.isInteger?Math.round(e.value):n.processFloat(e.value,n.props.precision);n.props.onSettingChange?(n.props.onSettingChange(n.props.actionType,"",t),n.setState({value:e.value})):n.props.onSettingChangeWithFloatV2?(n.props.onSettingChangeWithFloatV2(n.props.actionType,null,n.props.isInteger?t:0,n.props.isInteger?0:t,null),n.setState({value:t})):n.props.onSettingChangeWithFloat&&(n.props.onSettingChangeWithFloat(n.props.actionType,"",n.props.isInteger?t:0,n.props.isInteger?0:t),n.setState({value:t}))}},n.state={value:n.props.value,savedProps:n.props},n}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.savedProps!==e?{value:e.value,savedProps:e}:null},t.prototype.render=function(){return O.createElement(su,{type:"AppSpinButtonProps",id:this.props.id,label:this.props.label,labelPosition:this.props.labelOnLeft?tr.a.start:tr.a.end,validUnits:ou(this.props.unit,this.props.min,this.props.max,this.props.step),incrementButtonIcon:c.a.CommonControlChevronUp_8,incrementAriaLabel:ExcelRibbonStrings.SpinnerIncrementButtonAriaLabel,decrementButtonIcon:c.a.CommonControlChevronDown_8,decrementAriaLabel:ExcelRibbonStrings.SpinnerDecrementButtonAriaLabel,onExecute:this.onExecuteSpinButton,unitType:this.props.unit,value:this.state.value,numberFormatInfo:ru(this.props.precision),disabled:this.props.disabled,styles:nu(this.props.labelOnLeft)})},t.prototype.processFloat=function(e,t){return parseFloat(this.toFixedHelper(e,t))},t.prototype.toFixedHelper=function(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t)},t}(O.PureComponent),cu=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=Bc();return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsLayoutSectionHeader,divId:"layoutSection",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"layoutSection",className:Nc(!this.props.isCollapsed)},O.createElement("div",{className:e.firstRoot},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsLayoutColumnsGroupHeader),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsLayoutColumnsSeparate,id:"compactOff",actionType:19,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsLayoutCompact,id:"compactOn",actionType:19,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),O.createElement(lu,{id:"indentIncrement",value:this.props.indentIncrement,min:0,max:127,step:1,stepPrecision:0,label:ExcelRibbonStrings.PivotTableSettingsLayoutCompactIndent,labelOnLeft:!1,disabled:this.props.hasLessThanTwoRowFields,isInteger:!0,precision:0,unit:"None",actionType:20,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})),O.createElement("div",{className:e.root},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsLayoutItemLabelsGroupHeader),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsLayoutRepeatLabels,id:"repeatLabelOn",actionType:4,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsLayoutDoNotRepeatLabels,id:"repeatLabelOff",actionType:4,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields})),O.createElement("div",{className:e.root},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsLayoutBlankLineGroupHeader),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsLayoutBlankLine,id:"blankLineOn",actionType:5,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),O.createElement(Xc,{label:ExcelRibbonStrings.PivotTableSettingsLayoutNoBlankLine,id:"blankLineOff",actionType:5,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}))))},t}(O.PureComponent),uu=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsRefreshSaveSectionHeader,divId:"refreshAndSave",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"refreshAndSave",className:Nc(!this.props.isCollapsed)},O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsRefreshSaveSourceDataWithFile,id:"saveSourceDataWithFile",checked:this.props.saveSourceDataWithFile,actionType:14,onSettingChange:this.props.onSettingChange,disabled:this.props.disableSaveSourceData}),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsRefreshSaveRefreshOnLoad,id:"refreshOnLoad",checked:this.props.refreshOnLoad,actionType:15,onSettingChange:this.props.onSettingChange,disabled:!1})))},t}(O.PureComponent),du=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=Bc();return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsSortDisplaySectionHeader,divId:"sortAndDisplay",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"sortAndDisplay",className:Nc(!this.props.isCollapsed)},O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayAutoFit,id:"autoFormatOnUpdate",checked:this.props.autoFormatOnUpdate,actionType:6,onSettingChange:this.props.onSettingChange,disabled:!1}),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayShowExpandCollapse,id:"showDrillIndicators",checked:this.props.showDrillIndicators,actionType:7,onSettingChange:this.props.onSettingChange,disabled:!1}),this.props.isNativePivotTable?null:O.createElement("div",{className:e.root},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsSortDisplayItemsWithNoDataGroupHeader),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayItemsWithNoDataShowOnRows,id:"showItemsWithNoDataOnRw",checked:this.props.showItemsWithNoDataOnRw,actionType:8,onSettingChange:this.props.onSettingChange,disabled:!1}),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayItemsWithNoDataShowOnColumns,id:"showItemsWithNoDataOnCol",checked:this.props.showItemsWithNoDataOnCol,actionType:9,onSettingChange:this.props.onSettingChange,disabled:!1})),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayErrorString,id:"displayErrorString",checked:this.props.displayErrorString,actionType:10,onSettingChange:this.props.onSettingChange,disabled:!1}),O.createElement(Jc,{id:"errorString",label:ExcelRibbonStrings.PivotTableSettingsSortDisplayErrorString,hideLabel:!0,value:this.props.errorString,disabled:!this.props.displayErrorString,multiline:!1,actionType:12,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged}),O.createElement(eu,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayNullString,id:"displayNullString",checked:this.props.displayNullString,actionType:11,onSettingChange:this.props.onSettingChange,disabled:!1}),O.createElement(Jc,{id:"nullString",label:ExcelRibbonStrings.PivotTableSettingsSortDisplayNullString,hideLabel:!0,value:this.props.nullString,disabled:!this.props.displayNullString,multiline:!1,actionType:13,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})))},t}(O.PureComponent),pu=n(1412),hu=n(126),gu=n(1410),mu={root:{overflow:"hidden",border:"1px solid #8a8886",borderRadius:"2px",selectors:{".ms-List-cell":{minHeight:"24px",height:"24px",verticalAlign:"middle",alignItems:"middle",textOverflow:"ellipsis"}}}},fu={root:{height:"24px",lineHeight:"normal",verticalAlign:"middle",fontSize:"12px",padding:0,maxWidth:"100%",selectors:{".ms-DetailsHeader-cellName":{fontSize:"12px",height:"16px",verticalAlign:"baseline",alignItems:"baseline",padding:"4px 4px 4px 4px"},".ms-DetailsHeader-cell":{height:"24px"}}}},bu={container:{overflow:"auto",padding:0},cellStyles:{cellExtraRightPadding:0,cellLeftPadding:0,cellRightPadding:0}},vu={key:"connectionCheckbox",name:"",minWidth:22,maxWidth:22,styles:{root:{padding:"0px 2px 0px 2px"}},isResizable:!1,isCollapsable:!1,columnActionsMode:hu.b.disabled},yu={key:"connectionCaption",name:ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsCaptionColumnHeader,minWidth:75,maxWidth:75,isResizable:!0,isCollapsable:!1,columnActionsMode:hu.b.disabled},xu={key:"connectionName",name:ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsNameColumnHeader,minWidth:75,maxWidth:75,isResizable:!0,isCollapsable:!1,columnActionsMode:hu.b.disabled},Cu={key:"connectionSheetName",name:ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader,minWidth:75,maxWidth:75,isResizable:!0,isCollapsable:!1,columnActionsMode:hu.b.disabled},Su={key:"pivotTableName",name:ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsNameColumnHeader,minWidth:112,maxWidth:112,isResizable:!0,isCollapsable:!1,columnActionsMode:hu.b.disabled},Eu={key:"pivotTableSheetName",name:ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader,minWidth:112,maxWidth:112,isResizable:!0,isCollapsable:!1,columnActionsMode:hu.b.disabled},ku=[vu,yu,xu,Cu],Ou=[vu,Su,Eu],Tu={root:{height:"24px",minHeight:"24px",lineHeight:"normal",padding:0,verticalAlign:"middle",selectors:{":hover":{background:"#FFFFFF"}}},cell:{paddingTop:0,paddingBottom:0,height:"24px",minHeight:"24px",verticalAlign:"middle",lineHeight:"normal"}},Iu={root:[_c,{height:"24px",lineHeight:"normal",minHeight:"24px",paddingLeft:2,paddingRight:2}],checkbox:{background:"#FFFFFF"}},wu=Object(Po.c)((function(){return Object(V.eb)([Tc,{textOverflow:"ellipsis",height:"16px",verticalAlign:"middle",lineHeight:"24px",fontSize:"12px",padding:"4px 4px 4px 4px",cursor:"default"}])})),_u=function(e){function t(t){var n=e.call(this,t)||this;return n.connectionRowRef=O.createRef(),n.getRowAriaLabel=function(){return null==n.props.rowProps.item?"":"slicerConnections"===n.props.listType?"".concat(ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsCaptionColumnHeader," ").concat(n.props.rowProps.item.caption,"\n    ").concat(ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsNameColumnHeader," ").concat(n.props.rowProps.item.name," ").concat(ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader," ").concat(n.props.rowProps.item.sheet):"".concat(ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsNameColumnHeader," ").concat(n.props.rowProps.item.name," ").concat(ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsSheetNameColumnHeader," ").concat(n.props.rowProps.item.sheet)},n.onConnectionRowKeyDown=function(e){if(" "===e.key||"Spacebar"===e.key){e.preventDefault();var t=n.props.rowProps.item;if(null==t||null==t.name||"pivotTableConnections"===n.props.listType&&null==t.sheet)return;n.props.onSettingChange?n.props.onSettingChange(21,t.name,Number(!t.enabled)):n.props.onSettingChangeWithFloatV2&&n.props.onSettingChangeWithFloatV2(16,t.name,Number(!t.enabled),0,t.sheet)}},n.onRenderItemColumn=function(e,t,o){if(null==e||null==t||null==o)return null;var r=e.name||"",i=e.caption||"",a=e.sheet||"",s=e.enabled||!1,l=t;switch(null==o?void 0:o.key){case"connectionCheckbox":return O.createElement(Xl,{type:"AppCheckboxProps",label:r,id:"slicerConnections"===n.props.listType?"slicerConnection".concat(l):"pivotTableConnection".concat(l),styles:Iu,checked:s,checkmarkIcon:ir.a.checkboxCheckmark,onExecute:n.onCheckboxExecute});case"connectionName":case"pivotTableName":return O.createElement("span",{className:wu(),title:r},r);case"connectionSheetName":case"pivotTableSheetName":return O.createElement("span",{className:wu(),title:a},a);case"connectionCaption":return O.createElement("span",{className:wu(),title:i},i);default:return null}},n.onCheckboxExecute=function(e){if(null!=n.props.rowProps.item&&null!=n.props.rowProps.item.name&&("pivotTableConnections"!==n.props.listType||null!=n.props.rowProps.item.sheet)){var t=n.props.rowProps.item.name,o=n.props.rowProps.item.sheet;n.props.onSettingChange?n.props.onSettingChange(21,t,Number(e.checked)):n.props.onSettingChangeWithFloatV2&&n.props.onSettingChangeWithFloatV2(16,t,Number(e.checked),0,o)}},n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.rowProps.item&&this.connectionRowRef.current&&this.connectionRowRef.current.firstElementChild&&this.connectionRowRef.current.firstElementChild.setAttribute("aria-selected",this.props.rowProps.item.enabled)},t.prototype.componentDidUpdate=function(){null!=this.props.rowProps.item&&this.connectionRowRef.current&&this.connectionRowRef.current.firstElementChild&&this.connectionRowRef.current.firstElementChild.setAttribute("aria-selected",this.props.rowProps.item.enabled)},t.prototype.render=function(){return O.createElement("div",{ref:this.connectionRowRef,onKeyDown:this.onConnectionRowKeyDown},O.createElement(_i.a,Object(k.__assign)({},this.props.rowProps,{getRowAriaLabel:this.getRowAriaLabel,onRenderItemColumn:this.onRenderItemColumn,styles:Tu})))},t}(O.PureComponent),Pu=function(e){function t(t){var n=e.call(this,t)||this;return n.onRenderDetailsHeader=function(e){var t=e||{};return O.createElement(pu.a,Object(k.__assign)({},t,{styles:fu,layoutMode:hu.e.justified}))},n.onRenderRow=function(e){return e?O.createElement(_u,{rowProps:e,listType:n.props.listType,onSettingChange:n.props.onSettingChange,onSettingChangeWithFloatV2:n.props.onSettingChangeWithFloatV2}):null},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Da.a,{direction:Zt.a.vertical,"data-is-scrollable":"true",style:bu.container},O.createElement(gu.a,{items:this.props.items,columns:this.props.columns,selectionMode:Pi.d.none,onRenderDetailsHeader:this.onRenderDetailsHeader,onRenderRow:this.onRenderRow,cellStyleProps:bu.cellStyles,compact:!0,constrainMode:hu.d.unconstrained,styles:mu,layoutMode:hu.e.justified,checkboxVisibility:hu.a.hidden}))},t}(O.PureComponent),Ru=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.slicerConnections;return!e||e.length<=0?null:O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsSlicerConnectionsSectionHeader,divId:"slicerConnections",paneId:"pivotTableSettings",collapse:this.props.isCollapsed,type:5,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"slicerConnections",className:Wc(!this.props.isCollapsed)},O.createElement(Pu,{items:e,columns:ku,onSettingChange:this.props.onSettingChange,listType:"slicerConnections"})))},t}(O.PureComponent),Du=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t;this.props.needFocusOnFirstElement&&this.props.needFocusOnFirstElement!==e.needFocusOnFirstElement&&(null===(t=document.getElementById("PivotTableName"))||void 0===t||t.focus())},t.prototype.render=function(){return null!=this.props.settingsInfo&&O.createElement("div",{className:Mc()},O.createElement("div",{className:Fc()},O.createElement(Jc,{id:"PivotTableName",label:ExcelRibbonStrings.PivotTableSettingsPivotTableName,hideLabel:!1,value:this.props.settingsInfo.pivotTableName,multiline:!1,disabled:!1,actionType:1,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})),O.createElement(tu,{colGrandTotalOn:this.props.settingsInfo.colGrandTotalOn,rwGrandTotalOn:this.props.settingsInfo.rwGrandTotalOn,onSettingChange:this.props.onSettingChange,hasLessThanTwoRowFields:this.props.hasLessThanTwoRowFields,type:1,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[1],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement(cu,{indentIncrement:this.props.settingsInfo.indentIncrement,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,hasLessThanTwoRowFields:this.props.hasLessThanTwoRowFields,type:2,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[2],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement(du,{autoFormatOnUpdate:this.props.settingsInfo.autoFormatOnUpdate,showDrillIndicators:this.props.settingsInfo.showDrillIndicators,showItemsWithNoDataOnRw:this.props.settingsInfo.showItemsWithNoDataOnRw,showItemsWithNoDataOnCol:this.props.settingsInfo.showItemsWithNoDataOnCol,displayErrorString:this.props.settingsInfo.displayErrorString,displayNullString:this.props.settingsInfo.displayNullString,errorString:this.props.settingsInfo.errorString,nullString:this.props.settingsInfo.nullString,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,isNativePivotTable:this.props.isNativePivotTable,type:4,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[4],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement(uu,{saveSourceDataWithFile:this.props.settingsInfo.saveSourceDataWithFile,refreshOnLoad:this.props.settingsInfo.refreshOnLoad,onSettingChange:this.props.onSettingChange,disableSaveSourceData:!this.props.isNativePivotTable,type:3,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[3],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement(Ru,{slicerConnections:this.props.settingsInfo.slicerConnections,onSettingChange:this.props.onSettingChange,type:5,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[5],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement(Zc,{altText:this.props.settingsInfo.altText,altTextSummary:this.props.settingsInfo.altTextSummary,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,type:0,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[0],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}))},t}(O.Component),ju=O.createContext({}),Bu=O.createContext((function(e){}));function Fu(e){var t=e.children,n=O.useState({}),o=n[0],r=n[1];return O.createElement(ju.Provider,{value:o},O.createElement(Bu.Provider,{value:function(e){r(e)}},t))}var Lu={height:"100%",display:"contents"},Mu={root:{padding:"0px 16px 0px 10px"},label:{paddingTop:"6px",fontWeight:"600",width:"100%",height:"32px"}},Au=function(){return Object(V.eb)({display:"flex",height:"70%",justifyContent:"center",alignItems:"center"})},Nu=function(e){var t,n;return{root:{margin:"6px 8px 6px 7px",background:null===(t=e.semanticColors)||void 0===t?void 0:t.inputBackground,justifyContent:"center",alignItems:"center",selectors:{"::after":{borderColor:null===(n=e.semanticColors)||void 0===n?void 0:n.inputBorder}}}}},Wu=Object(Po.c)((function(e,t,n){var o,r,i;return{root:{marginTop:"3px",marginRight:"8px",marginLeft:"8px"},expand:{},title:!n&&{width:"100%",padding:0,selectors:(o={},o.span={display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"".concat(220-16*t,"px")},o)},groupHeaderContainer:{height:"auto",selectors:(r={},r[":hover"]=[{backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.listItemBackgroundHovered}],r)},headerCount:{whiteSpace:"nowrap",overflow:"visible"}}})),Hu=function(e){return Object(Po.c)((function(t){var n,o,r,i,a;return{root:{width:"100%"},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(n=e.semanticColors)||void 0===n?void 0:n.focusBorder:null===(o=e.semanticColors)||void 0===o?void 0:o.inputBorder,boxSizing:"border-box",borderRadius:V.e.roundedCorner2,height:"24px",color:null===(r=e.semanticColors)||void 0===r?void 0:r.inputText,backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.inputBackground},field:{lineHeight:"16px"},errorMessage:{color:null===(a=e.semanticColors)||void 0===a?void 0:a.errorText}}}))},zu={childrenGap:2,margin:"0px 6px"},Vu=function(e,t,n,o){return o?Object(V.I)(Gu(e,t,n),qu(e)):Gu(e,t,n)},Gu=function(e,t,n){var o,r,i,a,s,l,c,u=Object(yt.isChangeGateEnabled)("OfficeVSO:8279522_FixQueryHoverHighlight")?null===(i=e.semanticColors)||void 0===i?void 0:i.listItemBackgroundCheckedHovered:null===(a=e.semanticColors)||void 0===a?void 0:a.listItemBackgroundHovered;return{root:{height:"".concat(n?115:85,"px"),padding:"0px 0px 2px 16px",margin:"0px 8px 3px 8px",boxShadow:"none",background:"none",paddingLeft:"".concat(16*(t+1),"px"),maxWidth:"inherit",selectors:(o={},o[":hover"]=[{backgroundColor:u},Ds.o],o[":focus"]={selectors:(r={},r[":focus"]=[{backgroundColor:null===(s=e.semanticColors)||void 0===s?void 0:s.listItemBackgroundChecked},Ds.o],r[":focus:hover"]=[{backgroundColor:null===(l=e.semanticColors)||void 0===l?void 0:l.listItemBackgroundCheckedHovered},Ds.o],r[":active"]=[{backgroundColor:null===(c=e.semanticColors)||void 0===c?void 0:c.listItemBackgroundChecked},Ds.o],r)},o)}}},Uu=Object(Po.c)((function(){return{root:{flex:1,minWidth:0,marginLeft:"2px"}}})),qu=function(e){var t;return{root:{border:"none",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listItemBackgroundChecked,commonHighContrastHoverFocusStyles:Ds.o}}};function Qu(e){var t,n,o,r;return{root:{backgroundColor:"transparent",padding:"1px",border:0,borderColor:"transparent",color:null===(t=null==e?void 0:e.semanticColors)||void 0===t?void 0:t.buttonText},rootDisabled:{backgroundColor:"transparent",padding:"1px",border:0,borderColor:"transparent",color:null===(n=null==e?void 0:e.semanticColors)||void 0===n?void 0:n.buttonText},rootHovered:{backgroundColor:null===(o=null==e?void 0:e.semanticColors)||void 0===o?void 0:o.buttonBackgroundHovered,padding:"1px",border:0,borderColor:"transparent"},rootPressed:{backgroundColor:null===(r=null==e?void 0:e.semanticColors)||void 0===r?void 0:r.buttonBackgroundHovered,padding:"1px",border:0,borderColor:"transparent"}}}var Ku=Object(Po.c)((function(e,t,n){var o,r,i;return{root:[{float:"left",padding:"0",width:"97%",minWidth:"0",flex:"1"}],label:[t&&{height:"26px",whiteSpace:"nowrap",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",padding:"3px 0px 2px 0px",position:"relative",color:null===(r=e.semanticColors)||void 0===r?void 0:r.listText},!t&&{whiteSpace:"nowrap",fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",marginTop:"0px",marginLeft:"7px",padding:"0px 0px 0px 0px",color:null===(i=e.semanticColors)||void 0===i?void 0:i.listText},{selectors:(o={},o[V.m]={color:n?"HighlightText":"inherit"},o)}]}})),Ju={paddingTop:"2px",height:"20px",width:"22px"},Zu={width:20,height:20,alignItems:"center",paddingRight:0,paddingLeft:"5px"},Yu=function(e){return Object(Po.c)((function(t){var n,o,r,i,a;return{root:{width:"100%"},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(n=e.semanticColors)||void 0===n?void 0:n.focusBorder:null===(o=e.semanticColors)||void 0===o?void 0:o.inputBorder,boxSizing:"border-box",borderRadius:V.e.roundedCorner2,height:"24px",color:null===(r=e.semanticColors)||void 0===r?void 0:r.inputText,backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.inputBackground},field:{lineHeight:"16px"},errorMessage:{color:null===(a=e.semanticColors)||void 0===a?void 0:a.errorText}}}))},Xu={marginTop:"6px"},$u=function(e){function t(t){var n=e.call(this,t)||this;return n.getErrorString=function(e){switch(e){case 3:return ExcelPowerqueryTaskpaneStrings.DownloadFailed;case 4:return ExcelPowerqueryTaskpaneStrings.DownloadDidNotComplete;case 1:return ExcelPowerqueryTaskpaneStrings.LoadToWorksheetFailed;case 2:return ExcelPowerqueryTaskpaneStrings.LoadToDataModelFailed;default:return i.a.sendTraceTag(574374984,a.a.msoulscat_ES_EWAJS,s.a.Error,"QueryErrorComponent: Unknown query error"),""}},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement("div",{"data-testid":"QueryErrorComponent"},O.createElement(Bo.a,null,(function(t){return O.createElement(jo.a,{type:"AppLabelProps",id:"QueryError-"+e.props.id,forId:"QueryError-"+e.props.id,label:e.getErrorString(e.props.query.queryError),styles:Ku(t,!1,e.props.isCardHovered),iconProps:{iconName:W.a.AlertWarning_20,style:Zu}})})))},t}(O.Component),ed=n(1978),td=n(1947),nd=O.createContext({onQuerySelected:function(){},onQueryRefresh:function(){},handleQueryGroupOperation:function(){},onCancelQueryRefresh:function(){},onLegacyConnectionRefresh:function(){},onLegacyConnectionCancelRefresh:function(){},onLegacyConnectionDelete:function(){},onCancelKeyboardReorder:function(){},onSetQueryProperties:function(){}});function od(){return O.useContext(nd)}var rd,id=nd.Provider;!function(e){e[e.Home=0]="Home",e[e.GroupProperties=1]="GroupProperties",e[e.QueryProperties=2]="QueryProperties",e[e.MoveToGroup=3]="MoveToGroup"}(rd||(rd={}));var ad=O.createContext({type:rd.Home}),sd=O.createContext((function(e){}));function ld(){return O.useContext(sd)}function cd(e){var t=e.children,n=O.useState({type:rd.Home}),o=n[0],r=n[1];return O.createElement(ad.Provider,{value:o},O.createElement(sd.Provider,{value:function(e){r(e)}},t))}function ud(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,r,i,a;return Object(k.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,7,,8]),e="",[4,navigator.clipboard.read()];case 1:t=s.sent(),n=0,o=t,s.label=2;case 2:return n<o.length?(r=o[n]).types.includes("text/html")?[4,r.getType("text/html")]:[3,5]:[3,6];case 3:return[4,s.sent().text()];case 4:if((i=s.sent()).includes("microsoft-mashup-format"))return e=i,[3,6];s.label=5;case 5:return n++,[3,2];case 6:return[2,new Promise((function(t,n){t(e)}))];case 7:return a=s.sent(),[2,new Promise((function(e,t){t(a)}))];case 8:return[2]}}))}))}var dd=n(2495);function pd(e){var t,n=(t=e,new dd.XMLParser({attributeNamePrefix:"",ignoreNameSpace:!0,ignoreAttributes:!1,parseAttributeValue:!0,isArray:function(e,t,n,o){return"Query"===e||"QueryGroup"===e}}).parse(t).Mashup);return n&&n.Items&&(n.Items.Query||n.Items.QueryGroup)?function e(t,n){var o,r,i={queryGroups:[],queries:[]};if(t.Query&&t.Query.length>0)for(var a=0,s=t.Query;a<s.length;a++){var l=s[a],c=gd(l.Name,l.Description,l.FillObjectType,l.LoadToDataModel,l.Formula,n);i.queries.push(c)}if(t.QueryGroup&&t.QueryGroup.length>0)for(var u=0,d=t.QueryGroup;u<d.length;u++){var p=d[u],h=hd(p.Name,p.Description,n);i.queryGroups.push(h);var g=e(p.Items,h.key),m=g.queryGroups,f=g.queries;(o=i.queryGroups).push.apply(o,m),(r=i.queries).push.apply(r,f)}return i}(n.Items,bd):{queryGroups:[],queries:[]}}function hd(e,t,n){return{key:"{"+ct()+"}",count:0,startIndex:0,level:0,order:0,isDeleting:!1,parentKey:n,name:e,data:t}}function gd(e,t,n,o,r,i){return{name:e,description:t,rowsLoaded:0,fillObjectType:md(n),loadedToDataModel:o,queryError:0,nestingDepth:0,groupKey:i,rowsWithError:0,inRefresh:!1,refreshEnabled:!1,currentRunningOperation:-1,formula:r}}function md(e){switch(e){case"Table":return 0;case"ConnectionOnly":return 1;case"PivotTable":return 2;case"PivotChart":return 3;default:return i.a.sendTraceTag(508121953,a.a.msoulscat_ES_EWAJS,s.a.Error,"MAshupXMLParser.getFillObjectTypeFromString: Unknown fill object type"),-1}}var fd,bd="{00000000-0000-0000-0000-000000000000}",vd=Object(L.f)(),yd=/<div class="microsoft-mashup-format">(.*?)<\/div>/s;!function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(fd||(fd={}));var xd=function(e){return!e.loadedToDataModel&&1!==e.fillObjectType&&e.refreshEnabled&&!e.inRefresh},Cd=function(e,t,n){if(t){if(e&&e.toLocaleLowerCase()===t.toLocaleLowerCase())return;if(n&&e&&t!==e&&-1!==n.findIndex((function(e){return e.toLocaleLowerCase()===t.trim().toLocaleLowerCase()})))return ExcelPowerqueryTaskpaneStrings.QueryNameAlreadyExistsErrorMessage.replace("{0}",t.trim());if(t.length>80)return ExcelPowerqueryTaskpaneStrings.QueryNameTooLongErrorMessage.replace("{0}",80..toString());if(function(e){for(var t=['"',"."],n=0;n<=31;++n)t.push(String.fromCharCode(n));for(n=127;n<=159;++n)t.push(String.fromCharCode(n));return e.split("").some((function(e){return-1!==t.indexOf(e)}))}(t))return ExcelPowerqueryTaskpaneStrings.QueryNameWithInvalidCharactersErrorMessage}if(!t.trim())return ExcelPowerqueryTaskpaneStrings.QueryNameEmptyErrorMessage},Sd=function(e,t,n){if(e){if(n&&n.toLocaleLowerCase()===e.toLocaleLowerCase())return;if(e.includes("\\"))return ExcelPowerqueryTaskpaneStrings.GroupNameContainsBackslashErrorMessage;if(t&&e!==n&&-1!==t.findIndex((function(t){return t.toLocaleLowerCase()===e.trim().toLocaleLowerCase()})))return ExcelPowerqueryTaskpaneStrings.GroupNameConflictsErrorMessage.replace("{0}",e.trim())}if(!e||!e.trim())return ExcelPowerqueryTaskpaneStrings.EmptyGroupNameErrorMessage},Ed=Object(Po.c)((function(e,t,n){for(var o=n?kd:Od,r=[],i=Td(e),a=function(){var e=i.pop();return n&&e.key===t?"continue":(i.push.apply(i,e.children.map((function(t){return t.name=e.name+"\\"+t.name,t}))),o(e,t)?void r.push(e):"continue")};(null==i?void 0:i.length)>0;)a();return r.sort((function(e,t){var n,o;return"Other Queries"===e.key?1:"Other Queries"===t.key?-1:(null===(n=e.name)||void 0===n?void 0:n.split("\\").pop())>(null===(o=t.name)||void 0===o?void 0:o.split("\\").pop())?1:-1}))})),kd=function(e,t){var n,o;return e.key!==t&&"Other Queries"!==e.key&&!(null===(n=e.key)||void 0===n?void 0:n.startsWith("SubGroupOtherQueries-"))&&!(-1!==(null===(o=e.children)||void 0===o?void 0:o.findIndex((function(e){return e.key===t}))))},Od=function(e,t){var n,o=(null===(n=e.key)||void 0===n?void 0:n.startsWith("SubGroupOtherQueries-"))||e.key===t,r=""===t&&"Other Queries"===e.key,i=t===e.key;return!o&&!r&&!i},Td=function(e){if(!e)return null;var t=[];return e.forEach((function(e){var n=Object(k.__assign)({},e);e&&(n.children=Td(e.children)),t.push(n)})),t},Id=function(e){return vd&&e.metaKey||!vd&&e.ctrlKey},wd=function(e,t,n){var o,r,i,a,s,l=""===e?"Other Queries":e;for(l.startsWith("SubGroupOtherQueries-")&&(l=e.replace("SubGroupOtherQueries-",""));t.length>0;)for(var c=null!==(o=t.shift())&&void 0!==o?o:[],u=0;u<c.length;u++){var d=c[u];if(d&&d.key===l){var p=void 0;switch(n){case fd.Up:u-1>=0&&(p=null===(r=c[u-1])||void 0===r?void 0:r.key);break;case fd.Down:u+1<c.length&&(p=null===(i=c[u+1])||void 0===i?void 0:i.key);break;case fd.Left:p=d.parentKey;break;case fd.Right:d.children&&d.children.length>0&&(p=null===(a=d.children[0])||void 0===a?void 0:a.key)}if(!p||p.startsWith("SubGroupOtherQueries-")||p===bd)return;return p="Other Queries"===p?"":p}t.push(null!==(s=d.children)&&void 0!==s?s:[])}},_d=function(e,t,n,o,r,i){var a,s,l,c;return{type:"AppButtonProps",label:e,id:t+Date(),icon:o,onExecute:n,disabled:r,styles:{root:{selectors:(a={},a[":focus"]=[{backgroundColor:null===(s=null==i?void 0:i.semanticColors)||void 0===s?void 0:s.listItemBackgroundHovered}],a[":active"]=[{backgroundColor:null===(l=null==i?void 0:i.semanticColors)||void 0===l?void 0:l.listItemBackgroundHovered}],a[":hover"]=[{backgroundColor:null===(c=null==i?void 0:i.semanticColors)||void 0===c?void 0:c.listItemBackgroundHovered}],a)}}}},Pd=function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:e=!1,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,ud()];case 2:return t=o.sent(),e=""!==t,[3,4];case 3:return n=o.sent(),i.a.sendTraceTag(508130653,a.a.msoulscat_ES_EWAJS,s.a.Error,"clipboardContainsMashupFormat failed: "+n),[3,4];case 4:return[2,e]}}))}))},Rd=function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o;return Object(k.__generator)(this,(function(r){switch(r.label){case 0:e={queryGroups:[],queries:[]},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ud()];case 2:if(0===(t=r.sent()).trim().length)throw new Error("getClipboardMashupQueriesAndGroups failed: Empty mashup clipboard data");if(!(n=t.match(yd))||n.length<2)throw new Error("getClipboardMashupQueriesAndGroups failed: Failed to regex parse of internal clipboard data");return e=pd(n[1].replace(/&([a-z]+|#\d+);/gi,(function(e,t){if(t.startsWith("#")){var n=t.startsWith("#x")?parseInt(t.substr(2),16):parseInt(t.substr(1),10);return String.fromCharCode(n)}return{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"}[t]||e}))),[3,4];case 3:return o=r.sent(),i.a.sendTraceTag(507872211,a.a.msoulscat_ES_EWAJS,s.a.Error,"clipboardContainsMashupFormat failed: "+o),[3,4];case 4:return[2,e]}}))}))},Dd={borderRadius:"0px",buttonBorderLine:"1px",margin:"0px",isCancelButtonFirst:!1},jd=O.createContext(Dd),Bd=function(){var e=Object(O.useContext)(jd).borderRadius;return{root:{borderRadius:e,height:"22px",selectors:{div:{height:"22px"}}},rootDisabled:{borderRadius:e,height:"22px",selectors:{div:{height:"22px"}}},rootHovered:{borderRadius:e,height:"22px",selectors:{div:{height:"22px"}}},rootPressed:{borderRadius:e,height:"22px",selectors:{div:{height:"22px"}}},icon:{height:"22px",width:"20px"},iconHovered:{height:"22px",width:"20px"},iconPressed:{height:"22px",width:"20px"},iconExpanded:{height:"22px",width:"20px"},label:{lineHeight:"inherit"}}},Fd=function(e){e.styles;var t=Object(k.__rest)(e,["styles"]);return O.createElement(Nr.b,Object(k.__assign)({},t,{styles:Object(V.I)(e.styles,Bd())}))},Ld=n(1456),Md=n(1063),Ad=n(1064),Nd=n(158),Wd=n(1380),Hd=n(2701),zd=Object(Nd.a)((function(e,t,n,o){return{key:e,data:t,onRender:function(e,t){return O.createElement("span",{key:e.key},Object(Hd.a)(e.data,Object(Wd.a)(t),Number(e["aria-posinset"]),Number(e["aria-setsize"]),n,o))},customOnRenderListLength:Object(Pr.e)(t)}})),Vd=Object(Po.c)((function(e,t,n){return function(o){var r=o.controlProps,i=o.subComponentStyles,a=o.location,s=o.arePerfImprovementsEnabled,l=o.onMenuItemExecuted,c=o.onSubMenuPositioned,u=o.terminalParentControlId,d=o.useFullDescriptionLabelOnly;return r.filter((function(e){return Object(Pr.e)(e)>0})).map((function(o){var r=Object(k.__assign)(Object(k.__assign)({},Object(Pr.a)(o,l)),{keytipProps:void 0,location:a,appStrings:t,terminalParentControlId:u}),p=r.id;switch(r.type){case"AppButtonProps":return(n?zs.b:zs.a)(Object(Hs.a)(r.id,r.location),r,i,void 0,void 0,d);case"AppToggleButtonProps":return Object(Ld.a)(r,i,void 0,d);case"AppFlyoutAnchorProps":return(s?Md.b:Md.a)(Object(Hs.a)(r.id,r.location),r,Vd(e,t),e,c,i,i,s,l,d);case"AppSplitButtonProps":return(s?Ad.b:Ad.a)(Object(Hs.a)(r.id,r.location),r,Vd(e,t),e,c,i,i,s,l);case"AppFontStylesFullGalleryProps":return zd(p,r,Vd(e,t,!0),e);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppCharacterCodeGalleryProps":case"AppCompoundButtonProps":case"RibbonChangeColorsFullGalleryProps":return zd(p,r);default:throw new Error("The control of type ".concat(r.type," is not valid in a Floatie menu"))}}))}})),Gd=function(e){function t(t){var n=e.call(this,t)||this;return n.controlInMenuRendererFunction=Vd(ir.a,Object(Dr.a)()),n.onMenuShowHide=function(e){n.props.onMenuShowHide&&n.props.onMenuShowHide(e)},n.controlInMenuRendererFunction.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&this.props.isAADDocumentHost&&this.props.getRefreshOrCancelButton;return O.createElement(Bo.a,null,(function(n){var o,r,i,a;return O.createElement(Qe.a,{horizontal:!0},t&&e.props.getRefreshOrCancelButton(),e.props.shouldRenderOtherOptions&&O.createElement($r,{id:"PowerQueryTaskPaneEllipsesFlyoutId-"+e.props.id,label:ExcelPowerqueryTaskpaneStrings.OverflowWellLabel,type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHint:Y.a.bottomRightEdge,icon:c.a.HintBarEllipses_20,menuDefinition:e.props.menuDefinition,menuClassNames:e.props.menuClassNames,styles:Object(V.I)({rootHovered:{backgroundColor:null===(o=n.semanticColors)||void 0===o?void 0:o.buttonBackgroundHovered},rootExpanded:{backgroundColor:null===(r=n.semanticColors)||void 0===r?void 0:r.buttonBackgroundHovered},rootExpandedHovered:{backgroundColor:null===(i=n.semanticColors)||void 0===i?void 0:i.buttonBackgroundHovered},rootPressed:{backgroundColor:null===(a=n.semanticColors)||void 0===a?void 0:a.buttonBackgroundHovered}},e.props.styles),controlInMenuRendererFunction:e.controlInMenuRendererFunction,onAfterMenuDismiss:function(){e.onMenuShowHide(!1)},onExecute:function(){e.onMenuShowHide(!0)},directionalHintFixed:!1}))}))},t.contextType=nd,t}(O.Component),Ud=function(e){var t=O.useContext(jd),n=t.borderRadius,o=t.margin,r=Bd();function i(e){return e.sections.forEach((function(e){e.controls.forEach((function(e){var t=Object(V.I)(e.styles,r);e.styles=t}))})),e}e.styles;var a=e.menuDefinition,s=(e.menuClassNames,Object(k.__rest)(e,["styles","menuDefinition","menuClassNames"]));return O.createElement(Bo.a,null,(function(t){var l,c,u;return O.createElement(Gd,Object(k.__assign)({},s,{menuDefinition:i(a),styles:Object(V.I)(e.styles,r),menuClassNames:{subComponentStyles:{callout:{root:{selectors:{".ms-FocusZone":{margin:o}}},calloutMain:{borderRadius:n&&"0px"!==n?n:V.e.roundedCorner2,color:null===(l=t.semanticColors)||void 0===l?void 0:l.menuItemText,background:null===(c=t.semanticColors)||void 0===c?void 0:c.menuBackground,selectors:{"& button:hover":{backgroundColor:null===(u=t.semanticColors)||void 0===u?void 0:u.menuItemBackgroundHovered},"& button:disabled":{backgroundColor:"transparent"}}}},menuItem:{}}}}))}))},qd=function(e){e.styles;var t=e.partialTheme,n=Object(k.__rest)(e,["styles","partialTheme"]),o=function(e){var t,n,o=Object(O.useContext)(jd),r=o.borderRadius,i=o.buttonBorderLine;return{root:{borderRadius:r,selectors:(t={},t[":focus"]=[{border:"".concat(i," solid ").concat(null===(n=e.semanticColors)||void 0===n?void 0:n.focusBorder),outline:0}],t)}}}(t);return O.createElement(Qe.a,Object(k.__assign)({},n,{styles:Object(V.I)(e.styles,o)}))},Qd=function(e){function t(t){var n=e.call(this,t)||this;return n.nameInput=O.createRef(),n.menuShown=!1,n.isDeleteEnabled=!1,n.isRenameEnabled=!1,n.isEditQueryEnabled=!1,n.paneLayoutUpdate=function(e){},n.fillObjectTypeToString=function(e){switch(e){case 1:return ExcelPowerqueryTaskpaneStrings.LoadedToConnectionOnly;case 0:return ExcelPowerqueryTaskpaneStrings.LoadedToTable;case 2:return ExcelPowerqueryTaskpaneStrings.LoadedToPivotTable;case 3:return ExcelPowerqueryTaskpaneStrings.LoadedToPivotChart;default:return i.a.sendTraceTag(573191066,a.a.msoulscat_ES_EWAJS,s.a.Error,"QueryProperties: Unknown fill object type"),""}},n.onHover=function(){n.menuShown||n.setState({isHovered:!0})},n.onNotHover=function(){n.menuShown||n.setState({isHovered:!1})},n.onFocus=function(){n.menuShown||n.setState({isFocused:!0})},n.onBlur=function(){n.menuShown||n.setState({isFocused:!1})},n.onCardClick=function(e){n.props.onQuerySelected(n.props.query),n.props.focusSelected&&n.props.focusSelected(n.state.isFocused)},n.onInputClick=function(e){null==e||e.stopPropagation()},n.onCardSectionKeyDown=function(e){n.state.isRenaming||n.state.ContextMenuSectionFocused||!e||e.keyCode!==z.a.enter&&e.which!==z.a.space||(n.props.onQuerySelected(n.props.query),n.props.focusSelected&&n.props.focusSelected(n.state.isFocused),e.preventDefault())},n.getErrorCountString=function(){return!n.props.query.rowsWithError||n.props.query.rowsWithError<=0?"":n.props.query.rowsWithError>1?ExcelPowerqueryTaskpaneStrings.ErrorsCount.replace("{0}",n.props.query.rowsWithError.toString()):ExcelPowerqueryTaskpaneStrings.OneError},n.getRowsLoadedLine=function(){var e=n.props.query.rowsLoaded>1?ExcelPowerqueryTaskpaneStrings.QueryRowsLoaded.replace("{0}",(new Intl.NumberFormat).format(n.props.query.rowsLoaded)):ExcelPowerqueryTaskpaneStrings.QueryRowLoaded;return n.props.query.rowsWithError&&n.props.query.rowsWithError>0?"".concat(e," ").concat(n.getErrorCountString()):e},n.getLoadedToRow=function(e){return e?n.props.query.loadedToDataModel?ExcelPowerqueryTaskpaneStrings.LoadedTo.replace("{0}",ExcelPowerqueryTaskpaneStrings.DataModel):n.fillObjectTypeToString(n.props.query.fillObjectType):n.props.query.loadedToDataModel?ExcelPowerqueryTaskpaneStrings.LoadedToDataModel.replace("{0}",n.fillObjectTypeToString(n.props.query.fillObjectType)):ExcelPowerqueryTaskpaneStrings.LoadedTo.replace("{0}",n.fillObjectTypeToString(n.props.query.fillObjectType))},n.onRenderTitle=function(e,t){return e?n.state.isRenaming?O.createElement("div",{onClick:n.onInputClick},O.createElement(Ya.a,{ref:n.nameInput,id:"QueryNameInput",type:"AppInputProps",defaultValue:n.props.query.name,autoComplete:"off",styles:Yu(e),onChange:n.onQueryNameChange,errorMessage:n.state.errorMessage,executeOnEnter:!0,executeOnBlur:!0,onExecute:n.onQueryRename(t),onKeyDown:n.onAppInputKeyDown})):O.createElement(jo.a,{type:"AppLabelProps",id:"QueryName-"+n.props.id,forId:"QueryName-"+n.props.id,label:n.props.query.name,styles:Ku(e,!0,n.state.isHovered),customTooltip:n.props.query.name}):null},n.onQueryNameChange=function(e){var t,o;n.setState({errorMessage:Cd(n.props.query.name,e,null!==(o=null===(t=n.props.queries)||void 0===t?void 0:t.map((function(e){return e.name})))&&void 0!==o?o:[])})},n.setRenameStart=function(){n.menuShown=!1,n.props.onRenameStartedOrEnd(n.props.query.name),n.setState({isRenaming:!0})},n.setRenameEnd=function(){n.props.onRenameStartedOrEnd(""),n.setState({isRenaming:!1,errorMessage:void 0,isFocused:!1,isHovered:!1})},n.onAppInputKeyDown=function(e){var t;e.which===z.a.escape&&(null===(t=n.nameInput.current)||void 0===t||t.resetState(),n.setRenameEnd(),e.stopPropagation(),e.preventDefault())},n.onRenderQueryDetails=function(e,t){var o=[];return n.isDeleting()?o.push(n.onRenderQueryDeleting()):(o.push(n.onRenderQueryRowsLoaded(e,t)),o.push(n.onRenderQueryLastRefreshed()),o.push(n.onRenderQueryLoadedTo(t))),o},n.onRenderQueryDeleting=function(){return O.createElement(Bo.a,null,(function(e){return O.createElement(jo.a,{type:"AppLabelProps",id:"QueryDeleting-"+n.props.id,forId:"QueryDeleting-"+n.props.id,label:ExcelPowerqueryTaskpaneStrings.QueryDeleting,styles:Ku(e,!1,n.state.isHovered)})}))},n.onRenderQueryLoadedTo=function(e){return O.createElement(Bo.a,null,(function(t){return O.createElement(jo.a,{type:"AppLabelProps",id:"QueryLoadedTo-"+n.props.id,forId:"QueryLoadedTo-"+n.props.id,label:n.getLoadedToRow(e),styles:Ku(t,!1,n.state.isHovered)})}))},n.onRenderQueryLastRefreshed=function(){return O.createElement(Bo.a,null,(function(e){return O.createElement(jo.a,{type:"AppLabelProps",id:"QueryLastRefreshed-"+n.props.id,forId:"QueryLastRefreshed-"+n.props.id,label:ExcelPowerqueryTaskpaneStrings.QueryLastRefreshed.replace("{0}",new Date(n.props.query.lastRefresh).toLocaleString()),styles:Ku(e,!1,n.state.isHovered)})}))},n.onRenderQueryRowsLoaded=function(e,t){return e?O.createElement($u,{query:n.props.query,id:n.props.id,isCardHovered:n.state.isHovered}):(!t||n.props.query.loadedToDataModel)&&O.createElement(Bo.a,null,(function(e){return O.createElement("div",{"data-testid":"QueryRowsLoaded"},O.createElement(jo.a,{type:"AppLabelProps",id:"QueryRowsLoaded-"+n.props.id,forId:"QueryRowsLoaded-"+n.props.id,label:n.getRowsLoadedLine(),styles:Ku(e,!1,n.state.isHovered)}))}))},n.isConnectionOnly=function(){return 1===n.props.query.fillObjectType},n.isDeletingEnabled=function(){return Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryTaskPaneDeleteQuery",!1)&&n.props.isPowerQueryEditEnabled&&n.props.isAADDocumentHost},n.isDeleting=function(){return n.isDeleteEnabled&&1===n.props.query.currentRunningOperation},n.isRenamingEnabled=function(){return Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryTaskPaneRenameQuery",!1)&&n.props.isPowerQueryEditEnabled&&n.props.isAADDocumentHost},n.isEditingQueryEnabled=function(){return Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryImport",!1)&&n.props.isPowerQueryEditEnabled&&n.props.isAADDocumentHost},n.isContextMenuShown=function(e){return(Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&n.props.isAADDocumentHost||n.props.isPowerQueryEditEnabled)&&(n.state.isFocused||n.state.isHovered||n.menuShown)&&!e&&!n.isDeleting()},n.shouldDisableRefreshButton=function(){return!Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")||!n.props.isAADDocumentHost||n.props.query.loadedToDataModel||1===n.props.query.fillObjectType||!n.props.query.refreshEnabled||n.props.query.inRefresh||n.isOperationRunning()},n.setContextMenuSectionFocused=function(e){n.setState({ContextMenuSectionFocused:e})},n.onMenuShowHide=function(e){return Object(k.__awaiter)(n,void 0,void 0,(function(){var t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return this.menuShown=e,Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryCopyPaste")?[4,Pd()]:[3,2];case 1:return(t=n.sent())&&!this.state.isPasteEnabled?this.setState({isPasteEnabled:!0,isFocused:!1,isHovered:!1}):!t&&this.state.isPasteEnabled&&this.setState({isPasteEnabled:!1,isFocused:!1,isHovered:!1}),[3,3];case 2:this.setState({isFocused:!1,isHovered:!1}),n.label=3;case 3:return[2]}}))}))},n.onRefresh=function(){n.props.onQueryRefresh(n.props.query.name)},n.onCancelRefresh=function(e){e.onCancelQueryRefresh(n.props.query.name)},n.switchTaskPaneLayout=function(e){var t;switch(e){case rd.MoveToGroup:n.paneLayoutUpdate({type:e,groupOperationPayload:{id:null===(t=n.props.query.groupKey)||void 0===t?void 0:t.replace("SubGroupOtherQueries-",""),name:n.props.query.name},isGroupMoving:!1});break;case rd.QueryProperties:n.paneLayoutUpdate({type:e,queryOperationPayload:{id:n.props.query.name,name:n.props.query.name,description:n.props.query.description},queryPropertiesPayload:{lastRefresh:n.props.query.lastRefresh,propertiesControls:n.props.query.propertiesControls}});break;default:i.a.debugAssertTag(508699338,a.a.msoulscat_ES_EWAJS,!1,"Unexpected PowerQueryTaskPaneType: ".concat(e))}},n.getQueryActionCallback=function(e,t,n){return function(){e.handleQueryAction(t,{name:n})}},n.getRefreshOrCancelButton=function(e,t){return n.props.query.inRefresh&&Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")?O.createElement(Fd,Object(k.__assign)({},_d(ExcelPowerqueryTaskpaneStrings.Cancel,"ExternalCancelRefreshButton-"+n.props.id,(function(){return n.onCancelRefresh(e)}),ir.a.closeIcon,!1,t),{hideLabel:!0,styles:Qu(t)})):O.createElement(Fd,Object(k.__assign)({},_d(ExcelPowerqueryTaskpaneStrings.Refresh,"ExternalRefreshButton-"+n.props.id,n.onRefresh,W.a.RefreshConnection_20,n.shouldDisableRefreshButton(),t),{hideLabel:!0,styles:Qu(t)}))},n.isOperationRunning=function(){return Object(yt.isChangeGateEnabled)("OfficeVSO:7739992_AddingCurrentRunningOperation")&&void 0!==n.props.query.currentRunningOperation&&-1!==n.props.query.currentRunningOperation},n.isDuplicateQueryEnabled=function(){return!(0!==n.props.query.fillObjectType&&1!==n.props.query.fillObjectType||n.props.query.loadedToDataModel||n.isOperationRunning())},n.shouldDisableActionButton=function(e){switch(e){case 0:case 3:return n.isOperationRunning();case 4:return!n.isDuplicateQueryEnabled();case 1:case 2:case 5:return n.props.query.inRefresh||n.isOperationRunning()||n.props.query.loadedToDataModel||n.props.isDocumentStructureLocked;default:return!0}},n.shouldDisabledEditQuery=function(){return n.isOperationRunning()||n.props.query.loadedToDataModel||n.props.isDocumentStructureLocked},n.isQueryEditingEnabled=function(){return n.isRenameEnabled||n.isDeleteEnabled||n.isEditQueryEnabled},n.getCopyPasteSection=function(e,t){var o={controls:[]};return o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.PasteOption,"Paste-"+n.props.id,(function(){return Object(k.__awaiter)(n,void 0,void 0,(function(){var t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return[4,Rd()];case 1:return t=n.sent(),e.onPowerQueryPaste(this.props.query.groupKey,t.queries,t.queryGroups),[2]}}))}))}),W.a.Paste_24,!n.state.isPasteEnabled,t)),o},n.getEditQuerySection=function(e,t){var o={controls:[]};return n.isEditQueryEnabled&&o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.EditQueryOption,"QueryEditButton-"+n.props.id,(function(){return e.onEditQuery(n.props.query.name)}),W.a.EditQuery_20,n.shouldDisabledEditQuery(),t)),n.isDeleteEnabled&&o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.DeleteQueryOption,"QueryDeleteButton-"+n.props.id,n.getQueryActionCallback(e,1,n.props.query.name),W.a.Delete_20,n.shouldDisableActionButton(1),t)),n.isRenameEnabled&&o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.RenameQueryOption,"QueryRenameButton-"+n.props.id,n.setRenameStart,d.a.RenameColumn_32,n.shouldDisableActionButton(2),t)),o},n.getRefreshQuerySection=function(e){var t={controls:[]};return t.controls.push(_d(ExcelPowerqueryTaskpaneStrings.Refresh,"QueryRefreshButton-"+n.props.id,n.onRefresh,W.a.RefreshConnection_20,n.shouldDisableRefreshButton(),e)),t},n.getOtherCommandSection=function(e,t){var o={controls:[]};return Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryTaskPaneDuplicateQuery",!1)&&o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.DuplicateQueryOption,"QueryDuplicateButton-"+n.props.id,n.getQueryActionCallback(e,4,n.props.query.name),W.a.Duplicate_24,n.shouldDisableActionButton(4),t)),n.props.shouldShowMoveQueryButton&&n.props.isPowerQueryEditEnabled&&o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.MoveQueryToGroupOption,"QueryMoveToGroupButton-"+n.props.id,(function(){return n.switchTaskPaneLayout(rd.MoveToGroup)}),void 0,n.shouldDisableActionButton(0),t)),Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties")&&o.controls.push(_d(ExcelPowerqueryTaskpaneStrings.PropertiesOption,"QueryPropertiesButton-"+n.props.id,(function(){return n.switchTaskPaneLayout(rd.QueryProperties)}),W.a.Info_20,n.shouldDisableActionButton(5))),o},n.getMenuDefinition=function(e,t){var o={sections:[{controls:[]}]};return Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryCopyPaste")&&n.props.isPowerQueryEditEnabled&&o.sections.push(n.getCopyPasteSection(e,t)),n.isQueryEditingEnabled()&&o.sections.push(n.getEditQuerySection(e,t)),o.sections.push(n.getRefreshQuerySection(t)),o.sections.push(n.getOtherCommandSection(e,t)),o},n.getContextMenu=function(e,t){return O.createElement(Ud,{id:"Query-"+n.props.id.toString(),onMenuShowHide:n.onMenuShowHide,getRefreshOrCancelButton:function(){return n.getRefreshOrCancelButton(e,t)},menuDefinition:n.getMenuDefinition(e,t),shouldRenderOtherOptions:!0,isAADDocumentHost:n.props.isAADDocumentHost})},n.getFocusZone=function(e,t){return O.createElement(Da.a,{onFocus:function(){return n.setContextMenuSectionFocused(!0)},onBlur:function(){return n.setContextMenuSectionFocused(!1)}},n.getContextMenu(e,t))},n.state={isHovered:!1,isFocused:!1,ContextMenuSectionFocused:!1,isRenaming:!1,errorMessage:void 0,isPasteEnabled:!1},n.isDeleteEnabled=n.isDeletingEnabled(),n.isRenameEnabled=n.isRenamingEnabled(),n.isEditQueryEnabled=n.isEditingQueryEnabled(),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.selected&&this.props.focusSelected&&this.props.focusSelected(this.state.isFocused)},t.prototype.componentDidUpdate=function(e){var t,n,o,r;this.props.queries!==e.queries&&this.state.isRenaming&&this.setState({errorMessage:Cd(e.query.name,null===(t=this.nameInput.current)||void 0===t?void 0:t.value,null!==(o=null===(n=this.props.queries)||void 0===n?void 0:n.map((function(e){return e.name})))&&void 0!==o?o:[])}),this.state.isRenaming&&(null===(r=this.nameInput.current)||void 0===r||r.focus())},t.prototype.onQueryRename=function(e){var t=this.state.errorMessage,n=this.props.query.name,o=this.setRenameEnd;return function(r){var i=null==r?void 0:r.trim();!t&&i&&i!==n&&e.handleQueryAction(2,{name:n,extraData:i}),o()}},t.prototype.render=function(){var e=this;this.paneLayoutUpdate=this.context.bind(this);var t=0!==this.props.query.queryError,n=this.isConnectionOnly(),o=this.state.isRenaming,r=this.isContextMenuShown(o);return O.createElement(Bo.a,null,(function(o){return O.createElement(nd.Consumer,null,(function(i){return O.createElement("div",{ref:e.props.forwardRef,"data-testid":"QueryContainer"},O.createElement(qd,{"data-testid":"PowerQueryContainerId",id:"PowerQueryContainerId-"+e.props.id,horizontal:!1,tokens:zu,styles:Vu(o,e.props.nestingDepth,void 0!==e.state.errorMessage,e.props.selected),"data-is-focusable":!0,onFocus:e.onFocus,onBlur:e.onBlur,onMouseOver:e.onHover,onMouseLeave:e.onNotHover,onClick:e.onCardClick,onKeyDown:e.onCardSectionKeyDown,partialTheme:o},O.createElement(Qe.a,{horizontal:!0},O.createElement(Qe.a,null,e.props.query.inRefresh?O.createElement(ed.a,{type:"AppSpinnerProps",id:"QueryRefreshSpinner"+e.props.id,appColors:Object(f.a)(),spinnerSize:al.a.medium}):O.createElement(H.a,{style:Ju,iconName:W.a.Table_20})),O.createElement(Qe.a,{horizontal:!1,styles:Uu},O.createElement(Qe.a,{horizontal:!0},O.createElement(td.a,null,e.onRenderTitle(o,i),r&&e.getFocusZone(i,o))),O.createElement(Qe.a,{horizontal:!1},e.onRenderQueryDetails(t,n))))))}))}))},t.contextType=nd,t}(O.Component);Qd.contextType=sd;var Kd=n(1486),Jd=n(150),Zd=n(2259),Yd=function(){var e,t=Object(O.useContext)(jd).borderRadius;return{root:{borderRadius:t},expand:{borderRadius:t},groupHeaderContainer:{selectors:(e={},e[":hover"]=[{borderRadius:t}],e)}}},Xd=Object(Vc.a)(),$d=O.createRef(),ep=function(e){function t(t){var n,o=this;return(o=e.call(this,t)||this).menuShown=!1,o.onMenuShowHide=function(e){return Object(k.__awaiter)(o,void 0,void 0,(function(){var t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return this.menuShown=e,Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryCopyPaste")?[4,Pd()]:[3,2];case 1:return(t=n.sent())&&!this.state.isPasteEnabled?this.setState({isPasteEnabled:!0,isFocused:!1,isHovered:!1}):!t&&this.state.isPasteEnabled&&this.setState({isPasteEnabled:!1,isFocused:!1,isHovered:!1}),[3,3];case 2:this.setState({isFocused:!1,isHovered:!1}),n.label=3;case 3:return[2]}}))}))},o.getGroupOperationPayload=function(){var e,t,n,r=null===(e=o.props.groupDividerProps)||void 0===e?void 0:e.group;return{id:null===(n=null===(t=o.props.groupDividerProps)||void 0===t?void 0:t.group)||void 0===n?void 0:n.key,name:null==r?void 0:r.name,description:null==r?void 0:r.data}},o.getMovingGroupOperationSection=function(e,t){var n,r,i,a,s,l,c,u,p,h,g,m,f,b=o.getGroupOperationPayload(),v=null===(n=o.props.groupDividerProps)||void 0===n?void 0:n.group,y={controls:[]},x=y.controls;return 0!==(null==v?void 0:v.count)&&(null==v?void 0:v.children)&&x.push(_d(ExcelPowerqueryTaskpaneStrings.UngroupOption,"UngroupGroupButton-"+(null===(i=null===(r=o.props.groupDividerProps)||void 0===r?void 0:r.group)||void 0===i?void 0:i.key),o.getGroupOperationFunction(1,b),void 0,o.props.isDocumentStructureLocked,t)),!Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryDeleteQueryGroup",!1)&&0!==(null==v?void 0:v.count)&&(null==v?void 0:v.children)||x.push(_d(ExcelPowerqueryTaskpaneStrings.DeleteGroupOption,"DeleteGroupButoon-"+(null===(s=null===(a=o.props.groupDividerProps)||void 0===a?void 0:a.group)||void 0===s?void 0:s.key),o.getGroupOperationFunction(2,b),W.a.Delete_20,o.props.isDocumentStructureLocked,t)),x.push(_d(ExcelPowerqueryTaskpaneStrings.RenameGroupOption,"RenameGroupButton-"+(null===(c=null===(l=o.props.groupDividerProps)||void 0===l?void 0:l.group)||void 0===c?void 0:c.key),o.setRenameStart,d.a.RenameColumn_32,o.props.isDocumentStructureLocked,t)),x.push(_d(ExcelPowerqueryTaskpaneStrings.MoveQueryToGroupOption,"MoveToGroupButton-"+(null===(p=null===(u=o.props.groupDividerProps)||void 0===u?void 0:u.group)||void 0===p?void 0:p.key),(function(){e({type:rd.MoveToGroup,groupOperation:4,groupOperationPayload:b,isGroupMoving:!0})}),void 0,o.props.isDocumentStructureLocked,t)),x.push(_d(ExcelPowerqueryTaskpaneStrings.MoveToTopLevelOption,"MoveToTopLevelButton-"+(null===(g=null===(h=o.props.groupDividerProps)||void 0===h?void 0:h.group)||void 0===g?void 0:g.key),(function(){b.parentId=null,o.props.handleGroupOperation(4,b)}),void 0,0===(null==v?void 0:v.level)||o.props.isDocumentStructureLocked,t)),x.push(_d(ExcelPowerqueryTaskpaneStrings.PropertiesOption,"SetPropertiesButton-"+(null===(f=null===(m=o.props.groupDividerProps)||void 0===m?void 0:m.group)||void 0===f?void 0:f.key),(function(){var t,n,r;e({type:rd.GroupProperties,groupOperation:5,groupOperationPayload:b,groupSiblingsNames:null!==(r=null===(n=null===(t=o.props.groupDividerProps)||void 0===t?void 0:t.groups)||void 0===n?void 0:n.map((function(e){return e.name})))&&void 0!==r?r:[]})}),W.a.Info_20,o.props.isDocumentStructureLocked,t)),y},o.getMenuDefinition=function(e,t,n){var r,i,a,s,l,c,u={sections:[]};if(Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryCopyPaste")&&o.props.isPowerQueryEditEnabled){var d=[];d.push(_d(ExcelPowerqueryTaskpaneStrings.PasteOption,"Paste-"+(null===(i=null===(r=o.props.groupDividerProps)||void 0===r?void 0:r.group)||void 0===i?void 0:i.key),(function(){return Object(k.__awaiter)(o,void 0,void 0,(function(){var t,n,o;return Object(k.__generator)(this,(function(r){switch(r.label){case 0:return[4,Rd()];case 1:return t=r.sent(),null==e||e.onPowerQueryPaste(null===(o=null===(n=this.props.groupDividerProps)||void 0===n?void 0:n.group)||void 0===o?void 0:o.key,t.queries,t.queryGroups),[2]}}))}))}),W.a.Paste_24,!o.state.isPasteEnabled,n)),u.sections.push({controls:d})}var p=[];return p.push(_d(ExcelPowerqueryTaskpaneStrings.Refresh,"RefreshGroupButton-"+(null===(s=null===(a=o.props.groupDividerProps)||void 0===a?void 0:a.group)||void 0===s?void 0:s.key),(function(){o.onRefreshAll(e.onQueryRefresh)}),W.a.RefreshConnection_20,o.shouldDisableRefreshButton(),n)),u.sections.push({controls:p}),o.props.isPowerQueryEditEnabled&&"Other Queries"!==(null===(c=null===(l=o.props.groupDividerProps)||void 0===l?void 0:l.group)||void 0===c?void 0:c.key)&&u.sections.push(o.getMovingGroupOperationSection(t,n)),u},o.getGroupOperationFunction=function(e,t){return function(){o.props.handleGroupOperation(e,t)}},o.getContextMenu=function(e,t,n){var r,i;return O.createElement(Ud,{id:"Group-"+(null===(i=null===(r=o.props.groupDividerProps)||void 0===r?void 0:r.group)||void 0===i?void 0:i.key),onMenuShowHide:o.onMenuShowHide,menuDefinition:o.getMenuDefinition(e,t,n),shouldRenderOtherOptions:!0,isAADDocumentHost:o.props.isAADDocumentHost})},o.onHover=function(e){return function(){o.menuShown||o.setState({isHovered:e})}},o.onFocus=function(e){return function(){o.menuShown||o.setState({isFocused:e})}},o.onRenderTitle=function(e,t){if(!e)return null;var n=t,r=n.group,i=n.ariaColSpan;if(!r)return null;var a=r.count;if(r.children&&r.children.length>0){a=r.children.length;var s=r.children.find((function(e){return e.name.includes("SubGroupOtherQueries-")}));s&&(a--,a+=s.count)}else a=r.count;var l=Xd(t.styles,{theme:t.theme,className:t.className,selected:t.isSelected,isCollapsed:t.group.isCollapsed,compact:t.compact});if(o.state.isRenaming)return O.createElement(Ya.a,{ref:$d,id:"GroupNameInput",type:"AppInputProps",defaultValue:r.name,autoComplete:"off",styles:Hu(e),onChange:o.onGroupNameChange,errorMessage:o.state.errorMessage,executeOnEnter:!0,executeOnBlur:!0,onExecute:o.onGroupRename,onKeyDown:o.onAppInputKeyDown});var c=(Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&o.props.isAADDocumentHost||o.props.isPowerQueryEditEnabled)&&(o.state.isFocused||o.state.isHovered||o.menuShown)&&!o.state.isRenaming;return O.createElement(Qe.a,{grow:1,horizontal:!0,verticalAlign:"center"},O.createElement("div",{className:l.title,role:"gridcell","aria-colspan":i},O.createElement("span",null,r.name),0!==r.count&&O.createElement("span",{className:l.headerCount},"(",a,")")),c&&O.createElement(nd.Consumer,null,(function(t){return O.createElement(sd.Consumer,null,(function(n){return o.getContextMenu(t,n,e)}))})))},o.onGroupNameChange=function(e){var t,n,r,i,a;o.setState({errorMessage:Sd(e,null!==(r=null===(n=null===(t=o.props.groupDividerProps)||void 0===t?void 0:t.groups)||void 0===n?void 0:n.map((function(e){return e.name})))&&void 0!==r?r:[],null===(a=null===(i=o.props.groupDividerProps)||void 0===i?void 0:i.group)||void 0===a?void 0:a.name)})},o.onGroupRename=function(e){var t,n;!o.state.errorMessage&&e&&o.props.handleGroupOperation(3,{id:null===(n=null===(t=o.props.groupDividerProps)||void 0===t?void 0:t.group)||void 0===n?void 0:n.key,name:e}),o.setRenameEnd()},o.setRenameStart=function(){o.menuShown=!1,o.setState({isRenaming:!0})},o.setRenameEnd=function(){o.setState({isRenaming:!1,errorMessage:void 0,isFocused:!1,isHovered:!1})},o.onRefreshAll=function(e){var t,n,r,i,a=null===(n=null===(t=o.props.groupDividerProps)||void 0===t?void 0:t.group)||void 0===n?void 0:n.startIndex,s=a+(null===(i=null===(r=o.props.groupDividerProps)||void 0===r?void 0:r.group)||void 0===i?void 0:i.count);o.props.queries.slice(a,s).forEach((function(t){xd(t)&&e(null==t?void 0:t.name)}))},o.shouldDisableRefreshButton=function(){var e,t,n,r;if(!Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")||!o.props.isAADDocumentHost)return!0;var i=null===(t=null===(e=o.props.groupDividerProps)||void 0===e?void 0:e.group)||void 0===t?void 0:t.startIndex,a=i+(null===(r=null===(n=o.props.groupDividerProps)||void 0===n?void 0:n.group)||void 0===r?void 0:r.count);return!o.props.queries.slice(i,a).some((function(e){return xd(e)}))},o.onAppInputKeyDown=function(e){var t;e.which===z.a.escape&&(null===(t=$d.current)||void 0===t||t.resetState(),o.setRenameEnd(),e.stopPropagation(),e.preventDefault())},o.state={isHovered:!1,isFocused:!1,isRenaming:!1,errorMessage:void 0,isPasteEnabled:!1},o.setRenameStart=o.setRenameStart.bind(o),o.onRenderTitle=o.onRenderTitle.bind(o),o.onGroupRename=o.onGroupRename.bind(o),null===(n=o.props.defaultRender)||void 0===n||n.bind(o),o}return Object(k.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t,n,o,r,i,a,s,l,c;(null===(t=this.props.groupDividerProps)||void 0===t?void 0:t.groups)!==(null===(n=e.groupDividerProps)||void 0===n?void 0:n.groups)&&this.state.isRenaming&&this.setState({errorMessage:Sd(null===(o=$d.current)||void 0===o?void 0:o.value,null!==(a=null===(i=null===(r=this.props.groupDividerProps)||void 0===r?void 0:r.groups)||void 0===i?void 0:i.map((function(e){return e.name})))&&void 0!==a?a:[],null===(l=null===(s=this.props.groupDividerProps)||void 0===s?void 0:s.group)||void 0===l?void 0:l.name)}),this.state.isRenaming&&(null===(c=$d.current)||void 0===c||c.focus())},t.prototype.render=function(){var e,t,n,o,r,i,a,s,l=this,c=0!==(null===(t=null===(e=this.props.groupDividerProps)||void 0===e?void 0:e.group)||void 0===t?void 0:t.count)||!!(null===(o=null===(n=this.props.groupDividerProps)||void 0===n?void 0:n.group)||void 0===o?void 0:o.children)&&(null===(i=null===(r=this.props.groupDividerProps)||void 0===r?void 0:r.group)||void 0===i?void 0:i.children.length)>0;return O.createElement(Qe.a,{grow:1,horizontal:!0,verticalAlign:"center",onMouseOver:this.onHover(!0),onMouseLeave:this.onHover(!1),onFocus:this.onFocus(!0),onBlur:this.onFocus(!1),id:(null===(s=null===(a=this.props.groupDividerProps)||void 0===a?void 0:a.group)||void 0===s?void 0:s.key)+"GroupHeader"},O.createElement(Qe.a.Item,{grow:1},O.createElement(Bo.a,null,(function(e){var t,n,o;return O.createElement(Zd.a,{tooltipLabel:null===(n=null===(t=l.props.groupDividerProps)||void 0===t?void 0:t.group)||void 0===n?void 0:n.data,tooltipId:"GroupHeaderToolTip",tooltipDirection:Y.a.bottomCenter,updateTooltipsHidden:l.context.updateTooltipsHidden,setTooltipElement:l.context.setTooltipElement},l.props.defaultRender(Object(k.__assign)(Object(k.__assign)({},l.props.groupDividerProps),{expandButtonProps:{style:{visibility:c?"unset":"hidden"}},selectionMode:Pi.d.none,indentWidth:16,styles:Object(V.db)(Wu(e,null===(o=l.props.groupDividerProps)||void 0===o?void 0:o.groupLevel,!!l.state.isRenaming),Yd()),onRenderTitle:function(t){return l.onRenderTitle(e,t)}})))}))))},t}(O.Component);ep.contextType=Jd.a;var tp,np=n(928),op=n(411);!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(tp||(tp={}));var rp,ip=void 0;!function(e){e[e.UxppRuntime=0]="UxppRuntime",e[e.PowerOptions=1]="PowerOptions",e[e.PowerQuery=2]="PowerQuery",e[e.DataCleansing=3]="DataCleansing"}(rp||(rp={}));var ap="Office".concat(".","Uxpp");function sp(){return"Office".concat(".").concat(null!=ip?ip:"None")}function lp(){return"".concat(sp()).concat(".","Client")}function cp(e){return"".concat(lp()).concat(".").concat(rp[e])}var up=n(216),dp="abcdefghijklmnopqrstuvwxyz0123456789";function pp(e){return Object(up.d)("Tag",function(e){return e<=65535?e.toString():e>>24>=36?(e>>24&255).toString()+(e>>16&255).toString()+(e>>8&255).toString()+(255&e).toString():dp[e>>24&63]+dp[e>>18&63]+dp[e>>12&63]+dp[e>>6&63]+dp[63&e]}(e))}function hp(e){return function(e,t){var n=gp(e,t);if(isNaN(Number(n)))return 0;return Number(n)}(e,"Hidden.Tag")}function gp(e,t){var n,o=null===(n=e.dataFields)||void 0===n?void 0:n.filter((function(e){return e.name===t}));if(null==o?void 0:o.length)return o[0].value}function mp(e){!function(e){e.dataFields=fp(e,"Hidden.Tag")}(e),function(e){e.dataFields=fp(e,"Hidden.Log.Level")}(e)}function fp(e,t){var n;return null===(n=e.dataFields)||void 0===n?void 0:n.filter((function(e){return e.name!==t}))}var bp=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){try{var t=function(e){return"Error"===gp(e,"Hidden.Log.Level")?s.a.Error:s.a.Info}(e),n=hp(e);mp(e),i.a.sendTraceTag(n,a.a.msoulscat_ES_EWAJS,t,JSON.stringify(e))}catch(t){Object(op.b)(0,1,(function(){return"UlsTraceSink caught an error for event name '".concat(e.eventName,"': (timestamp=").concat(Date.now(),") ").concat(JSON.stringify(t))}))}},e}(),vp="";(yp=new np.a).addSink(new bp),yp.setTenantToken(sp(),vp),Object(op.c)().addListener((function(e){i.a.sendTraceTag(508864163,a.a.msoulscat_ES_EWAJS,Cp(e.level),e.message())}));var yp,xp=new(function(){function e(){}return e.prototype.log=function(e,t){this.sendTelemetryEvent(e,t,"Info")},e.prototype.error=function(e,t){this.sendTelemetryEvent(e,t,"Error")},e.prototype.sendTelemetryEvent=function(e,t,n){var o;i.a.shipAssertTag(508864192,a.a.msoulscat_ES_EWAJS,void 0===ip||t.eventName.startsWith(lp())||t.eventName.startsWith(ap)||t.eventName.startsWith(sp()),"Telemetry event '".concat(t.eventName,"' with tag '").concat(e,"' will be dropped in Desktop's UXPP because its name is not prefixed by the namespace '").concat(sp(),"' as configured by setTenantToken")),null!==(o=t.dataFields)&&void 0!==o||(t.dataFields=[]),t.dataFields.push(function(e){return Object(up.b)("Hidden.Tag",e)}(e),pp(e),function(e){return Object(up.d)("Hidden.Log.Level",e)}(n)),yp.sendTelemetryEvent(t)},e}());function Cp(e){switch(e){case 0:return s.a.Error;case 2:return s.a.Info;case 3:return s.a.Verbose;case 1:return s.a.Warning}}function Sp(e,t,n){return{dataCategories:e,diagnosticLevel:t,samplingPolicy:n,costPriority:tp.CostPriority.Normal,persistencePriority:tp.PersistencePriority.Normal}}var Ep,kp=void 0,Op="query",Tp="group",Ip=function(e){function t(t){var o=e.call(this,t)||this;return o.list=O.createRef(),o.selectedQuery=O.createRef(),o.focusZone=O.createRef(),o.async=new Ia.a,o.paneData=null,o.paneDataUpdate=function(e){},o.dragAndDropEnabled=o.props.isPowerQueryEditEnabled,o.isFirstRender=!1,o.isKeyboardDragging=!1,o.onShouldVirtualize=function(){return!o.dragAndDropEnabled||!o.isFirstRender},o.filterGroups=function(e){return null==e||e.forEach((function(e){return e.children=e.children&&0!==e.children.length?o.filterGroups(e.children):e.children})),null==e?void 0:e.filter((function(e){return 0!==e.count}))},o.moveQuery=function(e,t,n){var r,i,a,s,l,c,u,d,p,h,g,m,f,b=void 0;(null===(r=o.paneData)||void 0===r?void 0:r.draggedQueryName)||(b=o.props.queries.findIndex((function(t){return t.name===e})));var v=(null===(i=o.props.queries)||void 0===i?void 0:i.find((function(e){return e.name===t}))).groupKey;if(v.startsWith("SubGroupOtherQueries-")&&(v=v.replace("SubGroupOtherQueries-","")),n){if((null===(a=o.paneData)||void 0===a?void 0:a.draggedQueryName)===(null===(s=o.paneData)||void 0===s?void 0:s.hoveredQueryName)&&(null===(l=o.paneData)||void 0===l?void 0:l.groupKey)){var y={name:e,extraData:o.paneData.groupKey};o.props.callbacks.handleQueryAction(0,y)}else(null===(c=o.paneData)||void 0===c?void 0:c.draggedQueryName)!==(null===(u=o.paneData)||void 0===u?void 0:u.hoveredQueryName)&&o.shouldCallReorderAction()&&o.props.callbacks.handleQueryAction(3,{name:null===(d=o.paneData)||void 0===d?void 0:d.draggedQueryName,extraData:null===(p=o.paneData)||void 0===p?void 0:p.hoveredQueryName});o.paneDataUpdate({draggedQueryName:void 0,groupKey:void 0,hoveredQueryName:void 0,searchValue:null===(h=o.paneData)||void 0===h?void 0:h.searchValue,draggedInitialIndex:o.isKeyboardDragging?null===(g=o.paneData)||void 0===g?void 0:g.draggedInitialIndex:b})}else o.paneDataUpdate({draggedQueryName:e,groupKey:v,hoveredQueryName:t,searchValue:null===(m=o.paneData)||void 0===m?void 0:m.searchValue,draggedInitialIndex:o.isKeyboardDragging?null===(f=o.paneData)||void 0===f?void 0:f.draggedInitialIndex:b})},o.shouldCallReorderAction=function(){var e;return o.props.queries.findIndex((function(e){var t;return e.name===(null===(t=o.paneData)||void 0===t?void 0:t.draggedQueryName)}))!==(null===(e=o.paneData)||void 0===e?void 0:e.draggedInitialIndex)},o.moveQueryToGroup=function(e,t,n){var r,i=t;if(t.startsWith("SubGroupOtherQueries-")&&(i=t.replace("SubGroupOtherQueries-","")),n){var a={name:e,extraData:t};return o.props.callbacks.handleQueryAction(0,a),void o.onClearDragDropPreview()}o.paneDataUpdate({draggedQueryName:e,groupKey:i,hoveredQueryName:void 0,searchValue:null===(r=o.paneData)||void 0===r?void 0:r.searchValue})},o.onClearDragDropPreview=function(){var e;o.paneDataUpdate({draggedQueryName:void 0,groupKey:void 0,hoveredQueryName:void 0,searchValue:null===(e=o.paneData)||void 0===e?void 0:e.searchValue})},o.onRenderListItem=function(e,t,n){if(void 0!==t)return o.dragAndDropEnabled&&Ep?O.createElement(O.Suspense,{fallback:function(){return xp.error(508924352,{eventName:cp(rp.PowerQuery),dataFields:[Object(up.a)("ReactDND.Query.Fallback",!0)],eventFlags:Sp(tp.DataCategories.ProductServiceUsage,tp.DiagnosticLevel.RequiredServiceData,tp.SamplingPolicy.CriticalBusinessImpact)}),o.getQueryContainerElement(t,n)}},O.createElement(Ep,{id:t.name,type:Op,index:void 0!==n?n:0,moveQueryCallback:o.async.debounce(o.moveQuery,5),draggable:t.name!==o.state.renamingQueryKey,onClearDragDropPreview:o.onClearDragDropPreview},o.getQueryContainerElement(t,n))):o.getQueryContainerElement(t,n)},o.onRenameStartedOrEndForQuery=function(e){var t;o.setState({renamingQueryKey:e}),null===(t=o.list.current)||void 0===t||t.forceUpdate()},o.getQueryContainer=function(e,t,n){var r=o.props.groups&&0!==o.props.groups.length,i=e?{forwardRef:o.selectedQuery,focusSelected:o.focusSelectedElementOnUpdate}:{};return O.createElement(Qd,Object(k.__assign)({query:t,id:void 0!==n?n+1:0,nestingDepth:t.nestingDepth,onQueryRefresh:o.props.onQueryRefresh,onQuerySelected:o.setQuerySelected,selected:e,shouldShowMoveQueryButton:r,queries:o.props.queries,onRenameStartedOrEnd:o.onRenameStartedOrEndForQuery},i,{isAADDocumentHost:o.props.isAADDocumentHost,isPowerQueryEditEnabled:o.props.isPowerQueryEditEnabled,isDocumentStructureLocked:o.props.isDocumentStructureLocked}))},o.getQueryContainerElement=function(e,t){var n,r=ExcelPowerqueryTaskpaneStrings.QueryAriaLabel.replace("{0}",(t+1).toString()).replace("{1}",o.props.queries.length.toString()),i=o.selection.isKeySelected(e.name);return O.createElement("div",{"aria-label":r,style:{opacity:o.isKeyboardDragging&&(null===(n=o.paneData)||void 0===n?void 0:n.draggedQueryName)===e.name?"0.4":"unset"},onKeyDown:function(e){i&&o.onQueryKeydown(e)}},o.getQueryContainer(i,e,t))},o.focusSelectedElementOnUpdate=function(e){var t;(o.isKeyboardDragging||e)&&(null===(t=o.focusZone.current)||void 0===t||t.focusElement(o.selectedQuery.current))},o.getGroupHeaderElement=function(e,t){return O.createElement(td.a,null,O.createElement(ep,{groupDividerProps:e,defaultRender:t,handleGroupOperation:o.props.handleGroupOperation,queries:o.props.queries,isAADDocumentHost:o.props.isAADDocumentHost,isPowerQueryEditEnabled:o.props.isPowerQueryEditEnabled,isDocumentStructureLocked:o.props.isDocumentStructureLocked}))},o.groupProps=function(e){return{onRenderHeader:o.getRenderGroupSectionFunction(e),showEmptyGroups:!0}},o.onQueryKeydown=function(e){if(o.dragAndDropEnabled)if(e.repeat)e.stopPropagation();else if(e.shiftKey&&Id(e)){var t=!0;switch(e.key){case"ArrowUp":o.moveQueryOneStep(fd.Up);break;case"ArrowDown":o.moveQueryOneStep(fd.Down);break;case"ArrowLeft":o.moveQueryOneLevel(fd.Left);break;case"ArrowRight":o.moveQueryOneLevel(fd.Right);break;default:t=!1}t&&e.stopPropagation()}else!o.isKeyboardDragging||e.shiftKey||Id(e)?"ArrowUp"!==e.key&&"ArrowDown"!==e.key||o.unselectQuery():(o.commitOrCancelDragState("Enter"===e.key),e.stopPropagation())},o.onRenderListItem=o.onRenderListItem.bind(o),o.setQuerySelected=o.setQuerySelected.bind(o),o.selection=new wi.a({items:o.props.queries,selectionMode:Pi.d.single}),o.state={selectedQueryKey:"",renamingQueryKey:""},o.dragAndDropEnabled&&(kp=O.lazy((function(){return ko((function(){n.e(27).then(n.bind(null,2697)).then((function(e){Ep=e.default})).catch((function(e){i.a.sendTraceTag(509872344,a.a.msoulscat_ES_EWAJS,s.a.Error,"QueriesList.ctor: cannot load draggableItem after loading react dnd, error:"+e),xp.error(508924354,{eventName:cp(rp.PowerQuery),dataFields:[Object(up.a)("ReactDND.Load.Failed",!0)],eventFlags:Sp(tp.DataCategories.ProductServiceUsage,tp.DiagnosticLevel.RequiredServiceData,tp.SamplingPolicy.CriticalBusinessImpact)})}))}))}))),o}return Object(k.__extends)(t,e),t.prototype.componentDidUpdate=function(e){this.isFirstRender&&(this.isFirstRender=!1),e.selectedQueryKey!==this.props.selectedQueryKey&&this.state.selectedQueryKey!==this.props.selectedQueryKey&&this.props.selectedQueryKey&&(this.selection.setKeySelected(this.props.selectedQueryKey,!1,!0),this.setState({selectedQueryKey:this.props.selectedQueryKey})),this.selection.setItems(this.props.queries,!1)},t.prototype.render=function(){var e=this;return this.paneDataUpdate=this.context.bind(this),this.dragAndDropEnabled?O.createElement(ju.Consumer,null,(function(t){return O.createElement(O.Suspense,{fallback:function(){return xp.error(508924353,{eventName:cp(rp.PowerQuery),dataFields:[Object(up.a)("ReactDND.Load.Fallback",!0)],eventFlags:Sp(tp.DataCategories.ProductServiceUsage,tp.DiagnosticLevel.RequiredServiceData,tp.SamplingPolicy.CriticalBusinessImpact)}),e.getQueriesListJSX(t)}},O.createElement(kp,{onRenderComponent:function(){return e.getQueriesListJSX(t)}}))})):this.getQueriesListJSX(null)},t.prototype.getQueriesListJSX=function(e){var t=this;this.paneData=e;var n=this.props.searchValueExists?this.filterGroups(this.props.groups):this.props.groups;return O.createElement("div",{"data-testid":"QueriesList",style:Xu},O.createElement(Ra.a,{selection:this.selection,selectionMode:Pi.d.single},O.createElement(Bo.a,null,(function(e){return O.createElement(Kd.a,{componentRef:t.list,items:t.props.queries,onRenderCell:t.onRenderListItem,selectionMode:Pi.d.single,focusZoneProps:{isCircularNavigation:!1,preventDefaultWhenHandled:!1,direction:Zt.a.vertical,componentRef:t.focusZone},groups:n,groupProps:t.groupProps(e),compact:!0,selection:t.selection,onShouldVirtualize:t.onShouldVirtualize})}))))},t.prototype.moveQueryOneLevel=function(e){var t,n,o=this.selection.getSelectedIndices();if(1===o.length){var r=o[0],i=this.props.queries[r],a=wd(i.groupKey,[this.props.groups],e);void 0!==a&&(this.paneDataUpdate({draggedQueryName:i.name,groupKey:a,hoveredQueryName:void 0,searchValue:null===(t=this.paneData)||void 0===t?void 0:t.searchValue,draggedInitialIndex:this.isKeyboardDragging?null===(n=this.paneData)||void 0===n?void 0:n.draggedInitialIndex:r}),this.isKeyboardDragging||(this.isKeyboardDragging=!0))}},t.prototype.moveQueryOneStep=function(e){var t,n,o,r=this.selection.getSelectedIndices();if(1===r.length){var i=r[0],a=this.props.queries[i],s=function(e,t,n){var o=n===fd.Up?e-1:e+1;if(!(o<0||o>=t))return o}(i,this.props.queries.length,e),l=void 0!==s?this.props.queries[s]:void 0;if(l&&l.groupKey===a.groupKey)this.paneDataUpdate({draggedQueryName:a.name,groupKey:void 0,hoveredQueryName:l.name,searchValue:null===(t=this.paneData)||void 0===t?void 0:t.searchValue});else{var c=wd(a.groupKey,[this.props.groups],e);if(void 0===c)return;this.paneDataUpdate({draggedQueryName:a.name,groupKey:c,hoveredQueryName:void 0,searchValue:null===(n=this.paneData)||void 0===n?void 0:n.searchValue,draggedInitialIndex:this.isKeyboardDragging?null===(o=this.paneData)||void 0===o?void 0:o.draggedInitialIndex:i})}this.isKeyboardDragging||(this.isKeyboardDragging=!0)}},t.prototype.commitOrCancelDragState=function(e){var t,n,o,r,l,c,u,d;if(this.isKeyboardDragging=!1,e)if((null===(t=this.paneData)||void 0===t?void 0:t.draggedQueryName)&&null!=(null===(n=this.paneData)||void 0===n?void 0:n.groupKey)){var p={name:null===(o=this.paneData)||void 0===o?void 0:o.draggedQueryName,extraData:""===this.paneData.groupKey?"Other Queries":this.paneData.groupKey};this.props.callbacks.handleQueryAction(0,p)}else(null===(r=this.paneData)||void 0===r?void 0:r.draggedQueryName)&&(null===(l=this.paneData)||void 0===l?void 0:l.hoveredQueryName)&&this.shouldCallReorderAction()&&this.props.callbacks.handleQueryAction(3,{name:null===(c=this.paneData)||void 0===c?void 0:c.draggedQueryName,extraData:null===(u=this.paneData)||void 0===u?void 0:u.hoveredQueryName});else this.props.callbacks.onCancelKeyboardReorder();this.paneDataUpdate({draggedQueryName:void 0,groupKey:void 0,hoveredQueryName:void 0,searchValue:null===(d=this.paneData)||void 0===d?void 0:d.searchValue}),i.a.sendTraceTag(509658316,a.a.msoulscat_ES_EWAJS,s.a.Info,"QueriesList.commitOrCancelDragState: User exit the dragging state with commit:"+e)},t.prototype.getRenderGroupSectionFunction=function(e){var t=this;return function(n,o){var r,i,a,s;return(null===(r=null==n?void 0:n.group)||void 0===r?void 0:r.name)&&-1!==(null===(i=null==n?void 0:n.group)||void 0===i?void 0:i.name.search("SubGroupOtherQueries-"))?O.createElement(O.Fragment,null," "):(null===(a=null==n?void 0:n.group)||void 0===a?void 0:a.key)&&t.props.isPowerQueryEditEnabled?t.dragAndDropEnabled&&Ep?O.createElement(O.Suspense,{fallback:function(){return xp.error(508924323,{eventName:cp(rp.PowerQuery),dataFields:[Object(up.a)("ReactDND.Group.Fallback",!0)],eventFlags:Sp(tp.DataCategories.ProductServiceUsage,tp.DiagnosticLevel.RequiredServiceData,tp.SamplingPolicy.CriticalBusinessImpact)}),t.getGroupHeaderElement(n,o)}},O.createElement(Ep,{id:null===(s=null==n?void 0:n.group)||void 0===s?void 0:s.key,type:Tp,moveQueryCallback:t.async.debounce(t.moveQueryToGroup,5)},t.getGroupHeaderElement(n,o))):t.getGroupHeaderElement(n,o):o(Object(k.__assign)(Object(k.__assign)({},n),{selectionMode:Pi.d.none,indentWidth:16,styles:Wu(e,null==n?void 0:n.groupLevel)}))}},t.prototype.toggleCollapseAll=function(e){var t;null===(t=this.list.current)||void 0===t||t.toggleCollapseAll(e)},t.prototype.setQuerySelected=function(e){var t;0!==e.fillObjectType&&2!==e.fillObjectType&&3!==e.fillObjectType||this.props.onQueySelected(e.name),this.selection.isKeySelected(e.name)||(this.isKeyboardDragging&&this.commitOrCancelDragState(!1),this.selection.setKeySelected(e.name,!0,!0),null===(t=this.list.current)||void 0===t||t.forceUpdate(),this.setState({selectedQueryKey:e.name}))},t.prototype.unselectQuery=function(){var e;if(0!==this.selection.getSelectedCount()){var t=this.props.queries[this.selection.getSelectedIndices()[0]];this.isKeyboardDragging&&this.commitOrCancelDragState(!1),this.selection.setKeySelected(t.name,!1,!1),this.setState({selectedQueryKey:""}),null===(e=this.list.current)||void 0===e||e.forceUpdate()}},t}(O.Component);Ip.contextType=Bu;var wp=n(1461),_p=n(646),Pp=n(30),Rp=n(427),Dp={root:"ms-CardItem"},jp={padding:0},Bp={margin:0},Fp=Object(wp.a)((function(e){var t=Object(_p.b)(e,{root:Qe.a.Item});return Object(_p.c)(t.root,Object(k.__assign)({},e))}),{displayName:"CardItem",styles:function(e,t,n){var o=Object(V.R)(Dp,t);return{root:[t.fonts.large,o.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[jp,e.fill&&Bp]}}),Lp={root:"ms-CardSection"},Mp={padding:0},Ap={margin:0},Np=Object(wp.a)((function(e){var t=e.children,n=Object(k.__rest)(e,["children"]);if(O.Children.count(t)<1)return null;var o=Object(_p.b)(e,{root:Qe.a});return Object(_p.c)(o.root,Object(k.__assign)({},n),t)}),{displayName:"CardSection",styles:function(e,t,n){var o=Object(V.R)(Lp,t);return{root:[t.fonts.large,o.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[Mp,e.fill&&Ap]}});function Wp(e){return!!e&&"object"==typeof e&&!!e.type}var Hp={root:"ms-Card"},zp=function(e,t){return{boxShadow:t.effects.elevation4,childrenGap:12,childrenMargin:0,cursor:"default",height:"inherit",highContrastBoxShadow:"0 1.6px 3.6px 0 Highlight, 0 0.3px 0.9px 0 Highlight",minHeight:"348px",minWidth:"212px",maxWidth:"286px"}},Vp={height:"auto",minWidth:"300px",maxWidth:"500px"},Gp=function(e,t){var n=t.effects;return{borderFocused:"1px solid black",boxShadowFocused:n.elevation8,boxShadowHovered:n.elevation8,cursor:"pointer",highContrastBoxShadowHovered:"0 3.2px 7.2px 0 Highlight, 0 0.6px 1.8px 0 Highlight"}},Up={Item:Fp,Section:Np},qp=Object(wp.a)((function(e){var t=Object(_p.b)(e,{root:Qe.a}),n=e.children,o=(e.styles,e.tokens),r=e.horizontal,i=e.onClick,a=e.onKeyDown,s=Object(k.__rest)(e,["children","styles","tokens","horizontal","onClick","onKeyDown"]),l=Object(Pp.j)(s,Pp.k),c=o&&o.childrenGap,u=o&&o.childrenMargin,d=O.Children.count(n),p=O.Children.map(n,(function(e,t){if(!e)return null;var n,o=Wp(n=e)&&n.type.displayName===Fp.displayName,i=function(e){return Wp(e)&&e.type.displayName===Np.displayName}(e);if(o||i){if(!c&&!u)return e;var a=e.props,s=a.fill,l=a.tokens,p=Object(k.__rest)(a,["fill","tokens"]),h=0;if(u&&!s){var g=0===t?u:0,m=t===d-1?u:0;h=r?u+"px "+m+"px "+u+"px "+g+"px":g+"px "+u+"px "+m+"px"}var f=Object(k.__assign)({margin:h,childrenGap:i?c:void 0},l);return O.cloneElement(e,Object(k.__assign)({tokens:f},p))}return Object(Rp.b)("The children of a Card component should be of type CardItem or CardSection."),e}));return Object(_p.c)(t.root,Object(k.__assign)({onClick:i,onKeyDown:function(e){a?a(e):i&&e&&(e.which===z.a.enter||e.which===z.a.space)&&(i(),e.preventDefault())},role:i?"button":"presentation",tabIndex:i?0:-1},l,{horizontal:r,horizontalAlign:r?"start":"stretch",tokens:o,verticalAlign:"start",verticalFill:!0}),p)}),{displayName:"Card",styles:function(e,t,n){var o,r,i;return{root:[Object(V.R)(Hp,t).root,{borderRadius:"2px",boxShadow:n.boxShadow,cursor:n.cursor,height:n.height,maxWidth:n.maxWidth,minWidth:n.minWidth,outline:"none",transition:"box-shadow 0.5s ease",width:n.width,selectors:(o={":focus":{border:n.borderFocused,boxShadow:n.boxShadowFocused,selectors:(r={},r[V.m]={boxShadow:n.highContrastBoxShadowFocused},r)},":hover":{boxShadow:n.boxShadowHovered,selectors:(i={},i[V.m]={boxShadow:n.highContrastBoxShadowHovered},i)}},o[V.m]={boxShadow:n.highContrastBoxShadow},o)}]}},tokens:function(e,t){return[zp,e.horizontal&&Vp,e.onClick&&Gp]},statics:Up}),Qp=function(e,t){return t?Object(V.I)(Kp(e),Yp(e)):Kp(e)},Kp=function(e){var t,n,o,r,i,a;return{root:{height:"50px",padding:"2px 0px 2px 3px",margin:"3px 8px 3px 8px",boxShadow:"none",background:"none",maxWidth:"inherit",selectors:(t={},t[":hover"]=[{backgroundColor:null===(o=e.semanticColors)||void 0===o?void 0:o.listItemBackgroundHovered},Ds.o],t[":focus"]={selectors:(n={},n[":focus"]=[{backgroundColor:null===(r=e.semanticColors)||void 0===r?void 0:r.listItemBackgroundChecked},Ds.o],n[":focus:hover"]=[{backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.listItemBackgroundCheckedHovered},Ds.o],n[":active"]=[{backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.listItemBackgroundChecked},Ds.o],n)},t)}}},Jp=Object(Po.c)((function(e,t){var n;return{root:[{float:"left",padding:"0",width:"97%",minWidth:"0",flex:"1"}],label:[e&&{height:"26px",whiteSpace:"nowrap",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",padding:"0px 0px 2px 0px",position:"relative"},!e&&{whiteSpace:"nowrap",fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",marginTop:"0px",marginLeft:"7px",padding:"0px 0px 0px 0px",fontSize:"12px"},{selectors:(n={},n[V.m]={color:t?"HighlightText":"inherit"},n)}]}})),Zp=Object(Po.c)((function(){return{root:{flex:1,minWidth:0}}})),Yp=function(e){var t;return{root:{border:"none",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listItemBackgroundChecked,commonHighContrastHoverFocusStyles:Ds.o}}};function Xp(e){var t,n;return{root:{backgroundColor:"transparent",height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"},rootDisabled:{backgroundColor:"transparent",height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"},rootHovered:{backgroundColor:null===(t=null==e?void 0:e.semanticColors)||void 0===t?void 0:t.buttonBackgroundHovered,height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"},rootPressed:{backgroundColor:null===(n=null==e?void 0:e.semanticColors)||void 0===n?void 0:n.buttonBackgroundHovered,height:"20px",padding:"1px",border:"0px",borderColor:"transparent",width:"20px"}}}var $p={height:"20px",width:"20px"},eh=function(e){e.styles;var t=e.partialTheme,n=Object(k.__rest)(e,["styles","partialTheme"]),o=function(e){var t,n,o=Object(O.useContext)(jd),r=o.borderRadius,i=o.buttonBorderLine;return{root:{borderRadius:r,selectors:(t={},t[":focus"]=[{border:"".concat(i," solid ").concat(null===(n=e.semanticColors)||void 0===n?void 0:n.focusBorder)}],t)}}}(t);return O.createElement(qp,Object(k.__assign)({},n,{styles:Object(V.I)(e.styles,o)}))},th=function(e){function t(t){var n=e.call(this,t)||this;return n.card=O.createRef(),n.menuShown=!1,n.paneLayoutUpdate=function(e){},n.isContextMenuShown=function(){var e,t;return n.props.isPowerQueryTaskPaneConnectionActionsEnabled&&((null===(e=n.state)||void 0===e?void 0:e.isFocused)||(null===(t=n.state)||void 0===t?void 0:t.isHovered)||n.menuShown)},n.shouldDisableRefreshButton=function(){return n.props.connection.loadedToDataModel||1===n.props.connection.fillObjectType||!n.props.connection.refreshEnabled||n.props.connection.inRefresh},n.setIsContextMenuSectionFocused=function(e){n.setState({isContextMenuSectionFocused:e})},n.onMenuShowHide=function(e){n.menuShown=e,n.setState({isFocused:!1,isHovered:!1})},n.onRefresh=function(){n.props.onLegacyConnectionRefresh(n.props.connection.name)},n.onCancelRefresh=function(e){e.onLegacyConnectionCancelRefresh(n.props.connection.name)},n.onConnectionDelete=function(e){e.onLegacyConnectionDelete(n.props.connection.name)},n.getRefreshOrCancelButton=function(e,t){return n.props.connection.inRefresh&&Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")?O.createElement(Fd,Object(k.__assign)({},_d(ExcelPowerqueryTaskpaneStrings.Cancel,"ExternalCancelRefreshButton-",(function(){return n.onCancelRefresh(t)}),ir.a.closeIcon,!1,e),{hideLabel:!0,styles:Xp(e)})):O.createElement(Fd,Object(k.__assign)({},_d(ExcelPowerqueryTaskpaneStrings.Refresh,"ExternalRefreshButton-",n.onRefresh,W.a.RefreshConnection_20,n.shouldDisableRefreshButton(),e),{hideLabel:!0,styles:Xp(e)}))},n.getMenuDefinition=function(e,t){var o={sections:[{controls:[]}]},r=o.sections[0].controls;return r.push(_d(ExcelPowerqueryTaskpaneStrings.Refresh,"ConnectionRefreshButton-",n.onRefresh,W.a.RefreshConnection_20,n.shouldDisableRefreshButton(),t)),r.push(_d(ExcelPowerqueryTaskpaneStrings.DeleteQueryOption,"ConnectionDeleteButton-",(function(){return n.onConnectionDelete(e)}),W.a.Delete_20,n.props.connection.inRefresh,t)),o},n.getContextMenu=function(e,t){return O.createElement(Ud,{id:"Connection-"+n.props.id.toString(),onMenuShowHide:n.onMenuShowHide,getRefreshOrCancelButton:function(){return n.getRefreshOrCancelButton(t,e)},menuDefinition:n.getMenuDefinition(e,t),shouldRenderOtherOptions:!0,isAADDocumentHost:!0})},n.onHover=n.onHover.bind(n),n.onNotHover=n.onNotHover.bind(n),n.onFocus=n.onFocus.bind(n),n.onBlur=n.onBlur.bind(n),n.onCardSectionKeyDown=n.onCardSectionKeyDown.bind(n),n.onRenderTitle=n.onRenderTitle.bind(n),n.isContextMenuShown=n.isContextMenuShown.bind(n),n.shouldDisableRefreshButton=n.shouldDisableRefreshButton.bind(n),n.setIsContextMenuSectionFocused=n.setIsContextMenuSectionFocused.bind(n),n.onMenuShowHide=n.onMenuShowHide.bind(n),n.onRefresh=n.onRefresh.bind(n),n.onCancelRefresh=n.onCancelRefresh.bind(n),n.onConnectionDelete=n.onConnectionDelete.bind(n),n.setState({isHovered:!1,isFocused:!1,isSelected:!1,isContextMenuSectionFocused:!1}),n}return Object(k.__extends)(t,e),t.prototype.onHover=function(){this.menuShown||this.setState({isFocused:!1,isSelected:!1,isHovered:!0})},t.prototype.onNotHover=function(){this.menuShown||this.setState({isFocused:!1,isSelected:!1,isHovered:!1})},t.prototype.onFocus=function(){this.menuShown||this.setState({isFocused:!0,isSelected:!0,isHovered:!1})},t.prototype.onBlur=function(){this.menuShown||this.setState({isFocused:!1,isSelected:!1,isHovered:!1})},t.prototype.onCardSectionKeyDown=function(e){var t;this.state.isContextMenuSectionFocused||!e||e.keyCode!==z.a.enter&&e.which!==z.a.space||(null===(t=this.card.current)||void 0===t||t.click(),e.preventDefault())},t.prototype.componentDidMount=function(){if(1===this.props.id){var e=document.getElementById("PowerQueryConnectionContainerId-"+this.props.id);e&&e.focus()}},t.prototype.componentDidUpdate=function(e){var t;if(null===(t=this.state)||void 0===t?void 0:t.isFocused){var n=document.getElementById("PowerQueryConnectionContainerId-"+this.props.id);n&&n.focus()}},t.prototype.onRenderTitle=function(){var e;return O.createElement(jo.a,{type:"AppLabelProps",id:"ConnectionName-"+this.props.id,forId:"ConnectionName-"+this.props.id,label:this.props.connection.name,styles:Jp(!0,null===(e=this.state)||void 0===e?void 0:e.isHovered),customTooltip:this.props.connection.name})},t.prototype.render=function(){var e=this,t=this.isContextMenuShown();return O.createElement(Bo.a,null,(function(n){return O.createElement(nd.Consumer,null,(function(o){var r,i;return O.createElement("div",{ref:e.card},O.createElement(eh,{id:"PowerQueryConnectionContainerId-"+e.props.id,horizontal:!1,styles:Qp(n,null===(r=e.state)||void 0===r?void 0:r.isSelected),"data-is-focusable":!0,onFocus:e.onFocus,onBlur:e.onBlur,onMouseOver:e.onHover,onMouseLeave:e.onNotHover,onKeyDown:e.onCardSectionKeyDown,onClick:e.onFocus,partialTheme:n},O.createElement(qp.Section,{horizontal:!0},O.createElement(qp.Section,null,e.props.connection.inRefresh?O.createElement(ed.a,{type:"AppSpinnerProps",id:"ConnectionRefreshSpinner"+e.props.id,appColors:Object(f.a)(),spinnerSize:al.a.medium}):O.createElement(H.a,{style:$p,iconName:W.a.Table_20})),O.createElement(qp.Section,{horizontal:!1,styles:Zp},O.createElement(qp.Section,{horizontal:!0},O.createElement(td.a,null,e.onRenderTitle()),t&&O.createElement(Da.a,{onFocus:function(){return e.setIsContextMenuSectionFocused(!0)},onBlur:function(){return e.setIsContextMenuSectionFocused(!1)}},e.getContextMenu(o,n))),O.createElement(qp.Section,{horizontal:!1},O.createElement(jo.a,{type:"AppLabelProps",id:"ConnectionDescription-"+e.props.id,forId:"ConnectionDescription-"+e.props.id,label:e.props.connection.description,styles:Jp(!1,null===(i=e.state)||void 0===i?void 0:i.isHovered)}))))))}))}))},t.contextType=nd,t}(O.Component),nh=function(e){function t(t){var n=e.call(this,t)||this;return n.focusZone=O.createRef(),n.onRenderListItem=function(e,t,o){if(void 0!==t){var r=(null!=o?o:0)+1,i=ExcelPowerqueryTaskpaneStrings.ConnectionAriaLabel.replace("{0}",r.toString()).replace("{1}",n.props.connections.length.toString());return O.createElement("div",{"aria-label":i},O.createElement(th,{connection:t,id:r,isPowerQueryTaskPaneConnectionActionsEnabled:n.props.isPowerQueryTaskPaneConnectionActionsEnabled,onLegacyConnectionRefresh:n.props.onLegacyConnectionRefresh,onLegacyConnectionCancelRefresh:n.props.onLegacyConnectionCancelRefresh,onLegacyConnectionDelete:n.props.onLegacyConnectionDelete}))}},n.onRenderListItem=n.onRenderListItem.bind(n),n.selection=new wi.a({items:n.props.connections,selectionMode:Pi.d.single}),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Kd.a,{role:"list",items:this.props.connections,onRenderCell:this.onRenderListItem,selection:this.selection,compact:!0,focusZoneProps:{isCircularNavigation:!1,preventDefaultWhenHandled:!1,direction:Zt.a.vertical,componentRef:this.focusZone}})},t.prototype.componentDidUpdate=function(e){var t=this.selection.getSelection()[0];this.selection.setItems(this.props.connections,!1),t?this.selection.setKeySelected(t.key,!0,!0):e.connections&&0!==e.connections.length||this.selection.setIndexSelected(0,!0,!0)},t}(O.Component),oh=function(e){var t,n=e.children,o=e.partialTheme,r=Object(k.__rest)(e,["children","partialTheme"]),i=null===(t=function(e){var t,n,o,r=Object(O.useContext)(jd).borderRadius;return{styles:{root:{selectors:(t={},t[":active"]=[{backgroundColor:null===(n=e.semanticColors)||void 0===n?void 0:n.listItemBackgroundHovered}],t[":hover"]=[{borderRadius:r,backgroundColor:null===(o=e.semanticColors)||void 0===o?void 0:o.listItemBackgroundHovered}],t)}}}}(o))||void 0===t?void 0:t.styles,a=[];return O.Children.forEach(n,(function(e){var t;if(O.isValidElement(e)){var n=e.props,o=(n.headerButtonProps,Object(k.__rest)(n,["headerButtonProps"]));a.push(O.createElement(No.a,Object(k.__assign)({},o,{headerButtonProps:{styles:Object(V.I)(null===(t=e.props.headerButtonProps)||void 0===t?void 0:t.styles,i)}})))}})),O.createElement(Wo.a,Object(k.__assign)({},r),a)},rh={root:{marginRight:"8px"}},ih={root:{marginRight:"4px"}},ah={paddingTop:"1px",height:"100%",width:"100%"},sh={link:{marginTop:"1px",marginLeft:"1px"}},lh=function(e){function t(t){var n=e.call(this,t)||this;return n.queriesCountContainerRef=O.createRef(),n.queriesListRef=O.createRef(),n.connectionsListRef=O.createRef(),n.asyncInstance=new Ia.a,n.isProtectedWorkbook=!1,n.getQueriesCountLabel=function(e){return n.props.searchValue?0===e?ExcelPowerqueryTaskpaneStrings.QueriesSearchNoQueriesFound:1===e?ExcelPowerqueryTaskpaneStrings.QueriesSearchOneQueryFound:ExcelPowerqueryTaskpaneStrings.QueriesSearchNumQueriesFound.replace("{0}",e.toString()):1===e?ExcelPowerqueryTaskpaneStrings.OneQueryTaskpaneHeadline:ExcelPowerqueryTaskpaneStrings.QueriesCountTaskpaneHeadline.replace("{0}",e.toString())},n.getConnectionsCountLabel=function(e){return 1===e?ExcelPowerqueryTaskpaneStrings.OneConnectionTaskpaneHeadline:ExcelPowerqueryTaskpaneStrings.ConnectionsCountTaskpaneHeadline.replace("{0}",e.toString())},n.filterConnections=function(){var e;return null===(e=n.props.connections)||void 0===e?void 0:e.filter((function(e,t){return!!(null==e?void 0:e.name)||(i.a.sendTraceTag(512288606,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.filterConnections: Unknown connection name at index "+t),!1)})).map((function(e){return{name:e.name,description:e.description,fillObjectType:e.fillObjectType,loadedToDataModel:e.loadedToDataModel,inRefresh:e.inRefresh,refreshEnabled:e.refreshEnabled}}))},n.filterQueries=function(){var e;return null===(e=n.props.queries)||void 0===e?void 0:e.filter((function(e,t){return!(!e||!e.name)||(i.a.sendTraceTag(540374725,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.filterQueries: Unknown query name in index"+t),!1)}))},n.filterGroups=function(){var e;return null===(e=n.props.groups)||void 0===e?void 0:e.filter((function(e,t){return!!(e&&e.name&&e.key)||(i.a.sendTraceTag(540374726,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.ctor: Unknown group name or key in index"+t),!1)}))},n.buildQueriesWithKeys=function(){var e;return null===(e=n.filterQueries())||void 0===e?void 0:e.map((function(e){return Object(k.__assign)(Object(k.__assign)({},e),{key:null==e?void 0:e.name})}))},n.getRefreshButton=function(e,t,o){return O.createElement(Fd,Object(k.__assign)({},_d(ExcelPowerqueryTaskpaneStrings.RefreshAll,e,t,W.a.RefreshConnection_20,n.shouldDisableRefreshButton(),o),{hideLabel:!0,styles:Qu(o)}))},n.getConnectionsRefreshButton=function(e,t,o){return O.createElement(Fd,Object(k.__assign)({},_d(ExcelPowerqueryTaskpaneStrings.RefreshAll,e,t,W.a.RefreshConnection_20,n.shouldDisableConnectionsRefreshButton(),o),{hideLabel:!0,styles:Qu(o)}))},n.getClearPermissionsSection=function(e){var t={controls:[]};return t.controls.push(_d(ExcelPowerqueryTaskpaneStrings.ClearAllPermissions,"ClearAllPermissions-",(function(){var e;return null===(e=n.props.callbacks)||void 0===e?void 0:e.onClearAllCredentials()}),W.a.DeleteHyperlink_20,!1,e)),t},n.getCollapseExpandButtonsSection=function(e){var t={controls:[]},o=t.controls;return o.push(_d(ExcelPowerqueryTaskpaneStrings.ExpandAllOption,"ExpandAllButton-",(function(){n.toggleCollapseAll(!1)}),void 0,!1,e)),o.push(_d(ExcelPowerqueryTaskpaneStrings.CollapseAllOption,"CollapseAllButton-",(function(){n.toggleCollapseAll(!0)}),void 0,!1,e)),t},n.getGeneralMenuDefinition=function(e,t){var o={sections:[]};if(Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryCopyPaste")&&n.props.isPowerQueryEditEnabled){var r=[];r.push(_d(ExcelPowerqueryTaskpaneStrings.PasteOption,"Paste-",(function(){return Object(k.__awaiter)(n,void 0,void 0,(function(){var e,t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return[4,Rd()];case 1:return e=n.sent(),null===(t=this.props.callbacks)||void 0===t||t.onPowerQueryPaste(null,e.queries,e.queryGroups),[2]}}))}))}),W.a.Paste_24,!n.state.isPasteEnabled,t)),o.sections.push({controls:r})}var i=[];return i.push(_d(ExcelPowerqueryTaskpaneStrings.CreateNewGroupOption,"NewGroupButton-",(function(){var t,o;e({type:rd.GroupProperties,groupOperation:0,groupSiblingsNames:null!==(o=null===(t=n.props.groups)||void 0===t?void 0:t.map((function(e){return null==e?void 0:e.name})))&&void 0!==o?o:[]})}),W.a.AddQueryGroup_16,n.isProtectedWorkbook,t)),o.sections.push({controls:i}),o.sections.push(n.getCollapseExpandButtonsSection(t)),Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh")&&Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane")&&o.sections.push(n.getClearPermissionsSection(t)),o},n.onMenuShowHide=function(e){return Object(k.__awaiter)(n,void 0,void 0,(function(){var t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return e&&Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryCopyPaste")?[4,Pd()]:[2];case 1:return(t=n.sent())&&!this.state.isPasteEnabled?this.setState({isPasteEnabled:!0}):!t&&this.state.isPasteEnabled&&this.setState({isPasteEnabled:!1}),[2]}}))}))},n.getGeneralContextMenu=function(e,t,o){return O.createElement(td.a,null,O.createElement(Ud,{id:"GeneralContextMenu",getRefreshOrCancelButton:function(){return n.getRefreshButton("TopLevelRefreshButton-",(function(){n.onRefreshAll(e.onQueryRefresh)}),o)},styles:rh,menuDefinition:n.getGeneralMenuDefinition(t,o),shouldRenderOtherOptions:n.props.isPowerQueryEditEnabled,isAADDocumentHost:n.props.isAADDocumentHost,onMenuShowHide:n.onMenuShowHide}))},n.getQueriesTaskPane=function(){var e=n.buildQueriesWithKeys(),t=Td(n.filterGroups());return O.createElement(Bo.a,null,(function(o){return O.createElement(nd.Consumer,null,(function(r){var i,a;return O.createElement("div",null,null==e&&O.createElement("div",{className:Au(),"data-testid":"PowerQueryTaskPaneSpinner"},O.createElement(ed.a,{type:"AppSpinnerProps",id:"PowerQueryTaskPaneSpinner",appColors:Object(f.a)(),label:ExcelPowerqueryTaskpaneStrings.SpinnerLoadingLabel})),null!=e&&O.createElement("div",{"aria-live":"assertive","aria-label":ExcelPowerqueryTaskpaneStrings.QueriesTaskpaneAriaLabel,style:Lu},O.createElement(Ga.a,{type:"AppSearchBoxProps",id:"searchQueriesId",styles:Nu(o),iconColor:null===(i=o.palette)||void 0===i?void 0:i.neutralSecondaryAlt,icon:"Search",onChange:n.asyncInstance.debounce(n.onSearchTextChanged,500),autoComplete:"off",value:n.props.searchValue,placeholder:ExcelPowerqueryTaskpaneStrings.QueriesSearchPlaceholder,maxLength:80}),O.createElement("div",{tabIndex:0,ref:n.queriesCountContainerRef},O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},O.createElement(Qe.a.Item,{grow:1},O.createElement(jo.a,{type:"AppLabelProps",id:"QueriesCount",forId:"QueriesCount-"+e.length,label:n.getQueriesCountLabel(e.length),styles:Mu})),O.createElement(sd.Consumer,null,(function(e){return O.createElement(Qe.a.Item,{grow:0},(Object(yt.isChangeGateEnabled)("OfficeVSO:7111771_PowerQueryRefreshWeb")&&n.props.isAADDocumentHost||n.props.isPowerQueryEditEnabled)&&n.getGeneralContextMenu(r,e,o))})))),O.createElement(Ip,{queries:e,groups:t,onQueySelected:n.props.callbacks.onQuerySelected,onQueryRefresh:null===(a=n.props.callbacks)||void 0===a?void 0:a.onQueryRefresh,searchValueExists:!!n.props.searchValue&&0!==n.props.searchValue.length,handleGroupOperation:n.props.callbacks.handleQueryGroupOperation,selectedQueryKey:n.props.selectedQueryKey,ref:n.queriesListRef,callbacks:r,isAADDocumentHost:n.props.isAADDocumentHost,isPowerQueryEditEnabled:n.props.isPowerQueryEditEnabled,isDocumentStructureLocked:n.isProtectedWorkbook})))}))}))},n.getConnectionsMenuDefinition=function(e,t){var o={sections:[{controls:[]}]};return o.sections[0].controls.push(_d(ExcelPowerqueryTaskpaneStrings.RefreshAll,"ConnectionsRefreshAllButton-",(function(){n.onRefreshAllConnections(e.onLegacyConnectionRefresh)}),W.a.RefreshConnection_20,n.shouldDisableConnectionsRefreshButton(),t)),o},n.getConnectionsContextMenu=function(e,t){return O.createElement(Ud,{id:"ConnectionsContextMenu-",getRefreshOrCancelButton:function(){return n.getConnectionsRefreshButton("ConnectionsRefreshAllButton-",(function(){n.onRefreshAllConnections(e.onLegacyConnectionRefresh)}),t)},styles:ih,menuDefinition:n.getConnectionsMenuDefinition(e,t),shouldRenderOtherOptions:n.props.isPowerQueryTaskPaneConnectionActionsEnabled,isAADDocumentHost:n.props.isAADDocumentHost})},n.getConnectionsTaskPane=function(){var e,t=null===(e=n.filterConnections())||void 0===e?void 0:e.map((function(e){return Object(k.__assign)(Object(k.__assign)({},e),{key:null==e?void 0:e.name})}));return O.createElement(Bo.a,null,(function(e){return O.createElement(nd.Consumer,null,(function(o){var r,i,a;return O.createElement("div",null,null==t&&O.createElement("div",{className:Au()},O.createElement(ed.a,{type:"AppSpinnerProps",id:"PowerQueryConnectionsTaskPaneSpinner",appColors:Object(f.a)(),label:ExcelPowerqueryTaskpaneStrings.SpinnerLoadingLabel})),null!=t&&O.createElement("div",{"aria-live":"assertive","aria-label":ExcelPowerqueryTaskpaneStrings.ConnectionsTaskpaneAriaLabel,style:Lu},O.createElement("div",{tabIndex:0},O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",styles:ih},O.createElement(Qe.a.Item,{grow:1},O.createElement(jo.a,{type:"AppLabelProps",id:"ConnectionsCount",forId:"ConnectionsCount-0",label:n.getConnectionsCountLabel(t.length),styles:Mu})),O.createElement(Qe.a.Item,{grow:0},n.props.isPowerQueryTaskPaneConnectionActionsEnabled&&n.getConnectionsContextMenu(o,e)))),O.createElement(nh,{connections:t,ref:n.connectionsListRef,onLegacyConnectionRefresh:null===(r=n.props.callbacks)||void 0===r?void 0:r.onLegacyConnectionRefresh,onLegacyConnectionCancelRefresh:null===(i=n.props.callbacks)||void 0===i?void 0:i.onLegacyConnectionCancelRefresh,onLegacyConnectionDelete:null===(a=n.props.callbacks)||void 0===a?void 0:a.onLegacyConnectionDelete,callbacks:o,isPowerQueryTaskPaneConnectionActionsEnabled:n.props.isPowerQueryTaskPaneConnectionActionsEnabled})))}))}))},n.toggleCollapseAll=function(e){var t;null===(t=n.queriesListRef.current)||void 0===t||t.toggleCollapseAll(e)},n.onRefreshAll=function(e){var t;null===(t=n.props.queries)||void 0===t||t.forEach((function(t){xd(t)&&e(null==t?void 0:t.name)}))},n.onRefreshAllConnections=function(e){var t;null===(t=n.props.connections)||void 0===t||t.forEach((function(t){xd(t)&&e(null==t?void 0:t.name)}))},n.shouldDisableRefreshButton=function(){var e;return!(null===(e=n.props.queries)||void 0===e?void 0:e.some((function(e){return xd(e)})))},n.shouldDisableConnectionsRefreshButton=function(){var e;return!(null===(e=n.props.connections)||void 0===e?void 0:e.some((function(e){return xd(e)})))},n.onSearchTextChanged=function(e,t){n.context({searchValue:t})},n.isProtectedWorkbook=Object(yt.isChangeGateEnabled)("OfficeVSO:8318223_DisableEditOperationsForStructureProtected")&&t.isDocumentStructureLocked,n.state={isPasteEnabled:!1},n}return Object(k.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t,n;null==e.queries&&null!=this.props&&0===(null===(t=this.props.queries)||void 0===t?void 0:t.length)&&(null===(n=this.queriesCountContainerRef.current)||void 0===n||n.focus())},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement("div",{style:ah},O.createElement(oh,{partialTheme:t,styles:Object(yt.isChangeGateEnabled)("OfficeVSO:8374443_QueriesConnectionA11yFix")?sh:void 0,onLinkClick:function(e){var t;xp.log(508924357,{eventName:cp(rp.PowerQuery),dataFields:[Object(up.d)("Tab.Clicked",null!==(t=null==e?void 0:e.props.itemKey)&&void 0!==t?t:"")],eventFlags:Sp(tp.DataCategories.ProductServiceUsage,tp.DiagnosticLevel.RequiredServiceData,tp.SamplingPolicy.CriticalBusinessImpact)})}},O.createElement(No.a,{itemKey:"Queries",headerText:ExcelPowerqueryTaskpaneStrings.QueriesTaskPaneTab},e.getQueriesTaskPane()),O.createElement(No.a,{itemKey:"Connections",headerText:ExcelPowerqueryTaskpaneStrings.ConnectionsTaskPaneTab},e.getConnectionsTaskPane())))}))},t}(O.Component);function ch(e){var t;return{root:{top:"3px",bottom:"5px",fontSize:"12px",lineHeight:"16px",padding:"0px"},label:{fontWeight:V.l.semibold,color:null===(t=e.semanticColors)||void 0===t?void 0:t.inputText}}}function uh(e){return function(t){var n,o,r,i,a;return{root:{background:null===(n=e.semanticColors)||void 0===n?void 0:n.inputBackground},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(o=e.semanticColors)||void 0===o?void 0:o.focusBorder:null===(r=e.semanticColors)||void 0===r?void 0:r.inputBorder,boxSizing:"border-box",borderRadius:V.e.roundedCorner2,color:null===(i=e.semanticColors)||void 0===i?void 0:i.inputText,backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.inputBackground},field:{fontSize:"12px",lineHeight:"16px",height:"48px"}}}}function dh(){var e;return{root:{width:"fit-content",padding:"5px 20px"},label:(e={fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:V.l.semibold},e[V.m]={color:"inherit"},e)}}function ph(e){var t,n,o,r,i,a;return{root:{width:"fit-content",padding:"5px 20px",backgroundColor:null===(n=e.semanticColors)||void 0===n?void 0:n.buttonBackground},label:(t={color:null===(o=e.semanticColors)||void 0===o?void 0:o.buttonText,fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:V.l.semibold},t[V.m]={color:"inherit"},t),rootHovered:{backgroundColor:null===(r=e.semanticColors)||void 0===r?void 0:r.buttonBackgroundHovered},rootPressed:{backgroundColor:null===(i=e.semanticColors)||void 0===i?void 0:i.buttonBackgroundPressed},rootFocused:{backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.buttonBackground}}}lh.contextType=Bu;var hh=function(e,t){var n,o,r,i,a,s,l,c,u,d,p,h,g,m,f,b,v,y,x,C,S,E,k,T,I=Object(O.useContext)(jd),w=I.borderRadius,_=I.buttonBorderLine;return{root:{borderRadius:w,backgroundColor:e?null===(n=t.semanticColors)||void 0===n?void 0:n.primaryButtonBackground:null===(o=null==t?void 0:t.semanticColors)||void 0===o?void 0:o.buttonBackground,color:e?null===(r=t.semanticColors)||void 0===r?void 0:r.primaryButtonText:null===(i=t.semanticColors)||void 0===i?void 0:i.buttonText,border:"".concat(_," solid ").concat(e?null===(a=null==t?void 0:t.semanticColors)||void 0===a?void 0:a.primaryButtonBorder:null===(s=null==t?void 0:t.semanticColors)||void 0===s?void 0:s.buttonBorder)},rootDisabled:{borderRadius:w,backgroundColor:e?null===(l=t.semanticColors)||void 0===l?void 0:l.primaryButtonBackgroundDisabled:null===(c=null==t?void 0:t.semanticColors)||void 0===c?void 0:c.buttonBackgroundDisabled,border:"".concat(_," solid ").concat(e?null===(u=null==t?void 0:t.semanticColors)||void 0===u?void 0:u.buttonBorderDisabled:null===(d=null==t?void 0:t.semanticColors)||void 0===d?void 0:d.buttonBorderDisabled)},rootHovered:{borderRadius:w,backgroundColor:w!==Dd.borderRadius?e?null===(p=t.semanticColors)||void 0===p?void 0:p.primaryButtonBackground:null===(h=null==t?void 0:t.semanticColors)||void 0===h?void 0:h.buttonBackground:e?null===(g=t.semanticColors)||void 0===g?void 0:g.primaryButtonBackgroundHovered:null===(m=null==t?void 0:t.semanticColors)||void 0===m?void 0:m.buttonBackgroundHovered,border:"".concat(_," solid ").concat(e?null===(f=null==t?void 0:t.semanticColors)||void 0===f?void 0:f.primaryButtonBorder:null===(b=null==t?void 0:t.semanticColors)||void 0===b?void 0:b.buttonBorder)},rootPressed:{borderRadius:w,backgroundColor:null===(v=t.semanticColors)||void 0===v?void 0:v.primaryButtonBackgroundPressed,color:null===(y=t.semanticColors)||void 0===y?void 0:y.primaryButtonText,border:"".concat(_," solid ").concat(e?null===(x=null==t?void 0:t.semanticColors)||void 0===x?void 0:x.primaryButtonBorder:null===(C=null==t?void 0:t.semanticColors)||void 0===C?void 0:C.buttonBorder)},rootFocused:{borderRadius:w,backgroundColor:null===(S=t.semanticColors)||void 0===S?void 0:S.primaryButtonBackground,color:null===(E=t.semanticColors)||void 0===E?void 0:E.primaryButtonText,border:"".concat(_," solid ").concat(e?null===(k=null==t?void 0:t.semanticColors)||void 0===k?void 0:k.primaryButtonBorder:null===(T=null==t?void 0:t.semanticColors)||void 0===T?void 0:T.buttonBorder)}}},gh=function(e){e.styles,e.partialTheme;var t=Object(k.__rest)(e,["styles","partialTheme"]);return O.createElement(Nr.b,Object(k.__assign)({},t,{styles:Object(V.I)(e.styles,hh(e.primary,e.partialTheme))}))},mh=function(e){var t,n,o=Object(O.useContext)(jd).borderRadius;return{root:{border:"none",borderRadius:o,background:"transparent",width:"fit-content",paddingLeft:"0px"},rootDisabled:{border:"none",borderRadius:o,background:"transparent"},rootHovered:{border:"none",borderRadius:o,backgroundColor:null===(t=null==e?void 0:e.semanticColors)||void 0===t?void 0:t.buttonBackgroundHovered},rootPressed:{border:"none",borderRadius:o,backgroundColor:null===(n=null==e?void 0:e.semanticColors)||void 0===n?void 0:n.buttonBackgroundPressed},icon:{height:"20px",width:"20px"},label:{fontSize:"14px",lineHeight:"20px",textAlign:"center",fontWeight:V.l.regular}}},fh=function(e){e.styles,e.partialTheme;var t=Object(k.__rest)(e,["styles","partialTheme"]);return O.createElement(Nr.b,Object(k.__assign)({},t,{styles:Object(V.I)(e.styles,mh(e.partialTheme))}))},bh=function(e){var t=e.id,n=e.name,o=e.description,r=e.operationType,i=e.groups,a=e.siblingNames,s=O.useState(void 0),l=s[0],u=s[1],d=O.useState(n),p=d[0],h=d[1],g=O.createRef(),m=O.useState(o),f=m[0],b=m[1],v=O.createRef(),y=od(),x=ld(),C=function(e){var t,o=Object(yt.isChangeGateEnabled)("OfficeVSO:7995406_isFixingValidateGroupNamesEnabled");if(h(e),e!==n||o){var r=o?a:null!==(t=null==i?void 0:i.map((function(e){return null==e?void 0:e.name})))&&void 0!==t?t:[];u(Sd(e,r,n))}},S=function(){var e,n,o;if(!l&&(null===(e=g.current)||void 0===e?void 0:e.value)){var i={id:t||"{"+ct()+"}",name:null===(n=g.current)||void 0===n?void 0:n.value,description:null===(o=v.current)||void 0===o?void 0:o.value,parentId:""};y.handleQueryGroupOperation(r,i),x({type:rd.Home})}},E=function(e){var t;e.which===z.a.escape&&(null===(t=g.current)||void 0===t||t.resetState(),e.stopPropagation(),e.preventDefault())};O.useEffect((function(){var e;null===(e=g.current)||void 0===e||e.focus()}),[]),O.useEffect((function(){var e,t,o=Object(yt.isChangeGateEnabled)("OfficeVSO:7995406_isFixingValidateGroupNamesEnabled");if((null===(e=g.current)||void 0===e?void 0:e.value)!==n||o){var r=o?a:null!==(t=null==i?void 0:i.map((function(e){return null==e?void 0:e.name})))&&void 0!==t?t:[];u(Sd(p,r,n))}}),[i,n,g,p,a]);var k=function(e){return O.createElement(gh,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.SaveButton,id:"GroupProperties-SaveButton",styles:dh(),disabled:!(!l&&p)||5===r&&n===p&&o===f,onExecute:S,partialTheme:e,primary:!0})},T=function(e){return O.createElement(gh,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.CancelButton,id:"GroupProperties-CancelsButton",styles:ph(e),onExecute:function(){x({type:rd.Home})},partialTheme:e,primary:!1})},I=O.useContext(jd).isCancelButtonFirst;return O.createElement(Bo.a,null,(function(e){return O.createElement(Qe.a,{horizontal:!1,verticalAlign:"start",styles:{root:{padding:"16px",height:"100%"}},tokens:{childrenGap:12}},O.createElement(fh,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.QueriesTaskPaneTab,id:"GroupProperties-queriesButton",icon:Object(F.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:function(){x({type:rd.Home})},partialTheme:e}),O.createElement(Qe.a.Item,null,O.createElement(jo.a,{id:"GroupNameLabel",type:"AppLabelProps",forId:"GroupNameInput",label:ExcelPowerqueryTaskpaneStrings.GroupNameInputLabel,styles:ch(e)}),O.createElement(Ya.a,{ref:g,id:"GroupNameInput",type:"AppInputProps",value:n,autoComplete:"off",styles:Hu(e),onChange:C,errorMessage:l,onExecute:S,executeOnEnter:!0,onKeyDown:E})),O.createElement(Qe.a.Item,null,O.createElement(jo.a,{id:"GroupDescriptionLabel",type:"AppLabelProps",forId:"GroupDescriptionInput",label:ExcelPowerqueryTaskpaneStrings.PropertiesDescriptionInputLabel,styles:ch(e)}),O.createElement(Ya.a,{ref:v,id:"GroupDescriptionInput",type:"AppInputProps",value:o,autoComplete:"off",styles:uh(e),multiline:!0,resizable:!0,onChange:function(e){b(e)},onExecute:S,executeOnEnter:!0,onKeyDown:E})),O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:4}},I?T(e):k(e),I?k(e):T(e)))}))};var vh=function(e){var t,n;return Object(V.eb)({color:null===(t=e.semanticColors)||void 0===t?void 0:t.errorText,margin:0,paddingTop:5,fontSize:"12px",fontWeight:V.l.regular,background:null===(n=e.semanticColors)||void 0===n?void 0:n.errorBackground})},yh=function(e){var t;return{root:{padding:"0px"},label:{fontWeight:V.l.semibold,fontSize:"12px",lineHeight:"16px",color:null===(t=e.semanticColors)||void 0===t?void 0:t.inputText}}},xh=function(e){var t,n;return{width:"100%",height:"210px",backgroundColor:null===(t=e.semanticColors)||void 0===t?void 0:t.listBackground,border:"1px solid "+(null===(n=e.semanticColors)||void 0===n?void 0:n.inputBorder),boxSizing:"border-box",borderRadius:V.e.roundedCorner2,overflow:"auto"}},Ch=Object(Po.c)((function(e,t){var n,o,r,i,a,s;return{root:{margin:"6px 12px 6px 8px",height:"28px",backgroundColor:t?null===(o=e.semanticColors)||void 0===o?void 0:o.listItemBackgroundChecked:"unset",selectors:(n={},n[":hover"]=[{backgroundColor:t?null===(r=e.semanticColors)||void 0===r?void 0:r.listItemBackgroundCheckedHovered:null===(i=e.semanticColors)||void 0===i?void 0:i.listItemBackgroundHovered}],n[":focus"]=[{backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.listItemBackgroundChecked}],n)},label:{fontSize:"12px",lineHeight:"16px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:null===(s=e.semanticColors)||void 0===s?void 0:s.listText}}})),Sh=function(e){e.styles;var t=Object(k.__rest)(e,["styles"]);return O.createElement(jo.a,Object(k.__assign)({},t,{styles:Object(V.I)(e.styles,{root:{borderRadius:Object(O.useContext)(jd).borderRadius}})}))};function Eh(e){var t,n,o;return{root:{width:"fit-content",padding:"5px 20px",backgroundColor:null===(n=e.semanticColors)||void 0===n?void 0:n.buttonBackground},label:(t={fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:V.l.semibold},t[V.m]={color:"inherit"},t),rootHovered:{backgroundColor:null===(o=e.semanticColors)||void 0===o?void 0:o.buttonBackgroundHovered}}}var kh=function(e,t,n,o,r,i){return O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:4}},r?Th(e,t,o):Oh(e,t,i,n),r?Oh(e,t,i,n):Th(e,t,o))},Oh=function(e,t,n,o){return O.createElement(gh,{id:"".concat(e,"-SaveButton"),type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.SaveButton,styles:{root:{width:"fit-content",padding:"5px 20px"},label:(r={fontSize:"12px",lineHeight:"16px",textAlign:"center",fontWeight:V.l.semibold},r[V.m]={color:"inherit"},r)},disabled:n,onExecute:o,partialTheme:t,primary:!0});var r},Th=function(e,t,n){return O.createElement(gh,{id:"".concat(e,"-CancelButton"),type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.CancelButton,styles:Eh(t),onExecute:n,partialTheme:t,primary:!1})},Ih=function(e){var t=e.groups,n=e.movingObjectId,o=e.movingObjectName,r=e.isGroupMoving,i=O.useRef(null),a=od(),s=Ed(t,n,r),l=ld(),u=O.useState(void 0),d=u[0],p=u[1],h=O.useState(void 0),g=h[0],m=h[1],f=new wi.a({items:s,selectionMode:Pi.d.single,onSelectionChanged:function(){var e,t=f.getSelection()[0];t&&(p(t),m(function(e,t,n){var o,r;return!!(null===(r=null===(o=e.find((function(e){return e.key===n})))||void 0===o?void 0:o.children)||void 0===r?void 0:r.find((function(e){var n,o;return(null===(o=null===(n=e.name)||void 0===n?void 0:n.split("\\").pop())||void 0===o?void 0:o.toLowerCase())===t.toLowerCase()})))}(s,o,t.key)),null===(e=i.current)||void 0===e||e.forceUpdate())}}),b=function(e,t,n){return O.createElement(Bo.a,null,(function(n){return O.createElement("div",{"data-selection-select":!0,"data-selection-index":t,"data-is-focusable":!0,"data-selection-touch-invoke":!0},O.createElement(Sh,{id:"GroupsListItem-"+(null==e?void 0:e.key),type:"AppLabelProps",forId:"GroupNameInput",label:null==e?void 0:e.name,styles:Ch(n,!!d&&d.key===(null==e?void 0:e.key))}))}))},v=function(){if(r){var e={id:n,parentId:d.key};a.handleQueryGroupOperation(4,e)}else{var t={name:o,extraData:d.key};a.handleQueryAction(0,t)}l({type:rd.Home})},y=function(){l({type:rd.Home})},x=O.useContext(jd).isCancelButtonFirst;return O.createElement(Bo.a,null,(function(e){return O.createElement(Qe.a,{horizontal:!1,verticalAlign:"start",tokens:{childrenGap:12},styles:{root:{padding:"16px",height:"100%"}}},O.createElement(fh,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.QueriesTaskPaneTab,id:"GroupProperties-queriesButton",icon:Object(F.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:function(){l({type:rd.Home})},partialTheme:e}),O.createElement(Qe.a.Item,null,O.createElement(jo.a,{id:"GroupsListTitle",type:"AppLabelProps",label:ExcelPowerqueryTaskpaneStrings.MoveToPageSelectGroup,forId:"groupsList",styles:yh(e)}),O.createElement(Ra.a,{selection:f},O.createElement(Da.a,null,O.createElement(ja.a,{id:"groupsList",items:s,onRenderCell:b,style:xh(e),componentRef:i}))),g&&O.createElement("div",{role:"alert"},O.createElement("p",{className:vh(e)},O.createElement("span",null,ExcelPowerqueryTaskpaneStrings.MoveToConflictNamesErrorMessage.replace(/\{0\}/g,o).replace("{1}",null==d?void 0:d.name))))),kh("MoveToGroup",e,v,y,x,!d||!!g))}))};function wh(e){return function(t){var n,o,r,i,a;return{root:{background:null===(n=e.semanticColors)||void 0===n?void 0:n.inputBackground},fieldGroup:{border:"1px solid",borderColor:t.focused?null===(o=e.semanticColors)||void 0===o?void 0:o.focusBorder:null===(r=e.semanticColors)||void 0===r?void 0:r.inputBorder,boxSizing:"border-box",borderRadius:V.e.roundedCorner2,color:null===(i=e.semanticColors)||void 0===i?void 0:i.inputText,backgroundColor:null===(a=e.semanticColors)||void 0===a?void 0:a.inputBackground},field:{fontSize:"12px",lineHeight:"16px",height:"48px"}}}}function _h(e){var t;return{root:{top:"3px",bottom:"5px",fontSize:"12px",lineHeight:"16px",padding:"0px"},label:{fontWeight:V.l.semibold,color:null===(t=e.semanticColors)||void 0===t?void 0:t.inputText}}}var Ph=function(e){var t=e.label,n=e.name,o=e.description,r=e.errorMessage,i=e.onNameChange,a=e.onDescriptionChange,s=O.createRef(),l=O.createRef(),c=function(e){return function(t){var n;t.which===z.a.escape&&(null===(n=e.current)||void 0===n||n.resetState(),t.stopPropagation(),t.preventDefault())}};return O.useEffect((function(){var e;null===(e=s.current)||void 0===e||e.focus()}),[]),O.createElement(Bo.a,null,(function(e){return O.createElement(O.Fragment,null,O.createElement(Qe.a.Item,null,O.createElement(jo.a,{id:"NameLabel",type:"AppLabelProps",forId:"NameInput",label:t,styles:_h(e)}),O.createElement(Ya.a,{ref:s,id:"NameInput",type:"AppInputProps",value:n,autoComplete:"off",styles:Hu(e),onChange:i,errorMessage:r,onKeyDown:c(s)})),O.createElement(Qe.a.Item,null,O.createElement(jo.a,{id:"DescriptionLabel",type:"AppLabelProps",forId:"DescriptionInput",label:ExcelPowerqueryTaskpaneStrings.PropertiesDescriptionInputLabel,styles:_h(e)}),O.createElement(Ya.a,{ref:l,id:"DescriptionInput",type:"AppInputProps",value:o,autoComplete:"off",styles:wh(e),multiline:!0,resizable:!0,onChange:a,onKeyDown:c(l)})))}))},Rh=function(e){var t=e.id,n=e.originalName,o=e.originalDescription,r=e.groupOperation,i=e.prohibitedNames,a=O.useState(void 0),s=a[0],l=a[1],u=O.useState(n),d=u[0],p=u[1],h=O.useState(o),g=h[0],m=h[1],f=od(),b=ld(),v=function(e){p(e),y(e)},y=O.useCallback((function(e){l(Sd(e,i,n))}),[n,i]),x=function(){if(!s&&d){var e={id:t||"{"+ct()+"}",name:d,description:g,parentId:""};f.handleQueryGroupOperation(r,e),b({type:rd.Home})}},C=function(){b({type:rd.Home})};O.useEffect((function(){void 0!==d&&y(d)}),[d,y]);var S=O.useContext(jd).isCancelButtonFirst;return O.createElement(Bo.a,null,(function(e){return O.createElement(Qe.a,{horizontal:!1,verticalAlign:"start",styles:{root:{padding:"16px",height:"100%"}},tokens:{childrenGap:12}},O.createElement(fh,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.QueriesTaskPaneTab,id:"GroupProperties-queriesButton",icon:Object(F.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:function(){b({type:rd.Home})},partialTheme:e}),O.createElement(Ph,{label:ExcelPowerqueryTaskpaneStrings.GroupNameInputLabel,name:d,description:g,errorMessage:s,onNameChange:v,onDescriptionChange:m}),kh("GroupProperties",e,x,C,S,!(!s&&d)||d===n&&g===o))}))};var Dh={marginInlineStart:12},jh=Object(Po.c)((function(){return Object(V.eb)({fontWeight:"600"})})),Bh=Object(Po.c)((function(){return Object(V.eb)({marginInlineStart:10,fontWeight:400,fontStyle:"italic"})})),Fh={root:{width:"fit-content"}},Lh={root:[{marginBottom:5,marginTop:5,display:"block"}],spinButtonWrapper:{width:60,height:24,boxSizing:"border-box"},labelWrapper:[{height:"auto",minHeight:24,width:"calc(100% - ".concat(64,"px)")},{marginInlineStart:0}]},Mh={root:{marginBottom:5,marginTop:5}},Ah={root:[Mh,{lineHeight:14,marginInlineStart:20}]},Nh=function(e){var t=e.originalName,n=e.originalDescription,o=e.prohibitedNames,r=e.lastRefresh,i=e.queryPropertiesControls,a=O.useState(void 0),s=a[0],l=a[1],u=O.useState(t),d=u[0],p=u[1],h=O.useState(n),g=h[0],m=h[1],f=O.useState(i.isBackgroundRefreshEnabled),b=f[0],v=f[1],y=O.useState(i.isIntervalRefreshEnabled),x=y[0],C=y[1],S=O.useState(i.intervalInMinutes),E=S[0],k=S[1],T=O.useState(i.isRefreshOnOpenEnabled),I=T[0],w=T[1],_=O.useState(i.isRemoveDataEnabled),P=_[0],R=_[1],D=O.useState(i.isRefreshOnRefreshAllEnabled),j=D[0],B=D[1],L=O.useState(i.isFastDataLoadEnabled),M=L[0],A=L[1],N=od(),W=ld(),H=function(e){p(e),z(e)},z=O.useCallback((function(e){l(Cd(t,e,o))}),[t,o]),V=function(){var e={Name:d,Description:g,RefreshControls:{IsBackgroundRefreshEnabled:b,IsIntervalRefreshEnabled:x,IntervalInMinutes:E,IsRefreshOnOpenEnabled:I,IsRemoveDataEnabled:P,IsRefreshOnRefreshAllEnabled:j,IsFastDataLoadEnabled:M}};N.onSetQueryProperties(e),W({type:rd.Home})},G=function(){W({type:rd.Home})};O.useEffect((function(){void 0!==d&&z(d)}),[d,z]);var U={negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberNegativePattern:1,numberGroupSeparator:",",numberGroupSizes:[3]},q=Object(Po.c)((function(e,t,n,o){return[{unitType:e,unitPlaceholder:"{0}",minValue:t,maxValue:n,step:o}]})),Q=O.useContext(jd).isCancelButtonFirst;return O.createElement(Bo.a,null,(function(e){return O.createElement(Qe.a,{horizontal:!1,verticalAlign:"start",styles:{root:{padding:"16px",height:"100%"}},tokens:{childrenGap:12}},O.createElement(fh,{type:"AppButtonProps",label:ExcelPowerqueryTaskpaneStrings.QueriesTaskPaneTab,id:"QueryProperties-queriesButton",icon:Object(F.a)()?c.a.CommonControlChevronRight_12:c.a.CommonControlChevronLeft_12,onExecute:function(){W({type:rd.Home})},partialTheme:e}),O.createElement(Ph,{label:ExcelPowerqueryTaskpaneStrings.QueryNameInputLabel,name:d,description:g,errorMessage:s,onNameChange:H,onDescriptionChange:m}),O.createElement(Qe.a,null,O.createElement(Ge.a,{className:jh()},ExcelPowerqueryTaskpaneStrings.Usage),O.createElement(Qe.a,{style:Dh},O.createElement(Ge.a,{className:Bh()},ExcelPowerqueryTaskpaneStrings.QueryLastRefreshed.replace("{0}",new Date(r).toLocaleString())),void 0!==i.isBackgroundRefreshEnabled&&O.createElement(Xl,{id:"EnableBackgroundRefresh",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStrings.EnableBackgroundRefresh,checked:b,onExecute:function(){return v((function(e){return!e}))},disabled:i.shouldDisableBackgroundRefreshCheckbox,checkmarkIcon:ir.a.checkboxCheckmark,styles:Mh}),void 0!==i.isIntervalRefreshEnabled&&O.createElement(Qe.a,{horizontal:!0,styles:Fh},O.createElement(Xl,{id:"EnableIntervalRefresh",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStrings.RefreshEvery,checked:x,onExecute:function(){return C((function(e){return!e}))},checkmarkIcon:ir.a.checkboxCheckmark,styles:Mh}),O.createElement(su,{id:"IntervalIncrement",type:"AppSpinButtonProps",value:E,onExecute:function(e){k(Number(e.value))},label:ExcelPowerqueryTaskpaneStrings.Minutes,labelPosition:tr.a.end,styles:Lh,disabled:!x,incrementButtonIcon:c.a.CommonControlChevronUp_8,incrementAriaLabel:ExcelRibbonStrings.SpinnerIncrementButtonAriaLabel,decrementButtonIcon:c.a.CommonControlChevronDown_8,decrementAriaLabel:ExcelRibbonStrings.SpinnerDecrementButtonAriaLabel,unitType:"Minutes",validUnits:q("Minutes",1,32767,1),numberFormatInfo:U})),O.createElement(Xl,{id:"EnableRefreshOnOpen",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStrings.RefreshDataOnopen,checked:I,onExecute:function(){return w((function(e){return!e}))},checkmarkIcon:ir.a.checkboxCheckmark,styles:Mh}),void 0!==i.isRemoveDataEnabled&&O.createElement(Xl,{id:"EnableRemoveData",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStrings.RemoveDataFromWorkbook,checked:P,onExecute:function(){return R((function(e){return!e}))},disabled:i.shouldDisableRemoveDataCheckbox,checkmarkIcon:ir.a.checkboxCheckmark,styles:Ah}),O.createElement(Xl,{id:"EnableRefreshOnRefreshAll",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStrings.RefreshOnRefreshAll,checked:j,onExecute:function(){return B((function(e){return!e}))},checkmarkIcon:ir.a.checkboxCheckmark,styles:Mh}),void 0!==i.isFastDataLoadEnabled&&O.createElement(Xl,{id:"EnableFastDataLoad",type:"AppCheckboxProps",label:ExcelPowerqueryTaskpaneStrings.EnableFastDataLoad,checked:M,onExecute:function(){return A((function(e){return!e}))},checkmarkIcon:ir.a.checkboxCheckmark,styles:Mh}))),kh("QueryProperties",e,V,G,Q,!(!s&&d)||d===t&&g===n&&b===i.isBackgroundRefreshEnabled&&x===i.isIntervalRefreshEnabled&&E===i.intervalInMinutes&&I===i.isRefreshOnOpenEnabled&&P===i.isRemoveDataEnabled&&j===i.isRefreshOnRefreshAllEnabled&&M===i.isFastDataLoadEnabled))}))},Wh=(O.createContext(rd.Home),function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(id,{value:this.props.callbacks},O.createElement(cd,null,O.createElement(ad.Consumer,null,(function(t){return e.getPaneBodyComponent(t)}))))},t.prototype.getPaneBodyComponent=function(e){var t,n,o,r,l,c,u,d,p,h,g,m;switch(e.type){case rd.Home:return O.createElement(lh,Object(k.__assign)({},this.props));case rd.GroupProperties:return Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties")?O.createElement(Rh,{groupOperation:e.groupOperation,id:null===(t=e.groupOperationPayload)||void 0===t?void 0:t.id,originalName:null===(n=e.groupOperationPayload)||void 0===n?void 0:n.name,originalDescription:null!==(r=null===(o=e.groupOperationPayload)||void 0===o?void 0:o.description)&&void 0!==r?r:"",prohibitedNames:e.groupSiblingsNames}):O.createElement(bh,{operationType:e.groupOperation,id:null===(l=e.groupOperationPayload)||void 0===l?void 0:l.id,name:null===(c=e.groupOperationPayload)||void 0===c?void 0:c.name,description:null===(u=e.groupOperationPayload)||void 0===u?void 0:u.description,groups:this.props.groups,siblingNames:e.groupSiblingsNames});case rd.QueryProperties:return O.createElement(Nh,{originalName:e.queryOperationPayload.name,originalDescription:null!==(d=e.queryOperationPayload.description)&&void 0!==d?d:"",prohibitedNames:null!==(h=null===(p=this.props.queries)||void 0===p?void 0:p.map((function(e){return null==e?void 0:e.name})))&&void 0!==h?h:[],lastRefresh:e.queryPropertiesPayload.lastRefresh,queryPropertiesControls:e.queryPropertiesPayload.propertiesControls});case rd.MoveToGroup:return O.createElement(Ih,{groups:this.props.groups,movingObjectId:null===(g=e.groupOperationPayload)||void 0===g?void 0:g.id,movingObjectName:null===(m=e.groupOperationPayload)||void 0===m?void 0:m.name,isGroupMoving:e.isGroupMoving});default:return i.a.sendTraceTag(520447842,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.render: Unknown pane type."),O.createElement("div",null)}},t}(O.Component)),Hh=function(){function e(){var e=this;this.groupIdLookupDictionary={},this.groupChildrenDictionary={},this.groupQueriesDictionary={},this.queriesInfo=null,this.groupsInfo=null,this.connectionsInfo=null,this.build=function(t,n,o){var r;if(e.groupChildrenDictionary={},e.groupIdLookupDictionary={},e.groupQueriesDictionary={},e.queriesInfo=null,e.groupsInfo=null,e.connectionsInfo=o,t)if(e.queriesInfo=[],n&&n.length){e.groupsInfo=[];var i=e.cloneTaskPaneData(n,t);e.prepareGroupsDataForTaskPane(i.groups),e.prepareQueriesDataForTaskPane(i.queries),e.groupsInfo=null===(r=e.createGroupInfoForGroup("root",-1).children)||void 0===r?void 0:r.concat(e.createGroupInfoForGroup("Other Queries",0))}else e.queriesInfo=t;return{queries:e.queriesInfo,groups:e.groupsInfo,connections:e.connectionsInfo}}}return e.prototype.cloneTaskPaneData=function(e,t){var n=this,o=[],r=[];return t.forEach((function(e){o.push(n.cloneQueryInfo(e))})),e.forEach((function(e){r.push(n.cloneGroupInfo(e))})),{queries:o,groups:r}},e.prototype.prepareGroupsDataForTaskPane=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t],r="{00000000-0000-0000-0000-000000000000}"===o.parentKey?"root":o.parentKey;this.groupIdLookupDictionary[o.key]=o,this.appendChildGroupToParent(o,r)}var i={};i.name=ExcelPowerqueryTaskpaneStrings.OtherQueriesGroupName,i.key="Other Queries",i.order=Number.MAX_VALUE,this.groupIdLookupDictionary["Other Queries"]=i;var a={name:"root",key:"root",order:0};this.groupIdLookupDictionary.root=a},e.prototype.prepareQueriesDataForTaskPane=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t],r=o.groupKey||"Other Queries",i=this.groupChildrenDictionary[r];if("Other Queries"!==r&&i&&i.length){var a="SubGroupOtherQueries-"+r;if(!this.groupIdLookupDictionary[a]){var s={};s.name=a,s.key=a,s.order=Number.MAX_VALUE,this.groupIdLookupDictionary[a]=s,this.appendChildGroupToParent(s,r)}r=a,o.groupKey=a}this.groupQueriesDictionary[r]?this.groupQueriesDictionary[r].push(o):this.groupQueriesDictionary[r]=[o]}},e.prototype.appendChildGroupToParent=function(e,t){var n=[e];this.groupChildrenDictionary[t]&&(n=n.concat(this.groupChildrenDictionary[t])),this.groupChildrenDictionary[t]=n},e.prototype.createGroupChildrenForGroup=function(e,t){var n=this,o=[];if(this.groupChildrenDictionary[e]){var r=this.groupChildrenDictionary[e];r.sort((function(e,t){return n.numberCompare(e.order,t.order)}));for(var i=0,a=r;i<a.length;i++){var s=a[i];o=o.concat(this.createGroupInfoForGroup(s.key,t+1))}}return o},e.prototype.createGroupInfoForGroup=function(e,t){var n,o,r,i=this.groupIdLookupDictionary[e],a=this.createGroupChildrenForGroup(e,t);i.children=this.cloneGroupInfoArray(a),i.level=t,i.count=0,i.children.length&&(i.startIndex=i.children[0].startIndex,i.count=i.children.reduce((function(e,t){return e+(t?t.count:0)}),i.count));var s=this.groupQueriesDictionary[e];return s&&(i.startIndex=null!==(o=null===(n=this.queriesInfo)||void 0===n?void 0:n.length)&&void 0!==o?o:-1,i.count+=s.length,this.queriesInfo=null===(r=this.queriesInfo)||void 0===r?void 0:r.concat(this.createReactQueryInfoArray(s,e.includes("SubGroupOtherQueries-")?t:t+1))),i},e.prototype.createReactQueryInfoArray=function(e,t){if(!e)return e;var n=e;return n.forEach((function(e){e.nestingDepth=t})),n},e.prototype.cloneGroupInfoArray=function(e){var t=this,n=[];return null==e||e.forEach((function(e){var o=t.cloneGroupInfo(e);o.children=t.cloneGroupInfoArray(e.children),n.push(o)})),n},e.prototype.cloneGroupInfo=function(e){var t={};return t.key=e.key,t.name=e.name,t.count=e.count,t.startIndex=e.startIndex,t.data=e.data,t.parentKey=e.parentKey,t.children=[],t.level=e.level,t.order=e.order,t},e.prototype.cloneQueryInfo=function(e){var t={};return t.fillObjectType=e.fillObjectType,t.groupKey=e.groupKey,t.inRefresh=e.inRefresh,t.lastRefresh=e.lastRefresh,t.loadedToDataModel=e.loadedToDataModel,t.name=e.name,t.nestingDepth=e.nestingDepth,t.queryError=e.queryError,t.refreshEnabled=e.refreshEnabled,t.rowsLoaded=e.rowsLoaded,t.rowsWithError=e.rowsWithError,t.currentRunningOperation=e.currentRunningOperation,Object(yt.isChangeGateEnabled)("OfficeVSO:8207354_PowerQueryGettingQueryDescriptionEnabled")&&(t.description=e.description,t.propertiesControls=this.cloneQueryPropertiesControls(e.propertiesControls)),t},e.prototype.cloneQueryPropertiesControls=function(e){var t={};return e&&(t.intervalInMinutes=e.intervalInMinutes,t.isBackgroundRefreshEnabled=e.isBackgroundRefreshEnabled,t.isFastDataLoadEnabled=e.isFastDataLoadEnabled,t.isIntervalRefreshEnabled=e.isIntervalRefreshEnabled,t.isRefreshOnOpenEnabled=e.isRefreshOnOpenEnabled,t.isRefreshOnRefreshAllEnabled=e.isRefreshOnRefreshAllEnabled,t.isRemoveDataEnabled=e.isRemoveDataEnabled,t.shouldDisableBackgroundRefreshCheckbox=e.shouldDisableBackgroundRefreshCheckbox,t.shouldDisableRemoveDataCheckbox=e.shouldDisableRemoveDataCheckbox),t},e.prototype.numberCompare=function(e,t){return e>t?1:e<t?-1:0},e}(),zh=function(e){function t(n){var o=e.call(this,n)||this;return o.ariaNotifierRef=O.createRef(),o.dragAndDropEnabled=o.props.isPowerQueryEditEnabled,o.callbacks=o.dragAndDropEnabled?Object(k.__assign)(Object(k.__assign)({},o.props.callbacks),{onCancelKeyboardReorder:function(){o.setState({localPaneData:t.taskPaneDataFactory.cloneTaskPaneData(o.props.groups,o.props.queries)})}}):o.props.callbacks,o.paneDataUpdate=function(e){},o.buildTaskPaneData=function(e,n,o){return t.taskPaneDataFactory.build(n,e,o)},t.taskPaneDataFactory=new Hh,o.props.queries&&o.props.groups?o.state={localPaneData:t.taskPaneDataFactory.cloneTaskPaneData(o.props.groups,o.props.queries)}:o.state={localPaneData:{queries:null,groups:null}},o.writeSearchTelemetry=!0,o}return Object(k.__extends)(t,e),t.prototype.announceMessage=function(e){var t=this.ariaNotifierRef.current;(null==t?void 0:t.firstChild)&&t.removeChild(t.firstChild);var n=document.createElement("div");n.setAttribute("role","status"),n.setAttribute("aria-label",e),n.setAttribute("aria-live","assertive"),null==t||t.appendChild(n)},t.prototype.componentDidCatch=function(e,t){i.a.sendTraceTag(509872347,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane: component failed to render: ".concat(t.componentStack)),xp.error(508924356,{eventName:cp(rp.PowerQuery),dataFields:[Object(up.a)("Render.Failed",!0),Object(up.d)("Render.Stack",t.componentStack)],eventFlags:Sp(tp.DataCategories.ProductServiceUsage,tp.DiagnosticLevel.RequiredServiceData,tp.SamplingPolicy.CriticalBusinessImpact)})},t.getDerivedStateFromProps=function(e){return e.queries&&e.groups?{localPaneData:t.taskPaneDataFactory.cloneTaskPaneData(e.groups,e.queries)}:{localPaneData:{queries:null,groups:null}}},t.prototype.render=function(){var e=this;return this.paneDataUpdate=this.context.bind(this),O.createElement(Fu,null,O.createElement(ju.Consumer,null,(function(t){return O.createElement("div",null,O.createElement("div",{ref:e.ariaNotifierRef}),O.createElement("div",null,e.getTaskPaneJSX(t)))})))},t.prototype.getTaskPaneJSX=function(e){var t,n,o,r,l,c=null===(t=null==e?void 0:e.searchValue)||void 0===t?void 0:t.toLocaleLowerCase(),u=this.dragAndDropEnabled&&(null==e?void 0:e.draggedQueryName)?null===(n=this.state.localPaneData)||void 0===n?void 0:n.queries:this.props.queries;if(c&&(u=null===(o=this.props.queries)||void 0===o?void 0:o.filter((function(e){var t;return null===(t=null==e?void 0:e.name)||void 0===t?void 0:t.toLocaleLowerCase().includes(c)})),this.writeSearchTelemetry&&c&&(i.a.sendTraceTag(512328398,a.a.msoulscat_ES_EWAJS,s.a.Info,"PowerQueryTaskPane - Search queries in a session"),this.writeSearchTelemetry=!1)),this.dragAndDropEnabled&&(null==e?void 0:e.draggedQueryName)){var d=null==u?void 0:u.findIndex((function(t){return t.name===e.draggedQueryName}));if(-1===d)i.a.sendTraceTag(509872346,a.a.msoulscat_ES_EWAJS,s.a.Error,"PowerQueryTaskPane.getTaskPaneJSX: cannot find dragged or dropped query indexes.");else{var p=u[d],h=e.hoveredQueryName?null==u?void 0:u.findIndex((function(t){return t.name===e.hoveredQueryName})):-1;-1!==h&&(u.splice(d,1),u.splice(h,0,p)),null!=e.groupKey?(this.announceMessage(ExcelPowerqueryTaskpaneStrings.QueryReorderOutsideGroup.replace("{0}",e.draggedQueryName).replace("{1}",null===(l=null===(r=this.props.groups)||void 0===r?void 0:r.find((function(t){return(null==t?void 0:t.key)===e.groupKey})))||void 0===l?void 0:l.name).replace("{2}",h.toString())),p.groupKey=e.groupKey):this.announceMessage(ExcelPowerqueryTaskpaneStrings.QueryReorder.replace("{0}",e.draggedQueryName).replace("{1}",h.toString())),i.a.sendTraceTag(509872345,a.a.msoulscat_ES_EWAJS,s.a.Info,"PowerQueryTaskPane - Drag and drop was executed, while search has value :"+!!c)}}var g=this.buildTaskPaneData(this.props.groups,u,this.props.connections);return O.createElement(Wh,{queries:g.queries,groups:g.groups,callbacks:this.callbacks,connections:g.connections,selectedQueryKey:this.props.selectedQueryKey,type:this.props.type,searchValue:null==e?void 0:e.searchValue,isAADDocumentHost:this.props.isAADDocumentHost,isPowerQueryEditEnabled:this.props.isPowerQueryEditEnabled,isPowerQueryTaskPaneConnectionActionsEnabled:this.props.isPowerQueryTaskPaneConnectionActionsEnabled,isDocumentStructureLocked:this.props.isDocumentStructureLocked})},t}(O.Component);zh.contextType=Bu;var Vh,Gh,Uh,qh,Qh,Kh,Jh,Zh,Yh,Xh,$h,eg,tg=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.PivotTableSettingsAltTextSectionHeader,divId:"slicerAltTextSection",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"slicerAltTextSection",className:Nc(!this.props.isCollapsed)},O.createElement(Ge.a,{className:Hc()},ExcelRibbonStrings.SlicerSettingsAltTextSectionDescription),O.createElement(Jc,{id:"altTextTitle",label:ExcelRibbonStrings.PivotTableSettingsAltTextTitle,hideLabel:!1,value:this.props.altTextTitle,multiline:!1,disabled:!1,actionType:14,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(Jc,{id:"altTextDescription",label:ExcelRibbonStrings.PivotTableSettingsAltTextDescription,hideLabel:!1,value:this.props.altTextDescription,multiline:!0,disabled:!1,actionType:15,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})))},t}(O.PureComponent),ng=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.SlicerSettingsPropertiesSectionHeader,divId:"slicerProperties",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"slicerProperties",className:Nc(!this.props.isCollapsed)},O.createElement(eu,{label:ExcelRibbonStrings.SlicerSettingsPrintObject,id:"slicerPrintObject",checked:this.props.printObject,actionType:12,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),O.createElement(eu,{label:ExcelRibbonStrings.SlicerSettingsLock,id:"slicerLocked",checked:this.props.isLocked,actionType:13,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1})))},t}(O.PureComponent),og={root:{marginTop:"24px",selectors:{".ms-ChoiceField-wrapper":{minHeight:"24px",marginTop:0},".ms-ChoiceField":[_c,{minHeight:"24px"}],".ms-ChoiceField .ms-ChoiceFieldLabel":[Tc,{fontSize:"12px",paddingLeft:"22px"}],".ms-ChoiceField-field::before, .ms-ChoiceField-field:hover::before":{width:"16px",height:"16px",top:"2px"},".ms-ChoiceField-field:hover::after, .ms-ChoiceField-field:focus::after, .ms-ChoiceField-field.is-checked::after":{width:"8px",height:"8px",top:"6px",left:"4px"},".ms-ChoiceField-field.is-checked::after":{borderWidth:"4px"}}}},rg=n(2349),ig=function(e){function t(t){var n=e.call(this,t)||this;return n.onChoiceChange=n.onChoiceChange.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(rg.a,{id:this.props.id,selectedKey:this.props.selectedKey,options:this.props.options,styles:og,onChange:this.onChoiceChange})},t.prototype.onChoiceChange=function(e,t){void 0!==t&&(this.props.onSettingChangeWithFloatV2?this.props.onSettingChangeWithFloatV2(this.props.actionType,null,Number(t.key),0,null):this.props.onSettingChangeWithFloat&&this.props.onSettingChangeWithFloat(this.props.actionType,"",Number(t.key),0))},t}(O.Component),ag=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=Bc();return O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.SlicerSettingsSizePositionSectionHeader,divId:"sizeAndPositionSection",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:this.props.type,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"sizeAndPositionSection",className:Nc(!this.props.isCollapsed)},O.createElement("div",{className:e.firstRoot},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.SlicerSettingsButtonSettingsGroupHeader),O.createElement(lu,{id:"buttonsPerRow",value:this.props.buttonsPerRow,min:1,max:2e4,step:1,stepPrecision:0,label:ExcelRibbonStrings.SlicerSettingsButtonNumberPerRow,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!0,precision:0,unit:"None",actionType:3,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(lu,{id:"buttonHeight",value:this.props.buttonHeight,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsHeight,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:4,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(lu,{id:"buttonWidth",value:this.props.buttonWidth,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsWidth,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:5,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),O.createElement("div",{className:e.root},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.SlicerSettingsSlicerSizeGroupHeader),O.createElement(lu,{id:"slicerHeight",value:this.props.slicerHeight,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsHeight,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:6,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(lu,{id:"slicerWidth",value:this.props.slicerWidth,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsWidth,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:7,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),O.createElement("div",{className:e.root},O.createElement(Ge.a,{className:e.label},ExcelRibbonStrings.SlicerSettingsSlicerPositionGroupHeader),O.createElement(lu,{id:"horizontalPosition",value:this.props.horizontal,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsHorizontalPosition,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:8,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(lu,{id:"verticalPosition",value:this.props.vertical,min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsVerticalPosition,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:"Inch",actionType:9,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),O.createElement(eu,{label:ExcelRibbonStrings.SlicerSettingsDisableResizeAndMove,id:"disableResizeAndMove",checked:this.props.disableResizeAndMove,actionType:10,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),O.createElement(ig,{id:"slicerAnchorType",actionType:11,selectedKey:this.props.slicerAnchorType.toString(),options:[{key:(0).toString(),text:ExcelRibbonStrings.SlicerSettingsMoveAndSizeWithCells},{key:1..toString(),text:ExcelRibbonStrings.SlicerSettingsMoveButDoNotSizeWithCells},{key:2..toString(),text:ExcelRibbonStrings.SlicerSettingsDoNotMoveOrSizeWithCells}],onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})))},t}(O.PureComponent),sg=function(e){function t(t){return e.call(this,t)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.pivotTableConnections;return!e||e.length<=0?null:O.createElement("div",null,O.createElement(zc,{displayName:ExcelRibbonStrings.SlicerSettingsPivotTableConnectionsSectionHeader,divId:"pivotTableConnections",paneId:"slicerSettings",collapse:this.props.isCollapsed,type:3,onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement("div",{id:"pivotTableConnections",className:Wc(!this.props.isCollapsed)},O.createElement(Pu,{items:e,columns:Ou,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,listType:"pivotTableConnections"})))},t}(O.PureComponent),lg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t;this.props.needFocusOnFirstElement&&this.props.needFocusOnFirstElement!==e.needFocusOnFirstElement&&(null===(t=document.getElementById("slicerCaption"))||void 0===t||t.focus())},t.prototype.render=function(){var e=this.props.settingsInfo;return null!=e&&O.createElement("div",{className:Mc()},O.createElement("div",{className:Fc()},O.createElement(Jc,{id:"slicerCaption",label:ExcelRibbonStrings.SlicerSettingsTitle,hideLabel:!1,value:e.caption,multiline:!1,disabled:!1,actionType:1,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(eu,{id:"displaySlicerHeader",label:ExcelRibbonStrings.SlicerSettingsShowHeader,checked:e.displayHeader,actionType:2,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),O.createElement(Ge.a,{className:Lc()},"".concat(ExcelRibbonStrings.SlicerSettingsDataSource,":   ").concat(e.dataSource)),O.createElement(Ge.a,{className:Lc()},"".concat(ExcelRibbonStrings.SlicerSettingsName,":   ").concat(e.name))),O.createElement(ag,{buttonsPerRow:e.buttonsPerRow,buttonHeight:e.buttonHeight,buttonWidth:e.buttonWidth,slicerHeight:e.height,slicerWidth:e.width,horizontal:e.horizontalPosition,vertical:e.verticalPosition,disableResizeAndMove:e.disableResizeAndMove,slicerAnchorType:e.anchorType,isSlicerSwitched:this.props.isSlicerSwitched,type:1,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[1],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(ng,{printObject:e.printObject,isLocked:e.locked,type:0,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[0],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),O.createElement(sg,{pivotTableConnections:e.pivotTableConnections,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,type:3,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[3],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState}),O.createElement(tg,{altTextTitle:e.altTextTitle,altTextDescription:e.altTextDescription,isSlicerSwitched:this.props.isSlicerSwitched,type:2,isCollapsed:!!this.props.sectionCollapseStates&&this.props.sectionCollapseStates[2],onSaveSectionCollapseState:this.props.onSaveSectionCollapseState,onSettingChangeWithFloatV2:this.props.onSettingChangeWithFloatV2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}))},t}(O.Component),cg=Object(Po.c)((function(){return Object(V.db)({taskPaneContent:{height:"100%",width:"100%",border:"none"},appForOfficeContainer:{marginTop:"0 !important",zIndex:899}})})),ug="ocv-inapp-feedback",dg=n(581);!function(e){e.Smile="Smile",e.Frown="Frown",e.Idea="Idea",e.Unclassified="Unclassified"}(Vh||(Vh={})),function(e){e.Undefined="Undefined",e.MinorWithoutParentalConsent="MinorWithoutParentalConsent",e.MinorWithParentalConsent="MinorWithParentalConsent",e.NotAdult="NotAdult",e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired"}(Gh||(Gh={})),function(e){e.MSA="MSA",e.AAD="AAD",e.Unauthenticated="Unauthenticated"}(Uh||(Uh={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.NotConfigured="Not Configured"}(qh||(qh={})),function(e){e.JPEG="jpeg",e.PNG="png"}(Qh||(Qh={})),function(e){e.Landscape="Landscape",e.Potrait="Potrait"}(Kh||(Kh={})),function(e){e.AutoCapture="AutoCapture",e.AutoCaptureWithHtml2Canvas="AutoCaptureWithHtml2Canvas",e.ProvidedAtInitialization="ProvidedAtInitialization",e.DynamicallyProvided="DynamicallyProvided"}(Jh||(Jh={})),function(e){e.SidePane="SidePane",e.Modal="Modal",e.NoSurface="NoSurface",e.CallOut="CallOut",e.NoSurfaceWithoutTitle="NoSurfaceWithoutTitle"}(Zh||(Zh={})),function(e){e.Windows="Windows",e.IOS="iOS",e.Android="Android",e.WacTaskPane="WacTaskPane",e.MacOS="MacOS",e.Web="Web"}(Yh||(Yh={})),function(e){e[e.Undefined=0]="Undefined",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(Xh||(Xh={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD",e[e.Unauthenticated=2]="Unauthenticated"}($h||($h={})),function(e){e[e.NotConfigured=0]="NotConfigured",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(eg||(eg={}));var pg=function(e){switch(e){case Xh.MinorWithoutParentalConsent:return Gh.MinorWithoutParentalConsent;case Xh.MinorWithParentalConsent:return Gh.MinorWithParentalConsent;case Xh.NotAdult:return Gh.NotAdult;case Xh.Adult:return Gh.Adult;case Xh.MinorNoParentalConsentRequired:return Gh.MinorNoParentalConsentRequired;case Xh.Undefined:default:return Gh.Undefined}},hg=function(e){switch(e){case $h.MSA:return Uh.MSA;case $h.AAD:return Uh.AAD;case $h.Unauthenticated:default:return Uh.Unauthenticated}},gg=function(e){switch(e){case eg.Enabled:return qh.Enabled;case eg.Disabled:return qh.Disabled;case eg.NotConfigured:default:return qh.NotConfigured}};function mg(e,t,n){var o={timestamp:Date.now(),message:e,stepName:t,clientFeedbackId:n};return JSON.stringify(o)}function fg(e){var t,n,o,r,i={centroEnvironmentBaseUrl:"https://admin.microsoft.com",centroAdapters:{runtimeStaticConfig:(n=e.clientName,o=xg(null===(t=e.feedbackConfig)||void 0===t?void 0:t.appData).Language,r=e.clientFeedbackId,{hostName:n?yg(n):"OfficeWacFeedback",locale:(null==o?void 0:o.toLowerCase())||"en-us",appId:r,perfPrefix:"Wac".concat(n,"OcvFeedback")}),request:function(){}},centroHvcData:"",forHostVersion:"v2"};if(function(e){return"WacDemoApp"===e||window.origin.includes(".europe.corp.microsoft.com")}(e.clientName)){i.centroHvcData='{"ocv-inapp-feedback":{"cdnUrl":"https://localcdn.centro-dev.com:5555/","loaderSpec":{"type":"scriptUrl",\n      "content":"https://localcdn.centro-dev.com:5555/ocv-inapp-feedback.en.bundle.js"},"version":"localdevbox"},\n      "__hostApp_config":{"ariaLoggerId":"ea84b6a3285140258eaeb7caaab5884a-9d3ca75b-b3ee-42b8-a22c-ab0759ad4d38-7330",\n      "hostingAppUrls":"{\\"M365AdminPortal\\":\\"https://portal-sdf.office.com\\",\\"EXOAdminPortal\\":\\"https://admin-sdf.exchange.microsoft.com\\",\\"SPOAdminPortal\\":\\"https://admin.microsoft.com/sharepoint\\",\\"TeamsAdminPortal\\":\\"https://admin-dev.teams.microsoft.net/\\",\\"MSGraphEndPoint\\":\\"https://graph.microsoft.com\\"}"}}'}return i}var bg,vg,yg=function(e){switch(e.toLowerCase()){case"word":return"OfficeWacWordFeedback";case"excel":return"OfficeWacExcelFeedback";case"powerpoint":return"OfficeWacPowerpointFeedback";case"visio":return"OfficeWacVisioFeedback";case"onenote":return"OfficeWacOnenoteFeedback";default:return"OfficeWacFeedback"}},xg=function(e){try{return JSON.parse(e.replaceAll("\\",""))}catch(e){return void i.a.sendTraceTag(507901579,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Error in parsing app data for feedback at parseApplicationData","parseApplicationData"))}},Cg=function(e,t){return!(!e.showFeedbackButton||e.policyAllowFeedback===eg.Disabled)||(i.a.sendTraceTag(507901578,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Centro Initialization failed: showFeedbackButton is disabled",t,e.clientFeedbackId)),!1)};function Sg(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function Eg(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){return[2,new Promise((function(t,n){var o=document.createElement("script");o.src=e.content,o.onload=function(){t()},o.onerror=function(){n(new Error("Dynamically loading script "+e.content+" failed"))},Sg(o,e.attributes),document.body.appendChild(o)}))]}))}))}function kg(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){return[2,new Promise((function(t){var n=document.createElement("script"),o=document.createTextNode(e.content);n.appendChild(o),Sg(n,e.attributes),document.body.appendChild(n),t()}))]}))}))}function Og(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){return[2,new Promise((function(t,n){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=e.content,o.onload=function(){t()},o.onerror=function(){n(new Error("Dynamically loading style "+e.content+" failed"))},Sg(o,e.attributes),document.head.appendChild(o)}))]}))}))}function Tg(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){return[2,new Promise((function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var o=document.createTextNode(e.content);n.appendChild(o),Sg(n,e.attributes),document.head.appendChild(n),t()}))]}))}))}function Ig(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r,i,a,s;return Object(k.__generator)(this,(function(l){switch(l.label){case 0:switch(e.type){case"parallel":return[3,1];case"sequential":return[3,5];case"scriptUrl":return[3,16];case"script":return[3,18];case"styleUrl":return[3,20];case"style":return[3,22]}return[3,24];case 1:return l.trys.push([1,3,,4]),[4,Promise.all(e.children.map(Ig))];case 2:return l.sent(),[3,4];case 3:if(t=l.sent(),!e.optional)throw t;return console.log("Dynamic loading of optional script failed",t),[3,4];case 4:return[2];case 5:l.trys.push([5,14,,15]),l.label=6;case 6:l.trys.push([6,11,12,13]),n=Object(k.__values)(e.children),o=n.next(),l.label=7;case 7:return o.done?[3,10]:[4,Ig(o.value)];case 8:l.sent(),l.label=9;case 9:return o=n.next(),[3,7];case 10:return[3,13];case 11:return r=l.sent(),a={error:r},[3,13];case 12:try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 13:return[3,15];case 14:if(i=l.sent(),!e.optional)throw i;return console.log("Dynamic loading of optional script failed",i),[3,15];case 15:return[2];case 16:return[4,Eg(e)];case 17:return l.sent(),[2];case 18:return[4,kg(e)];case 19:return l.sent(),[2];case 20:return[4,Og(e)];case 21:return l.sent(),[2];case 22:return[4,Tg(e)];case 23:return l.sent(),[2];case 24:throw new Error("Invalid script loader object "+JSON.stringify(e))}}))}))}!function(e){e.Info="Info",e.Error="Error",e.Analytics="Analytics",e.Performance="Performance",e.Interface="Interface",e.Availability="Availability",e.Reliability="Reliability"}(bg||(bg={})),function(e){e.ClientInfo="ClientInfo",e.ClientError="ClientError",e.ClientAnalytics="ClientAnalytics",e.ClientPerformance="ClientPerformance",e.ClientAvailability="ClientAvailability",e.ClientReliability="ClientReliability"}(vg||(vg={}));var wg=new Map;function _g(e,t){if(wg.has(e))throw new Error("Logger "+e+" already exists");wg.set(e,t)}var Pg,Rg,Dg=function(e){!function e(t,n){n.forEach((function(o,r){try{o(t)}catch(t){var i=new Map(n);i.delete(r),e({id:"500294",type:bg.Error,logCategory:vg.ClientError,message:"Failure in logger: "+r,error:t},i)}}))}(e,wg)};!function(e){e.M365AdminPortal="M365AdminPortal",e.SPOAdminPortal="SPOAdminPortal",e.SPOPortal="SPOPortal",e.EXOAdminPortal="EXOAdminPortal",e.TeamsAdminPortal="TeamsAdminPortal",e.SecurityPortal="SecurityPortal",e.CompliancePortal="CompliancePortal",e.M365SCCPortal="M365SCCPortal",e.SupportCentral="SupportCentral",e.IbizaMTMPortal="IbizaMTMPortal",e.CloudCostManagementPortal="CloudCostManagementPortal",e.Rave="Rave",e.DynamicsPortal="DynamicsPortal",e.TeamsApp="TeamsApp",e.M365DefenderSMB="M365DefenderSMB",e.Windows365Portal="Windows365Portal",e.TeamsHarness="TeamsHarness",e.PPACAdminPortal="PPACAdminPortal"}(Pg||(Pg={})),function(e){e.Static="centro.runtime.static"}(Rg||(Rg={}));var jg,Bg=void 0;!function(e){e[e.Trace=0]="Trace",e[e.Info=1]="Info",e[e.Comment=2]="Comment",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(jg||(jg={}));var Fg=!0;function Lg(e,t,n,o){var r=[],i=0,a=e,s=t,l=n,c=o,u=function(){if(0===r.length||Fg)setTimeout(u,1e3);else{var e=new XMLHttpRequest;e.open("POST",s,!0),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("x-ms-mac-hostingapp",l),e.setRequestHeader("x-ms-mac-appid",a),e.setRequestHeader("x-ms-mac-version",c),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&(204!==e.status&&console.log("Request to /api/instrument/logclient failed, server responseCode: "+e.status+" body: "+e.response),setTimeout(u,1e3))};var t=r.splice(0,r.length);e.send(JSON.stringify(t))}};setTimeout(u,1e3);var d=function(e){r.push(e)};return function(e){if(e.type!==bg.Analytics&&!function(e){return e.type===bg.Performance}(e)){i+=1;var t=parseInt(e.id,10),n=e.message||"",o="",r="";try{if(null!==(o=function(){if(void 0===Bg)throw new Error("History object has not been set");return Bg}().location.pathname)&&-1!==o.indexOf(":")){var s=o.split(":");o=s[0],r=s[1]}}catch(e){o="",r=""}if(d({TagId:t,LogLevel:jg.Info,LogCategory:e.logCategory||vg.ClientInfo,Message:n,Adhoc0:a,Adhoc1:i.toString(),Adhoc2:JSON.stringify({data:e.data}),Adhoc5:r,PageName:o}),function(e){return e.type===bg.Error}(e)){var l=e.error.stack||"";d({TagId:500781,LogLevel:jg.Error,LogCategory:e.logCategory||vg.ClientError,Message:"UI Exception: "+(e.error.message||""),Adhoc0:a,Adhoc1:i.toString(),Adhoc2:JSON.stringify({version:c,stack:l}),Adhoc3:t.toString(),Adhoc5:r,PageName:o})}}}}function Mg(e,t){if(!e){var n=new Error(t);throw Dg({type:bg.Error,message:t,id:"508371",error:n}),n}}function Ag(e){return void 0===window?(Dg({type:bg.Info,message:"window is undefined",id:"512105"}),!1):void 0===window.m365_admin_features?(Dg({type:bg.Info,message:"window.m365_admin_features is undefined",id:"512108"}),!1):void 0!==window.m365_admin_features.initializers&&void 0!==window.m365_admin_features.initializers[e]}function Ng(e){var t,n;return!!(null===(n=null===(t=window.m365_admin_features)||void 0===t?void 0:t.locDbg)||void 0===n?void 0:n[e])}var Wg=void 0,Hg=void 0,zg=void 0,Vg=!1,Gg=!1,Ug=void 0;function qg(e){return void 0===e&&(e=""),Object(k.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:if(void 0===zg)throw t=new Error("attempting to getUxVersionData before adapters were provided"),Dg({type:bg.Error,message:t.message,error:t,id:"508373"}),t;return n=Wg+"/admin/api/uxversion"+e,[4,new Promise((function(e,t){var o=new XMLHttpRequest;o.open("GET",n,!0),o.setRequestHeader("x-ms-mac-locale",zg.runtimeStaticConfig.locale),o.setRequestHeader("x-ms-mac-hostingapp",zg.runtimeStaticConfig.hostName),o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE){var r=o.getResponseHeader("x-ms-correlation-id");if(200!==o.status){var i="Request to "+n+" failed, server responseCode: "+o.status+" body: "+o.response+" correlationId: "+r,a=new Error(i);t(a)}e(function(e){if(void 0!==e&&e.hasOwnProperty("__hostApp_config"))for(var t in e)t.startsWith("__")||(e[t.toLowerCase()]=e[t],t.toLowerCase()!==t&&delete e[t]);return JSON.stringify(e)}(JSON.parse(o.response)))}},o.send()}))];case 1:return[2,o.sent()]}}))}))}function Qg(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return Ug?[2]:(t=(e=JSON).parse,[4,qg("?locdbg=true")]);case 1:return Ug=t.apply(e,[n.sent()]),[2]}}))}))}function Kg(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t,o,r,i,a,s,l,c,u,d,p,h;return Object(k.__generator)(this,(function(g){switch(g.label){case 0:t=e.centroEnvironmentBaseUrl,o=e.centroAdapters,r=e.centroHvcData,Mg(!!t,"centroEnvironmentBaseUrl is missing"),Mg(!!o,"centroAdapters is missing"),(zg=o).runtimeStaticConfig.appId||(zg.runtimeStaticConfig.appId="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))),i=zg.runtimeStaticConfig.appId,a=zg.runtimeStaticConfig.hostName,g.label=1;case 1:return g.trys.push([1,5,,6]),Vg?(Dg({type:bg.Info,message:"initialize() is called but loader is already previously initialized",id:"508375"}),[2]):(Wg="/"===t.substring(t.length-1)?t.substring(0,t.length-1):t,s=n(2478),l=Wg+"/api/instrument/logclient",Gg||(_g("hvcLoaderKustoLogger",Lg(i,l,a,s.name+"_"+s.version)),Fg=!1,void 0!==(c=zg.additionalLoggers)&&Object.keys(c).forEach((function(e){_g(e,c[e])})),Gg=!0),u=performance.now(),r?(Dg({type:bg.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:r}),Hg=JSON.parse(r),[3,4]):[3,2]);case 2:if(e.forHostVersion&&e.hvcVersion)throw new Error("cannot specify both forHostVersion and hvcVersion");return d="",e.forHostVersion?d="?bldVer="+encodeURIComponent(e.forHostVersion):e.hvcVersion&&(d="?pkgver="+encodeURIComponent(e.hvcVersion)),[4,qg(d)];case 3:p=g.sent(),Dg({type:bg.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:p}),Hg=JSON.parse(p),g.label=4;case 4:return Vg=!0,Dg({type:bg.Info,message:"hvcloader initialze() step has succeeded",id:"513574",data:{eventName:"hvcLoader_Initialize_step",fromStart:performance.now()-u,UA:navigator.userAgent}}),[3,6];case 5:throw h=g.sent(),Dg({type:bg.Error,message:"hvcloader initialze() step has failed "+h.message,id:"508376",error:h}),h;case 6:return[2]}}))}))}function Jg(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r;return Object(k.__generator)(this,(function(i){switch(i.label){case 0:t=Hg,i.label=1;case 1:if(i.trys.push([1,7,,8]),!Vg)throw new Error("initialize() needs to be invoked before calling preloadFeature()");return n=performance.now(),e.localMode?[4,Qg()]:[3,3];case 2:i.sent(),t=Ug,i.label=3;case 3:if(!t)throw new Error("uxVersionData is not populated");return o=e.featureName.toLowerCase(),t[o]?Ag(o)&&Ng(o)===!!e.localMode?(Dg({type:bg.Info,message:"preloadFeature() feature "+o+" already loaded previously",id:"508465",data:{hvc:o}}),[3,6]):[3,4]:(Dg({type:bg.Info,message:"HVC "+o+" is not enabled for this host",id:"508419"}),[2,!1]);case 4:return[4,Ig(t[o].loaderSpec)];case 5:if(i.sent(),!Ag(o))throw new Error("preloadFeature(): global is not populated after loading for "+o);void 0===window.m365_admin_features.locDbg&&(window.m365_admin_features.locDbg={}),window.m365_admin_features.locDbg[o]=!!e.localMode,i.label=6;case 6:return Dg({type:bg.Info,message:"preloadFeatures() step has succeeded",id:"513585",data:{hvc:o,uxdata:JSON.stringify(t),eventName:"preloadFeature_step",fromStart:performance.now()-n,UA:navigator.userAgent}}),[2,!0];case 7:throw r=i.sent(),Dg({type:bg.Error,message:"error in preloadFeatures() step "+r.message,id:"508417",data:{uxdata:JSON.stringify(t)},error:r}),r;case 8:return[2]}}))}))}function Zg(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r,i,a,s;return Object(k.__generator)(this,(function(l){try{if(!Vg)throw new Error("initialize() needs to be invoked before calling bootstrapFeature()");if(t=performance.now(),n=Hg,Ng(o=e.featureName.toLowerCase())&&(n=Ug),!n)throw new Error("uxVersionData is not populated");if(r=zg,i=Object(k.__assign)(Object(k.__assign)({},r),{dataSources:function(t){r.dataSources&&r.dataSources(t),e.setAdditionalDataSource&&e.setAdditionalDataSource(t)}}),Ag(o))return a={centroBaseUrl:Wg,cdnUrl:n[o].cdnUrl,ariaLoggerId:n.__hostApp_config.ariaLoggerId,targetAppUrls:n.__hostApp_config.hostingAppUrls},s=window.m365_admin_features.initializers[o](i,a),Dg({type:bg.Info,message:"bootstrapFeature() step has succeeded",id:"513586",data:{hvc:o,eventName:"bootstrapFeature_step",fromStart:performance.now()-t,UA:navigator.userAgent}}),[2,s];throw new Error("bootstrapFeature(): preloadFeature() was not called before bootstraping "+o)}catch(e){throw Dg({type:bg.Error,message:"error in bootstrapFeature() step "+e.message,id:"508481",error:e}),e}return[2]}))}))}var Yg,Xg={},$g=(Yg=[],{register:function(e){return e&&Yg.push(e),Xg},unregister:function(e){var t=Yg.indexOf(e);t>-1&&Yg.splice(t,1)},updateFeedbackObject:function(e){Object.assign(Xg,e),Yg.forEach((function(e){return e(Xg)}))}}),em=function(e){e.taskPaneIdToClose&&e.taskPaneLocation?Object(kr.a)(fr(e.taskPaneIdToClose,e.taskPaneLocation)):e.uiType===Zh.NoSurfaceWithoutTitle&&i.a.sendTraceTag(507901581,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("taskPaneIdToClose is not passed for feedback Taskpane to dispatch removeTaskPanesFromGroup","closeTaskPane"))};function tm(e){var t,n,o,r,i=e.customerUiWrapperFeedbackData,a=function(e){switch(e.toLowerCase()){case"word":return Object(dg.a)()?"WordDarkTheme":"WordLightTheme";case"excel":return Object(dg.a)()?"ExcelDarkTheme":"ExcelLightTheme";case"powerpoint":return Object(dg.a)()?"PowerPointDarkTheme":"PowerPointLightTheme";case"visio":return Object(dg.a)()?"VisioDarkTheme":"VisioLightTheme";case"onenote":return Object(dg.a)()?"OneNoteDarkTheme":"OneNoteLightTheme";default:return dg.a?"OfficeDarkTheme":"OfficeLightTheme"}}(i.Application),s={onDismiss:i.onDismiss?i.onDismiss:function(){em({taskPaneIdToClose:e.taskPaneIdToClose,taskPaneLocation:e.taskPaneLocation})},onError:i.onError,onSuccess:i.onSuccess,provideDynamicScreenshot:i.provideDynamicScreenshot,supportCallback:i.supportCallback,initializationComplete:i.initializationComplete},l={connectedExperiences:gg(i.connectedExperiences),policyAllowFeedback:gg(i.policyAllowFeedback),policyAllowSurvey:gg(i.policyAllowSurvey),policyAllowScreenshot:gg(i.policyAllowScreenshot),policyAllowContact:gg(i.policyAllowContact),policyAllowContent:gg(i.policyAllowContent),policyEmailCollectionDefault:gg(i.policyEmailCollectionDefault),policyScreenshotDefault:gg(i.policyScreenshotDefault),policyContentSamplesDefault:gg(i.policyContentSamplesDefault)},c={appData:i.applicationGroup.appData,complianceChecks:l,email:i.userEmail,feedbackForumUrl:i.feedbackForumUrl,feedbackUiType:i.uiType,hostPlatform:i.hostPlatform,initialFeedbackType:i.initialFeedbackType,invocationTimeStamp:i.invocationTimeStamp?i.invocationTimeStamp:Date.now(),isDisplayed:!0,isEmailCollectionEnabled:i.showEmailAddress,isFeedbackForumEnabled:null===(t=i.isFeedbackForumEnabled)||void 0===t||t,isFileUploadEnabled:null===(n=i.isFileUploadEnabled)||void 0===n||n,isMyFeedbackEnabled:null===(o=i.isMyFeedbackEnabled)||void 0===o||o,isScreenRecordingEnabled:(null===(r=i.isScreenRecordingEnabled)||void 0===r||r)&&nm(i.applicationGroup),isScreenshotEnabled:i.screenshot,isThankYouPageDisabled:i.isThankYouPageDisabled,myFeedbackUrl:i.myFeedbackForumUrl,scenarioConfig:i.scenarioConfig,screenshotInfo:{providedScreenshotType:nm(i.applicationGroup)?Jh.AutoCapture:Jh.AutoCaptureWithHtml2Canvas},diagnosticsConfig:{isShareContextDataEnabled:i.isShareContextDataEnabled,getContextData:i.getContextData,isHostManagedContextDataEnabled:i.isHostManagedContextDataEnabled,hostManagedContextDataExplanationUrl:i.hostManagedContextDataExplanationUrl,isRetrieveFormDataEnabled:i.isRetrieveFormDataEnabled,extractFeedbackDataForHost:i.extractFeedbackDataForHost}},u={audience:i.telemetryGroup.audience,audienceGroup:i.telemetryGroup.audienceGroup,channel:i.telemetryGroup.channel,clientCountryCode:i.telemetryGroup.clientCountryCode,deviceId:i.telemetryGroup.deviceId,deviceType:i.telemetryGroup.deviceType,errorClassification:i.telemetryGroup.errorClassification,errorCode:i.telemetryGroup.errorCode,errorName:i.telemetryGroup.errorName,featureArea:i.telemetryGroup.featureArea,flights:i.telemetryGroup.flights,flightSource:i.telemetryGroup.flightSource,fundamentalArea:i.telemetryGroup.fundamentalArea,installationType:i.telemetryGroup.installationType,isLogIncluded:i.telemetryGroup.isLogIncluded,isUserSubscriber:i.telemetryGroup.isUserSubscriber,officeArchitecture:i.telemetryGroup.officeArchitecture,officeBuild:i.telemetryGroup.officeBuild,officeEditingLang:i.telemetryGroup.officeEditingLang,officeUILang:i.telemetryGroup.officeUILang,osBitness:i.telemetryGroup.osBitness,osBuild:i.telemetryGroup.osBuild,osUserLang:i.telemetryGroup.osUserLang,platform:i.telemetryGroup.platform,processSessionId:i.telemetryGroup.processSessionId,ringId:i.telemetryGroup.ringId,sku:i.telemetryGroup.sku,sourceContext:i.telemetryGroup.sourceContext,systemProductName:i.telemetryGroup.systemProductName,systemManufacturer:i.telemetryGroup.systemManufacturer,browser:i.webGroup.browser,browserVersion:i.webGroup.browserVersion,dataCenter:i.webGroup.dataCenter};return{appId:i.appId,authenticationType:hg(i.authenticationType),ageGroup:pg(i.ageGroup),callbackFunctions:s,clientName:i.Application,clientFeedbackId:i.clientFeedbackId,feedbackConfig:c,isProduction:i.IsProd,telemetry:u,tenantId:i.telemetryGroup.tenantId,userId:i.telemetryGroup.loggableUserId,themeOptions:{baseTheme:a}}}function nm(e){var t,n,o,r,i,a,s;if(!(null==e?void 0:e.appData))return!1;var l=xg(e.appData);return!(void 0===l||(null===(t=null==l?void 0:l.AppModeExt)||void 0===t?void 0:t.toLowerCase().includes("embed_view"))||(null===(n=null==l?void 0:l.UiHost)||void 0===n?void 0:n.toLowerCase().includes("teams"))||(null===(o=null==l?void 0:l.App)||void 0===o?void 0:o.toLowerCase().includes("powerpoint"))&&(null===(r=null==l?void 0:l.AppModeExt)||void 0===r?void 0:r.toLowerCase().includes("view"))||(null===(i=null==l?void 0:l.App)||void 0===i?void 0:i.toLowerCase().includes("visio"))&&(null===(a=null==l?void 0:l.Host)||void 0===a?void 0:a.toLowerCase().includes("onedrivewopi"))&&(null===(s=null==l?void 0:l.AppModeExt)||void 0===s?void 0:s.toLowerCase().includes("view")))}var om=function(){},rm={};function im(e,t){var n;n={taskPaneIdToClose:e.taskPaneIdToClose,taskPaneLocation:e.taskPaneLocation,uiType:e.customerUiWrapperFeedbackData.uiType},om(),rm.taskPaneIdToClose&&rm.taskPaneLocation&&n.uiType!==Zh.NoSurfaceWithoutTitle&&em({taskPaneIdToClose:rm.taskPaneIdToClose,taskPaneLocation:rm.taskPaneLocation,uiType:n.uiType}),rm.taskPaneIdToClose=n.taskPaneIdToClose,rm.taskPaneLocation=n.taskPaneLocation;var o=tm(e);!function(e,t,n){var o=this;Object(k.__awaiter)(o,void 0,void 0,(function(){var o,r;return Object(k.__generator)(this,(function(i){switch(i.label){case 0:return o=function(e,t){var n;return t?t.current:((n=document.getElementById(e))||((n=document.createElement("div")).id=e,document.body.appendChild(n)),n)}(ug,n),[4,sm(t)];case 1:return r=i.sent(),$g.updateFeedbackObject(e),[4,r.main(o)];case 2:return om=i.sent(),[2]}}))})).then((function(){})).catch((function(t){i.a.sendTraceTag(507901580,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Centro Initialization failed for OCV Inapp Feedback => ".concat(t),"centroAsyncOperation",e.clientFeedbackId))}))}(o,fg(o),t)}function am(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return t=tm(e),[4,sm(fg(t))];case 1:return n.sent(),[2]}}))}))}function sm(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){switch(t.label){case 0:return[4,Kg(e)];case 1:return t.sent(),[4,Jg({featureName:ug})];case 2:return t.sent(),[4,Zg({featureName:ug,setAdditionalDataSource:function(e){e("centro.hvc.feedback.initOptions",$g)}})];case 3:return[2,t.sent()]}}))}))}var lm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.centroRef=O.createRef(),t.taskPaneStyles=cg(),t}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t,n=this.props.feedbackTaskPaneProps;try{i.a.sendTraceTag(508956945,a.a.msoulscat_Wac_WacFeedback,s.a.Info,mg("Centro-based Feedback Taskpane invoked:","OOUI OcvFeedbackTaskPane",null===(e=null==n?void 0:n.customerUiWrapperFeedbackData)||void 0===e?void 0:e.clientFeedbackId)),n.customerUiWrapperFeedbackData.initializationComplete=function(e){var t;i.a.sendTraceTag(508952738,a.a.msoulscat_Wac_WacFeedback,s.a.Info,mg("Feedback initialization complete result: ".concat(JSON.stringify(e)),"OOUI OcvFeedbackTaskPane initializationComplete",null===(t=null==n?void 0:n.customerUiWrapperFeedbackData)||void 0===t?void 0:t.clientFeedbackId))},im(n,this.centroRef)}catch(e){i.a.sendTraceTag(508957004,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Centro Initialization failed due to internal error => ".concat(e),"OOUI OcvFeedbackTaskPane",null===(t=null==n?void 0:n.customerUiWrapperFeedbackData)||void 0===t?void 0:t.clientFeedbackId))}},t.prototype.render=function(){var e,t,n,o=this.props.feedbackTaskPaneProps;if(!o||!o.customerUiWrapperFeedbackData)return i.a.sendTraceTag(508957003,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Centro Initialization failed for OCV Inapp Feedback due to missing feedback Taskpane props","OOUI OcvFeedbackTaskPane",null===(e=null==o?void 0:o.customerUiWrapperFeedbackData)||void 0===e?void 0:e.clientFeedbackId)),O.createElement("div",null);if(Object(Re.b)("Microsoft.Office.SharedOnline.ShowFeedbackButtonCheck",!1)&&!Cg(o.customerUiWrapperFeedbackData,"OOUI OcvFeedbackTaskPane"))return O.createElement("div",null);o.customerUiWrapperFeedbackData.uiType=Zh.NoSurfaceWithoutTitle,o.customerUiWrapperFeedbackData.hostPlatform=Yh.WacTaskPane,o.customerUiWrapperFeedbackData.invocationTimeStamp=Date.now();var r=this.taskPaneStyles.taskPaneContent;if("powerpoint"===(null===(n=null===(t=o.customerUiWrapperFeedbackData)||void 0===t?void 0:t.Application)||void 0===n?void 0:n.toLowerCase())){r="".concat(r," ").concat("AddinPanePanelResize"," ").concat(this.taskPaneStyles.appForOfficeContainer)}return O.createElement("div",{className:r,ref:this.centroRef})},t}(O.PureComponent);function cm(e){return function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.ref=O.createRef(),e}return Object(k.__extends)(n,t),n.prototype.componentDidMount=function(){this.props.setFocusCallback&&this.ref.current&&this.props.setFocusCallback(this.props.taskPaneId,this.ref.current.focus)},n.prototype.render=function(){return O.createElement(e,Object(k.__assign)({ref:this.ref},this.props))},n}(O.Component)}var um,dm=n(50),pm=n(351),hm=n(2262),gm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrapperRef=O.createRef(),t}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.initializeTooltipHost()},t.prototype.componentWillUnmount=function(){this.tooltipHost&&(this.tooltipHost.unregisterTooltipHostActions(),this.tooltipHost=void 0)},t.prototype.componentDidUpdate=function(e){this.props.customTooltip&&e.customTooltip!==this.props.customTooltip&&(this.tooltipHost?this.tooltipHost.updateTooltip(this.props.customTooltip):this.initializeTooltipHost())},t.prototype.initializeTooltipHost=function(){this.context.setTooltipElement&&this.context.updateTooltipsHidden&&this.props.customTooltip&&(this.tooltipHost=new pm.a({updateTooltipsHidden:this.context.updateTooltipsHidden,setTooltipElement:this.context.setTooltipElement,refElement:this.wrapperRef,controlId:this.props.id,controlLabel:this.props.customTooltip,tooltipDirection:this.props.tooltipDirection,performSetOnNextFrame:!!Object(dm.a)(this.context,dm.f.delayRenderTooltipsIsEnabled)}),this.tooltipHost.registerTooltipHostActions())},t.prototype.render=function(){var e,t=(e=this.props).label,n=e.iconProps,o=e.id,r=e.ariaLiveAssertiveness,i=Object(hm.b)(this.props.styles);return O.createElement("div",{className:i.root,ref:this.wrapperRef},n&&O.createElement(H.a,Object(k.__assign)({},n,{styles:Object(hm.a)(n)})),O.createElement(Cc.a,{"aria-live":r||void 0,message:t})," ",O.createElement("div",{"data-unique-id":o,className:i.label,"aria-hidden":"true"},t))},t.contextType=Jd.a,t}(O.PureComponent),mm=n(930);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Tip=2]="Tip",e[e.IntelligentService=3]="IntelligentService"}(um||(um={}));var fm,bm,vm,ym=n(648),xm=n(673),Cm=n(112),Sm={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},Em={selectors:{"[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast":{fill:"HighlightText"}}},km=Object(Po.c)((function(){return Object(V.db)({root:{display:"flex",height:"100%",flexDirection:"column"},recheckButton:{display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:40}})})),Om={root:["qa-screener-ignore"],label:["qa-screener-ignore",{fontWeight:600,marginLeft:8}]},Tm={root:[{marginRight:16}]},Im=Object(Po.c)((function(e){return Object(V.db)({root:{flexGrow:1,height:"100%",minHeight:100,paddingLeft:16,paddingRight:16,paddingTop:4},pivot:{display:"flex",flexDirection:"column",border:"1px solid transparent",height:"100%",width:"100%",backgroundColor:Object(Cm.c)()?e.palette.white:"white"},pivotItem:{commonHighContrastBorder:Ds.i},listContainer:{backgroundColor:Object(Cm.c)()?e.palette.white:"white",minHeight:"auto",paddingTop:4}})})),wm=Object(Po.c)((function(){return Object(V.db)({root:{overflowX:"unset"},focusZone:{maxWidth:"100%"}})})),_m=Object(Po.c)((function(e,t){var n,o,r,i,a;return Object(V.db)({itemContainer:{overflow:"auto",height:"100%"},icon:{selectors:{"& i":{height:16,width:16,marginTop:4}},height:16,width:16},link:{selectors:(n={},n[V.m]={border:"1px solid ButtonText"},n[":hover"]=[Ds.t,Ds.o],n[":focus"]=[Ds.t,Ds.o],n["".concat(Ds.c," &:focus")]={outlineWidth:2,outlineOffset:-1,selectors:(o={},o[V.m]=[Ds.t,Ds.o,{outlineOffset:0}],o)},n)},linkIsSelected:[Ds.u,Ds.o,{selectors:(r={":hover":[Ds.t,Ds.o,{selectors:(i={},i[V.m]={backgroundColor:"Highlight"},i)}]},r["".concat(Ds.c," &:focus")]={outlineWidth:2,outlineOffset:-1,selectors:(a={},a[V.m]=[Ds.t,Ds.o,{outlineOffset:0}],a)},r["::before"]={backgroundColor:Object(ym.a)(e,t).primaryDefaultBackgroundColor,bottom:1},r[V.m]={selectors:{"::before":{backgroundColor:"HighlightText"}}},r)}]})})),Pm={root:{fontWeight:400,padding:"8px 8px"}},Rm={root:{paddingLeft:8,paddingRight:8,paddingTop:16}},Dm=Object(Po.c)((function(e,t,n){return{root:{height:"32px",width:"100%",backgroundColor:Object(xm.f)(n).background,display:e&&Object(ea.d)("AccCheckerFixItMenuIsEnabled")?"auto":"none"},icon:{transform:t?"rotate(90deg)":"unset"}}})),jm=Object(Po.c)((function(e,t){return{root:{height:"32px",width:"100%",backgroundColor:Object(xm.f)(t).background},icon:{transform:e?"rotate(90deg)":"unset"}}})),Bm=Object(Po.c)((function(e,t,n){return Object(V.db)({root:{display:"flex",bottom:0,padding:"8px 16px",flexDirection:"column",overflow:"hidden",flexShrink:0},title:{fontSize:18,paddingTop:8,paddingBottom:4},body:{paddingTop:8,paddingBottom:8},notification:{display:e?"initial":"none",padding:"0 16px"},fixItContainer:{display:t&&Object(ea.d)("AccCheckerFixItMenuIsEnabled")?"auto":"none"},additionalInformationContainer:{display:n?"auto":"none"}})})),Fm=Object(Po.c)((function(e){return{root:{background:Object(Cm.c)()?e.palette.neutralLighterAlt:"rgba(113, 175, 229, 0.2)",color:Object(Cm.c)()?e.palette.themeDark:"#00188f"},icon:{color:Object(Cm.c)()?e.palette.themeDark:"#00188f"}}})),Lm=Object(Po.c)((function(){var e;return Object(V.db)({root:{selectors:(e={":focus":[Ds.t,Ds.o,Sm,Em]},e[Ds.a]={outlineWidth:2,outlineOffset:-2,left:0,right:0,top:0,bottom:0,border:"none"},e)},groupHeaderContainer:{selectors:{":hover":[Ds.t,Ds.o,Sm,Em]}},expand:{selectors:{"&[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText"},":hover":[Ds.t,Ds.o],":focus":[Ds.t,Ds.o,Sm]}},expandIsCollapsed:{width:14,height:14},title:{overflow:"hidden"}})})),Mm=Object(Po.c)((function(e){var t;return Object(V.db)({root:{width:"100%",selectors:(t={":hover":[Ds.t,Ds.o],":focus":[Ds.t,Ds.o],".ms-GroupSpacer":{flexShrink:0}},t[Ds.a]={borderWidth:2,left:0,right:0,top:0,bottom:0},t)},cell:{color:e.palette.neutralPrimary}})})),Am=function(e){function t(t){var n=e.call(this,t)||this;return n._errorItems=[],n._warningItems=[],n._tipItems=[],n._intelligentServiceItems=[],n._errorRules=[],n._warningRules=[],n._tipRules=[],n._intelligentServiceRules=[],n._allErrors=[],n._allWarnings=[],n._allTips=[],n._allIntelligentServices=[],n._selectionErrors=new wi.a,n._selectionWarnings=new wi.a,n._selectionTips=new wi.a,n._selectionIntelligentServices=new wi.a,n._currentlySelectedPivot=AccessibilityCheckerPaneStrings.ErrorsTab,n._showNotification=!1,n._notificationText="",n._messageBarType=Ys.a.info,n.recheckButton=O.createRef(),n.groupedResultsList=O.createRef(),n.errorsTooltipRef=O.createRef(),n.warningsTooltipRef=O.createRef(),n.tipsTooltipRef=O.createRef(),n.intelligentServicesTooltipRef=O.createRef(),n._repopulateResults=!0,n._expandFixIt=!1,n._expandAdditionalInformation=!1,n._showFixItMenu=!1,n._currentlySelectedRuleId="",n._lastScanTimeLabel=AccessibilityCheckerPaneStrings.LastChecked.replace("{0}",(new Date).toLocaleTimeString()),n._columns=[{key:"violations",name:"AccessibilityViolations",fieldName:"key",minWidth:100,maxWidth:200,isResizable:!0,ariaLabel:AccessibilityCheckerPaneStrings.ResultsColumnLabel}],n.accCheckerHeaderClassNames=km(),n.accCheckerFooterClassNames=Bm(),n.onLinkFocus=function(e){return function(){var t;null===(t=null==e?void 0:e.current)||void 0===t||t.show()}},n.onLinkClick=function(e){n._currentlySelectedPivot=e.props.itemKey,n.resetSelection(n._selectionErrors),n.resetSelection(n._selectionWarnings),n.resetSelection(n._selectionTips),n.resetSelection(n._selectionIntelligentServices)},n.getMessageBarStyle=function(e){if(n._messageBarType!==Ys.a.error)return Fm(e)},n.resetSelection=function(e){e!==n._selectionErrors&&n._selectionErrors.setAllSelected(!1),e!==n._selectionWarnings&&n._selectionWarnings.setAllSelected(!1),e!==n._selectionTips&&n._selectionTips.setAllSelected(!1),e!==n._selectionIntelligentServices&&n._selectionIntelligentServices.setAllSelected(!1)},n.onViolationSelectionChanged=function(e){null!==e&&0!==e.count?(n.props.onInvokeNavigateExecute&&n.props.onInvokeNavigateExecute(e.getSelection()[0].value.ResultId),n._currentlySelectedRuleId=e.getSelection()[0].value.RuleId):n._currentlySelectedRuleId="",n.forceUpdate()},n.customRenderer=function(e,t){return function(n,o){return O.createElement(Z.a,{content:e,calloutProps:{gapSpace:0},componentRef:t},o(n))}},n.onRenderGroupHeader=function(e){var t=n.props.pivotIcons;return O.createElement(mm.a,Object(k.__assign)({},e,{expandButtonIcon:t.chevron,indentWidth:0}))},n.onRenderCell=function(e,t,o,r){return o&&"number"==typeof r&&r>-1?O.createElement(_i.a,{columns:n._columns,groupNestingDepth:t,item:o,itemIndex:r,selection:n.getSelection(),selectionMode:Pi.d.single,compact:!0,styles:Mm(e),checkboxVisibility:hu.a.hidden}):null},n.getSelection=function(){switch(n._currentlySelectedPivot){case AccessibilityCheckerPaneStrings.ErrorsTab:return n._selectionErrors.setItems(n._errorItems,!1),n._selectionErrors;case AccessibilityCheckerPaneStrings.WarningsTab:return n._selectionWarnings.setItems(n._warningItems,!1),n._selectionWarnings;case AccessibilityCheckerPaneStrings.TipsTab:return n._selectionTips.setItems(n._tipItems,!1),n._selectionTips;case AccessibilityCheckerPaneStrings.IntelligentServicesTab:return n._selectionIntelligentServices.setItems(n._intelligentServiceItems,!1),n._selectionIntelligentServices;default:return n._selectionErrors}},n.createShimmeredList=function(){for(var e=[],t=0;t<3;t+=1)for(var n=100;n>=50;n-=25)e.push(O.createElement(j.a,{width:n+"%",shimmerElements:[{type:ba.a.circle},{type:ba.a.gap,width:"2%"},{type:ba.a.line}],styles:Rm}));return e},n.getNoIssuesFoundString=function(e){var t=n.props.accessibilityCheckResultCollection;return t&&t.Results&&t.Results.length>0?AccessibilityCheckerPaneStrings.NoIssuesFoundInCategory.replace("{0}",e.toLowerCase()):AccessibilityCheckerPaneStrings.NoIssuesFound},n.onGroupHeaderClick=function(e){e.isCollapsed=!e.isCollapsed,n.groupedResultsList.current&&n.groupedResultsList.current.forceUpdate()},n.setLastScanTime=function(){var e=AccessibilityCheckerPaneStrings.LastChecked,t=new Date;e=e.replace("{0}",t.toLocaleTimeString()),n._lastScanTimeLabel=e},n.populatePivot=function(e,t,n,o,r){for(var i=0,a=Object(pi.f)(o);i<a.length;i++){var s=a[i];s.Category===r&&t.push({count:0,key:s.RuleId,name:s.RuleName,startIndex:0,isCollapsed:!0})}if(e.forEach((function(e){var o=!1;t.forEach((function(t){o||t.key!==e.RuleId||(t.count=t.count+1,o=!0)})),n.push({key:e.ContentName,value:e})})),t.length>1){t.sort((function(e,t){return parseInt(e.key,10)-parseInt(t.key,10)}));for(var l=0;l<t.length;l+=1)0!==t[l].count?l>0&&(t[l].startIndex=t[l-1].startIndex+t[l-1].count):(t.splice(l,1),l-=1)}},n.getViolationsInCategory=function(e,t){var n=[];return null!==e.Results&&e.Results.forEach((function(o){e.AccessibilityRules[o.RuleId].Category===t&&n.push(o)})),n},n.sortByRuleID=function(e){e.sort((function(e,t){return parseInt(e.RuleId,10)-parseInt(t.RuleId,10)}))},n.ToggleFixItHeader=function(){n._expandFixIt=!n._expandFixIt,n.forceUpdate()},n.ToggleAdditionalInformationHeader=function(){n._expandAdditionalInformation=!n._expandAdditionalInformation,n.forceUpdate()},n.onRecheckClick=function(){n._showFixItMenu=!1,n._expandFixIt=!1,n.props.onRecheckExecute&&n.props.onRecheckExecute()},n.onHelpLinkClick=function(){"true"===Object(Re.a)("HelpTabIsEnabled","false")?n.props.showHelpPane&&n.props.showHelpPane():n.openHelpLink()},n.openHelpLink=function(){window.open(n.props.helpLink)},n.focus=function(){n.recheckButton&&n.recheckButton.current&&n.recheckButton.current.focus()},n.updateNotifications=function(){var e=n.props,t=e.outOfSync,o=e.partialResult,r=e.accessibilityCheckResultCollection,i=!1;r&&(i=!r.IsSuccess),n._showNotification=t||o||i},n.setNotificationText=function(){var e=n.props,t=e.outOfSync,o=e.partialResult,r=e.accessibilityCheckResultCollection;t?n.setOutOfSyncNotification():o?n.setPartialResultNotification():r&&!r.IsSuccess?n.setUnsuccessfulResultsNotification():n.clearNotification()},n._selectionErrors=new wi.a({onSelectionChanged:function(){n.resetSelection(n._selectionErrors),n.onViolationSelectionChanged(n._selectionErrors)}}),n._selectionErrors.setItems(n._errorItems),n._selectionWarnings=new wi.a({onSelectionChanged:function(){n.resetSelection(n._selectionWarnings),n.onViolationSelectionChanged(n._selectionWarnings)}}),n._selectionWarnings.setItems(n._warningItems),n._selectionTips=new wi.a({onSelectionChanged:function(){n.resetSelection(n._selectionTips),n.onViolationSelectionChanged(n._selectionTips)}}),n._selectionTips.setItems(n._tipItems),n._selectionIntelligentServices=new wi.a({onSelectionChanged:function(){n.resetSelection(n._selectionIntelligentServices),n.onViolationSelectionChanged(n._selectionIntelligentServices)}}),n._selectionIntelligentServices.setItems(n._intelligentServiceItems),n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.innerRef&&(this.props.innerRef.current=this),this.props.updateLastScanTime&&this.props.updateLastScanTime(this.setLastScanTime)},t.prototype.componentDidUpdate=function(e){e.innerRef!==this.props.innerRef&&(e.innerRef&&(e.innerRef.current=null),this.props.innerRef&&(this.props.innerRef.current=this))},t.prototype.render=function(){var e=this,t=this.props.resultsReady;return t||(this._allErrors=[],this._allWarnings=[],this._allTips=[],this._allIntelligentServices=[],this._errorRules=[],this._warningRules=[],this._tipRules=[],this._intelligentServiceRules=[],this._errorItems=[],this._warningItems=[],this._tipItems=[],this._intelligentServiceItems=[],this._selectionErrors.setAllSelected(!1),this._selectionWarnings.setAllSelected(!1),this._selectionTips.setAllSelected(!1),this._selectionIntelligentServices.setAllSelected(!1),this._repopulateResults=!0),this.setNotificationText(),O.createElement(Bo.a,null,(function(n){return O.createElement("div",{className:e.accCheckerHeaderClassNames.root},O.createElement("div",{className:e.accCheckerHeaderClassNames.recheckButton},O.createElement(gm,{type:"AppStatusTextProps",id:"LastScanTime",label:e.getLastScanTime(),styles:Om}),O.createElement($t.a,{id:"RecheckBtn",type:"AppButtonProps",styles:Tm,label:AccessibilityCheckerPaneStrings.RecheckButton,ariaDescription:t?e._notificationText+" "+e._lastScanTimeLabel:AccessibilityCheckerPaneStrings.Scanning,disabled:!t,onExecute:e.onRecheckClick,ref:e.recheckButton})),O.createElement("div",{className:Im(n).root},e.renderList(!t,n)),e.renderNotificationBar(n),O.createElement("div",{id:"AccCheckerFooter",className:e.accCheckerFooterClassNames.root},O.createElement($t.a,{type:"AppButtonProps",label:AccessibilityCheckerPaneStrings.RecommendedActions,id:"FixItChevron",icon:e.props.pivotIcons.chevron,styles:Dm(e._showFixItMenu,e._expandFixIt,n),onExecute:e.ToggleFixItHeader,ariaExpanded:e._expandFixIt}),O.createElement("div",{id:"FixIt",className:Bm(e._showNotification,e._expandFixIt,e._expandAdditionalInformation).fixItContainer},e.renderFixItButtons()),O.createElement($t.a,{type:"AppButtonProps",label:AccessibilityCheckerPaneStrings.AdditionalInformationTitle,id:"AdditionalInformationChevron",icon:e.props.pivotIcons.chevron,styles:jm(e._expandAdditionalInformation,n),onExecute:e.ToggleAdditionalInformationHeader,ariaExpanded:e._expandAdditionalInformation}),O.createElement("div",{id:"AdditionalInformation",className:Bm(e._showNotification,e._expandFixIt,e._expandAdditionalInformation).additionalInformationContainer},AccessibilityCheckerPaneStrings.AdditionalInformationHeader,O.createElement("div",{className:e.accCheckerFooterClassNames.title},AccessibilityCheckerPaneStrings.AdditionalInformationTitle),O.createElement("div",{className:e.accCheckerFooterClassNames.body},AccessibilityCheckerPaneStrings.AdditionalInformationBody),O.createElement(Li.a,{type:"AppLinkProps",id:"AccCheckerHelpLink",text:AccessibilityCheckerPaneStrings.AdditionalInformationLink,onExecute:e.onHelpLinkClick}))))}))},t.prototype.renderFixItButtons=function(){var e=this,t=this.props.fixItMenuControlRendererFunction;this._showFixItMenu=!1;var n=[];for(var o in this.props.violationToControlMap)if(o.toString()===this._currentlySelectedRuleId.toString()){this.props.violationToControlMap[o].forEach((function(o){t&&(n.push(t(o)),e._showFixItMenu=!0)}));break}return O.createElement("div",{style:{display:"flex",flexDirection:"column"}},n)},t.prototype.renderNotificationBar=function(e){return this.updateNotifications(),O.createElement("div",{className:Bm(this._showNotification,this._expandFixIt,this._expandAdditionalInformation).notification},O.createElement(Zs.a,{styles:this.getMessageBarStyle(e),messageBarType:this._messageBarType},this._notificationText))},t.prototype.renderList=function(e,t){if(!e&&this._repopulateResults){var n=this.props.accessibilityCheckResultCollection;n&&(this._allErrors=this.getViolationsInCategory(n,um.Error),this._allWarnings=this.getViolationsInCategory(n,um.Warning),this._allTips=this.getViolationsInCategory(n,um.Tip),this._allIntelligentServices=this.getViolationsInCategory(n,um.IntelligentService),this.sortByRuleID(this._allErrors),this.sortByRuleID(this._allWarnings),this.sortByRuleID(this._allTips),this.sortByRuleID(this._allIntelligentServices),n&&n.AccessibilityRules&&(this.populatePivot(this._allErrors,this._errorRules,this._errorItems,n.AccessibilityRules,um.Error),this.populatePivot(this._allWarnings,this._warningRules,this._warningItems,n.AccessibilityRules,um.Warning),this.populatePivot(this._allTips,this._tipRules,this._tipItems,n.AccessibilityRules,um.Tip),this.populatePivot(this._allIntelligentServices,this._intelligentServiceRules,this._intelligentServiceItems,n.AccessibilityRules,um.IntelligentService))),this._repopulateResults=!1}var o=this.props,r=o.appColors,i=o.pivotIcons;return O.createElement(Wo.a,{linkFormat:"links",linkSize:"normal",className:Im(t).pivot,styles:_m(t,r),onLinkClick:this.onLinkClick},O.createElement(No.a,{itemIcon:i.error,itemCount:this._allErrors.length,itemKey:AccessibilityCheckerPaneStrings.ErrorsTab,onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStrings.ErrorsTab,this.errorsTooltipRef),className:Im(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStrings.ErrorsTab+", "+this._allErrors.length,id:"ErrorsTab",headerButtonProps:{onFocus:this.onLinkFocus(this.errorsTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allErrors,this._errorItems,this._errorRules,this._selectionErrors,AccessibilityCheckerPaneStrings.ErrorsTab,t)),O.createElement(No.a,{itemIcon:i.warning,itemCount:this._allWarnings.length,itemKey:AccessibilityCheckerPaneStrings.WarningsTab,onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStrings.WarningsTab,this.warningsTooltipRef),className:Im(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStrings.WarningsTab+", "+this._allWarnings.length,id:"WarningsTab",headerButtonProps:{onFocus:this.onLinkFocus(this.warningsTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allWarnings,this._warningItems,this._warningRules,this._selectionWarnings,AccessibilityCheckerPaneStrings.WarningsTab,t)),O.createElement(No.a,{itemIcon:i.tips,itemCount:this._allTips.length,itemKey:AccessibilityCheckerPaneStrings.TipsTab,onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStrings.TipsTab,this.tipsTooltipRef),className:Im(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStrings.TipsTab+", "+this._allTips.length,id:"TipsTab",headerButtonProps:{onFocus:this.onLinkFocus(this.tipsTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allTips,this._tipItems,this._tipRules,this._selectionTips,AccessibilityCheckerPaneStrings.TipsTab,t)),O.createElement(No.a,{itemIcon:i.intelligentServices,itemCount:this._allIntelligentServices.length,itemKey:AccessibilityCheckerPaneStrings.IntelligentServicesTab,onRenderItemLink:this.customRenderer(AccessibilityCheckerPaneStrings.IntelligentServicesTab,this.intelligentServicesTooltipRef),className:Im(t).pivotItem,ariaLabel:AccessibilityCheckerPaneStrings.IntelligentServicesTab+", "+this._allIntelligentServices.length,id:"IntelligentServicesTab",headerButtonProps:{onFocus:this.onLinkFocus(this.intelligentServicesTooltipRef)}},e?this.getShimmeredList(t):this.populateList(this._allIntelligentServices,this._intelligentServiceItems,this._intelligentServiceRules,this._selectionIntelligentServices,AccessibilityCheckerPaneStrings.IntelligentServicesTab,t)))},t.prototype.populateList=function(e,t,n,o,r,i){var a=this,s={headerProps:{onGroupHeaderClick:this.onGroupHeaderClick,styles:Lm()},onRenderHeader:this.onRenderGroupHeader};return O.createElement("div",{id:"ResultsContainer",className:Im(i).listContainer},e.length>0?O.createElement(Ra.a,{selection:o,selectionMode:Pi.d.single,isSelectedOnFocus:!1},O.createElement(Kd.a,{items:t,groups:n,listProps:{onShouldVirtualize:function(){return!0}},selection:o,compact:!0,selectionMode:Pi.d.none,groupProps:s,componentRef:this.groupedResultsList,styles:wm(),onRenderCell:function(e,t,n){return a.onRenderCell(i,e,t,n)}})):O.createElement(Ge.a,{styles:Pm},this.getNoIssuesFoundString(r)))},t.prototype.getShimmeredList=function(e){return O.createElement("div",{id:"ShimmeredResultsContainer",className:Im(e).listContainer},this.createShimmeredList())},t.prototype.getLastScanTime=function(){var e=this.props.resultsReady,t=AccessibilityCheckerPaneStrings.LastChecked;return e?this._lastScanTimeLabel:t.replace("{0}",AccessibilityCheckerPaneStrings.Scanning)},t.prototype.setOutOfSyncNotification=function(){this._notificationText=AccessibilityCheckerPaneStrings.OutOfSyncNotification,this._messageBarType=Ys.a.info},t.prototype.setPartialResultNotification=function(){this._notificationText=AccessibilityCheckerPaneStrings.PartialResultNotification,this._messageBarType=Ys.a.info},t.prototype.setUnsuccessfulResultsNotification=function(){this._notificationText=AccessibilityCheckerPaneStrings.UnsuccessfulResultsNotification,this._messageBarType=Ys.a.error},t.prototype.clearNotification=function(){this._notificationText=""},t}(O.PureComponent),Nm=Object(xr.a)([function(e,t){return t.violationToControlId},Cr.U,Cr.u],(function(e,t,n){for(var o={},r=function(r){var i=[];e[r].forEach((function(e){var o=Object(Sr.c)(t,n,e,{});i.push(o)})),o[r]=i},i=0,a=Object.keys(e);i<a.length;i++){r(a[i])}return o})),Wm=n(301),Hm=O.createRef(),zm=Object(Ir.connect)((function(e,t){Object(Wm.j)("AccCheckerTaskPane");var n=Object(k.__assign)(Object(k.__assign)({},t),{violationToControlMap:Nm(e,t)});return Object(Wm.j)("AccCheckerTaskPane","NonCached"),n}),void 0,void 0,{areStatesEqual:Object(Tr.a)("AccCheckerTaskPane")})(Object(Or.a)(Am)),Vm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.focus=function(){var e;null===(e=null==Hm?void 0:Hm.current)||void 0===e||e.focus()},t.prototype.render=function(){return O.createElement(zm,Object(k.__assign)({innerRef:Hm},this.props))},t}(O.PureComponent),Gm=n(394),Um=n(476),qm=n(38),Qm=function(e){function t(t){var n=e.call(this,t)||this;return n.onComponentProviderStateChange=function(e){e===Gm.a.Unregistered&&n.setState({componentProvider:void 0})},n.onExtensionCollectionStateChange=function(e){n.setComponentProvider()},n.focus=function(){n.props.focusCallback&&n.props.focusCallback()},n.state={componentProvider:void 0},n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){this.extensionCollection=Object(qm.g)().getExtensions([qm.b.CommentThread],Um.a),this.extensionCollection.onUpdated.subscribe(this.onExtensionCollectionStateChange),this.setComponentProvider()},t.prototype.setComponentProvider=function(){var e=this,t=this.getExtensionProvider();if(t){var n=t.getExtension();if(n.priority!==qm.d.Disabled)Object(Gm.d)().getComponent(n.componentKey).then((function(t){t.onStateChanged.subscribe(e.onComponentProviderStateChange),e.setState({componentProvider:t})})).catch((function(t){e.setState({componentProvider:void 0}),i.a.sendTraceTag(571073567,a.a.msoulscat_Wac_TaskPane,s.a.Info,"Failed to fetch provider from ComponentRegistry's getComponent promise. Message: ".concat(t))}));else this.setState({componentProvider:void 0})}else this.setState({componentProvider:void 0})},t.prototype.getExtensionProvider=function(){var e=this.extensionCollection&&this.extensionCollection.providers.filter((function(e){return e.scope.contentType===qm.b.CommentThread&&e.scope.renderMode===qm.e.TaskPane}));if(e&&e.length){var t=e[0];if(Object(qm.j)(t))return t}},t.prototype.render=function(){var e;return(null===(e=this.state.componentProvider)||void 0===e?void 0:e.component)?O.createElement(this.state.componentProvider.component,null):null},t}(O.PureComponent),Km=Object(Po.c)((function(e){return{bodyContainer:{position:"absolute",width:"100%",height:"100%",zIndex:1e3,backgroundColor:e.palette.neutralLighterAlt},iconCard:{height:"80px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:e.palette.neutralLighter},icon:{width:"48px",height:"48px"},mainBody:{width:"100%",height:"100%"},copylinkCard:{height:"210px",padding:"24px 16px"},title:{fontWeight:600,marginBottom:"24px",fontSize:"16px",lineHeight:"22px",color:e.palette.neutralDark},input:{padding:"6px 8px",boxSizing:"border-box",borderRadius:"2px",fontWeight:400,fontSize:"14px",lineHeight:"20px",color:e.palette.neutralDark,backgroundColor:e.palette.neutralLighterAlt},copySucceedMsg:{margin:"8px 0 0 -10px",height:"12px",fontWeight:400,fontSize:"10px",lineHeight:"12px",color:e.palette.neutralDark},copyButton:{marginTop:"24px",display:"flex",justifyContent:"flex-end"}}})),Jm=n(495),Zm=n(1129),Ym=n(321),Xm=function(e){function t(t){var n=e.call(this,t)||this;return n._copySharingLinkToClipboard=function(){var e=!1;try{n._textField.focus(),n._textField.setSelectionRange(0,n._textField.value.length),e=document.execCommand("copy")}catch(e){i.a.sendTraceTag(526989392,a.a.msoulscat_Wac_TaskPane,s.a.Error,'Copy link failed by document.execCommand("copy"), error: '.concat(e))}try{var t=window.external.CopyToClipboard(n.props.sharingLink);e=t||void 0===t}catch(e){i.a.sendTraceTag(526989393,a.a.msoulscat_Wac_TaskPane,s.a.Error,"Copy link failed by CopyToClipboard, error: ".concat(e))}e&&n.props.copySuccessCallback&&n.props.copySuccessCallback(),n.setState({successfullyCopied:e})},n.state={successfullyCopied:!1},n._copyButtonLabel=Object(Ym.a)().AddinSharingCopyLinkButtonLabel,n._copiedSuccessMessage=Object(Ym.a)().AddingSharingCopiedSuccessMessage,n._addinSharingTitle=Object(Ym.a)().AddinSharingTitle,n._textField=O.createRef(),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.sharingLink,o=t.iconUrl;return O.createElement(Bo.a,null,(function(t){var r=Km(t);return O.createElement("div",{style:r.bodyContainer},O.createElement("div",{style:r.iconCard},O.createElement("div",{style:r.icon},o&&Object(Zm.a)(o))),O.createElement("div",{style:r.mainBody},O.createElement("div",{style:r.copylinkCard},O.createElement("div",{style:r.title},e._addinSharingTitle),O.createElement(D.a,{autoFocus:!0,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",value:n,style:r.input}),O.createElement("div",{style:r.copySucceedMsg},O.createElement(jo.a,{id:"AddingSharingCopiedSuccessMessage",type:"AppLabelProps",label:e.state.successfullyCopied?e._copiedSuccessMessage:"",forId:"AddingSharingCopiedSuccessMessage"})),O.createElement("div",{style:r.copyButton},O.createElement(ma.a,{id:"AddinSharingCopyLinkButton",styles:Object(Jm.d)(Object(Jm.c)(t,void 0)),text:e._copyButtonLabel,onClick:function(){e._copySharingLinkToClipboard()}})))))}))},t}(O.PureComponent),$m=function(e){function t(t){var n=e.call(this,t)||this;return n.container=O.createRef(),n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.addinSharingTaskPaneProps,n=e.showSharingContent;return O.createElement(O.Fragment,null,t&&n&&O.createElement(Xm,Object(k.__assign)({},t)),O.createElement("div",{style:{position:"relative",height:"100%",display:t&&n?"none":"block"},ref:this.container}))},t.prototype.componentDidMount=function(){this.container&&this.container.current&&this.container.current.appendChild(this.props.getContent())},t}(O.PureComponent),ef=(fm=function(){return{root:["ExcelLegacyTaskPaneContainer",{height:"100%"}]}}(),{root:Object(V.eb)(fm.root)}),tf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=O.createRef(),t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{className:ef.root,ref:this.container})},t.prototype.componentDidMount=function(){this.container&&this.container.current&&this.container.current.appendChild(this.props.getContent())},t}(O.PureComponent);!function(e){e[e.None=0]="None",e[e.BlockedInCoauthoring=1]="BlockedInCoauthoring",e[e.BlockedInViewMode=2]="BlockedInViewMode",e[e.BlockedInSheetView=3]="BlockedInSheetView",e[e.BlockedInProtectedSheet=4]="BlockedInProtectedSheet",e[e.DataExceedsLimit=5]="DataExceedsLimit",e[e.GeneralError=6]="GeneralError",e[e.NoSuggestions=7]="NoSuggestions"}(bm||(bm={})),function(e){e[e.Disabled=0]="Disabled",e[e.LoadingSuggestions=1]="LoadingSuggestions",e[e.DisplaySuggestions=2]="DisplaySuggestions"}(vm||(vm={}));var nf=function(){return O.createElement(Qe.a,{"data-testid":"Loading",horizontalAlign:"center",verticalAlign:"center",style:{height:"100%"}},O.createElement(il.a,{label:"Loading...",labelPosition:"right"}))},of=O.createContext(null);function rf(){return O.useContext(of)}var af=of.Provider,sf=n(228);function lf(e){var t=Object(sf.a)(e);return O.useEffect((function(){Object(k.__assign)(t,e)}),[e,t]),t}var cf=O.createContext({});function uf(){return O.useContext(cf)}var df=function(e){var t=lf(e.callbacks);return O.createElement(cf.Provider,{value:t},e.children)},pf=n(430),hf={text:{fontSize:12,width:"100%"},root:{paddingInline:10,marginBlockEnd:5},label:{alignItems:"center",width:"100%"},checkbox:{height:16,width:16,"::after":{top:2,left:2}}},gf=function(e){var t=e.options,n=e.checkedOptions,o=e.onChange,r=e.selectAllLabel,i=e.testId,a=e.optionsContainerStyle,s=e.getOptionLabel,l=void 0===s?String:s,c=e.getOptionCount,u=e.getOptionsCount,d=Object(pf.a)(),p=O.useRef(null);if(O.useEffect((function(){var e;return null===(e=p.current)||void 0===e?void 0:e.forceUpdate()}),[n]),!(null==t?void 0:t.length))return null;var h=n.length>0&&n.length<t.length;return O.createElement(O.Fragment,null,O.createElement(Ht.a,{styles:hf,label:r,indeterminate:h,checked:n.length===t.length,onRenderLabel:function(e,t){return mf(null==e?void 0:e.label,null==u?void 0:u(),d,[e,t])},onChange:function(e,n){return o(n||h?t:[])}}),O.createElement(ja.a,{"data-testid":i,ref:p,style:a,items:t,getKey:function(e){return l(e)},onRenderCell:function(e){return O.createElement(Ht.a,{inputProps:{"data-testid":e},label:l(e),onRenderLabel:function(t,n){return mf(null==t?void 0:t.label,null==c?void 0:c(e),d,[t,n])},styles:hf,checked:n.includes(e),onChange:function(t,r){o(r?Object(k.__spreadArray)(Object(k.__spreadArray)([],n,!0),[e],!1):n.filter((function(t){return t!==e})))}})}}))};function mf(e,t,n,o){var r,i,a=o[0],s=o[1];if(void 0===t)return null!==(r=null==s?void 0:s(a))&&void 0!==r?r:null;var l=O.createElement(Qe.a,{grow:!0,horizontal:!0,horizontalAlign:"space-between","data-testid":"OptionLabel"},O.createElement("span",null,e),O.createElement("span",{style:{color:n.palette.neutralPrimaryAlt}},t));return null!==(i=null==s?void 0:s(Object(k.__assign)(Object(k.__assign)({},a),{label:l})))&&void 0!==i?i:null}var ff=O.createContext(ExcelDataCleansingStrings);function bf(){return O.useContext(ff)}var vf,yf,xf=function(e){var t=e.children;return O.createElement(ff.Provider,{value:ExcelDataCleansingStrings},t)};function Cf(e){return e.type===vf.ExtraSpaces}function Sf(e){return e.type===vf.TextInconsistency}function Ef(e){return e.type===vf.NumberFormatInconsistency}!function(e){e[e.TextInconsistency=0]="TextInconsistency",e[e.NumberFormatInconsistency=1]="NumberFormatInconsistency",e[e.ExtraSpaces=2]="ExtraSpaces",e[e.ExtraSpacesTable=3]="ExtraSpacesTable"}(vf||(vf={})),function(e){e[e.AllNumber=0]="AllNumber",e[e.AllText=1]="AllText",e[e.MixedNumberAndText=2]="MixedNumberAndText"}(yf||(yf={}));var kf=[vf.ExtraSpacesTable,vf.TextInconsistency,vf.NumberFormatInconsistency],Of=new Map([[vf.ExtraSpacesTable,"Filter_ExtraSpacesType"],[vf.ExtraSpaces,"Filter_ExtraSpacesType"],[vf.TextInconsistency,"Filter_TextInconsistencyType"],[vf.NumberFormatInconsistency,"Filter_NumberFormatInconsistencyType"]]);var Tf=function(e){var t=e.availableTypes,n=e.selectedTypes,o=e.tables,r=e.selectedTables,l=e.suggestions,c=e.onFilterChanged,u=e.isFiltered,d=bf(),p=O.useState(n),h=p[0],g=p[1],m=O.useState(r),f=m[0],b=m[1];function v(){g(n),b(r)}O.useEffect(v,[n,r]);var y=[{key:"FilterBySuggestionType",text:d.Filter_FilterByType,itemType:Jt.a.Header},{key:"types",onRender:function(){return O.createElement(gf,{options:t,checkedOptions:h,onChange:g,getOptionLabel:function(e){return function(e,t){if(Of.has(t))return e[Of.get(t)];i.a.sendTraceTag(540378824,a.a.msoulscat_ES_EWAJS,s.a.Warning,"SuggestionsFilter.stringByType: No string for type ".concat(t))}(d,e)},selectAllLabel:d.Filter_SelectAllTypes,testId:"FilterByTypeList",getOptionsCount:function(){return l.length},getOptionCount:function(e){return l.filter((function(t){return t.type===e})).length}})}},{key:"FilterByTable",text:d.Filter_FilterByTable,itemType:Jt.a.Header},{key:"tables",onRender:function(){return O.createElement(gf,{options:o,checkedOptions:f,onChange:b,selectAllLabel:d.Filter_SelectAllTables,optionsContainerStyle:{maxHeight:200,overflow:"auto"},testId:"FilterByTableList",getOptionsCount:function(){return l.length},getOptionCount:function(e){return l.filter((function(t){return t.tableName===e})).length}})}},{key:"Apply",onRender:function(e,t){return O.createElement(ma.a,{"data-testid":"SuggestionsFilterApply",text:d.Filter_Apply,styles:{root:{margin:"5px 0 10px 10px"}},disabled:0===h.length||0===f.length,onClick:function(e){t(e,!0),c(h,f)}})}}];return O.createElement(Ba.a,{"data-testid":"SuggestionsFilterButton",iconProps:{iconName:u?W.a.EditFilter_16:W.a.Filter_20},styles:{root:{padding:0,height:25,marginInlineEnd:5}},menuProps:{items:y,doNotLayer:!0,calloutProps:{calloutWidth:225},onMenuDismissed:function(){v()}}})},If=function(e){var t=O.useRef(e);t.current=e,O.useEffect((function(){var e;null===(e=t.current)||void 0===e||e.call(t)}),[])},wf=O.createContext({});function _f(){return O.useContext(wf)}var Pf=wf.Provider,Rf=O.createContext(void 0),Df=O.createContext((function(){}));function jf(){return O.useContext(Rf)}var Bf=function(e){var t=e.children,n=_f(),o=O.useState({}),r=o[0],l=o[1],c=O.useCallback((function(e,t){e?l((function(n){var o;return Object(k.__assign)(Object(k.__assign)({},n),((o={})[e]=t,o))})):i.a.sendTraceTag(508843221,a.a.msoulscat_ES_EWAJS,s.a.Error,"Set filter failed: sheetId is undefined")}),[l]);return O.createElement(Df.Provider,{value:c},O.createElement(Rf.Provider,{value:r[n.sheetId]},t))};var Ff=function(e){var t=e.isFiltered,n=e.suggestions,o=e.filterHint,r=e.sheetId,i=jf(),a=O.useContext(Df),s=Array.from(new Set(n.map((function(e){return e.tableName})))),l=function(e,t,n,o){var r,i={filterTables:n,filterSuggestionTypes:o};if(t){var a=n.filter((function(e){return t.filterTables.includes(e)}));a.length>0&&(i.filterTables=a);var s=kf.filter((function(e){return t.filterSuggestionTypes.includes(e)}));s.length>0&&(i.filterSuggestionTypes=s)}else(null===(r=null==e?void 0:e.filterTables)||void 0===r?void 0:r.length)&&(i.filterTables=n.filter((function(t){return e.filterTables.includes(t)})));return i}(o,i,s,kf),c=l.filterTables,u=l.filterSuggestionTypes,d=O.useState({selectedTypes:u,selectedTables:c}),p=d[0],h=d[1];function g(e,t){h({selectedTypes:e,selectedTables:t}),r&&(null==a||a(r,{filterTables:t,filterSuggestionTypes:e}))}return If((function(){o&&g(u,c)})),O.createElement(Tf,Object(k.__assign)({},p,{isFiltered:t,availableTypes:kf,tables:s,onFilterChanged:g,suggestions:n}))},Lf=Object(V.eb)({fontWeight:V.l.semibold}),Mf=function(e){var t=e.title,n=e.subTitle,o=e.testId,r=e.children;return O.createElement("div",{"data-testid":o},O.createElement(Qe.a,{tokens:{childrenGap:8},style:{height:"100%"}},O.createElement(uo.a,{className:Lf},t),O.createElement(uo.a,{variant:"smallPlus"},n),r))},Af=function(){var e=bf();return O.createElement(Mf,{testId:"EmptyFilteredSuggestions",title:e.Filter_NoSuggestionTitle,subTitle:e.Filter_NoSuggestionSubheader})},Nf=O.createContext(void 0),Wf=Nf.Provider;function Hf(){return O.useContext(Nf)}var zf=function(){var e=Hf(),t=bf();return(null==e?void 0:e.canRefresh)?O.createElement(Zs.a,{isMultiline:!1,messageBarType:Ys.a.success,styles:{root:{width:"unset"},iconContainer:{display:"none"},content:{alignItems:"center"},actions:{marginInlineEnd:-2},text:{fontSize:V.k.small,marginInlineStart:10}},actions:O.createElement(be.a,{onClick:e.refresh,primary:!0,styles:{textContainer:{fontWeight:V.l.semibold,fontSize:V.k.small}}},t.RefreshAnnotations_Button)},t.RefreshAnnotations_Title):null},Vf={top:0,position:"sticky",zIndex:1},Gf=function(e){var t=e.name,n=e.sticky,o=Object(pf.a)(),r=o.palette,i=r.neutralLight,a=r.neutralLighter,s=r.neutralPrimaryAlt,l=Object(yt.isChangeGateEnabled)("OfficeVSO:8232921_CleanDataTableTitleUsePaneBackground")?Object(xm.f)(o,Object(yt.getBooleanFeatureGate)("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled")).background:a,c=i;return O.createElement(Dn.a,{styles:{root:Object(k.__assign)(Object(k.__assign)({},n?Vf:{}),{backgroundColor:l,":before":{backgroundColor:c}}),content:{backgroundColor:l,padding:"0 ".concat(V.k.size20)}}},O.createElement(uo.a,{variant:"small",styles:{root:{color:s,fontWeight:V.l.semibold}}},t))},Uf=n(2241),qf=O.createContext({isSelected:!1,isHovered:!1}),Qf=qf.Provider,Kf=function(e){var t=e.index,n=e.suggestionId,o=e.isPreviewEnabled,r=e.children,i=e.isSelected,a=e.onRemoved,s=e.disabled,l=void 0!==s&&s,c=rf(),u=O.useState(!1),d=u[0],p=u[1];Object(Uf.a)((function(){null==a||a()}));return O.createElement("span",{role:"listitem",className:"suggestion-card","data-selection-index":t,onClick:function(e){e.target!==document.activeElement&&e.currentTarget.focus()},onMouseEnter:function(){var e;p(!0),o&&(null===(e=null==c?void 0:c.onSuggestionPreview)||void 0===e||e.call(c,n))},onMouseLeave:function(){var e;p(!1),o&&(null===(e=null==c?void 0:c.onCancelSuggestionPreview)||void 0===e||e.call(c,n))},style:Object(k.__assign)({outline:"none",transition:"opacity 0.45s linear",marginBlockEnd:8},l&&{userSelect:"none",opacity:"0.4"}),"data-is-focusable":!0,"data-selection-select":!0,"data-selected-card":i||void 0},O.createElement(Qf,{value:{isSelected:i,isHovered:d}},r))},Jf=n(1938),Zf=n(947),Yf=function(e){var t=e.range,n=e.tooltip,o=e.style,r=Object(pf.a)();if(!t)return null;var i={cursor:"default",padding:3,border:"1px solid",borderRadius:3,fontSize:V.k.xSmall,fontWeight:V.l.semibold,color:r.palette.neutralDark,borderColor:r.palette.neutralLight,backgroundColor:r.palette.neutralLight,textOverflow:"ellipsis",whiteSpace:"pre",overflow:"hidden"};return n?O.createElement(Z.a,{overflowMode:Zf.a.Self,directionalHint:Y.a.bottomCenter,content:n,styles:{root:Object(k.__assign)(Object(k.__assign)({},i),o)}},t):O.createElement(uo.a,{styles:{root:i}},t)},Xf={Apply:W.a.Checkmark_16,Ignore:W.a.DeleteHover_16,Close:c.a.CancelGlyph_16,Actions:c.a.HintBarEllipses_20},$f={actionButtonStyles:{icon:{width:12,margin:0},root:{height:"unset",fontSize:V.k.size12,padding:0,":after":{outlineOffset:"6px"}}},closeButtonStyles:{root:{width:16,height:16,marginInlineEnd:-9,marginBlockStart:-9}}},eb=Object(Po.c)((function(e,t){return Object(V.eb)({padding:9,borderRadius:"3px",boxSizing:"border-box",boxShadow:Jf.a.depth4,border:"2px solid transparent",background:t.palette.white,opacity:"inherit",":hover":{boxShadow:Jf.a.depth8}},e&&{borderColor:t.palette.themePrimary})})),tb=function(e){var t=e.menuItems,n=e.menuString;if(!t||0===t.length)return null;if(1===t.length){var o=t[0];return O.createElement(be.a,{style:{marginInlineStart:"auto"},onClick:function(){return o.onClick()},styles:$f.actionButtonStyles},o.text)}return O.createElement(Kt.a,{style:{marginInlineStart:"auto"},title:n,menuProps:{items:t},menuIconProps:{iconName:Xf.Actions},ariaLabel:ExcelRibbonStrings.OverflowWellLabel})},nb=function(e){var t=e.title,n=e.range,o=e.rangeTooltipString,r=e.applyString,i=e.ignoreString,a=e.onApply,s=e.onIgnore,l=e.disableApply,c=void 0!==l&&l,u=e.disableIgnore,d=void 0!==u&&u,p=e.showIgnore,h=void 0!==p&&p,g=e.children,m=e.isSelected,f=void 0!==m&&m,b=e.otherActions,v=void 0===b?[]:b,y=e.otherActionsString,x=e.onClose,C=e.closeString,S=e.handleTab,E=e.focusBeforeApply,k=void 0!==E&&E,T=e.additionalAction,I=e.actionsRowStyle,w=e.showRangeBadge,_=void 0===w||w,P=O.useRef(null),R=Object(pf.a)(),D=eb(f,R);return O.createElement(Da.a,{className:D,handleTabKey:S},x&&O.createElement(Qe.a,{horizontalAlign:"end"},O.createElement(Ba.a,{title:C,iconProps:{iconName:Xf.Close},onClick:x,styles:$f.closeButtonStyles})),O.createElement(Qe.a,{style:x?{paddingInlineEnd:7}:{}},O.createElement(Qe.a,{horizontal:!0,style:{marginBottom:10},tokens:{childrenGap:10},horizontalAlign:"space-between",verticalAlign:"start"},O.createElement(Ge.a,{style:{padding:0}},t),_&&O.createElement(Yf,{range:n,tooltip:o,style:{maxWidth:"25%"}})),g),O.createElement(Dn.a,{styles:{root:{padding:"1px 0",":before":{backgroundColor:R.palette.neutralQuaternaryAlt}}}}),O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"start",tokens:{childrenGap:6},style:I},O.createElement(be.a,{elementRef:P,"data-testid":"SuggestionCardApplyButton",disabled:c,onClick:k?function(){var e;null===(e=P.current)||void 0===e||e.focus(),null==a||a()}:a,iconProps:{iconName:Xf.Apply},styles:$f.actionButtonStyles},r),h&&O.createElement(be.a,{"data-testid":"SuggestionCardIgnoreButton",disabled:d,onClick:s,iconProps:{iconName:Xf.Ignore},styles:$f.actionButtonStyles},i),T,O.createElement(tb,{menuItems:v,menuString:y})))};var ob,rb,ib=function(e){var t=e.text,n=e.spacesRegex,o=void 0===n?/\s/:n,r=e.highlightLeading,i=void 0===r||r,a=e.highlightMiddle,s=void 0===a||a,l=e.highlightTrailing,c=void 0===l||l,u=e.ignoreSingleMiddle,d=void 0===u||u,p=e.whitespaceBaseColor,h=void 0===p?"#FF9198":p,g=e.variant,m=void 0===g?"thin":g,f=e.wrap,b=void 0!==f&&f;if(!t)return null;if(!(i||s||c))return O.createElement(O.Fragment,null,t);var v=function(e,t){var n={margin:"0 0.5px",":first-child":{marginInlineStart:0},":last-child":{marginInlineEnd:0}};return Object(V.db)({container:{whiteSpace:t?"pre-wrap":"pre"},space:Object(k.__assign)(Object(k.__assign)({},n),{backgroundColor:e}),spacesContainer:Object(k.__assign)(Object(k.__assign)({},n),{display:"inline-block"})})}(h,b);return O.createElement("span",{className:v.container},function(e,t,n){void 0===n&&(n=/\s/);var o=[],r=0;for(;r<e.length;){for(var i="";r<e.length&&n.test(e[r]);)i+=e[r],r+=1;i.length>0&&o.push(t(i,r-1));for(var a="";r<e.length&&!n.test(e[r]);)a+=e[r],r+=1;a.length>0&&o.push(a)}return o}(t,(function(e,n){var o=n===e.length-1,r=n===t.length-1,a=!(o||r);if(o&&!i||a&&!s||a&&d&&e.length<2||r&&!c)return e;var l=e.replace("\r\n","\n");return O.createElement("span",{key:n,className:v.spacesContainer},Array.from(l).map((function(e,t){return O.createElement("span",{key:"".concat(n,"|").concat(t),className:v.space},"thin"===m?e:e+e)})))}),o))},ab=function(e){var t=e.onChange,n=e.variations,o=e.collapsedVariationsToShow,r=void 0===o?4:o,i=bf(),a=O.useCallback((function(e,n){var o;return void 0===n&&(n=!1),t(null===(o=null==e?void 0:e.currentTarget)||void 0===o?void 0:o.name,n)}),[t]),s=O.useState(!1),l=s[0],c=s[1],u=l?n:n.slice(0,r),d=Object(yt.isChangeGateEnabled)("OfficeVSO:8221421_DataCleansingDisplayTextVariationsInSingleColumn");return O.createElement(Qe.a,null,O.createElement(Qe.a,Object(k.__assign)({verticalAlign:"center"},d?void 0:{horizontal:!0,wrap:!0,horizontalAlign:"space-between"},{styles:{root:{margin:"8px 0",outline:"none"}},tokens:{childrenGap:"6px 0"}}),u.map((function(e){return O.createElement(Ht.a,{name:e.value,key:e.value,label:e.value,checked:e.isSelected,onChange:a,onRenderLabel:sb,styles:Object(k.__assign)(Object(k.__assign)({text:{fontSize:12}},d?void 0:{root:{width:"49%"}}),{checkbox:{height:16,width:16},label:{maxWidth:"100%",whiteSpace:"pre"}})})}))),n.length>r&&O.createElement(Qe.a,{horizontalAlign:d?"start":"end",styles:{root:{marginBottom:4}}},O.createElement(be.a,{styles:{root:{fontSize:12,height:20}},onClick:function(){return c((function(e){return!e}))}},l?i.TextInconsistencyIssue_ShowLess:i.TextInconsistencyIssue_ShowAll)))},sb=function(e,t){return O.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis"}},O.createElement(Z.a,{content:O.createElement(ib,{text:null==e?void 0:e.label,wrap:!0}),overflowMode:Zf.a.Parent},null==t?void 0:t({label:O.createElement(ib,{text:null==e?void 0:e.label})})))},lb=n(1138);function cb(e,t){switch(e.type){case vf.TextInconsistency:return ub[vf.TextInconsistency](e,t);case vf.NumberFormatInconsistency:return ub[vf.NumberFormatInconsistency](e,t)}return e}!function(e){e[e.NoChange=0]="NoChange",e[e.ReplacementValue=1]="ReplacementValue",e[e.VariationSelection=2]="VariationSelection",e[e.CustomNumberFormat=3]="CustomNumberFormat"}(rb||(rb={}));var ub=((ob={})[vf.TextInconsistency]=function(e,t){var n,o,r=Object(k.__assign)(Object(k.__assign)({},e),{variations:e.variations.map((function(e){return Object(k.__assign)({},e)}))});switch(t.type){case rb.NoChange:break;case rb.VariationSelection:var i=null===(n=r.variations)||void 0===n?void 0:n.find((function(e){return(null==e?void 0:e.value)===t.variation}));i&&(i.isSelected=t.selected);break;case rb.ReplacementValue:r.replacementValue=t.value,null===(o=r.variations)||void 0===o||o.forEach((function(t){(null==t?void 0:t.value)===e.replacementValue&&(t.isSelected=!0),(null==t?void 0:t.value)===r.replacementValue&&(t.isSelected=!1)}))}return r},ob[vf.NumberFormatInconsistency]=function(e,t){var n,o,r=Object(k.__assign)(Object(k.__assign)({},e),{formats:e.formats.map((function(e){return Object(k.__assign)({},e)}))});switch(t.type){case rb.NoChange:break;case rb.ReplacementValue:r.replacementFormat=t.value;break;case rb.CustomNumberFormat:var i=null!==(o=null===(n=e.formats)||void 0===n?void 0:n.filter((function(e){return(null==e?void 0:e.key)!==t.format.key})))&&void 0!==o?o:[];r.formats=Object(k.__spreadArray)(Object(k.__spreadArray)([],i,!0),[t.format],!1),r.replacementFormat=t.format.key}return r},ob);var db=n(1106),pb=function(e){var t=e.actionsRef,n=e.onChange,o=e.onPendingValueChanged,r=Object(k.__rest)(e,["actionsRef","onChange","onPendingValueChanged"]),l=O.useRef(),c=O.useRef(!1);return O.useEffect((function(){t&&(t.current={flushChangeEvent:function(){void 0!==l.current&&(c.current=!0,null==n||n({},void 0,void 0,l.current),i.a.sendTraceTag(540354722,a.a.msoulscat_ES_EWAJS,s.a.Info,"FlushableComboBox: flushed change event"))}})}),[t,n]),O.createElement(db.a,Object(k.__assign)({},r,{onPendingValueChanged:function(e,t,n){void 0!==n&&(l.current=n),null==o||o(e,t,n)},onChange:function(e,t,o,r){var s;c.current?(c.current=!1,i.a.debugAssertTag(540312162,a.a.msoulscat_ES_EWAJS,l.current===(null!==(s=null==t?void 0:t.text)&&void 0!==s?s:r),"FlushableComboBox: Skipped with a different value")):null==n||n(e,t,o,r),l.current=void 0}}))};function hb(e){switch(e){case"Leading":return 0;case"Trailing":return 1;case"InBetween":return 2;default:throw new TypeError("".concat(e," is not supported for ExtraSpacesPaddingType"))}}function gb(e){switch(e){case"AllNumber":return yf.AllNumber;case"AllText":return yf.AllText;case"MixedNumberAndText":return yf.MixedNumberAndText;default:throw new TypeError("".concat(e," is not supported for NumberFormatVariationsType"))}}function mb(e){switch(e){case vf.ExtraSpacesTable:case vf.ExtraSpaces:return"ExtraSpaces";case vf.TextInconsistency:return"TextInconsistency";case vf.NumberFormatInconsistency:return"NumberFormatInconsistency";default:return"UnknownSuggestionType"}}function fb(e){switch(e){case yf.AllNumber:return"AllNumber";case yf.AllText:return"AllText";case yf.MixedNumberAndText:return"MixedNumberAndText";case void 0:default:return"UnknownNumberFormatVariationType"}}function bb(e){switch(e){case 0:return"Leading";case 1:return"Trailing";case 2:return"InBetween";default:return"UnknownExtraSpacesPaddingType"}}function vb(e,t){return new Set(Array.from(e).filter((function(e){return!t.has(e)})))}function yb(e,t){return e.reduce((function(e,n){var o=t(n);return o in e?e[o]++:e[o]=1,e}),{})}function xb(e){var t=[];return e.forEach((function(e){return t.push.apply(t,e)})),t}function Cb(e){return e.reduce((function(e,t){return function(e,t){var n=t.tableIdentifier;if(!n)return;n in e||(e[n]={});!function(e,t){var n=mb(t.type);n in e||(e[n]=0);e[n]++}(e[n],t)}(e,t),e}),{})}function Sb(e,t,n){void 0===n&&(n="");var o=mb(e.type);i.a.sendTraceTag(509219931,a.a.msoulscat_ES_EWAJS,s.a.Important,"sendApplyTelemetry: applied ".concat(o," in [sheetId: ").concat(t," tableId: ").concat(e.tableIdentifier,"] ").concat(n))}function Eb(e){return yb(xb(e.filter(Sf).map((function(e){return Array.from(function(e){return new Set(xb(e.variations.map((function(e){return e.linters}))))}(e).values())}))),(function(e){return e}))}function kb(e,t,n){var o;n.logIgnoreDataForSuggestions(e,t),i.a.sendTraceTag(509720396,a.a.msoulscat_ES_EWAJS,s.a.Important,"useAnnotationsSuggestions: ".concat(JSON.stringify(((o={}).sheetId=e,o.suggestionsInfo=Cb(t),o.textInconsistencyLinters=Eb(t),o.extraSpacesTypes=function(e){return yb(e.filter(Cf),(function(e){return bb(e.extraSpacesType)}))}(t),o.numberFormatTypes=function(e){return yb(e.filter(Ef),(function(e){var t;return fb(null!==(t=e.variationsType)&&void 0!==t?t:void 0)}))}(t),o))))}var Ob=function(e,t){return{name:e,dataType:0,value:t}},Tb=function(e,t){return{name:e,dataType:1,value:t}},Ib=[Ob("featureNameField","DataCleansing"),Ob("ver","1.0.0")],wb={dataCategories:tp.DataCategories.ProductServiceUsage,samplingPolicy:tp.SamplingPolicy.Measure,diagnosticLevel:tp.DiagnosticLevel.Optional},_b={eventName:"Office.Excel.DataCleansing.Seen",eventFlags:wb,dataFields:Object(k.__spreadArray)(Object(k.__spreadArray)([],Ib,!0),[Tb("isFeatureSeen",!0)],!1)},Pb={eventName:"Office.Excel.DataCleansing.Tried",eventFlags:wb,dataFields:Object(k.__spreadArray)(Object(k.__spreadArray)([],Ib,!0),[Tb("isFeatureTried",!0)],!1)},Rb={eventName:"Office.Excel.DataCleansing.Succeeded",eventFlags:wb,dataFields:Object(k.__spreadArray)(Object(k.__spreadArray)([],Ib,!0),[Tb("isFeatureSucceeded",!0)],!1)},Db=O.createContext(void 0);function jb(){return O.useContext(Db)}var Bb=Db.Provider;function Fb(){var e=bf(),t=jb(),n=rf();return O.useCallback((function(o){null==t||t.showToast({key:"undo_suggestion",message:o,actionMessage:e.ConfirmationCallout_UndoButton,action:null==n?void 0:n.undoLastAppliedSuggestion,onDismiss:null==n?void 0:n.reportSuggestionSucceeded})}),[e,n,t])}var Lb,Mb=n(2301),Ab=[vf.ExtraSpacesTable,vf.ExtraSpaces,vf.TextInconsistency,vf.NumberFormatInconsistency];function Nb(e,t){if(!e||!t)return e?-1:1;var n,o,r,i,a,s,l=e.suggestionRange,c=t.suggestionRange;return Wb(e.tableRange,t.tableRange)||Hb(l,c)||(n=e.type,o=t.type,r=Ab.indexOf(n),i=Ab.indexOf(o),a=r<0?Ab.length:r,s=i<0?Ab.length:i,a-s)||zb(l,c)}function Wb(e,t){return Hb(e,t)||zb(e,t)}function Hb(e,t){return e.left-t.left}function zb(e,t){return e.top-t.top}function Vb(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)}}var Gb=((Lb={})[vf.ExtraSpacesTable]={getSuggestionAffectedRanges:function(e){return xb(Array.from(e.rangesByType.values()))},canApplySuggestion:function(e){return!0}},Lb[vf.ExtraSpaces]={getSuggestionAffectedRanges:function(e){return e.ranges},canApplySuggestion:function(e){return!0}},Lb[vf.TextInconsistency]={getSuggestionAffectedRanges:function(e){return Kb(e.variations.filter((function(t){return t.ranges&&t.isSelected&&t.value!==e.replacementValue})))},canApplySuggestion:function(e){var t;return Boolean(e.replacementValue&&(null===(t=e.variations)||void 0===t?void 0:t.some((function(t){return(null==t?void 0:t.isSelected)&&t.value!==e.replacementValue}))))}},Lb[vf.NumberFormatInconsistency]={getSuggestionAffectedRanges:function(e){return Kb(e.formats.filter((function(t){return t.format!==e.replacementFormat||!t.isApplicable})))},canApplySuggestion:function(e){var t,n;return null!==(n=null===(t=e.formats)||void 0===t?void 0:t.some((function(e){return null==e?void 0:e.isApplicable})))&&void 0!==n&&n}},Lb);function Ub(e){switch(null==e?void 0:e.type){case vf.ExtraSpacesTable:case vf.ExtraSpaces:case vf.TextInconsistency:case vf.NumberFormatInconsistency:return Gb[e.type].canApplySuggestion(e);default:return!1}}function qb(e){var t=[];switch(null==e?void 0:e.type){case vf.ExtraSpacesTable:case vf.ExtraSpaces:case vf.TextInconsistency:case vf.NumberFormatInconsistency:t=Gb[e.type].getSuggestionAffectedRanges(e)}return function(e){for(var t,n,o,r,i=e.sort(Wb),a=[],s=0;s<i.length;s++){for(;s<i.length-1&&(t=i[s],n=i[s+1],o=void 0,r=void 0,o=t.left===n.left&&t.right===n.right,r=n.top-t.bottom<=1,o&&r);)i[s+1]=Vb(i[s+1],i[s]),s++;a.push(i[s])}return a}(t)}function Qb(e,t,n){var o=Object(yt.isChangeGateEnabled)("OfficeVSO:8339329_DataCleansingIgnore"),r=e.filter((function(e){return!n.has(e.id)})),l=o?r.filter((function(e){return!t(e)})):r;return i.a.sendTraceTag(508699847,a.a.msoulscat_ES_EWAJS,s.a.Info,"filterHiddenSuggestions: ".concat(l.length," out of ").concat(e.length," returned. (removed ").concat(e.length-r.length," applied, ").concat(r.length-l.length," ignored)")),l}function Kb(e){return xb(e.map((function(e){return e.ranges})))}var Jb=function(e){var t,n,o=e.suggestion,r=e.isSelected,i=e.baseSuggestionCardProps,a=rf(),s=uf(),l=bf(),c=_f(),u=O.useRef(),d=null!==(t=function(e){return e.replacementValue||null}(o))&&void 0!==t?t:void 0,p=Fb();function h(e,t,n,r){var i,s;null===(i=null==a?void 0:a.onSuggestionValuesChanged)||void 0===i||i.call(a,cb(o,{type:rb.ReplacementValue,value:null!==(s=null==t?void 0:t.text)&&void 0!==s?s:r}))}var g=function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(k.__generator)(this,(function(i){switch(i.label){case 0:return e=qb(o),t=o.variations.filter((function(e){return e.isSelected&&e.value!==o.replacementValue})),[4,null===(r=null==s?void 0:s.replaceMultipleStrings)||void 0===r?void 0:r.call(s,e,t.map((function(e){return e.value})),o.replacementValue,{matchCase:!1,matchEntireCell:!0,replaceWholeWordOnly:!1})];case 1:if(null==(n=i.sent()))throw new Error("TextInconsistencyCard.apply: returned a nullish value.");return[2,n]}}))}))};return O.createElement(nb,Object(k.__assign)({},i,{onApply:function(){var e,t,n;null===(e=u.current)||void 0===e||e.flushChangeEvent(),null===(n=null===(t=null==a?void 0:a.onSuggestionApplied)||void 0===t?void 0:t.call(a,o.id,g))||void 0===n||n.then((function(e){var t,n=1===e?l.TextInconsistencySuggestionApplicationConfirmationSingular:l.TextInconsistencySuggestionApplicationConfirmationPlural,r=1===e?{}:{changedVariationsCount:e};p(O.createElement(lb.a,{message:n,values:r}));var i="Linters: [".concat(function(e){for(var t=0,n=e.variations;t<n.length;t++){var o=n[t];if(o.value===e.replacementValue)return o.linters}return["UserCustomValue"]}(o),"]");Sb(o,null==c?void 0:c.sheetId,i),null===(t=null==s?void 0:s.sendOtelEvent)||void 0===t||t.call(s,Pb)})).catch((function(){}))},title:Object(yt.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase1")?l.TextInconsistencyCardTitle:l.TextInconsistencyCard_Title,applyString:l.TextInconsistencyCard_Apply,ignoreString:l.TextInconsistencyCard_Ignore,disableApply:!function(){var e;return null===(e=null==a?void 0:a.canApplySuggestion)||void 0===e?void 0:e.call(a,o.id)}(),isSelected:r,range:o.columnName,rangeTooltipString:null!==(n=o.columnName)&&void 0!==n?n:void 0}),O.createElement(uo.a,{variant:"smallPlus",block:!0,styles:{root:{cursor:"default"}}},Object(yt.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase1")?O.createElement(lb.a,{message:l.TextInconsistencyCard_Message,values:{column:O.createElement("b",null,o.columnTitle)}}):O.createElement(lb.a,{message:l.TextInconsistencyCard_VariationsDetails,values:{value:O.createElement("b",{style:{overflowWrap:"break-word"}},"‘",o.suggestedValue,"’"),variationsNumber:O.createElement("b",null,o.variations.length)}})),O.createElement(ab,{variations:o.variations,onChange:function(e,t){var n;void 0===t&&(t=!1),null===(n=null==a?void 0:a.onSuggestionValuesChanged)||void 0===n||n.call(a,cb(o,{type:rb.VariationSelection,selected:t,variation:e}))}}),O.createElement(pb,{allowFreeform:!0,autoComplete:"off",text:d,onChange:h,onPendingValueChanged:function(e,t,n){n&&n!==d&&h(0,e,0,n)},onRenderItem:Zb,actionsRef:u,styles:{root:{height:25},input:{fontSize:12},label:{fontSize:12}},comboBoxOptionStyles:{optionText:{fontSize:12}},label:l.TextInconsistencyCard_VariationsDropdownTitle,useComboBoxAsMenuWidth:!0,options:o.variations.map((function(e){return{key:e.value,text:e.value}}))}))},Zb=function(e,t){return e&&t?t(Object(k.__assign)(Object(k.__assign)({},e),{title:e.text,text:O.createElement(ib,{text:e.text})})):null},Yb=n(938),Xb=n(225),$b={dropdown:{height:24,lineHeight:24,fontSize:12},title:{height:24,lineHeight:24},caretDownWrapper:{lineHeight:24},dropdownItem:{fontSize:12,height:28},dropdownItemSelected:{fontSize:12,height:28}},ev=function(e){var t,n,o,r,l,c,u=e.suggestion,d=e.isSelected,p=e.baseSuggestionCardProps,h=O.useState(null!==(r=u.replacementFormat)&&void 0!==r?r:void 0),g=h[0],m=h[1],f=rf(),b=uf(),v=bf(),y=_f(),x=function(e){var t=bf();if(void 0===e)return i.a.sendTraceTag(509436363,a.a.msoulscat_ES_EWAJS,s.a.Error,"NumberFormatInconsistencyCard.useSuggestionDescriptionByType: type is undefined"),"";switch(e){case yf.AllNumber:return t.NumberFormatInconsistencyCard_MixOfNumberIssue;case yf.AllText:return Object(Xb.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase2")?t.NumberFormatInconsistencyCard_MixTextIssue:t.NumberFormatInconsistencyCard_MixOfTextIssue;case yf.MixedNumberAndText:return t.NumberFormatInconsistencyCard_MixOfNumberAndTextIssue;default:Object(Yb.a)(e)}}(null!==(l=u.variationsType)&&void 0!==l?l:void 0),C=Fb(),S=u.formats.filter((function(e){return e.isApplicable})).map((function(e){var t,n;return{key:null!==(n=null!==(t=e.key)&&void 0!==t?t:e.format)&&void 0!==n?n:e.value,text:e.value}})),E=[{key:"divider",text:"",itemType:Ut.a.Divider},{key:"MoreNumberFormats",text:v.NumberFormatInconsistencyCard_MoreNumberFormats}],T=Object(k.__spreadArray)(Object(k.__spreadArray)([],S,!0),E,!0);var I=function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:return e=qb(u),t=u.formats.find((function(e){return e.key===u.replacementFormat})),[4,null===(n=b.formatCells)||void 0===n?void 0:n.call(b,e,Object(Xb.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase2")?"General":null==t?void 0:t.format)];case 1:if(null==o.sent())throw new Error("NumberFormatInconsistencyCard.apply: returned a nullish value.");return[2,-1]}}))}))};return O.createElement(nb,Object(k.__assign)({},p,{onApply:function(){var e,t;null===(t=null===(e=null==f?void 0:f.onSuggestionApplied)||void 0===e?void 0:e.call(f,u.id,I))||void 0===t||t.then((function(){var e,t;C(v.NumberFormattingInconsistencySuggestionApplicationConfirmation);var n="type: [".concat(fb(null!==(e=u.variationsType)&&void 0!==e?e:void 0),"]");Sb(u,null==y?void 0:y.sheetId,n),null===(t=null==b?void 0:b.sendOtelEvent)||void 0===t||t.call(b,Pb)})).catch((function(){}))},title:Object(Xb.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase2")?v.NumberFormatInconsistencyCard_NumberFormatTitle:v.NumberFormatInconsistencyCard_Title,applyString:v.NumberFormatInconsistencyCard_Apply,ignoreString:v.NumberFormatInconsistencyCard_Ignore,disableApply:!function(){var e;return null===(e=null==f?void 0:f.canApplySuggestion)||void 0===e?void 0:e.call(f,u.id)}(),isSelected:d,range:u.columnName,rangeTooltipString:null!==(c=u.columnName)&&void 0!==c?c:void 0}),O.createElement(uo.a,{variant:"smallPlus",block:!0,styles:{root:{paddingBottom:10,cursor:"default"}}},O.createElement(lb.a,{message:x,values:Object(Xb.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase2")?(t={column:O.createElement("b",null,u.columnTitle)},t.number=O.createElement("b",null,v.NumberFormatInconsistencyCard_Number),t.text=O.createElement("b",null,v.NumberFormatInconsistencyCard_Text),t):(n={},n.number=O.createElement("b",null,v.NumberFormatInconsistencyCard_Number),n.text=O.createElement("b",null,v.NumberFormatInconsistencyCard_Text),n)})),Object(Xb.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase2")?O.createElement(Ge.a,{styles:{root:{fontSize:12,marginTop:12,marginBottom:2}}},O.createElement(lb.a,{message:v.NumberFormatInconsistencyCard_Message,values:(o={text:O.createElement("b",null,v.NumberFormatInconsistencyCard_Text)},o.number=O.createElement("b",null,v.NumberFormatInconsistencyCard_Number),o)})):O.createElement(qe.a,{selectedKey:g,onChange:function(e,t,n){var o,r,l,c;"MoreNumberFormats"===(null==t?void 0:t.key)?null===(r=null===(o=null==b?void 0:b.openCustomNumberFormat)||void 0===o?void 0:o.call(b))||void 0===r||r.then((function(e){var t,n=cb(u,e?{type:rb.CustomNumberFormat,format:{format:e,ranges:[],isApplicable:!0,key:v.NumberFormatInconsistencyCard_Custom,value:v.NumberFormatInconsistencyCard_Custom}}:{type:rb.ReplacementValue,value:String(u.suggestedFormat)});null===(t=null==f?void 0:f.onSuggestionValuesChanged)||void 0===t||t.call(f,n),m(n.replacementFormat)})).catch((function(e){i.a.sendTraceTag(523638883,a.a.msoulscat_ES_EWAJS,s.a.Error,"NumberFormatInconsistencyCard.onSelectedValueChanged: ".concat(e))})):(null===(l=null==f?void 0:f.onSuggestionValuesChanged)||void 0===l||l.call(f,cb(u,{type:rb.ReplacementValue,value:String(null!==(c=null==t?void 0:t.key)&&void 0!==c?c:"")})),m(null==t?void 0:t.key))},styles:$b,onRenderLabel:nv,options:T}))},tv=function(){var e=bf();return O.createElement(Ge.a,{styles:{root:{fontSize:12}}},e.NumberFormatInconsistencyCard_DropdownTitle)},nv=function(e){return O.createElement(tv,null)};var ov=" ####",rv="#### ",iv="####  ####",av=function(e){var t,n=e.suggestion,o=e.isSelected,r=e.baseSuggestionCardProps,i=Object(pf.a)(),a=rf(),s=uf(),l=bf(),c=_f(),u=function(e){var t=bf();switch(e){case 0:return{title:t.ExtraSpacesCard_TitleLeading,message:t.ExtraSpacesCard_MessageLeading,example:ov};case 1:return{title:t.ExtraSpacesCard_TitleTrailing,message:t.ExtraSpacesCard_MessageTrailing,example:rv};case 2:return{title:t.ExtraSpacesCard_TitleInBetween,message:t.ExtraSpacesCard_MessageInBetween,example:iv}}}(n.extraSpacesType),d=Fb(),p=function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:return[4,null===(t=null==s?void 0:s.trimWhitespace)||void 0===t?void 0:t.call(s,qb(n),[n.extraSpacesType])];case 1:if(null==(e=o.sent()))throw new Error("ExtraSpacesCard.apply: returned a nullish value.");return[2,e]}}))}))};return O.createElement(nb,Object(k.__assign)({},r,{onApply:function(){var e,t;null===(t=null===(e=null==a?void 0:a.onSuggestionApplied)||void 0===e?void 0:e.call(a,n.id,p))||void 0===t||t.then((function(e){var t,o=1===e?l.ExtraSpacesSuggestionApplicationConfirmationSingular:l.ExtraSpacesSuggestionApplicationConfirmationPlural,r=1===e?{}:{changedCellsCount:e};d(O.createElement(lb.a,{message:o,values:r}));var i="type: [".concat(bb(n.extraSpacesType),"] changedCellsCount: [").concat(e,"]");Sb(n,null==c?void 0:c.sheetId,i),null===(t=null==s?void 0:s.sendOtelEvent)||void 0===t||t.call(s,Pb)})).catch((function(){}))},title:null==u?void 0:u.title,applyString:l.ExtraSpacesCard_Apply,ignoreString:l.ExtraSpacesCard_Ignore,disableApply:!function(){var e;return null===(e=null==a?void 0:a.canApplySuggestion)||void 0===e?void 0:e.call(a,n.id)}(),isSelected:o,range:n.columnName,rangeTooltipString:null!==(t=n.columnName)&&void 0!==t?t:void 0,focusBeforeApply:!0}),O.createElement(uo.a,{variant:"smallPlus",block:!0,styles:{root:{cursor:"default"}}},null==u?void 0:u.message),O.createElement(Ge.a,{styles:{root:{fontSize:12,marginTop:12,marginBottom:2}}},l.ExtraSpacesCard_RemoveExtraSpacesQuestion),O.createElement(uo.a,{variant:"small",styles:{root:{borderColor:i.palette.neutralQuaternary,borderWidth:1,borderStyle:"solid",fontWeight:600,padding:4,cursor:"default"}}},O.createElement(ib,{text:null==u?void 0:u.example,variant:"thick"})))};var sv=function(e){var t,n=e.suggestion,o=e.isSelected,r=e.baseSuggestionCardProps,i=Object(pf.a)(),a=rf(),s=uf(),l=bf(),c=_f(),u=Fb(),d=function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:return[4,null===(t=null==s?void 0:s.trimWhitespace)||void 0===t?void 0:t.call(s,qb(n),Array.from(n.rangesByType.keys()))];case 1:if(null==(e=o.sent()))throw new Error("ExtraSpacesTableSuggestion.apply: returned a nullish value.");return[2,e]}}))}))},p=Object(yt.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase1")?O.createElement(lb.a,{message:l.ExtraSpacesTableCard_TableMayHaveMessage,values:{tableName:O.createElement("b",null,n.tableName)}}):l.ExtraSpacesTableCard_Message;return O.createElement(nb,Object(k.__assign)({},r,{onApply:function(){var e,t;null===(t=null===(e=null==a?void 0:a.onSuggestionApplied)||void 0===e?void 0:e.call(a,n.id,d))||void 0===t||t.then((function(e){var t,o=1===e?l.ExtraSpacesSuggestionApplicationConfirmationSingular:l.ExtraSpacesSuggestionApplicationConfirmationPlural,r=1===e?{}:{changedCellsCount:e};u(O.createElement(lb.a,{message:o,values:r}));var i="";if(Object(yt.isChangeGateEnabled)("OfficeVSO:8281522_DataCleansingLogClaimedAffectedCellsCount")){var a=qb(n);i="claimedAffectedCellsCount: [".concat(a.reduce((function(e,t){return e+(t.bottom-t.top+1)*(t.right-t.left+1)}),0),"]")}var d="changedCellsCount: [".concat(e,"] ").concat(i);Sb(n,null==c?void 0:c.sheetId,d),null===(t=null==s?void 0:s.sendOtelEvent)||void 0===t||t.call(s,Pb)})).catch((function(){}))},title:l.ExtraSpacesTableCard_Title,applyString:l.ExtraSpacesTableCard_Apply,ignoreString:l.ExtraSpacesTableCard_Ignore,disableApply:!function(){var e;return null===(e=null==a?void 0:a.canApplySuggestion)||void 0===e?void 0:e.call(a,n.id)}(),isSelected:o,range:n.tableName,rangeTooltipString:null!==(t=n.tableName)&&void 0!==t?t:void 0,focusBeforeApply:!0}),O.createElement(uo.a,{variant:"smallPlus",block:!0,styles:{root:{cursor:"default"}}},p),O.createElement(Ge.a,{styles:{root:{fontSize:12,marginTop:12,marginBottom:2}}},Object(yt.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase1")?l.ExtraSpacesTableCard_RemoveQuestion:O.createElement(lb.a,{message:l.ExtraSpacesTableCard_RemoveExtraSpacesQuestion,values:{tableName:n.tableName}})),O.createElement(uo.a,{variant:"small",styles:{root:{borderColor:i.palette.neutralQuaternary,borderWidth:1,borderStyle:"solid",fontWeight:600,padding:4,cursor:"default"}}}))};function lv(e,t){return 0===t?0:(e%t+t)%t}var cv=function(e){var t=e.ranges,n=e.isCardSelected,o=Object(pf.a)(),r=uf(),l=bf(),c=O.useState({index:-1}),u=c[0],d=c[1];O.useEffect((function(){n||d({index:-1})}),[n]),O.useEffect((function(){d({index:-1})}),[t]),Object(Uf.a)((function(){var e;-1!==u.index&&(null===(e=r.highlightRangesOnGrid)||void 0===e||e.call(r,[],!0,1))})),O.useEffect((function(){var e;null===(e=r.highlightRangesOnGrid)||void 0===e||e.call(r,-1===u.index?[]:[u.cell],!0,1)}),[u,r]);var p={root:{height:V.k.size24,width:V.k.size24}};return O.createElement(Qe.a,{horizontal:!0,styles:{root:{flexGrow:1}},horizontalAlign:"end",verticalAlign:"center"},O.createElement(Ba.a,{iconProps:{iconName:W.a.CommonControlChevronUp_16},title:l.GridNavigationArrow_Previous,styles:p,disabled:0===t.length,onClick:function(){d((function(e){var n=e.index,o=lv(n>=0?n-1:n,t.length);return i.a.sendTraceTag(509747720,a.a.msoulscat_ES_EWAJS,s.a.Important,"GridNavigation: previous button was clicked. indexBeforeClick: ".concat(n,"/").concat(t.length,"  indexAfterClick: ").concat(o,"/").concat(t.length)),{index:o,cell:t[o]}}))}}),O.createElement(uo.a,{styles:{root:{margin:0,textAlign:"center",minWidth:V.k.size32,fontSize:V.k.size12,color:o.palette.neutralDark}}},O.createElement(lb.a,{message:l.GridNavigation_Summary,values:{current:u.index+1,count:t.length}})),O.createElement(Ba.a,{iconProps:{iconName:W.a.CommonControlChevronDown_16},title:l.GridNavigationArrow_Next,styles:p,disabled:0===t.length,onClick:function(){d((function(e){var n=e.index,o=lv(n+1,t.length);return i.a.sendTraceTag(509747719,a.a.msoulscat_ES_EWAJS,s.a.Important,"GridNavigation: next button was clicked. indexBeforeClick: ".concat(n,"/").concat(t.length,"  indexAfterClick: ").concat(o,"/").concat(t.length)),{index:o,cell:t[o]}}))}}))},uv=O.memo((function(e){var t=e.suggestion,n=e.isSelected,o=O.useContext(qf).isHovered,r=rf(),l=O.useMemo((function(){return e=qb(t),n=[],e.forEach((function(e){return n.push.apply(n,function(e){for(var t=[],n=e.left,o=e.top;o<=e.bottom;o++)t.push({top:o,bottom:o,left:n,right:n});return t}(e))})),n;var e,n}),[t]),c={isSelected:n,showIgnore:Object(yt.isChangeGateEnabled)("OfficeVSO:8339329_DataCleansingIgnore"),focusBeforeApply:!0,onIgnore:function(){var e;return null===(e=null==r?void 0:r.onSuggestionIgnored)||void 0===e?void 0:e.call(r,t.id)},actionsRowStyle:{height:V.k.size20},additionalAction:o||n?O.createElement(cv,{ranges:l,isCardSelected:n}):void 0,showRangeBadge:!Object(yt.isChangeGateEnabled)("OfficeVSO:8318229_UpdateUICardsForPublicPreviewPhase1")};switch(t.type){case vf.TextInconsistency:return O.createElement(Jb,{key:t.id,suggestion:t,isSelected:n,baseSuggestionCardProps:c});case vf.NumberFormatInconsistency:return O.createElement(ev,{key:t.id,suggestion:t,isSelected:n,baseSuggestionCardProps:c});case vf.ExtraSpaces:return O.createElement(av,{key:t.id,suggestion:t,isSelected:n,baseSuggestionCardProps:c});case vf.ExtraSpacesTable:return O.createElement(sv,{key:t.id,suggestion:t,isSelected:n,baseSuggestionCardProps:c});default:return i.a.sendTraceTag(559748639,a.a.msoulscat_ES_EWAJS,s.a.Warning,"SuggestionCardRenderer: unknown suggestion type ".concat(t.type)),null}})),dv=function(e){var t=e.tableName,n=e.suggestions,o=e.selection,r=e.selectedSuggestionId;return O.createElement(O.Fragment,null,O.createElement(Gf,{name:t,sticky:!0}),O.createElement(Qe.a,{role:"group",key:t},n.map((function(e){var t=r===e.id;return O.createElement(Kf,{key:e.id,index:o.getItemIndex(e.id),suggestionId:e.id,isPreviewEnabled:0===o.getSelectedCount(),isSelected:t,onRemoved:function(){return o.setKeySelected(e.id,!1,!1)}},O.createElement(uv,{suggestion:e,isSelected:t}))}))))},pv=function(){var e=uf(),t=bf();return O.createElement(Qe.a,{horizontal:!1},O.createElement(et.a,{styles:{root:{fontSize:V.k.size12,marginTop:"15px",marginBottom:"14px"}},onClick:function(){var t;null===(t=e.openLearnMore)||void 0===t||t.call(e)}},t.LearnMore_Link))},hv=function(e){var t=e.selection,n=e.suggestions,o=e.selectedSuggestionId,r=e.containerStyle,i=O.useRef(null),a=O.useMemo((function(){return function(e,t){for(var n,o=new Map,r=0,i=e;r<i.length;r++){var a=i[r],s=t(a);o.has(s)||o.set(s,[]),null===(n=o.get(s))||void 0===n||n.push(a)}return o}(n,(function(e){return e.tableName}))}),[n]);return O.createElement(Ra.a,{selection:t},O.createElement(Da.a,{onBlur:function(e){var n=e.target,o=e.currentTarget,r=e.relatedTarget;!o.contains(r)&&(t.setAllSelected(!1),function(e,t){var n=e.querySelector("[data-selection-index='0']");n&&(n.tabIndex=0);n!==t&&(t.tabIndex=-1)}(o,n))},shouldFocusOnMount:!1,preventFocusRestoration:!0,isCircularNavigation:!1,componentRef:i,handleTabKey:Zt.b.none,direction:Zt.a.vertical,shouldEnterInnerZone:gv,shouldFocusInnerElementWhenReceivedFocus:!0,shouldResetActiveElementWhenTabFromZone:!0,onActiveElementChanged:function(e){var n,o=parseInt(null!==(n=null==e?void 0:e.dataset.selectionIndex)&&void 0!==n?n:"",10);isNaN(o)||t.isIndexSelected(o)||null==t||t.setIndexSelected(o,!0,!0)}},O.createElement(Qe.a,{role:"list","data-testid":"suggestions-list",className:"suggestions-list",styles:{root:r}},Array.from(a.entries()).map((function(e){var n=e[0],r=e[1];return O.createElement(dv,{key:n,tableName:n,suggestions:r,selection:t,selectedSuggestionId:o})})),Object(yt.isChangeGateEnabled)("OfficeVSO:8318126_AddingCleanDataSupportArticle")&&O.createElement(pv,null))))};function gv(e){return e.keyCode===z.a.right||e.keyCode===z.a.enter}var mv=function(e){var t=e.sheetName,n=e.suggestionCount,o=bf(),r=Object(pf.a)();if(!t)return null;var i={root:{fontSize:V.k.size14,fontWeight:V.l.semibold,color:r.palette.neutralDark,cursor:"default"}};return O.createElement(O.Fragment,null,O.createElement(uo.a,{styles:i},t),O.createElement("div",{style:{flexGrow:1}}),O.createElement(Z.a,{content:o.SheetSuggestionsCount_Tooltip},O.createElement(uo.a,{styles:i},O.createElement(lb.a,{message:o.SheetSuggestionsCount_Count,values:{count:n}}))))},fv=function(e){var t,n,o=e.worksheetState,r=e.suggestions,l=e.filterHint,c=uf(),u=jf(),d=O.useState(),p=d[0],h=d[1];O.useEffect((function(){!function(){var e;Object(k.__awaiter)(this,void 0,void 0,(function(){var t;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return(null==r?void 0:r.length)?[4,null===(e=null==c?void 0:c.containsHiddenCells)||void 0===e?void 0:e.call(c,r.map((function(e){return null==e?void 0:e.suggestionRange})))]:[3,2];case 1:(null==(t=n.sent())?void 0:t.length)&&i.a.sendTraceTag(520176270,a.a.msoulscat_ES_EWAJS,s.a.Info,"DataCleansingTaskPane: ".concat(t.length," suggestions with hidden cells displayed")),n.label=2;case 2:return[2]}}))}))}()}),[c,r]);var g=O.useMemo((function(){var e=function(e,t){if(t){var n=t.filterTables,o=t.filterSuggestionTypes;if(o.length!==kf.length||n.length!==e.size)return function(e){return o.includes(e.type)&&n.includes(e.tableName)}}return function(){return!0}}(new Set(r.map((function(e){return e.tableName}))),u),t=r.filter(e);return i.a.sendTraceTag(508843220,a.a.msoulscat_ES_EWAJS,s.a.Info,"SuggestionsManager: Filter: ".concat(t.length," out of ").concat(r.length," suggestions left")),t}),[r,u]),m=0===g.length&&g.length<r.length;O.useEffect((function(){m&&i.a.sendTraceTag(540840334,a.a.msoulscat_ES_EWAJS,s.a.Info,"SuggestionsManager: No suggestions after filtering")}),[m]);var f=function(e,t){var n=rf(),o=O.useState((function(){var r=null,i={items:e,getKey:function(e){return e.id},selectionMode:Pi.d.single,onSelectionChanged:function(){var e,i;null!==r&&(null===(e=null==n?void 0:n.onSuggestionDeselected)||void 0===e||e.call(n,r),r=null);var a=o.getSelection()[0];a&&(null===(i=null==n?void 0:n.onSuggestionSelected)||void 0===i||i.call(n,a.id),r=a.id),t(a)}};return new wi.a(i)}))[0];return O.useEffect((function(){o.setItems(e,!1)}),[e,o]),o}(g,(function(e){var t;h(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:void 0)}));return O.createElement(O.Fragment,null,O.createElement(Qe.a,{verticalAlign:"center",horizontal:!0},O.createElement(Ff,{key:o.sheetId,suggestions:r,isFiltered:g.length!==r.length,filterHint:l,sheetId:null!==(t=o.sheetId)&&void 0!==t?t:void 0}),O.createElement(mv,{sheetName:null!==(n=o.sheetName)&&void 0!==n?n:"",suggestionCount:g.length})),O.createElement(zf,null),m?O.createElement(Af,null):O.createElement(He,{trackWidth:ey/2,containerStyle:{width:"calc(100% + ".concat(ey,"px)")}},O.createElement(hv,{suggestions:g,selectedSuggestionId:p,selection:f,containerStyle:{padding:"0 ".concat(ey,"px 0 0")}})))};var bv=function(e){var t=e.feedbackOrigin,n=void 0===t?"DataCleansingTaskPane":t,o=bf(),r=uf();return(null==r?void 0:r.openFeedback)?O.createElement(rn.a,{styles:{root:{border:"none",width:"100%",padding:"1.5em 0",borderRadius:"3px",boxShadow:Jf.a.depth8},label:{fontWeight:V.l.regular},rootHovered:{boxShadow:Jf.a.depth16}},onClick:function(){var e;null===(e=r.openFeedback)||void 0===e||e.call(r,n)},text:o.Feedback_Button}):null},vv=function(){var e=bf();return O.createElement(Mf,{testId:"BlockedInCoauthoring",title:e.BlockedInCoauthoring_Title,subTitle:e.BlockedInCoauthoring_SubHeader})},yv=function(){var e=bf();return O.createElement(Mf,{testId:"BlockedInSheetView",title:e.BlockedInSheetView_Title,subTitle:e.BlockedInSheetView_SubHeader})},xv=function(){var e=bf();return O.createElement(Mf,{testId:"BlockedInViewMode",title:e.BlockedInViewMode_Title,subTitle:e.BlockedInViewMode_SubHeader})},Cv=function(){var e=bf();return O.createElement(Mf,{testId:"BlockedInProtectedSheet",title:e.BlockedInProtectedSheet_Title,subTitle:e.BlockedInProtectedSheet_SubHeader})},Sv=function(){var e=bf(),t=Hf();return O.useEffect((function(){(null==t?void 0:t.canRefresh)&&i.a.sendTraceTag(509694288,a.a.msoulscat_ES_EWAJS,s.a.Warning,"EmptySuggestions but refresh annotations button wants to be rendered")}),[t]),O.createElement(Mf,{testId:"EmptyState",title:e.NoSuggestionTitle,subTitle:e.NoSuggestionSubheader})},Ev=function(){var e=bf();return O.createElement(Mf,{testId:"BlockedInError",title:e.ErrorStateTitle,subTitle:e.ErrorStateSubheader})},kv=function(){var e=bf();return O.createElement(Mf,{testId:"DataExceedsLimit",title:e.ErrorStateDataExceedsLimitTitle,subTitle:e.ErrorStateDataExceedsLimitSubheader})},Ov=function(e){var t=e.messageId;switch(O.useEffect((function(){i.a.sendTraceTag(509690120,a.a.msoulscat_ES_EWAJS,s.a.Info,"Message type changed to ".concat(t))}),[t]),t){case bm.BlockedInCoauthoring:return O.createElement(vv,null);case bm.BlockedInSheetView:return O.createElement(yv,null);case bm.BlockedInViewMode:return O.createElement(xv,null);case bm.BlockedInProtectedSheet:return O.createElement(Cv,null);case bm.NoSuggestions:return O.createElement(Sv,null);case bm.DataExceedsLimit:return O.createElement(kv,null);case bm.GeneralError:return O.createElement(Ev,null);case bm.None:return null;default:Object(Yb.a)(t)}},Tv=function(e){var t,n=e.worksheetState,o=e.suggestions,r=e.messageType,i=void 0===r?bm.None:r,a=e.viewState,s=void 0===a?vm.LoadingSuggestions:a,l=e.discoverability,c=e.isFeedbackAllowed,u=uf(),d=Boolean(null==o?void 0:o.length);O.useEffect((function(){var e;d&&(null===(e=null==u?void 0:u.sendOtelEvent)||void 0===e||e.call(u,_b))}),[d,u]);var p=s===vm.Disabled,h=s===vm.LoadingSuggestions,g=s===vm.DisplaySuggestions,m=Object(yt.isChangeGateEnabled)("OfficeVSO:7985428_AddingIsFeedbackAllowed")?c&&g:g,f=d||p||i!==bm.None?i:bm.NoSuggestions;return O.createElement(Qe.a,{verticalFill:!0,tokens:{childrenGap:6}},h?O.createElement(nf,null):O.createElement(O.Fragment,null,O.createElement(Ov,{messageId:f}),g&&d&&o&&O.createElement(fv,{worksheetState:n,suggestions:o,filterHint:null!==(t=null==l?void 0:l.filterHint)&&void 0!==t?t:void 0}),m&&O.createElement("div",{style:{flexGrow:1}}),m&&O.createElement(bv,null)))};function Iv(e,t){var n;return(null==e?void 0:e.errorState)?function(e){switch(e){case"EcsProxyClose_MaxNumberOfNonEmptyCellsExceeded":case"EcsProxyClose_MaxRangeRequestsInSeedExceeded":return bm.DataExceedsLimit;default:return bm.GeneralError}}(null!==(n=null==e?void 0:e.errorState)&&void 0!==n?n:void 0):(null==e?void 0:e.isInViewMode)?bm.BlockedInViewMode:(null==e?void 0:e.isInCoauthoring)?bm.BlockedInCoauthoring:(null==t?void 0:t.isInNamedSheetView)?bm.BlockedInSheetView:(null==t?void 0:t.isProtected)?bm.BlockedInProtectedSheet:bm.None}var wv;function _v(e,t){return t instanceof Set?{__serializable__:wv.set,values:Array.from(t)}:t instanceof Map?{__serializable__:wv.map,entries:Array.from(t)}:t}function Pv(e,t){if(Rv(t))switch(t.__serializable__){case wv.set:return new Set(t.values);case wv.map:return new Map(t.entries);default:return t}return t}function Rv(e){return null!==e&&"object"==typeof e&&"__serializable__"in e&&"string"==typeof e.__serializable__&&e.__serializable__ in wv}!function(e){e.set="set",e.map="map"}(wv||(wv={}));var Dv=n(2261),jv=function(){function e(e,t){var n=this;this.onTimeout=e,this.timeout=t,this.start=function(){n.stop(),n.timerId=setTimeout(n.end,n.timeout)},this.stop=function(){n.running&&(clearTimeout(n.timerId),n.timerId=void 0)},this.end=function(){n.running&&(n.stop(),n.onTimeout())}}return Object.defineProperty(e.prototype,"running",{get:function(){return void 0!==this.timerId},enumerable:!1,configurable:!0}),e}(),Bv=function(){function e(e){this.rerender=e,this.allowMultipleToasts=!1,this.toastsByKeys=new Map,this.timerByKeys=new Map,this.actionsByKeys=new Map,this.orderedToasts=[]}return e.prototype.showToast=function(e,t){var n=this;void 0===t&&(t=5e3);var o=e.key;i.a.sendTraceTag(508638029,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: showToast: ".concat(o)),this.allowMultipleToasts?this.removeToast(o):this.removeAllToasts();var r=new jv((function(){var t;i.a.sendTraceTag(508638028,a.a.msoulscat_ES_EWAJS,s.a.Verbose,"ToastManager: timer ended: ".concat(o,", hiding toast")),null===(t=e.onDismiss)||void 0===t||t.call(e),n.hideToast(o,!1)}),t);r.start(),this.timerByKeys.set(o,r),this.toastsByKeys.set(o,e),"function"==typeof e.action&&this.actionsByKeys.set(o,(function(){var e,t,r;i.a.sendTraceTag(508638027,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: actionClick: ".concat(o)),null===(e=n.timerByKeys.get(o))||void 0===e||e.stop(),null===(r=null===(t=n.toastsByKeys.get(o))||void 0===t?void 0:t.action)||void 0===r||r.call(t),n.hideToast(o)})),this.orderedToasts.push(e),this.render()},e.prototype.hideToast=function(e,t){void 0===t&&(t=!0),this.removeToast(e,t)&&(i.a.sendTraceTag(508638026,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: hideToast: ".concat(e)),this.render())},e.prototype.getActionForToast=function(e){return this.actionsByKeys.get(e)},e.prototype.onMouseEnter=function(e){var t;i.a.sendTraceTag(508638025,a.a.msoulscat_ES_EWAJS,s.a.Verbose,"ToastManager onMouseEnter: ".concat(e,", stopping timer")),null===(t=this.timerByKeys.get(e))||void 0===t||t.stop()},e.prototype.onMouseLeave=function(e){var t;i.a.sendTraceTag(508638024,a.a.msoulscat_ES_EWAJS,s.a.Verbose,"ToastManager onMouseLeave: ".concat(e,", starting timer")),null===(t=this.timerByKeys.get(e))||void 0===t||t.start()},e.prototype.removeToast=function(e,t){var n;return void 0===t&&(t=!1),i.a.sendTraceTag(508638023,a.a.msoulscat_ES_EWAJS,s.a.Info,"ToastManager: removeToast: ".concat(e,". endTimer: ").concat(t)),t&&(null===(n=this.timerByKeys.get(e))||void 0===n||n.end()),this.orderedToasts=this.orderedToasts.filter((function(t){return t.key!==e})),this.actionsByKeys.delete(e),this.timerByKeys.delete(e),this.toastsByKeys.delete(e)},e.prototype.removeAllToasts=function(){var e=this;new Set(this.orderedToasts.map((function(e){return e.key}))).forEach((function(t){e.removeToast(t)}))},e.prototype.render=function(){var e;null===(e=this.rerender)||void 0===e||e.call(this,this.allowMultipleToasts?this.orderedToasts:this.orderedToasts.slice(0,1))},e}(),Fv=function(e){var t=e.message,n=e.action,o=e.actionMessage,r=e.onMouseEnter,i=e.onMouseLeave,a=Object(pf.a)();return O.createElement("div",{onMouseEnter:r,onMouseLeave:i},O.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 12px"}},O.createElement(uo.a,{variant:"medium",styles:{root:{fontWeight:V.l.semibold,color:a.palette.neutralLighter,whiteSpace:"pre-line"}}},t),Boolean(n&&o)&&O.createElement(rn.a,{style:{backgroundColor:"transparent",color:a.palette.neutralLighter,maxHeight:"24px",minWidth:"54px",padding:"initial"},text:o,onClick:function(){return null==n?void 0:n()}})))},Lv=function(e){var t=e.targetRef,n=e.toasts,o=Object(pf.a)(),r=jb();return r&&n.length?O.createElement(wn.a,{calloutWidth:264,role:"dialog",directionalHint:Y.a.rightBottomEdge,coverTarget:!0,target:t,gapSpace:20,backgroundColor:o.palette.neutralPrimary,isBeakVisible:!1,style:{borderRadius:"4px"},styles:{root:{boxShadow:Jf.a.depth8,marginBottom:10}}},O.createElement(Qe.a,{tokens:{childrenGap:8}},n.map((function(e){var t=e.key,n=e.message,o=e.actionMessage;return O.createElement(Fv,{key:t,message:n,actionMessage:o,action:r.getActionForToast(t),onMouseEnter:function(){return r.onMouseEnter(t)},onMouseLeave:function(){return r.onMouseLeave(t)}})})))):null},Mv=function(e){return e.join("|")},Av=function(e){return e.join("/")},Nv=function(e){return Array.from(e).sort((function(e,t){return e.localeCompare(t)}))},Wv=function(e){return Array.from(new Set(Nv(e)))};function Hv(e,t){return[t,e.tableName,e.columnName]}function zv(e){var t,n;switch(e.type){case vf.TextInconsistency:var o=Nv(e.variations.map((function(e){return null==e?void 0:e.value})));return[mb(e.type),null!==(t=e.suggestedValue)&&void 0!==t?t:"<unknown>",Av(o)];case vf.NumberFormatInconsistency:var r=Nv(e.formats.map((function(e){return null==e?void 0:e.value})));return[mb(e.type),null!==(n=e.suggestedFormat)&&void 0!==n?n:"<unknown>",Av(r)];case vf.ExtraSpaces:return[mb(e.type),e.extraSpacesType];case vf.ExtraSpacesTable:return[mb(e.type)];default:return i.a.sendTraceTag(508601216,a.a.msoulscat_ES_EWAJS,s.a.Error,"suggestionIdentities.ruleId: Unknown suggestion type ".concat(e.type)),["<unknown>"]}}function Vv(e){var t,n;function o(e){var t="R".concat(e.top,"C").concat(e.left),n="R".concat(e.bottom,"C").concat(e.right);return t===n?t:"".concat(t,":").concat(n)}switch(e.type){case vf.TextInconsistency:var r=xb(e.variations.map((function(e){return e.ranges})));return[null!==(t=e.suggestedValue)&&void 0!==t?t:"<unknown>",Av(Wv(r.map(o)))];case vf.NumberFormatInconsistency:var l=xb(e.formats.map((function(e){return null==e?void 0:e.ranges})));return[null!==(n=e.suggestedFormat)&&void 0!==n?n:"<unknown>",Av(Wv(l.map(o)))];case vf.ExtraSpaces:return[Av(Wv(e.ranges.map(o)))];case vf.ExtraSpacesTable:return Array.from(e.rangesByType.entries()).map((function(e){var t=e[0],n=e[1];return"".concat(t,"|").concat(Av(n.map(o)))}));default:return i.a.sendTraceTag(508601187,a.a.msoulscat_ES_EWAJS,s.a.Error,"suggestionIdentities.instanceId: Unknown suggestion type ".concat(e.type)),["<unknown>"]}}function Gv(e,t){var n;return void 0===t&&(t="<unknown>"),e?{worksheetId:t,id:null!==(n=e.id)&&void 0!==n?n:"<unknown>",ruleId:Mv(zv(e)),instanceId:Mv(Vv(e)),locationId:Mv(Hv(e,t))}:{worksheetId:t,id:"<unknown>",ruleId:"<unknown>",instanceId:"<unknown>",locationId:"<unknown>"}}var Uv=new(function(){function e(){this.ignoredIdsBySuggestionId=new Map,this.ignoredBySheet=new Map}return e.prototype.isIgnored=function(e){return this.ignoredIdsBySuggestionId.has(e.id)},e.prototype.ignore=function(e,t,n){i.a.sendTraceTag(508621021,a.a.msoulscat_ES_EWAJS,s.a.Important,"IgnoreManager.ignore(".concat(e,", ").concat(t.id,")"));var o,r,l,c=Gv(t,e);this.ignoredIdsBySuggestionId.set(c.id,c),(o=this.ignoredBySheet,r=c.worksheetId,l=function(){return[]},o.has(r)||o.set(r,l()),o.get(r)).push(c),this.sendTelemetry(e,n)},e.prototype.unIgnore=function(e,t){var n=Gv(t,e),o=this.ignoredBySheet.get(n.worksheetId);o&&this.ignoredBySheet.set(n.worksheetId,o.filter((function(e){return e.id!==n.id}))),this.ignoredIdsBySuggestionId.delete(n.id),i.a.sendTraceTag(508621020,a.a.msoulscat_ES_EWAJS,s.a.Important,"IgnoreManager.unIgnore(".concat(n.id,")"))},e.prototype.logIgnoreDataForSuggestions=function(e,t){i.a.sendTraceTag(508618531,a.a.msoulscat_ES_EWAJS,s.a.Important,"IgnoreManager.logIgnoreDataForSuggestions(".concat(e,", [").concat(t.length,"])")),this.sendTelemetry(e,t)},e.prototype.getTelemetryData=function(e,t){var n=Gv(t,e),o=this.ignoredBySheet.get(e);if(o){var r=function(e){return o.filter((function(t){return e.every((function(e){return e in t&&n[e]===t[e]}))})).map((function(e){return e.id}))};return{byId:Boolean(this.ignoredIdsBySuggestionId.get(n.id)),byRuleId:r(["ruleId"]),byRuleAndLocationId:r(["ruleId","locationId"])}}},e.prototype.sendTelemetry=function(e,t){var n="IgnoreManager.sendTelemetry(".concat(e,"):");if(this.ignoredBySheet.get(e))for(var o=0,r=t;o<r.length;o++){var l=r[o],c=this.getTelemetryData(e,l);((null==c?void 0:c.byId)||(null==c?void 0:c.byRuleId.length)||(null==c?void 0:c.byRuleAndLocationId.length))&&i.a.sendTraceTag(508621018,a.a.msoulscat_ES_EWAJS,s.a.Important,"".concat(n," ").concat(l.id," is a possible ignored suggestion: ").concat(JSON.stringify(c)))}else i.a.sendTraceTag(508621019,a.a.msoulscat_ES_EWAJS,s.a.Important,"".concat(n," no ignored suggestions found"))},e}()),qv=n(2302),Qv=n(856);function Kv(e){return Mb.a.typeGuard(e)?function(e){var t=e.columnName?[e.columnName]:Object(lb.b)(ExcelDataCleansingStrings.ColumnTitle,{column:e.columnTitle}),n={tableName:e.tableName,columnName:e.columnName,columnTitle:e.columnTitle,tableRange:e.tableRange,tableId:e.tableIdentifier,columnString:t.join("")},o=e.suggestions.map((function(e){try{return function(e,t){if(function(e){return"ExtraSpaces"===e.type}(e))return function(e,t){return{id:e.id,type:vf.ExtraSpaces,tableRange:t.tableRange,tableName:t.tableName,tableIdentifier:t.tableId,columnName:t.columnString,columnTitle:t.columnTitle,extraSpacesType:hb(e.extraSpacesType),suggestionRange:e.suggestionRange,ranges:e.ranges}}(e,t);if(function(e){return"TextInconsistency"===e.type}(e))return function(e,t){var n=Jv(e.suggestedValue.type),o=e.variations.map((function(e){return Jv(e.type)})).join(";"),r=e.id;return i.a.sendTraceTag(509199957,a.a.msoulscat_ES_EWAJS,s.a.Important,"createTextInconsistencySuggestion: suggestionId: ".concat(r," numVariations: ").concat(e.variations.length+1," suggestedValueLinters: [").concat(n,"] otherVariationsLinters: [").concat(o,"]")),{id:r,type:vf.TextInconsistency,tableRange:t.tableRange,tableName:t.tableName,tableIdentifier:t.tableId,columnName:t.columnString,columnTitle:t.columnTitle,suggestedValue:e.suggestedValue.value,replacementValue:e.suggestedValue.value,variations:Object(k.__spreadArray)([{isSelected:!1,ranges:e.suggestedValue.ranges,value:e.suggestedValue.value,linters:n}],e.variations.map((function(e){return{isSelected:!0,ranges:e.ranges,value:e.value,linters:Jv(e.type)}})),!0),suggestionRange:e.suggestionRange}}(e,t);if(function(e){return"NumberFormattingInconsistency"===e.type}(e))return function(e,t){var n,o=Object(k.__spreadArray)([e.suggestedFormat],e.otherFormats,!0),r={id:e.id,type:vf.NumberFormatInconsistency,tableRange:t.tableRange,tableName:t.tableName,tableIdentifier:t.tableId,columnName:t.columnString,columnTitle:t.columnTitle,suggestionRange:e.suggestionRange,replacementFormat:e.suggestedFormat.value,suggestedFormat:e.suggestedFormat.value,variationsType:gb(e.variationsType),formats:o.map((function(e){return{isApplicable:Boolean(e.isApplicable),value:e.value,key:e.value,format:e.value,ranges:e.ranges}}))},l=null===(n=r.formats)||void 0===n?void 0:n.find((function(e){return null==e?void 0:e.isApplicable}));(null==l?void 0:l.format)&&(r.suggestedFormat=l.format,r.replacementFormat=l.format);Ub(r)||i.a.sendTraceTag(508880516,a.a.msoulscat_ES_EWAJS,s.a.Error,"createNumberFormatInconsistencySuggestion: not applicable, suggestionId: ".concat(e.id));return r}(e,t);return void i.a.sendTraceTag(522733216,a.a.msoulscat_ES_EWAJS,s.a.Error,"createSuggestion: unsupported suggestion type ".concat(null==e?void 0:e.type))}(e,n)}catch(e){return void i.a.sendTraceTag(522733215,a.a.msoulscat_ES_EWAJS,s.a.Error,"Exception thrown from createSuggestion: ".concat(e))}}));return Object(Qv.a)(o)}(e):qv.a.typeGuard(e)?[Zv(e)]:[]}function Jv(e){return e.split(",").map((function(e){return e.trim()}))}function Zv(e){return{id:e.id,type:vf.ExtraSpacesTable,tableRange:e.tableRange,suggestionRange:e.tableRange,tableName:e.tableName,tableIdentifier:e.tableIdentifier,rangesByType:new Map([[0,e.rangesWithLeading],[1,e.rangesWithTrailing],[2,e.rangesWithInBetween]])}}function Yv(e,t,n){if(0===vb(t,n).size)return i.a.sendTraceTag(509122378,a.a.msoulscat_ES_EWAJS,s.a.Info,"canAutomaticallyRefresh: true, had no suggestions"),!0;var o=vb(e,t),r=vb(t,e);return o.size>0||r.size>0?!(0!==o.size||0!==vb(r,n).size)&&(i.a.sendTraceTag(509162309,a.a.msoulscat_ES_EWAJS,s.a.Info,"canAutomaticallyRefresh: true, apply is the only change"),!0):(i.a.sendTraceTag(509162310,a.a.msoulscat_ES_EWAJS,s.a.Info,"canAutomaticallyRefresh: true, no suggestions changed"),!0)}function Xv(e,t,n,o){var r=Object(Dv.a)(),l=O.useRef(t),c=O.useRef(t);c.current=t;var u,d,p=O.useRef(e),h=!0;if(c.current!==l.current){if(p.current!==e)h=!0,p.current=e;else{var g=function(e){return Qb(e,(function(e){return o.isIgnored(e)}),n)};u=g(c.current),d=g(l.current),h=Yv(new Set(u.map((function(e){return e.id}))),new Set(d.map((function(e){return e.id}))),new Set)}h?(i.a.sendTraceTag(508441609,a.a.msoulscat_ES_EWAJS,s.a.Info,"useRefreshSuggestions: quietly refreshed suggestions"),l.current=c.current):i.a.sendTraceTag(508441608,a.a.msoulscat_ES_EWAJS,s.a.Info,"useRefreshSuggestions: canRefreshQuietly is false")}return{canRefresh:!h,suggestions:l.current,refresh:function(){i.a.sendTraceTag(508441607,a.a.msoulscat_ES_EWAJS,s.a.Info,"Refresh button clicked"),l.current=c.current,r()}}}var $v=n(2300);var ey=16,ty=function(e){var t=e.hostState,n=void 0===t?{}:t,o=e.worksheetState,r=void 0===o?{}:o,l=e.containerRef,c=e.discoverability,u=Object(k.__rest)(e,["hostState","worksheetState","containerRef","discoverability"]),d=O.useRef(new Set),p=bf(),h=function(e){void 0===e&&(e="dataCleansingTaskPaneState");var t=uf();return lf({get:function(n){var o;return Object(k.__awaiter)(this,void 0,void 0,(function(){var r;return Object(k.__generator)(this,(function(l){switch(l.label){case 0:return[4,null===(o=null==t?void 0:t.getSessionStorageItem)||void 0===o?void 0:o.call(t,e,n)];case 1:if(null==(r=l.sent()))return[2,r];try{return[2,JSON.parse(r,Pv)]}catch(e){return i.a.sendTraceTag(508887458,a.a.msoulscat_ES_EWAJS,s.a.Error,"useSessionStorage: failed to parse object. type ".concat(Rv(r)?r.__serializable__:typeof r)),[2,r]}return[2]}}))}))},set:function(n,o){var r;return Object(k.__awaiter)(this,void 0,void 0,(function(){var l;return Object(k.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),l=JSON.stringify(o,_v),[4,null===(r=t.setSessionStorageItem)||void 0===r?void 0:r.call(t,e,n,l)];case 1:return c.sent(),[2,!0];case 2:return c.sent(),i.a.sendTraceTag(508887299,a.a.msoulscat_ES_EWAJS,s.a.Error,"useSessionStorage: failed to parse stringify. type ".concat(typeof o)),[2,!1];case 3:return[2]}}))}))}})}(),g=uf(),m=O.useRef(),f=Object(Dv.a)();If((function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,o;return Object(k.__generator)(this,(function(r){switch(r.label){case 0:return[4,h.get("appliedSuggestionIds")];case 1:if((e=r.sent())&&e.size>0){for(t=0,n=Array.from(e);t<n.length;t++)o=n[t],d.current.add(o);i.a.sendTraceTag(508872083,a.a.msoulscat_ES_EWAJS,s.a.Info,"DataCleansingTaskPane: loaded ".concat(e.size," applied suggestion ids from session storage")),f()}return[2]}}))}))})),Object(Uf.a)((function(){return Object(k.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(k.__generator)(this,(function(t){switch(t.label){case 0:return e=d.current,[4,h.set("appliedSuggestionIds",e)];case 1:return t.sent(),i.a.sendTraceTag(508872082,a.a.msoulscat_ES_EWAJS,s.a.Info,"DataCleansingTaskPane: saved ".concat(e.size," applied suggestion ids to session storage")),[2]}}))}))}));var b=O.useState([]),v=b[0],y=b[1],x=Object(sf.a)((function(){return new Bv(y)})),C=function(e,t,n){return t.errorState?vm.Disabled:e?vm.LoadingSuggestions:n.isProtected||t.isInViewMode||t.isInCoauthoring||n.isInNamedSheetView?vm.Disabled:vm.DisplaySuggestions}(!u.annotations.find($v.a.typeGuard),n,r),S=Iv(n,r),E=function(e){return O.useMemo((function(){var t=xb(e.map(Kv));return t.sort(Nb),t}),[e])}(u.annotations),T=Xv(r.sheetId,E,d.current,Uv),I=function(e,t,n,o){var r=Object(Dv.a)(),l=n.current,c=Object(sf.a)(new Map),u=O.useRef([]);kb(e,t,o);var d=Qb(t,(function(e){return o.isIgnored(e)}),l);return u.current=d.map((function(e){var t;return null!==(t=c.get(e.id))&&void 0!==t?t:e})),{suggestions:u.current,saveEditedSuggestion:function(e){c.set(e.id,e),r()},getSuggestion:function(e){return u.current.find((function(t){return t.id===e}))},setAppliedState:function(e,t){var n,o="useVisibleSuggestions: setAppliedState(".concat(e,", ").concat(t,")");e?t||l.has(e)?t&&l.has(e)&&(n="suggestion is already applied"):n="suggestion is not applied":n="suggestionId is undefined",n?i.a.sendTraceTag(508441606,a.a.msoulscat_ES_EWAJS,s.a.Error,"".concat(o,": ").concat(n)):(l[t?"add":"delete"](e),r(),i.a.sendTraceTag(508441605,a.a.msoulscat_ES_EWAJS,s.a.Info,"".concat(o)))},setIgnoredState:function(e,n,l){var c="useVisibleSuggestions: setIgnoredState(".concat(e,", ").concat(null==n?void 0:n.id,", ").concat(l,")");e&&n?(i.a.sendTraceTag(508441603,a.a.msoulscat_ES_EWAJS,s.a.Important,c),l?o.ignore(e,n,t):o.unIgnore(e,n),r()):i.a.sendTraceTag(508441604,a.a.msoulscat_ES_EWAJS,s.a.Error,"".concat(c," worksheetId or suggestion is undefined"))}}}(r.sheetId,T.suggestions,d,Uv),w=I.suggestions,_=I.getSuggestion,P=I.saveEditedSuggestion,R=I.setAppliedState,D=I.setIgnoredState,j=O.useRef(),B=lf({canApplySuggestion:function(e){return Ub(_(e))},onSuggestionIgnored:function(e){var t=null==r?void 0:r.sheetId,n=_(e);Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingIgnoreCallout")&&(null==x||x.showToast({key:"ignore_suggestion",message:p.IgnoreCallout_Message,actionMessage:p.IgnoreCallout_UndoButton,action:function(){return D(t,n,!1)}})),D(t,n,!0)},onSuggestionApplied:function(e,t){var n,o;return Object(k.__awaiter)(this,void 0,void 0,(function(){var r,l,c,u;return Object(k.__generator)(this,(function(d){switch(d.label){case 0:if(!(r=_(e)))throw l="onSuggestionApplied: called with no suggestion",i.a.sendTraceTag(509380127,a.a.msoulscat_ES_EWAJS,s.a.Error,l),new Error(l);r.suggestionRange&&(null===(o=null===(n=g.containsHiddenCells)||void 0===n?void 0:n.call(g,[r.suggestionRange]))||void 0===o||o.then((function(e){(null==e?void 0:e.length)&&i.a.sendTraceTag(509380126,a.a.msoulscat_ES_EWAJS,s.a.Info,"DataCleansingTaskPane: suggestion with hidden cells applied")}))),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t()];case 2:return c=d.sent(),m.current=e,R(e,!0),[2,c];case 3:throw u=d.sent(),i.a.sendTraceTag(509380125,a.a.msoulscat_ES_EWAJS,s.a.Error,"onSuggestionApplied: applySuggestion threw an error: ".concat(u)),u;case 4:return[2]}}))}))},onSuggestionSelected:function(e){var t;j.current=null!=e?e:void 0,null===(t=g.highlightRangesOnGrid)||void 0===t||t.call(g,qb(_(e)),!0,0)},onSuggestionDeselected:function(e){var t;j.current=void 0,null===(t=g.highlightRangesOnGrid)||void 0===t||t.call(g,[],!0,0)},onSuggestionPreview:function(e){var t;j.current=e,null===(t=g.highlightRangesOnGrid)||void 0===t||t.call(g,qb(_(e)),!1,0)},onCancelSuggestionPreview:function(e){var t;j.current=void 0,null===(t=g.highlightRangesOnGrid)||void 0===t||t.call(g,[],!1,0)},onSuggestionValuesChanged:function(e){var t;P(e),e.id===j.current&&(null===(t=g.highlightRangesOnGrid)||void 0===t||t.call(g,qb(e),!0,0))},undoLastAppliedSuggestion:function(){var e;i.a.sendTraceTag(508638022,a.a.msoulscat_ES_EWAJS,s.a.Important,"onAppliedUndo: confirmation callout for '".concat(m.current,"' triggered undo")),R(m.current,!1),null===(e=g.doUndo)||void 0===e||e.call(g)},reportSuggestionSucceeded:function(){var e;null===(e=null==g?void 0:g.sendOtelEvent)||void 0===e||e.call(g,Rb)}});return O.createElement(Wf,{value:T},O.createElement(Bb,{value:x},O.createElement(af,{value:B},O.createElement(Tv,{worksheetState:r,suggestions:w,viewState:C,messageType:S,discoverability:c,isFeedbackAllowed:null==n?void 0:n.isFeedbackAllowed})),O.createElement(Lv,{targetRef:l,toasts:v})))},ny=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=O.createRef(),t.selectorsToFocus=[".".concat("suggestion-card","[data-selected-card]"),".".concat("suggestions-list"),"*"],t.focus=function(){var e=t.props.discoverability;if(!e||e.shouldFocus){var n=t.containerRef.current;if(n&&!n.contains(document.activeElement)){for(var o=0,r=t.selectorsToFocus;o<r.length;o++){var l=r[o],c=n.querySelector(l);if(c){var u=Object(ua.f)(n,c,!0);if(u&&Object(ua.c)(u))break}}i.a.sendTraceTag(509380122,a.a.msoulscat_ES_EWAJS,s.a.Spam,"DataCleansingTaskPane: focused on ".concat(oy(document.activeElement)))}}},t}return Object(k.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){i.a.sendTraceTag(509380121,a.a.msoulscat_ES_EWAJS,s.a.Error,"DataCleansingTaskPane: componentDidCatch: ".concat(null==e?void 0:e.message," ").concat(t.componentStack))},t.prototype.render=function(){var e,t=this.props,n=t.hostAppCallbacks,o=t.annotations,r=Object(k.__rest)(t,["hostAppCallbacks","annotations"]),i=null===(e=null==r?void 0:r.worksheetState)||void 0===e?void 0:e.sheetId;return O.createElement(xf,null,O.createElement(df,{callbacks:n},O.createElement(Pf,{value:null==r?void 0:r.worksheetState},O.createElement(Bf,null,O.createElement("div",{ref:this.containerRef,style:{height:"100%",padding:"0 ".concat(ey,"px 1em"),boxSizing:"border-box"}},O.createElement(ty,Object(k.__assign)({containerRef:this.containerRef,annotations:i?o.filter((function(e){return e.worksheetId===i})):o},r)))))))},t}(O.Component);function oy(e){return e?e.id||e.className||e.tagName:"nothing"}function ry(e,t,n){return O.createElement("div",{id:"ExcelTaskPaneContentWrapper",style:{position:"relative",height:"100%",overflowX:"hidden"}},function(e,t,n){switch(t.type){case"AccCheckerTaskPaneProps":return O.createElement(ay.AccCheckerTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},Object(k.__assign)({},t),{pivotIcons:{error:m.a.CancelRequest_16,warning:m.a.Risks_16,tips:W.a.Lightbulb_16,intelligentServices:h.a.LightningIdeasHandraiseState_20,chevron:Object(F.a)()?c.a.CommonControlChevronLeft_16:c.a.CommonControlChevronRight_16},appColors:Object(f.a)(),violationToControlId:{},fixItMenuControlRendererFunction:Object(Rr.a)(ir.a,Object(Pr.c)(ir.a,Object(Dr.a)()))}));case"ConditionalFormattingTaskPaneProps":return O.createElement(ay.ConditionalFormattingTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"DataCleansingTaskPaneProps":case"DataCleansingStatefulTaskPaneProps":return O.createElement(ay.DataCleansingTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"EmbeddedTaskPaneProps":return O.createElement(ay.EmbeddedTaskPane,Object(k.__assign)({},t));case"ExcelLegacyTaskPaneWacInfraProps":return O.createElement(ay.ExcelLegacyTaskPaneWacInfra,Object(k.__assign)({},t));case"ExternalLinksTaskPaneProps":return O.createElement(ay.ExternalLinksTaskPane,Object(k.__assign)({},t));case"FieldListTaskPaneProps":return O.createElement(ay.FieldListTaskPane,Object(k.__assign)({},t));case"FormatCellsTaskPaneProps":return O.createElement(ay.FormatCellsTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"NameManagerTaskPaneProps":return O.createElement(ay.NameManagerTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"LoadBlockingFloatingObjectsTaskPaneProps":return O.createElement(ay.LoadBlockingFloatingObjectsTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"PivotTableSettingsTaskPaneProps":return O.createElement(ay.PivotTableSettingsTaskPane,Object(k.__assign)({},t));case"PowerQueryTaskPaneProps":return O.createElement(ay.PowerQueryTaskPane,Object(k.__assign)({},t));case"SlicerSettingsTaskPaneProps":return O.createElement(ay.SlicerSettingsTaskPane,Object(k.__assign)({},t));case"SpellCheckTaskPaneProps":return O.createElement(ay.SpellCheckTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"SharedCommentsTaskPaneProps":return O.createElement(ay.SharedCommentsTaskPane,Object(k.__assign)({taskPaneId:e,setFocusCallback:n},t));case"OcvFeedbackTaskPaneProps":return O.createElement(lm,Object(k.__assign)({},t));default:throw new Error("Rendering an unspecified TaskPane Type. Trying to render pane with id: "+e+" , props.type: "+t.type)}}(e,t,n))}var iy={AccCheckerTaskPane:cm(Vm),ConditionalFormattingTaskPane:cm(wo),DataCleansingTaskPane:cm(ny),FormatCellsTaskPane:cm(sa),LoadBlockingFloatingObjectsTaskPane:cm(ga),NameManagerTaskPane:cm(hs),SpellCheckTaskPane:cm(ll),SharedCommentsTaskPane:cm(Qm)},ay={AccCheckerTaskPane:O.memo(iy.AccCheckerTaskPane),ConditionalFormattingTaskPane:O.memo(iy.ConditionalFormattingTaskPane),DataCleansingTaskPane:O.memo(iy.DataCleansingTaskPane),EmbeddedTaskPane:O.memo($m),ExcelLegacyTaskPaneWacInfra:tf,ExternalLinksTaskPane:O.memo(Bl),FieldListTaskPane:O.memo((function(e){return O.createElement(kc,Object(k.__assign)({},e))})),FormatCellsTaskPane:O.memo(iy.FormatCellsTaskPane),LoadBlockingFloatingObjectsTaskPane:O.memo(iy.LoadBlockingFloatingObjectsTaskPane),NameManagerTaskPane:O.memo(iy.NameManagerTaskPane),PivotTableSettingsTaskPane:O.memo(Du),PowerQueryTaskPane:O.memo(zh),SlicerSettingsTaskPane:O.memo(lg),SpellCheckTaskPane:O.memo(iy.SpellCheckTaskPane),SharedCommentsTaskPane:O.memo(iy.SharedCommentsTaskPane)};function sy(e,t){switch(e.type){case"AccCheckerTaskPaneProps":return cs.a.AccessibilityChecker_20;case"ConditionalFormattingTaskPaneProps":return h.a.ConditionalFormatting_20;case"ExcelLegacyTaskPaneWacInfraProps":return function(e,t){switch(t){case"FieldManagerTaskPane":case"1":return W.a.SxShowFieldDman_20;case"ParametersTaskPane":case"2":return W.a.NOV_ParameterTaskPane_20;case"CommentTaskPane":case"7":return W.a.CommentsPane_20;case"AccessibilityCheckerTaskPane":case"8":return W.a.AccessibilityChecker_20;case"EnrichmentTaskPane":case"10":return W.a.LinkedRecordsHelp_24;case"LineageTaskPane":case"15":return W.a.ShowChangesExcel_20;case"FA000000066":return W.a.Refresh_20;case"AnalyzeDataTaskPane":return h.a.IdeaNew_20;case"RecommendedChartsTaskPane":return cs.a.RecommendedCharts_20;case"PivotTableTaskPane":return cs.a.PivotTable_20;case"CopilotSDXTaskpane":return c.a.M365Excel_20;case"HelpTaskPane":return W.a.AboutButton_20;case"ContactSupportTaskPane":return W.a.AccountSupport_20;default:return}}(0,t);case"ExternalLinksTaskPaneProps":return W.a.Links_20;case"FieldListTaskPaneProps":return W.a.SxShowFieldDman_20;case"PivotTableSettingsTaskPaneProps":return W.a.Properties_20;case"PowerQueryTaskPaneProps":return W.a.ShowQueryPane_20;case"SlicerSettingsTaskPaneProps":return W.a.Properties_20;case"SpellCheckTaskPaneProps":return W.a.Spelling_20;case"NameManagerTaskPaneProps":return cs.a.NameManager_20;case"SharedCommentsTaskPaneProps":return W.a.CommentsPane_20;case"DataCleansingTaskPaneProps":case"DataCleansingStatefulTaskPaneProps":return W.a.DataCleaning_20;case"FormatCellsTaskPaneProps":return sn.a.PaintBrushandBucket_20;case"OcvFeedbackTaskPaneProps":return W.a.Feedback_20;case"LoadBlockingFloatingObjectsTaskPaneProps":return W.a.EditQuickCommand_Glyph_20;default:return}}var ly=n(869),cy=Object(Po.c)((function(e){for(var t=[],n=0,o=e;n<o.length;n++){var r=o[n],i=null==r?void 0:r.activeControls;i&&t.push.apply(t,i)}var a=new Set(t);return Array.from(a.values())}));function uy(e){if(!e.taskPaneDataModel)return[];var t=e.taskPaneDataModel,n=Object(k.__spreadArray)(Object(k.__spreadArray)([],t.rightTaskPanes,!0),t.leftTaskPanes,!0).map((function(e){return t.taskPaneModels[e]}));return cy(n)}var dy=n(2305),py=n(485),hy=function(e){return{backgroundColor:Object(Cm.c)()?e.palette.white:Yt.a.white}},gy=Object(Po.c)((function(e,t,n){var o,r=Object(xm.f)(e,n),i=function(e,t){return{backgroundColor:e,borderColor:Object(Cm.c)()?t.palette.neutralPrimary:Yt.a.gray160}}(r.background,e);return{root:[{width:40,height:40,backgroundColor:r.background,marginBottom:1,selectors:(o={},o[Ds.b]=[i,{selectors:{":hover":hy(e)}}],o[Ds.a]={outline:"none",border:"none"},o)},t&&[Ds.u,Ds.o]],rootPressed:{backgroundColor:r.background},rootHovered:hy(e),rootFocused:[i,{selectors:{":hover":hy(e)}}]}})),my=Object(Po.c)((function(e,t,n){return Object(py.b)(e,Object(Fr.b)(e,gy(e,t,n)))})),fy=Object(Po.c)((function(e,t,n,o,r){var i=Object(Ds.z)(o),a=Object(xm.f)(e,r);return{resizeGroupRoot:[{position:"relative",backgroundColor:a.background,height:"100%"},t>1&&n&&{borderLeft:"1px solid ".concat(Yt.a.gray50)}],buttonContainer:[{position:"relative",height:"100%",width:t>1?40:0,transition:"width ".concat(i,"ms ease"),display:"inline-block",backgroundColor:a.background},Ds.w]}})),by=Object(Po.c)((function(e){return Object(V.I)({root:{left:"auto",position:"absolute"}},e)})),vy=Object(Po.c)((function(e){return{resizeGroupRoot:Object(V.eb)(e.resizeGroupRoot),buttonContainer:Object(V.eb)(e.buttonContainer)}})),yy=Object(Po.c)((function(){return Object(Po.c)((function(e,t){return Object(La.b)()(e,t,!1)}))})),xy=Object(Po.c)((function(e,t){return{wrapper:{width:40},pivotHeader:my(e,!1,t),selectedPivotHeader:my(e,!0,t)}})),Cy=Object(Po.c)((function(e){return{overflowButton:my(e,!1)}})),Sy=Object(Po.c)((function(e,t){return by(Object(V.I)(t,{root:{transition:"".concat(e," 400ms cubic-bezier(0.17, 0.17, 0.00, 1.00)")}}))})),Ey={taskPaneModels:{},leftTaskPanes:[],rightTaskPanes:[]},ky=function(e,t){if(void 0===e&&(e=Ey),null===e)return Ey;switch(t.type){case dr.z:var n=Object(k.__assign)({},e.taskPaneModels);return t.payload.taskPanes.forEach((function(t){var o=n[t.id];t.isPersistedTaskPane&&(!o&&t.hidePersistedPaneInitially?t.hidden=!0:o&&o.hidden&&(t.hidden=!1));var r=e.taskPaneModels[t.id];t.resizeWidth||(t.resizeWidth=r&&r.resizeWidth?r.resizeWidth:t.width),t.activeControls||(t.activeControls=null==r?void 0:r.activeControls),n[t.id]=t})),Object(k.__assign)(Object(k.__assign)({},e),{taskPaneModels:n});case dr.Hc:return Object(k.__assign)(Object(k.__assign)({},e),{taskPaneModels:Oy(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case dr.Pb:return Object(k.__assign)(Object(k.__assign)({},e),{taskPaneModels:Ty(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case dr.Ic:return Object(k.__assign)(Object(k.__assign)({},e),{taskPaneModels:Iy(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case dr.A:return wy(e,t.payload.taskPaneIds,t.payload.location);case dr.V:return _y(e,t.payload.taskPaneIds,t.payload.location);case dr.Ib:return By(e,t.payload.taskPaneId,t.payload.location);case dr.Z:var o=e.selectedTaskPaneIdRight,r=e.rightTaskPanes,i=e.selectedTaskPaneIdLeft,a=e.leftTaskPanes;t.payload.location===P.a.Left&&(o=e.selectedTaskPaneIdLeft,r=e.leftTaskPanes,i=e.selectedTaskPaneIdRight,a=e.rightTaskPanes);var s=e.taskPaneModels,l=Py(r,s).length>1,c=Py(a,s).length>1;return Fy(s,l,c,t.payload.middleContainer,o,t.payload.selectedPaneId,i),e;case dr.ab:var u=Py(t.payload.location===P.a.Left?e.leftTaskPanes:e.rightTaskPanes,e.taskPaneModels),d=u.length>0?u[0]:void 0;return By(e,d,t.payload.location);case dr.Sb:var p=t;return Object(k.__assign)(Object(k.__assign)({},e),{taskPaneModels:jy(e.taskPaneModels,p,e.taskPaneModels[p.payload.taskPaneId])});default:return e}},Oy=function(e,t,n){var o;if(n){var r=Object(k.__assign)(Object(k.__assign)({},n),{renderContent:t.payload.renderContent});return Object(k.__assign)(Object(k.__assign)({},e),((o={})[t.payload.taskPaneId]=r,o))}return e},Ty=function(e,t,n){var o;if(n){var r=Object(k.__assign)(Object(k.__assign)({},n),{showSharingContent:!n.showSharingContent});if(n.renderContent){var i=n.renderContent(),a=O.cloneElement(i,Object(k.__assign)(Object(k.__assign)({},i.props),{showSharingContent:!n.showSharingContent}));r.renderContent=function(){return a}}return Object(k.__assign)(Object(k.__assign)({},e),((o={})[t.payload.taskPaneId]=r,o))}return e},Iy=function(e,t,n){var o;if(n){var r=Object(k.__assign)(Object(k.__assign)({},n),{resizeWidth:t.payload.resizeWidth});return i.a.sendTraceTag(595077188,a.a.msoulscat_Wac_TaskPane,s.a.Info,"TaskPane has been resized"),Object(k.__assign)(Object(k.__assign)({},e),((o={})[t.payload.taskPaneId]=r,o))}return e},wy=function(e,t,n){for(var o=Object(k.__spreadArray)([],Ry(e,n),!0),r=0,i=t;r<i.length;r++){var a=i[r];-1===o.indexOf(a)&&o.push(a)}return Dy(e,n,o)},_y=function(e,t,n){for(var o=Object(k.__spreadArray)([],Ry(e,n),!0),r=Object(k.__assign)({},e.taskPaneModels),i=n===P.a.Left?e.selectedTaskPaneIdLeft:e.selectedTaskPaneIdRight,a=i?Py(o,r).indexOf(i):-1,s=0,l=t;s<l.length;s++){var c=l[s],u=o.indexOf(c),d=r[c];d&&d.isPersistedTaskPane?r[c]=Object(k.__assign)(Object(k.__assign)({},d),{hidden:!0}):u>=0&&o.splice(u,1)}if(i&&t.indexOf(i)>=0){var p=Py(o,r);if(i=void 0,p.length>0){a>=p.length&&(a=p.length-1);for(var h=a;h<p.length;h+=1){var g=p[h],m=r[g];if(m&&!m.hidden){i=g;break}}}}return n===P.a.Left?Object(k.__assign)(Object(k.__assign)({},e),{leftTaskPanes:o,selectedTaskPaneIdLeft:i,taskPaneModels:r}):Object(k.__assign)(Object(k.__assign)({},e),{rightTaskPanes:o,selectedTaskPaneIdRight:i,taskPaneModels:r})},Py=function(e,t){return e.filter((function(e){var n=t[e];return n&&!n.hidden}))},Ry=function(e,t){return t===P.a.Left?e.leftTaskPanes:e.rightTaskPanes},Dy=function(e,t,n){return t===P.a.Left?Object(k.__assign)(Object(k.__assign)({},e),{leftTaskPanes:n}):Object(k.__assign)(Object(k.__assign)({},e),{rightTaskPanes:n})},jy=function(e,t,n){var o;if(n){var r=Object(k.__assign)(Object(k.__assign)({},n),{activeControls:t.payload.controlIdsList});return Object(k.__assign)(Object(k.__assign)({},e),((o={})[t.payload.taskPaneId]=r,o))}return e},By=function(e,t,n){return n===P.a.Left?Object(k.__assign)(Object(k.__assign)({},e),{selectedTaskPaneIdLeft:t}):Object(k.__assign)(Object(k.__assign)({},e),{selectedTaskPaneIdRight:t})},Fy=function(e,t,n,o,r,i,a){var s=Ly(e,t,i||r)+"px",l=Ly(e,n,a)+"px";Object(F.a)()?(o.style.left=s,o.style.right=l):(o.style.right=s,o.style.left=l)},Ly=function(e,t,n){var o=n?e[n]:void 0;return(o?o.enableResize&&o.resizeWidth?o.resizeWidth:o.width:0)+My(t,o)},My=function(e,t){return t?e?42:1:e?41:0};function Ay(){dy.b.register("taskPaneDataModel",ky),Object(yt.isChangeGateEnabled)("OfficeVSO:8362208_ActiveControlsInTaskPaneModel")&&Object(ly.c)(uy)}var Ny,Wy=n(290),Hy=n(2335),zy=n(2315),Vy=n(144),Gy=n(747),Uy=n(172),qy=(Ny=function(e,t){return(Ny=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Ny(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Qy=function(){return(Qy=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Ky={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},Jy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return qy(t,e),t.prototype.render=function(){return O.createElement("div",{className:this.props.className||"",style:Qy(Qy({position:"absolute",userSelect:"none"},Ky[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(O.PureComponent),Zy=n(2477),Yy=n.n(Zy),Xy=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$y=function(){return($y=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ex={width:"auto",height:"auto"},tx=Yy()((function(e,t,n){return Math.max(Math.min(e,n),t)})),nx=Yy()((function(e,t){return Math.round(e/t)*t})),ox=Yy()((function(e,t){return new RegExp(e,"i").test(t)})),rx=function(e){return Boolean(e.touches&&e.touches.length)},ix=Yy()((function(e,t,n){void 0===n&&(n=0);var o=t.reduce((function(n,o,r){return Math.abs(o-e)<Math.abs(t[n]-e)?r:n}),0),r=Math.abs(t[o]-e);return 0===n||r<n?t[o]:e})),ax=Yy()((function(e,t){return e.substr(e.length-t.length,t.length)===t})),sx=Yy()((function(e){return"auto"===(e=e.toString())||ax(e,"px")||ax(e,"%")||ax(e,"vh")||ax(e,"vw")||ax(e,"vmax")||ax(e,"vmin")?e:e+"px"})),lx=function(e,t,n,o){if(e&&"string"==typeof e){if(ax(e,"%"))return t*(Number(e.replace("%",""))/100);if(ax(e,"vw"))return n*(Number(e.replace("vw",""))/100);if(ax(e,"vh"))return o*(Number(e.replace("vh",""))/100)}return e},cx=Yy()((function(e,t,n,o,r,i,a){return o=lx(o,e.width,t,n),r=lx(r,e.height,t,n),i=lx(i,e.width,t,n),a=lx(a,e.height,t,n),{maxWidth:void 0===o?void 0:Number(o),maxHeight:void 0===r?void 0:Number(r),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===a?void 0:Number(a)}})),ux=["as","style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],dx=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableTop=0,n.targetLeft=0,n.targetTop=0,n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return Xy(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||ex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,n=[].slice.call(e.children);t<n.length;t++){var o=n[t];if(o.classList.contains("__resizable_base__"))return o}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,o=this.resizable.offsetHeight,r=this.resizable.style.position;"relative"!==r&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:o,this.resizable.style.position=r}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&ax(e.propsSize[t].toString(),"%")){if(ax(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return sx(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?sx(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?sx(t.height):n("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=!1,t=this.parentNode.style.flexWrap,n=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var o={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=n,o},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0});var t=this.parentNode;if(t&&!this.base){var n=this.window.document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.transform="scale(0, 0)",n.style.left="0",n.style.flex="0",n.classList?n.classList.add("__resizable_base__"):n.className+="__resizable_base__",t.appendChild(n)}}},t.prototype.componentWillUnmount=function(){if(this.window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!e||!this.base)return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var n=this.parentNode;if(n){var o=n.offsetWidth+(this.parentLeft-this.resizableLeft),r=n.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<r?t:r}}else if("window"===this.props.bounds){if(this.window){o=this.window.innerWidth-this.resizableLeft,r=this.window.innerHeight-this.resizableTop;e=e&&e<o?e:o,t=t&&t<r?t:r}}else if(this.props.bounds){o=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),r=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<r?t:r}return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,o=this.props.resizeRatio||1,r=this.state,i=r.direction,a=r.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=a.width,p=a.height,h=c||0,g=u||0;return ox("right",i)&&(d=a.width+(e-a.x)*o/n,l&&(p=(d-g)/this.ratio+h)),ox("left",i)&&(d=a.width-(e-a.x)*o/n,l&&(p=(d-g)/this.ratio+h)),ox("bottom",i)&&(p=a.height+(t-a.y)*o/n,l&&(d=(p-h)*this.ratio+g)),ox("top",i)&&(p=a.height-(t-a.y)*o/n,l&&(d=(p-h)*this.ratio+g)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,o){var r=this.props,i=r.lockAspectRatio,a=r.lockAspectRatioExtraHeight,s=r.lockAspectRatioExtraWidth,l=void 0===o.width?10:o.width,c=void 0===n.width||n.width<0?e:n.width,u=void 0===o.height?10:o.height,d=void 0===n.height||n.height<0?t:n.height,p=a||0,h=s||0;if(i){var g=(u-p)*this.ratio+h,m=(d-p)*this.ratio+h,f=(l-h)/this.ratio+p,b=(c-h)/this.ratio+p,v=Math.max(l,g),y=Math.min(c,m),x=Math.max(u,f),C=Math.min(d,b);e=tx(e,v,y),t=tx(t,x,C)}else e=tx(e,l,c),t=tx(t,u,d);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var o=this.resizable.getBoundingClientRect(),r=o.left,i=o.top;this.resizableLeft=r,this.resizableTop=i}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,o=0,r=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)){if(o=e.nativeEvent.clientX,r=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent&&rx(e.nativeEvent)&&(o=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY);if(this.props.onResizeStart)if(this.resizable)if(!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var i=this.window.getComputedStyle(this.resizable);if("auto"!==i.flexBasis){var a=this.parentNode;if(a){var s=this.window.getComputedStyle(a).flexDirection;this.flexDir=s.startsWith("row")?"row":"column",n=i.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var l={original:{x:o,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:$y($y({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(l)}},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&rx(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var t=this.props,n=t.maxWidth,o=t.maxHeight,r=t.minWidth,i=t.minHeight,a=rx(e)?e.touches[0].clientX:e.clientX,s=rx(e)?e.touches[0].clientY:e.clientY,l=this.state,c=l.direction,u=l.original,d=l.width,p=l.height,h=this.getParentSize(),g=cx(h,this.window.innerWidth,this.window.innerHeight,n,o,r,i);n=g.maxWidth,o=g.maxHeight,r=g.minWidth,i=g.minHeight;var m=this.calculateNewSizeFromDirection(a,s),f=m.newHeight,b=m.newWidth,v=this.calculateNewMaxFromBoundary(n,o),y=this.calculateNewSizeFromAspectRatio(b,f,{width:v.maxWidth,height:v.maxHeight},{width:r,height:i});if(b=y.newWidth,f=y.newHeight,this.props.grid){var x=nx(b,this.props.grid[0]),C=nx(f,this.props.grid[1]),S=this.props.snapGap||0;b=0===S||Math.abs(x-b)<=S?x:b,f=0===S||Math.abs(C-f)<=S?C:f}this.props.snap&&this.props.snap.x&&(b=ix(b,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(f=ix(f,this.props.snap.y,this.props.snapGap));var E={width:b-u.width,height:f-u.height};if(d&&"string"==typeof d)if(ax(d,"%"))b=b/h.width*100+"%";else if(ax(d,"vw")){b=b/this.window.innerWidth*100+"vw"}else if(ax(d,"vh")){b=b/this.window.innerHeight*100+"vh"}if(p&&"string"==typeof p)if(ax(p,"%"))f=f/h.height*100+"%";else if(ax(p,"vw")){f=f/this.window.innerWidth*100+"vw"}else if(ax(p,"vh")){f=f/this.window.innerHeight*100+"vh"}var k={width:this.createSizeForCssProperty(b,"width"),height:this.createSizeForCssProperty(f,"height")};"row"===this.flexDir?k.flexBasis=k.width:"column"===this.flexDir&&(k.flexBasis=k.height),this.setState(k),this.props.onResize&&this.props.onResize(e,c,this.resizable,E)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,o=t.direction,r=t.original;if(n&&this.resizable){var i={width:this.size.width-r.width,height:this.size.height-r.height};this.props.onResizeStop&&this.props.onResizeStop(e,o,this.resizable,i),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:$y($y({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,o=t.handleStyles,r=t.handleClasses,i=t.handleWrapperStyle,a=t.handleWrapperClass,s=t.handleComponent;if(!n)return null;var l=Object.keys(n).map((function(t){return!1!==n[t]?O.createElement(Jy,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:o&&o[t],className:r&&r[t]},s&&s[t]?s[t]:null):null}));return O.createElement("span",{className:a,style:i},l)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==ux.indexOf(n)||(t[n]=e.props[n]),t}),{}),n=$y($y($y({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return O.createElement(o,$y({ref:this.ref,style:n,className:this.props.className},t),this.state.isResizing&&O.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(O.PureComponent),px=function(e){var t=Object(F.a)();return e&&!t||!e&&t},hx=function(e){function t(t){var n=e.call(this,t)||this;return n.async=new Ia.a,n.resizableRef=O.createRef(),n.resizeButtonRef=O.createRef(),n.onResize=function(e,t,o){var r,i;null===(i=(r=n.props).onResize)||void 0===i||i.call(r,o.offsetWidth)},n.onResizeStart=function(){var e,t;null===(t=(e=n.props).onResizeStart)||void 0===t||t.call(e)},n.onResizeStop=function(e,t,o){n.props.onResizeEnd&&n.props.onResizeEnd(o.offsetWidth)},n.onResizeHandleBlur=function(){var e,t,o,r=n.props.resizeStrings;if(null===(e=n.resizableRef)||void 0===e?void 0:e.current){r&&n.setMessage(r.resizeModeOff),n.setState({resizeHandleVisible:!1});var i=n.resizableRef.current.size.width;null===(o=(t=n.props).onResizeEnd)||void 0===o||o.call(t,i)}},n.onResizeHandleFocus=function(){var e=n.props.resizeStrings;n.onResizeStart(),e&&n.setMessage(e.resizeModeOn),n.setState({resizeHandleVisible:!0})},n.onKeyDown=function(e){var t=n.props,o=t.invertResizeKey,r=t.keyboardResizeIncrement,i=r||15,a=px(!!o)?-i:i,s=0;e.keyCode===z.a.left?(n.resizableRef&&n.resizableRef.current&&(s=n.getLeftArrowContentWidth(n.resizableRef.current.size.width-a)),n.handleResizeKey(e,s)):e.keyCode===z.a.right&&(n.resizableRef&&n.resizableRef.current&&(s=n.getRightArrowContentWidth(n.resizableRef.current.size.width+a)),n.handleResizeKey(e,s))},n.handleResizeKey=function(e,t){var o,r,i,a;n.resizableRef&&n.resizableRef.current&&(n.resizableRef.current.updateSize({width:t,height:"100%"}),null===(r=(o=n.props).onResize)||void 0===r||r.call(o,t)),null===(a=null===(i=n.resizeButtonRef.current)||void 0===i?void 0:i.removeToolTip)||void 0===a||a.call(i),e.stopPropagation(),e.preventDefault()},n.getLeftArrowContentWidth=function(e){var t=n.props,o=t.invertResizeKey,r=t.maxWidth,i=t.minWidth,a=e,s=px(!!o);return s&&r?a=Math.min(e,r):!s&&i&&(a=Math.max(e,i)),n.calculateNewSizeMessage(a),a},n.getRightArrowContentWidth=function(e){var t=n.props,o=t.invertResizeKey,r=t.maxWidth,i=t.minWidth,a=e,s=px(!!o);return s&&i?a=Math.max(e,i):!s&&r&&(a=Math.min(e,r)),n.calculateNewSizeMessage(a),a},n.calculateNewSizeMessage=function(e){var t=n.props,o=t.maxWidth,r=t.minWidth,i=t.resizeStrings;if(i){var a="";a=e===o?i.resizeMaxValue:e===r?i.resizeMinValue:i.resizeCurrentValue.replace("{0}",e.toString()),n.setMessage(a)}},n.setMessage=function(e){n.setState({message:e})},n.state={message:"",resizeHandleVisible:!1},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.enable,n=e.defaultSize,o=e.minWidth,r=e.maxWidth,i=e.style,a=e.handleStyles,s=e.resizeHandleIcon,l=e.invertResizeKey,c=e.enableKeyboardResize,u=e.resizeStrings,d=e.className;return O.createElement(O.Fragment,null,O.createElement(dx,{ref:this.resizableRef,handleStyles:a,style:i,minWidth:o,maxWidth:r,defaultSize:n,enable:t,onResize:this.async.debounce(this.onResize,5,{leading:!1,maxWait:5}),onResizeStart:this.onResizeStart,onResizeStop:this.onResizeStop,className:d},this.props.children,c&&O.createElement($t.a,{type:"AppButtonProps",label:(null==u?void 0:u.resizeLabel)||"",hideLabel:!0,id:"resizeHandleButton",ref:this.resizeButtonRef,onKeyDown:this.onKeyDown,onFocus:this.onResizeHandleFocus,onBlur:this.onResizeHandleBlur,styles:bx(!!l,this.state.resizeHandleVisible,Object(As.isReducedAnimations)()),icon:s})),O.createElement(Cc.a,{"aria-live":"polite",message:this.state.message}))},t.prototype.focusResizeHandle=function(){var e,t;this.props.enableKeyboardResize&&(null===(t=null===(e=this.resizeButtonRef)||void 0===e?void 0:e.current)||void 0===t||t.focus())},t.prototype.updateSize=function(e){var t,n;null===(n=null===(t=this.resizableRef)||void 0===t?void 0:t.current)||void 0===n||n.updateSize(e)},t}(O.PureComponent),gx=Object(Po.c)((function(e,t){return px(e)?{left:t}:{right:t}})),mx=Object(Po.c)((function(e){return px(e)?{left:{width:15}}:{right:{width:15}}})),fx=Object(Po.c)((function(e,t){var n=Object(Ds.z)(t);return e?{}:{transition:"width ".concat(n,"ms ease")}})),bx=Object(Po.c)((function(e,t,n){var o=Object(Ds.z)(n);return{root:[{paddingLeft:0,paddingRight:0,backgroundColor:"transparent",borderColor:"transparent",position:"absolute",top:0,bottom:0,marginTop:"auto",marginBottom:"auto",pointerEvents:"none",transition:"opacity ".concat(o,"ms ease")},t&&{opacity:1},!t&&{opacity:0},!e&&{right:0,marginRight:-16},e&&{left:0,marginLeft:-16},Ds.w],icon:{height:32,width:32}}})),vx=n(954),yx=n(2299),xx=Object(Po.c)((function(e,t,n,o,r,i,a,s,l,c,u,d){var p=Object(xm.f)(e,c),h=t===P.a.Left?0:"auto",g=t===P.a.Left?"auto":0,m="1px ".concat(p.border," solid"),f=Object(Ds.z)(s);return Object(V.I)({resizableContainer:[!o&&{width:"100% !important",flexShrink:"1 !important"}],root:[{height:"100%",display:"flex",flexShrink:0,position:"absolute",left:h,right:g,background:p.background,boxSizing:"border-box"},l&&t===P.a.Left&&{borderRight:u?"none":m},l&&t===P.a.Right&&{borderLeft:m},r&&{width:"100%"}],taskPaneContainer:[{display:"inline-block",height:"100%",position:"relative",width:o||r?"100%":n,transition:"width ".concat(f,"ms ease"),backgroundColor:d?"var(--clrMlrRefreshCanvasBgNew)":void 0},Ds.w]},i,a)})),Cx=Object(Po.c)((function(e){return{root:Object(V.eb)(e.root),taskPaneContainer:Object(V.eb)(e.taskPaneContainer),resizableContainer:Object(V.eb)(e.resizableContainer)}})),Sx=n(2227),Ex=n(889),kx=n(2325),Ox=n(1370),Tx=n(1082),Ix=n(1083),wx=n(1158),_x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabStripContainer=null,t.innerTabStrip=null,t.indicatorContainer=O.createRef(),t.containsElement=function(e){return t.innerTabStrip&&t.innerTabStrip.containsElement(e)},t.renderResizedTabStrip=function(e){var n,o=(n=t.props).selectedPaneId,r=n.onTabButtonExecute,i=n.indicatorStyles,a=n.overflowMenuIcon,s=n.overflowMenuLabel,l=n.onOverflowMenuOpen,c=n.onOverflowMenuClose,u=n.tabContainerLabel,d=n.onFocus,p=n.location;return function(n){var h=n.taskPanes.length>1;return O.createElement("div",{className:e.buttonContainer},h&&O.createElement(Px,Object(k.__assign)({ref:function(e){return t.innerTabStrip=e}},t.splitTabsIntoOverflow(n),{selectedPaneId:o,onTabButtonExecute:r,tabStripContainer:t.tabStripContainer,indicatorStyles:i,overflowMenuIcon:a,overflowMenuLabel:s,onOverflowMenuOpen:l,onOverflowMenuClose:c,indicatorContainer:t.indicatorContainer,tabContainerLabel:u,onFocus:d,location:p})))}},t.onReduceData=function(e){if(0!==e.taskPanes.length)return Object(k.__assign)(Object(k.__assign)({},e),{overflowTabCount:e.overflowTabCount+1})},t.onGrowData=function(e){if(0!==e.overflowTabCount)return Object(k.__assign)(Object(k.__assign)({},e),{overflowTabCount:e.overflowTabCount-1})},t.splitTabsIntoOverflow=function(e){var n=e.taskPanes,o=e.overflowTabCount,r=Object(Vy.c)(n.length,(function(e){return-1})),i=Object(Vy.e)(n,(function(e){return e.id===t.props.selectedPaneId})),a=n.length-1;i>=0&&(r[i]=a,a-=1);for(var s=0;s<r.length;s+=1)-1===r[s]&&(r[s]=a,a-=1);return{items:n.filter((function(e,t){return r[t]>=o})),overflowItems:n.filter((function(e,t){return r[t]<o}))}},t.getVisiblePanes=function(){return t.props.taskPanes.filter((function(e){return!e.hidden}))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.selectedPaneId,n=this.getVisiblePanes(),o={taskPanes:n,overflowTabCount:0};return O.createElement(Bo.a,null,(function(r){var i=Object(wx.a)(e.context),a=vy(fy(r,n.length,t,Object(As.isReducedAnimations)(),i));return O.createElement("div",{ref:function(t){return e.tabStripContainer=t}},O.createElement(Tx.a,{className:a.resizeGroupRoot,data:o,onReduceData:e.onReduceData,onGrowData:e.onGrowData,direction:Ix.a.vertical,onRenderData:e.renderResizedTabStrip(a)}),O.createElement("div",{ref:e.indicatorContainer}))}))},t.prototype.focus=function(){this.innerTabStrip&&this.innerTabStrip.focus()},t.prototype.componentDidUpdate=function(){this.getVisiblePanes().length<2&&this.indicatorContainer.current&&T.render(O.createElement("div",null),this.indicatorContainer.current)},t.contextType=Jd.a,t}(O.PureComponent),Px=function(e){function t(t){var n=e.call(this,t)||this;return n.tabStripButtonId="tabStripButton",n.pivotRef=O.createRef(),n.selectedPane="",n.indicatorState={position:0,offset:0,length:0,thickness:0},n.convertItemsToPivotHeaders=Object(Po.c)((function(e,t,o){return t.map((function(t){return{id:n.tabStripButtonId+t.id,title:t.title,styles:xy(e,o),icon:t.icon,hideLabel:!0,ariaControls:Object(xm.e)(t.id),tooltipDirection:Y.a.leftCenter,getMenuItemClassNames:yy(),ariaLabel:t.title}}))})),n.containsElement=function(e){var t=document.getElementById(n.focusZoneId);return Object(_n.a)(t,e)},n.panesNotEqual=function(e,t){var n=e.map((function(e){return e.id})),o=t.map((function(e){return e.id}));return!Object(Vy.b)(n,o)},n.selectedPaneWasInOverflow=function(e,t){return!!t&&e.map((function(e){return e.id})).indexOf(t)>=0},n.getTransitionProperties=function(e){var t="all";return e||(t="width"),t},n.renderPivotIndicator=function(e,t,o,r){void 0===r&&(r=!1),n.selectedPane=o,r||(n.indicatorState=n.getPivotIndicatorState(o)),T.render(O.createElement(Sx.a,{direction:Ex.a.Vertical,showAnimation:t,position:n.indicatorState.position,length:n.indicatorState.length,thickness:n.indicatorState.thickness,styles:Sy(e,n.props.indicatorStyles)}),n.props.indicatorContainer.current)},n.onFocusCapture=function(e){var t=document.getElementById(n.focusZoneId),o=document.activeElement,r=o&&Object(_n.a)(t,document.activeElement,!1),i=e&&e.relatedTarget,a=i&&!Object(_n.a)(t,e.relatedTarget,!1),s=n.props.onFocus;s&&r&&a&&s();var l=o&&t===document.activeElement,c=o&&r&&o.id!==n.tabStripButtonId+n.props.selectedPaneId;(o||i)&&(l||c)&&a&&(e.preventDefault(),n.focus())},n.getFocusZoneProps=Object(Po.c)((function(){return Object(k.__assign)(Object(k.__assign)({direction:Zt.a.vertical,isCircularNavigation:!0,onFocusCapture:n.onFocusCapture,tabIndex:0},{"data-is-focusable":!0}),{id:n.focusZoneId})})),n.getPivotIndicatorState=function(e){if(e){var t=document.getElementById(n.tabStripButtonId+e);if(t&&n.props.tabStripContainer)return{position:t.getBoundingClientRect().top-n.props.tabStripContainer.getBoundingClientRect().top,offset:3,length:40,thickness:3}}return{position:n.indicatorState&&n.indicatorState.position||0,offset:n.indicatorState&&n.indicatorState.offset||0,length:n.indicatorState&&n.indicatorState.length||0,thickness:0}},n.onTabButtonExecute=function(){return function(e,t){var o=e.slice(n.tabStripButtonId.length);n.renderPivotIndicator(n.getTransitionProperties(n.selectedPane),!0,o),n.props.onTabButtonExecute&&n.props.onTabButtonExecute(o,t&&t.inputMethod||Uy.a.Unknown)}},n.getMenuProps=Object(Po.c)((function(){return{directionalHint:Y.a.leftBottomEdge,onMenuOpened:n.onMenuOpened,onMenuDismissed:n.onMenuDismiss}})),n.onMenuDismiss=function(e){var t=n.props.onOverflowMenuClose;t&&t()},n.onMenuOpened=function(e){var t=n.props.onOverflowMenuOpen;t&&t()},n.props.location===P.a.Left?n.focusZoneId="tabStripFocusZoneLeft":n.focusZoneId="tabStripFocusZone",n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.items,o=t.overflowItems,r=t.overflowMenuLabel,i=t.overflowMenuIcon,a=t.selectedPaneId,s=t.tabContainerLabel;return O.createElement(Bo.a,null,(function(t){var l=Object(wx.a)(e.context);return O.createElement(kx.a,{ref:e.pivotRef,label:s,topLevelItems:e.convertItemsToPivotHeaders(t,n,l),overflowItems:e.convertItemsToPivotHeaders(t,o,l),selectedPivotId:a?e.tabStripButtonId+a:void 0,overflowMenuLauncherLabel:r,onPivotHeaderExecute:e.onTabButtonExecute(),direction:Ox.a.Vertical,menuProps:e.getMenuProps(),menuIconProps:Object(co.a)(i),styles:Cy(t),focusZoneProps:e.getFocusZoneProps(),tooltipDirection:Y.a.leftCenter})}))},t.prototype.focus=function(){this.pivotRef.current&&this.pivotRef.current.focus()},t.prototype.componentDidMount=function(){this.props.indicatorContainer.current&&this.renderPivotIndicator("all",!0,this.props.selectedPaneId)},t.prototype.componentDidUpdate=function(e){var t=this.selectedPaneWasInOverflow(e.overflowItems,this.props.selectedPaneId);(this.selectedPane!==this.props.selectedPaneId||this.panesNotEqual(e.items,this.props.items)||this.panesNotEqual(e.overflowItems,this.props.overflowItems)||t)&&this.renderPivotIndicator(this.getTransitionProperties(e.selectedPaneId),e.selectedPaneId!==this.props.selectedPaneId,this.props.selectedPaneId,t)},t.contextType=Jd.a,t}(O.PureComponent),Rx=function(e){function t(t){var n=e.call(this,t)||this;return n.animationClassNames=Object(vx.a)(),n.persistedPanes=[],n.nonPersistedPanes=[],n.taskPaneContainer=O.createRef(),n.tabStrip=O.createRef(),n.resizable=O.createRef(),n.lastInputMethod=Uy.a.Unknown,n.isReducedAnimations=function(){return!!n.props.useReducedAnimations||Object(As.isReducedAnimations)()},n.getResizedPaneWidth=function(e){return!n.isResizeDisabled()&&(null==e?void 0:e.resizeWidth)?null==e?void 0:e.resizeWidth:null==e?void 0:e.width},n.updateInternalState=function(){var e=n.internalState,t=n.props,o={prevPanes:e.currPanes,currPanes:t.taskPanes},r=e.currSelectedPaneId,i=t.selectedPaneId,a=t.taskPaneOpeningString,s="";if(a&&void 0!==i&&(r!==i||""!==e.taskPaneOpeningMessage)){var l=Object(Vy.d)(t.taskPanes,(function(e){return e.id===i}));s=l?a.replace("{0}",l.title):""}n.internalState=void 0!==r&&void 0!==i&&r!==i?Object(k.__assign)(Object(k.__assign)({prevSelectedPaneId:r,currSelectedPaneId:i},o),{taskPaneOpeningMessage:s}):Object(k.__assign)(Object(k.__assign)({prevSelectedPaneId:e.currSelectedPaneId,currSelectedPaneId:i},o),{taskPaneOpeningMessage:s})},n.onRootFocus=function(e){var t=document.getElementById(n.rootId),o=document.activeElement,r=e&&e.relatedTarget,i=!o||!(Object(_n.a)(t,document.activeElement)&&t!==o),a=!r||!(Object(_n.a)(t,e.relatedTarget)&&t!==r);((o||r)&&i&&a||!n.props.selectedPaneId&&n.props.taskPanes.filter((function(e){return!e.hidden})).length>=2&&n.tabStrip.current&&!n.tabStrip.current.containsElement(o))&&n.focus()},n.onRootMouseDown=function(e){var t=e.target,o="#"+n.rootId+' [draggable="true"]',r=t.matches||t.webkitMatchesSelector||t.msMatchesSelector;if(r){var i=r.call(t,"input, input *"),a=r.call(t,"textarea, textarea *"),s=r.call(t,'[role="textbox"], [role="textbox"] *'),l=(t.closest||n.closestPolyfill(t,r)).call(t,o),c=n.isClickTarget(r,t);i||a||s||l||c||e.preventDefault()}},n.isClickTarget=function(e,t){return!!n.props.clickTargetSelectors&&!!n.props.clickTargetSelectors.find((function(n){return e.call(t,"".concat(n,", ").concat(n," *"))}))},n.closestPolyfill=function(e,t){return function(n){var o=e;do{if(t.call(o,n))return o;o=o.parentElement||o.parentNode}while(null!==o&&1===o.nodeType);return null}},n.renderPanes=function(e,t,o,r){var i,a,s=(i=n.internalState).prevSelectedPaneId,l=i.prevPanes,c=n.state.isResizing,u=(a=n.props).location,d=a.taskPanes,p=a.selectedPaneId,h=a.stretchWidthToContainer,g=a.resizeStrings,m=a.resizeHandleIcon,f=a.getSplashPageContent;n.persistedPanes=[],n.nonPersistedPanes=[];var b=!!p&&!Object(Vy.d)(l,(function(e){return e.id===p})),v=Object(xm.b)(d),y=Object(xm.a)(d).concat(v),x=Object(xm.c)(d),C=Object(Vy.d)(d,(function(e){return e.id===p})),S=!!C&&!!C.enableResize,E=C?n.getPaneWidth(C,t):0,T=u===P.a.Right,I=t?{ref:n.resizable,enable:gx(T,n.taskPaneResizingIsEnabled(t,S)),handleStyles:mx(T),style:fx(c,n.isReducedAnimations()),className:e.resizableContainer,defaultSize:{width:E,height:"100%"},minWidth:c&&S?null==C?void 0:C.minResizeWidth:void 0,maxWidth:c&&S?null==C?void 0:C.maxResizeWidth:void 0,onResize:n.onResize,onResizeStart:n.onResizeStart,onResizeEnd:n.onResizeEnd,invertResizeKey:T,resizeStrings:g,resizeHandleIcon:m,enableKeyboardResize:S}:void 0,w=t?hx:O.Fragment,_=void 0;return 0===o&&f&&h&&(_=f()),O.createElement(w,Object(k.__assign)({},I),O.createElement("div",{className:e.taskPaneContainer,ref:n.taskPaneContainer},_,x.map((function(e){var o=O.createRef();n.persistedPanes.push(o);var r=e.id===p;return O.createElement(yx.a,Object(k.__assign)({},e,{key:e.id,ref:o,styles:Object(vx.d)(r,b&&r,c,!!h,!!s,n.isReducedAnimations()),"data-is-visible":r,role:"tabpanel",width:n.getPaneWidth(e,t)}))})),O.createElement(Hy.a,{component:null},y.map((function(e){var o=O.createRef();e.isPersistedTaskPane?n.persistedPanes.push(o):n.nonPersistedPanes.push(o);var i=p===e.id,a=n.getResizeChatButtonProps(e);return O.createElement(zy.a,{key:e.id,classNames:n.animationClassNames,timeout:Object(Ds.z)(n.isReducedAnimations()),onEntering:e.onOpen,onExiting:e.onClose},O.createElement(yx.a,Object(k.__assign)({key:e.id,ref:o},e,{styles:Object(vx.d)(i,b&&i,c,!!h,!!s,n.isReducedAnimations(),r),"data-is-visible":i,role:"tabpanel",width:n.getPaneWidth(e,t),resizeChatButtonProps:a})))})))))},n.getResizeChatButtonProps=Object(Po.c)((function(e){if(e.resizeChatButtonProps)return Object(k.__assign)(Object(k.__assign)({},e.resizeChatButtonProps),{onExecute:n.getOnChatResizeExecute(e)})})),n.getOnChatResizeExecute=function(e){return function(t){var o,r,i=628;e.resizeWidth&&e.resizeWidth>e.width&&(i=e.width),n.onResizeStart(),n.resizable.current.updateSize({width:i,height:"100%"}),window.requestAnimationFrame((function(){return n.onResizeEnd(i)})),null===(r=null===(o=e.resizeChatButtonProps)||void 0===o?void 0:o.onExecute)||void 0===r||r.call(o,t)}},n.onResize=function(e){var t,o=(t=n.props).onResize,r=t.selectedPaneId,i=t.location,a=t.taskPanes;if(o&&r){var s=Object(Vy.d)(a,(function(e){return e.id===r}));s&&s.enableResize&&o(e,i)}},n.onResizeStart=function(){var e,t=(e=n.props).onResizeStart,o=e.selectedPaneId;n.setState({isResizing:!0}),t&&o&&t()},n.onResizeEnd=function(e){var t,o=(t=n.props).onResizeEnd,r=t.selectedPaneId;n.setState({isResizing:!1}),o&&r&&o(r,e)},n.findSelectedPaneRef=function(){var e=Object(Vy.d)(n.nonPersistedPanes,(function(e){return!!e.current&&e.current.props.id===n.props.selectedPaneId}));return e||(e=Object(Vy.d)(n.persistedPanes,(function(e){return!!e.current&&e.current.props.id===n.props.selectedPaneId})))},n.boundingWindowRectsChanged=function(e,t){n.setState({windowMode:t,layoutBreakpoint:Object(As.getLayoutBreakpoint)()})},n.findPane=function(e,t){return Object(Vy.d)(t,(function(t){return t.id===e}))},n.getOnTabButtonExecute=Object(Po.c)((function(e){return function(t,o){n.setLastInputMethod(o),e&&e(t)}})),n.setLastInputMethod=function(e){n.lastInputMethod=e},n.isResizeDisabled=function(){return!!n.props.stretchWidthToContainer},n.getPaneWidth=function(e,t){return e.resizeWidth&&n.taskPaneResizingIsEnabled(t,!!e.enableResize)?e.resizeWidth:e.width},n.taskPaneResizingIsEnabled=function(e,t){return e&&t&&!n.isResizeDisabled()},n.props.location===P.a.Left?n.rootId="tabbedTaskPaneContainerLeft":n.rootId="tabbedTaskPaneContainer",n.state={windowMode:Object(As.getWindowMode)(),layoutBreakpoint:Object(As.getLayoutBreakpoint)(),isResizing:!1},n.internalState={prevSelectedPaneId:void 0,currSelectedPaneId:t.selectedPaneId,prevPanes:[],currPanes:t.taskPanes,taskPaneOpeningMessage:""},Object(As.registerBoundingWindowRectsChanged)("reactTabbedTaskPanes_"+n.props.location,n.boundingWindowRectsChanged),n}return Object(k.__extends)(t,e),t.prototype.componentWillUnmount=function(){Object(As.unregisterBoundingWindowRectsChanged)("reactTabbedTaskPanes_"+this.props.location)},t.prototype.componentDidMount=function(){this.props.innerRef&&(this.props.innerRef.current=this)},t.prototype.componentDidUpdate=function(e){Object(xm.d)(this.persistedPanes,e.taskPanes,this.props.taskPanes);var t=e.selectedPaneId,n=this.props.selectedPaneId,o=n!==t;if(t&&o){var r=this.findPane(t,this.props.taskPanes);r&&r.onHide&&r.onHide(this.lastInputMethod)}if(n){var i=this.findPane(n,this.props.taskPanes);if(o&&i&&i.onShow&&i.onShow(this.lastInputMethod),i&&this.resizable.current){var a=t?this.getResizedPaneWidth(this.findPane(t,e.taskPanes)):void 0,s=this.getResizedPaneWidth(i);s&&(o||a&&s!==a)&&(this.resizable.current.updateSize({width:s,height:"100%"}),this.onResize(s))}}!n&&this.resizable.current&&this.resizable.current.updateSize({width:0,height:"100%"}),this.setLastInputMethod(Uy.a.Unknown),e.innerRef!==this.props.innerRef&&(e.innerRef&&(e.innerRef.current=null),this.props.innerRef&&(this.props.innerRef.current=this))},t.prototype.render=function(){var e,t,n=this,o=(e=this.props).taskPanes,r=e.location,i=e.selectedPaneId,a=e.onTabButtonExecute,s=e.styles,l=e.indicatorStyles,c=e.overflowMenuIcon,u=e.overflowMenuLabel,d=e.onOverflowMenuOpen,p=e.onOverflowMenuClose,h=e.tabContainerLabel,g=e.getGroupAdaptiveLayoutStyles,m=e.stretchWidthToContainer,f=e.onTabStripFocus,b=e.useBorderLessTaskPaneContainer,v=(t=this.state).windowMode,y=t.layoutBreakpoint,x=0,C=void 0,S=void 0;if(i){if(!(C=Object(Vy.d)(o,(function(e){return e.id===i}))))throw new Error("Selected pane ID was not found in the TabbedTaskPaneGroup");S=C.useBorderLessStyles,x=C.width}var E=o.filter((function(e){return!e.hidden})),k=O.createElement(_x,{ref:this.tabStrip,taskPanes:o,selectedPaneId:i,onTabButtonExecute:this.getOnTabButtonExecute(a),indicatorStyles:l,overflowMenuIcon:c,overflowMenuLabel:u,onOverflowMenuOpen:d,onOverflowMenuClose:p,tabContainerLabel:h,onFocus:f,location:r});return O.createElement(Jd.a.Consumer,null,(function(e){return O.createElement(Bo.a,null,(function(t){n.updateInternalState();var o=!!Object(dm.a)(e,dm.f.taskPaneResizingIsEnabled),i=!!Object(dm.a)(e,dm.f.multiTaskPaneOpenFixIsEnabled);C&&(x=n.getPaneWidth(C,o));var a=Object(wx.a)(n.context),l=Cx(xx(t,r,x,o&&!n.isResizeDisabled(),!!m,s,g&&g(v,y,E.length>0),n.isReducedAnimations(),E.length>0,a,S,b)),c=n.renderPanes(l,o,E.length,i);return O.createElement(Gy.a,{id:n.rootId,isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0,ignoreExternalFocusing:!0,className:l.root,tabIndex:0,"data-is-focusable":!0,onFocus:n.onRootFocus,onMouseDown:n.onRootMouseDown},O.createElement(Cc.a,{"aria-live":"polite",message:n.internalState.taskPaneOpeningMessage,"aria-atomic":!0}),O.createElement(td.a,null,r===P.a.Left?O.createElement(O.Fragment,null,k,c):O.createElement(O.Fragment,null,c,k)))}))}))},t.prototype.focus=function(){if(this.props.taskPanes.filter((function(e){return!e.hidden})).length>1&&this.tabStrip&&this.tabStrip.current)this.tabStrip.current.focus();else{var e=this.findSelectedPaneRef();e&&e.current&&e.current.focus()}},t.prototype.focusResizeHandle=function(){var e,t;null===(t=null===(e=this.resizable)||void 0===e?void 0:e.current)||void 0===t||t.focusResizeHandle()},t.contextType=Jd.a,t}(O.PureComponent),Dx=n(537),jx=function(e){return e.taskPaneDataModel.taskPaneModels},Bx=function(e,t){return t.location===P.a.Left?e.taskPaneDataModel.leftTaskPanes:e.taskPaneDataModel.rightTaskPanes},Fx=function(e,t){return t.location},Lx=function(e,t){return t.onOpen},Mx=function(e,t){return t.onClose},Ax=function(e,t){return t.middleContainer},Nx=function(e){return!(!e||Object(Dx.d)()||Object(Re.h)("RegionComposerIsEnabled")||e.className.includes("RegionComposer"))};function Wx(e,t){return t.location===P.a.Left?e.taskPaneDataModel.selectedTaskPaneIdLeft:e.taskPaneDataModel.selectedTaskPaneIdRight}var Hx=n(2015),zx=(Object(xr.a)([Bx,jx,Fx,Lx,Mx,Ax,function(e,t){return t.useReducedAnimations}],(function(e,t,n,o,r,i,a){var s=Object(Hx.a)(),l=Object(Dr.a)();return zx(e,t,{icon:s.closeIcon,label:l.closeLabel},n,o,r,i,a)})),Object(Po.c)((function(e,t,n,o,r,i,a,s){var l=Vx(e,t);return Gx(l,n,o,r,i,a,s)}))),Vx=Object(Po.c)((function(e,t){return e.map((function(e){return t[e]})).reduce((function(e,t){return t&&e.push(t),e}),[])})),Gx=Object(Po.c)((function(e,t,n,o,r,i,a){var s=Object(Dr.a)(),l=e.map((function(e){return Ux(e,t,n,o,r,i)}));return{location:n,taskPanes:l,taskPaneOpeningString:s.taskPaneOpeningString,useReducedAnimations:a}})),Ux=Object(Po.c)((function(e,t,n,o,r,i){var a=e.id,s=e.title,l=e.width,c=e.hideHeader,u=e.renderContent,d=e.isPersistedTaskPane,p=e.hidden,h=e.onCloseButtonTabKeyDown,g=e.actionButtonProps,m=e.headerIconUrl,f=e.headerIconId,b=e.useBorderLessStyles;return{id:a,title:s,width:l,hideHeader:c,closeButtonProps:Object(k.__assign)(Object(k.__assign)({},t),{onExecute:qx(n),onTabKeyDown:h}),renderContent:u,onOpen:Qx(e.id,n,e.width+1,e.onOpen,o,i),onClose:Qx(e.id,n,-1*(e.width+1),e.onClose,r,i),isPersistedTaskPane:d,hidden:p,actionButtonProps:g,headerIconId:f,headerIconUrl:m,useBorderLessStyles:b}})),qx=Object(Po.c)((function(e,t){return function(n){t&&t(),Object(kr.a)(fr(n,e))}})),Qx=Object(Po.c)((function(e,t,n,o,r,i){return function(a){r&&r(e,a),o&&o(a),i&&Kx(i,n,t)}})),Kx=function(e,t,n){if(Nx(e)){var o=Object(F.a)();if(n===P.a.Left&&!o||n===P.a.Right&&o){if(null!==e.style.left){var r=parseInt(e.style.left,10)||0;e.style.left=r+t+"px"}}else if(null!==e.style.right){var i=parseInt(e.style.right,10)||0;e.style.right=i+t+"px"}}},Jx=['[id^="cardRoot_"]','[id="GhostCard"]','[id="NewCommentButton"]','[id="LineageScrollablePaneId"]','[id="ConditionalFormattingTaskPane-panel"]'];var Zx,Yx=n(725),Xx=n(247),$x=n.n(Xx),eC=n(60),tC=Object(xr.a)([Bx,jx,Fx,function(e,t){return t.defaultTabStripIcon},Lx,Mx,Wx,Ax,function(e,t){return t.onShow},function(e,t){return t.onHide},function(e,t){return t.stretchWidthToContainer},function(e,t){return t.addVerticalScrollSpace},function(e,t){return t.globalMaxResizeWidth}],(function(e,t,n,o,r,i,a,s,l,c,u,d,p){return nC(e,t,n,o,r,i,a,s,l,c,u,d,p)})),nC=Object(Po.c)((function(e,t,n,o,r,i,a,s,l,c,u,d,p){var h=Vx(e,t);return oC(h,n,o,r,i,a,s,l,c,u,d,p)})),oC=Object(Po.c)((function(e,t,n,o,r,i,a,s,l,c,u,d){var p=Object(Hx.a)(),h=Object(Dr.a)(),g=Jx,m=e.map((function(e){return iC(e,p,h,t,n,o,r,a,i,s,l,u,d)}));return{location:t,taskPanes:m,selectedPaneId:i,onTabButtonExecute:dC(!!c,i,a),overflowMenuIcon:p.overflowMenuLauncher,overflowMenuLabel:h.taskPaneOverflowMenuLabel,tabContainerLabel:h.taskPaneTabsContainerLabel,onResize:rC(e,a,i),taskPaneOpeningString:h.taskPaneOpeningString,clickTargetSelectors:g}})),rC=Object(Po.c)((function(e,t,n){return function(o,r){if(vC(t)&&t){var i=e.filter((function(e){return!e.hidden})).length>1,a=n?Object(Vy.d)(e,(function(e){return e.id===n})):void 0,s=o+My(i,a)+"px",l=Object(F.a)();r===P.a.Left&&!l||r===P.a.Right&&l?t.style.left=s:t.style.right=s}}})),iC=Object(Po.c)((function(e,t,n,o,r,i,a,s,l,c,u,d,p){void 0===p&&(p=Number.MAX_SAFE_INTEGER);var h=e.id,g=e.title,m=e.titleTag,f=e.width,b=e.hideHeader,v=e.renderContent,y=e.isPersistedTaskPane,x=e.hidePersistedPaneInitially,C=e.hidden,S=e.onCloseButtonTabKeyDown,E=e.icon,k=e.headerIconId,O=e.headerIconUrl,T=e.actionButtonProps,I=e.rightActionButtonProps,w=e.showSharingContent,_=e.canBeShared,P=e.enableResize,R=e.minResizeWidth,D=e.maxResizeWidth,j=e.resizeWidth,B=e.isModernPane,F=e.disableVerticalScrollSpace,L=e.isNonClosablePane,M=e.preventCloseCallback,A=e.onManualClose,N=e.showResizeChatButton,W=e.showBackButton,H=e.useBorderLessStyles,z=Object(Re.h)("TaskPaneResizingIsEnabled")&&P,V=D&&Math.min(D,p),G=z&&V?Math.min(V,920):f,U=z&&R?Math.max(R,100):f,q=j&&V?Math.min(j,V):j;return{id:h,title:g,titleTag:m,width:f,hideHeader:b,useBorderLessStyles:H,closeButtonProps:L||_&&w?void 0:sC(t,n,o,S,M,A),renderContent:v,icon:E||r,headerIconId:k,headerIconUrl:O,onOpen:gC(h,e.onOpen,i,s),onClose:mC(h,e.onClose,a,s),isPersistedTaskPane:y,hidePersistedPaneInitially:x,hidden:C,actionButtonProps:_&&w?cC():W?lC(o,S,M,A):T,rightActionButtonProps:_?w?void 0:uC(null==I?void 0:I.onTabKeyDown,null==I?void 0:I.onExecute):I,resizeChatButtonProps:!N||"Portrait"===Object(As.getWindowMode)()&&"Small"===Object(As.getLayoutBreakpoint)()?void 0:aC(q,f),onShow:fC(h,e.onShow,c),onHide:bC(h,!l,e.onHide,u),stretchBodyToContainer:B,enableResize:!!z&&P,minResizeWidth:Math.min(U,G),maxResizeWidth:G,roleDescription:n.taskPaneRoleDescription,resizeWidth:q,addVerticalScrollSpace:!F&&d}})),aC=Object(Po.c)((function(e,t){var n=void 0!==e&&e>t,o=n?$x.a.CollapsePane_20:$x.a.ExpandPane_20,r=n?Object(Ym.a)().TaskPaneResizeCollapseChatButton:Object(Ym.a)().TaskPaneResizeExpandChatButton,i=n?"ResizeChatCollapse":"ResizeChatExpand";return{label:r,icon:o,onExecute:function(){var t=[{name:"WindowWidth",int64:window.innerWidth}];e&&t.push({name:"ResizeWidth",int64:e}),Object(go.logUserAction)(i,void 0,void 0,void 0,void 0,void 0,t)}}})),sC=Object(Po.c)((function(e,t,n,o,r,i){return{icon:e.closeIcon,label:t.closeLabel,onExecute:r?pC(n,r,i):qx(n,i),onTabKeyDown:o}})),lC=Object(Po.c)((function(e,t,n,o){var r;return{icon:$x.a.BackFluent_24,label:null!==(r=Object(Dr.a)().navigationPaneCloseLabel)&&void 0!==r?r:"",onExecute:n?pC(e,n,o):qx(e,o),onTabKeyDown:t}})),cC=Object(Po.c)((function(){return{icon:"Back",label:Object(Ym.a)().AddinSharingActionButtonLabel,onExecute:hC()}})),uC=Object(Po.c)((function(e,t){return{icon:"Send",label:Object(Ym.a)().AddinSharingShareButtonLabel,onExecute:hC(t),onTabKeyDown:e}})),dC=Object(Po.c)((function(e,t,n){return function(o){var r=o;if(t&&t===o){if(e)return;r=void 0}n&&vC(n)?Object(kr.a)([br(r),vr(n)]):Object(kr.a)(br(r))}})),pC=Object(Po.c)((function(e,t,n){return function(o){t((function(){qx(e,n)(o)}))}})),hC=Object(Po.c)((function(e){return function(t){var n;e&&e(t),Object(kr.a)((n=t,Object(ur.a)(dr.Pb,{taskPaneId:n})))}})),gC=Object(Po.c)((function(e,t,n,o){return function(r){n&&n(e,r),t&&t(r),o&&vC(o)&&Object(kr.a)(vr(o,e));if(!Object(eC.u)()||"FindReplaceTaskPane"!==e){var i=e+":PaneOpen:Start",a=e+":PaneOpen:End";Object(lr.a)(a,i),Object(Yx.b)()&&(window.performance.clearMarks(i),window.performance.clearMarks(a))}}})),mC=Object(Po.c)((function(e,t,n,o){return function(r){n&&n(e,r),t&&t(r),o&&vC(o)&&Object(kr.a)(vr(o))}})),fC=Object(Po.c)((function(e,t,n){return function(o){n&&n(e,o),t&&t(o)}})),bC=Object(Po.c)((function(e,t,n,o){return function(r){o&&o(e,r,t),n&&n(r,t)}})),vC=function(e){return Nx(e)},yC=n(226),xC=Object(Po.c)((function(e,t,n){return function(o,r){t&&Nx(t)?e(Object(yC.batchActions)([gr(o,r),vr(t,o)])):e(gr(o,r)),n&&n()}})),CC=n(2239),SC=Object(Ir.connect)((function(e,t){Object(Wm.j)("TabbedTaskPaneGroup");var n=Object(k.__assign)(Object(k.__assign)({},tC(e,t)),{innerRef:t.innerRef,styles:t.styles,indicatorStyles:t.indicatorStyles,onOverflowMenuClose:t.onOverflowMenuClose,onOverflowMenuOpen:t.onOverflowMenuOpen,onResizeStart:t.onResizeStart,getGroupAdaptiveLayoutStyles:t.getGroupAdaptiveLayoutStyles,stretchWidthToContainer:t.stretchWidthToContainer,resizeStrings:t.resizeStrings,getSplashPageContent:t.getSplashPageContent,addVerticalScrollSpace:t.addVerticalScrollSpace,resizeHandleIcon:t.resizeHandleIcon,onTabStripFocus:t.onTabStripFocus,id:"TabbedTaskPaneGroupProps",useReducedAnimations:t.useReducedAnimations,useBorderLessTaskPaneContainer:t.useBorderLessTaskPaneContainer});return Object(Wm.j)("TabbedTaskPaneGroup","NonCached"),n}),(function(e,t){Object(Wm.h)("TabbedTaskPaneGroup");var n=Object(k.__assign)({},function(e,t){return{onResizeEnd:xC(e,t.middleContainer,t.onResizeEnd)}}(e,t));return Object(Wm.h)("TabbedTaskPaneGroup","NonCached"),n}),(function(e,t){Object(Wm.i)("TabbedTaskPaneGroup");var n=Object(k.__assign)(Object(k.__assign)({},e),t);return Object(Wm.i)("TabbedTaskPaneGroup","NonCached"),n}),{areStatesEqual:Object(Tr.a)("TabbedTaskPaneGroup")})(Object(Or.a)(Rx)),EC=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabbedTaskPaneGroup=O.createRef(),t}return Object(k.__extends)(t,e),t.prototype.focus=function(){var e,t;null===(t=null===(e=this.tabbedTaskPaneGroup)||void 0===e?void 0:e.current)||void 0===t||t.focus()},t.prototype.focusResizeHandle=function(){var e,t;null===(t=null===(e=this.tabbedTaskPaneGroup)||void 0===e?void 0:e.current)||void 0===t||t.focusResizeHandle()},t.prototype.render=function(){return O.createElement(CC.a,null,O.createElement(SC,Object(k.__assign)({innerRef:this.tabbedTaskPaneGroup},this.props)))},t}(O.PureComponent),kC=n(422),OC=Object(Po.c)((function(){return{resizeCurrentValue:OfficeCommonStrings.TaskPaneResizeCurrentValue,resizeLabel:OfficeCommonStrings.TaskPaneResize,resizeMaxValue:OfficeCommonStrings.TaskPaneResizeMaxValue,resizeMinValue:OfficeCommonStrings.TaskPaneResizeMinValue,resizeModeOff:OfficeCommonStrings.TaskPaneResizeModeOff,resizeModeOn:OfficeCommonStrings.TaskPaneResizeModeOn}})),TC=n(650),IC=function(e){function t(t){var n=e.call(this,t)||this;return n.tabbedContainer=O.createRef(),Object(Hx.b)(ir.a),Object(Dr.b)(Object(b.a)()),n}return Object(k.__extends)(t,e),t.prototype.focus=function(){var e,t;null===(t=null===(e=this.tabbedContainer)||void 0===e?void 0:e.current)||void 0===t||t.focus()},t.prototype.focusResizeHandle=function(){var e,t;null===(t=null===(e=this.tabbedContainer)||void 0===e?void 0:e.current)||void 0===t||t.focusResizeHandle()},t.prototype.render=function(){var e=TC.a;return O.createElement(cl.a,{className:Object(V.eb)({fontFamily:ExcelRibbonStrings.UserInterfaceFontName,fontSize:ExcelRibbonStrings.UserInterfaceFontSize})},O.createElement(Ir.Provider,{store:kC.a},O.createElement(e,{as:"span"},O.createElement(EC,Object(k.__assign)({ref:this.tabbedContainer},this.props,{resizeStrings:OC(),defaultTabStripIcon:c.a.AppForOfficeLogo_20,resizeHandleIcon:W.a.PaneResizingGrabber_32,styles:{root:{position:"relative",borderLeftColor:Object(yt.isChangeGateEnabled)("OfficeVSO:8206025_TaskPaneBorderColourUpdate")?"#e0e0e0":void 0}},indicatorStyles:{root:{backgroundColor:Object(f.a)().primary}}})))))},t}(O.PureComponent);function wC(e,t,n,o){return Object(k.__assign)({id:e,title:t,width:n},o)}function _C(e,t){switch(t){case"CopilotSDXTaskpane":return"XLCoPilot_24";default:return}}var PC,RC=[],DC=[],jC=O.createRef(),BC=function(e){switch(e.type){case"ExcelLegacyTaskPaneWacInfraProps":return!!e.isSharedRuntime;default:return!1}};var FC=function(e,t){return function(n){n(Object(yC.batchActions)([hr(MC(e,t)),mr(e,t.location)]))}},LC=function(e){return function(t){t(br(e))}};var MC=function(e,t){var n=t.title,o=t.width,r=Object(k.__rest)(t,["title","width"]),i=function(){return ry(e,t.contentProps,Zx)};if(Object(yt.isChangeGateEnabled)("OfficeVSO:5706321_SDXTaskpaneIconIdOverride")){var a=null;return t.iconId?a=sy(t.contentProps,t.iconId):t.iconUrl?(a=Object(_.a)(t.iconUrl),I.a.registerAddinIcon(a,t.iconUrl)):a=sy(t.contentProps,e),Object(yt.isChangeGateEnabled)("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")?wC(e,n,o,Object(k.__assign)({renderContent:i,icon:a,headerIconId:_C(t.contentProps,t.iconId||""),isPersistedTaskPane:RC.indexOf(e)>=0||BC(t.contentProps),hidePersistedPaneInitially:DC.indexOf(e)>=0},r)):wC(e,n,o,Object(k.__assign)({renderContent:i,icon:a,isPersistedTaskPane:RC.indexOf(e)>=0||BC(t.contentProps),hidePersistedPaneInitially:DC.indexOf(e)>=0},r))}var s="";return t.iconUrl&&(s=Object(_.a)(t.iconUrl),I.a.registerAddinIcon(s,t.iconUrl)),Object(yt.isChangeGateEnabled)("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")?wC(e,n,o,Object(k.__assign)({renderContent:i,icon:t.iconUrl?s:sy(t.contentProps,e),headerIconId:_C(t.contentProps,t.iconId||""),isPersistedTaskPane:RC.indexOf(e)>=0||BC(t.contentProps),hidePersistedPaneInitially:DC.indexOf(e)>=0},r)):wC(e,n,o,Object(k.__assign)({renderContent:i,icon:t.iconUrl?s:sy(t.contentProps,e),isPersistedTaskPane:RC.indexOf(e)>=0||BC(t.contentProps),hidePersistedPaneInitially:DC.indexOf(e)>=0},r))};var AC,NC={renderTaskPaneGroups:function(e,t,n){PC=n.middleContainer,Ay(),Zx=n.setFocusCallback,Object(yt.isChangeGateEnabled)("OfficeVSO:8262217_fixingJsCrashWithThemeProvider")?t&&T.render(O.createElement(IC,Object(k.__assign)({ref:jC,location:P.a.Right},n)),t):T.render(O.createElement(IC,Object(k.__assign)({ref:jC,location:P.a.Right},n)),t)},showTaskPane:function(e,t){Object(w.a)(e+":PaneOpen:Start"),Object(Wy.a)([FC(e,t),LC(e)])},updateTaskPane:function(e,t){Object(Wy.a)(hr(MC(e,t)))},hideTaskPane:function(e,t){Object(Wy.a)(fr(e,t))},doNotUse_InitializePersistedTaskPane:function(e,t){RC.indexOf(e)<0&&RC.push(e),Object(Wy.a)(FC(e,t))},focusTabbedTaskPaneArea:function(){var e;null===(e=null==jC?void 0:jC.current)||void 0===e||e.focus()},setSelectedTaskPane:function(e){PC&&vC(PC)?Object(Wy.a)([LC(e),vr(PC,e)]):Object(Wy.a)(LC(e))},selectors:(AC=kC.a,{getTabbedTaskPaneCount:function(e){return void 0===e&&(e=P.a.Right),function(e,t){return(t===P.a.Left?e.taskPaneDataModel.leftTaskPanes:e.taskPaneDataModel.rightTaskPanes).reduce((function(t,n){var o=e.taskPaneDataModel.taskPaneModels[n];return o&&!o.hidden?t+1:t}),0)}(AC.getState(),e)},getSelectedTaskPane:function(e){return void 0===e&&(e=P.a.Right),Wx(AC.getState(),{location:e})}}),focusResizeHandle:function(){var e;null===(e=null==jC?void 0:jC.current)||void 0===e||e.focusResizeHandle()},initializeHiddenSharedRuntimeTaskPane:function(e,t){DC.indexOf(e)<0&&DC.push(e),Object(Wy.a)(FC(e,t))}},WC=n(2351),HC=n(140),zC=n(139),VC=n(660),GC=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.bodyRendererFunction=function(){var e=n.props.bodyControls,t=e.redLabel,o=e.blueLabel,r=e.greenLabel,i=e.hexLabel,a=e.alphaLabel,s=e.alphaSliderType,l=e.alphaAriaLabel,c=e.hueAriaLabel,u=e.transparencyAriaLabel,d=e.svAriaLabel,p=e.hexError,h=e.alphaError,g=e.transparencyError,m=e.redError,f=e.greenError,b=e.blueError;return O.createElement(WC.a,{color:n.selectedColor,onChange:n.updateColor,showPreview:!0,alphaType:s||"none",styles:{panel:{padding:12},root:{width:352,maxWidth:352},colorRectangle:{height:268,marginBottom:"12px"},flexContainer:{marginBottom:"12px"},colorSquare:{marginLeft:"12px"}},strings:{red:t,blue:o,green:r,hex:i,alpha:a,alphaAriaLabel:l,hueAriaLabel:c,transparencyAriaLabel:u,svAriaLabel:d,hexError:p,alphaError:h,transparencyError:g,redError:m,greenError:f,blueError:b}})},n.updateColor=function(e,t){n.selectedColor=t},n.colorPickerDialogResultHandler=function(e){var t={};e===zC.a.Ok&&(t.selectedColorText=n.selectedColor.hex,n.props.bodyControls.alphaSliderType&&"none"!==n.props.bodyControls.alphaSliderType&&(t.alphaValue=n.selectedColor.a)),n.baseResultHandler(e,t)},n.selectedColor=t.bodyControls.initColor&&Object(HC.a)(t.bodyControls.initColor)||Object(HC.a)("#ffffff"),null!=t.bodyControls.alpha&&void 0!==t.bodyControls.alpha&&(n.selectedColor.a=t.bodyControls.alpha),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.colorPickerDialogResultHandler,styles:{root:{selectors:{".ms-Button-label":{textAlign:"center",minWidth:"86px"}}},main:{}}}))},t}(O.PureComponent);var UC=n(284),qC={paddingTop:20},QC={flexDirection:"column",width:435},KC={paddingTop:16},JC={paddingTop:20,display:"flex",justifyContent:"space-between"},ZC={paddingTop:5},YC={root:{width:15,height:15}},XC=function(e){function t(t){var n=e.call(this,t)||this;return n.bodyRendererFunction=function(){return O.createElement(Bo.a,null,(function(e){var t=Object(UC.h)(e,n.props.sharedDialogStyles);return n.renderNoClipboardAccessDialog(t)}))},n.onClickHandler=n.onClickHandler.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.props.resultHandler,dialogButtonsOption:zC.b.None}))},t.prototype.renderNoClipboardAccessDialog=function(e){var t=this.props.bodyControls,n=t.startText,o=t.endText,r=t.cutText,i=t.copyText,a=t.pasteText,s=t.cutShortcutText,l=t.copyShortcutText,c=t.pasteShortcutText,u=t.learnMoreLink,d=t.imageAltText,p=t.imageSrc,h=t.primaryButtonLabel;return O.createElement("div",{style:QC},O.createElement("div",null,n," [",O.createElement(H.a,{iconName:$x.a.LockGlyph_24x_24,"aria-hidden":!0,styles:YC}),"] ",o),O.createElement("div",{style:qC},O.createElement("div",null,O.createElement("b",null,r)," - ",s," | ",O.createElement("b",null,i)," -"," ",l," | ",O.createElement("b",null,a)," - ",c)),O.createElement("img",{src:p,style:KC,alt:d}),O.createElement("div",{style:JC},O.createElement("div",{style:ZC},O.createElement(Li.a,Object(k.__assign)({},u,{type:"AppLinkProps",id:"learnMoreLink"}))),O.createElement($t.a,{id:"okButton",label:h,type:"AppButtonProps",onExecute:this.onClickHandler,styles:e.primaryButton})))},t.prototype.onClickHandler=function(e){this.props.resultHandler(zC.a.Ok)},t}(O.PureComponent);var $C={fontSize:"28px"},eS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyRendererFuction=function(){var e=t.props.bodyControls,n=e.extensionStartText,o=e.extensionLink,r=e.extensionEndText,i=e.shortcutsMessageText,a=e.cutText,s=e.copyText,l=e.pasteText,c=e.pasteTextOnly;return O.createElement("div",{style:{flexDirection:"column"}},O.createElement("div",{style:{fontWeight:600,fontSize:"16px"}},O.createElement("span",null,n),o&&O.createElement("span",null,O.createElement(Li.a,Object(k.__assign)({},o,{shouldTakeFocus:!1}))),r&&O.createElement("span",null,r)),O.createElement("div",{style:{paddingTop:"20px",paddingBottom:"6px",fontSize:"14px"}},i),O.createElement("div",{style:{fontWeight:600,fontSize:"14px"}},O.createElement("div",null,a),O.createElement("div",null,s),O.createElement("div",null,l),O.createElement("div",null,c)))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFuction,sharedDialogStyles:(e=this.props.sharedDialogStyles,void 0!==e?(t=e).title=Object(V.eb)(e.title,$C):t={title:$C},t),maxWidth:450,focusDefaultButtonWhenOpened:!0}));var e,t},t}(O.PureComponent);var tS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyRendererFuction=function(){var e=t.props.bodyControls,n=e.forwardElementText,o=e.cutText,r=e.copyText,i=e.pasteText,a=e.pasteTextOnly,s=e.extensionLink,l=e.suggestionPrefixElement,c=e.suggestionSuffixElement;return O.createElement("div",{style:{flexDirection:"column"}},O.createElement("div",null,n),O.createElement("div",{style:{fontWeight:"bold",paddingTop:"20px"}},O.createElement("div",null,o),O.createElement("div",null,r),O.createElement("div",null,i),a&&O.createElement("div",null,a)),s&&O.createElement("div",{style:{paddingTop:"20px"}},l&&O.createElement("span",null,l),O.createElement("span",null,O.createElement(Li.a,Object(k.__assign)({},s))),c&&O.createElement("span",null,c)))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFuction}))},t}(O.PureComponent);var nS=function(){return{containingDivStyles:{width:UC.a},displayLinkInput:{field:["txtDisplay"],subComponentStyles:{label:{root:{fontWeight:V.l.semibold}}}},addressLinkInput:{field:["txtLink"],subComponentStyles:{label:{root:{fontWeight:V.l.semibold,paddingTop:8}}}}}},oS=Object(Po.c)((function(e){return{pivot:{root:{marginTop:"18px",marginBottom:"20px"}},enterLink:{wrapper:{width:"65px",height:"16px"},pivotHeader:{root:{fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"14px",background:"transparent",padding:"0px 0px"},rootHovered:{color:e.palette.black,background:"transparent"}},selectedPivotHeader:{root:{background:"transparent",color:e.palette.black},rootHovered:{color:e.palette.black,background:"transparent"}},indicator:{margin:"0px 10%",width:"80%",top:"-6px",position:"relative",background:e.palette.themeDark}},thisDocument:{wrapper:{width:"103px",height:"16px",paddingLeft:"10px"},pivotHeader:{root:{background:"transparent",fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"14px",padding:"0px 0px"},rootHovered:{background:"transparent",color:e.palette.black}},selectedPivotHeader:{root:{background:"transparent",color:e.palette.black},rootHovered:{background:"transparent",color:e.palette.black}},indicator:{margin:"0px 10%",width:"80%",top:"-6px",position:"relative",background:e.palette.themeDark}}}})),rS=Object(Po.c)((function(){return{addressLinkInput:{root:{marginTop:"15px",marginBottom:"15px"},fieldGroup:{minHeight:"30px"},field:["txtLink",{height:"30px",overflow:"hidden",whiteSpace:"nowrap"}]}}})),iS=Object(Po.c)((function(e){return{backgroundColor:e.palette.white,height:"130px",boxSizing:"border-box",border:"1px solid ".concat(e.palette.neutralQuaternary),borderRadius:"2px",marginTop:"15px",marginBottom:"15px",overflow:"auto"}})),aS=Object(Po.c)((function(){return Object(V.db)({root:{overflowY:"auto"},focusZone:{maxWidth:"100%"}})})),sS=Object(Po.c)((function(){return Object(V.db)({headerCount:{display:"none"},groupHeaderContainer:{marginLeft:"-48px"},title:{cursor:"default"}})})),lS=Object(Po.c)((function(e){return Object(V.db)({root:{width:"calc(100% - 0px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",color:e.palette.black},fields:{marginTop:"-12px",marginLeft:"36px",selectors:{":hover":{overflowX:"auto",display:"block"},":focus":{overflowX:"auto",display:"block"}}}})})),cS={main:{position:"relative",top:"30% !important",visibility:"hidden"},root:{}},uS=function(e){function t(t){var n=e.call(this,t)||this;if(n.baseResultHandler=n.props.resultHandler,n.textDisplayValue="",n.textLinkValue="",n.txtDisplay="txtDisplay",n.txtLink="txtLink",n.isTabPanelEnabled=!1,n.enterLinkTabTxtDisplay="",n.thisDocumentTabTxtDisplay="",n.pivot=O.createRef(),n.enterLinkTab="InsertLinkDialog-EnterLinkTab",n.thisDocumentTab="InsertLinkDialog-ThisDocumentTab",n.items=[],n.groups=[],n.columns=[],n.groupedResultsList=O.createRef(),n.state={currentlySelectedPivotId:n.enterLinkTab,isCurrentTextLinkEmpty:""===n.textLinkValue,isAnyItemInDocumentTabSelected:!1},n.onPivotItemClicked=function(e){n.setState({currentlySelectedPivotId:e}),e===n.enterLinkTab?n.setState({isAnyItemInDocumentTabSelected:!1,isCurrentTextLinkEmpty:""===n.textLinkValue}):e===n.thisDocumentTab&&(n.syncStateWithSelection(),n.setState({isCurrentTextLinkEmpty:!0}))},n.syncStateWithSelection=function(){var e=n.selection.getSelection().length>0;n.setState({isAnyItemInDocumentTabSelected:e})},n.onRenderGroupHeader=function(e){return O.createElement(mm.a,Object(k.__assign)({},e,{expandButtonIcon:"",useFastIcons:!1,indentWidth:0,selected:!1,isSelected:!1}))},n.onRenderCell=function(e,t,o,r){return o&&"number"==typeof r&&r>-1?O.createElement(_i.a,{columns:n.columns,groupNestingDepth:t,item:o,itemIndex:r,selection:n.selection,selectionMode:Pi.d.single,compact:!0,checkboxVisibility:hu.a.hidden,styles:lS(e)}):null},n.bodyRendererFunction=function(){var e=n.props.bodyControls,t=e.displayTextLabel,o=e.txtDisplay,r=e.textDisplayDisabled,i=nS();return O.createElement(Bo.a,null,(function(e){return O.createElement("div",{style:i.containingDivStyles},O.createElement(Ya.a,{type:"AppInputProps",id:n.txtDisplay,defaultValue:o||void 0,autoComplete:"off",spellCheck:!1,styles:i.displayLinkInput,disabled:r,onChange:n.onTextDisplayChange,selectTextOnFocus:!0,label:t}),n.isTabPanelEnabled?n.renderTabPanel(e):n.renderAddressLinkAppInput())}))},n.onTextDisplayChange=function(e){n.textDisplayValue=e||""},n.onTextLinkChange=function(e){n.textLinkValue=(null==e?void 0:e.trim())||"",n.setState({isCurrentTextLinkEmpty:""===n.textLinkValue})},n.insertLinkDialogResultHandler=function(e){var t={},o=n.state.currentlySelectedPivotId;if(n.isTabPanelEnabled&&o===n.thisDocumentTab&&null!==n.selection&&0!==n.selection.count){var r=n.selection.getSelection()[0];t=r.isHeading?{txtDisplay:n.textDisplayValue,linkurl:r.linkurl,isHeading:!0,startCp:r.startCp,endCp:r.endCp,paragraphNode:r.paragraphNode}:{txtDisplay:n.textDisplayValue,linkurl:r.linkurl,isHeading:!1}}else t={txtDisplay:n.textDisplayValue,txtLink:n.textLinkValue};n.baseResultHandler(e,t)},n.textDisplayValue=t.bodyControls.txtDisplay||"",n.textLinkValue=t.bodyControls.txtLink||"",n.state.isCurrentTextLinkEmpty=""===n.textLinkValue,n.state.isAnyItemInDocumentTabSelected=!1,n.selection=new wi.a({onSelectionChanged:function(){return n.syncStateWithSelection()}}),t.bodyControls.insertInternalLinkEnabled&&(n.isTabPanelEnabled=!0,n.enterLinkTabTxtDisplay=t.bodyControls.enterLinkTabLabel||"",n.thisDocumentTabTxtDisplay=t.bodyControls.thisDocumentTabLabel||"",t.bodyControls.groupedList)){n.items=t.bodyControls.groupedList.items||[],n.groups=t.bodyControls.groupedList.groups||[],n.columns=[{key:"name",name:"Name",fieldName:"linkurl",minWidth:200,isResizable:!0}],n.selection.setItems(n.items,!0);var o=t.bodyControls.groupedList.selectedItem;if(o){var r=o.selectedIndex,i=o.selectedGroupId;n.selection.setIndexSelected(r,!0,!1),n.groups[i].isCollapsed=!1,n.state.currentlySelectedPivotId=n.thisDocumentTab}}return n}return Object(k.__extends)(t,e),t.prototype.getPivotHeaders=function(e){var t=oS(e);return[{id:this.enterLinkTab,title:this.enterLinkTabTxtDisplay,styles:t.enterLink},{id:this.thisDocumentTab,title:this.thisDocumentTabTxtDisplay,styles:t.thisDocument}]},t.prototype.renderTabPanel=function(e){var t=this.state.currentlySelectedPivotId,n=oS(e);return O.createElement("div",null,O.createElement(kx.a,{styles:n.pivot,componentRef:this.pivot,selectedPivotId:t,overflowMenuLauncherLabel:"More Tabs",topLevelItems:this.getPivotHeaders(e),onPivotHeaderExecute:this.onPivotItemClicked,displayTabIndicatorPlaceholder:!0,onPivotHeaderFocus:this.onPivotItemClicked}),t===this.thisDocumentTab?this.renderThisDocumentTabPanel(e):this.renderEnterLinkTabPanel())},t.prototype.renderEnterLinkTabPanel=function(){var e=rS();return O.createElement(Ya.a,{type:"AppInputProps",id:this.txtLink,defaultValue:this.textLinkValue,autoComplete:"off",spellCheck:!1,styles:e.addressLinkInput,onChange:this.onTextLinkChange,selectTextOnFocus:!0,inputType:"url",multiline:!1,resizable:!1,label:this.enterLinkTabTxtDisplay,hideLabel:!0})},t.prototype.renderThisDocumentTabPanel=function(e){return O.createElement("div",{style:iS(e)},this.populateList(this.items,this.groups,this.selection,e))},t.prototype.populateList=function(e,t,n,o){var r=this,i={headerProps:{styles:sS()},onRenderHeader:this.onRenderGroupHeader,showEmptyGroups:!0};return O.createElement(Ra.a,{selection:n,selectionMode:Pi.d.single,isSelectedOnFocus:!0},O.createElement(Kd.a,{items:e,groups:t,listProps:{onShouldVirtualize:function(){return!1}},selection:n,compact:!0,selectionMode:Pi.d.single,groupProps:i,componentRef:this.groupedResultsList,onRenderCell:function(e,t,n){return r.onRenderCell(o,e,t,n)},styles:aS(),focusZoneProps:{shouldRaiseClicks:!1}}))},t.prototype.renderAddressLinkAppInput=function(){var e=this.props.bodyControls,t=e.addressLabel,n=e.txtLink,o=nS();return O.createElement(Ya.a,{type:"AppInputProps",id:this.txtLink,defaultValue:n||void 0,autoComplete:"off",spellCheck:!1,styles:o.addressLinkInput,onChange:this.onTextLinkChange,selectTextOnFocus:!0,label:t,inputType:"url"})},t.prototype.render=function(){var e=void 0;return this.props.actionButtonProps&&(e=Object(k.__assign)(Object(k.__assign)({},this.props.actionButtonProps),{disabled:this.state.isCurrentTextLinkEmpty&&!this.state.isAnyItemInDocumentTabSelected})),O.createElement(VC.a,Object(k.__assign)({},this.props,{actionButtonProps:e,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.insertLinkDialogResultHandler,firstFocusableSelector:this.props.bodyControls.textDisplayInitialFocus?"txtDisplay":"txtLink",styles:cS,settings:{pinBehaviorIsEnabled:!0}}))},t}(O.PureComponent);var dS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyRendererFuction=function(){var e=t.props.bodyControls,n=e.errorMessage,o=e.errorFileDownloadOffer,r=e.helpLink,i=e.macOfficePreLinkText,a=e.macOfficeLink,s=e.macOfficePostLinkText;return O.createElement("div",null,O.createElement("div",null,n),r&&O.createElement("div",{style:{marginTop:"16px"}},O.createElement(Li.a,Object(k.__assign)({},r))),a?O.createElement("div",null,i&&O.createElement("span",null,i),O.createElement("span",null,O.createElement(Li.a,Object(k.__assign)({},a))),s&&O.createElement("span",null,s)):O.createElement("div",{style:{marginTop:"16px"}},o))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFuction}))},t}(O.PureComponent);var pS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyRendererFuction=function(){var e=t.props.bodyControls,n=e.errorMessage,o=e.errorFileDownloadOffer,r=e.helpLink;return O.createElement("div",null,O.createElement("div",null,n),r&&O.createElement("div",{style:{marginTop:"16px"}},O.createElement(Li.a,Object(k.__assign)({},r))),O.createElement("div",{style:{marginTop:"16px"}},o))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFuction}))},t}(O.PureComponent);var hS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyRendererFuction=function(){var e=t.props.bodyControls,n=e.errorMessage,o=e.offerString,r=e.helpLink;return O.createElement("div",null,O.createElement("div",null,n),O.createElement("div",{style:{marginTop:"16px"}},o),r&&O.createElement("div",null,O.createElement(Li.a,Object(k.__assign)({},r))))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFuction}))},t}(O.PureComponent);var gS="@media only screen and (max-width: 600px)",mS={gridColumn:"1",gridRow:"1","-ms-grid-row":"1","-ms-grid-column":"1"},fS={gridColumn:"2",gridRow:"1","-ms-grid-row":"1","-ms-grid-row-span":"1","-ms-grid-column":"2","-ms-grid-column-span":"1"},bS={gridColumn:"1",gridRow:"2","-ms-grid-row":"2","-ms-grid-row-span":"1","-ms-grid-column":"1","-ms-grid-column-span":"1"},vS={display:"flex",paddingRight:0,paddingLeft:0,minWidth:228},yS=Object(Po.c)((function(e){return{display:e?"inline-flex":"flex",marginRight:0,width:"100%"}})),xS=function(e){var t;return Object(V.eb)({gridTemplateColumns:"1fr 1fr",gridTemplateRows:"auto",gridColumnGap:"40px",selectors:(t={},t[gS]={gridTemplateColumns:"1fr",gridTemplateRows:"1fr auto",gridColumnGap:"0"},t)},e)},CS=function(){var e;return Object(V.eb)([fS,{selectors:(e={},e[gS]=bS,e)}])},SS=Object(Po.c)((function(e){var t;return Object(V.eb)([mS,{paddingRight:e?40:0,selectors:(t={},t[gS]={paddingRight:0},t)}])})),ES=Object(Po.c)((function(e){return{labelStyles:{label:{fontWeight:"bold",lineHeight:"normal"},root:{padding:"15px 0 0 0"}},spinButtonStyles:{root:vS,labelWrapper:{flex:1,float:"none",marginLeft:10,marginRight:0,height:40},label:{lineHeight:"normal"},spinButtonWrapper:{flex:1}},comboBoxStyles:{container:yS(e),root:{flex:1,padding:0},textContainer:{paddingLeft:10,flex:1},label:{margin:0,lineHeight:"normal",minHeight:"initial"}},comboBoxOptionsStyles:{optionText:{fontSize:"inherit"}},containerStyles:{display:e?"-ms-grid":"grid"}}})),kS=n(1132),OS=function(e){function t(t){var n=e.call(this,t)||this;return n.didChangeSpecialIndentationComboBoxValue=!1,n.baseResultHandler=n.props.resultHandler,n.indentationNoneValue="0",n.bodyRendererFunction=function(){var e=n.state.bodyStateProps,t=e.alignmentComboBoxProps,o=e.hideGeneralOptions,r=e.specialIndentationComboBoxProps,i=e.hideIndentationOptions,a=e.lineSpacingComboBoxProps,s=e.hideSpacingOptions,l=e.beforeTextSpinButtonProps,c=e.afterTextSpinButtonProps,u=e.bySpinButtonProps,d=e.beforeSpacingSpinButtonProps,p=e.afterSpacingSpinButtonProps,h=e.atSpinButtonProps,g=e.generalLabelProps,m=e.indentationLabelProps,f=e.spacingLabelProps,b=e.contextualSpacingCheckboxProps,v="undefined"!=typeof navigator?navigator:void 0,y=!(!v||!/rv:11.0/i.test(v.userAgent)),x=ES(y);return O.createElement("div",{style:x.containerStyles,className:xS(n.props.bodyProps.customContainerStyles)},O.createElement("div",{id:"LeftGroup",className:SS(y)},!o&&g&&t&&O.createElement("div",{id:g.forId,"aria-labelledby":g.id,role:"group"},O.createElement(jo.a,Object(k.__assign)({},g,{styles:x.labelStyles})),O.createElement(Wr.a,Object(k.__assign)({},t,{calloutHostLayerId:kS.a,onExecute:n.onAlignmentComboBoxExecute,styles:x.comboBoxStyles,optionStyles:x.comboBoxOptionsStyles}))),!i&&m&&O.createElement("div",{id:m.forId,"aria-labelledby":m.id,role:"group"},O.createElement(jo.a,Object(k.__assign)({},m,{styles:x.labelStyles})),l&&O.createElement(or.a,Object(k.__assign)({},l,{styles:x.spinButtonStyles,onExecute:n.onBeforeTextSpinButtonChange})),c&&O.createElement(or.a,Object(k.__assign)({},c,{styles:x.spinButtonStyles,onExecute:n.onAfterTextSpinButtonChange})),r&&O.createElement(Wr.a,Object(k.__assign)({},r,{calloutHostLayerId:kS.a,onExecute:n.onIndentationComboBoxExecute,styles:x.comboBoxStyles,optionStyles:x.comboBoxOptionsStyles})),u&&O.createElement(or.a,Object(k.__assign)({},u,{styles:x.spinButtonStyles,onExecute:n.onByTextSpinButtonChange})))),!s&&f&&O.createElement("div",{className:CS(),id:f.forId,"aria-labelledby":f.id,role:"group"},O.createElement(jo.a,Object(k.__assign)({},f,{styles:x.labelStyles})),d&&O.createElement(or.a,Object(k.__assign)({},d,{styles:x.spinButtonStyles,onExecute:n.onBeforeSpacingSpinButtonChange})),p&&O.createElement(or.a,Object(k.__assign)({},p,{styles:x.spinButtonStyles,onExecute:n.onAfterSpacingSpinButtonChange})),a&&O.createElement(Wr.a,Object(k.__assign)({},a,{calloutHostLayerId:kS.a,onExecute:n.onLineSpacingComboBoxExecute,styles:x.comboBoxStyles,optionStyles:x.comboBoxOptionsStyles})),h&&O.createElement(or.a,Object(k.__assign)({},h,{styles:x.spinButtonStyles,onExecute:n.onAtSpinButtonChange})),b&&O.createElement(yi.a,Object(k.__assign)({},b,{onExecute:n.onContextualSpacingCheckboxChange})),n.props.paginationRendererFunction&&n.props.paginationRendererFunction()))},n.paragraphDialogResultHandler=function(e){var t=Object(k.__assign)(Object(k.__assign)({},n.state.bodyStateProps),{didChangeSpecialIndentationComboBoxValue:n.didChangeSpecialIndentationComboBoxValue,keepWithNextCheckboxProps:n.props.keepWithNextCheckboxProps,widowOrphanCheckboxProps:n.props.widowOrphanCheckboxProps,keepTogetherCheckboxProps:n.props.keepTogetherCheckboxProps,pageBreakBeforeCheckboxProps:n.props.pageBreakBeforeCheckboxProps});n.baseResultHandler(e||zC.a.Cancel,t)},n.onAlignmentComboBoxExecute=function(e){"string"!=typeof e.newValue&&n.setState((function(t){var n=t.bodyStateProps.alignmentComboBoxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.alignmentComboBoxProps),{selectedKey:e.newValue.key}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{alignmentComboBoxProps:n})}}))},n.getIndentBySpinButtonValue=function(e,t,o){return e.key===n.indentationNoneValue?0:t&&t===n.indentationNoneValue?.5:o},n.onIndentationComboBoxExecute=function(e){n.didChangeSpecialIndentationComboBoxValue=!0,"string"!=typeof e.newValue&&n.setState((function(t){var o=t.bodyStateProps.specialIndentationComboBoxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.specialIndentationComboBoxProps),{selectedKey:e.newValue.key}):void 0,r=t.bodyStateProps.bySpinButtonProps&&t.bodyStateProps.specialIndentationComboBoxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.bySpinButtonProps),{value:n.getIndentBySpinButtonValue(e.newValue,t.bodyStateProps.specialIndentationComboBoxProps.selectedKey,t.bodyStateProps.bySpinButtonProps.value)}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{bySpinButtonProps:r,specialIndentationComboBoxProps:o})}}))},n.onLineSpacingComboBoxExecute=function(e){"string"!=typeof e.newValue&&n.setState((function(t){var n=e.newValue,o=t.bodyStateProps.lineSpacingComboBoxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.lineSpacingComboBoxProps),{selectedKey:n.key}):void 0,r=t.bodyStateProps.atSpinButtonProps?3===n.index?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.atSpinButtonProps),{value:3,reservedValue:void 0}):Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.atSpinButtonProps),{value:n.index,reservedValue:""}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{lineSpacingComboBoxProps:o,atSpinButtonProps:r})}}))},n.onBeforeTextSpinButtonChange=function(e){n.setState((function(t){var n=t.bodyStateProps.beforeTextSpinButtonProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.beforeTextSpinButtonProps),{value:e.value,unitType:e.unitType}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{beforeTextSpinButtonProps:n})}}))},n.onAfterTextSpinButtonChange=function(e){n.setState((function(t){var n=t.bodyStateProps.afterTextSpinButtonProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.afterTextSpinButtonProps),{value:e.value,unitType:e.unitType}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{afterTextSpinButtonProps:n})}}))},n.onByTextSpinButtonChange=function(e){n.setState((function(t){var o=t.bodyStateProps.bySpinButtonProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.bySpinButtonProps),{value:e.value,unitType:e.unitType}):void 0,r=t.bodyStateProps.specialIndentationComboBoxProps&&t.bodyStateProps.specialIndentationComboBoxProps.selectedKey,i=t.bodyStateProps.specialIndentationComboBoxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.specialIndentationComboBoxProps),{selectedKey:e.value>0&&r===n.indentationNoneValue?"1":r}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{bySpinButtonProps:o,specialIndentationComboBoxProps:i})}}))},n.onBeforeSpacingSpinButtonChange=function(e){n.setState((function(t){if(t.bodyStateProps.beforeSpacingSpinButtonProps){var n=e.reservedValue?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.beforeSpacingSpinButtonProps),{reservedValue:e.reservedValue,unitType:e.unitType}):Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.beforeSpacingSpinButtonProps),{value:e.value,unitType:e.unitType,reservedValue:void 0});return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{beforeSpacingSpinButtonProps:n})}}return Object(k.__assign)({},t)}))},n.onAfterSpacingSpinButtonChange=function(e){n.setState((function(t){if(t.bodyStateProps.afterSpacingSpinButtonProps){var n=e.reservedValue?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.afterSpacingSpinButtonProps),{reservedValue:e.reservedValue,unitType:e.unitType}):Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.afterSpacingSpinButtonProps),{value:e.value,unitType:e.unitType,reservedValue:void 0});return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{afterSpacingSpinButtonProps:n})}}return Object(k.__assign)({},t)}))},n.onAtSpinButtonChange=function(e){n.setState((function(t){if(t.bodyStateProps.atSpinButtonProps&&t.bodyStateProps.lineSpacingComboBoxProps){var n="multiple"===t.bodyStateProps.lineSpacingComboBoxProps.selectedKey,o=t.bodyStateProps.lineSpacingComboBoxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.lineSpacingComboBoxProps),{selectedKey:0!==e.value||void 0===e.reservedValue?"multiple":t.bodyStateProps.lineSpacingComboBoxProps.value}):void 0,r=e.reservedValue&&!n?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.atSpinButtonProps),{reservedValue:e.reservedValue}):Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.atSpinButtonProps),{value:e.value,reservedValue:void 0});return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{lineSpacingComboBoxProps:o,atSpinButtonProps:r})}}return Object(k.__assign)({},t)}))},n.onContextualSpacingCheckboxChange=function(e){n.setState((function(t){var n=t.bodyStateProps.contextualSpacingCheckboxProps?Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps.contextualSpacingCheckboxProps),{checked:e.checked}):void 0;return{bodyStateProps:Object(k.__assign)(Object(k.__assign)({},t.bodyStateProps),{contextualSpacingCheckboxProps:n})}}))},n.state={bodyStateProps:t.bodyProps},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.paragraphDialogResultHandler}))},t}(O.PureComponent);var TS=function(){return Object(V.eb)({margin:"0 auto"})},IS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyRendererFunction=function(){var e=t.props.bodyControls.spinnerProps;return O.createElement("div",{className:TS()},O.createElement(ed.a,Object(k.__assign)({},e,{appColors:t.props.appColors,labelPosition:"bottom",customTooltip:Object(Ym.a)().SpinnerFallbackTooltipLabel})))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,maxWidth:400}))},t}(O.PureComponent);var wS=Object(Po.c)((function(){return{containingDivStyles:{width:UC.a},nameInput:{field:["nameInputField"],root:{minHeight:80},subComponentStyles:{label:{root:{fontWeight:V.l.semibold}}}}}})),_S=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.bodyRendererFunction=function(){var e=n.props.bodyProps.nameInputProps,t=e.id,o=e.label,r=e.maxLength,i=wS();return O.createElement("div",{style:i.containingDivStyles},O.createElement(Ya.a,{type:"AppInputProps",id:t,value:n.state.nameValue,autoComplete:"off",spellCheck:!1,label:o,styles:i.nameInput,onChange:n.onInputChange,maxLength:r,errorMessage:n.state.inputError}))},n.onInputChange=function(e){n.props.validateOnChange?n.setState({nameValue:e,inputError:n.getNameValidation(e)}):(n.setState({nameValue:e}),n.state.inputError&&n.setState({inputError:void 0}))},n.renameDialogResultHandler=function(e){var t={};e===zC.a.Ok?n.validateNameInput()&&(t.txtDocumentName=n.state.nameValue,n.baseResultHandler(e,t)):n.baseResultHandler(e,t)},n.validateNameInput=function(){var e=n.getNameValidation(n.state.nameValue);return void 0===e||(n.setState({inputError:e}),!1)},n.getNameValidation=function(e){var t,o;return(null===(o=(t=n.props).getInputErrorIfInvalid)||void 0===o?void 0:o.call(t,e))||void 0},n.state={nameValue:t.bodyProps.nameInputProps.value||"",inputError:void 0},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.actionButtonProps,n=Object(k.__rest)(e,["actionButtonProps"]);return O.createElement(VC.a,Object(k.__assign)({},n,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.renameDialogResultHandler,firstFocusableSelector:"nameInputField",actionButtonProps:Object(k.__assign)(Object(k.__assign)({},t),{disabled:void 0!==this.state.inputError})}))},t.defaultProps={validateOnChange:!0},t}(O.PureComponent);function PS(e){return O.createElement(_S,Object(k.__assign)({},e,{bodyProps:e.bodyControls}))}var RS=Object(Po.c)((function(){return Object(V.eb)({padding:"10px 0",minWidth:360})})),DS=Object(Po.c)((function(){return Object(V.eb)({width:0,height:0})})),jS=Object(Po.c)((function(e){return Object(V.eb)({borderColor:Object(Gc.a)(e).inputBorderColor})})),BS={root:{display:"inline-block",maxWidth:"15em"},label:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},FS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameInitialized=!1,t.bodyRendererFunction=function(){var e=t.props.bodyControls.uploadButtonProps;return O.createElement(Bo.a,null,(function(n){return O.createElement("div",{className:RS()},O.createElement($t.a,Object(k.__assign)({},e,{id:"InsertFileDialogFileInput",type:"AppButtonProps",className:jS(n),ariaDescription:t.props.uploadStatusLabel})),O.createElement(jo.a,{id:"InsertFileDialogFileInputLabel",type:"AppLabelProps",forId:"InsertFileDialogFileInput",label:t.props.uploadStatusLabel||"",styles:BS}),O.createElement("div",{ref:t.setFrameContainerRef,className:DS(),"aria-hidden":"true"}))}))},t.setFrameContainerRef=function(e){var n,o;e&&!t.frameInitialized&&(t.frameInitialized=!0,null===(o=(n=t.props).onFrameReady)||void 0===o||o.call(n,e))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,maxWidth:450}))},t}(O.PureComponent);var LS={controlBorderColor:Yt.a.gray60,controlFocusBorderColor:Yt.a.gray150,controlHoverBackgroundColor:Yt.a.gray20,primaryTextColor:Yt.a.gray180,secondaryTextColor:Yt.a.gray140,controlFocusBackgroundColor:Yt.a.gray20,controlSelectedBackgroundColor:Yt.a.gray30},MS=Object(Po.c)((function(e){if(!Object(Cm.c)())return LS;var t=Object(Gc.a)(e);return{controlBorderColor:t.borderColor,controlFocusBorderColor:e.palette.neutralPrimary,controlHoverBackgroundColor:t.hoverBackgroundColor,primaryTextColor:t.textColor,secondaryTextColor:t.textSecondaryColor,controlFocusBackgroundColor:e.palette.neutralLighterAlt,controlSelectedBackgroundColor:t.selectedBackgroundColor}})),AS={suffix:{backgroundColor:"transparent"}},NS={root:{height:14,width:14}},WS={root:{padding:"0px",marginTop:"16px"}},HS={root:{width:"100%",height:"auto",marginBottom:"2px",paddingLeft:"0px",paddingRight:"8px"},flexContainer:{display:"block",alignItems:"start"}},zS=function(e){var t,n,o,r,i,a,s,l,c,u=MS(e);return{caretDownWrapper:{alignItems:"center",justifyContent:"center",display:"flex",width:"26px",boxSizing:"border-box",cursor:"pointer"},dropdownItemsWrapper:{selectors:{":focus":[Ds.u]}},dropdown:{display:"flex",margin:"0px",padding:"0px",boxSizing:"border-box",alignItems:"center",borderRadius:"2px",borderColor:u.controlBorderColor,borderWidth:"1px",borderStyle:"solid",selectors:(t={},t[V.m]=Object(k.__assign)({color:"ButtonText",borderColor:"buttontext"},Object(V.S)()),t[":hover"]=[{backgroundColor:u.controlHoverBackgroundColor,selectors:(n={},n[V.m]={outline:"2px dashed ButtonText",selectors:(o={},o["svg > path.OfficeIconColors_HighContrast"]={fill:"highlightText"},o)},n)},Ds.t,Ds.o],t[":focus"]=[Ds.t,Ds.o,{borderColor:u.controlFocusBorderColor,selectors:(r={},r[V.m]={outline:"2px dashed ButtonText",selectors:(i={},i["svg > path.OfficeIconColors_HighContrast"]={fill:"highlightText"},i)},r)}],t)},title:{boxSizing:"border-box",display:"block",position:"relative",cursor:"pointer",width:"100%",overflow:"hidden"},callout:{maxHeight:"550px",boxSizing:"border-box"},dropdownItem:{width:"100%",height:"100%",padding:"0px",margin:"0px",border:"1px solid transparent",borderRadius:"0px",selectors:(a={},a[V.m]=Object(k.__assign)({color:"ButtonText"},Object(V.S)()),a[":hover"]=[Ds.t,Ds.o,{color:u.primaryTextColor,backgroundColor:u.controlHoverBackgroundColor}],a[Ds.d]=[Ds.o,{backgroundColor:u.controlHoverBackgroundColor,outline:"none"}],a[Ds.b]=[Ds.o,{borderColor:u.controlFocusBorderColor,outline:"none"}],a[Ds.a]=[Ds.t],a)},dropdownItemSelected:{width:"100%",height:"100%",padding:"0px",margin:"0px",border:"1px solid transparent",borderRadius:"0px",backgroundColor:u.controlSelectedBackgroundColor,selectors:(s={},s[V.m]=Object(k.__assign)({backgroundColor:"Highlight",color:"HighlightText",marginTop:"1px"},Object(V.S)()),s[":hover"]=[Ds.t,Ds.o,{backgroundColor:u.controlHoverBackgroundColor}],s[Ds.d]={outline:"none"},s[Ds.b]=[Ds.o,{borderColor:u.controlFocusBorderColor,outline:"none"}],s[Ds.a]=[Ds.t],s)},root:{selectors:{"[aria-expanded='true']":[Ds.o,Ds.u,{backgroundColor:u.controlSelectedBackgroundColor,selectors:(l={},l[V.m]={selectors:(c={},c["svg > path.OfficeIconColors_HighContrast"]={fill:"highlightText"},c)},l)}]}},label:{fontWeight:V.l.regular,fontSize:V.k.medium}}},VS=function(e){var t,n,o=MS(e);return Object(V.db)({root:{width:"350px",overflow:"hidden"},documentExtension:{fontWeight:V.l.regular,fontSize:V.k.small},label:{whiteSpace:"nowrap",textAlign:"start",overflow:"hidden",textOverflow:"ellipsis",width:"100%",fontSize:16,color:o.primaryTextColor,fontWeight:V.l.regular,selectors:(t={},t[V.m]=Object(k.__assign)({color:"inherit"},Object(V.S)()),t)},description:{whiteSpace:"nowrap",textAlign:"start",overflow:"hidden",textOverflow:"ellipsis",width:"100%",fontSize:12,fontWeight:V.l.regular,color:o.secondaryTextColor,selectors:(n={},n[V.m]=Object(k.__assign)({color:"inherit"},Object(V.S)()),n)},controlWrapper:{display:"flex",overflow:"hidden",padding:"10px 8px 10px 8px",width:"100%"},singleLocationWrapper:{borderRadius:"2px",borderColor:o.controlBorderColor,borderWidth:"1px",borderStyle:"solid"},folderIcon:{display:"flex",alignItems:"center"},textContainer:{overflow:"hidden",paddingLeft:"8px",width:"100%"},dropdownContainer:{marginTop:"16px"},moreLocationsDropdownItem:{padding:"10px 8px 10px 8px"}})},GS=Object(Po.c)((function(e){return{classNames:VS(e),fileNameInput:AS,dropdownStyle:zS(e),locationLabelStyle:WS,singleLocationButton:HS,dropdownIconStyle:NS}})),US=n(1452),qS=function(e){function t(t){var n=e.call(this,t)||this;return n.dropdownBase=O.createRef(),n.onRenderInputSuffix=function(e){return function(){var t=GS(e).classNames;return O.createElement("span",{className:t.documentExtension},n.input.extension)}},n.filenameError=function(e){return e?n.fileNameHasInvalidChars(e)?SaveDialogStrings.InvalidCharacterError:"":SaveDialogStrings.FilenameEmptyError},n.bodyRendererFunction=function(){return O.createElement(Bo.a,null,(function(e){var t=GS(e);return O.createElement("div",{className:t.classNames.root},O.createElement(Ya.a,{type:"AppInputProps",id:"targetFilename",value:n.state.fileName,autoComplete:"off",spellCheck:!1,label:SaveDialogStrings.FilenameLabel,onChange:n.onFileNameChange,maxLength:255,styles:t.fileNameInput,errorMessage:n.filenameError(n.state.fileName),onRenderSuffix:n.isExtensionValid(n.input.extension)?n.onRenderInputSuffix(e):void 0}),1===n.input.saveLocations.length&&n.renderSingleLocation(e,n.input.saveLocations[0]),n.input.saveLocations.length>1&&O.createElement("div",{className:t.classNames.dropdownContainer},O.createElement(US.a,{id:"saveLocations",componentRef:n.dropdownBase,options:n.getDropdownOptions(n.input.saveLocations),onRenderOption:n.onRenderOption(e),onRenderTitle:n.onRenderTitle(e),styles:t.dropdownStyle,onRenderCaretDown:n.onRenderCaretDown(t.dropdownIconStyle),onChange:n.onLocationChange,onClick:n.onDropdownClick,label:SaveDialogStrings.LocationSelectionLabel})))}))},n.onFileNameChange=function(e){n.setState({fileName:e})},n.onMoreLocations=function(){n.executeSaveAs(zC.a.Ok,!0)},n.onLocationChange=function(e,t,o){var r;(null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.isMoreLocations)?n.onMoreLocations():n.setState({selectedIndex:o})},n.onDropdownClick=function(){var e;null===(e=n.dropdownBase.current)||void 0===e||e.focus(!0)},n.currentLocationGetter=function(){if(n.input.saveLocations&&void 0!==n.state.selectedIndex&&n.state.selectedIndex<n.input.saveLocations.length)return n.input.saveLocations[n.state.selectedIndex]},n.executeSaveAs=function(e,t){var o={fileName:n.state.fileName,moreLocationsSelected:!!t,locationCallback:t?void 0:n.currentLocationGetter};Object(go.sendTelemetryEvent)({name:"Office.FileIO.Online.SaveAsDialog",dataFields:[{name:"selectedButton",int64:e},{name:"filenameChanged",bool:n.input.fileName!==n.state.fileName},{name:"scenario",string:n.input.scenario},{name:"locationIndex",int64:n.state.selectedIndex},{name:"locationCount",int64:n.input.saveLocations.length},{name:"allowMoreLocations",bool:n.input.enableMoreLocations},{name:"isMoreLocationSelected",bool:!!t}]}),n.props.resultHandler(e,o)},n.saveAsDialogResultHandler=function(e){n.executeSaveAs(e)},n.input=t.bodyProps.inputPropsCallback(),n.state={fileName:n.input.fileName||"",selectedIndex:n.input.saveLocations.length>0?0:void 0},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.fileNameHasInvalidChars(this.state.fileName),t=void 0;return this.props.actionButtonProps&&(t=Object(k.__assign)(Object(k.__assign)({},this.props.actionButtonProps),{disabled:e})),O.createElement(VC.a,Object(k.__assign)({},this.props,{dialogButtonsOption:zC.b.OkCancel,defaultExecutionButton:zC.a.Ok,actionButtonProps:t,cancelButtonProps:this.props.cancelButtonProps,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.saveAsDialogResultHandler}))},t.prototype.isExtensionValid=function(e){return!!(e&&e.length>1&&"."===e[0])},t.prototype.renderLocation=function(e,t,n){var o=GS(e);return O.createElement(Qe.a,{horizontal:!0,verticalAlign:"end",className:o.classNames.controlWrapper},O.createElement("div",{className:o.classNames.folderIcon},O.createElement(H.a,{iconName:"Close_32","aria-hidden":"true",styles:{root:{width:32,height:32}}})),O.createElement(Qe.a,{horizontalAlign:"start",className:o.classNames.textContainer,id:"locationLabels"},O.createElement("div",{className:o.classNames.label,style:{textAlign:Object(F.a)()?"right":"left"}},t),n&&O.createElement("div",{className:o.classNames.description,style:{textAlign:Object(F.a)()?"right":"left"}},n)))},t.prototype.renderSingleLocation=function(e,t){var n=GS(e),o=Boolean(this.input.enableMoreLocations);return O.createElement(O.Fragment,null,O.createElement(jo.a,{type:"AppLabelProps",label:SaveDialogStrings.LocationSelectionLabel,id:"id",forId:"locationButton",styles:n.locationLabelStyle}),!o&&O.createElement("div",{className:n.classNames.singleLocationWrapper},this.renderLocation(e,t.folderName,t.friendlyPath)),o&&O.createElement(rr.a,{styles:n.singleLocationButton,id:"locationButton","aria-describedby":"locationLabels",onClick:this.onMoreLocations},O.createElement(Qe.a,{horizontal:!0},this.renderLocation(e,t.folderName,t.friendlyPath),O.createElement("div",{className:n.classNames.folderIcon},O.createElement(H.a,{iconName:"CommonControlChevronRight_12","aria-hidden":"true",styles:{root:{width:12,height:16,transform:Object(F.a)()?"rotate(180deg)":"none"}}})))))},t.prototype.onRenderOption=function(e){var t=this;return function(n){var o,r=GS(e);if(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.isMoreLocations)return O.createElement("div",{className:r.classNames.moreLocationsDropdownItem},n.text);var i=n.data&&n.data.path;return t.renderLocation(e,n.text,i)}},t.prototype.onRenderTitle=function(e){var t=this;return function(n){if(n.length>0){var o=n[0];return t.onRenderOption(e)(o)}return O.createElement(O.Fragment,null)}},t.prototype.getDropdownOptions=function(e){if(e){for(var t=new Array(e.length),n=0;n<e.length;n+=1)t[n]={key:n,selected:n===this.state.selectedIndex,text:e[n].folderName,data:{path:e[n].friendlyPath}};return this.input.enableMoreLocations&&t.push({key:e.length,selected:!1,text:SaveDialogStrings.MoreLocations,data:{isMoreLocations:!0}}),t}return[]},t.prototype.onRenderCaretDown=function(e){return function(){return O.createElement(H.a,{iconName:"CommonControlChevronDownGlyph_12",styles:e})}},t.prototype.fileNameHasInvalidChars=function(e){return 0!==(null==e?void 0:e.search(/^[^\/:*?""<>|]+$/))},t}(O.PureComponent);var QS=n(1133),KS=n(209),JS=function(){return Object(V.db)({container:{minWidth:""},messageContainer:{paddingBottom:30},textInputContainer:{padding:"10px 0"}})},ZS=Object(KS.strEnum)(["Irrelevant","Incorrect","Other"]),YS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textareaMaxCharacterLength=500,t.state={justificationChoice:void 0},t.textAreaContent="",t.bodyRendererFunction=function(){var e=t.props.bodyControls,n=e.textAreaProps,o=e.choiceGroupProps,r=t.props,i=r.infoMessage,a=r.justificationIncorrectLabel,s=r.justificationIrrelevantLabel,l=r.justificationOtherLabel,c=JS();return O.createElement("div",{className:c.container},O.createElement("div",{className:c.messageContainer},O.createElement("span",null,i)),O.createElement(QS.a,Object(k.__assign)({},o,{type:"AppChoiceGroupProps",id:"JustificationDialogRadio",label:"",options:[{key:ZS.Irrelevant,text:s||""},{key:ZS.Incorrect,text:a||""},{key:ZS.Other,text:l||""}],onChange:t.onChoiceGroupChange})),O.createElement("div",{className:c.textInputContainer},O.createElement(Ya.a,Object(k.__assign)({},n,{type:"AppInputProps",id:"JustificationDialogTextarea",multiline:!0,resizable:!1,maxLength:t.textareaMaxCharacterLength,disabled:t.state.justificationChoice!==ZS.Other,onChange:t.textAreaContentChanged}))))},t.onChoiceGroupChange=function(e){t.setState({justificationChoice:e.key},t.justificationChanged)},t.textAreaContentChanged=function(e){t.textAreaContent=e,t.justificationChanged()},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction}))},t.prototype.getJustification=function(){var e;switch(this.state.justificationChoice){case ZS.Irrelevant:e=this.props.justificationIrrelevantLabel;break;case ZS.Incorrect:e=this.props.justificationIncorrectLabel;break;case ZS.Other:e=this.textAreaContent}return e||""},t.prototype.justificationChanged=function(){var e,t;null===(t=(e=this.props).onJustificationUpdated)||void 0===t||t.call(e,this.getJustification())},t}(O.PureComponent);var XS=Object(Po.c)((function(e,t){return{padding:0,fontSize:22,color:Object(ym.a)(e,t).primaryTextColor}})),$S=Object(Po.c)((function(e,t){return{padding:"0 0 10px",fontSize:19,color:Object(ym.a)(e,t).primaryTextColor}})),eE=Object(Po.c)((function(e){var t=Object(Cm.c)()?e.palette.neutralLight:qo.a.gray40,n=Object(Cm.c)()?e.palette.neutralSecondary:qo.a.gray120,o=Object(Cm.c)()?e.palette.neutralSecondaryAlt:qo.a.gray110;return Object(V.db)({container:{padding:20},subTitle:{marginBottom:16},infoMessage:{padding:20,backgroundColor:t,border:"1px solid ".concat(n),borderRadius:2,marginBottom:16},optionalExperiencesContainer:{padding:20,border:"1px solid ".concat(o),borderRadius:2,marginBottom:16},optionalExperiencesSubTitle:{margin:"3px 0 10px"},optionalExperiencesCheckbox:{margin:"16px 0"},optionalExperiencesInfoMessage:{padding:20,backgroundColor:t,border:"1px solid ".concat(n),borderRadius:2,marginBottom:16,fontSize:12,display:"flex",alignItems:"center"},infoIcon:{width:24,height:24,marginRight:6}})})),tE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerGroupId="containerGroupId",t.containerGroupLabelledById="containerGroupLabelledById",t.optionalExperiencesGroupId="optionalExperiencesGroupId",t.optionalExperiencesGroupLabeledById="optionalExperiencesGroupLabeledById",t.state={optionalConnectedExperiencesEnabled:t.props.optionalExperiencesCheckboxInitialValue||!1},t.bodyRendererFunction=function(){var e=t.props.bodyControls,n=e.optionalConnectedExperiencesCheckboxProps,o=e.learnMoreLinkProps,r=e.privacyStatementLinkProps,i=t.props,a=i.appColors,s=i.title,l=i.subTitle,c=i.infoMessage,u=i.checkmarkIcon,d=i.optionalExperiencesTitle,p=i.optionalExperiencesSubTitle,h=i.optionalExperiencesInfoMessage,g=i.optionalExperiencesEnabled,m=i.optionalExperiencesInfoMessageIcon;return O.createElement(Bo.a,null,(function(e){var i=eE(e);return O.createElement("div",{className:i.container,role:"group",id:t.containerGroupId,"aria-labelledby":t.containerGroupLabelledById},O.createElement("div",{id:t.containerGroupLabelledById,style:XS(e,a),role:"heading","aria-level":1},s||""),O.createElement("div",{className:i.subTitle},l),O.createElement("div",{className:i.infoMessage},c),g&&O.createElement("div",{className:i.optionalExperiencesContainer,role:"group",id:t.optionalExperiencesGroupId,"aria-labelledby":t.optionalExperiencesGroupLabeledById},O.createElement("div",{id:t.optionalExperiencesGroupLabeledById,style:$S(e,a),role:"heading","aria-label":d||"","aria-level":2},d||""),O.createElement("div",{className:i.optionalExperiencesSubTitle},p),O.createElement(Li.a,Object(k.__assign)({},o,{type:"AppLinkProps",id:"CommercialTrustCenterDialogLearnMore"})),O.createElement("div",{className:i.optionalExperiencesCheckbox},O.createElement(yi.a,Object(k.__assign)({},n,{id:"OptionalConnectedExperiencesDialogCheckbox",type:"AppCheckboxProps",checkmarkIcon:u||"",checked:t.state.optionalConnectedExperiencesEnabled,onExecute:t.onCheckboxChange}))),O.createElement("div",{className:i.optionalExperiencesInfoMessage},O.createElement("div",null,m&&O.createElement(H.a,Object(k.__assign)({className:i.infoIcon,id:"optionalExperiencesInfoMessageIcon",role:"img","aria-label":m.title},m))),O.createElement("div",null,O.createElement("div",null,h),O.createElement(Li.a,Object(k.__assign)({},r,{type:"AppLinkProps",id:"CommercialTrustCenterDialogPrivacyStatement"}))))))}))},t.onCheckboxChange=function(e){var n,o;t.setState({optionalConnectedExperiencesEnabled:e.checked}),null===(o=(n=t.props).onOptionalExperiencesCheckboxChanged)||void 0===o||o.call(n,e.checked)},t.commercialTrustCenterDialogResultHandler=function(e){t.props.resultHandler(e,{optionalExperiencesEnabled:!!t.props.optionalExperiencesEnabled,optionalExperiencesCheckboxChecked:t.state.optionalConnectedExperiencesEnabled})},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.commercialTrustCenterDialogResultHandler,maxWidth:650}))},t}(O.PureComponent);var nE=n(1078),oE={paddingRight:0,paddingLeft:0,width:90},rE=function(){var e;return Object(V.eb)({gridColumn:"2",gridRow:"1","-ms-grid-row":"1","-ms-grid-row-span":"1","-ms-grid-column":"2","-ms-grid-column-span":"1",marginRight:160,selectors:(e={},e["@media only screen and (max-width: 600px)"]={marginRight:0},e)})},iE=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.bodyRendererFunction=function(){var e=n.props.bodyControls,t=e.horizontalDimensionSpinButtonProps,o=e.verticalDimensionSpinButtonProps,r={spinButtonStyles:{root:oE,labelWrapper:{lineHeight:20},label:{fontWeight:V.l.semibold},spinButtonWrapper:{width:90,height:30,paddingBottom:1}},containerStyles:{display:Object(nE.b)()?"-ms-grid":"grid"}};return O.createElement("div",{style:r.containerStyles,className:Object(V.eb)({gridTemplateColumns:"auto auto",gridTemplateRows:"auto",gridColumnGap:"15px"})},O.createElement("div",{className:Object(V.eb)({gridColumn:"1",gridRow:"1",paddingRight:Object(nE.b)()?15:0,float:"left","-ms-grid-row":"1","-ms-grid-column":"1"})},t&&O.createElement(or.a,Object(k.__assign)({},t,{value:n.state.horizontalDimension,labelPosition:tr.a.top,styles:r.spinButtonStyles,onExecute:n.onHorizontalDimensionSpinButtonChange}))),O.createElement("div",{className:rE()},o&&O.createElement(or.a,Object(k.__assign)({},o,{labelPosition:tr.a.top,value:n.state.verticalDimension,styles:r.spinButtonStyles,onExecute:n.onVerticalDimensionSpinButtonChange}))))},n.CustomSizeDialogResultHandler=function(e){n.baseResultHandler(e,{horizontalDimension:n.state.horizontalDimension,verticalDimension:n.state.verticalDimension})},n.onHorizontalDimensionSpinButtonChange=function(e){n.setState({horizontalDimension:e.value})},n.onVerticalDimensionSpinButtonChange=function(e){n.setState({verticalDimension:e.value})},n.state={horizontalDimension:t.bodyControls.horizontalDimensionSpinButtonProps.value,verticalDimension:t.bodyControls.verticalDimensionSpinButtonProps.value},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.CustomSizeDialogResultHandler}))},t}(O.PureComponent);var aE=function(){var e,t,n;return Object(V.db)({container:(e={display:"flex",flexDirection:"column"},e["@media (min-width: 800px)"]={flexDirection:"row"},e),previewPane:(t={maxWidth:450},t["@media (min-width: 800px)"]={paddingBottom:16},t.flex="1 1 450px",t),optionsPane:{flex:"1 0 250px",selectors:(n={},n["@media (min-width: 800px)"]={paddingLeft:50},n)},previewFrame:{border:"none",height:288,width:"100%"},embedPreviewSection:{paddingTop:10},embedCodeSection:{paddingTop:10},embedOptionWrapper:{display:"flex",alignItems:"center"},dimensionsSection:{paddingTop:10,overflowX:"hidden"},interactionSection:{paddingTop:10},appearanceSection:{paddingTop:10},whatToShowSection:{paddingTop:10},viewActualSizeLink:{fontSize:12,textAlign:"right"}})},sE=Object(Po.c)((function(){return{field:{fontSize:12}}})),lE=Object(Po.c)((function(){return{root:{display:"inline-block",width:50,marginLeft:5}}})),cE=Object(Po.c)((function(){return{root:{display:"inline-flex"}}})),uE=Object(Po.c)((function(){return{root:{width:150,marginLeft:28}}})),dE=Object(Po.c)((function(e,t,n){return{root:{padding:"2px 0",color:Object(ym.a)(e,t).primaryTextColor,opacity:n?1:0}}})),pE=Object(Po.c)((function(){return{root:{padding:"2px 0"}}})),hE=Object(Po.c)((function(e){return{root:{padding:0},label:{fontSize:14,fontWeight:V.l.semibold,color:Object(Gc.a)(e).textColor}}})),gE=Object(Po.c)((function(){return{root:{boxSizing:"border-box"},labelWrapper:{height:"unset",minHeight:40,lineHeight:"inherit"},label:{textAlign:"left",width:80,lineHeight:"inherit"}}})),mE=Object(Po.c)((function(e){return{pivot:{root:{marginBottom:20}},pivotHeaders:{wrapper:{height:20},pivotHeader:{root:{fontFamily:"Segoe UI",fontSize:14,lineHeight:20,background:"transparent",textAlign:"center",padding:"0px 0px"}},selectedPivotHeader:{root:{background:"transparent",color:e.palette.black},rootHovered:{background:"transparent",color:e.palette.black}},indicator:{margin:"0px 10%",width:"80%",top:-6,position:"relative",background:e.palette.themePrimary}}}})),fE=n(2194),bE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.embedPreviewContainerGroupId="embedPreviewContainerGroupId",t.embedPreviewContainerGroupLabeledById="embedPreviewContainerGroupLabeledById",t.embedCodeTextAreaId="embedDialogTextarea",t.embedCodeTextAreaPivotItemId="embedDialogTextareaPivotItem",t.embedUrlTextAreaId="embedUrlTextarea",t.embedUrlTextAreaPivotItemId="embedUrlTextareaPivotItem",t.embedCodeContainerGroupLabeledById="embedCodeContainerGroupLabeledById",t.dimensionsContainerGroupId="dimensionsContainerGroupId",t.dimensionsContainerGroupLabeledById="dimensionsContainerGroupLabeledById",t.interactionContainerGroupId="interactionContainerGroupId",t.interactionContainerGroupLabeledById="interactionContainerGroupLabeledById",t.appearanceContainerGroupId="appearanceContainerGroupId",t.appearanceContainerGroupLabeledById="appearanceContainerGroupLabeledById",t.whatToShowContainerGroupId="whatToShowContainerGroupId",t.whatToShowContainerGroupLabeledById="whatToShowContainerGroupLabeledById",t.embedCodeTextAreaRef=null,t.embedURLTextAreaRef=null,t.baseResultHandler=t.props.resultHandler,t.state={embedUrl:t.props.initialEmbedUrl||"",previewUrl:t.props.initialPreviewUrl||"",dimensionsWidth:t.getInitialDimensions().width,dimensionsHeight:t.getInitialDimensions().height,embedUserSettings:t.getInitialUserSettings(),whatToShowUserSettings:t.getInitialWhatToShowSettings(),showCodeCopiedStatus:!1,currentlySelectedPivotId:t.embedCodeTextAreaPivotItemId},t.embedDialogResultHandler=function(e){var n,o,r,i=t.state.currentlySelectedPivotId;e===zC.a.Ok?(t.embedCodeTextAreaRef||t.embedURLTextAreaRef)&&(t.props.showEmbedURL?i===t.embedCodeTextAreaPivotItemId?null===(n=t.embedCodeTextAreaRef)||void 0===n||n.select():null===(o=t.embedURLTextAreaRef)||void 0===o||o.select():null===(r=t.embedCodeTextAreaRef)||void 0===r||r.select(),document.execCommand("copy"),t.setState({showCodeCopiedStatus:!0})):t.baseResultHandler(e)},t.setEmbedCodeTextAreaRef=function(e){t.embedCodeTextAreaRef=e},t.setEmbedURLTextAreaRef=function(e){t.embedURLTextAreaRef=e},t.bodyRendererFunction=function(){var e=t.props,n=e.appColors,o=e.embedPreviewSectionTitle,r=e.codeCopiedText,i=e.viewActualSizeLinkProps,a=aE();return O.createElement(Bo.a,null,(function(e){return O.createElement("div",{className:a.container},O.createElement("div",{className:a.previewPane},O.createElement("div",{className:a.embedPreviewSection,role:"group",id:t.embedPreviewContainerGroupId,"aria-labelledby":t.embedPreviewContainerGroupLabeledById},O.createElement(jo.a,{id:t.embedPreviewContainerGroupLabeledById,type:"AppLabelProps",forId:t.embedPreviewContainerGroupId,styles:hE(e),label:o||""}),i&&O.createElement("div",{className:a.viewActualSizeLink},O.createElement(Li.a,Object(k.__assign)({},i,{type:"AppLinkProps",id:"ViewActualSizeLink"}))),O.createElement(fE.a,{id:"EmbedDialogIFrame",type:"AppIFrameProps",src:t.state.previewUrl,className:a.previewFrame,tabIndex:0})),O.createElement("div",{className:a.embedCodeSection},t.props.showEmbedURL?t.renderEmbedPivot(e):t.renderEmbedCode(e),O.createElement(gm,{type:"AppStatusTextProps",id:"EmbedCodeDisclaimer",label:OfficeCommonStrings.EmbedCodeDisclaimer,styles:pE()}),r&&O.createElement(gm,{type:"AppStatusTextProps",id:"CodeCopiedStatus",label:t.state.showCodeCopiedStatus?r:"",styles:dE(e,n,t.state.showCodeCopiedStatus)}))),O.createElement("div",{className:a.optionsPane},t.renderDimensionsOptions(e,a),t.renderWhatToShowOptions(e,a),t.renderInteractionOptions(e,a),t.renderAppearanceOptions(e,a)))}))},t.getPivotHeaders=function(e){var n=mE(e).pivotHeaders;return[{id:t.embedCodeTextAreaPivotItemId,title:t.props.embedCodeSectionTitle||Object(Ym.a)().EmbedCode,styles:n},{id:t.embedUrlTextAreaPivotItemId,title:t.props.embedUrlSectionTitle||Object(Ym.a)().EmbedURL,styles:n}]},t.onPivotItemClicked=function(e){t.setState({currentlySelectedPivotId:e})},t.getAppSpinButtonProps=Object(Po.c)((function(e,t,n){return{id:e,label:t,type:"AppSpinButtonProps",unitType:"px",validUnits:[{unitType:"px",unitPlaceholder:"{0}",minValue:n,maxValue:1e5,step:1}],numberFormatInfo:{negativeSign:"-",numberDecimalDigits:0,numberDecimalSeparator:".",numberNegativePattern:1,numberGroupSeparator:" ",numberGroupSizes:[3]}}})),t.onDimensionsWidthChange=function(e){t.setState({dimensionsWidth:e.value,showCodeCopiedStatus:!1},t.notifyDimensionsChanged)},t.onDimensionsHeightChange=function(e){t.setState({dimensionsHeight:e.value,showCodeCopiedStatus:!1},t.notifyDimensionsChanged)},t.onDimensionsMultipleChoiceChange=function(e){var n,o,r,i,a,s;t.setState({dimensionsWidth:null!==(r=null===(o=null===(n=t.props.dimensionsOptions)||void 0===n?void 0:n.choices)||void 0===o?void 0:o[parseInt(e.key,10)].width)&&void 0!==r?r:"",dimensionsHeight:null!==(s=null===(a=null===(i=t.props.dimensionsOptions)||void 0===i?void 0:i.choices)||void 0===a?void 0:a[parseInt(e.key,10)].height)&&void 0!==s?s:"",showCodeCopiedStatus:!1},t.notifyDimensionsChanged)},t.onWhatToShowChoiceChange=function(e){var n,o,r,i=null===(n=t.props.whatToShowOptions)||void 0===n?void 0:n.filter((function(t){return t.id===e.key})),a=null==i?void 0:i[0],s=(null==a?void 0:a.textInputProps)&&"";(null===(o=null==a?void 0:a.comboBoxProps)||void 0===o?void 0:o.options[0])&&(s=(null===(r=null==a?void 0:a.comboBoxProps)||void 0===r?void 0:r.options[0]).text);t.setState({whatToShowUserSettings:{selectedId:e.key,textValue:s},showCodeCopiedStatus:!1},t.updateUrlWithNewWhatToShowSetting)},t.notifyDimensionsChanged=function(){var e,n,o=t.state,r=o.dimensionsWidth,i=o.dimensionsHeight;t.isAppSpinValueNumber(i)&&t.isAppSpinValueNumber(r)&&(null===(n=null===(e=t.props.dimensionsOptions)||void 0===e?void 0:e.onDimensionsChange)||void 0===n||n.call(e,r,i))},t.updateUrlWithNewWhatToShowSetting=function(){var e=t.props.whatToShowTransformUrlFunction;if(e){var n=t.state.whatToShowUserSettings,o=n.selectedId,r=n.textValue,i=e(t.state.embedUrl,o,r);if(i!==t.state.embedUrl){var a=e(t.state.previewUrl,o,r);t.setState({embedUrl:i,previewUrl:a,showCodeCopiedStatus:!1})}}},t.getOnEmbedOptionTextChangeFunction=Object(Po.c)((function(e){return function(n){var o;t.setState({embedUserSettings:Object(k.__assign)(Object(k.__assign)({},t.state.embedUserSettings),(o={},o[e]=Object(k.__assign)(Object(k.__assign)({},t.state.embedUserSettings[e]),{textValue:n||""}),o))},t.updateUrlWithNewUserSetting.bind(t,e))}})),t.getOnWhatToShowOptionTextChangeFunction=function(e){t.setState({whatToShowUserSettings:Object(k.__assign)(Object(k.__assign)({},t.state.whatToShowUserSettings),{textValue:e})},t.updateUrlWithNewWhatToShowSetting)},t.getOnWhatToShowOptionComboBoxChangeFunction=function(e){var n="string"==typeof e.newValue?e.newValue:e.newValue.text;t.setState({whatToShowUserSettings:Object(k.__assign)(Object(k.__assign)({},t.state.whatToShowUserSettings),{textValue:n})},t.updateUrlWithNewWhatToShowSetting)},t.getOnEmbedOptionCheckboxChangeFunction=Object(Po.c)((function(e){return function(n){var o;t.setState({embedUserSettings:Object(k.__assign)(Object(k.__assign)({},t.state.embedUserSettings),(o={},o[e]=Object(k.__assign)(Object(k.__assign)({},t.state.embedUserSettings[e]),{checked:n.checked}),o))},t.updateUrlWithNewUserSetting.bind(t,e))}})),t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.embedDialogResultHandler,isWide:!0,focusDefaultButtonWhenOpened:!0,maxWidth:800}))},t.prototype.renderEmbedCode=function(e){return O.createElement(O.Fragment,null,O.createElement(jo.a,{id:this.embedCodeContainerGroupLabeledById,type:"AppLabelProps",forId:this.embedCodeTextAreaId,styles:hE(e),label:this.props.embedCodeSectionTitle||Object(Ym.a)().EmbedCode}),this.renderEmbedCodeInput())},t.prototype.renderEmbedCodeInput=function(){return O.createElement(Ya.a,{ref:this.setEmbedCodeTextAreaRef,type:"AppInputProps",id:this.embedCodeTextAreaId,multiline:!0,resizable:!1,readOnly:!0,value:this.getEmbedCode(),selectTextOnFocus:!0,styles:sE()})},t.prototype.renderEmbedUrlInput=function(){return O.createElement(O.Fragment,null,O.createElement(Ya.a,{ref:this.setEmbedURLTextAreaRef,type:"AppInputProps",id:this.embedUrlTextAreaId,multiline:!0,resizable:!1,readOnly:!0,value:this.props.initialEmbedUrl,selectTextOnFocus:!0,styles:sE()}))},t.prototype.renderEmbedPivot=function(e){var t=this.state.currentlySelectedPivotId,n=mE(e);return O.createElement(O.Fragment,null,O.createElement(kx.a,{styles:n.pivot,overflowMenuLauncherLabel:"",selectedPivotId:t,topLevelItems:this.getPivotHeaders(e),onPivotHeaderExecute:this.onPivotItemClicked,displayTabIndicatorPlaceholder:!0,onPivotHeaderFocus:this.onPivotItemClicked}),t===this.embedCodeTextAreaPivotItemId?this.renderEmbedCodeInput():this.renderEmbedUrlInput())},t.prototype.renderWhatToShowOptions=function(e,t){var n=this,o=this.props,r=o.whatToShowOptions,i=o.whatToShowSectionTitle,a=o.downChevronIcon;return r?O.createElement("div",{className:t.whatToShowSection,role:"group",id:this.whatToShowContainerGroupId,"aria-labelledby":this.whatToShowContainerGroupLabeledById},O.createElement(jo.a,{id:this.whatToShowContainerGroupLabeledById,type:"AppLabelProps",forId:this.whatToShowContainerGroupId,styles:hE(e),label:i||""}),O.createElement(QS.a,{type:"AppChoiceGroupProps",id:"EmbedDialogWhatToShowChoiceGroup",label:"",selectedKey:this.state.whatToShowUserSettings.selectedId,onChange:this.onWhatToShowChoiceChange,options:r.map((function(e){return Object(k.__assign)(Object(k.__assign)({key:e.id,text:e.label},e.textInputProps?{onRenderField:function(o,r){var i=n.state.whatToShowUserSettings.selectedId===e.id;return O.createElement("div",{className:t.embedOptionWrapper},r(o),O.createElement(Ya.a,Object(k.__assign)({},e.textInputProps,{id:"".concat(e.id,"-textinput"),type:"AppInputProps",value:i?n.state.whatToShowUserSettings.textValue:"",onChange:n.getOnWhatToShowOptionTextChangeFunction,resizable:!1,disabled:!i,styles:lE()})))}}:{}),e.comboBoxProps&&e.comboBoxProps.options?{onRenderField:function(t,o){var r=e.comboBoxProps,i=r.id,s=r.options;return O.createElement(O.Fragment,null,o(t),O.createElement(Wr.a,Object(k.__assign)({},e.comboBoxProps,{id:"".concat(i,"-comboBox"),type:"AppComboBoxProps",label:"",allowFreeForm:!1,options:s,defaultSelectedKey:s[0].key,onExecute:n.getOnWhatToShowOptionComboBoxChangeFunction,disabled:n.state.whatToShowUserSettings.selectedId!==e.id,downChevronIcon:a||"",styles:uE()})))}}:{})}))})):null},t.prototype.renderDimensionsOptions=function(e,t){var n,o,r,i,a,s,l=this.props,c=l.incrementButtonIcon,u=l.incrementButtonAriaLabel,d=l.decrementButtonIcon,p=l.decrementButtonAriaLabel,h=l.dimensionsOptions,g=l.dimensionsSectionTitle;return h?O.createElement("div",{className:t.dimensionsSection,role:"group",id:this.dimensionsContainerGroupId,"aria-labelledby":this.dimensionsContainerGroupLabeledById},O.createElement(jo.a,{id:this.dimensionsContainerGroupLabeledById,type:"AppLabelProps",forId:this.dimensionsContainerGroupId,styles:hE(e),label:g||""}),h.isMultipleChoice&&h.choices?O.createElement(QS.a,{type:"AppChoiceGroupProps",id:"EmbedDialogChoiceGroup",label:null!==(n=h.multipleChoiceLabel)&&void 0!==n?n:"",defaultSelectedKey:(null!==(o=h.defaultChoiceIndex)&&void 0!==o?o:0).toString(),options:h.choices.map((function(e,t){return{key:t.toString(),text:"".concat(e.width," x ").concat(e.height)}})),onChange:this.onDimensionsMultipleChoiceChange}):O.createElement(O.Fragment,null,O.createElement(or.a,Object(k.__assign)({},this.getAppSpinButtonProps("EmbedDialogWidthInput",null!==(r=h.widthLabel)&&void 0!==r?r:"",null!==(i=null==h?void 0:h.minWidth)&&void 0!==i?i:0),{value:this.state.dimensionsWidth,onExecute:this.onDimensionsWidthChange,incrementButtonIcon:null!=c?c:"",decrementButtonIcon:null!=d?d:"",incrementAriaLabel:u,decrementAriaLabel:p,styles:gE()})),O.createElement(or.a,Object(k.__assign)({},this.getAppSpinButtonProps("EmbedDialogHeightInput",null!==(a=h.heightLabel)&&void 0!==a?a:"",null!==(s=null==h?void 0:h.minHeight)&&void 0!==s?s:0),{value:this.state.dimensionsHeight,onExecute:this.onDimensionsHeightChange,incrementButtonIcon:null!=c?c:"",decrementButtonIcon:null!=d?d:"",incrementAriaLabel:u,decrementAriaLabel:p,styles:gE()})))):null},t.prototype.renderEmbedOptions=function(e,t){var n,o=this,r=null!==(n=this.props.checkmarkIcon)&&void 0!==n?n:"";return e.map((function(e){var n,i,a=null===(n=o.state.embedUserSettings[e.id])||void 0===n?void 0:n.checked;return O.createElement("div",{key:e.id,className:t.embedOptionWrapper},O.createElement(yi.a,{id:"".concat(e.id,"-checkbox"),styles:cE(),type:"AppCheckboxProps",label:e.checkboxLabel,checkmarkIcon:r,checked:a,onExecute:o.getOnEmbedOptionCheckboxChangeFunction(e.id)}),e.textInputProps&&O.createElement(Ya.a,Object(k.__assign)({},e.textInputProps,{id:"".concat(e.id,"-textinput"),type:"AppInputProps",value:null===(i=o.state.embedUserSettings[e.id])||void 0===i?void 0:i.textValue,onChange:o.getOnEmbedOptionTextChangeFunction(e.id),resizable:!1,disabled:!a,styles:lE()})))}))},t.prototype.renderInteractionOptions=function(e,t){var n=this.props,o=n.interactionOptions,r=n.interactionSectionTitle;return o&&0!==o.length?O.createElement("div",{className:t.interactionSection,role:"group",id:this.interactionContainerGroupId,"aria-labelledby":this.interactionContainerGroupLabeledById},O.createElement(jo.a,{id:this.interactionContainerGroupLabeledById,type:"AppLabelProps",forId:this.interactionContainerGroupId,styles:hE(e),label:r||""}),this.renderEmbedOptions(o,t)):null},t.prototype.renderAppearanceOptions=function(e,t){var n=this.props,o=n.appearanceOptions,r=n.appearanceSectionTitle;return o&&0!==o.length?O.createElement("div",{className:t.appearanceSection,role:"group",id:this.appearanceContainerGroupId,"aria-labelledby":this.appearanceContainerGroupLabeledById},O.createElement(jo.a,{id:this.appearanceContainerGroupLabeledById,type:"AppLabelProps",forId:this.appearanceContainerGroupId,styles:hE(e),label:r||""}),this.renderEmbedOptions(o,t)):null},t.prototype.getInitialDimensions=function(){var e,t,n=this.props.dimensionsOptions;if(n){if(n.isMultipleChoice&&n.choices&&n.defaultChoiceIndex)return n.choices[n.defaultChoiceIndex];if(!n.isMultipleChoice&&n.defaultWidth&&n.defaultHeight)return{width:n.defaultWidth,height:n.defaultHeight}}return{width:null!==(e=null==n?void 0:n.minWidth)&&void 0!==e?e:0,height:null!==(t=null==n?void 0:n.minHeight)&&void 0!==t?t:0}},t.prototype.getInitialUserSettings=function(){var e,t;return(null!==(e=this.props.interactionOptions)&&void 0!==e?e:[]).concat(null!==(t=this.props.appearanceOptions)&&void 0!==t?t:[]).reduce((function(e,t){return e[t.id]={checked:t.checkboxInitialValue},e}),{})},t.prototype.getInitialWhatToShowSettings=function(){var e;return{selectedId:(null===(e=this.props.whatToShowOptions)||void 0===e?void 0:e[0].id)||""}},t.prototype.getEmbedCode=function(){return this.props.getEmbedCode&&this.isAppSpinValueNumber(this.state.dimensionsWidth)&&this.isAppSpinValueNumber(this.state.dimensionsHeight)?this.props.getEmbedCode(this.state.embedUrl,this.state.dimensionsWidth,this.state.dimensionsHeight):""},t.prototype.isAppSpinValueNumber=function(e){return""!==e},t.prototype.getControlSettingsIdMap=function(){var e,t,n={};return null===(e=this.props.interactionOptions)||void 0===e||e.forEach((function(e){n[e.id]=e})),null===(t=this.props.appearanceOptions)||void 0===t||t.forEach((function(e){n[e.id]=e})),n},t.prototype.updateUrlWithNewUserSetting=function(e){var t=this.getControlSettingsIdMap()[e].urlTransformFunctionOnChange;if(t){var n=this.state.embedUserSettings[e],o=n.checked,r=n.textValue,i=t(this.state.embedUrl,e,o,r);if(i!==this.state.embedUrl){var a=t(this.state.previewUrl,e,o,r);this.setState({embedUrl:i,previewUrl:a,showCodeCopiedStatus:!1})}}},t}(O.PureComponent);var vE=function(){return Object(V.db)({container:{minWidth:360},messageContainer:{},textInputContainer:{padding:"10px 0"}})},yE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textareaMaxCharacterLength=256,t.textAreaContent="",t.state={reportErrorChecked:!0},t.bodyRendererFunction=function(){var e=t.props.bodyControls,n=e.textAreaProps,o=e.reportErrorCheckboxProps,r=e.privacyStatementLinkProps,i=t.props,a=i.errorMessage,s=i.errorReportMessage,l=i.errorTextPrompt,c=i.checkmarkIcon,u=vE();return O.createElement("div",{className:u.container},O.createElement("div",{className:u.messageContainer},O.createElement("p",null,a),O.createElement("p",null,s)),n&&O.createElement("div",{className:u.textInputContainer},O.createElement("p",null,l),O.createElement(Ya.a,Object(k.__assign)({},n,{type:"AppInputProps",id:"FileUploadErrorDialogTextarea",multiline:!0,resizable:!1,maxLength:t.textareaMaxCharacterLength,disabled:!t.state.reportErrorChecked,onChange:t.textAreaContentChanged}))),o&&O.createElement(yi.a,Object(k.__assign)({},o,{id:"ReportErrorDialogCheckbox",type:"AppCheckboxProps",checkmarkIcon:c||"",checked:t.state.reportErrorChecked,onExecute:t.onCheckboxChange})),O.createElement(Li.a,Object(k.__assign)({},r,{type:"AppLinkProps",id:"FileUploadErrorDialogPrivacyStatement"})))},t.onCheckboxChange=function(e){t.setState({reportErrorChecked:e.checked})},t.textAreaContentChanged=function(e){t.textAreaContent=e},t.fileUploadErrorDialogResultHandler=function(e){var n={text:t.textAreaContent,reportErrorChecked:t.state.reportErrorChecked};t.props.resultHandler(e,n)},t}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.fileUploadErrorDialogResultHandler}))},t}(O.PureComponent);var xE=n(2205),CE=n(2208),SE=function(e){function t(t){var n,o,r=this;(r=e.call(this,t)||this).baseResultHandler=r.props.resultHandler,r.labelMap={},r.setButtonAction=function(e){var t=r.labelMap[e.id];if(r.setState({currentLabel:t,currentLabelId:e.id}),document){var n=document.getElementById(r.props.bodyProps.labelFlyout.id);n&&n.focus()}},r.flyoutRenderFunction=function(e){return e.controlProps.map((function(t){return"AppToggleButtonProps"===t.type?Object(Ld.a)(t):Object(Md.a)(t.id,t,r.subFlyoutRenderFunction,Object(Hx.a)(),e.onSubMenuPositioned,void 0,void 0,!1,void 0)}))},r.subFlyoutRenderFunction=function(e){return e.controlProps.map((function(e){return Object(Ld.a)(e)}))},r.bodyRendererFunction=function(){var e=r.props.bodyProps.learnMoreLink?O.createElement("span",null,O.createElement(Li.a,Object(k.__assign)({},r.props.bodyProps.learnMoreLink))):O.createElement("span",null);return O.createElement("div",null,O.createElement("p",null," ",r.props.bodyProps.descriptionText," "),e,O.createElement("div",{className:r.props.bodyProps.labelFlyout.id,style:{marginTop:"1em"}},O.createElement(Yr.a,Object(k.__assign)({},r.props.bodyProps.labelFlyout,{controlInMenuRendererFunction:r.flyoutRenderFunction,label:r.state.currentLabel,styles:{root:["MandatoryLabelingDialogFlyoutAnchor"],label:{width:"10em",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},downChevronIcon:Object(Hx.a)().downChevron}))))},r.mandatoryLabellingDialogResultHandler=function(e){var t={selectedLabel:r.state.currentLabelId};r.baseResultHandler(e,t)},r.state={currentLabel:t.bodyProps.initialLabelText,currentLabelId:void 0};var i=null===(n=t.bodyProps.labelFlyout.menuDefinition)||void 0===n?void 0:n.sections[0].controls;if(!i)return r;for(var a=0,s=i;a<s.length;a++){var l=s[a];if(Object(xE.a)(l))r.labelMap[l.id]=l.label,l.onExecute=r.setButtonAction;else if(Object(CE.a)(l)){var c=null===(o=l.menuDefinition)||void 0===o?void 0:o.sections[0].controls;if(c)c.filter((function(e){return Object(xE.a)(e)})).map((function(e){return e})).forEach((function(e){r.labelMap[e.id]=e.label,e.onExecute=r.setButtonAction}))}}return r}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=void 0;return this.props.actionButtonProps&&(e=Object(k.__assign)(Object(k.__assign)({},this.props.actionButtonProps),{disabled:void 0===this.state.currentLabelId})),O.createElement(VC.a,Object(k.__assign)({},this.props,{actionButtonProps:e,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.mandatoryLabellingDialogResultHandler,firstFocusableSelector:"MandatoryLabelingDialogFlyoutAnchor"}))},t}(O.PureComponent);var EE=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.bodyRendererFuction=function(){var e=n.props.conflictInfo.shortcutDisplayInfoArray.map((function(e,t){var n={key:"".concat(t),text:e.actionDescription};return 2===e.ownerType&&(n.text=e.actionDescription+" ("+e.addinName+")"),n}));return O.createElement("div",null,O.createElement(QS.a,{id:"ShortcutChoiceGroup",type:"AppChoiceGroupProps",label:n.props.bodyProps.choiceLabel,options:e,onChange:n.handlePreferenceChange,defaultSelectedKey:"0"}),n.props.bodyProps.preferencesLinkEnabled&&O.createElement("div",{style:{marginTop:15}},O.createElement(Li.a,{id:"ShortcutPreferencesLink",type:"AppLinkProps",text:n.props.bodyProps.preferencesLinkText,handler:null!=n.props.bodyProps.preferencesHelpLinkOnExecute?n.props.bodyProps.preferencesHelpLinkOnExecute:{href:n.props.bodyProps.preferencesLinkHref,target:"_blank"}})))},n.ShortcutsDialogResultHandler=function(e){var t={};e===zC.a.Ok?t.selectedShortcutIndex=n.state.selectedIndex:t.selectedShortcutIndex=-1,n.baseResultHandler(e,t)},n.handlePreferenceChange=function(e){n.setState({selectedIndex:parseInt(e.key,10)})},n.state={selectedIndex:0},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFuction,resultHandler:this.ShortcutsDialogResultHandler}))},t}(O.Component),kE=n(1954),OE=n(202),TE=n(1467),IE={textStyles:{margin:0,display:"inline"},listItemStyles:{listStylePosition:"inside"},textSectionStyles:{boxSizing:"border-box"}},wE=function(e){var t=IE;return Object(V.db)({textStyles:t.textStyles,listItemStyles:t.listItemStyles,textSectionStyles:t.textSectionStyles},e)},_E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.classNames=wE(t.props.customStyles),t.additionalBodyTextContentIndex=0,t.renderAppLink=function(e){return O.createElement(Li.a,Object(k.__assign)({key:Object(OE.a)()},e))},t.interpolateLinksInText=function(e){var n=t.props.links;return n&&t.additionalBodyTextContentIndex<n.length?Object(TE.a)(e,(function(){var e=t.additionalBodyTextContentIndex;return t.additionalBodyTextContentIndex=t.additionalBodyTextContentIndex+1,t.renderAppLink(n[e])})):[e]},t.renderText=function(e){return O.createElement("p",{className:t.classNames.textStyles},t.interpolateLinksInText(e))},t.renderTextList=function(e){return O.createElement("ul",null,e.map((function(e){return O.createElement("li",{key:Object(OE.a)(),className:t.classNames.listItemStyles},t.renderText(e))})))},t.isTextList=function(e){return Array.isArray(e)},t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.textContent;return this.additionalBodyTextContentIndex=0,O.createElement(O.Fragment,null,t.map((function(t){return O.createElement("div",{key:Object(OE.a)(),className:e.classNames.textSectionStyles},e.isTextList(t)?e.renderTextList(t):e.renderText(t))})))},t}(O.PureComponent),PE=function(e,t){var n=Object(Gc.a)(e).textColor;return{standardTextStyles:[{paddingTop:"8px",color:n,boxSizing:"border-box"}],downloadLink:[{paddingTop:"8px",paddingBottom:"8px"}],title:[Object(k.__assign)({paddingBottom:4,color:n},t?{whiteSpace:"pre-line"}:{})],errorReportTitleStyles:[{fontWeight:"bold"}]}},RE=function(e,t){return{textSectionStyles:PE(e,t).standardTextStyles}},DE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dialogContentsId="DialogContents",t.dialogCharacterFixEnabled=Object(dm.a)(t.context,dm.f.dialogCharacterFixEnabled),t.state={permanentDismissCheckboxChecked:!1},t.permanentDismissCheckboxOnExecute=function(){t.props.permanentDismissCheckbox&&t.setState((function(e){return{permanentDismissCheckboxChecked:!e.permanentDismissCheckboxChecked}}),(function(){var e,n;null===(n=null===(e=t.props.permanentDismissCheckbox)||void 0===e?void 0:e.onExecute)||void 0===n||n.call(e,{id:t.props.permanentDismissCheckbox.id,checked:t.state.permanentDismissCheckboxChecked})}))},t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e,t=this,n=(e=this.props).titleText,o=e.additionalBodyTextContent,r=e.messageAreaLink,i=e.downloadLink,a=e.helpLink,s=e.feedbackDescription,l=e.feedbackLink,c=e.sessionId,u=e.permanentDismissCheckbox,d=e.saveErrorReportTitle,p=e.saveErrorReportDescription,h=e.privacyPolicyLink;return O.createElement(td.a,null,O.createElement(Bo.a,null,(function(e){var g=function(e,t){var n=PE(e,t);return Object(V.db)({standardTextStyles:n.standardTextStyles,downloadLink:n.downloadLink,title:n.title,errorReportTitleStyles:n.errorReportTitleStyles})}(e,t.dialogCharacterFixEnabled);return O.createElement(kE.a,Object(k.__assign)({},t.props,{titleText:void 0,focusDefaultButtonWhenOpened:!0,describedById:t.dialogContentsId,isAlert:!0}),O.createElement("div",{id:t.dialogContentsId},O.createElement("div",null,n&&O.createElement("span",{className:g.title,id:"ReactDialogText"},n),o&&O.createElement(_E,Object(k.__assign)({},o,{customStyles:RE(e,t.dialogCharacterFixEnabled)})),r&&O.createElement(Li.a,Object(k.__assign)({},r))),i&&O.createElement("div",{className:g.downloadLink},O.createElement(Li.a,Object(k.__assign)({},i))),a&&O.createElement("div",{className:g.standardTextStyles},O.createElement(Li.a,Object(k.__assign)({},a))),(s||l)&&O.createElement("div",{className:g.standardTextStyles},s&&O.createElement("div",null,s," "),l&&O.createElement(Li.a,Object(k.__assign)({},l,{role:"button"}))),c&&O.createElement("div",{className:g.standardTextStyles},O.createElement("span",null,c)),(d||p||h)&&O.createElement("div",{className:g.standardTextStyles},d&&O.createElement("div",{className:g.errorReportTitleStyles},d),p&&O.createElement("div",null,p),h&&O.createElement("div",{className:g.standardTextStyles},O.createElement(Li.a,Object(k.__assign)({},h)))),u&&O.createElement("div",{className:g.standardTextStyles},O.createElement(yi.a,Object(k.__assign)({},u,{styles:Object(V.db)({root:{padding:"0"}}),checked:t.state.permanentDismissCheckboxChecked,onExecute:t.permanentDismissCheckboxOnExecute})))))})))},t.contextType=Jd.a,t}(O.PureComponent),jE={root:{paddingTop:0,paddingLeft:0,paddingRight:0,paddingBottom:0,width:380}},BE={paddingTop:16},FE={paddingTop:20,display:"flex",justifyContent:"space-between"},LE={paddingTop:5},ME=function(e){function t(t){var n=e.call(this,t)||this;return n.bodyRendererFunction=function(){return O.createElement(Bo.a,null,(function(e){var t=Object(UC.h)(e,n.props.sharedDialogStyles);return n.renderMicrophoneErrorDialog(t)}))},n.onClickHandler=n.onClickHandler.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return void 0!==this.props.microphoneErrorDialogProps?O.createElement(VC.a,Object(k.__assign)({},this.props,{dialogIcon:this.props.dialogIcon,bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.props.resultHandler,dialogButtonsOption:zC.b.None,maxWidth:450})):O.createElement(DE,Object(k.__assign)({},this.props,{type:"StandardDialogProps",resultHandler:this.props.resultHandler,dialogIcon:this.props.dialogIcon,dialogButtonsOption:zC.b.Ok,actionButtonProps:{type:"AppButtonProps",title:this.props.primaryButtonLabel,label:this.props.primaryButtonLabel,id:"closeButton"},titleText:this.props.contentLabel,helpLink:void 0}))},t.prototype.renderMicrophoneErrorDialog=function(e){var t=this.props.microphoneErrorDialogProps,n=t.micPermissionsDialogImageSrc,o=t.micPermissionsDialogImageAltText,r=t.learnMoreLink;return O.createElement("div",null,O.createElement(jo.a,{type:"AppLabelProps",forId:"AppLabelProps",label:this.props.contentLabel,id:"contentLabel",styles:jE}),O.createElement("img",{src:n,style:BE,alt:o}),O.createElement("div",{style:FE},O.createElement("div",{style:LE},O.createElement(Li.a,Object(k.__assign)({},r,{type:"AppLinkProps",id:"learnMoreLink"}))),O.createElement($t.a,{id:"tryAgainButton",label:this.props.primaryButtonLabel,type:"AppButtonProps",onExecute:this.onClickHandler,styles:e.primaryButton})),void 0)},t.prototype.onClickHandler=function(e){this.props.resultHandler(zC.a.Retry)},t.prototype.renderHelpTextDebugLink=function(e){return void 0===e?void 0:O.createElement(Li.a,Object(k.__assign)({},e,{type:"AppLinkProps",id:"helpTextDebugLink"}))},t}(O.PureComponent);var AE=["Permission dismissed","Permission denied","Requested device not found","The request is not allowed by the user agent or the platform in the current context.","Could not start audio source","Device in use","Permission denied by system","Concurrent mic process limit."],NE=["PermissionDeniedError","NotFoundError","NotAllowedError","PermissionDismissedError","NotSupportedError","MediaDeviceNotSupported","DevicesNotFoundError","TrackStartError"];function WE(e){return e&&(e.message&&-1!==AE.indexOf(e.message)||e.name&&-1!==NE.indexOf(e.name)||"OverconstrainedError"===e.name&&"deviceId"===e.constraint)}function HE(e){var t="Exception: ";try{t+=JSON.stringify(e)}catch(e){i.a.sendTraceTag(540947140,a.a.msoulscat_Wac_Dictation,s.a.Error,"ErrorStringFromException error: ".concat(e.message," ").concat(e.stack))}return e&&(e.name&&(t+=", name: "+e.name),e.code&&(t+=", code: "+e.code),e.message&&(t+=", message: "+e.message),e.constraint&&(t+=", constraint: "+e.constraint),e.stack&&(t+=", stack: "+e.stack)),t}function zE(e){return{neutralPrimary:Object(Cm.c)()?e.palette.neutralPrimary:Yt.a.gray160,neutralQuaternary:Object(Cm.c)()?e.palette.neutralQuaternary:Yt.a.gray60}}var VE={paddingBottom:4};function GE(e,t){return{root:{paddingTop:e,paddingLeft:0,paddingRight:0},label:{paddingTop:0,paddingBottom:0,color:zE(t).neutralPrimary}}}var UE={container:{margin:0}},qE={optionText:{whiteSpace:"normal"},root:{height:"100%",width:440,maxWidth:440}},QE={marginTop:6,marginBottom:8,borderSpacing:0,width:"100%",display:"flex",justifyContent:"space-between"};function KE(e){return{root:{paddingTop:8},label:{color:zE(e).neutralPrimary}}}function JE(e,t){return{primaryButton:{root:{backgroundColor:Object(ym.a)(e,t).primaryDefaultBackgroundColor}},title:{color:zE(e).neutralPrimary}}}var ZE={borderSpacing:0},YE={width:20,height:20},XE={width:6,height:16,paddingLeft:8};function $E(e,t,n){var o;return{root:{padding:0,selectors:(o={},o["svg > path[class*='OfficeIconColors_mDictation']"]={fill:e?Object(ym.a)(t,n).textDisabledColorForPrimaryBackground:zE(t).neutralPrimary},o)}}}var ek=function(e){return{root:{padding:0,width:6,height:16,selectors:e}}};function tk(e){var t;return ek(((t={})["svg > rect"]={fill:zE(e).neutralQuaternary},t))}function nk(e,t){var n,o;return ek(((n={})["svg > rect"]={fill:Object(ym.a)(e,t).primaryDefaultBackgroundColor},n[V.m]=((o={})["svg > rect"]={fill:"Highlight"},o),n))}var ok=n(2505),rk=n.n(ok);var ik=function(e){function t(t){var n=e.call(this,t)||this;return n._isMounted=!1,n.state={currentVolume:0,isDisabled:!1,helpText:void 0},n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(e){switch(e.label){case 0:return this._isMounted=!0,[4,this.resetAndRunMicAudioCaptureWithVolumeMeterUpdateLoop()];case 1:return e.sent(),[2]}}))}))},t.prototype.componentWillUnmount=function(){this.cleanup(),this._isMounted=!1},t.prototype.componentDidUpdate=function(e,t){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){switch(t.label){case 0:return e.deviceId===this.props.deviceId?[3,2]:[4,this.resetAndRunMicAudioCaptureWithVolumeMeterUpdateLoop()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement("table",{style:ZE,title:e.state.helpText},O.createElement("tbody",null,O.createElement("tr",null,O.createElement("td",{style:YE},e.getMicIcon(t)),O.createElement("td",null,e.getVolumeBar(t,e.state.currentVolume)))))}))},t.prototype.getMicIcon=function(e){return O.createElement(H.a,{id:"MicIcon",iconName:rk.a.VoicedictationGray_24,theme:e,styles:$E(this.state.isDisabled,e,this.props.appColors)})},t.prototype.getVolumeBar=function(e,t){for(var n=this,o=[],r=0;r<this.props.countPills;r+=1)o.push(r);return O.createElement("table",{style:ZE},O.createElement("tbody",null,O.createElement("tr",null,o.map((function(o){var r=o<t;return O.createElement("td",{key:o,style:XE},O.createElement(H.a,{id:"VolumeBarPill"+o,iconName:r?rk.a.VolumePillBlue:rk.a.VolumePillGray,theme:e,styles:r?nk(e,n.props.appColors):tk(e)}))})))))},t.prototype.cleanup=function(){var e;if(this.timer&&(window.clearInterval(this.timer),this.timer=void 0),this.audioSource){var t=null===(e=this.audioSource.mediaStream)||void 0===e?void 0:e.getAudioTracks();if(t)for(var n=0,o=t;n<o.length;n++){var r=o[n];null==r||r.stop()}this.audioSource.disconnect(),this.audioSource=void 0}},t.prototype.resetAndRunMicAudioCaptureWithVolumeMeterUpdateLoop=function(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,r,l,c,u,d=this;return Object(k.__generator)(this,(function(p){switch(p.label){case 0:if(!this._isMounted)return[2];if(this.cleanup(),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return this.setState({helpText:DictationStrings.UnsupportedBrowserLabel,isDisabled:!0}),[2];if(!this.props.deviceId)return[2];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:this.props.deviceId}}})];case 2:return e=p.sent(),null===(t=window.AudioContext||window.webkitAudioContext)?(this.setState({helpText:DictationStrings.UnsupportedBrowserLabel,isDisabled:!0}),[2]):(n=new t,this.audioSource=n.createMediaStreamSource(e),(o=n.createAnalyser()).fftSize=2048,o.minDecibels=-100,o.maxDecibels=-40,o.smoothingTimeConstant=0,this.audioSource.connect(o),r=new Uint8Array(o.frequencyBinCount),l=Math.abs(o.minDecibels-o.maxDecibels),c=function(){o.getByteFrequencyData(r);var e=0;r.forEach((function(t){e+=t}));var t=e/r.length;t<1?d.setState({currentVolume:0,isDisabled:!1,helpText:DictationStrings.MicrophoneMutedLabel}):d.setState({currentVolume:t/l*d.props.countPills,isDisabled:!1,helpText:""})},this.timer=window.setInterval(c,200),[3,4]);case 3:return u=p.sent(),i.a.sendTraceTag(570766667,a.a.msoulscat_Wac_Dictation,WE(u)?s.a.Info:s.a.Error,"AppMicVolumeBar error: ".concat(u.message," ").concat(u.stack)),this.setState({helpText:DictationStrings.UnsupportedBrowserLabel,isDisabled:!0}),[3,4];case 4:return[2]}}))}))},t}(O.PureComponent),ak=n(2333),sk=function(e){function t(t){var n=e.call(this,t)||this;return n.firstGetUserMediaUpdateDone=!1,n.bodyRendererFunction=function(e){return O.createElement("div",{style:VE},n.getLanguageSettingControl(e),n.getMicrophoneSettingControl(e),n.getMicrophoneVolumeAndHelpLinkControls(),n.getAutoPunctuationSettingControl(e),n.getProfanityFilterSettingControl(e),n.getQuickAccessInterfaceSettingControl(e))},n.onLangugageChange=function(e){n.setState({LanguageState:e.newValue.key})},n.onMicrophoneChange=function(e){n.setState({MicrophoneState:e.newValue.key})},n.onAutoPunctuationChange=function(e,t){n.setState({AutoPunctuationState:t})},n.onProfanityFilterChange=function(e,t){n.setState({ProfanityFilterState:t})},n.onQuickAccessInterfaceChange=function(e,t){n.setState({QuickAccessInterfaceState:t})},n.closeDialogHandler=function(e){e===zC.a.Ok?n.props.resultHandler(e,{LanguageState:n.state.LanguageState,AutoPunctuationState:n.state.AutoPunctuationState,MicrophoneState:n.state.MicrophoneState,ProfanityFilterState:n.state.ProfanityFilterState,QuickAccessInterfaceState:n.state.QuickAccessInterfaceState}):n.props.resultHandler(e)},n.state={LanguageState:t.LanguageState,MicrophoneOptions:[],MicrophoneState:null==t.MicrophoneState?void 0:t.MicrophoneState,MicrophoneControlDisabled:!1,MicrophoneControlErrorTooltip:void 0,AutoPunctuationState:t.AutoPunctuationState,ProfanityFilterState:t.ProfanityFilterState,QuickAccessInterfaceState:t.QuickAccessInterfaceState},n}return Object(k.__extends)(t,e),t.prototype.componentDidMount=function(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(k.__generator)(this,(function(n){switch(n.label){case 0:if(!this.isMicrophoneSettingEnabled())return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.getMicrophoneOptionsAndUpdateState()];case 2:return n.sent(),navigator.mediaDevices.ondevicechange=function(e){return Object(k.__awaiter)(t,void 0,void 0,(function(){return Object(k.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.getMicrophoneOptionsAndUpdateState()];case 1:return e.sent(),[2]}}))}))},[3,4];case 3:return e=n.sent(),i.a.sendTraceTag(544018691,a.a.msoulscat_Wac_Dictation,s.a.Error,"DictationSettingsDialog.componentDidMount error: ".concat(HE(e))),[3,4];case 4:return[3,6];case 5:this.setState({MicrophoneControlDisabled:!0,MicrophoneControlErrorTooltip:DictationStrings.UnsupportedBrowserLabel}),n.label=6;case 6:return[2]}}))}))},t.prototype.componentDidUpdate=function(e,t){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(n){switch(n.label){case 0:return this.firstGetUserMediaUpdateDone&&t.MicrophoneState===this.state.MicrophoneState&&e.MicrophoneState===this.props.MicrophoneState?[3,2]:[4,this.ensureMicPermissionsGetMicrophoneOptionsAndUpdateState(this.state.MicrophoneState)];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.cleanup=function(){if(this.mediaStream){var e=this.mediaStream.getAudioTracks();if(e)for(var t=0,n=e;t<n.length;t++){var o=n[t];null==o||o.stop()}this.mediaStream=void 0}},t.prototype.componentWillUnmount=function(){this.cleanup()},t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(VC.a,Object(k.__assign)({},e.props,{bodyRendererFunction:function(){return e.bodyRendererFunction(t)},resultHandler:e.closeDialogHandler,dialogButtonsOption:zC.b.OkCancel,actionButtonProps:{type:"AppButtonProps",title:DictationStrings.DictationSettingSaveButtonLabel,label:DictationStrings.DictationSettingSaveButtonLabel,id:"saveButtonId"},maxWidth:480,sharedDialogStyles:JE(t,e.props.appColors)}))}))},t.prototype.getLanguageSettingControl=function(e){return this.getSettingWithLabelAndComboBox(DictationStrings.DictationSettingsLanguage,"languageSettingLabel",function(e){return GE(16,e)}(e),"languageSettingControl",this.state.LanguageState,this.getLanguageOptions(),this.onLangugageChange,Y.a.topCenter)},t.prototype.isMicrophoneSettingEnabled=function(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.getUserMedia)},t.prototype.getMicrophoneSettingControl=function(e){return this.getSettingWithLabelAndComboBox(DictationStrings.MicrophoneLabel,"microphoneSettingLabel",function(e){return GE(18,e)}(e),"microphoneSettingControl",this.state.MicrophoneState,this.state.MicrophoneOptions,this.onMicrophoneChange,void 0,this.state.MicrophoneControlDisabled,this.state.MicrophoneControlErrorTooltip)},t.prototype.getMicrophoneVolumeAndHelpLinkControls=function(){return O.createElement("div",{style:QE},O.createElement("div",null,O.createElement(ik,{deviceId:this.state.MicrophoneState,countPills:10,appColors:this.props.appColors})),O.createElement("div",{"aria-label":this.props.MicProblemsLink.text},O.createElement(Li.a,Object(k.__assign)({},this.props.MicProblemsLink))))},t.prototype.getAutoPunctuationSettingControl=function(e){return this.getSettingToggle("autoPunctuationSettingControl",this.state.AutoPunctuationState,this.onAutoPunctuationChange,DictationStrings.DictationSettingsAutoPunctuation,e)},t.prototype.getProfanityFilterSettingControl=function(e){return this.getSettingToggle("profanityFilterSettingControl",this.state.ProfanityFilterState,this.onProfanityFilterChange,DictationStrings.DictationSettingsProfanityFilter,e)},t.prototype.getQuickAccessInterfaceSettingControl=function(e){return Object(eC.j)()?this.getSettingToggle("quickAccessInterfaceSettingControl",this.state.QuickAccessInterfaceState,this.onQuickAccessInterfaceChange,"Show Dictation quick access interface",e):void 0},t.prototype.getSettingWithLabelAndComboBox=function(e,t,n,o,r,i,a,s,l,c){return void 0===s&&(s=void 0),void 0===l&&(l=!1),void 0===c&&(c=void 0),O.createElement("div",null,this.getSettingLabel(o,e,t,n),O.createElement(Wr.a,{id:o,type:"AppComboBoxProps",label:e,width:440,styles:UE,allowFreeForm:!1,selectedKey:r,downChevronIcon:Object(Hx.a)().downChevron.icon12,options:i,onExecute:a,disabled:l,customTooltip:c,tooltipDirection:s,optionStyles:qE}))},t.prototype.getSettingLabel=function(e,t,n,o){return O.createElement(jo.a,{type:"AppLabelProps",forId:e,label:t,id:n,styles:o})},t.prototype.getSettingToggle=function(e,t,n,o,r){return O.createElement(ak.a,{type:"AppToggleProps",id:e,label:o,inlineLabel:!0,checked:t,onChange:n,appColors:this.props.appColors,ariaLabel:o,styles:KE(r)})},t.prototype.ensureMicPermissionsGetMicrophoneOptionsAndUpdateState=function(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:if(!this.isMicrophoneSettingEnabled())return[2];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:e}}})];case 2:return t=o.sent(),this.mediaStream!==t&&(this.cleanup(),this.mediaStream=t),this.firstGetUserMediaUpdateDone=!0,[4,this.getMicrophoneOptionsAndUpdateState()];case 3:return o.sent(),[3,5];case 4:return n=o.sent(),i.a.sendTraceTag(562157331,a.a.msoulscat_Wac_Dictation,WE(n)?s.a.Info:s.a.Error,"ensureMicPermissionsGetMicrophoneOptionsAndUpdateState error: ".concat(HE(n))),[3,5];case 5:return[2]}}))}))},t.prototype.getMicrophoneOptionsAndUpdateState=function(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(k.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,this.getMicrophoneOptions()];case 1:return e=o.sent(),this.setState({MicrophoneOptions:e}),e.length>0?((t=this.getSelectedMicKeyFromOptions(e))!==this.state.MicrophoneState&&this.setState({MicrophoneState:t}),this.firstGetUserMediaUpdateDone?[3,3]:[4,this.ensureMicPermissionsGetMicrophoneOptionsAndUpdateState(t)]):[3,3];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:return n=o.sent(),i.a.sendTraceTag(562157332,a.a.msoulscat_Wac_Dictation,s.a.Error,"getMicrophoneOptionsAndUpdateState error: ".concat(HE(n))),[3,5];case 5:return[2]}}))}))},t.prototype.getSelectedMicKeyFromOptions=function(e){if(!this.state.MicrophoneState)return e[0].key;for(var t=!1,n=0;n<e.length;n+=1)if(e[n].key===this.state.MicrophoneState){t=!0;break}return t?this.state.MicrophoneState:e[0].key},t.prototype.getMicrophoneOptions=function(){return Object(k.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o;return Object(k.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=[],[4,navigator.mediaDevices.enumerateDevices()];case 1:return t=r.sent(),n=new Map,t.forEach((function(t){"audioinput"!==t.kind||"default"===t.deviceId||"communications"===t.deviceId||n.has(t.groupId)||(e.push({type:"AppComboBoxItem",key:t.deviceId,text:t.label}),n.set(t.groupId,"added"))})),e.length<=0?this.setState({MicrophoneControlDisabled:!0,MicrophoneControlErrorTooltip:DictationStrings.NoMicrophoneDetectedLabel}):this.setState({MicrophoneControlDisabled:!1,MicrophoneControlErrorTooltip:void 0}),[2,e];case 2:return o=r.sent(),this.setState({MicrophoneControlDisabled:!0,MicrophoneControlErrorTooltip:DictationStrings.UnsupportedBrowserLabel}),[2,Promise.reject("getMicrophoneOptions error: ".concat(HE(o)))];case 3:return[2]}}))}))},t.prototype.isPrivatePreviewLanguagesEnabled=function(){return!(!this.props.PrivatePreviewSupportLanguages||!this.props.PrivatePreviewLanguagesHeader)&&this.props.PrivatePreviewSupportLanguages.length>0},t.prototype.getLanguageOptions=function(){var e=[];return this.props.ProductionSupportLanguages.forEach((function(t){e.push({type:"AppComboBoxItem",key:t.Tag,text:t.Name})})),e.push({type:"AppComboBoxDivider",key:"divider"}),e.push({type:"AppComboBoxHeader",key:"previewLanguagesHeader",text:this.props.PreviewLanguagesHeader}),this.props.PreviewSupportLanguages.forEach((function(t){e.push({type:"AppComboBoxItem",key:t.Tag,text:t.Name})})),this.isPrivatePreviewLanguagesEnabled()&&(e.push({type:"AppComboBoxDivider",key:"divider"}),e.push({type:"AppComboBoxHeader",key:"privatePreviewLanguagesHeader",text:this.props.PrivatePreviewLanguagesHeader}),this.props.PrivatePreviewSupportLanguages.forEach((function(t){e.push({type:"AppComboBoxItem",key:t.Tag,text:t.Name})}))),e},t}(O.PureComponent);var lk=function(e){function t(t){var n=e.call(this,t)||this;n.resultHandler=function(e){var t={selectedOption:n.state.selectedOption};n.props.resultHandler(e,t)},n.bodyRendererFunction=function(){var e=n.props.bodyProps.dialogChoiceGroupProps;return O.createElement(QS.a,Object(k.__assign)({},e,{onChange:n.onChoiceGroupChange}))},n.onChoiceGroupChange=function(e){n.setState({selectedOption:e.key})};var o=t.bodyProps.dialogChoiceGroupProps;return n.state={selectedOption:o.defaultSelectedKey||""},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.resultHandler}))},t}(O.Component);var ck=Object(Po.c)((function(e){var t=Object(Gc.a)(e),n=Object(Cm.c)()?e.palette.neutralDark:Yt.a.gray180;return{sectionContainer:{padding:"0 10px"},sectionTitle:{root:{padding:0},label:{fontSize:V.k.large,fontWeight:V.l.semibold,color:t.textColor}},settingsCheckbox:{root:{padding:0,marginTop:"10px"},checkbox:{borderColor:n},text:{color:t.textColor}}}})),uk=function(e){function t(t){var n=e.call(this,t)||this;return n.tooltipPersistenceGroupId="tooltipPersistenceGroup",n.tooltipPersistenceGroupLabelId="tooltipPersistenceGroupLabel",n.textSelectionGroupId="textSelectionGroup",n.textSelectionGroupLabelId="textSelectionGroupLabel",n.bodyRendererFunction=function(e){var t=ck(e),o=function(e){var t=Object(Gc.a)(e);return Object(V.db)({sectionDescription:{color:t.textColor}})}(e);return function(){return O.createElement("div",null,O.createElement("div",{role:"group",id:n.tooltipPersistenceGroupId,"aria-labelledby":n.tooltipPersistenceGroupLabelId,style:t.sectionContainer},O.createElement(jo.a,{id:n.tooltipPersistenceGroupLabelId,type:"AppLabelProps",forId:n.tooltipPersistenceGroupId,label:AccessibilitySettingsDialogStrings.TooltipPersistenceTitle,styles:t.sectionTitle}),O.createElement("div",{className:o.sectionDescription},AccessibilitySettingsDialogStrings.TooltipPersistenceDescription),O.createElement(yi.a,{type:"AppCheckboxProps",id:"tooltipPersistenceCheckbox",label:AccessibilitySettingsDialogStrings.EnableTooltipPersistence,checkmarkIcon:n.props.checkmarkIcon||"",checked:n.state.tooltipPersistenceEnabled,onExecute:n.onCheckboxChange,styles:t.settingsCheckbox})),O.createElement("div",{role:"group",id:n.textSelectionGroupId,"aria-labelledby":n.textSelectionGroupLabelId,style:t.sectionContainer},O.createElement(jo.a,{id:n.textSelectionGroupLabelId,type:"AppLabelProps",forId:n.textSelectionGroupId,label:AccessibilitySettingsDialogStrings.AccessibleTextSelectionTitle,styles:t.sectionTitle}),O.createElement("div",{className:o.sectionDescription},AccessibilitySettingsDialogStrings.AccessibleTextSelectionDescription),O.createElement(yi.a,{type:"AppCheckboxProps",id:"textSelectionHighlightCheckbox",label:AccessibilitySettingsDialogStrings.EnableTextSelectionHighlight,checkmarkIcon:n.props.checkmarkIcon||"",checked:n.state.textSelectionChangeEnabled,onExecute:n.onTextSelectionCheckboxChange,styles:t.settingsCheckbox})))}},n.onCheckboxChange=function(){n.setState({tooltipPersistenceEnabled:!n.state.tooltipPersistenceEnabled})},n.onTextSelectionCheckboxChange=function(){n.setState({textSelectionChangeEnabled:!n.state.textSelectionChangeEnabled})},n.resultHandler=function(e){n.previousTextSelectionValue!==n.state.textSelectionChangeEnabled&&i.a.sendTraceTag(508864476,a.a.msoulscat_Wac_Telemetry,s.a.Info,"User Modified Text Selection Highlight setting. New value: ".concat(n.state.textSelectionChangeEnabled)),n.props.resultHandler(e,{tooltipPersistenceEnabled:n.state.tooltipPersistenceEnabled,textSelectionChangeEnabled:n.state.textSelectionChangeEnabled})},n.previousTextSelectionValue=t.bodyControls.textSelectionChangeEnabled,n.state={tooltipPersistenceEnabled:t.bodyControls.tooltipPersistenceEnabled,textSelectionChangeEnabled:t.bodyControls.textSelectionChangeEnabled},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(VC.a,Object(k.__assign)({},e.props,{headerText:AccessibilitySettingsDialogStrings.AccessibilitySettingsDialogTitle,bodyRendererFunction:e.bodyRendererFunction(t),resultHandler:e.resultHandler}))}))},t}(O.PureComponent);var dk=Object(Po.c)((function(){return{containingDivStyles:{width:UC.a},input:{field:["nameInputField"],root:{"input[type=text]":{paddingLeft:"2px",paddingRight:"2px"},textarea:{paddingLeft:"2px",paddingRight:"2px"}},subComponentStyles:{label:{root:{fontWeight:V.l.semibold}}}}}})),pk=function(e){function t(t){var n=e.call(this,t)||this;return n.bodyRendererFunction=function(){var e=dk();return O.createElement("div",{style:e.containingDivStyles},!n.state.hideTitleField&&O.createElement(Ya.a,{id:"AltTextDialog-Title",type:"AppInputProps",value:n.state.titleText,maxLength:100,autoComplete:"off",spellCheck:!1,label:Object(Ym.a)().Title,styles:e.input,onChange:n.onTitleInputChange}),O.createElement(Ya.a,{id:"AltTextDialog-Description",type:"AppInputProps",value:n.state.descriptionText,multiline:!0,autoComplete:"off",spellCheck:!1,label:Object(Ym.a)().Description,styles:e.input,onChange:n.onDescriptionInputChange}))},n.onTitleInputChange=function(e){n.setState({titleText:null!=e?e:""})},n.onDescriptionInputChange=function(e){n.setState({descriptionText:null!=e?e:""})},n.altTextDialogResultHandler=function(e){var t={};e===zC.a.Ok&&(t.titleText=n.state.titleText,t.descriptionText=n.state.descriptionText),n.props.resultHandler(e,t)},n.state={titleText:t.bodyControls.titleText||"",descriptionText:t.bodyControls.descriptionText||"",hideTitleField:t.bodyControls.hideTitleField||!1},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.altTextDialogResultHandler}))},t}(O.Component);function hk(e){return O.createElement(pk,Object(k.__assign)({},e))}var gk=Object(Po.c)((function(e){var t=Object(Gc.a)(e);return{sectionTitleRibbonLayout:{root:{padding:0},label:{fontWeight:V.l.semibold,color:t.textColor}},sectionTitleShowRibbon:{root:{paddingTop:14},label:{fontWeight:V.l.semibold,color:t.textColor}}}})),mk=function(){return Object(V.db)({container:{padding:"0 10px"}})},fk=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={RibbonLayoutChoice:t.props.bodyControls.ribbonLayoutChoice,ShowRibbonChoice:t.props.bodyControls.showRibbonChoice},t.bodyRendererFunction=function(e){var n=gk(e),o=mk(),r=t.getRibbonLayoutOptions(),i=t.getShyRibbonOptions();return function(){return O.createElement("div",{className:o.container},O.createElement(QS.a,{type:"AppChoiceGroupProps",id:"RibbonLayoutRadio",label:OfficeCommonStrings.RibbonModeSectionTitle,styles:n.sectionTitleRibbonLayout,options:r,selectedKey:t.state.RibbonLayoutChoice,onChange:t.onChoiceGroupRibbonLayoutChange}),O.createElement(QS.a,{type:"AppChoiceGroupProps",id:"ShowRibbonRadio",label:OfficeCommonStrings.ShyRibbonSectionTitle,styles:n.sectionTitleShowRibbon,options:i,selectedKey:t.state.ShowRibbonChoice,onChange:t.onChoiceGroupShowRibbonChange}))}},t.getRibbonLayoutOptions=Object(Po.c)((function(){return[{key:"ClassicRibbon",text:OfficeCommonStrings.ClassicRibbon},{key:"SingleLineRibbon",text:OfficeCommonStrings.ToggleRibbonControl}]})),t.getShyRibbonOptions=Object(Po.c)((function(){return[{key:"AlwaysShow",text:OfficeCommonStrings.AlwaysShow},{key:"AutomaticallyHide",text:OfficeCommonStrings.HideRibbonLabel}]})),t.onChoiceGroupRibbonLayoutChange=function(e){t.setState({RibbonLayoutChoice:e.key})},t.onChoiceGroupShowRibbonChange=function(e){t.setState({ShowRibbonChoice:e.key})},t.resultHandler=function(e){t.props.resultHandler(e,{ribbonLayoutChoice:t.state.RibbonLayoutChoice,showRibbonChoice:t.state.ShowRibbonChoice})},t}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){return O.createElement(VC.a,Object(k.__assign)({},e.props,{headerText:OfficeCommonStrings.RibbonOptionsTooltip,bodyRendererFunction:e.bodyRendererFunction(t),resultHandler:e.resultHandler}))}))},t}(O.PureComponent);var bk=Object(Po.c)((function(e){return Object(V.eb)({display:"flex",justifyContent:e?"left":"right"})})),vk=Object(Po.c)((function(e,t){return Object(V.eb)({visibility:e&&t?"visible":"hidden",height:e&&t?"auto":"0px"})})),yk=Object(V.eb)({display:"flex",flexDirection:"column"}),xk=Object(V.eb)({paddingBottom:"16px"}),Ck=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{id:"sharedAuthFrameInnerContainer",className:bk(this.props.rtl),ref:this.props.frameRef})},t}(O.PureComponent),Sk=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.frame=n.props.bodyControls.createFrame(),n.ref=function(e){return e&&e.appendChild(n.frame)},n.bodyRendererFunction=function(){var e=n.props.sharedDialogStyles,t=n.props.bodyControls,o=t.promptMessage,r=t.frameLoaded,i=t.frameLoadSuccess,a=t.rtl,s=t.resolveDialogStyles;return O.createElement(Bo.a,null,(function(t){return n.dialogStyles||(n.dialogStyles=Object(UC.h)(t,e),s(n.dialogStyles)),O.createElement("div",{id:"sharedAuthDialogContainer",className:yk},!r&&O.createElement(ed.a,{id:"frameLoadingAppSpinner",type:"AppSpinnerProps",appColors:n.props.appColors,label:Object(Ym.a)().SpinnerFallbackTooltipLabel}),r&&i&&O.createElement("div",{id:"promptMessageContainer",className:xk,"aria-hidden":!!n.state.ariaHidePrompt||void 0},o),O.createElement("section",{id:"sharedAuthFrameOuterContainer",className:vk(r,i),tabIndex:r&&i?0:-1,onFocus:function(){return n.setState({ariaHidePrompt:!0})}},O.createElement(Ck,{frameRef:n.ref,rtl:a})))}))},n.sharedAuthConsentDialogResultHandler=function(e){n.baseResultHandler(e)},n.state={},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.bodyControls,t=e.errorText,n=e.frameLoaded,o=e.frameLoadSuccess;return n&&!o?O.createElement(DE,Object(k.__assign)({},this.props,{type:"StandardDialogProps",dialogButtonsOption:this.props.dialogButtonsOption,titleText:t})):O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.sharedAuthConsentDialogResultHandler}))},t.prototype.componentDidUpdate=function(){var e=this.props.bodyControls,t=e.frameLoaded,n=e.frameLoadSuccess;if(t&&!n){var o=document.getElementById("DialogCancelButton");null==o||o.focus()}},t}(O.PureComponent);var Ek={display:"flex",marginTop:"8px",padding:"0 0 0 0"},kk=function(e){var t;return Object(V.eb)({paddingTop:"0px",paddingBottom:"12px",paddingRight:"100px",width:"250px",selectors:(t={},t["@media only screen and (max-width: 500px)"]={maxWidth:"300px",flexWrap:"wrap"},t)},e)},Ok=Object(Po.c)((function(){return{spinButtonStyles:{root:Ek,labelWrapper:{flex:1,float:"none",height:"24px",maxWidth:"128px"},label:{lineHeight:"20px"},spinButtonWrapper:{flex:1,height:"24px",maxWidth:"100px"}}}})),Tk=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.bodyRendererFunction=function(){var e=n.props.bodyProps,t=e.columnsSpinButtonProps,o=e.rowsSpinButtonProps,r=Ok();return O.createElement("div",{className:kk()},t&&O.createElement(or.a,Object(k.__assign)({},t,{value:n.state.columns,styles:r.spinButtonStyles,onExecute:n.onColumnsSpinButtonChange})),o&&O.createElement(or.a,Object(k.__assign)({},o,{value:n.state.rows,styles:r.spinButtonStyles,onExecute:n.onRowsSpinButtonChange})))},n.tableSizeDialogResultHandler=function(e){var t={rows:n.state.rows,columns:n.state.columns};n.baseResultHandler(e||zC.a.Cancel,t)},n.onColumnsSpinButtonChange=function(e){n.setState({columns:e.value})},n.onRowsSpinButtonChange=function(e){n.setState({rows:e.value})},n.state={columns:n.props.bodyProps.columnsSpinButtonProps.value,rows:n.props.bodyProps.rowsSpinButtonProps.value},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.tableSizeDialogResultHandler}))},t}(O.PureComponent);var Ik={root:{background:"transparent",border:"none",minWidth:"16px",padding:0}},wk=n(2344),_k=n(2310),Pk=n(626),Rk=n(447),Dk=n(1949),jk=function(e){function t(t){var n=e.call(this,t)||this;return n.baseResultHandler=n.props.resultHandler,n.bodyRendererFunction=function(){var e=Object(V.db)({container:{minWidth:360},messageContainer:{paddingBottom:30},peoplePicker:{padding:"10px 0"},permissions:{padding:"10px 0"},addReq:{padding:"20px 0 0 0"}});return O.createElement("div",{className:e.container},O.createElement("div",{className:e.messageContainer},O.createElement("p",null,"Add users you'd like to give permissions to this document.")),O.createElement("div",{className:e.peoplePicker},O.createElement("p",null,"People picker place holder"," ")),O.createElement("div",{className:e.permissions},O.createElement(Bk,{toggleId:"expirationToggle",label:"Add expiration date",icon:"Info",toolTip:"Toggle to pick a date.",handler:n.stateHandler,calendarShow:n.state.expirationToggled}),O.createElement(Bk,{toggleId:"copyContentToggle",label:"Allow users with read access to copy content",icon:"Info",toolTip:"This allows users with read access to copy content from this document.",handler:n.stateHandler}),O.createElement(Bk,{toggleId:"accessProgrammaticallyToggle",label:"Allow access to content programmatically",icon:"Info",toolTip:"This allows users access the content from this document programmatically.",handler:n.stateHandler}),O.createElement("div",{className:e.addReq},O.createElement(D.a,{disabled:!n.state.additionalPermissionReqToggled,value:n.state.referrer,onChange:n.onTextFieldChanged}),O.createElement(Bk,{toggleId:"additionalPermissionReqToggle",label:"Users can request additional permissions from anyone specified above.",icon:"Info",toolTip:"This allows users to request additional permissions than the ones that have already been granted from a specified email address.",handler:n.stateHandler})),O.createElement(Bk,{toggleId:"connectVerifyPermissionToggle",label:"Require a connection to verify a user's permission",icon:"Info",toolTip:"This requires a connection to authenticate the permissions of a user.",handler:n.stateHandler})))},n.onTextFieldChanged=function(e,t){n.setState({referrer:t||""})},n.userDefinedPermissionsDialogResultHandler=function(e){var t={copyContentToggled:n.state.copyContentToggled,accessProgrammaticallyToggled:n.state.accessProgrammaticallyToggled,additionalPermissionReqToggled:n.state.additionalPermissionReqToggled,connectVerifyPermissionToggled:n.state.connectVerifyPermissionToggled,dateSelected:n.state.dateSelected,currentValue:n.state.referrer};n.baseResultHandler(e,t)},n.stateHandler=n.stateHandler.bind(n),n.state={expirationToggled:!1,copyContentToggled:!1,accessProgrammaticallyToggled:!1,additionalPermissionReqToggled:!1,connectVerifyPermissionToggled:!1,dateSelected:void 0,referrer:""},n}return Object(k.__extends)(t,e),t.prototype.stateHandler=function(e,t){"expirationToggle"===e&&t?this.setState({dateSelected:t}):"expirationToggle"===e?this.setState({expirationToggled:!this.state.expirationToggled}):"copyContentToggle"===e?this.setState({copyContentToggled:!this.state.copyContentToggled}):"accessProgrammaticallyToggle"===e?this.setState({accessProgrammaticallyToggled:!this.state.accessProgrammaticallyToggled}):"additionalPermissionReqToggle"===e?this.setState({additionalPermissionReqToggled:!this.state.additionalPermissionReqToggled}):"connectVerifyPermissionToggle"===e&&this.setState({connectVerifyPermissionToggled:!this.state.connectVerifyPermissionToggled})},t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.userDefinedPermissionsDialogResultHandler}))},t}(O.PureComponent),Bk=function(e){var t,n=O.useState(!1),o=n[0],r=n[1],i=Object(Rk.a)("tooltipId"),a=e.toolTip,s=O.createElement(Z.a,{content:o?a:void 0,id:i},O.createElement(rn.a,{"aria-label":"more info","aria-describedby":o?i:void 0,onClick:function(){r(!o)},styles:Ik,iconProps:{iconName:e.icon}}));return"expirationToggle"===e.toggleId&&(t=O.createElement(Fk,{enabled:e.calendarShow,handler:e.handler})),O.createElement(wk.a,{label:O.createElement("div",null,t,e.label," ",s),onText:"On",offText:"Off",onChange:function(){e.handler(e.toggleId)}})},Fk=function(e){var t=O.useState(),n=t[0],o=t[1],r=Object(Dk.a)(!1),i=r[0],a=r[1],s=a.toggle,l=a.setFalse,c=O.useRef(null);return O.createElement("div",null,O.createElement("div",{ref:c,hidden:!e.enabled},O.createElement("p",{hidden:!e.enabled},"This document expires on: ",e.enabled?(null==n?void 0:n.toLocaleString().match("^[^,]+"))||"":void 0),O.createElement(Ba.a,{disabled:!e.enabled,onClick:e.enabled?s:l,iconProps:{iconName:"Calendar"}})),i&&O.createElement(wn.a,{isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:c,directionalHint:Y.a.bottomLeftEdge,onDismiss:l,setInitialFocus:!0},O.createElement(Gy.a,{isClickableOutsideFocusTrap:!1},O.createElement(_k.a,{onSelectDate:function(t,n){t&&(o(t),e.handler("expirationToggle",t),l())},onDismiss:l,isMonthPickerVisible:!0,value:n,highlightCurrentMonth:!0,isDayPickerVisible:!0,showGoToToday:!0,strings:Pk.b}))))};var Lk={pinBehaviorIsEnabled:!1,dialogFooterButtonPositionIsEnabled:Object(eC.i)(),pinnedDialogLeftOffset:void 0};function Mk(e,t,n){switch(e){case"ColorPickerDialog":return function(e){return O.createElement(GC,Object(k.__assign)({},e))}(t);case"CopyPasteInstallDialog":return function(e){return O.createElement(eS,Object(k.__assign)({},e))}(t);case"CopyPasteNoClipboardAccessDialog":return function(e){return O.createElement(XC,Object(k.__assign)({},e))}(t);case"CopyPasteShortcutDialog":return function(e){return O.createElement(tS,Object(k.__assign)({},e))}(t);case"CustomSizeDialog":return function(e){return O.createElement(iE,Object(k.__assign)({},e))}(t);case"DictationErrorDialog":return function(e){return O.createElement(ME,Object(k.__assign)({},e))}(t);case"DictationSettingsDialog":return function(e,t){return O.createElement(sk,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"EmbedDialog":return function(e,t){return O.createElement(bE,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"FileUploadErrorDialog":return function(e,t){return O.createElement(yE,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"InsertLinkDialog":return function(e){return O.createElement(uS,Object(k.__assign)({},e))}(t);case"InsertFileDialog":return function(e,t){return O.createElement(FS,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"JustificationDialog":return function(e,t){return O.createElement(YS,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"CommercialTrustCenterDialog":return function(e,t){return O.createElement(tE,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"MandatoryLabellingDialog":return function(e){return O.createElement(SE,Object(k.__assign)({},e,{bodyProps:e.bodyControls}))}(t);case"OICErrorDialog":return function(e){return O.createElement(dS,Object(k.__assign)({},e))}(t);case"OICErrorDialogWithDownload":return function(e){return O.createElement(pS,Object(k.__assign)({},e))}(t);case"OICErrorDialogWithTrial":return function(e){return O.createElement(hS,Object(k.__assign)({},e))}(t);case"OptionsDialog":return function(e){return O.createElement(lk,Object(k.__assign)({},e,{bodyProps:e.bodyControls}))}(t);case"ParagraphDialog":return function(e){return O.createElement(OS,Object(k.__assign)({},e))}(t);case"ProgressDialog":return function(e,t){return O.createElement(IS,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"RenameDialog":return PS(t);case"SaveAsDialog":return function(e){return O.createElement(qS,Object(k.__assign)({},e,{bodyProps:e.bodyControls}))}(t);case"SharedAuthConsentDialog":return function(e,t){return O.createElement(Sk,Object(k.__assign)({},e,{appColors:t}))}(t,n);case"ShortcutConflictResolutionDialog":return function(e){return O.createElement(EE,Object(k.__assign)({},e,{bodyProps:e.bodyControls,conflictInfo:e.conflictInfo}))}(t);case"UserDefinedPermissionsDialog":return function(e){return O.createElement(jk,Object(k.__assign)({},e))}(t);case"AccessibilitySettingsDialog":return i.a.sendTraceTag(508650442,a.a.msoulscat_Wac_Telemetry,s.a.Info,"User opened the AccessibilitySettingsDialog"),function(e){return O.createElement(uk,Object(k.__assign)({},e))}(t);case"RibbonSettingsDialog":return function(e){return O.createElement(fk,Object(k.__assign)({},e))}(t);case"AltTextDialog":return hk(t);case"InsertTableDialog":case"SplitTableCellsDialog":return function(e){return O.createElement(Tk,Object(k.__assign)({},e))}(t);default:return Object(Yb.a)(e)}}var Ak,Nk,Wk,Hk=n(2419),zk=n(1624);!function(e){e[e.Password=0]="Password",e[e.Text=1]="Text"}(Ak||(Ak={})),function(e){e[e.Default=0]="Default",e[e.Invalid=1]="Invalid",e[e.Error=2]="Error",e[e.Loading=3]="Loading"}(Nk||(Nk={})),function(e){e[e.Nil=0]="Nil",e[e.IncorrectPassword=1]="IncorrectPassword",e[e.AttemptThresholdExceeded=2]="AttemptThresholdExceeded",e[e.VerifyPasswordRequestFailure=3]="VerifyPasswordRequestFailure"}(Wk||(Wk={}));var Vk=function(e){function t(t){var n=e.call(this,t)||this;return n.bodyRendererFunction=function(){var e=Object(Hk.c)(),t=n.props.bodyControls,o=t.description,r=t.placeholderText;return O.createElement("div",{style:e.bodyContainer},O.createElement("div",{style:e.bodyItemContainer},O.createElement(jo.a,{id:"PasswordInputDescription",type:"AppLabelProps",label:o,forId:"PasswordInput",styles:e.label})),O.createElement("div",{style:e.bodyItemContainer},O.createElement(Ya.a,{type:"AppInputProps",id:"PasswordInput",disabled:n.state.mode===Nk.Loading||n.state.mode===Nk.Error&&n.state.errorMode===Wk.AttemptThresholdExceeded,placeholder:r,autoComplete:"off",spellCheck:!1,maxLength:255,onChange:n.inputChanged,inputType:n.state.inputMode===Ak.Text?"text":"password",value:n.password,onRenderSuffix:n.state.mode===Nk.Loading?n.renderSpinner:n.renderEyeButton,errorMessage:n.state.mode===Nk.Error?n.errorMessageMapping.get(n.state.errorMode):void 0,styles:e.input})),n.props.bodyControls.additionalBodyContent&&O.createElement("div",{style:e.bodyItemContainer},O.createElement(_E,Object(k.__assign)({},n.props.bodyControls.additionalBodyContent))))},n.renderEyeButton=function(){var e=n.state.inputMode===Ak.Password?n.props.bodyControls.passwordShowEyeIconAriaLabel:n.props.bodyControls.passwordHideEyeIconAriaLabel,t=Object(zk.a)().CommonControlEyeOpen_16;return O.createElement(Bo.a,null,(function(o){return O.createElement(td.a,{appColors:n.props.appColors},O.createElement($t.a,{type:"AppButtonProps",id:"PasswordToggle",disabled:n.state.mode===Nk.Loading||n.state.mode===Nk.Error&&n.state.errorMode===Wk.AttemptThresholdExceeded,label:e,hideLabel:!0,ariaDescription:e,icon:t,onExecute:n.eyeButtonClickHandler,onKeyDown:n.eyeButtonKeyEventHandler,onMouseDown:n.eyeMouseKeyDownEventHandler,takeFocusOnClick:!0,styles:Object(Hk.a)(n.state.inputMode===Ak.Text,n.state.mode===Nk.Loading||n.state.mode===Nk.Error&&n.state.errorMode===Wk.AttemptThresholdExceeded,n.props.appColors,o)}))}))},n.renderSpinner=function(){return O.createElement("div",{style:Object(Hk.b)()},O.createElement(ed.a,{type:"AppSpinnerProps",id:"PasswordSpinner",spinnerSize:al.a.small,appColors:n.props.appColors}))},n.inputChanged=function(e){n.password=e,n.setState({mode:n.isInputValid(e)?Nk.Default:Nk.Invalid,errorMode:Wk.Nil})},n.isInputValid=function(e){return void 0!==e&&0!==e.length},n.eyeButtonClickHandler=function(){n.setState((function(e){return{inputMode:e.inputMode===Ak.Text?Ak.Password:Ak.Text}}))},n.eyeButtonKeyEventHandler=function(e){e.stopPropagation()},n.eyeMouseKeyDownEventHandler=function(e){e.stopPropagation()},n.passwordDialogResultHandler=function(e){e===zC.a.Ok&&void 0!==n.password?(n.setState({mode:Nk.Loading}),n.props.bodyControls.verifyPasswordAction(n.password,n.setPasswordDialogResult)):n.props.resultHandler(e)},n.setPasswordDialogResult=function(e){e===Wk.Nil?n.props.resultHandler(zC.a.Ok):n.setState({mode:Nk.Error,errorMode:e})},n.state={mode:void 0!==t.bodyControls.errorMode&&t.bodyControls.errorMode!==Wk.Nil?Nk.Error:Nk.Invalid,inputMode:Ak.Password,errorMode:t.bodyControls.errorMode?t.bodyControls.errorMode:Wk.Nil},n.errorMessageMapping=new Map([[Wk.IncorrectPassword,t.bodyControls.incorrectPasswordErrorMessage],[Wk.AttemptThresholdExceeded,t.bodyControls.attemptThresholdExceededErrorMessage],[Wk.VerifyPasswordRequestFailure,t.bodyControls.verifyPasswordRequestFailureErrorMessage]]),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(VC.a,Object(k.__assign)({},this.props,{bodyRendererFunction:this.bodyRendererFunction,resultHandler:this.passwordDialogResultHandler,actionButtonProps:Object(k.__assign)(Object(k.__assign)({},this.props.actionButtonProps),{disabled:this.state.mode===Nk.Loading||this.state.mode===Nk.Invalid||this.state.mode===Nk.Error})}))},t}(O.PureComponent);var Gk=n(1223),Uk=n(1310),qk=n(1301),Qk=n(1311),Kk=n(1312),Jk=n(1220),Zk=n(1313),Yk=n(1298),Xk=n(1325),$k=n(1302),eO=n(1314),tO=n(1315),nO=n(1316),oO=n(1224),rO=n(1300),iO=n(1303),aO=n(1317),sO=n(1304),lO=n(1225),cO=n(1318),uO=n(1320),dO=n(1226),pO=n(1227),hO=n(1319),gO=n(1305),mO=n(1228),fO=n(1321),bO=n(1322),vO=n(1323),yO=n(1309),xO=n(1327),CO=n(1328),SO=n(1329),EO=n(1324),kO=n(1330),OO=n(1297),TO=n(806),IO=n(1326),wO=n(1331),_O=n(246),PO=n(426);function RO(e){for(var t in e)"object"==typeof e[t]?RO(e[t]):e[t]=_O.utils.decodeHtml(e[t]);return e}function DO(e,t){Object(yt.isChangeGateEnabled)("OfficeVSO:8365361_IsSharedCustomDialogInvestigationEnabled")&&i.a.sendTraceTag(508078243,a.a.msoulscat_ES_EWAJS,s.a.Info,"ShowExcelDialog dialogId: ".concat(e,", dialogType: ").concat(t.type));var n=t.dialogIcon?Object(Gk.a)(t.dialogIcon):void 0,o=Object(Gk.b)(),r=Object(Gk.c)();switch(t.type){case"StandardDialogProps":var l=function(e){return RO(e)}(Object(k.__assign)({},t));return function(e,t){var n=e.permanentDismissCheckbox?Object(k.__assign)(Object(k.__assign)({},e.permanentDismissCheckbox),{checkmarkIcon:t}):void 0;return O.createElement(DE,Object(k.__assign)({},e,{permanentDismissCheckbox:n}))}(Object(k.__assign)(Object(k.__assign)({},l),{icon:n,closeIconProps:o,msLogoProps:Gk.f,dragOptions:r,settings:Lk}),ir.a.checkboxCheckmark);case"CustomDialogProps":n=n||t.icon;var c={},u=(l=function(e){return e.bodyControls=RO(e.bodyControls),e}(Object(k.__assign)({},t)),Object(k.__assign)(Object(k.__assign)({},l),{icon:n,closeIconProps:o,msLogoProps:Gk.f,dragOptions:r,settings:Lk}));switch(e){case"ChangeLocaleDialog":return Object(Uk.a)(u);case"ChangeSourceDialog":return Object(qk.a)(u);case"ChartEditDataDialog":return Object(Qk.a)(u);case"ChartEditTitleDialog":return Object(Kk.a)(u);case"ClipboardReadPermissionAskDialog":return Object(Jk.b)(u);case"CommercialTrustCenterDialog":c={checkmarkIcon:ir.a.checkboxCheckmark,optionalExperiencesInfoMessageIcon:Object(Gk.a)(zC.c.Info)};break;case"CoauthInfraStatisticsDialog":return Object(Zk.b)(u);case"CustomSortDialog":return Object(Yk.b)(u);case"CreateTableDialog":return Object(Xk.b)(u);case"DataValidationEditDialog":return Object($k.b)(u);case"DataValidationErrorDialog":return Object(eO.a)(u);case"ExcelLiveWelcomeDialog":return Object(tO.b)(u);case"FindAndReplaceDialog":return Object(nO.b)(u);case"FunctionDialog":return Object(oO.a)(u);case"FunctionArgumentsDialog":return Object(rO.a)(u);case"FunctionSignatureDialog":return Object(iO.a)(u);case"FormatAsTableDialog":return Object(Xk.b)(u);case"GotoDialog":return Object(aO.a)(u);case"GridDensityOptionsDialog":return Object(sO.a)(u);case"GroupOrUngroupCellsDialog":return Object(lO.a)(u);case"HyperLinkDialog":return Object(cO.b)(u);case"KeyboardShortcutsDialog":return Object(uO.a)(u,Object(f.a)());case"InsertCopiedCutCellsDialog":return Object(dO.a)(u);case"InsertDeleteCellsDialog":return Object(pO.a)(u,Object(f.a)());case"InsertSlicerDialog":return Object(hO.b)(u);case"KeyboardShortcutsDialog":return Object(uO.a)(u,Object(f.a)());case"PasswordDialog":return function(e,t){return O.createElement(Vk,Object(k.__assign)({},e,{appColors:t}))}(u,Object(f.a)());case"PresentModeWelcomeDialog":return Object(gO.b)(u);case"PowerQueryFlowDialog":return Object(mO.a)(u);case"RenameSheetDialog":return PS(u);case"ReorderSheetDialog":return Object(fO.b)(u);case"ResizeHeadersDialog":return Object(bO.a)(u);case"ResizeTableDialog":return Object(vO.b)(u,Object(f.a)());case"AltTextDialog":return Object(yt.isChangeGateEnabled)("OfficeVSO:8221342_ReactAltTextDialog")?hk(u):Object(yO.b)(u);case"TableAltTextDialog":return Object(yO.b)(u);case"UnHideSheetDialog":return Object(xO.b)(u);case"WorkbookStatisticsDialog":return Object(CO.b)(u);case"PageLoadStatsDialog":return Object(SO.b)(u);case"AccessibilitySettingsDialog":c={checkmarkIcon:ir.a.checkboxCheckmark};break;case"SetDefaultPasteDialog":return Object(EO.a)(u);case"WACSessionIdDialog":return Object(kO.a)(u);case"ExcelCopilotStart":return Object(OO.a)(u);case"SuggestionSettingsDialog":return Object(TO.b)(u);case"TimerBasedRedirectDialog":return Object(IO.b)(u);case"UserIntentDialog":return Object(wO.a)(u)}return Mk(e,Object(k.__assign)(Object(k.__assign)({},u),c),Object(f.a)());default:return Object(Yb.a)(t)}}function jO(e,t){return Object(yt.isChangeGateEnabled)("OfficeVSO:7858550_RemovingExcelThemeProvider")?O.createElement(CC.a,null,DO(e,t)):O.createElement(CC.a,null,O.createElement(PO.a,null,DO(e,t)))}var BO={initialize:function(e){Object(kS.d)(e,jO,Object(Gk.d)())},show:kS.e,hide:kS.c,update:kS.f,dispose:kS.b};function FO(e,t){if(void 0===e&&(e={}),null===e)return{};switch(t.type){case dr.j:var n=Object(k.__assign)({},e);return t.payload.models.forEach((function(e){return n[e.id]=e})),n;default:return e}}function LO(e,t){if(void 0===e&&(e=[]),null==e)return[];switch(t.type){case dr.bb:return t.payload.activeGroups;default:return e}}var MO=n(2404);function AO(e,t){if(void 0===e&&(e={}),null===e)return{};switch(t.type){case dr.gb:return{flyoutAnchorId:t.payload.flyoutAnchorId};default:return e}}function NO(e,t){if(void 0===e&&(e={}),null===e)return{};switch(t.type){case dr.ib:return Object(k.__assign)(Object(k.__assign)({},e),t.payload.contextualUILayoutModel);case dr.I:return e.floatieLayout?Object(k.__assign)(Object(k.__assign)({},e),{floatieLayout:void 0}):e;case dr.H:return e.contextMenuLayout?Object(k.__assign)(Object(k.__assign)({},e),{contextMenuLayout:void 0}):e;case dr.hb:return Object(k.__assign)(Object(k.__assign)({},e),{contextMenusToShadowRender:t.payload.contextMenusToShadowRender});case dr.W:return Object(k.__assign)(Object(k.__assign)({},e),{contextMenuLayout:Object(k.__assign)(Object(k.__assign)({},e.contextMenuLayout),{target:t.payload.target}),floatieLayout:Object(k.__assign)(Object(k.__assign)({},e.floatieLayout),{target:t.payload.target})});default:return e}}function WO(e,t){dy.b.register("floatieGroupModels",FO),dy.b.register("activeFloatieGroups",LO),Object(MO.f)(),dy.b.register("contextMenuModel",AO),dy.b.register("contextualUILayoutModel",NO),t(e)}var HO=n(2282),zO=n(366),VO=n(2195),GO=n(44),UO=function(e){return e.contextMenuModel.flyoutAnchorId},qO=function(e){return!!e.contextualUILayoutModel.contextMenuLayout},QO=Object(xr.a)([UO,Cr.U,Cr.u,Cr.bb],(function(e,t,n,o){var r=e&&Object(Cr.v)(t,n,e);if(r&&"FlyoutAnchorModel"===r.type&&r.menuModel&&!r.hidden)return XO(r.menuModel,t,n,o)})),KO=Object(xr.a)([Cr.U,Cr.u,Cr.bb,Cr.vb,Cr.E],(function(e,t,n,o,r){var i,a,s=r[GO.a.ZeroTermContextMenu];return o&&o.queryText&&""!==o.queryText&&o.menuModel?$O(o.menuModel,e,t,n,ti.a.SearchResult,null===(a=null===(i=null==s?void 0:s.menuModel)||void 0===i?void 0:i.menuTargetDescriptor)||void 0===a?void 0:a.menuTargetType):s&&s.menuModel&&!s.disabled?$O(s.menuModel,e,t,n,ti.a.ZeroTermMenu):void 0})),JO=Object(xr.a)([Cr.U,Cr.u,Cr.bb,function(e){return e.contextualUILayoutModel.contextMenusToShadowRender}],(function(e,t,n,o){var r=new Map;if(o)return o.forEach((function(o){var i=o&&Object(Cr.v)(e,t,o);i&&"FlyoutAnchorModel"===i.type&&i.menuModel?r.set(o,XO(i.menuModel,e,t,n)):r.set(o,void 0)})),r})),ZO=Object(xr.a)([Cr.E],(function(e){return!!e[GO.a.ZeroTermContextMenu]})),YO=Object(xr.a)([UO,Cr.U,Cr.u,Cr.E],(function(e,t,n,o){var r=e&&Object(Cr.v)(t,n,e),i=o[GO.a.ZeroTermContextMenu];return r&&"FlyoutAnchorModel"===r.type&&r.menuModel&&r.hidden&&i?ti.a.ZeroTermMenu:ti.a.StandardContextMenu})),XO=Object(VO.a)((function(e,t,n,o){return Object(zO.a)(e,t,n,o)})),$O=Object(VO.a)((function(e,t,n,o,r,i){var a,s=Object(zO.a)(e,t,n,o,void 0,void 0,void 0,!0);return Object(k.__assign)(Object(k.__assign)({},s),{menuTargetType:null!==(a=s.menuTargetType)&&void 0!==a?a:i,contextualUILocation:r})})),eT=n(461),tT=n(446),nT=n(2303),oT=function(e){return!!e&&!!e.sections&&e.sections.some((function(e){return e.controls&&e.controls.length>0}))},rT=function(e){return oT(e)&&(null==e?void 0:e.contextualUILocation)||ti.a.StandardContextMenu},iT=function(e,t){var n,o=void 0;return(null===(n=e.searchableContextualMenuProps)||void 0===n?void 0:n.menuDefinition)?o=e.searchableContextualMenuProps.menuDefinition:e.menuDefinition&&(o=e.menuDefinition),aT(t,o)},aT=function(e,t){var n,o;if(!t)return[];for(var r=[],i=0,a=t.sections;i<a.length;i++)for(var s=a[i],l=0,c=s.controls;l<c.length;l++){var u=c[l],d={commandId:u.id,location:e};s.data&&s.data.itemsMetadata&&s.data.itemsMetadata[u.id]&&(d.source=null===(n=s.data.itemsMetadata[u.id])||void 0===n?void 0:n.source,d.confidenceScore=null===(o=s.data.itemsMetadata[u.id])||void 0===o?void 0:o.confidenceScore),r.push(d)}return r};function sT(e){if(!e)return[];for(var t=[],n=0,o=e.sections;n<o.length;n++)for(var r=0,i=o[n].controls;r<i.length;r++){var a=i[r];t.push(a.id)}return t}function lT(e){return e?e.map((function(e){return e.id})):[]}function cT(e){var t=[];switch(e.type){case"MultiRowFloatieGroup":var n=e;t.push.apply(t,lT(n.topControlsRow)),t.push.apply(t,lT(n.bottomControlsRow));break;case"SingleRowFloatieGroup":var o=e;t.push.apply(t,lT(o.controls));break;case"SingleControlFloatieGroup":var r=e;r.control&&t.push(r.control.id)}return t}var uT="",dT="",pT=function(e,t,n){var o=t||GO.a.ContextMenu;Object(tT.c)(o,"FlyoutAnchorModel",e)({id:o,location:ti.b.ContextMenu,isShadowRendering:n})},hT=Object(nT.a)("ContextualUIPopulate",(function(e,t,n){pT(e,t,n)})),gT=Object(nT.a)("ContextMenuPopulate",(function(e,t,n){pT(e,t,n)})),mT=Object(nT.a)("ContextMenuDispatch",(function(e,t){e(Object(HO.h)(t))})),fT=Object(nT.a)("ContextualUIDispatch",(function(e,t){e(Object(HO.h)(t))})),bT=Object(nT.a)("FloatieDispatch",(function(e,t){e(Object(HO.h)(t))})),vT=Object(nT.a)("RepostiionContextualUI",(function(e,t){e(Object(HO.d)(t))}));var yT=function(e){return!!e&&void 0===!e.x};var xT=n(2028),CT=n(1114),ST=n(2671),ET=n(1398),kT=n(1477),OT=n(2275),TT=n(1111),IT=n(1482),wT=n(669),_T=n(1488),PT=n(2207),RT=function(e){for(var t=0,n=e;n;){var o=parseInt(window.getComputedStyle(n).zIndex,10);if(o){t=o;break}n=n.parentElement}return t},DT=n(270),jT=n(956),BT=n(964),FT=n(1979),LT=n(647),MT=n(2330),AT=n(345),NT=n(460),WT=Object(Po.c)((function(e){return{width:"260px",display:"flex",flexDirection:e?"column-reverse":"column"}})),HT=Object(Po.c)((function(e,t){var n=Object(Gc.a)(e),o={margin:"1px",selectors:{".ms-Button":Object(k.__assign)(Object(k.__assign)({},Ds.i),{borderRadius:"4px",selectors:{":after":{display:"none"},":focus":Object(k.__assign)(Object(k.__assign)({},Ds.t),{border:"1px solid ".concat(n.focusedBorderColor)}),":hover":Object(k.__assign)({},Ds.t)}}),i:{width:"20px",height:"20px",selectors:{svg:Object(k.__assign)({},Object(Ds.B)())}}}};return{root:{margin:t?"4px 12px 6px 12px":"6px 12px 4px 12px",height:"30px",borderRadius:"4px",padding:"0px 0px 0px 8px",borderColor:qo.a.gray50,selectors:{":hover":Object(k.__assign)(Object(k.__assign)({},Ds.t),{borderColor:qo.a.gray50,borderRadius:"4px"}),":after":Object(k.__assign)(Object(k.__assign)({},Ds.t),{border:"1px solid ".concat(n.focusedBorderColor),borderRadius:"4px"})}},iconContainer:{display:"none"},clearButton:o}})),zT=Object(Po.c)((function(e,t){var n,o=Object(Gc.a)(e),r={selectors:(n={"button span":{textOverflow:"ellipsis",overflow:"hidden"}},n["li:first-child li:first-child"]=t?{backgroundColor:o.toggledBackgroundColor,outline:"1px solid ".concat(o.inputBorderColor),outlineOffset:"-1px"}:void 0,n['li div[data-automation-type="RibbonComboBox"]']={width:"100%",selectors:{"> div:first-child":{maxWidth:"66%"},i:{flexShrink:0},"i + .textContainer":{overflow:"hidden"},".textContainer":{selectors:{label:{textOverflow:"ellipsis",overflow:"hidden",lineHeight:"normal"}}}}},n)};return Object(V.eb)(r)})),VT=n(2676),GT=function(e){function t(t){var n=e.call(this,t)||this;return n.resultsWrapperId="resultsWrapper",n.menuRegion=O.createRef(),n.onSearchChanged=n.onSearchChanged.bind(n),n.onEscape=n.onEscape.bind(n),n.onSearchExecuted=n.onSearchExecuted.bind(n),n.onClick=n.onClick.bind(n),n.onSearchBoxFocus=n.onSearchBoxFocus.bind(n),n.onSearchBoxBlur=n.onSearchBoxBlur.bind(n),n.state={query:""},n}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(Bo.a,null,(function(t){var n,o;return O.createElement("div",{role:"search",style:WT(e.props.searchBoxOnTheBottom)},(null===(o=(n=e.context).isExperimentalFeatureEnabled)||void 0===o?void 0:o.call(n,"Microsoft.Office.SharedOnline.AsyncReactUITiming"))?O.createElement(VT.a,{elementTimingId:"context-menu",hidden:e.props.hidden,interactivityTrackerContext:e.props.menuId}):null,e.renderSearchBox(t),O.createElement("div",{ref:e.menuRegion,role:"menu",id:e.resultsWrapperId,"aria-label":e.props.appStrings.searchableMenuRegionLabel,className:zT(t,!!e.state.searchBoxFocused&&e.isSearchResult())},e.renderSearchResults()))}))},t.prototype.componentDidMount=function(){this.props.hidden||this.onMenuOpen()},t.prototype.componentWillUnmount=function(){this.props.hidden||this.onMenuClosed()},t.prototype.componentDidUpdate=function(e){!this.props.hidden&&e.hidden?this.onMenuOpen():this.props.hidden&&!e.hidden&&this.onMenuClosed()},t.prototype.renderSearchBox=function(e){return O.createElement(fc.a,{"data-no-horizontal-wrap":"false",type:"text",ariaLabel:this.props.appStrings.searchLabel,"aria-controls":this.resultsWrapperId,id:this.props.searchBoxId,clearButtonProps:{ariaLabel:this.props.appStrings.clearSearch,iconProps:{iconName:this.props.appIcons.closeIcon}},iconProps:{iconName:""},styles:HT(e,this.props.searchBoxOnTheBottom),placeholder:this.props.appStrings.searchPlaceholderLong,onChange:this.onSearchChanged,onSearch:this.onSearchExecuted,onEscape:this.onEscape,autoComplete:"off",value:this.state.query,onClick:this.onClick,onFocus:this.onSearchBoxFocus,onBlur:this.onSearchBoxBlur,onContextMenu:this.onContextMenu})},t.prototype.renderSearchResults=function(){return this.props.defaultRender(this.props.menuListProps)},t.prototype.onSearchBoxFocus=function(e){this.setState({searchBoxFocused:!0}),this.props.onSearchBoxFocused&&this.props.onSearchBoxFocused()},t.prototype.onSearchBoxBlur=function(e){this.setState({searchBoxFocused:!1})},t.prototype.onClick=function(){this.props.onShowZeroTermMenu&&this.props.zeroTermMenuEnabled&&this.props.initialView!==ti.a.ZeroTermMenu&&this.props.onShowZeroTermMenu()},t.prototype.onSearchExecuted=function(e){var t,n;if(!(null===(n=(t=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(t,"Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab"))){if(!this.isSearchResult())return void(!this.state.query&&this.props.onShowZeroTermMenu&&this.props.zeroTermMenuEnabled&&this.props.onShowZeroTermMenu());var o=this.props.menuListProps.items?this.props.menuListProps.items[0]:void 0;if((null==o?void 0:o.onClick)&&!o.disabled)return void o.onClick();if(this.focusFirstMenuItem())return}this.props.onSearchExecuted&&this.props.onSearchExecuted(e)},t.prototype.isSearchResult=function(){return this.props.contextualUILocation===ti.a.SearchResult||this.props.contextualUILocation===ti.a.ZeroTermMenu},t.prototype.focusFirstMenuItem=function(){var e=this.menuRegion.current;if(!e)return!1;var t=Object(ua.j)(e,e);return!!t&&(t.focus(),!0)},t.prototype.onSearchChanged=function(e,t){var n=t||"",o=n.length>0;this.props.onSearchStateChanged&&this.props.onSearchStateChanged(o,n),this.setState({query:n})},t.prototype.onEscape=function(e){if(!this.state.query)return this.props.onHideZeroTermMenu&&this.props.contextualUILocation===ti.a.ZeroTermMenu&&this.props.initialView!==this.props.contextualUILocation?(this.props.onHideZeroTermMenu(),e.preventDefault(),void e.stopPropagation()):void(this.props.onEscape&&this.props.onEscape(e))},t.prototype.onContextMenu=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.onMenuOpen=function(){var e=this;(new Ia.a).setImmediate((function(){e.props.onMenuOpened&&e.props.onMenuOpened()}))},t.prototype.onMenuClosed=function(){this.props.onMenuClosed&&this.props.onMenuClosed()},t.getDerivedStateFromProps=function(e,t){return""!==t.query&&e.hidden?{query:""}:null},t.contextType=Jd.a,t}(O.Component),UT=function(e,t){var n=Object(Gc.a)(e).menuBackgroundColor;return{root:{animation:"none"},container:t&&{opacity:0},calloutMain:Object(Cm.c)()&&{backgroundColor:n}}},qT=Object(Po.c)((function(){return{label:{maxWidth:320,textOverflow:"ellipsis",overflowX:"hidden"},divider:{margin:"1px 8px"},root:{},linkContent:{},icon:{},checkmarkIcon:{},secondaryText:{paddingLeft:"20px"},subMenuIcon:{},item:{},anchorLink:{},iconColor:{}}})),QT=Object(Po.c)((function(e){return{styles:{root:{zIndex:e}}}})),KT=function(e){function t(t){var n=e.call(this,t)||this;return n.searchBoxId="contextualSearchBox",n.contextMenuWrapper=O.createRef(),n.pendingOpenSubmenu=!1,n.tooltipHostMap=new Map,n.flyoutDropdownId="FlyoutDropDownId",n.autoOpenSubmenuFixes=function(){var e,t;return null===(t=(e=n.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,"Microsoft.Office.SharedOnline.AutoOpenSubmenuFixes")},n.getLayerZIndex=function(){var e,t,o=-1;if(n.props.hidden||!(null===(t=(e=n.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,"SharedOnline.ChangeGate.GenericContextMenusIsEnabled")))return o;var r=document.querySelectorAll("[ data-contextmenu-id='".concat(n.props.id,"']"));if(r)for(var i=0;i<r.length;i+=1)o=Math.max(RT(r[i]),o);return o+1},n.getContextualMenuProps=function(e){var t,o,r,i,a,s,l,c=n.useSearchableMenu(),u=c?Object(AT.a)(null===(t=n.props.searchableContextualMenuProps)||void 0===t?void 0:t.menuDefinition,n.onItemExecute,void 0,ti.b.ContextMenu):n.props.menuDefinition,d=Object(BT.b)({menuDefinition:u,controlInMenuRendererFunction:c?n.controlInMenuTellMeRendererFunction:n.controlInMenuRendererFunction,location:ti.b.ContextMenu,subComponentStyles:qT(),customMenuClassNames:Object(k.__assign)(Object(k.__assign)({},Object(V.db)({header:{padding:"6px 12px",height:"unset",lineHeight:"normal",whiteSpace:"normal"}})),{subComponentStyles:{menuItem:{},callout:{}}}),arePerfImprovementsEnabled:null===(r=(o=n.context).isExperimentalFeatureEnabled)||void 0===r?void 0:r.call(o,"ContextualUIPerfImprovementsIsEnabled"),onMenuItemExecuted:n.useSearchableMenu()?void 0:n.onItemExecute,onSubMenuPositioned:n.onSubmenuPositioned,onMenuPositioned:n.onCalloutReady,theme:e,isMultiWindowSupportEnabled:null===(a=(i=n.context).isExperimentalFeatureEnabled)||void 0===a?void 0:a.call(i,dm.f.multiWindowSupportIsEnabled),useFullDescriptionLabelOnly:null===(l=(s=n.context).isExperimentalFeatureEnabled)||void 0===l?void 0:l.call(s,dm.f.useFullDescriptionLabelOnly)},!0,n.context.appWindow);return n.getMenuItemToExpand(u,d),d.focusZoneProps=Object(k.__assign)(Object(k.__assign)({},d.focusZoneProps),{shouldInputLoseFocusOnArrowKey:function(e){return n.isContextualSearchEnabled()&&e.id===n.searchBoxId}}),d},n.onContextMenuOpen=function(){var e,t=(e=n.props).onMenuOpen,o=e.id;t&&t({id:o,location:ti.b.ContextMenu})},n.onDismiss=function(e,t){var o=n.props.onDismiss;o&&o(e,t),n.tooltipHostMap&&n.unregisterTooltips()},n.onMouseDown=function(e){n.props.onDismiss&&!n.elementIsWithinContextMenu(e)&&n.onDismiss(e)},n.elementIsWithinContextMenu=function(e){return void 0!==e&&(n.contextMenuWrapper.current===e.target||Object(_n.a)(n.contextMenuWrapper.current,e.target))},n.shadowRenderingIsEnabled=function(){var e,t;return null===(t=(e=n.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,"ContextMenuShadowRenderingIsEnabled")},n.maxHeight=function(){return window.innerHeight-2*NT.a.floatieLargeControlHeight},n.onItemExecute=function(e,t){n.props.onItemExecute&&n.props.onItemExecute(e,n.getContextualUiLocation(),t)},n.onSubmenuPositioned=function(e,t){t&&(n.tooltipHostMap=Object(_T.a)(e,t+"MenuId",n.tooltipHostMap,n.context.setTooltipElement,n.context.updateTooltipsHidden,!!Object(dm.a)(n.context,dm.f.delayRenderTooltipsIsEnabled))),n.props.onItemSubmenuOpen&&n.props.onItemSubmenuOpen(t,n.getContextualUiLocation())},n.onCalloutReady=function(e){0===n.tooltipHostMap.size&&(n.tooltipHostMap=Object(_T.a)(e,n.flyoutDropdownId,n.tooltipHostMap,n.context.setTooltipElement,n.context.updateTooltipsHidden,!!Object(dm.a)(n.context,dm.f.delayRenderTooltipsIsEnabled)))},n.state={isShadowRendering:!1},n.renderSearchableMenuList=n.renderSearchableMenuList.bind(n),n.onSearchStateChanged=n.onSearchStateChanged.bind(n),n.onPositioned=n.onPositioned.bind(n),n.onShowZeroTermMenu=n.onShowZeroTermMenu.bind(n),n.controlInMenuRendererFunction=Vd(n.props.appIcons,n.props.appStrings),n.controlInMenuTellMeRendererFunction=Object(MT.a)(n.props.appIcons,n.props.appStrings,n.props.appColors),n.hasListeners=!1,n.flyoutDropdownId=Object(DT.c)(n.props,n.props.id),n}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.isShadowRendering&&!e.hidden?{isShadowRendering:!1}:null},t.prototype.shouldComponentUpdate=function(e,t){return!(this.props.hidden&&e.hidden&&!t.isShadowRendering)&&(!Object(pi.e)(this.props,e)||!Object(pi.e)(this.state,t))},t.prototype.render=function(){var e,t=this,n=(e=this.props).id,o=e.target,r=e.directionalHint,i=e.positionAndHide,a=e.inputMethod,s=e.hidden,l=this.getLayerZIndex();return O.createElement(Bo.a,null,(function(e){return O.createElement(LT.a.Provider,{value:Object(LT.b)(!!t.state.isShadowRendering)},O.createElement("div",{ref:t.contextMenuWrapper},O.createElement(FT.a,Object(k.__assign)({id:"".concat(ti.b.ContextMenu,"-").concat(n),onRenderMenuList:t.isContextualSearchEnabled()?t.renderSearchableMenuList:void 0,onDismiss:t.onDismiss,onMenuOpened:t.onContextMenuOpen},t.getContextualMenuProps(e),{directionalHint:r||Y.a.bottomLeftEdge,directionalHintFixed:!1,alignTargetEdge:!0,target:o,calloutProps:{id:"".concat(n),onPositioned:t.onPositioned,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,styles:UT(e,i),calloutMaxHeight:t.maxHeight(),layerProps:Object(k.__assign)(Object(k.__assign)({},l>V.G.Layer?QT(l):void 0),{eventBubblingEnabled:!0})},shouldFocusOnContainer:!t.isContextualSearchEnabled()&&a!==Uy.a.Keyboard&&!t.controlIdToExpand,shouldFocusOnMount:t.autoOpenSubmenuFixes()?!t.controlIdToExpand:void 0,"data-unique-id":"ContextMenu",hidden:s,shouldUpdateWhenHidden:t.state.isShadowRendering}))))}))},t.prototype.componentDidMount=function(){var e,t=this;this.props.hidden||this.addListeners(),Object(CT.a)((function(){t.contextualItemRef&&t.contextualItemRef.current&&(t.contextualItemRef.current.openSubMenu(),t.pendingOpenSubmenu=!1)}));var n=(e=this.props).populateMenuCallback,o=e.id;Object(jT.a)()&&this.shadowRenderingIsEnabled()&&n&&(window.requestIdleCallback((function(){n(Uy.a.Mouse,o,!0)}),void 0,"ContextMenu-".concat(this.props.id,"-ShadowMenuOpen")),window.requestIdleCallback((function(){t.setState({isShadowRendering:!0})}),void 0,"ContextMenu-".concat(this.props.id,"-StartShadowRendering")))},t.prototype.componentDidUpdate=function(e){var t=this;this.props.hidden?this.removeListeners():this.addListeners(),this.state.isShadowRendering&&void 0!==this.props.menuDefinition&&this.setState({isShadowRendering:!1}),Object(CT.a)((function(){(e.hidden&&!t.props.hidden||e.menuDefinition!==t.props.menuDefinition||t.autoOpenSubmenuFixes()&&t.pendingOpenSubmenu)&&t.contextualItemRef&&t.contextualItemRef.current&&(t.contextualItemRef.current.openSubMenu(),t.pendingOpenSubmenu=!1)}))},t.prototype.componentWillUnmount=function(){this.removeListeners()},t.prototype.onPositioned=function(e){var t=this.props.onPositioned;t&&t(e),this.targetEdge=(null==e?void 0:e.targetEdge)||tr.b.bottom},t.prototype.renderSearchableMenuList=function(e,t){var n,o,r,i,a,s,l,c=this,u={sessionId:this.props.sessionId,contextualUILocation:this.getContextualUiLocation(),zeroTermMenuEnabled:null===(n=this.props.searchableContextualMenuProps)||void 0===n?void 0:n.zeroTermMenuEnabled,initialView:null!==(r=null===(o=this.props.searchableContextualMenuProps)||void 0===o?void 0:o.initialView)&&void 0!==r?r:ti.a.StandardContextMenu,menuId:this.props.id,onEscape:function(e){return c.onDismiss(e,!0)},onSearchStateChanged:this.onSearchStateChanged,appStrings:this.props.appStrings,appIcons:this.props.appIcons,hidden:this.props.hidden,searchBoxOnTheBottom:this.targetEdge===tr.b.top,menuListProps:e,defaultRender:t,searchBoxId:this.searchBoxId,onShowZeroTermMenu:this.onShowZeroTermMenu,onHideZeroTermMenu:null===(i=this.props.searchableContextualMenuProps)||void 0===i?void 0:i.onHideZeroTermMenu,onSearchExecuted:null===(a=this.props.searchableContextualMenuProps)||void 0===a?void 0:a.openSearchPane,onMenuOpened:null===(s=this.props.searchableContextualMenuProps)||void 0===s?void 0:s.onAfterMenuOpen,onMenuClosed:null===(l=this.props.searchableContextualMenuProps)||void 0===l?void 0:l.onAfterMenuDismiss,onSearchBoxFocused:this.props.onSearchBoxFocused};return O.createElement(GT,Object(k.__assign)({},u))},t.prototype.onShowZeroTermMenu=function(){this.props.searchableContextualMenuProps&&(this.props.onFloatieDismiss&&this.props.onFloatieDismiss(),this.props.searchableContextualMenuProps.onShowZeroTermMenu())},t.prototype.onSearchStateChanged=function(e,t){this.props.searchableContextualMenuProps&&(e&&this.props.onFloatieDismiss&&this.props.onFloatieDismiss(),this.props.searchableContextualMenuProps.onSearchStateChanged(e,t))},t.prototype.isContextualSearchEnabled=function(){return!!this.props.searchableContextualMenuProps},t.prototype.useSearchableMenu=function(){var e,t;return(null===(e=this.props.searchableContextualMenuProps)||void 0===e?void 0:e.initialView)===ti.a.ZeroTermMenu||oT(null===(t=this.props.searchableContextualMenuProps)||void 0===t?void 0:t.menuDefinition)},t.prototype.getContextualMenuItemToExpand=function(e){var t=this;if(!this.autoOpenSubmenuFixes())return Object(Vy.d)(e,(function(e){return e.key===t.controlIdToExpand}));for(var n=0,o=e;n<o.length;n++){var r=o[n];if(r.key===this.controlIdToExpand)return r;if(r.sectionProps){var i=Object(Vy.d)(r.sectionProps.items,(function(e){return e.key===t.controlIdToExpand}));if(void 0!==i)return i}}},t.prototype.getMenuItemToExpand=function(e,t){if(e){this.controlIdToExpand=void 0;for(var n=0,o=e.sections;n<o.length;n++)for(var r=0,i=o[n].controls;r<i.length;r++){var a=i[r];if((Object(CE.a)(a)||Object(PT.a)(a))&&a.menuDefinition&&a.menuDefinition.shouldAutoOpen){var s=this.contextualItemRef;if(this.controlIdToExpand=a.id,this.controlIdToExpand&&t){var l=this.getContextualMenuItemToExpand(t.items);this.contextualItemRef=l&&l.componentRef}else this.contextualItemRef=void 0;return void(this.autoOpenSubmenuFixes()&&s!==this.contextualItemRef&&this.contextualItemRef&&(this.pendingOpenSubmenu=!0))}}}},t.prototype.addListeners=function(){this.hasListeners||(window.document.body.addEventListener("mousedown",this.onMouseDown,!0),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(window.document.body.removeEventListener("mousedown",this.onMouseDown,!0),this.hasListeners=!1)},t.prototype.unregisterTooltips=function(){this.tooltipHostMap.forEach((function(e){e.unregisterTooltipHostActions()})),this.tooltipHostMap.clear()},t.prototype.getContextualUiLocation=function(){var e;return rT(null===(e=this.props.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition)},t.contextType=Jd.a,t}(O.Component),JT=n(2695),ZT=n(2405),YT=n(1125),XT=n(671);function $T(e,t){var n=Object(YT.c)(e);return n===tr.b.top&&t===tr.b.left||n===tr.b.left&&t===tr.b.top?Y.a.topLeftEdge:n===tr.b.bottom&&t===tr.b.left||n===tr.b.left&&t===tr.b.bottom?Y.a.bottomLeftEdge:n===tr.b.bottom&&t===tr.b.right||n===tr.b.right&&t===tr.b.bottom?Y.a.bottomRightEdge:n===tr.b.top&&t===tr.b.right||n===tr.b.right&&t===tr.b.top?Y.a.topRightEdge:Y.a.topLeftEdge}var eI=function(e){function t(t){var n=e.call(this,t)||this;return n.contextualUIWrapper=O.createRef(),n.contextMenuIds=[],n.fullyPositioned=function(){var e=!(n.shouldRenderFloatie()&&!n.state.floatiePositioned),t=!(n.shouldRenderContextMenu()&&!n.state.contextMenuPositioned);return n.props.positionInOneFrameIsEnabled?n.state.fullyPositioned:t&&e},n.onPointerDown=function(e){var t,o;n.elementIsWithinContextualUI(null==e?void 0:e.target)||(n.usageData&&(n.usageData.clickedAway=!0),n.dismissContextualUI(e),(null===(o=(t=n.context).isExperimentalFeatureEnabled)||void 0===o?void 0:o.call(t,"SharedOnline.ChangeGate.PreventDefaultOnDimissContextualUI"))&&(null==e||e.preventDefault()))},n.onFocus=function(e){var t,o,r=!n.elementIsWithinContextualUI(null==e?void 0:e.target),i=!(null===(o=(t=n.context).isExperimentalFeatureEnabled)||void 0===o?void 0:o.call(t,"SharedOnline.ChangeGate.GenericContextMenusIsEnabled"))||n.elementIsWithinContextualUI(null==e?void 0:e.relatedTarget);n.shouldDismissContextualUIOnFocusLost()&&r&&i&&n.dismissContextualUI(e)},n.onMouseWheel=function(e){n.shouldDismissContextualUIOnScroll()&&!n.elementIsWithinContextualUI(null==e?void 0:e.target)&&n.dismissContextualUI(e)},n.onPointerMove=function(e){!n.shouldDismissFloatieOnPointerMove()||n.elementIsWithinFloatie(e)||n.state.floatieMenuOpened||"touch"!==(null==e?void 0:e.pointerType)||n.dismissContextualUI(e)},n.onKeyDown=function(e){e&&e.keyCode===z.a.escape&&n.props.contextMenuProps.hidden&&!n.props.floatieProps.hidden&&!n.state.floatieMenuOpened&&n.dismissContextualUI(e)},n.onBoundingWindowRectChanged=function(){n.dismissContextualUI()},n.onContextMenuDismiss=function(e,t){n.props.onContextMenuDismiss(e,t,n.props.contextMenuProps.id,n.props.contextMenuProps.attachedFloatie)},n.onContextualItemExecute=function(e,t,o){var r;if(n.props.onItemExecute&&n.props.onItemExecute(e,t,o),n.usageData){var i=iT(n.props.contextMenuProps,t),a=t===ti.a.Floatie||(null===(r=n.usageData.openedSubMenu)||void 0===r?void 0:r.commandId)===o?o:void 0,s=i.filter((function(t){return t.commandId===(a||e)}));if(t!==ti.a.Floatie&&s&&s.length>0){var l=s[0];n.usageData.executedCommands.push(Object(k.__assign)(Object(k.__assign)({},l),{commandId:e,parentId:a}))}else n.usageData.executedCommands.push({commandId:e,location:t,parentId:a})}},n.onSearchBoxFocused=function(){n.usageData&&0===n.usageData.visibleSessionStart&&(n.usageData.visibleSessionStart=n.getWindow().performance.now())},n.onSubMenuPositioned=function(e,t){n.usageData&&(n.usageData.openedSubMenu={commandId:e,location:t})},n.onContextMenuPositioned=function(e){if(n.props.contextMenuProps.attachedFloatie&&!n.state.contextMenuPositioned){var t=e.targetEdge,o=e.alignmentEdge;n.setState({floatieLayoutFromState:{directionalHint:$T(t,o),target:n.getContextMenuSelector(),gapSpace:JT.b},contextMenuPositioned:!0})}else n.state.contextMenuPositioned||n.setState({contextMenuPositioned:!0})},n.onFloatiePositioned=function(e){var t;if(n.props.floatieProps.attachedContextMenu&&!n.state.floatiePositioned){var o=e.targetEdge,r=e.alignmentEdge,i=(t=function(e,t,n){var o=e.getBoundingClientRect(),r=o.left,i=o.right,a=o.top,s=o.bottom;return t===tr.b.top&&n===tr.b.left||t===tr.b.right&&n===tr.b.bottom?{directionalHint:Y.a.topLeftEdge,target:{left:r,top:s}}:t===tr.b.bottom&&n===tr.b.right||t===tr.b.left&&n===tr.b.top?{directionalHint:Y.a.bottomRightEdge,target:{left:i,top:a}}:t===tr.b.bottom&&n===tr.b.left||t===tr.b.right&&n===tr.b.top?{directionalHint:Y.a.bottomLeftEdge,target:{left:r,top:a}}:t===tr.b.top&&n===tr.b.right||t===tr.b.left&&n===tr.b.bottom?{directionalHint:Y.a.topRightEdge,target:{left:i,top:s}}:{directionalHint:Y.a.topLeftEdge,target:{left:r,top:s}}}(n.getWindow().document.getElementById(JT.c),o,r)).target,a=t.directionalHint;n.setState({floatieLayoutFromState:{directionalHint:a,target:i,gapSpace:0},floatiePositioned:!0})}else n.state.floatiePositioned||n.setState({floatiePositioned:!0})},n.onFloatieFadedAway=function(){n.usageData&&(n.usageData.floatieFadedAway=!0)},n.onFloatieMenuToggled=function(e){n.setState({floatieMenuOpened:e})},n.state={contextMenuPositioned:!1,floatiePositioned:!1,floatieMenuOpened:!1,fullyPositioned:!1},n.hasListeners=!1,n.sessionId=0,n}return Object(k.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.contextMenuProps.target,o=e.floatieProps.target;return e.contextMenuProps.hidden||e.floatieProps.hidden||t.lastPropsContextMenuTarget===n||t.lastPropsFloatieTarget===o?{lastPropsContextMenuTarget:n,lastPropsFloatieTarget:o}:{contextMenuPositioned:!1,floatiePositioned:!1,floatieLayoutFromState:void 0,floatieMenuOpened:!1,fullyPositioned:!1,lastPropsContextMenuTarget:n,lastPropsFloatieTarget:o}},t.prototype.componentDidUpdate=function(e){if(this.props.positionInOneFrameIsEnabled&&!this.state.fullyPositioned)if(this.props.floatieProps.attachedContextMenu){var t=this.getWindow().document,n=function(e,t,n,o){var r,i,a,s,l=Y.a.topLeftEdge,c={top:0,left:0};if(null===e||null==t||void 0===n)return{directionalHint:l,target:c};var u=e.getBoundingClientRect(),d=t.getBoundingClientRect(),p=window.innerWidth,h=window.innerHeight,g=d.width,m=d.height,f=Object(XT.e)(t),b=null!==(r=null==f?void 0:f.top)&&void 0!==r?r:0,v=h-(null!==(i=null==f?void 0:f.bottom)&&void 0!==i?i:0),y=null!==(a=n.left)&&void 0!==a?a:0,x=null!==(s=n.top)&&void 0!==s?s:0,C=x+m<=h-v,S=y+g<=p,E=C||x-m-b>0,k=u.width,O=u.height,T=C?x:E?x-m:b,I=C?x+m:E?x:m,w=S?y:y-g,_=S?y+g:y,P=C?T-(o+O)>0:I+o+O<h,R=!C&&I+v+o+O>h,D=R?_+k<p:w+k<p;return R?D?(l=Y.a.rightTopEdge,c={top:T,left:_}):(l=Y.a.leftTopEdge,c={top:T,left:w}):C&&P&&D||!C&&!P&&D?(l=Y.a.topLeftEdge,c={top:T,left:w}):C&&P&&!D||!C&&!P&&!D?(l=Y.a.topRightEdge,c={top:T,left:_}):C&&!P&&D||!C&&P&&D?(l=Y.a.bottomLeftEdge,c={top:I,left:w}):(l=Y.a.bottomRightEdge,c={top:I,left:_}),{directionalHint:l,target:c}}(t.getElementById(JT.c),t.querySelector(this.getContextMenuSelector()),this.props.contextMenuProps.target,JT.b);this.setState({floatieLayoutFromState:Object(k.__assign)(Object(k.__assign)({},n),{gapSpace:JT.b}),fullyPositioned:!0},this.addListeners)}else this.setState({fullyPositioned:!0},this.addListeners);else this.isContextualUIVisible()?this.addListeners():this.removeListeners();var o=this.isContextualUIVisible(),r=this.isContextualUIVisibleFromProps(e);o&&!r?this.onShow():!o&&r&&this.onHide()},t.prototype.componentDidMount=function(){this.isContextualUIVisible()&&this.addListeners()},t.prototype.componentWillUnmount=function(){this.removeListeners()},t.prototype.render=function(){return O.createElement(IT.a,{hostId:this.props.containerId,eventBubblingEnabled:!0},O.createElement("div",{ref:this.contextualUIWrapper},this.renderContextMenu(),this.renderFloatie()))},t.prototype.menuIdHasBeenRenderedBefore=function(e){return Object(Vy.e)(this.contextMenuIds,(function(t){return t===e}))>-1},t.prototype.renderContextMenu=function(){var e,t,n,o=this,r=Object(L.g)(),i=(e=this.props).contextMenuProps,a=e.contextMenusToShadowRender,s=e.populateMenuCallback,l=e.onFloatieDismiss,c=e.positionInOneFrameIsEnabled,u=[];return(null===(n=(t=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(t,"IDBasedContextMenusIsEnabled"))?(a&&a.forEach((function(e,t){o.menuIdHasBeenRenderedBefore(t)||o.contextMenuIds.push(t)})),this.menuIdHasBeenRenderedBefore(i.id)||this.contextMenuIds.push(i.id),u=this.contextMenuIds.map((function(e){return O.createElement(KT,Object(k.__assign)({},i,{menuDefinition:a&&a.has(e)?a.get(e):i.menuDefinition,sessionId:o.sessionId,key:e,id:e,onPositioned:c?void 0:o.onContextMenuPositioned,onDismiss:o.onContextMenuDismiss,onFloatieDismiss:l,positionAndHide:o.shouldPositionContextMenuHidden(),hidden:!o.shouldRenderContextMenu(e),populateMenuCallback:s,onItemExecute:o.onContextualItemExecute,onItemSubmenuOpen:o.onSubMenuPositioned,onSearchBoxFocused:o.onSearchBoxFocused}))}))):u.push(O.createElement(KT,Object(k.__assign)({},i,{sessionId:this.sessionId,key:i.id,id:i.id,onPositioned:c?void 0:this.onContextMenuPositioned,onDismiss:this.onContextMenuDismiss,onFloatieDismiss:l,positionAndHide:this.shouldPositionContextMenuHidden(),hidden:!this.shouldRenderContextMenu(),onItemExecute:this.onContextualItemExecute,onItemSubmenuOpen:this.onSubMenuPositioned,onSearchBoxFocused:this.onSearchBoxFocused}))),r?u:O.createElement(td.a,null,u)},t.prototype.renderFloatie=function(){var e,t=this,n=Object(L.g)(),o=(e=this.props).floatieProps,r=e.onFloatieDismiss,i=e.useSmallScreenLayout,a=e.floatieGroupsToShadowRender,s=e.positionInOneFrameIsEnabled,l=this.state.floatieLayoutFromState,c=O.createElement(Bo.a,null,(function(e){return O.createElement(JT.a,Object(k.__assign)({},o,o.attachedContextMenu&&l,{originalTarget:o.target,onPositioned:s?void 0:t.onFloatiePositioned,onDismiss:r,onFadedAway:t.onFloatieFadedAway,onMenuToggled:t.onFloatieMenuToggled,positionAndHide:t.shouldPositionFloatieHidden(),hidden:s?!t.shouldRenderFloatieV2():!t.shouldRenderFloatie(),isSmallScreenFloatie:i,scrollStyles:Object(ZT.d)(e,Object(F.a)()),floatieGroupsToShadowRender:a,positionFloatieInSingleFrame:s,onItemExecute:t.onContextualItemExecute,onItemSubmenuOpen:t.onSubMenuPositioned}))}));return n?c:O.createElement(td.a,{appColors:this.props.floatieProps.appColors},c)},t.prototype.addListeners=function(){if(!this.hasListeners&&this.fullyPositioned()){if(!this.props.floatieProps.preventAutoDismiss){var e=this.getWindow();e.document.body.addEventListener("pointerdown",this.onPointerDown,!0),e.document.body.addEventListener("wheel",this.onMouseWheel,!0),e.document.body.addEventListener("focus",this.onFocus,!0),e.document.body.addEventListener("pointermove",this.onPointerMove,!0),e.document.body.addEventListener("keydown",this.onKeyDown,!0),Object(wT.t)("ContextualUI",this.onBoundingWindowRectChanged)}this.hasListeners=!0}},t.prototype.removeListeners=function(){if(this.hasListeners){var e=this.getWindow();e.document.body.removeEventListener("pointerdown",this.onPointerDown,!0),e.document.body.removeEventListener("wheel",this.onMouseWheel,!0),e.document.body.removeEventListener("focus",this.onFocus,!0),e.document.body.removeEventListener("pointermove",this.onPointerMove,!0),e.document.body.removeEventListener("keydown",this.onKeyDown,!0),Object(wT.w)("ContextualUI"),this.hasListeners=!1}},t.prototype.dismissContextualUI=function(e){var t,n;this.props.floatieProps.hidden||this.props.contextMenuProps.hidden||!(null===(n=(t=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(t,"SharedOnline.ChangeGate.ContextMenuPerfFix"))?(!this.props.floatieProps.hidden&&this.props.onFloatieDismiss(e),!this.props.contextMenuProps.hidden&&this.onContextMenuDismiss(e)):this.onContextMenuDismiss(e,!0)},t.prototype.startSessionLog=function(){var e,t;this.usageData={sessionId:this.sessionId,menuId:this.props.contextMenuProps.id,menuVisualization:(e=this.props,t=[],e.floatieProps.hidden||t.push(ti.a.Floatie),e.contextMenuProps.hidden||(e.contextMenuProps.searchableContextualMenuProps?(t.push(ti.a.SearchResult),e.contextMenuProps.searchableContextualMenuProps.initialView!==ti.a.ZeroTermMenu&&t.push(ti.a.StandardContextMenu),e.contextMenuProps.searchableContextualMenuProps.zeroTermMenuEnabled&&t.push(ti.a.ZeroTermMenu)):t.push(ti.a.StandardContextMenu)),t),sessionStart:this.getWindow().performance.now(),sessionDuration:0,visibleSessionStart:0,visibleSessionDuration:0,executedCommands:[],offeredCommands:[],offeredFloatieCommands:[],menuTargetType:"",visualizationAtClose:ti.a.StandardContextMenu,invocationMethod:this.props.contextMenuProps.inputMethod,menuShown:!this.props.contextMenuProps.hidden,floatieShown:!this.props.floatieProps.hidden,floatieFadedAway:!1,clickedAway:!1}},t.prototype.getMenuTargetType=function(){var e,t,n,o,r;return null!==(r=null!==(t=null===(e=this.props.contextMenuProps.menuDefinition)||void 0===e?void 0:e.menuTargetType)&&void 0!==t?t:null===(o=null===(n=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===n?void 0:n.menuDefinition)||void 0===o?void 0:o.menuTargetType)&&void 0!==r?r:"Unknown"},t.prototype.completeSessionLog=function(){var e,t,n,o;this.props.onInteractionCompleted&&this.usageData&&(this.usageData.sessionDuration=this.getWindow().performance.now()-this.usageData.sessionStart,this.usageData.visibleSessionDuration=this.getWindow().performance.now()-this.usageData.visibleSessionStart,this.usageData.visualizationAtClose=rT(null===(e=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition),this.usageData.menuTargetType=null!==(t=this.props.menuTargetType)&&void 0!==t?t:this.getMenuTargetType(),this.usageData.floatieShown&&(this.usageData.offeredFloatieCommands=(null==(o=this.props.floatieProps)?void 0:o.groups)?o.groups.map((function(e){return{commandIds:cT(e),location:ti.a.Floatie}})):[]),this.usageData.menuShown&&(this.usageData.offeredCommands=iT(this.props.contextMenuProps,this.usageData.visualizationAtClose)),this.usageData.zeroTermMenuEnabled=null===(n=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===n?void 0:n.zeroTermMenuEnabled,this.props.onInteractionCompleted(this.usageData)),this.sessionId=this.sessionId+1,this.usageData=void 0},t.prototype.elementIsWithinContextualUI=function(e){return void 0!==e&&(this.contextualUIWrapper.current===e||Object(_n.a)(this.contextualUIWrapper.current,e))},t.prototype.elementIsWithinFloatie=function(e){var t=this.getWindow().document.getElementById(JT.c);return void 0!==e&&(this.contextualUIWrapper.current===e.target||Object(_n.a)(this.contextualUIWrapper.current,e.target))||this.pointIsWithinFloatie(t,e)},t.prototype.pointIsWithinFloatie=function(e,t){if(!e||!t)return!1;var n=e.getBoundingClientRect();return t.clientX>n.x&&t.clientX<n.x+n.width&&t.clientY>n.y&&t.clientY<n.y+n.height},t.prototype.shouldRenderContextMenu=function(e){var t,n;return e&&(null===(n=(t=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(t,"IDBasedContextMenusIsEnabled"))?!this.props.contextMenuProps.hidden&&e===this.props.contextMenuProps.id:!this.props.contextMenuProps.hidden},t.prototype.shouldRenderFloatie=function(){return!this.props.floatieProps.hidden&&(this.props.contextMenuProps.hidden||this.state.contextMenuPositioned)},t.prototype.shouldPositionContextMenuHidden=function(){return this.props.positionInOneFrameIsEnabled?!(!this.props.contextMenuProps.attachedFloatie||this.state.fullyPositioned):!this.props.floatieProps.hidden&&!this.state.floatiePositioned},t.prototype.shouldPositionFloatieHidden=function(){return this.props.positionInOneFrameIsEnabled?!(!this.props.floatieProps.attachedContextMenu||this.state.fullyPositioned):!this.props.contextMenuProps.hidden&&!this.state.floatiePositioned},t.prototype.shouldDismissContextualUIOnFocusLost=function(){return!this.props.contextMenuProps.hidden},t.prototype.shouldDismissContextualUIOnScroll=function(){return!this.props.floatieProps.hidden&&this.props.contextMenuProps.hidden},t.prototype.shouldDismissFloatieOnPointerMove=function(){return!this.props.floatieProps.hidden&&this.props.contextMenuProps.hidden},t.prototype.isContextualUIVisible=function(){return this.isContextualUIVisibleFromProps(this.props)},t.prototype.isContextualUIVisibleFromProps=function(e){return!(e.contextMenuProps.hidden&&e.floatieProps.hidden)},t.prototype.getContextMenuSelector=function(){return"div#".concat(this.props.contextMenuProps.id)},t.prototype.shouldRenderFloatieV2=function(){return!this.props.floatieProps.hidden},t.prototype.onShow=function(){this.startSessionLog()},t.prototype.onHide=function(){this.completeSessionLog()},t.prototype.getWindow=function(){var e,t,n;return(null===(t=(e=this.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,dm.f.multiWindowSupportIsEnabled))&&null!==(n=this.context.appWindow)&&void 0!==n?n:window},t.contextType=Jd.a,t}(O.PureComponent),tI=n(580),nI=n(1927),oI=n(2192),rI=function(e,t){if(Object(mo.e)("ContextMenuSearchIsEnabled")&&iI(t))return{menuDefinition:KO(e),zeroTermMenuEnabled:ZO(e),initialView:YO(e),onSearchStateChanged:function(e,t){Object(TT.n)()(t,ti.b.ContextMenu)},onShowZeroTermMenu:function(){Object(kr.a)(Object(ET.a)("ZeroTermContextMenu",!1))},onHideZeroTermMenu:function(){Object(kr.a)(Object(ET.a)("ZeroTermContextMenu",!0))},onAfterMenuOpen:Object(TT.g)(ti.b.ContextMenu,"TellMe",ti.b.ContextMenu),openSearchPane:Object(TT.i)(ti.b.ContextMenu)}},iI=function(e){switch(e){case"ContextMenu":case"GridContextMenu":return!0}return!1},aI=function(e){return e===Uy.a.Touch||e===Uy.a.Pen},sI=function(e,t){return!(!e||e.attachedContextMenu||0===t.length)&&t.some((function(e){return("SingleControlFloatieGroup"===e.type||"SingleRowFloatieGroup"===e.type)&&e.preventAutoDismiss}))},lI=function(e){Object(go.logActivity)("ContextualUIUsageData",!0,e.sessionDuration,function(e){var t;return[{name:"MenuId",string:e.menuId},{name:"MenuVisualization",string:JSON.stringify(e.menuVisualization)},{name:"OpenedSubMenu",string:JSON.stringify(e.openedSubMenu)},{name:"OfferedCommands",string:JSON.stringify(e.offeredCommands)},{name:"OfferedFloatieCommands",string:JSON.stringify(e.offeredFloatieCommands)},{name:"ExecutedCommands",string:JSON.stringify(e.executedCommands)},{name:"SessionDuration",double:e.visibleSessionDuration},{name:"SessionId",int64:e.sessionId},{name:"MenuTargetType",string:e.menuTargetType},{name:"VisualizationAtClose",string:e.visualizationAtClose},{name:"InvocationMethod",string:Uy.a[e.invocationMethod||Uy.a.Unknown]},{name:"TellMeCorrelationId",string:Object(nI.a)()},{name:"AcmCorrelationId",string:Object(oI.a)("ACM")},{name:"ZeroTermMenuEnabled",bool:e.zeroTermMenuEnabled},{name:"CtxUiAbandoned",bool:0===(null===(t=e.executedCommands)||void 0===t?void 0:t.length)},{name:"FloatieFadedAway",bool:e.floatieFadedAway},{name:"ClickedAway",bool:e.clickedAway},{name:"Version",int64:4}]}(e)),function(e){var t=e.zeroTermMenuEnabled,n=e.visualizationAtClose,o=t?[Object(kT.a)("ContextMenu",!1),Object(ET.a)("ZeroTermContextMenu",!0),Object(OT.a)("ZeroTermContextMenu",[])]:[];Object(nI.a)()?Object(TT.f)(ti.b.ContextMenu,"TellMe")(o,ti.b.ContextMenu):t&&Object(kr.a)(o);Object(oI.b)("ACM",""),t&&n===ti.a.ZeroTermMenu&&Object(tT.d)(e)}(e)},cI=function(e,t){var n=document.getElementById(e),o=t;return void 0!==o&&"Escape"===o.key&&(n===o.target||Object(_n.a)(n,o.target))},uI=function(e,t,n){t===ti.a.SearchResult&&Object(TT.m)(e,n,ti.b.ContextMenu)},dI={areStatePropsEqual:function(e,t){var n=e.floatieProps.hidden!==t.floatieProps.hidden||!e.floatieProps.hidden,o=e.contextMenuProps.hidden!==t.contextMenuProps.hidden||!e.contextMenuProps.hidden,r=e.contextMenusToShadowRender,i=t.contextMenusToShadowRender;return!n&&!o&&!function(e,t){var n=0,o=0;return t&&t.forEach((function(e){void 0===e&&(o+=1)})),e&&e.forEach((function(e){void 0===e&&(n+=1)})),o!==n}(r,i)},areStatesEqual:function(e,t){var n;return!!(null===(n=Object(Tr.a)("ContextualUI"))||void 0===n?void 0:n(e,t))||!qO(e)&&!qO(t)&&!Object(MO.e)(e)&&!Object(MO.e)(t)}},pI=Object(Ir.connect)((function(e,t){var n=Object(MO.c)(e),o=function(e){return e.contextualUILayoutModel.contextMenuLayout}(e),r=UO(e),i=function(e){return e.contextualUILayoutModel.inputMethod}(e),a=function(e){return e.contextualUILayoutModel.menuTargetType}(e),s=Object(ST.b)()(e),l=sI(n,s);return{floatieProps:Object(k.__assign)(Object(k.__assign)({},n),{hidden:!Object(MO.e)(e),groups:s,appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColors,preventLightDismiss:l||aI(i),preventAutoDismiss:l}),contextMenuProps:Object(k.__assign)(Object(k.__assign)({},o),{hidden:!qO(e),id:Object(mo.e)("IDBasedContextMenusIsEnabled")?null!=r?r:GO.a.ContextMenu:t.contextMenuId,menuDefinition:QO(e),appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColors,inputMethod:i,searchableContextualMenuProps:rI(e,r)}),contextMenusToShadowRender:JO(e),floatieGroupsToShadowRender:Object(mo.e)("FloatieShadowRenderingIsEnabled")?Object(ST.b)(t.floatieGroupsToShadowRender)(e):void 0,menuTargetType:a}}),(function(e,t){return{onFloatieDismiss:function(){e(Object(HO.c)())},onContextMenuDismiss:function(n,o,r,i){var a=Object(tI.a)("SharedOnline.ChangeGate.ContextMenuPerfFix");o||cI(t.containerId,n)&&i?a?e(Object(yC.batchActions)([Object(HO.c)(),Object(HO.b)()])):(e(Object(HO.c)()),e(Object(HO.b)())):e(Object(HO.b)());var s=function(){Object(tT.b)(null!=r?r:t.contextMenuId,"FlyoutAnchorModel")()};a?Object(CT.a)(s):s()}}}),(function(e,t,n){var o=Object(k.__assign)(Object(k.__assign)({},n),{onInteractionCompleted:lI,onItemExecute:e.contextMenuProps.searchableContextualMenuProps?uI:void 0});return Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},o),e),t)}),dI)(eI),hI=function(e){return O.createElement(CC.a,null,O.createElement(pI,Object(k.__assign)({},e)))},gI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=TC.a;return O.createElement(cl.a,null,O.createElement(Ir.Provider,{store:kC.a},O.createElement(e,null,O.createElement(hI,{appStrings:Object(b.a)(),appIcons:ir.a,appColors:Object(f.a)(),contextMenuId:"ContextMenuContainer",contextMenuCommandId:GO.a.ContextMenu,containerId:this.props.containerId,positionInOneFrameIsEnabled:Object(ea.d)("positionInOneFrameIsEnabled"),useSmallScreenLayout:Object(ea.d)("SmallScreenContextualUIIsEnabled")&&Object(L.h)(),populateMenuCallback:pT,floatieGroupsToShadowRender:Object(ea.d)("FloatieShadowRenderingIsEnabled")?xT.b:void 0}))))},t}(O.PureComponent),mI=Object(MO.d)(kC.a),fI=n(659);var bI={initializeContextualUI:function(e){var t=[Object(fI.a)(Object(xT.d)()),Object(HO.a)(Object(xT.e)()),Object(HO.f)(GO.a.ContextMenu)];Object(ea.d)("ContextMenuShadowRenderingIsEnabled")&&(t=t.concat([Object(HO.g)(xT.f)])),WO(t,Wy.a),T.render(O.createElement(gI,{containerId:e.id}),e)},showContextMenu:function(e,t,n,o,r,i){var a=window.performance.now();if(!qO(kC.a.getState()))return function(s,l){var c;if(!qO(l())){n&&s(Object(HO.f)(n));var u=yT(e.target)?{left:e.target.x,top:e.target.y}:e.target;Object(eT.b)("ShowReactContextMenu",(function(){var e=sT(QO(l())).toString(),t=e===uT;return uT=e,t}),null!=n?n:UO(l()),void 0,null!==(c=null==i?void 0:i.sharedApiStartTime)&&void 0!==c?c:a),gT(t,n),mT(s,{contextMenuLayout:Object(k.__assign)(Object(k.__assign)({},e),{target:u}),inputMethod:t,useSmallScreenlayout:o,menuTargetType:r})}}},showContextualUI:function(e,t,n,o,r,i,a){var s=window.performance.now();if(!Object(MO.e)(kC.a.getState())||!qO(kC.a.getState()))return function(l,c){var u;if(!Object(MO.e)(c())||!qO(c())){r&&l(Object(HO.f)(r)),Object(eT.b)("ShowReactContextualUI",(function(){var e=Object(MO.a)(c()).toString(),t=e===dT;dT=e;var n=sT(QO(c())).toString(),o=n===uT;return uT=n,t&&o}),null!=r?r:UO(c()),void 0,null!==(u=null==a?void 0:a.sharedApiStartTime)&&void 0!==u?u:s),Object(Re.h)("ContextualUIDetailedTelemetryIsEnabled")?hT(n,r):gT(n,r);var d=yT(e.target)?{left:e.target.x,top:e.target.y}:e.target,p=yT(t.target)?{left:t.target.x,top:t.target.y}:t.target;fT(l,{floatieLayout:Object(k.__assign)(Object(k.__assign)({},e),{target:d,attachedContextMenu:!0}),contextMenuLayout:Object(k.__assign)(Object(k.__assign)({},t),{target:p,attachedFloatie:!0}),inputMethod:n,useSmallScreenlayout:o,menuTargetType:i})}}},showFloatie:function(e,t,n,o,r){var i=window.performance.now();if(!Object(MO.e)(kC.a.getState()))return function(a,s){var l,c;if(!Object(MO.e)(s())){var u=yT(e.target)?{left:e.target.x,top:e.target.y}:e.target,d=Object(MO.a)(s()),p=null===(l=Object(MO.b)(s())[d[0]])||void 0===l?void 0:l.type;Object(eT.b)("ShowReactFloatie",(function(){var e=d.toString(),t=e===dT;return dT=e,t}),t===Uy.a.Touch?"TouchFloatie-"+p:"NonTouchFloatie-"+p,r,null!==(c=null==r?void 0:r.sharedApiStartTime)&&void 0!==c?c:i),bT(a,{floatieLayout:Object(k.__assign)(Object(k.__assign)({},e),{target:u}),inputMethod:t,useSmallScreenlayout:n,menuTargetType:o})}}},hideContextMenu:function(){if(qO(kC.a.getState()))return function(e,t){qO(t())&&e(Object(HO.b)())}},hideContextualUI:function(){if(Object(MO.e)(kC.a.getState())||qO(kC.a.getState()))return function(e,t){(Object(MO.e)(t())||qO(t()))&&e(Object(yC.batchActions)([Object(HO.c)(),Object(HO.b)()]))}},hideFloatie:function(){if(Object(MO.e)(kC.a.getState()))return function(e,t){Object(MO.e)(t())&&e(Object(HO.c)())}},selectors:mI,getBlockedSmallScreenFloatieGroupList:xT.c,repositionContextualUI:function(e){return function(t){var n=yT(e)?{left:e.x,top:e.y}:e;vT(t,n)}}},vI=n(138),yI=n(219),xI=n(83),CI=Object(yI.a)({root:Object(k.__assign)({backgroundColor:"transparent"},xI.a.padding("0","8px"))}),SI=n(1079),EI=n(98),kI=function(e){var t,n=Object(tI.a)(dm.f.globalThemePaddingFix),o=(t=CI(),Object(vI.a)()?{fluentProviderProps:{className:t.root},themeProviderProps:{style:{background:"transparent"}}}:{});if(n){var r=o.fluentProviderProps,i=o.themeProviderProps;return O.createElement(SI.a,null,r&&i?O.createElement("div",{className:Object(EI.a)(r.className,i.className)},e.children):e.children)}return O.createElement(SI.a,Object(k.__assign)({},o),e.children)},OI=n(2314),TI={},II=function(e){return e.messageBar||TI},wI=Object(xr.a)([II],(function(e){return e.dismissIconProps})),_I=Object(xr.a)([II],(function(e){return e.typeIconsProps})),PI=Object(Ir.connect)((function(e,t){Object(Wm.j)("AppMessageBar");var n=void 0,o=_I(e);o&&(n=o[t.messageBarType||Ys.a.info]),t.messageBarIconProps&&(n=t.messageBarIconProps);var r={dismissIconProps:t.closeable?wI(e):void 0,messageBarIconProps:n,id:"AppMessageBar"};return Object(Wm.j)("AppMessageBar","NonCached"),r}),void 0,void 0,{areStatesEqual:Object(Tr.a)("MessageBar")})(Object(Or.a)(OI.a)),RI=function(e){return O.createElement(CC.a,null,O.createElement(PI,Object(k.__assign)({},e)))},DI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(cl.a,null,O.createElement(Ir.Provider,{store:kC.a},O.createElement(kI,null,O.createElement(RI,Object(k.__assign)({},this.props)))))},t}(O.Component);function jI(e,t){if(void 0===e&&(e=TI),null===e)return TI;switch(t.type){case dr.Cb:var n=t.payload.typeIconsProps;return n?Object(k.__assign)(Object(k.__assign)({},e),{typeIconsProps:n}):e;case dr.Bb:var o=t.payload.dismissIconProps;return o?Object(k.__assign)(Object(k.__assign)({},e),{dismissIconProps:o}):e;default:return e}}var BI=!1;var FI,LI={initializeMessageBarInStore:function(){var e,t,n;BI||(dy.b.register("messageBar",jI),Object(Wy.a)([(n={iconName:c.a.CancelGlyph_16},Object(ur.a)(dr.Bb,{dismissIconProps:n})),(e={},e[Ys.a.info]={iconName:d.a.AlertInfoLight_16},e[Ys.a.success]={iconName:d.a.AlertSuccess_16},e[Ys.a.warning]={iconName:d.a.AlertInfoLight_16},e[Ys.a.severeWarning]={iconName:d.a.AlertSevereWarning_16},e[Ys.a.error]={iconName:d.a.AlertError_16},e[Ys.a.blocked]={iconName:d.a.DrmStatus_16},t=e,Object(ur.a)(dr.Cb,{typeIconsProps:t}))]),i.a.sendTraceTag(587321818,a.a.msoulscat_ES_EWAJS,s.a.Info,"MessageBar store is initialized."),BI=!0)},createNewMessageBar:function(e,t){T.render(O.createElement(DI,Object(k.__assign)({},t)),e)},createNewMessageBarWithCallback:function(e,t,n){T.render(O.createElement(DI,Object(k.__assign)({},t)),e,n)}},MI=n(2339),AI=n(1446),NI={renderLiveMeetingBoundary:MI.a,renderLiveMeetingPill:AI.b},WI=n(440),HI={root:{backgroundColor:"#ffffff"},list:{fontSize:"12px"}},zI=function(e){return{root:{backgroundColor:e?WI.a.selectedBackgroundColor:"#ffffff",selectors:{":focus":{background:WI.a.hoverBackgroundColor+"!important"}}}}},VI=n(758),GI=[],UI=function(e){function t(t){var n=e.call(this,t)||this;n.tableTotalRowOptionSelected=function(e,t){return!!t&&(e&&i.a.sendTraceTag(595636250,a.a.msoulscat_ES_EWAJS,s.a.Verbose,"TableTotalRowOptions.tableTotalRowOptionSelected - Event : "+e.type),n.props.tableTotalRowOptionSelected(t.key))};var o=Object.keys(n.props.totalRowOptions);GI.splice(0,GI.length);for(var r=0,l=o;r<l.length;r++){var c=l[r],u=n.props.totalRowOptions[c],d={key:c,ariaLabel:u,text:u,itemProps:{styles:zI(!1)}};GI.push(d)}return n.state={previouslySelectedItem:"None",currentMenuItems:GI,currentButtonSize:17},n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement(Z.a,{content:ExcelRibbonStrings.TableTotalRowOptionsKeyTip,id:"TotalRowDropDownId",tooltipProps:{style:{overflowY:"auto",display:"block"},calloutProps:{isBeakVisible:!0,beakWidth:10},directionalHint:Y.a.topCenter,delay:VI.a.long}},O.createElement(po.a,{"data-is-focusable":!0,id:"TableTotalRowDropDownIconButtonId",allowDisabledFocus:!1,ariaLabel:ExcelRibbonStrings.TableTotalRowOptionsLabel,ariaDescription:ExcelRibbonStrings.TableTotalRowOptionsAriaDescription,tabIndex:0,styles:(e=this.state.currentButtonSize,{root:{position:"absolute",top:"0px",left:"0px",padding:"unset",height:e,width:e},flexContainer:{position:"absolute",top:"0px",left:"0px",height:e,width:e},icon:{display:"flex",position:"absolute",top:"0px",left:"0px",margin:"unset",height:e,width:e}}),iconProps:{iconName:W.a.DropdownArrowHover_16},menuTriggerKeyCode:z.a.alt&z.a.down,persistMenu:!0,primary:!0,menuProps:{gapSpace:0,focusZoneProps:{allowFocusRoot:!1,isCircularNavigation:!0,doNotAllowFocusEventToPropagate:!1,tabIndex:0,allowTabKey:!0},shouldFocusOnContainer:!1,shouldFocusOnMount:!0,styles:HI,onItemClick:this.tableTotalRowOptionSelected,items:this.state.currentMenuItems}}));var e},t.getDerivedStateFromProps=function(e,t){var n,o=[];return n=e.buttonSize!==t.currentButtonSize?e.buttonSize:t.currentButtonSize,e.selectedItem!==t.previouslySelectedItem?(GI.forEach((function(t){var n=t;n.text===e.selectedItem?n.itemProps={styles:zI(!0)}:n.itemProps={styles:zI(!1)},o.push(n)})),{currentMenuItems:o,currentButtonSize:n,previouslySelectedItem:e.selectedItem}):{currentMenuItems:GI,currentButtonSize:n}},t}(O.Component);function qI(e,t,n,o,r){T.render(O.createElement(UI,{totalRowOptions:t,selectedItem:n,buttonSize:o,tableTotalRowOptionSelected:r}),e)}var QI,KI,JI={root:{backgroundColor:qo.a.gray150,color:qo.a.gray40},subComponentStyles:{menuItem:{root:(FI={color:qo.a.gray40},FI[":active"]={backgroundColor:qo.a.gray120+" !important",color:qo.a.gray20},FI[":hover, :focus:hover, .ms-Fabric--isFocusVisible &:hover"]={backgroundColor:qo.a.gray140,color:qo.a.gray20},FI[".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus:hover"]={backgroundColor:qo.a.gray150,color:qo.a.gray20},FI)}}},ZI=function(e){var t=e.target,n=e.menuItems,o=e.toggleStateId,r=e.onShow,i=e.onHide,a=e.onRenderComplete,s=e.isPresentModeOn,l=O.useState(!1),c=l[0],u=l[1],d=O.useState(0),p=d[0],h=d[1];O.useLayoutEffect((function(){o===p&&c&&null!=a&&Object(CT.a)(a)}));var g=function(){u(!0),r()},m=function(){u(!1),i()};o!==p&&(c?m():g(),h(o));var f=Object(tT.b)(Vo.b.AllSheetsMenu,"FlyoutAnchorModel");return O.createElement("div",null,O.createElement(FT.a,{items:n,hidden:!c,target:t,onDismiss:m,onMenuOpened:function(){return Object(tT.c)(Vo.b.AllSheetsMenu,"FlyoutAnchorModel")({id:Vo.b.AllSheetsMenu})},onMenuDismissed:f,isBeakVisible:!1,shouldFocusOnMount:!0,styles:s?JI:{},calloutProps:{calloutMaxHeight:400,styles:{root:{animation:"none"}}}}))};function YI(e,t,n,o,r,i,a,s){T.render(O.createElement(ZI,{menuItems:n,target:t,toggleStateId:o,onShow:r,onHide:i,onRenderComplete:a,isPresentModeOn:s}),e)}var XI='"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',$I={root:[{position:"relative",height:"22px",width:"69px",marginTop:"4px"}],fieldGroup:[{border:"1px solid #C8C6C4",height:"26px",width:"110px"}],wrapper:[{fontFamily:XI,color:"#484644",lineHeight:"20px"}]},ew=function(e){var t,n;return{root:[{position:"relative",margin:"4px 8px 4px 4px",border:"1px solid rgba(0,0,0,0)",padding:"0px",height:"26px",background:"#107C41",alignSelf:"flex-start",selectors:(t={":active":{backgroundColor:"".concat(e.palette.themeDarkAlt)},":hover":{backgroundColor:"".concat(e.palette.themeDarkAlt)},":focus::after":{border:"1px solid white !important",outline:"2px solid ".concat(e.palette.themeDarkAlt),outlineOffset:"1px",borderRadius:"2px"}},t[V.m]={color:"HighlightText",backgroundColor:"Highlight",":focus::after":{outline:"none",border:"none"}},t)}],textContainer:[{fontWeight:"normal",color:"#FFFFFF",selectors:(n={},n[V.m]={color:"inherit"},n)}]}},tw=function(e){var t,n;return{root:[{position:"relative",margin:"4px 8px 4px 4px",border:"1px solid rgba(0,0,0,0)",padding:"0px",height:"26px",background:"#F3F2F1",alignSelf:"flex-start",selectors:(t={":active":{backgroundColor:"".concat(e.palette.neutralLighter)},":hover":{backgroundColor:"".concat(e.palette.neutralLighter)},":focus::after":{border:"1px solid ".concat(e.palette.neutralTertiaryAlt," !important"),outline:"2px solid ".concat(e.palette.neutralSecondaryAlt),outlineOffset:"1px",borderRadius:"2px"}},t[V.m]={":focus::after":{outline:"none",border:"none"}},t)}],textContainer:[{fontWeight:"normal",color:"#323130",selectors:(n={},n[V.m]={color:"inherit"},n)}]}},nw={root:[{paddingLeft:"0px",marginLeft:"0px",fontSize:"13px"}]},ow={root:[{boxShadow:"0px 3.2px 7.2px rgba(0, 0, 0, 0.13), 0px 0.6px 1.8px rgba(0, 0, 0, 0.1)",backgroundColor:"#FFFFFF"}]},rw={root:[{paddingLeft:"0px",marginLeft:"0px",marginBottom:"11px"}]},iw={root:[{position:"relative",minWidth:"110px",height:"32px",float:"right",top:"0px",bottom:"0px",border:"0px",boxSizing:"border-box",marginTop:"4px",padding:"6px 36px",background:"#107C41",alignSelf:"center",cursor:"pointer",selectors:(QI={":active":{backgroundColor:"#0F703B"},":hover":{backgroundColor:"#0F703B"}},QI[V.m]={color:"HighlightText",backgroundColor:"Highlight"},QI)}],textContainer:[{color:"#FFFFFF",fontFamily:XI,textAlign:"center",selectors:(KI={},KI[V.m]={color:"inherit"},KI)}],labelDisabled:[{color:"#EDEBE9"}],labelChecked:[{color:"#0C5F32"}]},aw=function(){return Object(V.eb)([{marginLeft:"12px",marginTop:"8px",position:"relative",display:"flex",right:"86px",left:"0px",fontFamily:XI,fontSize:"15px",lineHeight:"16px",color:"#22221E",order:0,fontWeight:V.l.semibold}])},sw=function(e){return Object(V.eb)([{direction:e?"rtl":"ltr",backgroundColor:"#F3F2F1",position:"relative",maxWidth:"312px",width:"312px",maxHeight:"132px",height:"132px",minHeight:"132px",overflow:"auto",border:"1px solid #BEBBB8",boxSizing:"border-box",margin:"6px 0px"}])},lw=function(e){return Object(V.eb)([{borderRight:e?"solid 1px /* @noflip */":"solid 0px /* @noflip */",borderLeft:e?"solid 0px /* @noflip */":"solid 1px /* @noflip */",borderColor:"#D2D0CE",minWidth:"60px",fontFamily:XI,fontStyle:"normal",fontWeight:"normal",padding:"3px",fontSize:"12px",color:"#252423",flex:"display"}])},cw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this.props.previewTableText,t=this.props.rowNumbers,n=this.props.isGridRtl;return O.createElement("pre",{className:sw(n),"aria-hidden":"true"},O.createElement("table",{className:Object(V.eb)([{borderCollapse:"separate",borderSpacing:"0px",height:"12px"}])},O.createElement("tbody",null,e.map((function(e,o){return O.createElement("tr",{className:Object(V.eb)([{border:"none",height:"12px"}]),key:o},O.createElement("td",{className:Object(V.eb)([{borderBottom:"solid 1px",borderColor:"#D2D0CE",minWidth:"12px",fontFamily:XI,fontStyle:"normal",fontWeight:"normal",padding:"3px",fontSize:"12px",color:"#252423",flex:"display"}])},t[o]),e.map((function(e,t){return O.createElement("td",{className:lw(n),key:t},e)})))})))))},t}(O.Component),uw=function(e){function t(t){var n=e.call(this,t)||this;return n.focusTrapZone=O.createRef(),n.focusZoneRef=O.createRef(),n.delimiters="delimiters",n.textToColumnsHeading=ExcelRibbonStrings.TextToColumns,n.applyButtonText=ExcelRibbonStrings.TextToColumnsApply,n.previewText=ExcelRibbonStrings.TextToColumnsPreview,n.chooseDelimiters=ExcelRibbonStrings.TextToColumnsSelectDelimiters,n.partialDataText=ExcelRibbonStrings.TextToColumnsPartialDataText,n.customDelimiterPlaceHolder=ExcelRibbonStrings.TextToColumnsCustomDelimiterPlaceHolder,n.textToColumnsDelimiterCustom=ExcelRibbonStrings.TextToColumnsDelimiterCustom,n.selectedAriaLabel=ExcelRibbonStrings.TextToColumnsDelimitersSelectedAriaLabel,n.unSelectedAriaLabel=ExcelRibbonStrings.TextToColumnsDelimitersUnSelectedAriaLabel,n.calloutGap=2,n.splitTextKey="splitText",n.partialDataKey="isPartial",n.rowNumbersKey="rowNumbers",n.previewTableKey="previewTableKey",n.delimitersArr=[ExcelRibbonStrings.TextToColumnsDelimiterTab,ExcelRibbonStrings.TextToColumnsDelimiterSemicolon,ExcelRibbonStrings.TextToColumnsDelimiterComma,ExcelRibbonStrings.TextToColumnsDelimiterSpace,n.textToColumnsDelimiterCustom],n.delimitersArrKey=["Tab","Semicolon","Comma","Space","Custom"],n.hasListeners=!1,n.preview={splitText:[[""]],isPartial:!1,rowNumbers:[0]},n.focus=function(){var e=document.querySelector("button#"+n.delimitersArrKey[0]);n.focusZoneRef.current&&n.focusZoneRef.current.focusElement(e)},n.setInitialFocus=function(e){n.async.requestAnimationFrame((function(){return n.focus()}))},n.calloutDismissed=function(){n.setState({isVisible:!1}),n.removeListeners(),n.props.OnCalloutDismissHandler()},n.customDelimiterChanged=function(e,t){if(n.setState({customDelimiter:t}),null!=(null==t?void 0:t.length)){var o=(null==t?void 0:t.length)>0;n.setState((function(e){var t;return{delimiterButtons:Object(k.__assign)(Object(k.__assign)({},e.delimiterButtons),(t={},t[n.textToColumnsDelimiterCustom]=o,t))}}))}},n.onApplyClicked=function(){var e;n.setState({isVisible:!1}),n.removeListeners(),n.props.OnCalloutDismissHandler(),n.props.OnApplyTextToColumns(n.state.delimiterButtons,null!==(e=n.state.customDelimiter)&&void 0!==e?e:"")},n.onDelimiterButtonChange=function(e){n.setState((function(t){var n;return{delimiterButtons:Object(k.__assign)(Object(k.__assign)({},t.delimiterButtons),(n={},n[e.id]=!t.delimiterButtons[e.id],n))}}))},n.onMouseWheel=function(e){void 0!==e&&n.calloutWrapperElement.current&&!Object(_n.a)(n.calloutWrapperElement.current,e.target)&&e.preventDefault()},n.getDelimiterAriaLabel=function(e){var t="";return"0"===e&&(t=n.textToColumnsHeading+" "+n.chooseDelimiters+" "),t+=n.delimitersArr[e]+" ",t+=n.state.delimiterButtons[n.delimitersArrKey[e]]?n.selectedAriaLabel:n.unSelectedAriaLabel},n.async=new Ia.a(n),n.calloutWrapperElement=O.createRef(),n.state={isVisible:!0,customDelimiter:"",delimiterButtons:n.delimitersArrKey.reduce((function(e,t){var o;return Object(k.__assign)(Object(k.__assign)({},e),((o={})[t]=n.selectAutomaticDelimiter(t),o))}),{})},n.onDelimiterButtonChange=n.onDelimiterButtonChange.bind(n),n.getDelimiterAriaLabel=n.getDelimiterAriaLabel.bind(n),n}return Object(k.__extends)(t,e),t.prototype.render=function(){return O.createElement("div",{ref:this.calloutWrapperElement},O.createElement(wn.a,{role:"alertdialog",className:Object(V.eb)([{display:"flex",flexDirection:"column",position:"absolute",padding:"12px 12px 12px 12px",alignItems:"center"}]),styles:ow,target:this.props.anchorElement,isBeakVisible:!1,hidden:!this.state.isVisible,onDismiss:this.calloutDismissed,setInitialFocus:!0,gapSpace:this.calloutGap,directionalHint:Y.a.rightTopEdge},O.createElement(Gy.a,{componentRef:this.focusTrapZone,id:"TextToColumnsContextualCalloutFocus",forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!1},O.createElement(Da.a,{componentRef:this.focusZoneRef,direction:Zt.a.bidirectional,isCircularNavigation:!0,allowTabKey:!0},O.createElement(uo.a,{className:aw(),styles:rw},this.textToColumnsHeading),O.createElement(td.a,null,O.createElement(po.a,{type:"AppIconButtonProps",iconProps:Object(co.a)(c.a.CancelGlyph_16),className:Object(V.eb)([{cursor:"pointer",position:"fixed",top:"0px",right:"0px",height:"32px",maxWidth:"32px",border:"none",color:"black",overflow:"hidden",selectors:{":hover":{backgroundColor:"#F3F2F1"}}}]),onClick:this.calloutDismissed,ariaLabel:ExcelRibbonStrings.Close,customTooltip:ExcelRibbonStrings.Close,id:"Close"})),O.createElement(uo.a,{className:aw(),styles:nw},this.chooseDelimiters),this.renderTextToColumnsDelimitersItems(),this.renderPreview(),this.renderPartialDataIndicator(),O.createElement($t.a,{type:"AppButtonProps",styles:iw,onExecute:this.onApplyClicked,id:this.applyButtonText,label:this.applyButtonText,key:this.applyButtonText})))))},t.prototype.renderTextToColumnsDelimitersItems=function(){var e=this,t=O.createElement(Bo.a,null,(function(t){var n=e.delimitersArrKey.map((function(n,o){return O.createElement($t.a,{id:n,fullDescriptionLabel:e.getDelimiterAriaLabel(o),type:"AppButtonProps",styles:e.state.delimiterButtons[n]?ew(t):tw(t),label:e.delimitersArr[o],key:n,onExecute:e.onDelimiterButtonChange})}));return n.push(e.renderCustomDelimiterTextBox()),n}));return O.createElement("div",{id:this.delimiters,className:Object(V.eb)([{display:"flex",flexDirection:"row",flexWrap:"wrap",position:"static",alignSelf:"flex-start",marginTop:"4px",maxWidth:"312px"}])},t)},t.prototype.renderCustomDelimiterTextBox=function(){return O.createElement("div",{className:Object(V.eb)([{boxSizing:"border-box",position:"relative",background:"#FFFFFF",fontSize:"4px",bottom:"0px",borderRadius:"2px",flex:"none",alignSelf:"flex-start",marginBottom:"4px"}])},O.createElement(D.a,{className:Object(V.eb)([{position:"absolute",bottom:0,fontSize:"2px",display:"flex"}]),styles:$I,value:this.state.customDelimiter,maxLength:1,onChange:this.customDelimiterChanged,placeholder:this.customDelimiterPlaceHolder,ariaLabel:this.customDelimiterPlaceHolder}))},t.prototype.renderPreview=function(){var e;return this.preview=this.props.GenerateTextToColumnsPreview(this.state.delimiterButtons,null!==(e=this.state.customDelimiter)&&void 0!==e?e:""),[O.createElement(uo.a,{className:aw(),key:this.previewText,styles:nw},this.previewText),O.createElement(cw,{previewTableText:this.preview[this.splitTextKey],rowNumbers:this.preview[this.rowNumbersKey],key:this.previewTableKey,isGridRtl:this.props.isGridRtl})]},t.prototype.renderPartialDataIndicator=function(){return this.preview[this.partialDataKey]?[O.createElement("div",{className:Object(V.eb)([{height:"16px",left:"25.18px",fontFamily:XI,fontSize:"12px",lineHeight:"14px",color:"#545454",flex:"display",alignSelf:"center",marginTop:"6px",marginLeft:"0px"}]),style:{display:"flex"},key:this.partialDataKey},O.createElement(H.a,{iconName:W.a.Info_20,className:Object(V.eb)([{position:"relative",height:"16px",marginRight:"2px",maxWidth:"20px",color:"#545454",flex:"none",marginLeft:"0px",filter:"grayscale(100%)"}]),style:{color:"black"}}),this.partialDataText)]:[]},t.prototype.componentWillReceiveProps=function(e){e.isVisible!==this.state.isVisible&&(this.setState({isVisible:!0}),this.addListeners(),this.focus())},t.prototype.componentDidMount=function(){this.addListeners(),this.setInitialFocus()},t.prototype.addListeners=function(){this.hasListeners||(window.document.body.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(window.document.body.removeEventListener("wheel",this.onMouseWheel),this.hasListeners=!1)},t.prototype.selectAutomaticDelimiter=function(e){var t=!1;return this.props.automaticDelimiter.forEach((function(n){e===n&&(t=!0)})),t},t}(O.Component);function dw(e,t,n,o,r,i){T.render(O.createElement(uw,{anchorElement:e,isVisible:!0,OnApplyTextToColumns:t,GenerateTextToColumnsPreview:n,OnCalloutDismissHandler:o,isGridRtl:r,automaticDelimiter:i}),e)}var pw=n(1280),hw=function(e){var t=e.target,n=e.styles,o=e.onIgnore,r=e.onCardMount,i=e.children,a=e.calloutStyles,s=O.useCallback((function(e){e&&r&&(e.focus=function(){return Object(ua.c)(e)},r(e))}),[r]);return O.createElement(pw.a,{onKeyDownCapture:function(e){"Escape"===e.key&&o()},isBeakVisible:!1,target:t,focusTrapProps:{isClickableOutsideFocusTrap:!0,disableFirstFocus:!0,forceFocusInsideTrap:!1},directionalHint:Y.a.rightTopEdge,directionalHintForRTL:Y.a.leftTopEdge,gapSpace:5,style:n,styles:a},O.createElement("div",{ref:s},i))},gw=Object(Po.c)((function(e){var t={marginBottom:7,minWidth:200,maxWidth:400,overflowWrap:"break-word"};return{ShowFormulaButtonStyles:{root:{color:e.palette.themePrimary,height:20,paddingInlineStart:0},label:{margin:0}},bodyContentStyle:t}})),mw={Apply:ExcelRibbonStrings.FormulaByExampleApply,Ignore:ExcelRibbonStrings.FormulaByExampleIgnore,Title:ExcelRibbonStrings.FormulaByExampleTitle,GiveFeedback:ExcelRibbonStrings.FormulaByExampleGiveFeedback,Body:ExcelRibbonStrings.FormulaByExampleBody,SumBody:ExcelRibbonStrings.FormulaByExampleSumBody,DifferenceBody:ExcelRibbonStrings.FormulaByExampleDifferenceBody,ShowFormula:ExcelRibbonStrings.FormulaByExampleShowFormula,HideFormula:ExcelRibbonStrings.FormulaByExampleHideFormula},fw=function(e){var t=e.formula,n=e.range,o=e.target,r=e.onApply,i=e.onIgnore,a=e.onGiveFeedback,s=e.onShowFormula,l=e.onCardMount,c=Object(pf.a)(),u=gw(c),d=Object(Dk.a)(!1),p=d[0],h=d[1].toggle,g=O.useMemo((function(){return function(e){var t=e.match(/^=[^\[\]\s]+\[@\[([^\[\]]+)\]\] ([-+]) [^\[\]\s]+\[@\[([^\[\]]+)\]\]$/);if(t){var n=t[1],o=t[2],r=t[3];if(n===r)return mw.Body;switch(o){case"+":return O.createElement(lb.a,{message:mw.SumBody,values:[O.createElement("b",{key:"column1"},n),O.createElement("b",{key:"column2"},r)]});case"-":return O.createElement(lb.a,{message:mw.DifferenceBody,values:[O.createElement("b",{key:"column1"},n),O.createElement("b",{key:"column2"},r)]})}}return mw.Body}(t)}),[t]);return O.createElement(hw,{target:o,onApply:r,onIgnore:i,onCardMount:l},O.createElement(nb,{showIgnore:!0,title:mw.Title,applyString:mw.Apply,onApply:r,onIgnore:i,ignoreString:mw.Ignore,onClose:i,range:n,handleTab:Zt.b.all,otherActions:a&&[{text:mw.GiveFeedback,onClick:a,key:"FormulaSuggestionCardGivefeedback"}]},O.createElement(uo.a,{block:!0,style:u.bodyContentStyle},p?t:g),O.createElement(be.a,{styles:u.ShowFormulaButtonStyles,onClick:function(){p||null==s||s(),h()}},p?mw.HideFormula:mw.ShowFormula)))};function bw(e,t,n,o,r,i,a,s,l){T.render(O.createElement(fw,{formula:e,range:t,target:o,onApply:r,onIgnore:i,onGiveFeedback:a,onShowFormula:s,onCardMount:l}),n)}var vw=Object(Po.c)((function(e){return{ShowFormulaButtonStyles:{root:{color:e.palette.themePrimary,height:20,paddingInlineStart:0},label:{margin:0}},bodyContentStyle:{marginBottom:7,minWidth:200}}})),yw={Apply:"OK",Ignore:ExcelRibbonStrings.FormulaByExampleIgnore,Title:"You've received an answer",ShowDetails:"Show Details",HideDetails:"Hide Details"},xw=function(e){var t=e.result,n=e.tag,o=e.description,r=e.target,i=e.onApply,a=e.onIgnore,s=e.onCardMount,l=Object(pf.a)(),c=vw(l),u=Object(Dk.a)(!1),d=u[0],p=u[1].toggle;return O.createElement(hw,{target:r,onApply:i,onIgnore:a,onCardMount:s},O.createElement(nb,{title:yw.Title,applyString:yw.Apply,onApply:i,onIgnore:a,ignoreString:yw.Ignore,onClose:a,range:n,handleTab:Zt.b.all},O.createElement(uo.a,{block:!0,style:c.bodyContentStyle},d?o:t),O.createElement(be.a,{styles:c.ShowFormulaButtonStyles,onClick:function(){p()}},d?yw.HideDetails:yw.ShowDetails)))};function Cw(e,t,n,o,r,i,a,s,l){T.render(O.createElement(xw,{result:e,tag:t,description:n,target:r,onApply:i,onIgnore:a,onShowDetails:s,onCardMount:l}),o)}var Sw={Title:ExcelRibbonStrings.ExcelIntelligenceTitle,Body:ExcelRibbonStrings.ExcelIntelligenceBody},Ew=Object(Po.c)((function(e){return{calloutStyles:{root:{borderRadius:8,boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}},cardStyle:{background:e.palette.white,width:180,height:68,borderRadius:8},stackStyle:{paddingLeft:12,paddingTop:8,paddingRight:8,paddingBottom:8},titleContentStyle:{color:e.palette.black,padding:0,fontFamily:"Segoe UI",fontWeight:600,fontSize:14},bodyContentStyle:{color:e.palette.black,padding:0,fontFamily:"Segoe UI",fontWeight:400,fontSize:12},closeButtonStyles:{root:{width:8.5,height:8.5}}}})),kw=function(e){var t=e.target,n=e.onApply,o=e.onIgnore,r=e.onCancel,i=e.onCardMount,a=Object(pf.a)(),s=Ew(a),l=Object(dg.a)()?c.a.CancelGlyphWhite_16:c.a.CancelGlyph_16,u=O.useState(!1),d=u[0],p=u[1],h={backgroundColor:d?a.palette.themeLight:a.palette.white};return O.createElement(hw,{target:t,styles:Object(k.__assign)(Object(k.__assign)({},s.cardStyle),h),onApply:n,onIgnore:o,onCardMount:i,calloutStyles:s.calloutStyles},O.createElement(Da.a,{onMouseEnter:function(){p(!0)},onMouseLeave:function(){p(!1)}},O.createElement(Qe.a,{horizontalAlign:"end"},Tw(d,l,r,s.closeButtonStyles)),O.createElement(Qe.a,{onClick:n,style:s.stackStyle},O.createElement(Ge.a,{style:s.titleContentStyle},Sw.Title),O.createElement(uo.a,{block:!0,style:s.bodyContentStyle},Sw.Body))))};function Ow(e,t,n,o,r,i){T.render(O.createElement(kw,{target:t,onApply:n,onIgnore:o,onCancel:r,onCardMount:i}),e)}var Tw=function(e,t,n,o){return e?O.createElement(Ba.a,{iconProps:{iconName:t},onClick:n,style:{position:"absolute",top:14,right:12},styles:o}):O.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMyAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTguMDYwNjMgMTUuNzAxMUM4LjMzNTM1IDE1Ljg5NTUgOC42NjM1OSAxNi4wMDAxIDkuMDAwMTggMTYuMDAwM0M5LjMxNjQyIDE2LjAwMDIgOS42MjU3OCAxNS45MDc5IDkuODkwNCAxNS43MzQ4QzEwLjE1NSAxNS41NjE2IDEwLjM2MzQgMTUuMzE1MSAxMC40OTAyIDE1LjAyNTNMMTEuMjU5MiAxMi42ODUzQzExLjQ0NjggMTIuMTIyNCAxMS43NjI5IDExLjYxMDggMTIuMTgyNCAxMS4xOTEyQzEyLjYwMTkgMTAuNzcxNSAxMy4xMTMzIDEwLjQ1NTIgMTMuNjc2MiAxMC4yNjczTDE1LjkxNDIgOS41NDAzM0MxNi4yMzE5IDkuNDI5IDE2LjUwNjggOS4yMjA5MiAxNi43MDAyIDguOTQ1MzNDMTYuODQ4OSA4LjczNTkzIDE2Ljk0NTcgOC40OTQxOSAxNi45ODI2IDguMjQwMDVDMTcuMDE5NSA3Ljk4NTkgMTYuOTk1NiA3LjcyNjYyIDE2LjkxMjcgNy40ODM1NUMxNi44Mjk4IDcuMjQwNDkgMTYuNjkwMyA3LjAyMDYgMTYuNTA1NyA2Ljg0MkMxNi4zMjEyIDYuNjYzNDEgMTYuMDk2OCA2LjUzMTIyIDE1Ljg1MTIgNi40NTYzM0wxMy42MzYyIDUuNzM2MzNDMTMuMDczIDUuNTQ5NTkgMTIuNTYxMSA1LjIzNDIxIDEyLjE0MSA0LjgxNTE5QzExLjcyMSA0LjM5NjE3IDExLjQwNDMgMy44ODUwMyAxMS4yMTYyIDMuMzIyMzNMMTAuNDg5MiAxLjA4NTMzQzEwLjM3NzMgMC43Njg0NDUgMTAuMTY5NyAwLjQ5NDE0MSA5Ljg5NTE4IDAuMzAwMzI4QzkuNjE4OTEgMC4xMDk4MjggOS4yOTEyNiAwLjAwNzgxMjUgOC45NTU2OCAwLjAwNzgxMjVDOC42MjAxIDAuMDA3ODEyNSA4LjI5MjQ1IDAuMTA5ODI4IDguMDE2MTggMC4zMDAzMjhDNy43MzcxNiAwLjQ5NzM5NSA3LjUyNzI0IDAuNzc3Mjg3IDcuNDE2MTggMS4xMDAzM0w2LjY3OTE4IDMuMzY1MzNDNi40OTE0OSAzLjkxMzMxIDYuMTgxNTUgNC40MTEzOSA1Ljc3Mjg0IDQuODIxODRDNS4zNjQxMyA1LjIzMjI4IDQuODY3MzYgNS41NDQzMyA0LjMyMDE4IDUuNzM0MzNMMi4wODAxOCA2LjQ2MTMzQzEuNzYxNDQgNi41NzQgMS40ODU3NCA2Ljc4MzIyIDEuMjkxNDUgNy4wNTk4OEMxLjA5NzE2IDcuMzM2NTQgMC45OTM5MjggNy42NjY4OSAwLjk5NjEyOCA4LjAwNDk1QzAuOTk4MzI4IDguMzQzMDEgMS4xMDU4NSA4LjY3MTk4IDEuMzAzNzIgOC45NDYwOUMxLjUwMTYgOS4yMjAyIDEuNzggOS40MjU4MSAyLjEwMDE4IDkuNTM0MzNMNC4zMTYxOCAxMC4yNTMzQzQuODgxMSAxMC40NDIzIDUuMzk0NTQgMTAuNzU5NiA1LjgxNjE4IDExLjE4MDNDNS45MjkxNCAxMS4yOTM0IDYuMDM0NyAxMS40MTM3IDYuMTMyMTggMTEuNTQwM0M2LjM5ODAzIDExLjg4MjggNi42MDMwMSAxMi4yNjg0IDYuNzM4MTggMTIuNjgwM0w3LjQ2NjE4IDE0LjkxNDNDNy41NzgyNCAxNS4yMzE3IDcuNzg1OTIgMTUuNTA2NiA4LjA2MDYzIDE1LjcwMTFaTTE3LjgwNDMgMjEuNzgxNUMxOC4wMDc4IDIxLjkyNDggMTguMjUwOSAyMi4wMDEzIDE4LjQ5OTkgMjIuMDAwM0MxOC43NDczIDIyLjAwMTQgMTguOTg5IDIxLjkyNiAxOS4xOTE5IDIxLjc4NDNDMTkuNDAwMiAyMS42MzY1IDE5LjU1NjMgMjEuNDI2NCAxOS42Mzc5IDIxLjE4NDNMMjAuMDA5OSAyMC4wNDEzQzIwLjA4ODUgMTkuODA0IDIwLjIyMTQgMTkuNTg4MyAyMC4zOTc5IDE5LjQxMTNDMjAuNTc0NSAxOS4yMzQyIDIwLjc4OTggMTkuMTAwNyAyMS4wMjY5IDE5LjAyMTNMMjIuMTkyOSAxOC42NDMzQzIyLjQyODQgMTguNTU5NyAyMi42MzI0IDE4LjQwNTMgMjIuNzc2OSAxOC4yMDEzQzIyLjkyMTggMTcuOTk4IDIyLjk5OTcgMTcuNzU0NSAyMi45OTk3IDE3LjUwNDhDMjIuOTk5NyAxNy4yNTUxIDIyLjkyMTggMTcuMDExNyAyMi43NzY5IDE2LjgwODNDMjIuNjIzMiAxNi41OTYxIDIyLjQwNTYgMTYuNDM4NyAyMi4xNTU5IDE2LjM1OTNMMjEuMDExOSAxNS45ODgzQzIwLjc3NDYgMTUuOTA5NyAyMC41NTg4IDE1Ljc3NjggMjAuMzgxOCAxNS42MDAzQzIwLjIwNDcgMTUuNDIzNyAyMC4wNzEyIDE1LjIwODQgMTkuOTkxOSAxNC45NzEzTDE5LjYxMjkgMTMuODA4M0MxOS41MzExIDEzLjU3MDYgMTkuMzc2OCAxMy4zNjQ2IDE5LjE3MTcgMTMuMjE5M0MxOC45NjY2IDEzLjA3NCAxOC43MjEgMTIuOTk2NyAxOC40Njk2IDEyLjk5ODVDMTguMjE4MiAxMy4wMDAzIDE3Ljk3MzggMTMuMDgwOSAxNy43NzA3IDEzLjIyOTFDMTcuNTY3NiAxMy4zNzczIDE3LjQxNjIgMTMuNTg1NSAxNy4zMzc5IDEzLjgyNDNMMTYuOTYzOSAxNC45NzAzQzE2Ljg4NzMgMTUuMjA0NiAxNi43NTc5IDE1LjQxODEgMTYuNTg1OCAxNS41OTQ0QzE2LjQxMzYgMTUuNzcwOCAxNi4yMDMyIDE1LjkwNTIgMTUuOTcwOSAxNS45ODczTDE0LjgwNDkgMTYuMzY1M0MxNC41NjkzIDE2LjQ0OSAxNC4zNjUzIDE2LjYwMzQgMTQuMjIwOSAxNi44MDczQzE0LjA3NTkgMTcuMDEwNyAxMy45OTggMTcuMjU0MiAxMy45OTggMTcuNTAzOEMxMy45OTggMTcuNzUzNSAxNC4wNzU5IDE3Ljk5NyAxNC4yMjA5IDE4LjIwMDNDMTQuMzY5NSAxOC40MDcgMTQuNTc5NCAxOC41NjE3IDE0LjgyMDkgMTguNjQyM0wxNS45NjQ5IDE5LjAxNDNDMTYuMjAzMiAxOS4wOTMyIDE2LjQxOTYgMTkuMjI2OCAxNi41OTY5IDE5LjQwNDVDMTYuNzc0MyAxOS41ODIyIDE2LjkwNzUgMTkuNzk4OSAxNi45ODU5IDIwLjAzNzNMMTcuMzYzOSAyMS4yMDAzQzE3LjQ0NjggMjEuNDM1MSAxNy42MDA4IDIxLjYzODEgMTcuODA0MyAyMS43ODE1WiIgZmlsbD0idXJsKCNwYWludDBfbGluZWFyXzE0MzVfNjE4NzUpIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMTQzNV82MTg3NSIgeDE9IjgiIHkxPSIxLjU2OTZlLTA3IiB4Mj0iMTcuNTExMyIgeTI9IjIxLjk5NTEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjAxNTYyNSIgc3RvcC1jb2xvcj0iIzEwN0M0MSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNENEVCOTQiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K",style:{position:"absolute",top:9,right:14}})},Iw=n(408),ww=Object(PO.b)(),_w=Object(V.eb)({maxWidth:"320px",padding:"12px",borderRadius:"4px",background:ww.palette.white}),Pw=Object(V.eb)({fontSize:16,paddingRight:10,height:16}),Rw={buttonStyles:{root:{borderRadius:4,padding:"8px 12px",height:"auto",minWidth:"auto",marginRight:"8px",marginBottom:"2px"},rootHovered:Ds.o,rootFocused:Ds.o},descriptionStyle:{root:{paddingBottom:"16px",paddingTop:"8px",fontSize:"12px",display:"inline-block"}},linkStyle:{root:{fontSize:"10px"}}},Dw={rootHovered:Ds.o,rootFocused:Ds.o,rootExpanded:Ds.o},jw={More:c.a.EllipsisExcel_16,TableDesignIdeas:W.a.TableDesignIdeas_16,WrapText:W.a.WrapText_16},Bw=function(e){var t=e.target,n=e.title,o=e.description,r=e.primaryButtonText,i=e.secondaryButtonText,a=e.onPrimaryAction,s=e.onSecondaryAction,l=e.menuItems,c=void 0===l?[]:l,u=e.onMouseEnter,d=e.onMouseLeave,p=e.icon,h=void 0===p?"":p,g=e.direction,m=void 0===g?7:g,f=e.gapSpace,b=void 0===f?5:f,v=e.onDismiss,y=e.createPrimaryBtnRef,x=e.setInitialFocus,C=e.ariaLabel,S=e.giveFeedbackLinkText,E=e.onGiveFeedbackLinkAction,k=h.length>0,T=m,I={items:c};return O.createElement(wn.a,{className:_w,onDismiss:v,onMouseEnter:u,onMouseLeave:d,onFocus:u,onBlur:d,target:t,isBeakVisible:!1,directionalHint:T,gapSpace:b,role:"alert",ariaLabel:C,ariaDescribedBy:"proactive-suggestion-description",setInitialFocus:x},O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"start"},k&&O.createElement(Iw.a,{iconName:jw[h],className:Pw}),O.createElement("h1",{style:{verticalAlign:"top",textAlign:"start",height:"20px",fontWeight:"600",fontSize:"14px",marginBlock:"0px"}},n)),O.createElement(uo.a,{styles:Rw.descriptionStyle,id:"proactive-suggestion-description"},o),O.createElement(Da.a,{isCircularNavigation:!0,handleTabKey:Zt.b.all},O.createElement(Qe.a,{horizontal:!0,horizontalAlign:"start"},O.createElement(ma.a,{styles:Rw.buttonStyles,onClick:a,componentRef:y},r),O.createElement(rn.a,{styles:Rw.buttonStyles,onClick:s},i),!!c.length&&O.createElement(Kt.a,{title:ExcelRibbonStrings.OverflowWellLabel,id:"proactive-suggestion-more",menuProps:I,menuIconProps:{iconName:jw.More},style:{marginInlineStart:"auto"},styles:Dw,ariaLabel:ExcelRibbonStrings.OverflowWellLabel})),!!S&&!!E&&O.createElement(et.a,{onClick:E,styles:Rw.linkStyle},S)))};function Fw(e,t,n,o,r,i,a,s,l,c,u,d,p,h,g,m,f,b,v,y){T.render(O.createElement(Bw,{target:e,title:n,description:o,primaryButtonText:r,secondaryButtonText:i,onPrimaryAction:a,onSecondaryAction:s,menuItems:l,onMouseEnter:c,onMouseLeave:u,icon:d,direction:p,gapSpace:h,onDismiss:g,createPrimaryBtnRef:m,setInitialFocus:f,ariaLabel:b,giveFeedbackLinkText:v,onGiveFeedbackLinkAction:y}),t)}var Lw=Object(PO.b)(),Mw=Object(V.eb)({maxWidth:"320px",padding:"12px",borderRadius:"4px",background:Lw.palette.white}),Aw=function(e){var t=e.target,n=e.offset,o=O.useState(),r=o[0],i=o[1];return O.useEffect((function(){function e(){i({left:t.getBoundingClientRect().right-n,top:t.getBoundingClientRect().bottom-n})}e();var o=new xc;return o.register([t],e),function(){return o.dispose()}}),[t,n]),O.createElement(wn.a,{className:Mw,coverTarget:!0,directionalHint:Y.a.bottomRightEdge,target:r,isBeakVisible:!1},"Proactive Suggestion Debug Pane",O.createElement("table",null,O.createElement("tbody",null,O.createElement("tr",null,O.createElement("td",null,"If LPP is blocking triggers, you may need to clear local storage"),O.createElement("td",null,O.createElement(ma.a,{onClick:function(){localStorage.clear(),location.reload()},text:"Clear local storage"}))))))};function Nw(e,t,n){T.render(O.createElement(Aw,{target:t,offset:n}),e)}var Ww={},Hw=Object(xr.a)([function(e){return e.statusBarModels||Ww},function(e,t){return t.id}],(function(e,t){return e[t]})),zw=Object(xr.a)([Hw],(function(e){return null==e?void 0:e.controls})),Vw=Object(xr.a)([Hw],(function(e){return(null==e?void 0:e.endRegionPrimaryScreenControlsIds)||[]})),Gw=Object(xr.a)([Hw],(function(e){return(null==e?void 0:e.scalingSteps)||[]})),Uw=Object(xr.a)([Hw],(function(e){return(null==e?void 0:e.appliedScalingSteps)||{}})),qw=Object(xr.a)([Hw],(function(e){return(null==e?void 0:e.appliedScalingStepsCount)||0})),Qw=Object(xr.a)([Hw],(function(e){return null==e?void 0:e.zoomControlModel})),Kw=function(e,t,n,o){var r=Object(Sr.c)(t,n,e,o),i="";switch(r.type){case"AppButtonProps":i="StatusBarButtonProps";break;case"AppToggleButtonProps":i="StatusBarToggleButtonProps";break;case"AppLabelProps":i="StatusBarLabelProps";break;case"AppFlyoutAnchorProps":return Object(k.__assign)(Object(k.__assign)({},r),{type:"StatusBarFlyoutAnchorProps",downChevronIcon:Object(Hx.a)().downChevron.icon8});case"AppSliderProps":return Object(k.__assign)(Object(k.__assign)({},r),{type:"StatusBarSliderProps"});default:throw new Error("The control of type ".concat(r.type," is not a valid StatusBar control"))}return Object(k.__assign)(Object(k.__assign)({},r),{type:i})},Jw=Object(VO.a)((function(e,t,n,o){return{id:e.id,type:"StatusBarZoomControlProps",decreaseZoomButtonProps:Kw(e.decreaseZoomControlId,t,n,o),zoomLabelProps:Kw(e.zoomLabelId,t,n,o),zoomSliderProps:Kw(e.zoomSliderId,t,n,o),zoomLevelButtonProps:Kw(e.zoomLevelButtonId,t,n,o),increaseZoomButtonProps:Kw(e.increaseZoomControlId,t,n,o),showSlider:e.showSlider}})),Zw=Object(xr.a)([zw,Qw,Cr.U,Cr.u,Cr.bb],(function(e,t,n,o,r){return Yw(e,t,n,o,r)})),Yw=Object(VO.a)((function(e,t,n,o,r){var i={left:[],center:[],right:[]};return e&&Object.keys(e).forEach((function(a){i[a]=function(e,t,n,o,r){return e?e.filter((function(e){return t&&t.id===e?!t.hidden:!Object(Cr.Db)(n,o,e)})).map((function(e){return t&&t.id===e?Jw(t,n,o,r):Kw(e,n,o,r)})):[]}(e[a],t,n,o,r)})),i})),Xw=Object(xr.a)([zw,Qw],(function(e,t){var n;return e?t?(n=[t.decreaseZoomControlId,t.zoomLabelId,t.zoomSliderId,t.zoomLevelButtonId,t.increaseZoomControlId]).concat.apply(n,Object.keys(e).map((function(t){return e[t]}))).filter((function(e){return e!==t.id})):[].concat.apply([],Object.keys(e).map((function(t){return e[t]}))):[]})),$w=Object(xr.a)([Xw,Cr.u],(function(e,t){var n={};return e.forEach((function(e){var o=Object(Cr.p)(t,e);n[e]=o.modelType})),n}));var e_=Object(KS.strEnum)(["ExcelViewerToolbar","ExcelStatusBar"]),t_=function(e){return{getStatusBarControlsMap:function(t){return $w(e.getState(),{id:t})}}}(kC.a),n_=n(151),o_=n(92),r_=n(87),i_=n(2190);function a_(e,t){return Object(ur.a)(dr.w,{id:e,controls:t})}function s_(e,t){return Object(ur.a)(dr.y,{statusBarId:e,controlId:t})}function l_(e,t){var n,o,r,i,a,s,l,c;if(void 0===e&&(e={}),null===e)return{};switch(t.type){case dr.w:var u=t.payload,d=u.id,p=u.controls;return d&&p?Object(k.__assign)(Object(k.__assign)({},e),((n={})[d]={controls:p},n)):e;case dr.x:var h=t.payload,g=h.statusBarId,m=h.region,f=h.controlId;if(g&&e[g]&&m&&f){var b=Object(k.__assign)(Object(k.__assign)({},e[g].controls),((o={})[m]=Object(k.__spreadArray)(Object(k.__spreadArray)([],e[g].controls[m],!0),[f],!1),o));return Object(k.__assign)(Object(k.__assign)({},e),((r={})[g]=Object(k.__assign)(Object(k.__assign)({},e[g]),{controls:b}),r))}return e;case dr.y:var v=t.payload;g=v.statusBarId,f=v.controlId;if(g&&e[g]&&f){var y=Object(k.__spreadArray)(Object(k.__spreadArray)([],e[g].endRegionPrimaryScreenControlsIds||[],!0),[f],!1);return Object(k.__assign)(Object(k.__assign)({},e),((i={})[g]=Object(k.__assign)(Object(k.__assign)({},e[g]),{endRegionPrimaryScreenControlsIds:y}),i))}return e;case dr.Nb:var x=t.payload,C=(g=x.statusBarId,x.scalingSteps);return g&&e[g]&&C?Object(k.__assign)(Object(k.__assign)({},e),((a={})[g]=Object(k.__assign)(Object(k.__assign)({},e[g]),{scalingSteps:C}),a)):e;case dr.E:var S=t.payload,E=(g=S.statusBarId,S.zoomControlModel);return g&&e[g]&&E?Object(k.__assign)(Object(k.__assign)({},e),((s={})[g]=Object(k.__assign)(Object(k.__assign)({},e[g]),{zoomControlModel:E}),s)):e;case dr.Fc:var O=t.payload,T=(g=O.statusBarId,O.step),I=O.removeNotAdd;if(g&&e[g]&&T){var w=e[g].appliedScalingSteps||{};(Array.isArray(T)?T:[T]).forEach((function(e){var t,n=e.type,o=e.controlId,r=w[n]||{},i=o,a=(r[i],Object(k.__rest)(r,["symbol"==typeof i?i:i+""]));I||(a[o]=!0),w=Object(k.__assign)(Object(k.__assign)({},w),((t={})[n]=a,t))}));var _=null!==(c=e[g].appliedScalingStepsCount)&&void 0!==c?c:0;return Object(k.__assign)(Object(k.__assign)({},e),((l={})[g]=Object(k.__assign)(Object(k.__assign)({},e[g]),{appliedScalingSteps:w,appliedScalingStepsCount:_+(I?-1:1)}),l))}return e;default:return e}}function c_(){dy.b.register("statusBarModels",l_)}var u_=n(1193);function d_(e){return Object(k.__spreadArray)([Object(i_.a)(u_.a.ShowDocumentLabel,"","DocumentName",{iconSet:{default:W.a.Excel_32}}),Object(n_.a)(u_.a.UndoInToolbar,e.Undo,{iconSet:{default:h.a.Undo_20},customTooltip:e.Undo,hideLabel:!0}),Object(n_.a)(u_.a.RedoInToolbar,e.Redo,{iconSet:{default:c.a.Redo_20},customTooltip:e.Redo,hideLabel:!0}),Object(n_.a)(u_.a.ShowOpenInAppInEditMode,e.Open,{iconSet:{default:W.a.ExcelMonoline_20}}),Object(n_.a)(u_.a.ShowOpenInAppDialog,e.Edit,{iconSet:{default:W.a.ChangesPaneEdit_20}})],function(e){return[Object(n_.a)(u_.a.GiveFeedbackToMicrosoft,e.GiveFeedbackToMicrosoft,{iconSet:{default:W.a.Feedback_20}}),Object(n_.a)(u_.a.ShowWACSessionIdDialog,e.About,{iconSet:{default:W.a.Info_20}}),Object(n_.a)(u_.a.ShowTermsOfUse,e.TermsOfUse,{iconSet:{default:W.a.Info_20}}),Object(n_.a)(u_.a.ThirdPartyNotices,e.ThirdPartyNotices,{iconSet:{default:W.a.Info_20}}),Object(n_.a)(u_.a.PrivacyStatement,e.Privacy,{iconSet:{default:W.a.ProtectForm_20}}),Object(n_.a)(u_.a.ShowTrustCenter,e.TrustCenter,{iconSet:{default:W.a.ProtectForm_20}}),Object(o_.a)(u_.a.MoreViewerOptionsFlyoutAnchor,e.SpinnerIncrementButtonAriaLabel,{iconSet:{default:c.a.HintBarEllipses_20},hideChevron:!0,hideLabel:!0,menuModel:Object(r_.a)([Object(r_.b)([u_.a.GiveFeedbackToMicrosoft,u_.a.ShowWACSessionIdDialog,u_.a.ShowTermsOfUse,u_.a.ThirdPartyNotices,u_.a.PrivacyStatement,u_.a.ShowTrustCenter])])})]}(e),!0)}var p_=Object(nT.a)("StatusBar:initializeViewerToolbarInStore",(function(){c_(),Object(Wy.a)(Object(k.__spreadArray)([Object(fI.a)(d_(ExcelRibbonStrings))],Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.MiniWACInEditMode",!1)?[a_(e_.ExcelViewerToolbar,{left:[u_.a.ShowDocumentLabel],center:[],right:[u_.a.UndoInToolbar,u_.a.RedoInToolbar,u_.a.ShowOpenInAppDialog,u_.a.ShowOpenInAppInEditMode,u_.a.MoreViewerOptionsFlyoutAnchor]})]:[a_(e_.ExcelViewerToolbar,{left:[u_.a.ShowDocumentLabel],center:[],right:[u_.a.ShowOpenInAppDialog,u_.a.MoreViewerOptionsFlyoutAnchor]})],!0))})),h_=O.memo((function(e){var t=e.debounceTimeoutMs,n=e.children,o=O.useRef(),r=O.useReducer((function(e){return e+1}),0)[1],i=O.useRef();return void 0===i.current?i.current=n:i.current!==n&&(void 0!==o.current&&(window.clearTimeout(o.current),o.current=void 0),o.current=window.setTimeout((function(){o.current=void 0,i.current=n,r()}),t)),O.createElement(O.Fragment,null,i.current)}));h_.displayName="DebouncedRenderer";var g_={display:"inline-block",verticalAlign:"top",whiteSpace:"nowrap"},m_=Object(Po.c)((function(){return Object(V.db)({outerContainer:{position:"relative",width:"100%"},innerContainerHidden:Object(k.__assign)(Object(k.__assign)({},g_),{position:"absolute",top:0,left:0,visibility:"hidden",width:"min-content"}),innerContainerDisplayed:Object(k.__assign)(Object(k.__assign)({},g_),{minWidth:"100%"})})})),f_=function(e,t){var n,o=t.current;if(o){var r=e.filter((function(e){return!(e.target!==o||!e.contentBoxSize)}))[0];return Math.floor(null===(n=null==r?void 0:r.contentRect)||void 0===n?void 0:n.width)}},b_=new Ia.a;var v_,y_,x_,C_,S_=O.memo((function(e){var t=e.steps,n=e.onScalingStepDispatch,o=e.appliedScalingStepsCount,r=e.children,i=O.useRef(),a=O.useRef(),s=O.useRef(null),l=O.useRef(null),c=O.useRef({}),u=O.useRef(!1),d=O.useRef(!1),p=O.useRef(),h=O.useRef(),g=O.useRef(o);g.current=o;var m=O.useCallback((function(){if(p.current&&h.current)if(c.current[g.current]=h.current,h.current>p.current){if(g.current===t.length)return;var e=g.current+1;u.current=!0,n(e,t[e-1],!1)}else{if(0===g.current)return;e=g.current-1;var o=c.current[e];(!o||o<p.current)&&(u.current=!0,n(e,t[e],!0))}}),[t,n]),f=O.useRef(),b=O.useRef(),v=O.useRef(o);O.useEffect((function(){return v.current!==g.current&&(f.current=window.requestAnimationFrame((function(){b.current=window.setTimeout((function(){u.current=!1,m()}),0)}))),v.current=o,function(){f.current&&window.cancelAnimationFrame(f.current),b.current&&window.clearTimeout(b.current)}}),[m,o]);var y=O.useMemo((function(){return b_.debounce((function(){d.current=!1,m()}),100,{leading:!1})}),[m]),x=O.useCallback((function(e){var t=f_(e,l);void 0!==t&&t!==p.current&&(p.current=t,d.current=!0,y())}),[y]),C=O.useCallback((function(e){var t=f_(e,s);void 0!==t&&(h.current=t,d.current||(u.current||(c.current={}),m()))}),[m]);O.useEffect((function(){return a.current=new ResizeObserver(b_.throttle(x,20,{leading:!0})),i.current=new ResizeObserver(C),s.current&&l.current&&(a.current.observe(l.current),i.current.observe(s.current)),function(){i.current&&i.current.disconnect(),a.current&&a.current.disconnect()}}),[x,C]);var S=m_();return O.createElement("div",{ref:l,className:S.outerContainer},O.createElement(h_,{debounceTimeoutMs:50},O.createElement("div",{className:S.innerContainerDisplayed},r)),O.createElement("div",{ref:s,className:S.innerContainerHidden},r))})),E_={whiteBackground:qo.a.white,defaultBackground:qo.a.gray20,hoverBackground:qo.a.gray30,pressedBackground:qo.a.gray50,selectedBackground:qo.a.gray40,defaultBorder:qo.a.gray40,focusedBorder:qo.a.gray130,text:qo.a.gray130,textDisabled:qo.a.gray90},k_=function(e){return Object(Cm.c)()?{whiteBackground:e.palette.white,defaultBackground:e.palette.neutralLighterAlt,hoverBackground:e.palette.neutralLighter,pressedBackground:e.palette.neutralQuaternaryAlt,selectedBackground:e.palette.neutralLight,defaultBorder:e.palette.neutralLight,focusedBorder:e.palette.neutralPrimaryAlt,text:e.palette.neutralPrimaryAlt,textDisabled:e.palette.neutralTertiaryAlt}:E_},O_={label:{fontSize:V.k.small,fontWeight:V.l.regular,fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',cursor:"default",textAlign:"center",userSelect:"none",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset",lineHeight:16,margin:"0 4px",paddingTop:0,paddingBottom:0,height:"100%",display:"flex",alignItems:"center"}},T_={root:{height:40,paddingLeft:9,paddingRight:9},label:{lineHeight:20}},I_={width:14,height:14,lineHeight:14,alignItems:"center"},w_={width:16,height:16,lineHeight:16},__=Object(Po.c)((function(e,t,n){var o=k_(e),r=Object(k.__assign)(Object(k.__assign)({},O_),{root:{height:24,minWidth:40,color:o.text,border:"1px solid transparent",borderRadius:0,boxSizing:"border-box",paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:"transparent"},rootHovered:{borderColor:"transparent",backgroundColor:o.hoverBackground},rootPressed:{backgroundColor:o.pressedBackground},rootChecked:{backgroundColor:o.selectedBackground},rootDisabled:{backgroundColor:o.defaultBackground,color:o.textDisabled},rootFocused:{borderColor:o.focusedBorder,backgroundColor:o.selectedBackground},rootCheckedHovered:{borderColor:"transparent",backgroundColor:o.hoverBackground},icon:Object(k.__assign)({},I_),menuIcon:{height:8,lineHeight:8,width:8,marginLeft:0,marginRight:0}});return Object(V.I)(r,n?T_:{},n?{icon:w_}:{},t)})),P_=n(2214),R_=n(327),D_=function(e){return O.createElement("span",{className:R_.i},e)},j_=function(e,t){e.isJumbo=!!t},B_=n(1466),F_=n(553),L_=n(19),M_=n(41),A_={icon:{width:12,height:12,lineHeight:12}},N_={root:{paddingLeft:0,paddingRight:0},label:{justifyContent:"center",minWidth:30,marginLeft:0,marginRight:0}},W_={label:{minWidth:32,justifyContent:"center"}},H_=Object(yI.a)({icon:{width:"12px",height:"12px",lineHeight:"12px"}}),z_=Object(yI.a)({label:{minWidth:"32px",justifyContent:"center"}}),V_=Object(yI.a)({baseIcon:Object(k.__assign)({width:"14px",height:"14px",lineHeight:"14px",alignItems:"center"},xI.a.margin("0px")),jumboIcon:Object(k.__assign)({width:"16px",height:"16px",lineHeight:"16px"},xI.a.margin("0px"))}),G_=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),xI.a.borderStyle("solid")),xI.a.borderWidth("2px")),xI.a.borderColor(L_.a.legacy_black)),{boxShadow:"none"}),U_=Object(yI.a)({baseStyle:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({height:"24px",minWidth:"40px"},xI.a.borderWidth("1px")),xI.a.borderStyle("solid")),xI.a.borderColor("transparent")),xI.a.borderRadius("0px")),(v_={boxSizing:"border-box",paddingLeft:"4px",paddingRight:"4px",paddingTop:"0px",paddingBottom:"0px",backgroundColor:"transparent",color:L_.a.legacy_neutralPrimaryAlt,fontWeight:L_.a.fontWeightRegular,fontSize:L_.a.fontSizeBase200},v_["& .".concat(Ds.D)]=Object(k.__assign)({},M_.p),v_["& .".concat(R_.i)]=Object(k.__assign)({},xI.a.margin("0px","4px")),v_[":hover"]=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),xI.a.borderColor("transparent")),{backgroundColor:L_.a.legacy_neutralLighter}),v_[":hover:active"]=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),xI.a.borderColor("transparent")),{backgroundColor:L_.a.legacy_neutralQuaternaryAlt}),v_[":disabled"]=Object(k.__assign)(Object(k.__assign)({backgroundColor:L_.a.legacy_neutralLighterAlt,color:L_.a.legacy_neutralTertiaryAlt},xI.a.borderRadius("0px")),(y_={},y_["".concat(M_.a)]=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},M_.f),M_.h),{":hover":Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),M_.k),":focus":Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),M_.l)}),y_)),v_[":focus"]=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),xI.a.borderColor(L_.a.legacy_black)),{backgroundColor:L_.a.legacy_neutralLight}),v_[":focus-visible"]=G_,v_)),Object(B_.a)(G_)),(x_={},x_["".concat(M_.a)]=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},Object(V.S)()),M_.d),M_.e),M_.c),{":hover":Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},M_.b),M_.g),M_.m),xI.a.borderRadius("0px")),":hover:active":Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},M_.b),M_.g),M_.m),xI.a.borderRadius("0px")),":focus":Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},xI.a.borderRadius("0px")),M_.b),M_.g),M_.m)}),x_))}),q_=Object(yI.a)({root:{height:"40px",paddingLeft:"9px",paddingRight:"9px"},label:{lineHeight:20}}),Q_=Object(yI.a)({baseStyle:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({height:"24px",backgroundColor:L_.a.colorNeutralBackground3},xI.a.borderRadius(L_.a.borderRadiusNone)),{color:L_.a.colorNeutralForeground3,paddingTop:L_.a.spacingVerticalNone,paddingBottom:L_.a.spacingVerticalNone,boxSizing:"border-box"}),xI.a.borderColor("transparent")),{fontWeight:L_.a.fontWeightRegular,fontSize:L_.a.fontSizeBase200}),xI.a.margin(L_.a.spacingHorizontalNone)),(C_={paddingLeft:L_.a.spacingHorizontalS,paddingRight:L_.a.spacingHorizontalXS,minWidth:"40px"},C_["& .".concat(R_.i)]={paddingBottom:"3px",paddingTop:"5px",paddingRight:"4px"},C_["& .".concat(Ds.D)]=Object(k.__assign)({},M_.p),C_[":hover"]=Object(k.__assign)(Object(k.__assign)({},xI.a.borderColor("transparent")),{backgroundColor:L_.a.colorNeutralBackground3Hover,color:L_.a.colorNeutralForeground3Hover}),C_[":hover:active"]=Object(k.__assign)(Object(k.__assign)({},xI.a.borderColor("transparent")),{backgroundColor:L_.a.colorNeutralBackground3Pressed,color:L_.a.colorNeutralForeground3Pressed}),C_[":disabled"]=Object(k.__assign)(Object(k.__assign)({},xI.a.borderColor("transparent")),{backgroundColor:L_.a.colorNeutralStrokeDisabled,color:L_.a.colorNeutralForegroundDisabled}),C_[":focus-visible"]=G_,C_)),Object(B_.a)(G_))}),K_=Object(yI.a)({baseIcon:Object(k.__assign)({width:"16px",height:"16px",lineHeight:L_.a.lineHeightBase200,alignItems:"center",paddingTop:L_.a.spacingVerticalXS,paddingBottom:L_.a.spacingVerticalXS,paddingRight:L_.a.spacingHorizontalXS},xI.a.margin(L_.a.spacingHorizontalNone))}),J_=function(e){return function(e){var t=U_(),n=q_(),o=V_(),r=e.isJumbo,i=Q_(),a=K_(),s=e.applyZoomIconStyles,l=H_();Object(vI.b)()?(e.root.className=Object(EI.a)(i.baseStyle,e.root.className),e.icon&&(e.icon.className=Object(EI.a)(a.baseIcon,s&&l.icon,e.icon.className))):(e.root.className=Object(EI.a)(t.baseStyle,r&&n.root,r&&n.label,e.root.className),e.icon&&(e.icon.className=Object(EI.a)(o.baseIcon,r&&o.jumboIcon,s&&l.icon,e.icon.className)))}(e),Object(F_.a)(e),e},Z_=n(1361),Y_=O.memo(O.forwardRef((function(e,t){var n=function(e,t){var n=e.dataAutomationType,o=e.label,r=e.isJumbo,i=e.applyZoomIconStyles,a=Object(P_.a)(Object(k.__assign)(Object(k.__assign)({},e),{children:D_(o),dataAutomationType:null!=n?n:"StatusBarButton"}),t);return j_(a,r),function(e,t){e.applyZoomIconStyles=!!t}(a,i),a}(e,t);return J_(n),Object(Z_.a)(n)})));Y_.displayName="next/StatusBarButton";var X_=function(){var e=O.useContext(Jd.a);return Object(dm.a)(e,dm.f.fluentV9StatusBarButtonEnabled)},$_=O.forwardRef((function(e,t){var n=e.styles,o=(e.type,e.isJumbo),r=Object(k.__rest)(e,["styles","type","isJumbo"]);return e.label||e.icon?O.createElement(Bo.a,null,(function(e){return O.createElement($t.a,Object(k.__assign)({ref:t,type:"AppButtonProps",noDomId:!0},r,{styles:__(e,n,o)}))})):null})),eP=O.forwardRef((function(e,t){return X_()?O.createElement(Y_,Object(k.__assign)({},e,{ref:t})):O.createElement($_,Object(k.__assign)({ref:t},e))}));eP.displayName="StatusBarButton";var tP=n(2204),nP=n(2206),oP=n(1060),rP=n(2266),iP=n(2267),aP=n(1095),sP=n(1626),lP=n(766);function cP(e,t,n,o,r){var i=isNaN(n)?void 0:n,a=isNaN(o)?void 0:o;if(Object(nP.a)(e))return function(e,t,n,o){return O.createElement(Bo.a,null,(function(r){return O.createElement(rP.a,Object(k.__assign)({positionInSet:n,setSize:o},Object(sP.a)(e,t),{keytipProps:Object(lP.a)(e.keytipProps),shouldTakeFocus:void 0===e.shouldTakeFocus||e.shouldTakeFocus,lang:e.lang,enableFocusOnHover:!1,styles:Object(iP.a)(r,Object(aP.b)(r,e.styles)),dataAutomationType:"StatusBarCompoundButton"}))}))}(e,t,i,a);throw new Error("The control of type ".concat(e.type," is not valid in a StatusBar menu"))}var uP,dP,pP=Object(Po.c)((function(e,t,n){var o=__(e);return Object(V.I)(o,n?T_:{},t)})),hP=O.forwardRef((function(e,t){var n=e.styles,o=(e.type,e.isJumbo),r=e.customMenuItemStyles,i=Object(k.__rest)(e,["styles","type","isJumbo","customMenuItemStyles"]);return e.label||e.icon?O.createElement(Bo.a,null,(function(e){return O.createElement(Yr.a,Object(k.__assign)({ref:t,type:"AppFlyoutAnchorProps"},i,{styles:pP(e,n,o),controlInMenuRendererFunction:gP(r),directionalHintFixed:!!o}))})):null})),gP=Object(Po.c)((function(e){return function(t){var n=t.controlProps,o=t.location,r=t.useFullDescriptionLabelOnly;return n.map((function(t){var n=Object(k.__assign)(Object(k.__assign)({},t),{location:o});if(Object(tP.a)(n))return Object(zs.a)(Object(Hs.a)(n.id,n.location),n,mP(e),void 0,void 0,r);if(Object(xE.a)(n))return Object(Ld.a)(n,mP(e),void 0,r);if(Object(nP.a)(n)){var i=Object(k.__assign)(Object(k.__assign)({},n),{styles:Object(V.db)(fP,n.styles)});return Object(oP.b)(i,cP)}throw new Error("The control of type ".concat(n.type," is not valid in a Peripheral Menu"))}))}})),mP=Object(Po.c)((function(e){return Object(V.db)({icon:{width:16,height:16,lineHeight:16}},e)})),fP=Object(V.db)({root:{minHeight:60,padding:"4px 12px"},icon:{width:32,height:32,lineHeight:32}}),bP=Object(Po.c)((function(e,t){return Object(V.I)({root:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},I_),{paddingRight:0}),t?w_:{})},e.styles)})),vP=Object(Po.c)((function(e,t,n){var o=k_(e),r=Object(k.__assign)(Object(k.__assign)({},O_),{root:{height:24,boxSizing:"border-box",border:"1px solid transparent",color:o.text,paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:"transparent",borderRadius:0}});return Object(V.I)(r,n?T_:{},t)})),yP=O.forwardRef((function(e,t){var n=e.styles,o=(e.type,e.iconProps),r=e.isJumbo,i=Object(k.__rest)(e,["styles","type","iconProps","isJumbo"]);return e.label||e.iconProps?O.createElement(Bo.a,null,(function(e){return O.createElement(gm,Object(k.__assign)({ref:t,type:"AppStatusTextProps"},i,{styles:vP(e,n,r),iconProps:o?Object(k.__assign)(Object(k.__assign)({},o),{styles:bP(o,r)}):void 0}))})):null})),xP=Object(Po.c)((function(e,t,n){var o=__(e);return Object(V.I)(o,n?T_:{},t)})),CP=n(1940),SP=n(1943),EP=Object(yI.a)({root:Object(k.__assign)({},xI.a.margin("0px")),checked:Object(k.__assign)(Object(k.__assign)({backgroundColor:L_.a.legacy_neutralLight},xI.a.borderColor("transparent")),(uP={},uP["".concat(M_.a)]=Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},M_.b),M_.g),M_.n),uP)),disabled:(dP={},dP["".concat(M_.a)]=Object(k.__assign)(Object(k.__assign)({},M_.f),{":focus":Object(k.__assign)({},M_.f)}),dP)}),kP=O.memo(O.forwardRef((function(e,t){var n=function(e,t){var n=e.dataAutomationType,o=e.label,r=e.isJumbo,i=Object(CP.a)(Object(k.__assign)(Object(k.__assign)({},e),{children:D_(o),dataAutomationType:null!=n?n:"RibbonToggleButton"}),t);return j_(i,r),i}(Object(k.__assign)({},e),t);return function(e){var t=EP();e.root.className=Object(EI.a)(t.root,e.checked&&t.checked,(e.disabled||e.disabledFocusable)&&t.disabled,e.root.className),J_(e),Object(SP.a)(e)}(n),Object(Z_.a)(n)})));kP.displayName="next/StatusBarToggleButton";var OP=O.forwardRef((function(e,t){var n=e.styles,o=(e.type,e.isJumbo),r=Object(k.__rest)(e,["styles","type","isJumbo"]);return e.label||e.icon?O.createElement(Bo.a,null,(function(e){return O.createElement(Br.a,Object(k.__assign)({ref:t,type:"AppToggleButtonProps"},r,{styles:xP(e,n,o)}))})):null})),TP=O.forwardRef((function(e,t){return X_()?O.createElement(kP,Object(k.__assign)({},e,{ref:t})):O.createElement(OP,Object(k.__assign)({ref:t},e))}));TP.displayName="StatusBarToggleButton";var IP=n(1981),wP=n(380),_P=Object(Po.c)((function(e,t,n,o){var r,i,a=k_(e),s=Object(ym.a)(e,n),l={root:{height:24},slideBox:Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({height:24,boxSizing:"border-box",paddingLeft:3,paddingRight:3,paddingBottom:1},t?{pointerEvents:"none"}:{"&:hover, &:active":{".ms-Slider-thumb":{border:0,borderRadius:0,backgroundColor:s.primaryDefaultBackgroundColor},".ms-Slider-active":{backgroundColor:a.focusedBorder},".ms-Slider-inactive":{backgroundColor:a.focusedBorder}}}),Object(wP.b)(e,void 0,t)),(r={},r[V.m]={".ms-Slider-thumb, .ms-Slider-active, .ms-Slider-inactive":{border:0,backgroundColor:t?"GrayText":"ButtonText"},"&:hover, &:active, &:focus":Object(k.__assign)(Object(k.__assign)({".ms-Slider-thumb, .ms-Slider-active, .ms-Slider-inactive":(i={},i[V.m]={backgroundColor:"HighlightText"},i)},Ds.o),Ds.t)},r)),thumb:{width:6,height:15,top:-7,border:0,borderRadius:0,backgroundColor:t?a.textDisabled:a.focusedBorder,transition:"none"},activeSection:{height:1,backgroundColor:t?a.textDisabled:a.focusedBorder},inactiveSection:{height:1,backgroundColor:t?a.textDisabled:a.focusedBorder}};return Object(k.__assign)(Object(k.__assign)(Object(k.__assign)(Object(k.__assign)({},O_),{root:{height:24,maxWidth:100}}),o),{slider:Object(V.I)(l,null==o?void 0:o.slider)})})),PP=n(29),RP=n.n(PP),DP=n(1975),jP=n(935),BP=n(523),FP=n(1620),LP=n(1349),MP=n(37),AP=n.n(MP),NP=n(1468),WP=(e,t,n)=>Math.max(t,Math.min(n,e||0)),HP=n(374),zP=n(644),VP=n(271),GP="fui-Slider",UP="fui-Slider__rail",qP="fui-Slider__thumb",QP="fui-Slider__input",KP="--fui-Slider--direction",JP="--fui-Slider--progress",ZP="--fui-Slider--steps-percent",YP=Object(VP.a)({root:{qhf8xq:"f10pi13n",mc9l5x:"fwk3njj",lpbzjs:"f1sdsnyy",Bt984gj:"f122n59",B7hvi0a:"f1oiokrs"},small:{Bi64ftq:"f1agqo6f",Ba19x4e:"f1i7ztpd",sshi5w:"f1pha7fy"},medium:{Bi64ftq:"f1a78h9h",Ba19x4e:"fuok0yf",sshi5w:"f1nxs5xn"},horizontal:{Bf4jedk:"fyvtabn",wkccdc:"fgfd48t",Budl1dq:"f4t5rw1"},vertical:{sshi5w:"f1pzv1zu",wkccdc:"fktlcaf",Budl1dq:"fiadc6h"},enabled:{B7wi8oa:"f4l8x3l",B250r6j:"f671q34",Bpmy4es:"fvfzmw5",Buw9y6v:"faw1t00",Bq939m0:"fxdgx5",gjzr1t:"fii04fa",tg7hqu:"f36hzz8",ypdvl1:"f1volkfw",Bw5jdd4:"f1xddb6",Bdjie01:"fcdikl",Bvh9j6m:"fhpzgm6",Bvsvvpo:"f1q6pm3h"},disabled:{Bpmy4es:"foojseg",B7wi8oa:"f1lgdqhv",B250r6j:"f1veetlj",ypdvl1:"fu12m3e",Bw5jdd4:"fi9guym",Bdjie01:"fcdjl4u"},focusIndicatorHorizontal:{Brovlpu:"ftqa4ok",B486eqv:"f2hkw1w",Bssx7fj:"f1b1k54r",uh7if5:["f4ne723","fqqcjud"],clntm0:"fh7aioi",Dlk2r6:["fqqcjud","f4ne723"],B2j2mmj:"ffht0p2",wigs8:"f1p0ul1q",pbfy6t:"f1c901ms",B0v4ure:"f1alokd7",ghq09:"f78i1la",B24cy0v:["f1kvsw7t","f1bw8brt"],Bwckmig:"f8k7e5g",Bvwlmkc:["f1bw8brt","f1kvsw7t"],Bbgo44z:"f1pmxfrl",Bil7v7r:["fszkfcr","f1ap5ily"],skfxo0:"f57dp0y",jo1ztg:["f1ap5ily","fszkfcr"],Ba3ybja:["f11dm2qb","f136rfnd"],az1dzo:["f136rfnd","f11dm2qb"],vppk2z:["fdsq1qd","f1khssms"],B6352mv:["f1khssms","fdsq1qd"],nr063g:"fq4eyks",Blmvk6g:["f1ya6x16","ftuszwa"],Bsiemmq:"f1e2iu44",B98u21t:["ftuszwa","f1ya6x16"],B2pnrqr:"f1pffoy2",B29w5g4:["f1bmyog6","f15fv2gd"],Bhhzhcn:"fs6b7xr",Bec0n69:["f15fv2gd","f1bmyog6"]},focusIndicatorVertical:{Brovlpu:"ftqa4ok",B486eqv:"f2hkw1w",Bssx7fj:"f1b1k54r",uh7if5:["f4ne723","fqqcjud"],clntm0:"fh7aioi",Dlk2r6:["fqqcjud","f4ne723"],B2j2mmj:"ffht0p2",wigs8:"f1p0ul1q",pbfy6t:"f1c901ms",B0v4ure:"f1alokd7",ghq09:"f78i1la",B24cy0v:["f1kvsw7t","f1bw8brt"],Bwckmig:"f8k7e5g",Bvwlmkc:["f1bw8brt","f1kvsw7t"],Bbgo44z:"f1pmxfrl",Bil7v7r:["fszkfcr","f1ap5ily"],skfxo0:"f57dp0y",jo1ztg:["f1ap5ily","fszkfcr"],Ba3ybja:["f11dm2qb","f136rfnd"],az1dzo:["f136rfnd","f11dm2qb"],vppk2z:["fdsq1qd","f1khssms"],B6352mv:["f1khssms","fdsq1qd"],nr063g:"fq4eyks",Blmvk6g:["f1ya6x16","ftuszwa"],Bsiemmq:"f1e2iu44",B98u21t:["ftuszwa","f1ya6x16"],B2pnrqr:"f1hxpdv8",B29w5g4:["fm5xmfm","femsgmt"],Bhhzhcn:"f1dmxpeg",Bec0n69:["femsgmt","fm5xmfm"]}},{d:[".f10pi13n{position:relative;}",".fwk3njj{display:-ms-inline-grid;display:inline-grid;}",".f1sdsnyy{touch-action:none;}",".f122n59{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}",".f1oiokrs{justify-items:center;}",".f1agqo6f{--fui-Slider__thumb--size:16px;}",".f1i7ztpd{--fui-Slider__rail--size:2px;}",".f1pha7fy{min-height:24px;}",".f1a78h9h{--fui-Slider__thumb--size:20px;}",".fuok0yf{--fui-Slider__rail--size:4px;}",".f1nxs5xn{min-height:32px;}",".fyvtabn{min-width:120px;}",".fgfd48t{-ms-grid-rows:1fr var(--fui-Slider__thumb--size) 1fr;grid-template-rows:1fr var(--fui-Slider__thumb--size) 1fr;}",".f4t5rw1{-ms-grid-columns:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;grid-template-columns:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;}",".f1pzv1zu{min-height:120px;}",".fktlcaf{-ms-grid-rows:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;grid-template-rows:1fr calc(100% - var(--fui-Slider__thumb--size)) 1fr;}",".fiadc6h{-ms-grid-columns:1fr var(--fui-Slider__thumb--size) 1fr;grid-template-columns:1fr var(--fui-Slider__thumb--size) 1fr;}",".f4l8x3l{--fui-Slider__rail--color:var(--colorNeutralStrokeAccessible);}",".f671q34{--fui-Slider__progress--color:var(--colorCompoundBrandBackground);}",".fvfzmw5{--fui-Slider__thumb--color:var(--colorCompoundBrandBackground);}",".foojseg{--fui-Slider__thumb--color:var(--colorNeutralForegroundDisabled);}",".f1lgdqhv{--fui-Slider__rail--color:var(--colorNeutralBackgroundDisabled);}",".f1veetlj{--fui-Slider__progress--color:var(--colorNeutralForegroundDisabled);}",".f1b1k54r[data-fui-focus-within]:focus-within{border-top-color:transparent;}",".f4ne723[data-fui-focus-within]:focus-within{border-right-color:transparent;}",".fqqcjud[data-fui-focus-within]:focus-within{border-left-color:transparent;}",".fh7aioi[data-fui-focus-within]:focus-within{border-bottom-color:transparent;}",'.ffht0p2[data-fui-focus-within]:focus-within::after{content:"";}',".f1p0ul1q[data-fui-focus-within]:focus-within::after{position:absolute;}",".f1c901ms[data-fui-focus-within]:focus-within::after{pointer-events:none;}",".f1alokd7[data-fui-focus-within]:focus-within::after{z-index:1;}",".f78i1la[data-fui-focus-within]:focus-within::after{border-top-style:solid;}",".f1kvsw7t[data-fui-focus-within]:focus-within::after{border-right-style:solid;}",".f1bw8brt[data-fui-focus-within]:focus-within::after{border-left-style:solid;}",".f8k7e5g[data-fui-focus-within]:focus-within::after{border-bottom-style:solid;}",".f1pmxfrl[data-fui-focus-within]:focus-within::after{border-top-width:2px;}",".fszkfcr[data-fui-focus-within]:focus-within::after{border-right-width:2px;}",".f1ap5ily[data-fui-focus-within]:focus-within::after{border-left-width:2px;}",".f57dp0y[data-fui-focus-within]:focus-within::after{border-bottom-width:2px;}",".f11dm2qb[data-fui-focus-within]:focus-within::after{border-bottom-right-radius:var(--borderRadiusMedium);}",".f136rfnd[data-fui-focus-within]:focus-within::after{border-bottom-left-radius:var(--borderRadiusMedium);}",".fdsq1qd[data-fui-focus-within]:focus-within::after{border-top-right-radius:var(--borderRadiusMedium);}",".f1khssms[data-fui-focus-within]:focus-within::after{border-top-left-radius:var(--borderRadiusMedium);}",".fq4eyks[data-fui-focus-within]:focus-within::after{border-top-color:var(--colorStrokeFocus2);}",".f1ya6x16[data-fui-focus-within]:focus-within::after{border-right-color:var(--colorStrokeFocus2);}",".ftuszwa[data-fui-focus-within]:focus-within::after{border-left-color:var(--colorStrokeFocus2);}",".f1e2iu44[data-fui-focus-within]:focus-within::after{border-bottom-color:var(--colorStrokeFocus2);}",".f1pffoy2[data-fui-focus-within]:focus-within::after{top:calc(0px - 2px - -2px);}",".f1bmyog6[data-fui-focus-within]:focus-within::after{right:calc(0px - 2px - 8px);}",".f15fv2gd[data-fui-focus-within]:focus-within::after{left:calc(0px - 2px - 8px);}",".fs6b7xr[data-fui-focus-within]:focus-within::after{bottom:calc(0px - 2px - -2px);}",".f1hxpdv8[data-fui-focus-within]:focus-within::after{top:calc(0px - 2px - 6px);}",".fm5xmfm[data-fui-focus-within]:focus-within::after{right:calc(0px - 2px - 4px);}",".femsgmt[data-fui-focus-within]:focus-within::after{left:calc(0px - 2px - 4px);}",".f1dmxpeg[data-fui-focus-within]:focus-within::after{bottom:calc(0px - 2px - 6px);}"],h:[".faw1t00:hover{--fui-Slider__thumb--color:var(--colorCompoundBrandBackgroundHover);}",".fxdgx5:hover{--fui-Slider__progress--color:var(--colorCompoundBrandBackgroundHover);}"],a:[".fii04fa:active{--fui-Slider__thumb--color:var(--colorCompoundBrandBackgroundPressed);}",".f36hzz8:active{--fui-Slider__progress--color:var(--colorCompoundBrandBackgroundPressed);}"],m:[["@media (forced-colors: active){.f1volkfw{--fui-Slider__rail--color:CanvasText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1xddb6{--fui-Slider__thumb--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcdikl{--fui-Slider__progress--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fhpzgm6:hover{--fui-Slider__thumb--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1q6pm3h:hover{--fui-Slider__progress--color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fu12m3e{--fui-Slider__rail--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fi9guym{--fui-Slider__thumb--color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcdjl4u{--fui-Slider__progress--color:GrayText;}}",{m:"(forced-colors: active)"}]],f:[".ftqa4ok:focus{outline-style:none;}"],i:[".f2hkw1w:focus-visible{outline-style:none;}"]}),XP=Object(VP.a)({rail:{Bbmb7ep:["fnivh3a","fc7yr5o"],Beyfa6y:["fc7yr5o","fnivh3a"],B7oj6ja:["f1el4m67","f8yange"],Btl43ni:["f8yange","f1el4m67"],Bkecrkj:"f1aehjj5",Ijaq50:"faunodf",nk6f5a:"f88nxoq",Br312pm:"fd46tj4",Bw0ie65:"f1e2fz10",qhf8xq:"f10pi13n",Bvjb7m6:"fdgv6k0",Bcmaq0h:"fizngqt",Bpd4iqm:"fpvhumw",oeaueh:"f1yog68k",Bw0xxkn:"f13sgyd8",Ftih45:"fzhtfnv",Brfgrao:"f1j7ml58",Bbn5juq:"fx36ao7",Brdvuy1:"fux3rle"},horizontal:{a9b677:"fly5x3f",Bqenvij:"f1cy86ho",Fbdkly:["f1heqfse","fkh49vu"],mdwyqc:["fkh49vu","f1heqfse"],Baz25je:"f16tdq4e"},vertical:{a9b677:"fqxfnkd",Bqenvij:"f1l02sjl",Ccq8qp:"f1rik0od",Bciustq:"f14xwovp",lawp4y:"febq2dz"}},{d:[".fnivh3a{border-bottom-right-radius:var(--borderRadiusXLarge);}",".fc7yr5o{border-bottom-left-radius:var(--borderRadiusXLarge);}",".f1el4m67{border-top-right-radius:var(--borderRadiusXLarge);}",".f8yange{border-top-left-radius:var(--borderRadiusXLarge);}",".f1aehjj5{pointer-events:none;}",".faunodf{-ms-grid-row:2;grid-row-start:2;}",".f88nxoq{-ms-grid-row-span:2;grid-row-end:2;}",".fd46tj4{-ms-grid-column:2;grid-column-start:2;}",".f1e2fz10{-ms-grid-column-span:2;grid-column-end:2;}",".f10pi13n{position:relative;}",".fdgv6k0{forced-color-adjust:none;}",".fizngqt{background-image:linear-gradient(\n      var(--fui-Slider--direction),\n      var(--fui-Slider__progress--color) 0%,\n      var(--fui-Slider__progress--color) var(--fui-Slider--progress),\n      var(--fui-Slider__rail--color) var(--fui-Slider--progress)\n    );}",".fpvhumw{outline-width:1px;}",".f1yog68k{outline-style:solid;}",".f13sgyd8{outline-color:var(--colorTransparentStroke);}",".fzhtfnv::before{content:'';}",".f1j7ml58::before{position:absolute;}",".fx36ao7::before{background-image:repeating-linear-gradient(\n        var(--fui-Slider--direction),\n        #0000 0%,\n        #0000 calc(var(--fui-Slider--steps-percent) - 1px),\n        var(--colorNeutralBackground1) calc(var(--fui-Slider--steps-percent) - 1px),\n        var(--colorNeutralBackground1) var(--fui-Slider--steps-percent)\n      );}",".fly5x3f{width:100%;}",".f1cy86ho{height:var(--fui-Slider__rail--size);}",".f1heqfse::before{left:-1px;}",".fkh49vu::before{right:-1px;}",".f16tdq4e::before{height:var(--fui-Slider__rail--size);}",".fqxfnkd{width:var(--fui-Slider__rail--size);}",".f1l02sjl{height:100%;}",".f1rik0od::before{width:var(--fui-Slider__rail--size);}",".f14xwovp::before{top:-1px;}",".febq2dz::before{bottom:1px;}"],m:[["@media (forced-colors: active){.fux3rle::before{background-image:repeating-linear-gradient(\n          var(--fui-Slider--direction),\n          #0000 0%,\n          #0000 calc(var(--fui-Slider--steps-percent) - 1px),\n          HighlightText calc(var(--fui-Slider--steps-percent) - 1px),\n          HighlightText var(--fui-Slider--steps-percent)\n        );}}",{m:"(forced-colors: active)"}]]}),$P=Object(VP.a)({thumb:{Ijaq50:"faunodf",nk6f5a:"f88nxoq",Br312pm:"fd46tj4",Bw0ie65:"f1e2fz10",qhf8xq:"f1euv43f",a9b677:"f174ca62",Bqenvij:"f1yfdkfd",Bkecrkj:"f1aehjj5",oeaueh:"f1s6fcnf",Bvjb7m6:"fdgv6k0",Bbmb7ep:["f8fbkgy","f1nfllo7"],Beyfa6y:["f1nfllo7","f8fbkgy"],B7oj6ja:["f1djnp8u","f1s8kh49"],Btl43ni:["f1s8kh49","f1djnp8u"],E5pizo:"fof7hq0",De3pzq:"foksa45",Brfgrao:"f1j7ml58",Bciustq:"f14u7mkt",Fbdkly:["f5zrw40","f1ks5ppg"],lawp4y:"fto0uou",mdwyqc:["f1ks5ppg","f5zrw40"],Budzafs:["feh19e8","f3j3guj"],r59vdv:["f3j3guj","feh19e8"],n07z76:["fo75joz","f1yag6sl"],ck0cow:["f1yag6sl","fo75joz"],Bcvre1j:"fyl8oag",Ftih45:"fzhtfnv",B0qfbqy:"f1rponpz",B4f6apu:["f1rvw2z1","fjj0g3m"],y0oebl:"f1muowhs",uvfttm:["fjj0g3m","f1rvw2z1"],Bdkvgpv:"f163fonl",m598lv:["f1yq6w5o","f1jpmc5p"],qa3bma:"f11yjt3y",Bbv0w2i:["f1jpmc5p","f1yq6w5o"],Bq4z7u6:"f10tv6oz",Bk5zm6e:["f16xp3sf","f1seuxxq"],Bqjgrrk:"fwrmqbx",Bm6vgfq:["f1seuxxq","f16xp3sf"]},disabled:{B0qfbqy:"f1rponpz",B4f6apu:["f1rvw2z1","fjj0g3m"],y0oebl:"f1muowhs",uvfttm:["fjj0g3m","f1rvw2z1"],Bdkvgpv:"f163fonl",m598lv:["f1yq6w5o","f1jpmc5p"],qa3bma:"f11yjt3y",Bbv0w2i:["f1jpmc5p","f1yq6w5o"],Bq4z7u6:"f1pw3ppl",Bk5zm6e:["fxoq2z","f1ykj0h9"],Bqjgrrk:"f1sz5gii",Bm6vgfq:["f1ykj0h9","fxoq2z"]},horizontal:{Bz10aip:["f13gfj74","f1nfknbn"],oyh7mz:["f1fj3zth","fcf9u6w"]},vertical:{Bz10aip:"f5cv5a3",B5kzvoi:"feeniun"}},{d:[".faunodf{-ms-grid-row:2;grid-row-start:2;}",".f88nxoq{-ms-grid-row-span:2;grid-row-end:2;}",".fd46tj4{-ms-grid-column:2;grid-column-start:2;}",".f1e2fz10{-ms-grid-column-span:2;grid-column-end:2;}",".f1euv43f{position:absolute;}",".f174ca62{width:var(--fui-Slider__thumb--size);}",".f1yfdkfd{height:var(--fui-Slider__thumb--size);}",".f1aehjj5{pointer-events:none;}",".f1s6fcnf{outline-style:none;}",".fdgv6k0{forced-color-adjust:none;}",".f8fbkgy{border-bottom-right-radius:var(--borderRadiusCircular);}",".f1nfllo7{border-bottom-left-radius:var(--borderRadiusCircular);}",".f1djnp8u{border-top-right-radius:var(--borderRadiusCircular);}",".f1s8kh49{border-top-left-radius:var(--borderRadiusCircular);}",".fof7hq0{box-shadow:0 0 0 calc(var(--fui-Slider__thumb--size) * .2) var(--colorNeutralBackground1) inset;}",".foksa45{background-color:var(--fui-Slider__thumb--color);}",".f1j7ml58::before{position:absolute;}",".f14u7mkt::before{top:0px;}",".f5zrw40::before{left:0px;}",".f1ks5ppg::before{right:0px;}",".fto0uou::before{bottom:0px;}",".feh19e8::before{border-bottom-right-radius:var(--borderRadiusCircular);}",".f3j3guj::before{border-bottom-left-radius:var(--borderRadiusCircular);}",".fo75joz::before{border-top-right-radius:var(--borderRadiusCircular);}",".f1yag6sl::before{border-top-left-radius:var(--borderRadiusCircular);}",".fyl8oag::before{box-sizing:border-box;}",".fzhtfnv::before{content:'';}",".f1rponpz::before{border-top-width:calc(var(--fui-Slider__thumb--size) * .05);}",".f1rvw2z1::before{border-right-width:calc(var(--fui-Slider__thumb--size) * .05);}",".fjj0g3m::before{border-left-width:calc(var(--fui-Slider__thumb--size) * .05);}",".f1muowhs::before{border-bottom-width:calc(var(--fui-Slider__thumb--size) * .05);}",".f163fonl::before{border-top-style:solid;}",".f1yq6w5o::before{border-right-style:solid;}",".f1jpmc5p::before{border-left-style:solid;}",".f11yjt3y::before{border-bottom-style:solid;}",".f10tv6oz::before{border-top-color:var(--colorNeutralStroke1);}",".f16xp3sf::before{border-right-color:var(--colorNeutralStroke1);}",".f1seuxxq::before{border-left-color:var(--colorNeutralStroke1);}",".fwrmqbx::before{border-bottom-color:var(--colorNeutralStroke1);}",".f1pw3ppl::before{border-top-color:var(--colorNeutralForegroundDisabled);}",".fxoq2z::before{border-right-color:var(--colorNeutralForegroundDisabled);}",".f1ykj0h9::before{border-left-color:var(--colorNeutralForegroundDisabled);}",".f1sz5gii::before{border-bottom-color:var(--colorNeutralForegroundDisabled);}",".f13gfj74{-webkit-transform:translateX(-50%);-moz-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);}",".f1nfknbn{-webkit-transform:translateX(50%);-moz-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);}",".f1fj3zth{left:var(--fui-Slider--progress);}",".fcf9u6w{right:var(--fui-Slider--progress);}",".f5cv5a3{-webkit-transform:translateY(50%);-moz-transform:translateY(50%);-ms-transform:translateY(50%);transform:translateY(50%);}",".feeniun{bottom:var(--fui-Slider--progress);}"]}),eR=Object(VP.a)({input:{Bceei9c:"f1k6fduh",abs64n:"fk73vx1",Ijaq50:"f16hsg94",nk6f5a:"f1nzqi2z",Br312pm:"fwpfdsa",Bw0ie65:"fuur7zz",z8tnut:"f1g0x7ka",z189sj:["fhxju0i","f1cnd47f"],Byoj8tv:"f1qch9an",uwmqm3:["f1cnd47f","fhxju0i"],B6of3ja:"f1hu3pq6",t21cq0:["f11qmguv","f1tyq0we"],jrapky:"f19f4twv",Frg6f3:["f1tyq0we","f11qmguv"]},disabled:{Bceei9c:"f158kwzp"},horizontal:{Bqenvij:"f1yfdkfd",a9b677:"fly5x3f"},vertical:{Bqenvij:"f1l02sjl",a9b677:"f174ca62",Brp00wb:"f1r9mf01"}},{d:[".f1k6fduh{cursor:pointer;}",".fk73vx1{opacity:0;}",".f16hsg94{-ms-grid-row:1;grid-row-start:1;}",".f1nzqi2z{-ms-grid-row-span:-1;grid-row-end:-1;}",".fwpfdsa{-ms-grid-column:1;grid-column-start:1;}",".fuur7zz{-ms-grid-column-span:-1;grid-column-end:-1;}",".f1g0x7ka{padding-top:0;}",".fhxju0i{padding-right:0;}",".f1cnd47f{padding-left:0;}",".f1qch9an{padding-bottom:0;}",".f1hu3pq6{margin-top:0;}",".f11qmguv{margin-right:0;}",".f1tyq0we{margin-left:0;}",".f19f4twv{margin-bottom:0;}",".f158kwzp{cursor:default;}",".f1yfdkfd{height:var(--fui-Slider__thumb--size);}",".fly5x3f{width:100%;}",".f1l02sjl{height:100%;}",".f174ca62{width:var(--fui-Slider__thumb--size);}",".f1r9mf01{-webkit-appearance:slider-vertical;}"]});function tR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function nR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tR(Object(n),!0).forEach((function(t){RP()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oR=ZP,rR=JP,iR=KP,aR=n(2361);function sR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function lR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sR(Object(n),!0).forEach((function(t){RP()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var cR=(e,t)=>{e=Object(DP.a)(e,{supportsLabelFor:!0});var n=Object(jP.b)({props:e,primarySlotTagName:"input",excludedPropNames:["onChange","size"]}),o=e,r=o.disabled,i=o.vertical,a=o.size,s=void 0===a?"medium":a,l=o.root,c=o.input,u=o.rail,d=o.thumb,p={disabled:r,size:s,vertical:i,components:{input:"input",rail:"div",root:"div",thumb:"div"},root:Object(BP.a)(l,{required:!0,defaultProps:n.root}),input:Object(BP.a)(c,{required:!0,defaultProps:lR(lR({id:Object(FP.a)("slider-",e.id),ref:t},n.primary),{},{type:"range",orient:i?"vertical":void 0})}),rail:Object(BP.a)(u,{required:!0}),thumb:Object(BP.a)(d,{required:!0})};return p.root.ref=Object(LP.a)(p.root.ref,Object(aR.a)()),((e,t)=>{var n=t.defaultValue,o=void 0===n?0:n,r=t.min,i=void 0===r?0:r,a=t.max,s=void 0===a?100:a,l=t.step,c=t.value,u=Object(zP.b)().dir,d=Object(NP.a)({state:void 0!==c?WP(c,i,s):void 0,defaultState:WP(o,i,s),initialState:0}),p=AP()(d,2),h=p[0],g=p[1],m=((e,t,n)=>n===t?0:(e-t)/(n-t)*100)(h,i,s),f=e.input.onChange,b=t.onChange,v=Object(HP.a)(e=>{var t=Number(e.target.value);g(WP(t,i,s)),f&&f!==b?f(e):b&&b(e,{value:t})}),y={[iR]:e.vertical?"0deg":"ltr"===u?"90deg":"270deg",[oR]:l&&l>0?"".concat(100*l/(s-i),"%"):"",[rR]:"".concat(m,"%")};e.root.style=nR(nR({},y),e.root.style),e.input.value=h,e.input.onChange=v})(p,e),p},uR=n(1935),dR=function(e,t){var n=e.label,o=e.text,r=e.value,i=o?"".concat(n," ").concat(o):n,a=function(e,t){var n=e.id,o=e.customTooltip,r=e.location,i=e.tooltipDirection;return Object(uR.a)(t,{customTooltip:o,id:n,direction:i,location:r}).mergedRef}(e,t),s=function(e){var t=e.id,n=e.location,o=e.onExecute;return O.useCallback((function(e,r){o&&o({id:t,value:r.value,location:n})}),[t,n,o])}(e);return cR(Object(k.__assign)(Object(k.__assign)({},e),{value:Math.floor(r),onChange:s,type:"slider","aria-valuetext":i}),a)},pR=n(302),hR=n(559),gR=O.memo(O.forwardRef((function(e,t){var n=function(e,t){var n=e.dataAutomationType;return dR(Object(k.__assign)(Object(k.__assign)({},e),{size:"small",dataAutomationType:null!=n?n:"StatusBarSlider"}),t)}(e,t);return(e=>{var t=YP(),n=XP(),o=$P(),r=eR(),i=e.vertical;e.root.className=Object(EI.a)(GP,t.root,i?t.focusIndicatorVertical:t.focusIndicatorHorizontal,t[e.size],i?t.vertical:t.horizontal,e.disabled?t.disabled:t.enabled,e.root.className),e.rail.className=Object(EI.a)(UP,n.rail,i?n.vertical:n.horizontal,e.rail.className),e.thumb.className=Object(EI.a)(qP,o.thumb,i?o.vertical:o.horizontal,e.disabled&&o.disabled,e.thumb.className),e.input.className=Object(EI.a)(QP,r.input,i?r.vertical:r.horizontal,e.disabled&&r.disabled,e.input.className)})(n),(e=>{var t=Object(hR.a)(e),n=t.slots,o=t.slotProps;return Object(pR.a)(n.root,o.root,Object(pR.a)(n.input,o.input),Object(pR.a)(n.rail,o.rail),Object(pR.a)(n.thumb,o.thumb))})(n)})));gR.displayName="next/StatusBarSlider";var mR,fR=O.forwardRef((function(e,t){e.type;var n=e.appColors,o=e.disabled,r=Object(k.__rest)(e,["type","appColors","disabled"]);return O.createElement(Bo.a,null,(function(e){return O.createElement(IP.a,Object(k.__assign)({ref:t,type:"AppSliderProps",disabled:o},r,{styles:_P(e,o,n)}))}))})),bR=O.forwardRef((function(e,t){var n;return(n=O.useContext(Jd.a),Object(dm.a)(n,dm.f.fluentV9StatusBarSliderEnabled))?O.createElement(gR,Object(k.__assign)({ref:t},e,{type:"AppSliderProps"})):O.createElement(fR,Object(k.__assign)({ref:t},e))})),vR=function(e){var t,n=e.increaseZoomButtonProps,o=e.decreaseZoomButtonProps,r=e.zoomLabelProps,i=e.zoomSliderProps,a=e.zoomLevelButtonProps,s=e.showSlider,l=e.isJumbo,c=e.appColors,u=e.location,d=Object(dm.a)(O.useContext(Jd.a),dm.f.zoomSliderIsEnabled),p={isJumbo:l},h=X_(),g=(t=a.className,Object(EI.a)(z_().label,t));return d?O.createElement(O.Fragment,null,O.createElement(eP,Object(k.__assign)({},o,p,{styles:Object(V.I)(A_,o.styles),noDomId:!0,applyZoomIconStyles:!0,location:u})),s?O.createElement(bR,Object(k.__assign)({},i,{appColors:c,location:u})):O.createElement(eP,Object(k.__assign)({},a,p,{styles:Object(V.I)(W_,a.styles),className:h?g:a.className,location:u})),O.createElement(eP,Object(k.__assign)({},n,p,{styles:Object(V.I)(A_,n.styles),noDomId:!0,applyZoomIconStyles:!0,location:u})),s&&O.createElement(eP,Object(k.__assign)({},a,p,{styles:Object(V.I)(W_,a.styles),className:h?g:a.className,location:u}))):O.createElement(O.Fragment,null,O.createElement(eP,Object(k.__assign)({},o,p,{styles:Object(V.I)(A_,o.styles),noDomId:!0,applyZoomIconStyles:!0,location:u})),O.createElement(yP,Object(k.__assign)({},r,p,{styles:N_})),O.createElement(eP,Object(k.__assign)({},n,p,{styles:Object(V.I)(A_,n.styles),noDomId:!0,applyZoomIconStyles:!0,location:u})))},yR=Object(KS.strEnum)(["left","center","right"]),xR={display:"inline-flex",selectors:{":empty":{display:"none"}}},CR=((mR={})[yR.left]=Object(k.__assign)(Object(k.__assign)({},xR),{flex:"1 0 0px",justifyContent:"flex-start"}),mR[yR.center]=Object(k.__assign)(Object(k.__assign)({},xR),{flex:"1 1 0px",justifyContent:"center",marginLeft:5,marginRight:5}),mR[yR.right]=Object(k.__assign)(Object(k.__assign)({},xR),{flex:"1 0 0px",justifyContent:"flex-end"}),mR),SR=Object(Po.c)((function(e,t){return t?Object(V.eb)(CR[e],t[e]):Object(V.eb)(CR[e])})),ER=function(e){var t=e.position,n=e.children,o=e.regionStyles;return O.createElement("div",{className:SR(t,o)},n)},kR=n(336);function OR(e,t){return Object(k.__assign)(Object(k.__assign)({},e),{cacheKey:TR(t,Object.keys(e.scaledStatusBarControls).map((function(t){return e.scaledStatusBarControls[t]})))})}function TR(e,t){return kR(JSON.stringify({isSpanning:e,controlRegions:t.map((function(e,t){return{regionId:t,controls:e.map((function(e){return function e(t){switch(t.type){case"StatusBarButtonProps":case"StatusBarToggleButtonProps":case"StatusBarFlyoutAnchorProps":return{controlType:t.type,id:t.id,labelCharacterLength:t.hideLabel?0:t.label.length};case"StatusBarLabelProps":return{controlType:t.type,id:t.id,labelCharacterLength:t.label.length};case"StatusBarSliderProps":return{controlType:t.type,id:t.id};case"StatusBarZoomControlProps":return{controlType:t.type,id:t.id,showSlider:String(t.showSlider),increaseZoom:JSON.stringify(e(t.increaseZoomButtonProps)),zoomLabel:JSON.stringify(e(t.zoomLabelProps)),zoomLevelButton:JSON.stringify(e(t.zoomLevelButtonProps)),decreaseZoom:JSON.stringify(e(t.decreaseZoomButtonProps)),zoomSlider:JSON.stringify(e(t.zoomSliderProps))};default:throw new Error("The following StatusBarControlProps is not valid as a status bar control"+t)}}(e)}))}}))})).toString(36)}function IR(e){return{controlId:e,type:"DropLabel"}}function wR(e){return{controlId:e,type:"HideControl"}}function _R(e){return{controlId:e,type:"CompressControl"}}var PR=function(e,t){var n=function(e){if(e.appliedScalingStepCount===e.scalingSteps.length)return;var t=e.appliedScalingStepCount+1;return jR(e,t)}(e);if(void 0!==n)return OR(n,t)},RR=function(e,t){var n=function(e){if(0===e.appliedScalingStepCount)return;var t=e.appliedScalingStepCount-1;return jR(e,t)}(e);if(void 0!==n)return OR(n,t)};var DR=Object(Po.c)((function(e,t,n){var o=BR(t,n),r={left:[],center:[],right:[]};return Object.keys(e).forEach((function(t){r[t]=FR(e[t],o)})),r}));function jR(e,t){var n=DR(e.statusBarControls,e.scalingSteps,t);return Object(k.__assign)(Object(k.__assign)({},e),{scaledStatusBarControls:n,appliedScalingStepCount:t})}var BR=Object(Po.c)((function(e,t){var n=e.slice(0,t),o=[];return n.forEach((function(e){o=o.concat(e)})),o}));var FR=Object(Po.c)((function(e,t){var n=Object(k.__spreadArray)([],e,!0);return t.forEach((function(e){var t=Object(Vy.e)(n,(function(t){return t.id===e.controlId}));if(-1!==t)switch(e.type){case"HideControl":n.splice(t,1);break;case"DropLabel":var o=Object(k.__assign)({},n[t]);"StatusBarLabelProps"===o.type?n.splice(t,1):"StatusBarZoomControlProps"===o.type||(o.hideLabel=!0,n.splice(t,1,o));break;case"CompressControl":var r=Object(k.__assign)({},n[t]);"StatusBarZoomControlProps"===r.type&&(r.showSlider=!1,n.splice(t,1,r));break;default:Object(Yb.a)(e)}})),n})),LR=Object(Po.c)((function(e,t,n){var o=k_(e),r={outerContainer:Object(k.__assign)(Object(k.__assign)({display:"flex",position:"relative",width:"100%",maxWidth:void 0,selectors:{"@-moz-document url-prefix()":{maxWidth:"100vw"}},height:t?40:24},t?{}:{borderTop:"1px solid ".concat(o.defaultBorder)}),{boxSizing:"content-box",overflow:"hidden",backgroundColor:o.defaultBackground}),container:{display:"flex",padding:"0 12px",boxSizing:"border-box",width:"100%",overflow:"hidden"},resizeGroup:{width:"100%",overflow:"hidden"}};return Object(V.db)(r,n)})),MR=function(e){function t(t){var n=e.call(this,t)||this;return n._spanningChangedStatusBarId="statusBar",n.spanningChanged=function(e,t){n.setState({isDoublePortraitLayout:e&&"DP"===t})},n.onRenderItem=function(e){var t,o,r,i,a,s,l,c,u,d,p,h,g,m,f,b,v,y,x,C,S=(t=n.props).appliedScalingSteps,E=t.appColors,T=t.location,I=e.type,w=e.id,_=void 0;if(S){if(null===(o=S.HideControl)||void 0===o?void 0:o[w])return null;if(null===(r=S.DropLabel)||void 0===r?void 0:r[w]){if("StatusBarLabelProps"===I)return null;_=!0}}switch(T&&(e.location=T),e.type){case"StatusBarButtonProps":return O.createElement(eP,Object(k.__assign)({},e,{hideLabel:null!=_?_:e.hideLabel,key:w,styles:null!==(a=null===(i=n.props.statusBarStyles)||void 0===i?void 0:i.statusBarButtonStyles)&&void 0!==a?a:e.styles}));case"StatusBarToggleButtonProps":return O.createElement(TP,Object(k.__assign)({},e,{hideLabel:null!=_?_:e.hideLabel,key:w,styles:null!==(l=null===(s=n.props.statusBarStyles)||void 0===s?void 0:s.statusBarButtonStyles)&&void 0!==l?l:e.styles}));case"StatusBarLabelProps":return O.createElement(yP,Object(k.__assign)({},e,{iconProps:e.iconProps&&Object(k.__assign)(Object(k.__assign)({},e.iconProps),{styles:null!==(u=null===(c=n.props.statusBarStyles)||void 0===c?void 0:c.statusBarLabelIconStyles)&&void 0!==u?u:e.iconProps.styles}),key:w,styles:null!==(p=null===(d=n.props.statusBarStyles)||void 0===d?void 0:d.statusBarLabelStyles)&&void 0!==p?p:e.styles}));case"StatusBarFlyoutAnchorProps":return O.createElement(hP,Object(k.__assign)({},e,{hideLabel:null!=_?_:e.hideLabel,key:w,styles:null!==(g=null===(h=n.props.statusBarStyles)||void 0===h?void 0:h.statusBarButtonStyles)&&void 0!==g?g:e.styles,customMenuItemStyles:null===(m=n.props.statusBarStyles)||void 0===m?void 0:m.menuItemStyleClassNames}));case"StatusBarZoomControlProps":return O.createElement(vR,Object(k.__assign)({},e,{increaseZoomButtonProps:Object(k.__assign)(Object(k.__assign)({},e.increaseZoomButtonProps),{styles:null!==(b=null===(f=n.props.statusBarStyles)||void 0===f?void 0:f.statusBarButtonStyles)&&void 0!==b?b:e.increaseZoomButtonProps.styles}),decreaseZoomButtonProps:Object(k.__assign)(Object(k.__assign)({},e.decreaseZoomButtonProps),{styles:null!==(y=null===(v=n.props.statusBarStyles)||void 0===v?void 0:v.statusBarButtonStyles)&&void 0!==y?y:e.decreaseZoomButtonProps.styles}),zoomLevelButtonProps:Object(k.__assign)(Object(k.__assign)({},e.zoomLevelButtonProps),{styles:null!==(C=null===(x=n.props.statusBarStyles)||void 0===x?void 0:x.statusBarButtonStyles)&&void 0!==C?C:e.zoomLevelButtonProps.styles}),key:w,appColors:E}));default:return null}},n.onResizeGroupReduce=function(e){return PR(e,n.state.isDoublePortraitLayout)},n.onResizeGroupGrow=function(e){return RR(e,n.state.isDoublePortraitLayout)},n.renderPrimaryScreenStatusBar=Object(Po.c)((function(e){return function(t){var o,r=(o=t.scaledStatusBarControls).left,i=o.center,a=o.right,s=n.state.isDoublePortraitLayout,l=a,c=n.props.endRegionPrimaryScreenControlsIds||[];s&&(l=a.filter((function(e){return c.indexOf(e.id)>=0})));var u=LR(e);return n.renderThreeRegionBar(r,i,l,u.container)}})),n.state={isDoublePortraitLayout:Object(As.isDPMode)()},Object(As.registerSpanningChanged)(n._spanningChangedStatusBarId,n.spanningChanged),n}return Object(k.__extends)(t,e),t.prototype.componentWillUnmount=function(){Object(As.unregisterSpanningChanged)(this._spanningChangedStatusBarId)},t.prototype.renderRegionItems=function(e){var t=this;return e?e.map((function(e){return t.onRenderItem(Object(k.__assign)(Object(k.__assign)({},e),{isJumbo:t.props.isJumbo}))})):null},t.prototype.render=function(){var e=this;if(this.props.hidden)return null;var t=this.state.isDoublePortraitLayout,n=[];if(t){var o=this.props.endRegionPrimaryScreenControlsIds||[];n=this.props.controls.right.filter((function(e){return o.indexOf(e.id)<0}))}var r,i=(r=this.context,"function"==typeof window.ResizeObserver&&Object(dm.a)(r,dm.f.decentralizedScalingLogicIsEnabled)&&!Object(L.e)());return O.createElement(Bo.a,null,(function(o){var r,a,s=LR(o,e.props.isJumbo,null===(r=e.props.statusBarStyles)||void 0===r?void 0:r.statusBarContainerStyles);return O.createElement(td.a,null,O.createElement(Da.a,{direction:Zt.a.horizontal,"data-is-focusable":!0,isCircularNavigation:null===(a=e.props.isCircularNavigation)||void 0===a||a,handleTabKey:Zt.b.all},O.createElement("div",{className:s.outerContainer},i&&e.props.onScalingStepDispatch&&void 0!==e.props.appliedScalingStepsCount?O.createElement(S_,{steps:e.props.scalingSteps||[],onScalingStepDispatch:e.props.onScalingStepDispatch,appliedScalingStepsCount:e.props.appliedScalingStepsCount},e.renderPrimaryScreenStatusBar(o)({scaledStatusBarControls:e.props.controls})):O.createElement(Tx.a,{className:s.resizeGroup,direction:Ix.a.horizontal,onRenderData:e.renderPrimaryScreenStatusBar(o),onReduceData:e.onResizeGroupReduce,onGrowData:e.onResizeGroupGrow,data:OR(e.getInitialScalingState(),e.state.isDoublePortraitLayout)}),t&&e.renderThreeRegionBar(void 0,void 0,n,s.container))))}))},t.prototype.getInitialScalingState=function(){return{scalingSteps:this.props.scalingSteps||[],appliedScalingStepCount:0,statusBarControls:this.props.controls,scaledStatusBarControls:this.props.controls}},t.prototype.renderThreeRegionBar=function(e,t,n,o){var r,i,a;return O.createElement("div",{className:o},O.createElement(ER,{position:yR.left,regionStyles:null===(r=this.props.statusBarStyles)||void 0===r?void 0:r.statusBarRegionStyles},this.renderRegionItems(e)),O.createElement(ER,{position:yR.center,regionStyles:null===(i=this.props.statusBarStyles)||void 0===i?void 0:i.statusBarRegionStyles},this.renderRegionItems(t)),O.createElement(ER,{position:yR.right,regionStyles:null===(a=this.props.statusBarStyles)||void 0===a?void 0:a.statusBarRegionStyles},this.renderRegionItems(n)))},t.contextType=Jd.a,t}(O.Component),AR=Object(Ir.connect)((function(e,t){var n;Object(Wm.j)("StatusBar");var o={hidden:!!(null===(n=Hw(e,t))||void 0===n?void 0:n.hidden),controls:Zw(e,t),endRegionPrimaryScreenControlsIds:Vw(e,t),scalingSteps:Gw(e,t),isJumbo:t.isJumbo,id:"StatusBar",appliedScalingSteps:Uw(e,t),appliedScalingStepsCount:qw(e,t),appColors:t.appColors,statusBarStyles:t.statusBarStyles,location:t.location,isCircularNavigation:t.isCircularNavigation};return Object(Wm.j)("StatusBar","Selectors"),o}),(function(e,t){return{onScalingStepDispatch:function(n,o,r){return e(function(e,t,n){return Object(ur.a)(dr.Fc,{statusBarId:e,step:t,removeNotAdd:n})}(t.id,o,r))}}}),void 0,{areStatesEqual:Object(Tr.a)("StatusBar")})(Object(Or.a)(MR)),NR=function(e){return O.createElement(CC.a,null,O.createElement(AR,Object(k.__assign)({},e)))},WR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(k.__extends)(t,e),t.prototype.render=function(){var e=this;return O.createElement(cl.a,null,O.createElement(Ir.Provider,{store:kC.a},O.createElement(Bo.a,null,(function(t){var n,o;return O.createElement(NR,{id:e.props.id,isJumbo:e.props.isJumbo,statusBarStyles:null===(o=(n=e.props).getStatusBarStyles)||void 0===o?void 0:o.call(n,t),location:e.props.location})}))))},t}(O.Component),HR=Object(Po.c)((function(e){var t=k_(e);return{statusBarButtonStyles:KR(e),statusBarLabelIconStyles:QR,statusBarLabelStyles:JR(),statusBarRegionStyles:Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.ShowHelpIconsOnStatusBar",!1)?Object(V.db)(GR(e),UR()):GR(e),menuItemStyleClassNames:qR(t),statusBarContainerStyles:VR(t)}})),zR=function(e,t,n,o){return{marginLeft:e,marginRight:t,marginTop:n,marginBottom:o}},VR=Object(Po.c)((function(e){return{outerContainer:{backgroundColor:e.whiteBackground,paddingLeft:0,paddingRight:0,height:22}}})),GR=Object(Po.c)((function(e){var t;return(t={})[yR.left]={justifyContent:"left",left:0,whiteSpace:"nowrap"},t[yR.center]=Object(k.__assign)(Object(k.__assign)({justifyContent:"center"},zR(5,5,0,0)),{whiteSpace:"nowrap"}),t[yR.right]={justifyContent:"right",whiteSpace:"nowrap","[data-unique-id*=ZoomDecrease]":{width:"28px"},"[data-unique-id*=ZoomIncrease]":{width:"28px"},"[data-unique-id*=ToggleFullScreenButton]":{width:"28px",paddingBottom:"2px"},"#ToggleFullScreenButton .ms-Button-label":{display:"none"},".ms-Button:first-child svg":{fill:e.palette.neutralPrimaryAlt},"#ZoomStatusBarMenuOpen .ms-Button-label":{minWidth:30,justifyContent:"center"}},t})),UR=Object(Po.c)((function(){var e,t;return(e={})[yR.right]={"[data-unique-id=StatusBar-KeyboardShortcutsButton], [data-unique-id=StatusBar-HelpButton], [data-unique-id=StatusBar-GiveFeedbackPane], [data-unique-id=StatusBar-GiveFeedbackButton]":(t={},t.i={width:"16px",height:"16px"},t.width="28px",t)},e})),qR=Object(Po.c)((function(e){return Object(V.db)({root:{border:"1px solid transparent",backgroundColor:e.whiteBackground,height:28,paddingLeft:0,paddingRight:0,minWidth:74},linkContent:{height:28,alignItems:"center"},icon:Object(k.__assign)(Object(k.__assign)({width:12,height:12},zR(7,7,8,8)),{fontSize:0,paddingRight:0,verticalAlign:"top"}),label:Object(k.__assign)(Object(k.__assign)({fontSize:12,fontWeight:400},zR(7,7,8,8)),{verticalAlign:"top"})})})),QR={root:{width:14,height:14}},KR=Object(Po.c)((function(e){var t;return{root:Object(k.__assign)(Object(k.__assign)({paddingLeft:1,paddingRight:1},zR(2,2,0,0)),(t={minWidth:0},t[V.m]={MsHighContrastAdjust:"auto"},t)),rootHovered:{backgroundColor:e.palette.themeLighter},rootPressed:{backgroundColor:e.palette.themeLight},rootExpanded:{backgroundColor:e.palette.themeLight},rootFocused:{backgroundColor:e.palette.themeLighter},icon:{width:12,height:12}}})),JR=Object(Po.c)((function(){return{root:Object(k.__assign)({alignItems:"center",userSelect:"none",verticalAlign:"top",paddingLeft:1,paddingRight:1},zR(2,2,0,0))}})),ZR=function(e){var t=k_(e);return{statusBarButtonStyles:$R(e),statusBarLabelIconStyles:tD,statusBarLabelStyles:eD,statusBarRegionStyles:YR(t),menuItemStyleClassNames:nD,statusBarContainerStyles:XR(t)}},YR=function(e){var t;return(t={})[yR.left]={flex:"1 0 0px",justifyContent:"flex-start",position:"absolute"},t[yR.center]={flex:"1 1 0px",justifyContent:"center",marginLeft:5,marginRight:5},t[yR.right]={flex:"1 0 0px",justifyContent:"flex-end",position:"absolute",right:0,backgroundColor:e.whiteBackground},t},XR=function(e){return{outerContainer:{height:42,backgroundColor:e.whiteBackground}}},$R=function(e){return{root:{height:42,minWidth:40,border:"1px solid transparent",borderRadius:0,boxSizing:"border-box",paddingLeft:4,paddingRight:4,paddingTop:0,paddingBottom:0,backgroundColor:"transparent"},rootHovered:{backgroundColor:"transparent"},rootExpanded:{backgroundColor:e.palette.themeLight},rootChecked:{backgroundColor:e.palette.themeLight},rootFocused:{backgroundColor:e.palette.themeLight},label:{fontSize:17,fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',cursor:"default",textAlign:"center",userSelect:"none",whiteSpace:"nowrap",overflow:"visible",textOverflow:"unset",lineHeight:42,margin:"0 4px",paddingTop:0,paddingBottom:0,height:42,display:"flex",alignItems:"center"},icon:{height:20,lineHeight:20,width:20,marginLeft:0,marginRight:0},menuIcon:{height:20,lineHeight:20,width:20,marginLeft:0,marginRight:0}}},eD={root:{display:"flex",flexWrap:"nowrap",alignItems:"center",userSelect:"none",padding:"0 9px 0 0"},label:{overflow:"hidden",overflowX:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:400,fontSize:17,cursor:"default !important"}},tD={root:{width:32,height:32,alignItems:"center",paddingRight:9,fontWeight:600}},nD=Object(V.db)({outerHeight:50,innerHeight:48,icon:{width:20,height:20,lineHeight:20},label:{fontSize:14},linkContent:{height:50,display:"flex",alignItems:"center",position:"relative"},root:{height:50,lineHeight:50,border:"0px solid transparent",selectors:{":hover":{backgroundColor:"transparent",outlineColor:"transparent"},":focus":{backgroundColor:"transparent",outlineColor:"transparent"}}}}),oD=n(285),rD=Object(KS.strEnum)(["ToggleDevServer","ToggleOOUIDevServer","PasteShortcutEnabledLabel","ProgressLabel","ClassificationLabel","SheetNumber","WorkbookStatisticsButton","PageLoadStatsDialog","CoauthInfraStatistics","SelectionModeLabel","EndModeLabel","LongTasksCount","CenterStatusLabel","MergeSuspensionSafeState","OcsConnectionStatus","EnvironmentName","PhaseStatus","DataSourceDirtinessButton","NetworkInformation","ExcelLiveViewState","NetworkDisconnectedLabel","NetworkConnectedLabel","OfficeAddinLabel","QueryAverageLabel","QueryCountLabel","QueryNumericalCountLabel","QueryMinimumLabel","QueryMaximumLabel","QuerySumLabel","CustomizeStatusBarMenuOpen","ToggleAverageButton","ToggleCountButton","ToggleNumericalCountButton","ToggleMinButton","ToggleMaxButton","ToggleSumButton","HelpButton","KeyboardShortcutsButton","GiveFeedbackButton","GiveFeedbackPane","ZoomDecrease","ZoomStatusBarMenuOpen","ZoomIncrease","Zoom200","Zoom175","Zoom150","Zoom125","Zoom100","Zoom75","Zoom50","Zoom25","ToggleFullScreenButton"]);function iD(e){return function(e,t){if(!e)return t;return t.filter((function(t){return e[t.controlId]}))}(e,Object(k.__spreadArray)(Object(k.__spreadArray)([_R(rD.ZoomIncrease),_R(rD.ZoomDecrease),_R(rD.ZoomStatusBarMenuOpen),_R(rD.ToggleFullScreenButton),IR(rD.ExcelLiveViewState),IR(rD.NetworkInformation),IR(rD.PhaseStatus),IR(rD.EnvironmentName),IR(rD.OcsConnectionStatus),IR(rD.CenterStatusLabel),IR(rD.LongTasksCount),wR(rD.MergeSuspensionSafeState),wR(rD.DataSourceDirtinessButton),IR(rD.EndModeLabel),IR(rD.SelectionModeLabel),wR(rD.CoauthInfraStatistics),wR(rD.WorkbookStatisticsButton),wR(rD.SheetNumber),wR(rD.PageLoadStatsDialog),IR(rD.ClassificationLabel)],Object(yt.isChangeGateEnabled)("OfficeVSO:8485697_RemovingProgressLabelFromReactStatusBar")?[]:[IR(rD.ProgressLabel)],!0),[IR(rD.PasteShortcutEnabledLabel),wR(rD.ToggleOOUIDevServer),wR(rD.ToggleDevServer),IR(rD.NetworkDisconnectedLabel),IR(rD.NetworkConnectedLabel),wR(rD.OfficeAddinLabel),IR(rD.QueryAverageLabel),IR(rD.QueryCountLabel),IR(rD.QueryNumericalCountLabel),IR(rD.QueryMinimumLabel),IR(rD.QueryMaximumLabel),IR(rD.QuerySumLabel),wR(rD.CustomizeStatusBarMenuOpen),wR(rD.GiveFeedbackPane),wR(rD.GiveFeedbackButton),wR(rD.ZoomDecrease),wR(rD.ZoomIncrease),wR(rD.ZoomStatusBarMenuOpen)],!1))}function aD(e,t){return e?t.filter((function(t){return e[t]})):t}var sD=Object(nT.a)("StatusBar:initializeStatusBarInStore",(function(e){var t,n;c_(),Object(Wy.a)(Object(k.__spreadArray)(Object(k.__spreadArray)([Object(fI.a)(Object(k.__spreadArray)(Object(k.__spreadArray)(Object(k.__spreadArray)(Object(k.__spreadArray)([Object(oD.a)(rD.ToggleDevServer,"DevServer Status: Unknown",{toggled:!0}),Object(oD.a)(rD.ToggleOOUIDevServer,"OOUI: Unknown",{toggled:!0}),Object(i_.b)(rD.PasteShortcutEnabledLabel,ExcelRibbonStrings.EnterToPaste,{hidden:!0})],Object(yt.isChangeGateEnabled)("OfficeVSO:8485697_RemovingProgressLabelFromReactStatusBar")?[]:[Object(i_.b)(rD.ProgressLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"})],!0),[Object(i_.b)(rD.ClassificationLabel,"",{hidden:!0,iconSet:{default:c.a.SBStatusBarMarkAsReadOnly_16,icon16:c.a.SBProtectForm_16},ariaLiveAssertiveness:"off"}),Object(n_.a)(rD.SheetNumber,ExcelRibbonStrings.SheetNumber,{customTooltip:ExcelRibbonStrings.SheetNumber}),Object(n_.a)(rD.WorkbookStatisticsButton,ExcelRibbonStrings.WorkbookStatistics,{customTooltip:ExcelRibbonStrings.WorkbookStatistics}),Object(n_.a)(rD.PageLoadStatsDialog,ExcelRibbonStrings.PageLoadStatistics,{customTooltip:ExcelRibbonStrings.PageLoadStatistics}),Object(n_.a)(rD.CoauthInfraStatistics,"CoauthInfraStatistics",{customTooltip:"CoauthInfraStatistics"}),Object(i_.b)(rD.SelectionModeLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.EndModeLabel,ExcelRibbonStrings.EndMode,{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.LongTasksCount,"",{customTooltip:ExcelRibbonStrings.LongTaskTooltip,hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.CenterStatusLabel,ExcelRibbonStrings.TextForOfficeOnlineInGallatin,{ariaLiveAssertiveness:"off"}),Object(oD.a)(rD.MergeSuspensionSafeState,"",{toggled:!0}),Object(i_.b)(rD.OcsConnectionStatus,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.EnvironmentName,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.PhaseStatus,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(n_.a)(rD.DataSourceDirtinessButton,ExcelRibbonStrings.DataSourceDirtiness,{hidden:!0}),Object(i_.b)(rD.NetworkInformation,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.ExcelLiveViewState,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.NetworkDisconnectedLabel,ExcelRibbonStrings.Disconnected,{iconSet:{default:W.a.AlertWarning_16},hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.NetworkConnectedLabel,ExcelRibbonStrings.Connected,{hidden:!0,ariaLiveAssertiveness:"off"}),Object(n_.a)(rD.OfficeAddinLabel,"",{iconSet:{default:c.a.AppForOfficeLogo_20},customTooltip:ExcelRibbonStrings.Addins,hidden:!0}),Object(i_.b)(rD.QueryAverageLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.QueryCountLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.QueryNumericalCountLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.QueryMinimumLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.QueryMaximumLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(i_.b)(rD.QuerySumLabel,"",{hidden:!0,ariaLiveAssertiveness:"off"}),Object(oD.a)(rD.ToggleAverageButton,"",{customTooltip:ExcelRibbonStrings.AverageDescription,iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(oD.a)(rD.ToggleCountButton,"",{customTooltip:ExcelRibbonStrings.CountDescription,iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(oD.a)(rD.ToggleNumericalCountButton,"",{customTooltip:ExcelRibbonStrings.NumericalCountDescription,iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(oD.a)(rD.ToggleMaxButton,"",{customTooltip:ExcelRibbonStrings.MaximumDescription,iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(oD.a)(rD.ToggleMinButton,"",{customTooltip:ExcelRibbonStrings.MinimumDescription,iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(oD.a)(rD.ToggleSumButton,"",{customTooltip:ExcelRibbonStrings.SumDescription,iconSet:{default:c.a.CheckmarkGlyph_8},toggleUsingIcon:!0,dismissHostingSurfaceOnExecute:!1}),Object(o_.a)(rD.CustomizeStatusBarMenuOpen,"",{iconSet:{default:c.a.CommonControlChevronDownGlyph_8},customTooltip:ExcelRibbonStrings.CustomiseStatusBar,hideChevron:!0,menuModel:Object(r_.a)([Object(r_.b)([rD.ToggleAverageButton,rD.ToggleCountButton,rD.ToggleNumericalCountButton,rD.ToggleMinButton,rD.ToggleMaxButton,rD.ToggleSumButton])],ExcelRibbonStrings.CustomiseStatusBar)})],!1),Object(yt.getBooleanFeatureGate)("Microsoft.Office.Excel.ShowHelpIconsOnStatusBar",!1)?[Object(n_.a)(rD.KeyboardShortcutsButton,ExcelRibbonStrings.KeyboardShortcutsDialogButtonLabel,{iconSet:{default:W.a.KeyboardShortcuts_16},customTooltip:ExcelRibbonStrings.KeyboardShortcutsDialogButtonLabel,hideLabel:!0}),Object(n_.a)(rD.HelpButton,ExcelRibbonStrings.HelpResources,{iconSet:{default:W.a.QuestionCircle_16},customTooltip:ExcelRibbonStrings.HelpResources,hideLabel:!0}),Object(n_.a)(rD.GiveFeedbackButton,"",{iconSet:{default:W.a.PersonFeedback_16},customTooltip:ExcelRibbonStrings.HelpImproveOffice,hideLabel:!0}),Object(n_.a)(rD.GiveFeedbackPane,"",{iconSet:{default:W.a.PersonFeedback_16},customTooltip:ExcelRibbonStrings.HelpImproveOffice,hideLabel:!0})]:[Object(n_.a)(rD.GiveFeedbackButton,ExcelRibbonStrings.GiveFeedbackToMicrosoft,{customTooltip:ExcelRibbonStrings.HelpImproveOffice}),Object(n_.a)(rD.GiveFeedbackPane,ExcelRibbonStrings.GiveFeedbackToMicrosoft,{customTooltip:ExcelRibbonStrings.HelpImproveOffice})],!0),[Object(n_.a)(rD.ZoomDecrease,"",{customTooltip:ExcelRibbonStrings.StatusBarZoomOut,iconSet:{default:c.a.CommonControlSliderMinus_12},hideLabel:!0}),Object(n_.a)(rD.Zoom200,ExcelRibbonStrings.ZoomTo200),Object(n_.a)(rD.Zoom175,ExcelRibbonStrings.ZoomTo175),Object(n_.a)(rD.Zoom150,ExcelRibbonStrings.ZoomTo150),Object(n_.a)(rD.Zoom125,ExcelRibbonStrings.ZoomTo125),Object(n_.a)(rD.Zoom100,ExcelRibbonStrings.ZoomTo100),Object(n_.a)(rD.Zoom75,ExcelRibbonStrings.ZoomTo75),Object(n_.a)(rD.Zoom50,ExcelRibbonStrings.ZoomTo50),Object(n_.a)(rD.Zoom25,ExcelRibbonStrings.ZoomTo25),Object(o_.a)(rD.ZoomStatusBarMenuOpen,"Zoom",{customTooltip:ExcelRibbonStrings.ZoomToolTip,hideChevron:!0,menuModel:Object(r_.a)([Object(r_.b)([rD.Zoom200,rD.Zoom175,rD.Zoom150,rD.Zoom125,rD.Zoom100,rD.Zoom75,rD.Zoom50,rD.Zoom25])])}),Object(n_.a)(rD.ZoomIncrease,"",{customTooltip:ExcelRibbonStrings.StatusBarZoomIn,iconSet:{default:c.a.CommonControlSliderPlus_12},hideLabel:!0}),Object(oD.a)(rD.ToggleFullScreenButton,"",{customTooltip:ExcelRibbonStrings.FullScreen,iconSet:{default:c.a.FitToScreen_16}})],!1))],function(e){var t=aD(e,Object(k.__spreadArray)(Object(k.__spreadArray)([rD.ToggleDevServer,rD.ToggleOOUIDevServer,rD.PasteShortcutEnabledLabel],Object(yt.isChangeGateEnabled)("OfficeVSO:8485697_RemovingProgressLabelFromReactStatusBar")?[]:[rD.ProgressLabel],!0),[rD.ClassificationLabel,rD.SheetNumber,rD.WorkbookStatisticsButton,rD.PageLoadStatsDialog,rD.CoauthInfraStatistics,rD.SelectionModeLabel,rD.EndModeLabel],!1)),n=aD(e,[rD.LongTasksCount,rD.CenterStatusLabel,rD.MergeSuspensionSafeState,rD.OcsConnectionStatus,rD.EnvironmentName,rD.PhaseStatus,rD.DataSourceDirtinessButton,rD.NetworkInformation,rD.ExcelLiveViewState]),o=aD(e,[rD.NetworkDisconnectedLabel,rD.NetworkConnectedLabel,rD.OfficeAddinLabel,rD.QueryAverageLabel,rD.QueryCountLabel,rD.QueryNumericalCountLabel,rD.QueryMinimumLabel,rD.QueryMaximumLabel,rD.QuerySumLabel,rD.CustomizeStatusBarMenuOpen,rD.KeyboardShortcutsButton,rD.HelpButton,rD.GiveFeedbackButton,rD.GiveFeedbackPane,rD.ZoomDecrease,rD.ZoomStatusBarMenuOpen,rD.ZoomIncrease,rD.ToggleFullScreenButton]);return[a_(e_.ExcelStatusBar,{left:t,center:n,right:o}),s_(e_.ExcelStatusBar,rD.ZoomDecrease),s_(e_.ExcelStatusBar,rD.ZoomStatusBarMenuOpen),s_(e_.ExcelStatusBar,rD.ZoomIncrease)]}(e),!0),[(t=e_.ExcelStatusBar,n=iD(e),Object(ur.a)(dr.Nb,{statusBarId:t,scalingSteps:n}))],!1))})),lD="",cD=Object(nT.a)("StatusBar:initializeNewExcelStatusBar",(function(e,t,n){switch(n){case e_.ExcelViewerToolbar:lD="StatusBar:renderExcelStatusBar",p_();break;case e_.ExcelStatusBar:lD="StatusBar:renderStatusBar",sD(null==t?void 0:t.whitelistedControlIds)}setTimeout((function(){uD(e,n)}),0)})),uD=Object(nT.a)(lD,(function(e,t){var n=t===e_.ExcelViewerToolbar;Object(yt.isChangeGateEnabled)("OfficeVSO:8262217_fixingJsCrashWithThemeProvider")?e&&T.render(O.createElement(WR,{id:t,isJumbo:n,getStatusBarStyles:n?ZR:HR,location:n?ti.b.ViewerToolbar:ti.b.StatusBar}),e):T.render(O.createElement(WR,{id:t,isJumbo:n,getStatusBarStyles:n?ZR:HR,location:n?ti.b.ViewerToolbar:ti.b.StatusBar}),e)})),dD={initializeNewStatusBar:cD,selectors:t_};var pD,hD={initializeFeedbackModal:function(e,t,n,o){var r=e;r.onDismiss=t,r.onError=n,r.extractFeedbackDataForHost=o,r.uiType=Zh.Modal,r.hostPlatform=Yh.Web,r.invocationTimeStamp=Date.now();var l={customerUiWrapperFeedbackData:r};if(l&&l.customerUiWrapperFeedbackData){if(!Object(Re.b)("Microsoft.Office.SharedOnline.ShowFeedbackButtonCheck",!1)||Cg(l.customerUiWrapperFeedbackData,"OOUI initializeFeedbackModal"))try{i.a.sendTraceTag(508957007,a.a.msoulscat_Wac_WacFeedback,s.a.Info,mg("Centro-based Feedback Modal invoked ","OOUI initializeFeedbackModal",r.clientFeedbackId)),l.customerUiWrapperFeedbackData.initializationComplete=function(e){i.a.sendTraceTag(508952737,a.a.msoulscat_Wac_WacFeedback,s.a.Info,mg("Feedback initialization complete result: ".concat(JSON.stringify(e)),"OOUI initializeFeedbackModal initializationComplete",r.clientFeedbackId))},im(l)}catch(e){i.a.sendTraceTag(508956946,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Centro Initialization failed due to internal error => ".concat(e),"OOUI initializeFeedbackModal",r.clientFeedbackId))}}else i.a.sendTraceTag(508957008,a.a.msoulscat_Wac_WacFeedback,s.a.Error,mg("Centro Initialization failed for OCV Inapp Feedback due to missing feedback Taskpane props","OOUI initializeFeedbackModal",r.clientFeedbackId))},preloadFeedbackContext:function(e){return Object(k.__awaiter)(this,void 0,void 0,(function(){return Object(k.__generator)(this,(function(t){switch(t.label){case 0:return[4,am({customerUiWrapperFeedbackData:e})];case 1:return t.sent(),[2]}}))}))}},gD=n(264),mD={months:[ExcelDatepickerStrings.calendarMonth_January,ExcelDatepickerStrings.calendarMonth_February,ExcelDatepickerStrings.calendarMonth_March,ExcelDatepickerStrings.calendarMonth_April,ExcelDatepickerStrings.calendarMonth_May,ExcelDatepickerStrings.calendarMonth_June,ExcelDatepickerStrings.calendarMonth_July,ExcelDatepickerStrings.calendarMonth_August,ExcelDatepickerStrings.calendarMonth_September,ExcelDatepickerStrings.calendarMonth_October,ExcelDatepickerStrings.calendarMonth_November,ExcelDatepickerStrings.calendarMonth_December],shortMonths:[ExcelDatepickerStrings.januaryAbbreviated,ExcelDatepickerStrings.februaryAbbreviated,ExcelDatepickerStrings.marchAbbreviated,ExcelDatepickerStrings.aprilAbbreviated,ExcelDatepickerStrings.mayAbbreviated,ExcelDatepickerStrings.juneAbbreviated,ExcelDatepickerStrings.julyAbbreviated,ExcelDatepickerStrings.augustAbbreviated,ExcelDatepickerStrings.septemberAbbreviated,ExcelDatepickerStrings.octoberAbbreviated,ExcelDatepickerStrings.novemberAbbreviated,ExcelDatepickerStrings.decemberAbbreviated],days:[ExcelDatepickerStrings.calendarDayOfWeek_Sunday,ExcelDatepickerStrings.calendarDayOfWeek_Monday,ExcelDatepickerStrings.calendarDayOfWeek_Tuesday,ExcelDatepickerStrings.calendarDayOfWeek_Wednesday,ExcelDatepickerStrings.calendarDayOfWeek_Thursday,ExcelDatepickerStrings.calendarDayOfWeek_Friday,ExcelDatepickerStrings.calendarDayOfWeek_Saturday],shortDays:[ExcelDatepickerStrings.calendarDayOfWeek_Su,ExcelDatepickerStrings.calendarDayOfWeek_Mo,ExcelDatepickerStrings.calendarDayOfWeek_Tu,ExcelDatepickerStrings.calendarDayOfWeek_We,ExcelDatepickerStrings.calendarDayOfWeek_Th,ExcelDatepickerStrings.calendarDayOfWeek_Fr,ExcelDatepickerStrings.calendarDayOfWeek_Sa],goToToday:ExcelDatepickerStrings.goToTodayString,prevMonthAriaLabel:ExcelDatepickerStrings.goToPreviousMonthStringLowerCaseText,nextMonthAriaLabel:ExcelDatepickerStrings.goToNextMonthStringLowerCaseText,prevYearAriaLabel:ExcelDatepickerStrings.goToPreviousYearStringLowerCaseText,nextYearAriaLabel:ExcelDatepickerStrings.goToNextYearStringLowerCaseText,prevYearRangeAriaLabel:ExcelDatepickerStrings.goToPreviousYearRangeStringLowerCaseText,nextYearRangeAriaLabel:ExcelDatepickerStrings.goToNextYearRangeStringLowerCaseText,monthPickerHeaderAriaLabel:ExcelDatepickerStrings.monthPickerHeaderAriaLabel,yearPickerHeaderAriaLabel:ExcelDatepickerStrings.yearPickerHeaderAriaLabel,weekNumberFormatString:ExcelDatepickerStrings.weekNumberFormatString,selectedDateFormatString:ExcelDatepickerStrings.selectedDateFormatString,todayDateFormatString:ExcelDatepickerStrings.todayDateFormatString},fD=new Date(1900,0,1),bD=new Date(9999,11,31),vD=Object(yt.isChangeGateEnabled)("OfficeVSO:8347550_DatePicker_VerboseLogs"),yD=function(e){vD&&i.a.sendTraceTag(508101779,a.a.msoulscat_ES_EWAJS,s.a.Info,"[DatePicker-OOUI] ".concat(e))},xD=O.createRef(),CD=O.memo(O.forwardRef((function(e,t){var n=Object(O.useState)(e.isVisible),o=n[0],r=n[1],i=Object(O.useState)(!1),a=i[0],s=i[1],l=e.onDatePickerMount,c=O.useRef(e.cellDateValue),u=new Date,d=Object(yt.isChangeGateEnabled)("OfficeVSO:8172680_RemoveTodayDateHighlighting");Object(O.useEffect)((function(){c.current=e.cellDateValue,yD("Received new props. isVisible: ".concat(e.isVisible)),r(e.isVisible),s(!1)}),[e.isVisible,e.cellDateValue]),Object(O.useImperativeHandle)(t,(function(){return{hideDatePicker:function(){yD("Hiding datepicker through new way from UX layer"),r(!1)}}})),Object(O.useEffect)((function(){yD("Received new state. isVisible: ".concat(o," isFocused: ").concat(a))}),[o,a]);var p=O.useCallback((function(e){e&&(e.focus=function(){return Object(ua.c)(e)},l(e))}),[l]);return O.createElement(pw.a,{role:"dialog","aria-live":"polite",ariaLabel:a?ExcelRibbonStrings.FocusDatePicker:Object(L.f)()?ExcelRibbonStrings.ShowDatePickerMac:ExcelRibbonStrings.ShowDatePicker,onPointerDown:function(){a||(yD("Shifting focus to datepicker from UX layer"),s(!0),e.preserveFocus())},onFocus:function(){return s(!0)},className:Object(V.eb)([{display:"flex",flexDirection:"column",position:"absolute",alignItems:"center"}]),target:e.anchorElement,isBeakVisible:!1,hidden:!o,onDismiss:function(){yD("Dismissing datepicker from UX layer"),r(!1),e.restoreFocus()},setInitialFocus:!1,finalHeight:300,focusTrapProps:{isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0},directionalHint:e.isRTL?Y.a.leftTopEdge:Y.a.rightTopEdge},O.createElement("div",{ref:p,"aria-hidden":!a,className:Object(V.eb)({fontFamily:"Segoe UI",display:"flex",flexDirection:"column",width:"221px",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13);",borderRadius:"2px"})},O.createElement(_k.a,{calendarDayProps:{customDayCellRef:function(e,t,n){var o,r;d&&Object(gD.f)(t,u)&&n.dayIsToday&&(null===(r=null===(o=null==e?void 0:e.firstElementChild)||void 0===o?void 0:o.classList)||void 0===r||r.remove(n.dayIsToday))}},minDate:fD,maxDate:bD,showMonthPickerAsOverlay:!0,highlightSelectedMonth:!0,showGoToToday:!1,onSelectDate:function(t){yD("Setting selected date from UX layer"),r(!1),e.onDateSelected(t)},value:c.current,strings:mD})))})));function SD(e,t,n,o,r,i,a,s,l){T.render(O.createElement(CD,{ref:xD,anchorElement:t,isVisible:n,cellDateValue:o,onDateSelected:r,restoreFocus:i,preserveFocus:a,onDatePickerMount:s,isRTL:l}),e)}function ED(){var e;null===(e=xD.current)||void 0===e||e.hideDatePicker()}!function(e){e[e.EMPTY_RANGE=0]="EMPTY_RANGE",e[e.RANGE_CREATED=1]="RANGE_CREATED"}(pD||(pD={}));var kD=Object(Po.c)((function(e){return{calloutStyles:{root:{padding:"12px",borderRadius:"4px",boxShadow:e.effects.elevation16,border:"none",marginLeft:"-4px",".nameBox-statusCallout-subText":{padding:"0px 2px",borderRadius:"2px",margin:"0px 4px",fontWeight:600,fontSize:"12px",lineHeight:"16px",backgroundColor:e.palette.neutralLight,color:e.palette.neutralPrimaryAlt,alignSelf:"center"},".nameBox-statusCallout-subTitle":{fontWeight:400,display:"flex"}},beak:{left:"25px !important"},beakCurtain:{borderRadius:"4px"},calloutMain:{lineHeight:"20px"}},headingStyles:{root:{fontSize:"14px",fontWeight:"600"}}}})),OD=Object(Po.c)((function(){var e;return(e={})[pD.EMPTY_RANGE]={icon:d.a.AlertError_16,heading:ExcelRibbonStrings.NameRangeStatusCalloutHeaderEmptyRange,subtext:ExcelRibbonStrings.NameRangeStatusCalloutBodyEmptyRange},e[pD.RANGE_CREATED]={icon:W.a.NameRange_16,heading:ExcelRibbonStrings.NameRangeStatusCalloutHeaderRangeCreated},e})),TD=function(e){var t=OD()[e.calloutType],n=O.useRef(null),o=O.useState(!1),r=o[0],i=o[1],a=O.useCallback((function(){n.current&&clearTimeout(n.current)}),[n]),s=O.useCallback((function(){n.current=setTimeout((function(){i(!0)}),5e3)}),[n]);return O.useEffect((function(){return i(!1),s(),function(){a()}}),[e,s,a]),O.createElement(Bo.a,null,(function(n){var o=kD(n);return O.createElement(ds.a,{target:"#".concat("FormulaBar-NameBox"),role:"alert",beakWidth:8,directionalHint:Y.a.bottomLeftEdge,directionalHintFixed:!0,calloutWidth:292,hidden:r,styles:o.calloutStyles,onMouseEnter:a,onMouseLeave:s},O.createElement(Qe.a,{horizontal:!0,tokens:{childrenGap:8}},O.createElement(Qe.a.Item,null,O.createElement(H.a,{iconName:t.icon,style:{width:20,height:20}})),O.createElement(Qe.a.Item,null,O.createElement(Qe.a,null,O.createElement(Qe.a.Item,null,O.createElement(uo.a,{as:"h2",styles:o.headingStyles},e.calloutType===pD.EMPTY_RANGE?t.heading:t.heading.replace("{0}",e.rangeName))),O.createElement("div",{className:"nameBox-statusCallout-subTitle"},e.calloutType===pD.EMPTY_RANGE?t.subtext:e.sheetName,e.calloutType===pD.RANGE_CREATED&&O.createElement("span",{className:"nameBox-statusCallout-subText"},e.reference))))))}))};function ID(e,t,n,o,r){T.render(O.createElement(TD,{calloutType:t,rangeName:n,sheetName:o,reference:r,hidden:!1}),e)}var wD=Object(Po.c)((function(e){var t,n,o,r,i;return{calloutStyles:{root:{whiteSpace:"nowrap",padding:"12px 12px 10px 8px",borderRadius:"4px",boxShadow:e.effects.elevation16,border:"none",marginLeft:"-4px",cursor:"default"},beak:{left:"30px !important"},beakCurtain:{borderRadius:"4px"},calloutMain:{lineHeight:"20px"}},headingStyles:{root:{fontSize:"14px",fontWeight:"600",lineHeight:"20px",color:e.palette.black,marginLeft:"12px",marginRight:"26px"}},buttonStyles:{root:{overflow:"hidden",width:"59px",height:"25px",textAlign:"center",fontSize:"12px",fontWeight:"600",color:e.palette.white,marginBottom:"2px",left:"32px",marginTop:"4px",cursor:"pointer",selectors:(t={},t[":focus"]=(n={},n[V.m]={borderColor:"highlight",backgroundColor:"highlight",outline:"2px dashed buttonText"},n),t)}},cloudIconStyles:{root:{width:"20px",height:"20px",selectors:(o={},o[V.m]={fill:"ButtonText !important"},o)}},cancelIconStyles:{root:{width:"16px",height:"16px",cursor:"pointer",float:"right",marginTop:"4px",marginRight:"4px",selectors:(r={},r[V.m]=(i={},i[":focus"]={borderColor:"highlight",backgroundColor:"highlight"},i[":hover"]={backgroundColor:"highlight !important"},i),r)}}}})),_D=!1,PD=O.memo((function(e){var t=e.renameCalloutHandler,n=e.refocus,o=e.titleString,r=e.iconName,l=e.buttonString,u=O.useState(!_D),d=u[0],p=u[1],h=O.useCallback((function(){i.a.sendTraceTag(508118339,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout Show me button clicked"),p(!1),t()}),[t]),g=O.useCallback((function(){i.a.sendTraceTag(508118338,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout closed on cancel"),p(!1),n()}),[n]),m=O.useCallback((function(){i.a.sendTraceTag(508118337,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout closed on FocusOut"),p(!1),n()}),[n]),f=O.useCallback((function(){i.a.sendTraceTag(508117123,a.a.msoulscat_ES_EWAJS,s.a.Info,"Callout closed on TimeOut"),p(!1),n()}),[n]);return O.useEffect((function(){if(_D=d,d){var e=setTimeout((function(){f()}),1e4);return function(){clearTimeout(e)}}return function(){}}),[d,f]),O.createElement(Bo.a,null,(function(e){var t=wD(e);return O.createElement(ds.a,{target:"#".concat("DocumentTitle"),role:"dialog",dismissOnTargetClick:!0,directionalHint:Y.a.bottomAutoEdge,directionalHintFixed:!0,onDismiss:m,hidden:!d,styles:t.calloutStyles},O.createElement(Gy.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,firstFocusableTarget:"#RenamePromptCalloutButton"},O.createElement("div",null,O.createElement("div",{className:"RenamePromptCalloutHeader",style:{display:"flex",flexDirection:"row"}},O.createElement("div",{className:"RenamePromptCalloutHeaderIcon"},O.createElement(H.a,{iconName:r,styles:t.cloudIconStyles})),O.createElement("div",{className:"RenamePromptCalloutHeaderTitle"},O.createElement(uo.a,{as:"h2",styles:t.headingStyles},o)),O.createElement("div",{className:"RenamePromptCalloutHeaderClose"},O.createElement(po.a,{id:"RenamePromptCalloutCloseButton","data-testid":"RenamePromptCalloutCloseButton",styles:t.cancelIconStyles,onClick:g,iconProps:Object(co.a)(c.a.CancelGlyph_20)}))),O.createElement("div",{className:"RenamePromptCalloutFooter"},O.createElement("div",{className:"RenamePromptCalloutFooter-Button"},O.createElement(ma.a,{id:"RenamePromptCalloutButton","data-testid":"RenamePromptCalloutButton",text:l,onClick:h,styles:t.buttonStyles,role:"button"}))))))}))}));function RD(e,t,n,o,r){T.render(O.createElement(PD,{renameCalloutHandler:e,refocus:t,titleString:n,iconName:o,buttonString:r}),document.createElement("div"))}function DD(){return _D}},2695:function(e,t,n){"use strict";n.d(t,"b",(function(){return ce})),n.d(t,"c",(function(){return ue})),n.d(t,"a",(function(){return de}));var o=n(2),r=n(0),i=n(84),a=n(699),s=n(194);function l(e,t){return function(e,t){if(e.left&&e.top&&t.left&&t.top)return Math.round(Math.sqrt(Math.pow(e.left-t.left,2)+Math.pow(e.top-t.top,2)));return 0}(e,function(e,t){var n={left:e.left,top:e.top};null!=t&&n.left&&n.top&&(n.left<t.left&&(n.left=t.left),n.left>t.left+t.width&&(n.left=t.left+t.width),n.top<t.top&&(n.top=t.top),n.top>t.top+t.height&&(n.top=t.top+t.height));return n}(e,t))}var c=n(204),u=n(956),d=n(1458),p=n(1472),h=n(269),g=n(54),m=n(13),f=n(902),b=n(1456),v=n(1063),y=n(1064),x=n(158),C=n(1115),S=n(1380),E=n(215),k=n(2672),O=n(2673),T=n(2674),I=n(4),w=n(1961),_=n(460),P=n(2387),R=n(2388),D=n(2381),j=Object(m.c)((function(e){var t={root:{padding:"0 2px 0 5px"},splitButtonMenuButton:{height:_.a.floatieRowHeight,width:_.a.menuButtonWidth,padding:0},splitButtonContainer:{height:_.a.floatieRowHeight}};return Object(I.db)(Object(P.b)(e),t)})),B=Object(m.c)((function(){var e={splitButtonMenuButton:{height:_.a.floatieLargeControlHeight,width:_.a.menuButtonWidth},splitButtonContainer:{height:_.a.floatieLargeControlHeight,padding:"0px 2px 0px 0px",selectors:{":focus:after":{right:2}}}};return Object(I.I)(P.a,e)})),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(w.a,Object(o.__assign)({},this.props,{id:Object(D.a)(this.props.id),useLegacyButton:!0,hideLabel:!0,styles:j(this.props.styles),directionalHintFixed:!1,dataAutomationType:"FloatieSplitButton",variant:"floatieSplitButton",keytipProps:void 0,shadowRenderMenu:!1}))},t}(r.PureComponent),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(w.a,Object(o.__assign)({},this.props,{id:Object(D.a)(this.props.id),styles:B(),directionalHintFixed:!1,dataAutomationType:"FloatieLargeSplitButton",useLegacyButton:!0,onRenderText:Object(R.a)(this.props.label),keytipProps:void 0,shadowRenderMenu:!1}))},t}(r.PureComponent),M=n(2675),A=n(1959),N={root:{marginRight:0,height:28},subComponentStyles:{textFieldStyles:{subComponentStyles:{buttonStyles:{root:{width:_.a.menuButtonWidth,height:28}}}},dropDownStyles:{}}},W=function(e){return r.createElement(A.a,Object(o.__assign)({},e,{id:Object(D.a)(e.id),styles:N,keytipProps:void 0,directionalHintDynamic:!0}))},H=n(2701),z=n(1626),V=n(2266),G=n(653),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;return r.createElement(h.a,null,(function(t){return r.createElement(V.a,Object(o.__assign)({},e.props,{id:Object(D.a)(e.props.id),dataAutomationType:"FloatieCompoundButton",styles:Object(G.b)(t,{label:{fontWeight:I.l.bold,margin:"0"}}),keytipProps:void 0}))}))},t}(r.PureComponent);var q=Object(m.c)((function(e,t){return function(n){e&&e(!0,n.id,n.isShadowRendering),t&&t(n)}})),Q=Object(m.c)((function(e,t){return function(n){e&&e(!1,n),t&&t(n)}})),K=Object(m.c)((function(e,t){return function(n){e&&e(void 0),t&&t(n)}})),J=Object(x.a)((function(e,t,n,i){return{key:e,data:t,onRender:function(e,t){return r.createElement("span",{key:e.key},function(e,t,n,i,a,s){var l=isNaN(n)?void 0:n,c=isNaN(i)?void 0:i;switch(e.type){case"AppCompoundButtonProps":return r.createElement(U,Object(o.__assign)({positionInSet:l,setSize:c},Object(z.a)(e,t),{lang:e.lang,enableFocusOnHover:!0}));case"AppFontStylesFullGalleryProps":return Object(H.a)(e,Object(S.a)(t),n,i,a,s);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppCharacterCodeGalleryProps":case"RibbonChangeColorsFullGalleryProps":return Object(H.a)(e,Object(S.a)(t),n,i);default:throw new Error("The control of type ".concat(e.type," is not valid in a Floatie menu"))}}(e.data,Object(S.a)(t),Number(e["aria-posinset"]),Number(e["aria-setsize"]),n,i))},customOnRenderListLength:Object(E.e)(t)}}));var Z=Object(m.c)((function(e,t,n,r){return function(i){var a=i.controlProps,s=i.subComponentStyles,l=i.location,c=i.arePerfImprovementsEnabled,u=i.onSubMenuPositioned,d=i.terminalParentControlId,p=i.useFullDescriptionLabelOnly,h=i.onMenuItemExecuted||n;return a.filter((function(e){return Object(E.e)(e)>0})).map((function(n){var i=Object(o.__assign)(Object(o.__assign)({},Object(E.a)(n,h)),{keytipProps:void 0,location:l,appStrings:t,terminalParentControlId:d});switch(i.type){case"AppButtonProps":return(r?f.b:f.a)(Object(C.a)(i.id,i.location),i,s,void 0,void 0,p);case"AppToggleButtonProps":return Object(b.a)(i,s,void 0,p);case"AppFlyoutAnchorProps":return(c?v.b:v.a)(Object(C.a)(i.id,i.location),i,Z(e,t),e,u,s,s,c,h,p);case"AppSplitButtonProps":return(c?y.b:y.a)(Object(C.a)(i.id,i.location),i,Z(e,t),e,u,s,s,c,h);case"AppFontStylesFullGalleryProps":return J(i.id,i,Z(e,t,void 0,!0),e);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppCharacterCodeGalleryProps":case"AppCompoundButtonProps":case"RibbonChangeColorsFullGalleryProps":return J(i.id,i);default:throw new Error("The control of type ".concat(i.type," is not valid in a Floatie menu"))}}))}}));function Y(e){var t=e.flyoutAnchorProps;return{type:"AppFlyoutAnchorProps",id:e.id,disabled:e.disabled,icon:t&&t.icon,label:t&&t.label||e.menuLauncherLabel,menuDefinition:e.expandedOptions,onExecute:e.onMenuButtonExecute,onAfterMenuDismiss:e.onAfterMenuDismiss,keytipProps:e.keytipProps}}var X=n(2326),$=n(2405),ee=n(818),te=Object(m.c)((function(e){return Object(I.eb)({padding:"2px 0",display:"flex"},e)})),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.controls,n=e.controlRendererFunction;return r.createElement("div",{className:te()},t.map((function(e,t,r){return re(Object(o.__assign)(Object(o.__assign)({},e),Object(ee.a)(r,t)),n)})))},t}(r.PureComponent),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.controls,n=e.controlRendererFunction;return r.createElement("div",{className:te(this.props.customStyles)},t.map((function(e){return re(e,n)})))},t}(r.PureComponent);function re(e,t){return r.createElement("div",{key:e.id},t(Object(o.__assign)(Object(o.__assign)({},e),{location:c.b.Floatie})))}var ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getFloatieGroupType=function(){switch(t.props.type){case"MultiRowFloatieGroup":return r.createElement("div",null,r.createElement(ne,{key:"".concat(t.props.id,"TopRow"),controls:t.props.topControlsRow,controlRendererFunction:t.props.controlRendererFunction}),r.createElement(ne,{key:"".concat(t.props.id,"BottomRow"),controls:t.props.bottomControlsRow,controlRendererFunction:t.props.controlRendererFunction}));case"SingleRowFloatieGroup":return r.createElement("div",null,r.createElement(oe,Object(o.__assign)({},t.props,{controlRendererFunction:t.props.controlRendererFunction,customStyles:t.props.customStyles})));case"SingleControlFloatieGroup":var e=Object(o.__assign)(Object(o.__assign)({},t.props),{controls:[t.props.control]});return r.createElement("div",null,r.createElement(oe,Object(o.__assign)({},e,{controlRendererFunction:e.controlRendererFunction})))}},t}return Object(o.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.hidden?this.props.hidden!==e.hidden:!Object(s.e)(this.props,e)},t.prototype.render=function(){return r.createElement("div",{className:Object($.c)(this.props.hidden,this.props.customStyles),id:this.props.id+"Group"},this.props.renderDivider&&r.createElement("div",null,r.createElement(X.a,{getClassNames:$.b})),r.createElement("div",null,this.getFloatieGroupType()))},t}(r.Component),ae=n(150),se=n(50),le=n(2676),ce=12,ue="ReactFloatie",de=function(e){function t(t){var n=e.call(this,t)||this;n.floatieWrapper=r.createRef(),n.floatieExtraDistance=0,n.initialMouseDistance=-1,n.floatieBounds=null,n.totalShadowRenderingTime=0,n.renderFloatieGroups=function(){var e,t,o=n.props.groups;return n.isShadowRenderingEnabled()&&(o=n.state.isShadowRendering?null!==(t=null===(e=n.props.floatieGroupsToShadowRender)||void 0===e?void 0:e.slice(0,n.state.itemsToRender))&&void 0!==t?t:[]:n.props.floatieGroupsToShadowRender),n.renderAllFloatieGroups(o,n.props.isSmallScreenFloatie,n.props.scrollStyles)},n.renderAllFloatieGroups=function(e,t,o){if(t&&o){var i=e.find((function(e){return"ContextMenu"===e.id})),a=e.filter((function(e){return"ContextMenu"!==e.id}));return r.createElement(r.Fragment,null,r.createElement("div",{className:o.wrapper},r.createElement("div",{className:o.leftFade}),r.createElement("div",{className:o.container,onScroll:n.onSmallScreenSwipe},a.map((function(e){return n.renderFloatieGroup(e)}))),r.createElement("div",{className:o.rightFade})),i&&n.renderFloatieGroup(i))}return e.map((function(e){return n.renderFloatieGroup(e)}))},n.renderFloatieGroup=function(e){var t;return r.createElement(ie,Object(o.__assign)({},e,{key:e.id,renderDivider:n.renderFloatieGroupDivider(e.id),hidden:n.isShadowRenderingEnabled()&&!n.floatieGroupShouldBeShown(e.id),controlRendererFunction:null!==(t=n.props.controlRendererFunction)&&void 0!==t?t:n.getFloatieGroupRenderFunction(e)}))},n.renderFloatieGroupDivider=function(e){return n.props.groups[0]&&n.props.groups[0].id!==e},n.onMouseMove=function(e){if(!n.props.hidden&&n.state.fadeOutFloatie&&!n.props.attachedContextMenu){n.initialMouseDistance=l(n.props.originalTarget,n.floatieBounds);var t=l({left:e&&e.clientX,top:e&&e.clientY},n.floatieBounds);if(0===t)n.floatieExtraDistance=0,n.setState((function(){return{opacity:"1",inRubberbandState:!1}}));else{n.state.inRubberbandState&&((0===n.floatieExtraDistance||t<n.floatieExtraDistance)&&(n.floatieExtraDistance=t),t-=n.floatieExtraDistance);var o=255-4*(t=Math.max(t-n.initialMouseDistance,0));o<=0&&t>=63.75?(n.props.onFadedAway&&n.props.onFadedAway(e),n.props.onDismiss&&n.props.onDismiss(e)):n.setState((function(){return{opacity:Math.max(o/255,0).toFixed(2)}}))}}},n.onSmallScreenSwipe=function(e){var t=e.target;if(t.parentElement&&t.parentElement.children&&!(t.parentElement.children.length<2)){var n=t.parentElement,o=n.firstChild,r=n.lastChild,i=0===t.scrollLeft;o.style.visibility=i?"hidden":"visible";var a=t.scrollWidth-t.scrollLeft-t.clientWidth<1;r.style.visibility=a?"hidden":"visible"}},n.onMenuToggled=function(e,t,o){o||(n.setState({fadeOutFloatie:!e,inRubberbandState:!e}),n.floatieExtraDistance=0,n.props.onMenuToggled&&n.props.onMenuToggled(e),n.openedMenuId=e&&!o?t:void 0)},n.onItemExecuted=function(e){n.props.onItemExecute&&n.props.onItemExecute(e,c.a.Floatie,n.openedMenuId)},n.updateFloatieBounds=function(e){n.getFloatieBounds(),n.props.onPositioned&&n.props.onPositioned(e)},n.renderMoreItemsInIdleCallback=function(){var e,t=(e=n.state).isShadowRendering,o=e.itemsToRender,r=n.props.floatieGroupsToShadowRender;if(t&&void 0!==r)if(o<r.length){n.currentShadowRenderingStart&&(n.totalShadowRenderingTime+=performance.now()-n.currentShadowRenderingStart);var i=Object(p.a)(n.totalShadowRenderingTime,o);Object(u.a)()&&n.getWindow().requestIdleCallback((function(){n.currentShadowRenderingStart=performance.now(),n.setState({itemsToRender:o+i})}),void 0,"Floatie-".concat(ue,"-ShadowRenderIncrement"))}else n.setState({isShadowRendering:!1})},n.isShadowRenderingEnabled=function(){return!!n.props.floatieGroupsToShadowRender};var i=t.appIcons,a=t.appStrings;return n.controlInMenuRendererFunction=Z(i,a,n.onItemExecuted),n.controlRendererFunction=function(e,t,n,i){return function(a){var s=Object(E.a)(a,i);switch(s.type){case"AppButtonProps":return r.createElement(k.a,Object(o.__assign)({},s));case"AppToggleButtonProps":return r.createElement(O.b,Object(o.__assign)({},s));case"AppFlyoutAnchorProps":return r.createElement(T.a,Object(o.__assign)({},s,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:q(n,s.onExecute),onAfterMenuDismiss:Q(n,s.onAfterMenuDismiss)}));case"AppSplitButtonProps":return r.createElement(F,Object(o.__assign)({},s,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:q(n,s.onMenuButtonExecute),onAfterMenuDismiss:Q(n,s.onAfterMenuDismiss)}));case"AppComboBoxProps":return r.createElement(M.a,Object(o.__assign)({},s,{onMenuOpen:q(n,s.onMenuOpen),onAfterMenuDismiss:Q(n,s.onAfterMenuDismiss),downChevronIcon:e.downChevron}));case"AppFontPickerProps":return r.createElement(W,Object(o.__assign)({},s,{onMenuOpen:q(n,s.onMenuOpen),onAfterMenuDismiss:Q(n,s.onAfterMenuDismiss),downChevronIcon:e.downChevron}));default:throw new Error("The control of type ".concat(s.type," is not a valid Floatie control"))}}}(i,n.controlInMenuRendererFunction,n.onMenuToggled,n.onItemExecuted),n.singleRowControlRendererFunction=function(e,t,n,i,a){return function(s){var l=Object(E.a)(s,a);switch(l.type){case"AppButtonProps":return r.createElement(k.b,Object(o.__assign)({},l,{onExecute:l.dismissHostingSurfaceOnExecute?K(i,l.onExecute):l.onExecute}));case"AppToggleButtonProps":return r.createElement(O.a,Object(o.__assign)({},l,{onExecute:l.dismissHostingSurfaceOnExecute?K(i,l.onExecute):l.onExecute}));case"AppFlyoutAnchorProps":return r.createElement(T.b,Object(o.__assign)({},l,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?q(n,l.onExecute):l.onExecute,onAfterMenuDismiss:n?Q(n,l.onAfterMenuDismiss):l.onAfterMenuDismiss}));case"AppFontStylesPreviewGalleryProps":case"AppIconPreviewGalleryProps":return r.createElement(T.b,Object(o.__assign)({},Y(l),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?q(n,l.onMenuButtonExecute):l.onMenuButtonExecute,onAfterMenuDismiss:n?Q(n,l.onAfterMenuDismiss):l.onAfterMenuDismiss}));case"AppSplitButtonProps":return r.createElement(L,Object(o.__assign)({},l,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:q(n,l.onMenuButtonExecute),onAfterMenuDismiss:n?Q(n,l.onAfterMenuDismiss):l.onAfterMenuDismiss}));default:throw new Error("The control of type ".concat(l.type," is not a valid Floatie large control"))}}}(i,n.controlInMenuRendererFunction,n.onMenuToggled,n.props.onDismiss,n.onItemExecuted),n.singleControlRendererFunction=function(e,t,n,i,a){return function(s){var l=Object(E.a)(s,a);switch(l.type){case"AppFlyoutAnchorProps":return r.createElement(T.b,Object(o.__assign)({},l,{controlInMenuRendererFunction:t,styles:i,downChevronIcon:e.downChevron,onExecute:n?q(n,l.onExecute):l.onExecute,onAfterMenuDismiss:n?Q(n,l.onAfterMenuDismiss):l.onAfterMenuDismiss,isDefaultLabelRendering:!0}));case"AppButtonProps":return r.createElement(k.a,Object(o.__assign)({},l));default:throw new Error("The control of type ".concat(l.type," is not a valid Floatie single control"))}}}(i,n.controlInMenuRendererFunction,n.onMenuToggled,P.c,n.onItemExecuted),n.hasListeners=!1,n.floatieId=n.props.floatieId?n.props.floatieId:ue,n.state={opacity:"1",fadeOutFloatie:!0,itemsToRender:0},n}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.isShadowRendering&&e.floatieGroupsToShadowRender&&!e.hidden?{isShadowRendering:!1,itemsToRender:e.floatieGroupsToShadowRender.length}:null},t.prototype.componentWillUnmount=function(){this.removeListeners()},t.prototype.addListeners=function(){this.props.hidden||this.props.attachedContextMenu||this.props.preventAutoDismiss||this.props.preventLightDismiss||!this.state.fadeOutFloatie||(this.getWindow().document.body.addEventListener("mousemove",this.onMouseMove,!0),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(this.getWindow().document.body.removeEventListener("mousemove",this.onMouseMove,!0),this.hasListeners=!1)},t.prototype.shouldComponentUpdate=function(e,t){return!(this.props.hidden&&e.hidden&&!t.isShadowRendering)&&(!Object(s.e)(this.props,e)||!Object(s.e)(this.state,t))},t.prototype.render=function(){var e,t,n,o=this,s=void 0===(t=(e=this.props).gapSpace)?this.props.attachedContextMenu?ce:22:t,l=e.target,c=e.hidden,u=void 0===(n=e.directionalHint)?i.a.topLeftEdge:n,p=e.positionAndHide;return r.createElement(h.a,null,(function(e){var t,n,i,h,m;return r.createElement("div",{ref:o.floatieWrapper},r.createElement(a.a,{id:o.floatieId,hidden:c,doNotLayer:!0,gapSpace:s,directionalHint:u,directionalHintForRTL:u,directionalHintFixed:o.props.attachedContextMenu&&o.props.positionFloatieInSingleFrame,alignTargetEdge:!(o.props.attachedContextMenu&&o.props.positionFloatieInSingleFrame),target:l,isBeakVisible:!1,styles:Object($.a)(e,p,o.state.opacity,o.props.styles),onPositioned:o.updateFloatieBounds,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,"data-unique-id":null!==(t=o.props.floatieId)&&void 0!==t?t:"Floatie",bounds:(null===(i=(n=o.context).isExperimentalFeatureEnabled)||void 0===i?void 0:i.call(n,se.f.multiWindowSupportIsEnabled))?Object(d.a)(o.context.appWindow):g.getBoundingWindowWithPaddingFabric,shouldUpdateWhenHidden:o.state.isShadowRendering},o.renderFloatieGroups(),(null===(m=(h=o.context).isExperimentalFeatureEnabled)||void 0===m?void 0:m.call(h,"Microsoft.Office.SharedOnline.AsyncReactUITiming"))?r.createElement(le.a,{elementTimingId:"floatie",hidden:c,interactivityTrackerContext:o.getInteractivityTrackerContext()}):null))}))},t.prototype.componentDidMount=function(){var e=this;this.props.hidden||this.addListeners(),Object(u.a)()&&this.props.hidden&&this.isShadowRenderingEnabled()&&this.getWindow().requestIdleCallback((function(){e.setState({isShadowRendering:!0})}),void 0,"Floatie-".concat(ue,"-StartShadowRendering"))},t.prototype.componentDidUpdate=function(){this.state.isShadowRendering?this.renderMoreItemsInIdleCallback():this.props.hidden?(this.removeListeners(),this.floatieBounds=null,this.initialMouseDistance=-1,this.setState((function(){return{opacity:"1",inRubberbandState:!1}}))):this.hasListeners||this.addListeners()},t.prototype.getInteractivityTrackerContext=function(){if(this.props.groups&&0!==this.props.groups.length)return this.props.groups.map((function(e){return e.id})).join(", ")},t.prototype.floatieGroupShouldBeShown=function(e){return this.props.groups.some((function(t){return t.id===e}))},t.prototype.getFloatieGroupRenderFunction=function(e){switch(e.type){case"MultiRowFloatieGroup":return this.controlRendererFunction;case"SingleControlFloatieGroup":return this.singleControlRendererFunction;case"SingleRowFloatieGroup":default:return this.singleRowControlRendererFunction}},t.prototype.getFloatieBounds=function(){var e=this;requestAnimationFrame((function(){var t=e.getWindow().document.getElementById(e.floatieId);e.floatieBounds=t&&t.getBoundingClientRect()}))},t.prototype.getWindow=function(){var e,t,n;return(null===(t=(e=this.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,se.f.multiWindowSupportIsEnabled))&&null!==(n=this.context.appWindow)&&void 0!==n?n:window},t.contextType=ae.a,t}(r.Component)},2696:function(e,t,n){"use strict";n.r(t),n.d(t,"initializePresentModeFloatieLazy",(function(){return Ce})),n.d(t,"showPresentModeFloatieLazy",(function(){return Se})),n.d(t,"hidePresentModeFloatieLazy",(function(){return Ee})),n.d(t,"updatePresentModeFloatieShyStateLazy",(function(){return ke})),n.d(t,"getPresentModeFloatieControlsMapLazy",(function(){return Oe}));var o,r,i,a,s,l=n(2),c=n(0),u=n(422),d=n(173),p=n(2346),h=n(215),g=n(2672),m=n(2675),f=n(2674),b=n(2673),v=n(2695),y=n(13),x=n(4),C=n(42),S={root:(o={height:"35px",width:"35px",borderRadius:"4px",margin:"0 5px"},o[":hover, :focus:hover"]={backgroundColor:C.a.gray150},o[":active"]={backgroundColor:C.a.gray160+"!important"},o["::after"]={border:"1px solid "+C.a.gray90+" !important",borderRadius:"4px",backgroundColor:"transparent"},o),rootChecked:(r={backgroundColor:"transparent"},r[".ms-Fabric--isFocusVisible &:focus"]={border:"1px solid "+C.a.gray90+" !important",borderRadius:"4px",backgroundColor:"transparent"},r[".ms-Fabric--isFocusVisible &:focus:hover"]={backgroundColor:C.a.gray150},r),rootCheckedPressed:{backgroundColor:C.a.gray160+"!important"},rootCheckedHovered:{backgroundColor:C.a.gray150},rootExpanded:(i={border:"1px solid "+C.a.gray90+" !important",borderRadius:"4px",backgroundColor:"transparent"},i[":hover"]={backgroundColor:C.a.gray150},i),rootDisabled:(a={background:"transparent"},a[".ms-Button-menuIcon"]={opacity:"0.4"},a),icon:{width:"19px",height:"19px"}},E=Object(y.c)((function(e){switch(e){case"TogglePresentModeOverlay":return{rootChecked:{backgroundColor:C.a.gray160}};case"ToggleHeadingsGridlines":return{root:{height:"35px",width:"50px"}};case"PresentModeZoomIn":case"PresentModeZoomOut":return{icon:{width:"16px !important",height:"16px !important"}};default:return{}}})),k=Object(y.c)((function(e){return Object(x.db)(S,E(e))})),O=Object(y.c)((function(e){return{root:{selectors:{":hover":{backgroundColor:C.a.gray140,selectors:{".checkbox-check":{opacity:0}}},":active":{backgroundColor:C.a.gray120,selectors:{".checkbox-check":{opacity:0}}},".ms-Fabric--isFocusVisible &::after":{border:"1px solid "+C.a.gray90}}},checkbox:{border:"none",background:"transparent !important"},text:{color:e?C.a.gray110:C.a.gray10}}})),T=Object(y.c)((function(e){return{root:{selectors:{":hover":{backgroundColor:C.a.gray140,selectors:{".checkbox-check":{fill:e?C.a.gray110:C.a.gray10}}},":active":{backgroundColor:C.a.gray120,selectors:{".checkbox-check":{fill:e?C.a.gray110:C.a.gray10}}},".ms-Fabric--isFocusVisible &::after":{border:"1px solid "+C.a.gray90}}},checkbox:{border:"none",background:"transparent !important"},text:{color:e?C.a.gray110:C.a.gray10},checkmark:{fill:e?C.a.gray110:C.a.gray10}}})),I=Object(y.c)((function(){return Object(l.__assign)(Object(l.__assign)({},Object(x.db)({container:{},list:{},header:{},root:{},title:{}})),{subComponentStyles:{menuItem:{},callout:{calloutMain:{background:C.a.gray160}}}})})),w={root:(s={backgroundColor:C.a.gray160,color:C.a.gray10+" !important"},s[":active"]={background:C.a.gray120+" !important"},s),rootHovered:{background:C.a.gray140+" !important"},rootChecked:{backgroundColor:C.a.gray130,color:C.a.gray10},rootCheckedPressed:{backgroundColor:C.a.gray120},rootCheckedHovered:{backgroundColor:C.a.gray140}},_={root:{margin:"0px !important",background:"transparent !important",border:"transparent !important",height:"35px",lineHeight:"35px",paddingRight:"10px"}},P=Object(y.c)((function(){var e,t;return{container:{backgroundColor:"transparent",height:"35px"},root:{backgroundColor:"transparent",border:"1px solid transparent",borderRadius:"4px",height:"35px",lineHeight:"35px",width:"65px"},rootHovered:{background:C.a.gray150},rootFocused:(e={background:"transparent",border:"1px solid "+C.a.gray90+" !important"},e[":hover"]={backgroundColor:C.a.gray150},e),rootPressed:{background:C.a.gray160},rootDisabled:(t={backgroundColor:"transparent !important"},t[".input"]={color:C.a.gray110},t),input:{color:C.a.gray10},optionsContainer:{backgroundColor:C.a.gray160}}})),R=Object(y.c)((function(){return{calloutMain:{background:"transparent",width:"fit-content",padding:"3px 0px",height:"39px"},root:{animation:"none",position:"inherit",background:"rgba(50, 49, 48, 0.9)",width:"100vw",justifyContent:"center"},container:{position:"inherit"}}})),D=Object(y.c)((function(){var e,t;return{container:(e={},e["span[class^='divider']"]={height:"25px !important",selectors:(t={},t[x.m]={"forced-color-adjust":"none"},t)},e),expanded:{height:"45px"},collapsed:{overflow:"hidden",height:0}}})),j=n(282),B=n(2240),F=n(587),L=n.n(F),M=n(1947),A=function(e){function t(t){var n=e.call(this,t)||this;return n.transitionStarted=!1,n.presentModeFloatieKey="presentModeFloatie_"+L()(),n.onPopOverStateChange=function(e){n.transitionStarted||n.props.onFloatieShyStateChanged&&n.props.onFloatieShyStateChanged(e)},n.getOnMenuOpened=Object(y.c)((function(e){return function(t){e&&e(!0)}})),n.getOnAfterMenuDismissed=Object(y.c)((function(e){return function(t){e&&e(!1)}})),n.onMenuToggled=function(e){n.onPopOverStateChange(e?j.a.Expanded:j.a.ExpandedSoftDismiss)},n.onTransitionStart=function(e){"height"!==e.propertyName||n.transitionStarted||(n.transitionStarted=!0)},n.onTransitionEnd=function(e){"height"===e.propertyName&&n.transitionStarted&&(n.transitionStarted=!1)},n.controlInMenuRendererFunction=function(e){return e.controlProps.map((function(e){var t=e;switch(t.type){case"AppCheckboxProps":return t.styles=t.checked?T(t.disabled):O(t.disabled),Object(h.b)(t,n.props.floatieProps.appIcons);default:throw new Error("The control of type ".concat(t.type," is not a valid menu item control"))}}))},n.renderControl=function(e){switch(e.type){case"AppButtonProps":return c.createElement(g.a,Object(l.__assign)({},e,{icon:e.icon,styles:k(e.id),title:e.customTooltip}));case"AppComboBoxProps":return c.createElement(M.a,null,c.createElement(m.a,Object(l.__assign)({},e,{styles:P(),onMenuOpen:n.getOnMenuOpened(n.onMenuToggled),onAfterMenuDismiss:n.getOnAfterMenuDismissed(n.onMenuToggled),downChevronIcon:n.props.floatieProps.appIcons.spinButtonUpChevron,showLabel:!1,optionStyles:w,caretDownButtonStyles:_,customTooltip:e.customTooltip})));case"AppFlyoutAnchorProps":return c.createElement(f.a,Object(l.__assign)({},e,{icon:e.icon,styles:k(e.id),menuClassNames:I(),downChevronIcon:n.props.floatieProps.appIcons.spinButtonUpChevron,controlInMenuRendererFunction:n.controlInMenuRendererFunction,title:e.customTooltip}));case"AppToggleButtonProps":return c.createElement(b.b,Object(l.__assign)({},e,{icon:e.icon,toggled:e.toggled,styles:k(e.id),iconColor:e.toggled?"#37A660":"#ffffff",title:e.customTooltip}));default:throw new Error("The control of type ".concat(e.type," is not a valid dictation floatie control"))}},n.state=Object(l.__assign)({},t),n}return Object(l.__extends)(t,e),t.prototype.render=function(){var e;return c.createElement(B.a,{isActive:!!this.props.isActive,popOverState:this.props.popOverState,triggerElement:null===(e=this.props.triggerElement)||void 0===e?void 0:e.id,shyDismissalRegions:this.props.shyDismissalRegions,onPopOverStateChange:this.onPopOverStateChange,onTransitionStart:this.onTransitionStart,onTransitionEnd:this.onTransitionEnd,styles:D()},c.createElement("div",null,c.createElement(v.a,Object(l.__assign)({},this.props.floatieProps,{target:this.state.target,controlRendererFunction:this.renderControl,preventAutoDismiss:!0,preventLightDismiss:!0,styles:R(),onMenuToggled:this.onMenuToggled,key:this.presentModeFloatieKey}))))},t}(c.PureComponent),N=n(131),W=n(2671),H=n(48),z=function(e){var t;return null===(t=e.presentModeFloatieModel)||void 0===t?void 0:t.presentModeFloatieGroupModel},V=Object(N.a)([z,H.U,H.u,H.bb],(function(e,t,n,o){var r=[];if(e)for(var i in e){var a=e[i];if(a)switch(a.type){case"SingleRowFloatieGroupModel":r.push(Object(W.a)(i,a,t,n,o));break;default:throw new Error("The floatie group type can't be placed in the floatie")}}return r})),G=Object(N.a)([z,H.u],(function(e,t){var n={};return e?(Object.keys(e).forEach((function(o){var r=e[o];if(r&&"SingleRowFloatieGroupModel"===r.type){var i=r.controls;null==i||i.forEach((function(e){var o=Object(H.p)(t,e);n[e]=o.modelType}))}})),n):n})),U=n(20),q=n(22);function Q(e){return Object(q.a)(U.Fb,{state:e})}var K=n(236),J=Object(d.connect)((function(e,t){var n=function(e){return e.presentModeFloatieModel}(e),o=V(e),r=function(e){var t,n;return null!==(n=null===(t=e.presentModeFloatieModel)||void 0===t?void 0:t.popOverState)&&void 0!==n?n:j.a.Collapsed}(e);return{target:n.target,isActive:n.isActive,triggerElement:n.triggerElement,shyDismissalRegions:n.shyDismissalRegions,popOverState:r,floatieProps:{groups:o,appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColor,hidden:!n.isActive}}}),(function(e){return{onFloatieShyStateChanged:function(t){e(Q({popOverState:t}))}}}),void 0,{areStatesEqual:Object(K.a)("PresentModeFloatie")})(A),Z=n(45),Y=n(2015),X=n(2014),$=n(26),ee=n.n($),te=function(e){function t(t){var n=e.call(this,t)||this;return n.appColors={shade30:"#094624",shade20:"#0C5F32",shade10:"#0F703B",primary:"#107C41",tint10:"#218D51",tint20:"#55B17E",tint30:"#A0D8B9",tint40:"#CAEAD8"},n.appIcons=Object(l.__assign)(Object(l.__assign)({},Object(Y.a)()),{spinButtonUpChevron:ee.a.UpArrowWhite}),n}return Object(l.__extends)(t,e),t.prototype.render=function(){return c.createElement(p.a,null,c.createElement(d.Provider,{store:u.a},c.createElement(J,{appStrings:Object(X.a)(),appIcons:this.appIcons,appColor:this.appColors})))},t}(c.Component);var ne=n(1071),oe=n(25),re=n.n(oe),ie=n(2305);function ae(e,t){if(void 0===e&&(e={presentModeFloatieGroupModel:{},popOverState:j.a.Collapsed}),null===e)return{presentModeFloatieGroupModel:{},popOverState:j.a.Collapsed};switch(t.type){case U.q:var n=Object(l.__assign)({},e);return t.payload.models.forEach((function(e){n.presentModeFloatieGroupModel&&(n.presentModeFloatieGroupModel[e.id]=e)})),n;case U.Fb:return Object(l.__assign)(Object(l.__assign)({},e),t.payload.state);default:return e}}function se(e,t){ie.b.register("presentModeFloatieModel",ae),e(t)}function le(e){return function(t){t(Q(e))}}var ce=n(659),ue=n(285),de=n(2278),pe=n(92),he=n(87),ge=n(151),me=n(527),fe=n(2197),be=n(209),ve=Object(be.strEnum)(["TogglePresentModeOverlay","ToggleHeadingsGridlines","PresentModeShowGridlines","PresentModeShowHeadings","PresentModeSelectZoomOption","PresentModeZoomIn","PresentModeZoomOut","ExitPresentMode"]),ye=Object(ne.a)(u.a),xe=Object(be.strEnum)(["PresentModeGridView","PresentModeZoom","PresentModeExit"]);function Ce(){var e,t,n=[Object(ce.a)([Object(ue.a)(ve.TogglePresentModeOverlay,ExcelRibbonStrings.PresentationViewToolbarSpotlight,{iconSet:{default:ee.a.SpotlightDynamic},toggled:!0,customTooltip:ExcelRibbonStrings.PresentationViewToolbarSpotlightTooltip}),Object(de.a)(ve.PresentModeShowGridlines,{label:ExcelRibbonStrings.ShowGridlines,keytip:ExcelRibbonStrings.ShowGridlinesKeyTip,checked:!1}),Object(de.a)(ve.PresentModeShowHeadings,{label:ExcelRibbonStrings.ShowHeadings,keytip:ExcelRibbonStrings.ShowHeadingsKeyTip,checked:!0}),Object(pe.a)(ve.ToggleHeadingsGridlines,ExcelRibbonStrings.PresentationViewToolbarShowOptions,{iconSet:{default:ee.a.ViewingTogglesWhite},menuModel:Object(he.a)([Object(he.b)([ve.PresentModeShowGridlines,ve.PresentModeShowHeadings])]),customTooltip:ExcelRibbonStrings.PresentationViewToolbarShowOptions}),Object(ge.a)(ve.PresentModeZoomIn,ExcelRibbonStrings.PresentationViewToolbarZoomIn,{iconSet:{default:ee.a.ZoomPlusWhite},customTooltip:ExcelRibbonStrings.PresentationViewToolbarZoomIn}),Object(ge.a)(ve.PresentModeZoomOut,ExcelRibbonStrings.PresentationViewToolbarZoomOut,{iconSet:{default:ee.a.ZoomMinusWhite},customTooltip:ExcelRibbonStrings.PresentationViewToolbarZoomOut}),Object(me.e)(ve.PresentModeSelectZoomOption,ExcelRibbonStrings.Zoom,{iconSet:{default:"",alternateIcon:re.a.ZoomCurrent100_20},selectedKey:"125",options:[Object(me.d)("200",ExcelRibbonStrings.ZoomTo200),Object(me.d)("175",ExcelRibbonStrings.ZoomTo175),Object(me.d)("150",ExcelRibbonStrings.ZoomTo150),Object(me.d)("125",ExcelRibbonStrings.ZoomTo125),Object(me.d)("100",ExcelRibbonStrings.ZoomTo100),Object(me.d)("75",ExcelRibbonStrings.ZoomTo75),Object(me.d)("50",ExcelRibbonStrings.ZoomTo50),Object(me.d)("25",ExcelRibbonStrings.ZoomTo25)],customTooltip:ExcelRibbonStrings.ZoomToolTip,width:60,pinToPreviousComboBox:!1,showLabel:!0},me.a.FreeForm),Object(ge.a)(ve.ExitPresentMode,ExcelRibbonStrings.PresentationViewToolbarExit,{iconSet:{default:ee.a.CloseWhite},customTooltip:ExcelRibbonStrings.PresentationViewToolbarExit})]),(e=[Object(fe.c)(xe.PresentModeGridView,[ve.TogglePresentModeOverlay,ve.ToggleHeadingsGridlines]),Object(fe.c)(xe.PresentModeZoom,[ve.PresentModeZoomOut,ve.PresentModeSelectZoomOption,ve.PresentModeZoomIn]),Object(fe.c)(xe.PresentModeExit,[ve.ExitPresentMode])],t=Array.isArray(e)?e:[e],Object(q.a)(U.q,{models:t}))];se(ye,n)}function Se(e,t,n){e&&t&&(ye(le({target:e,isActive:!0,triggerElement:t,shyDismissalRegions:n,popOverState:j.a.Expanded})),function(e){e&&Z.render(c.createElement(te,{containerId:e.id}),e)}(e))}function Ee(){ye(le({isActive:!1,popOverState:j.a.Collapsed}))}function ke(e){ye(le({popOverState:e}))}function Oe(){var e=G(u.a.getState()),t=[];return Object.keys(e).map((function(n){t.push({controlId:n,modelType:e[n]})})),t}},2701:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var o=n(2),r=n(0),i=n(2331),a=n(2336),s=n(2338),l=n(2264),c=n(2337),u=n(1626),d=n(486),p=n(2263),h=n(4),g=n(2266),m=n(653),f=n(269),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;return r.createElement(f.a,null,(function(t){return r.createElement(g.a,Object(o.__assign)({},e.props,{dataAutomationType:"ContextMenuCompoundButton",styles:Object(m.b)(t,{root:{padding:0,minHeight:"initial",minwidth:"initial",height:"50px"},label:{fontWeight:h.l.bold,margin:"0"}}),keytipProps:void 0}))}))},t}(r.PureComponent),v=n(170),y=n(723),x=n(13),C=n(1627),S=n(2265),E=n(379),k=n(440),O=n(12),T=n(112),I=n(50),w=n(150),_=Object(x.c)((function(e){return function(){return r.createElement(v.a,{iconName:e,style:{width:20,height:20}})}})),P=Object(x.c)((function(e){var t,n=Object(E.a)(e),o=Object(T.c)()?n.defaultBackgroundColor:k.a.defaultBackgroundColor;return{root:{selectors:(t={},t[O.b]={background:o},t[":active"]={background:o},t),padding:"0px 16px 0px 9px",width:"100%"},label:{paddingLeft:6}}})),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderIcon=function(){return r.createElement(y.a,{coinSize:20,imageInitials:Object(C.a)(t.props.personaInfo.displayName,!1),onRenderInitials:""===Object(C.a)(t.props.personaInfo.displayName,!1)||t.props.personaInfo.isUnauthenticatedSender&&!Object(I.a)(t.context,I.f.customAnonymousNameIsEnabled)?_(t.props.icon):void 0,initialsColor:t.props.personaInfo.personaCoinColor})},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;return r.createElement(f.a,null,(function(t){return r.createElement(S.a,Object(o.__assign)({},e.props,{onRenderIcon:e.renderIcon,styles:Object(m.b)(t,P(t)),keytipProps:void 0}))}))},t.contextType=w.a,t}(r.PureComponent);function D(e,t,n,h,g,m){var f=isNaN(n)?void 0:n,v=isNaN(h)?void 0:h;switch(e.type){case"AppColorPickerProps":return r.createElement(i.a,Object(o.__assign)({positionInSet:f,setSize:v},Object(u.a)(e,t)));case"AppCompoundButtonProps":return r.createElement(b,Object(o.__assign)({positionInSet:f,setSize:v},Object(u.a)(e,t),{lang:e.lang,enableFocusOnHover:!0}));case"AppCharacterCodeGalleryProps":return r.createElement(a.a,Object(o.__assign)({positionInSet:f,setSize:v},Object(d.a)(e,t)));case"AppListGalleryProps":return r.createElement(c.a,Object(o.__assign)({positionInSet:f,setSize:v},Object(d.a)(e,t)));case"AppIconFullGalleryProps":return r.createElement(l.a,Object(o.__assign)({positionInSet:f,setSize:v},Object(d.a)(e,t)));case"AppFontStylesFullGalleryProps":return r.createElement(s.a,Object(o.__assign)({positionInSet:f,setSize:v,controlInMenuRendererFunction:g,iconName:null==m?void 0:m.submenuLauncher},Object(d.a)(e,t)));case"AppPersonaButtonProps":return r.createElement(R,Object(o.__assign)({positionInSet:f,setSize:v},Object(u.a)(e,t),{lang:e.lang}));case"RibbonChangeColorsFullGalleryProps":return r.createElement(p.a,Object(o.__assign)({positionInSet:f,setSize:v},Object(d.a)(e,t)));default:throw new Error("The control of type ".concat(e.type," is not valid in a Floatie menu"))}}},530:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(2),r=n(0),i=n(490),a=n(757),s=n(334),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return r.createElement(s.a,Object(o.__assign)({},this.props,{primary:!0,onRenderDescription:i.b}))},t=Object(o.__decorate)([Object(a.a)("PrimaryButton",["theme","styles"],!0)],t)}(r.Component)}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/uiSlice20.min.js.map/536f3a0c3f2b85ca2162153b31a7cb00/uiSlice20.min.js.map