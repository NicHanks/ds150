'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1012:function(B,A,a){a.d(A,"a",function(){return d});B=a(0);var c=a(15),b=a(5),k=a(55),m=a(35);class d{static omf(n,l){switch(n){case 3:return d.yBi(l);case 2:return d.qti(l);case 1:return d.Rmi(l)}return""}static yBi(n){switch(n){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static qti(n){switch(n){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static Rmi(n){switch(n){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static zXd(n,l,f){if(m.a.gk||m.a.zr)window.setTimeout(()=>{d.ohg(f,d.Qvf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.yPe(f),n,0,!1)}static Fyh(n,l,f,h){l&&h&&h();
d.zXd(n,l,f)}static Qvf(){return m.a.gk?1:m.a.zr?2:m.a.MWa?3:m.a.isMac?4:0}static get fNb(){return"zh-CN"===window.navigator.language}static ohg(n,l){1===l?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),n=d.omf(n,l),8<m.a.LKb?k.a.Ph(n,void 0,void 0,"RedirectToAppStore"):k.a.R_(n)):document.hidden||(d.fNb?(n=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),k.a.R_(n)):c.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.omf(n,l),null,null)))}static yPe(n){switch(n){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get ace(){return(m.a.MWa||m.a.isMac)&&m.a.Br}static Emf(n){switch(n){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static DYi(n){return(n=d.aqi(n))&&
""!==n?Boolean.parse(n):!1}static $$d(n){d.qak(n)}static aqi(n){try{return localStorage.getItem(n)}catch(l){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static qak(n){try{localStorage.setItem(n,"true")}catch(l){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}d.rxh="ChromeExtensionBarDismiss";Object(B.a)(d,"WildFireUtilities",null,[])},1043:function(B,A,a){a.r(A);
a.d(A,"CalcHelper",function(){return u});B=a(0);var c=a(15),b=a(232),k;(function(v){v[v.paren=0]="paren";v[v.lead=1]="lead";v[v.intern=2]="intern";v[v.trail=3]="trail";v[v.undefined=4]="undefined"})(k||(k={}));Object(B.b)("CurrencyFormatOption",k);var m;(function(v){v[v.none=-1]="none";v[v.mdy=0]="mdy";v[v.dmy=1]="dmy";v[v.ymd=2]="ymd";v[v.myd=3]="myd";v[v.dym=4]="dym";v[v.ydm=5]="ydm"})(m||(m={}));Object(B.b)("DateOrderOption",m);class d{constructor(v,y){({CalcHelper:v}=a(1043));y&&(y.gi||c.ULS.shipAssertTag(537169942,
0,!1,"LocaleHolder constructor - locale information is not available"));this.P1g=v.c3e(y,v.L2e(y.Zqa));this.Q1g=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.Q1g}get localeData(){return this.P1g}}Object(B.a)(d,"LocaleHolder",null,[]);var n=a(1187),l=a(58),f=a(1),h=a(22),t=a(123);class u{constructor(v){this.$=v;(this.Uv=this.$.ja.Qa(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");
let y;y=f.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelOnlineCalcWP5",!1)?l.a.current.uq(77):l.a.current.uq(75):l.a.current.uq(76);this.logger=new n.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.K8i=new d(v,this.Uv);excelOnlineCalc.config.initCalc(this.logger,this.Uv?C=>this.Uv.isFeatureEnabled(C):()=>!1,y);this.zv=excelOnlineCalc.config.calcConfig(this.K8i.localeInfo)}get config(){return this.zv}OMh(){if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.sa)return c.ULS.shipAssertTag(537170069,
0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const v=this.$.sa.na;return v?v.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.sa.na.index}createParser(){const v={};v.config=this.config;return excelOnlineCalc.parse.createParser(v)}createAnalyzer(){const v={};v.config=this.config;return excelOnlineCalc.analyze.createAnalyzer(v)}createNumberFormatter(){const v=excelOnlineCalc.numfmt.createFormatGlobals(this.config,
(y,C)=>excelOnlineCalc.calc.getTime(this.config,y,C,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(v)}cLh(v,y,C,x){if(!x)return{range:{row:y,col:C},sheet:{document:this.documentLoc,index:v}};y=excelOnlineCalc.location.gridCell(y,C);v=excelOnlineCalc.location.sheetIndex(this.documentLoc,v);return excelOnlineCalc.location.sheetGridCell(v,y)}static c3e(v,y){y=void 0===y?null:y;const C=v.hHh(),x=v.gi.TrueValueString,w=v.gi.FalseValueString,z=v.gi.DecimalSeparator.toString(),F=v.gi.ListSeparator.toString(),
J=v.gi.ColumnSeparator.toString(),R=v.gi.RowSeparator.toString(),I=v.gi.ThousandsDataArray,O=v.gi.ThousandSeparator.toString(),Y=v.gi.Lcid,K=v.gi.Country,L=v.gi.DigitsNumber,X=v.gi.ExpSeparatedBySpace,T=v.gi.FractionSeparator.toString(),ba=v.gi.PercentSeparatedBySpace,Q=h.a.Sfc(Enum.toString(k,v.gi.CurrencyFormat)),P=v.gi.CurrencySymbolLead,ka=v.gi.CurrencySeparatedBySpace,ia=v.gi.CurrencySymbolString,Ba=v.gi.DigitsCurrency,va=-1===v.gi.DateOrder?"MDY":t.e(Enum.toString(m,v.gi.DateOrder)),W=v.gi.DateSeparator.toString(),
S=v.gi.DateAlternativeSeparator.toString(),da=v.gi.Year4Digits,aa=v.gi.Month2Digits,za=v.gi.Day2Digits,qa=v.gi.LongDateFormat,ta=v.gi.TimeSeparator.toString(),Xa=v.gi.TimeAltSeparator,oa=v.gi.Hour2Digits,ha=v.gi.Use24HourClock,Za=v.gi.AmPmSeparatedBySpace,Fa=[v.gi.AmString,v.gi.PmString],La=v.gi.DayNameShortArray,xa=v.gi.DayNameLongArray,db=v.gi.MonthNameShortArray,bb=v.gi.MonthNameLongArray,kb=v.gi.PictureSpecialArray,Rb=b.a.map(("\x00"+v.gi.PictureSingleString).split(""),Qb=>"\x00"===Qb?null:Qb),
zb=v.gi.PictureColorArray,nc=v.gi.PictureDbnumArray,Zb=v.gi.RowLetter.toString(),Sa=v.gi.ColumnLetter.toString(),Na=v.gi.LeftBrace.toString(),Ea=v.gi.RightBrace.toString(),Aa=v.gi.LeftBracket.toString(),Ka=v.gi.RightBracket.toString(),nb=u.dyi(v.gi);return excelOnlineCalc.calc.localeData(y,C,x,w,Zb,Sa,Na,Ea,Aa,Ka,z,F,J,R,I,O,Y,K,L,X,T,ba,Q,P,ka,ia,Ba,va,W,S,da,aa,za,qa,ta,Xa,oa,ha,Za,Fa,La,xa,db,bb,kb,Rb,zb,nc,nb,v.gi.SysDateFormatString,v.gi.SysTimeFormatString)}static L2e(v){const y=[];if(!v)return y;
for(const C of v)v=null,C.IsDynamicUdf||(v=excelOnlineCalc.calc.worksheetFunctionName(C.FunctionIndexInServer,C.NameUI)),v&&y.push(v);return y}static dyi(v){const y=Array(6);y[1]="#"+v.AllStructRefString;y[3]="#"+v.HeadersStructRefString;y[2]="#"+v.DataStructRefString;y[4]="#"+v.TotalsStructRefString;y[5]="#"+v.ThisRowStructRefString;return y}}Object(B.a)(u,"CalcHelper",null,[])},1168:function(B,A,a){a.d(A,"a",function(){return c});const c=b=>{const k=Array(b.length);for(let m=0,d=b.length;m<d;m++)k[m]=
b[m].cloneNode(!0);return k}},1172:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);class c{}c.HUc="b-ring_Apc_Trans";c.pQg="cdn_static_resource_ewa_image";Object(B.a)(c,"ResourceHosts",null,[])},1173:function(B,A,a){a.d(A,"a",function(){return k});B=a(0);var c=a(63),b=a(1270);class k{static yvd(m,d,n,l){l=void 0===l?null:l;k.rCc||(k.rCc=Array.isArray(c.a.qm(n.xa.NetworkMeasurementUrlList))?c.a.qm(n.xa.NetworkMeasurementUrlList):null);const f=[];for(let h=0;h<k.rCc.length;h++){const t=k.rCc[h];
let u=t.key;u||(u=t.Key);if(l&&!l.includes(u))continue;let v=t.value;v||(v=t.Value);u&&v&&f.push(new b.a(n,u,v,m,d))}return f}}k.rCc=null;Object(B.a)(k,"NetworkConnectionHelpers",null,[])},1175:function(B,A,a){a.d(A,"a",function(){return m});B=a(0);var c=a(15),b=a(55),k=a(77);a=a(804);class m extends a.a{constructor(d,n){super(d,n);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=m.nGa;this.pEa=!0}get linkText(){return m.SSf}eua(d){super.eua(d);
b.a.openWindow(4,k.a.JM(m.RSf))}yI(d){super.yI(d);m.aQd&&m.aQd(null)}static initialize(d,n,l,f){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");m.nGa=d;m.SSf=n;m.RSf=l;m.aQd=f}}m.nGa=null;m.SSf=null;m.RSf=null;m.aQd=null;Object(B.a)(m,"WacGdprNoticeBusinessBarEntry",a.a,[])},1176:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);class c{}c.$qd="ewa-bb";c.yZh="ewa-bb-entry";c.Fbf="ewa-bb-react";c.zZh="ewa-bb-entry-body";c.FZh="ewa-bb-icon";c.BZh="ewa-bb-entry-icon";
c.EZh="ewa-bb-entry-title";c.DZh="ewa-bb-entry-message";c.Dbf="ewa-bb-entry-button";c.CZh="ewa-bb-entry-link";c.AZh="ewa-bb-entry-close";c.Ebf="ewa-bb-entry-button-holder";c.xZh="ewa-bb-content";Object(B.a)(c,"CssClassNames",null,[])},1177:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);a=a(804);class c extends a.a{constructor(b,k){super(b,k);this.Sv=!0;this.title=c.V8;this.message=c.U8}get actionButton(){return c.V2}Wp(b){super.Wp(b);(b=c.tY)&&b(null)}static initialize(b,k,m,d){c.V8=b;c.U8=
k;c.V2=m;c.tY=d}}c.V8=null;c.U8=null;c.V2=null;c.tY=null;Object(B.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1178:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);a=a(804);class c extends a.a{constructor(b,k){super(b,k);this.Sv=!0;this.title=c.V8;this.message=c.U8}get actionButton(){return c.V2}Wp(b){super.Wp(b);(b=c.tY)&&b(null)}static initialize(b,k,m,d){c.V8=b;c.U8=k;c.V2=m;c.tY=d}}c.V8=null;c.U8=null;c.V2=null;c.tY=null;Object(B.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",
a.a,[])},1179:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);a=a(939);class c extends a.a{constructor(b,k,m){super(b,k,m);c.V2&&c.tY&&(this.Sv=!0);this.title=c.V8;this.message=c.U8}get actionButton(){return c.V2}static initialize(b,k,m,d){c.V8=b;c.U8=k;c.V2=m;c.tY=d}Wp(b){super.Wp(b);c.tY&&c.tY(null)}}c.V8=null;c.U8=null;c.V2=null;c.tY=null;Object(B.a)(c,"DataCleansingBusinessBarEntry",a.a,[])},1180:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);a=a(804);class c extends a.a{constructor(b,
k){super(b,k);this.Sv=!0;this.title=c.V8;this.message=c.U8}get actionButton(){return c.V2}Wp(b){super.Wp(b);(b=c.tY)&&b(null)}static initialize(b,k,m,d){c.V8=b;c.U8=k;c.V2=m;c.tY=d}}c.V8=null;c.U8=null;c.V2=null;c.tY=null;Object(B.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1181:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);a=a(804);class c extends a.a{constructor(b,k){super(b,k);this.Sv=!0;this.title=c.DQb;this.message=c.nGa}get actionButton(){return c.wib}Wp(b){super.Wp(b);
c.pGa&&c.pGa(null)}static initialize(b,k,m,d){c.DQb=b;c.nGa=k;c.wib=m;c.pGa=d}}c.DQb=null;c.nGa=null;c.wib=null;c.pGa=null;Object(B.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1182:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);a=a(804);class c extends a.a{constructor(b,k){super(b,k);c.wib&&c.pGa&&(this.Sv=!0);this.title=c.DQb;this.message=c.nGa}get actionButton(){return c.wib}Wp(b){super.Wp(b);c.pGa&&c.pGa(null)}static initialize(b,k,m,d){c.DQb=b;c.nGa=k;c.wib=
m;c.pGa=d}}c.DQb=null;c.nGa=null;c.wib=null;c.pGa=null;Object(B.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1227:function(B,A,a){a.r(A);a.d(A,"BusinessBarControl",function(){return cb});B=a(0);var c=a(15),b=a(99),k=a(150),m=a(16),d=a(98),n=a(86),l=a(32),f=a(35),h=a(14);A=a(253);var t=a(1176),u=a(6),v=a(280),y=a(1177),C=a(804),x=a(1252),w=a(939);class z extends w.a{constructor(hb,ya,Pa){super(hb,ya,Pa)}yI(hb){super.yI(hb)}}Object(B.a)(z,"EditAttemptReadOnlyBusinessBarEntry",
w.a,[]);var F=a(47);class J extends C.a{constructor(hb,ya,Pa,wb){super(hb,ya);this.error=Pa;this.options=wb;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Sv=!(wb&4)}Wp(hb){super.Wp(hb);this.error.Appearance&=-33;F.a(this.businessBar.$).kx([this.error])}}Object(B.a)(J,"ErrorBusinessBarEntry",C.a,[]);var R=a(91);class I extends J{constructor(hb,ya,Pa,wb,Ib){super(hb,ya,Pa,wb);this.command=Ib;this.l0=!0}h1(hb){super.h1(hb);
this.businessBar.$.Ha.Me(new R.a(this.command,hb,this.businessBar.$.zf,10,null))}}Object(B.a)(I,"ErrorAndCommandBusinessBarEntry",J,[]);var O=a(13);class Y{constructor(hb,ya,Pa,wb,Ib,pb,xc,ua,U,na){this.qO=this.Uea=this.JU=0;this.tWg=hb;this.uvk=ya;this.rO=Pa;this.H_g=xc;this.lub=l.a.XA(U);this.OYg=U;this.Epe=ua;this.I_g=na;0!==wb&&(this.JU=wb);0!==Ib&&(this.Uea=Ib);0!==pb&&(this.qO=pb)}get title(){return Y.ia(this.uvk)}get message(){return Y.ia(this.rO)}get messageId(){return this.rO}get iconName(){return this.I_g}get MAa(){return this.tWg}get actionButton(){return Y.ia(this.JU)}get rPa(){return Y.ia(this.Uea)}get link(){return Y.ia(this.qO)}get Et(){return this.H_g}get businessBarType(){return this.Epe}get hash(){return this.lub}get alt(){const {BusinessBarControl:hb}=
a(1227);switch(this.Et){case hb.qqa:return Y.ia(26);case hb.EA:return Y.ia(25);case hb.Sl:return Y.ia(24);default:return Y.ia(0)}}get ECa(){return this.OYg}set businessBarType(hb){this.Epe=hb}static ia(hb){return O.a.instance.ia(hb)}}Object(B.a)(Y,"EwaBusinessBarEntry",null,[]);class K extends Y{constructor(hb,ya,Pa,wb,Ib,pb,xc,ua,U){super(hb,0,ya,Pa,wb,Ib,pb,xc,ua,U)}get title(){return""}}Object(B.a)(K,"EwaNoTitleBusinessBarEntry",Y,[]);var L=a(75);class X extends C.a{constructor(hb,ya){super(hb,
ya);this.l0=this.Sv=!0}Wp(hb){super.Wp(hb);this.set_visible(!1);this.businessBar.$.GN();this.businessBar.$.Ha.Me(new R.a(1038998010,hb,this.businessBar.$.zf,10,null))}h1(hb){super.h1(hb);this.businessBar.$.Ha.Me(new R.a(-722953877,hb,this.businessBar.$.zf,10,null))}yI(hb){this.businessBar.removeEntry(55);L.g(hb)}}Object(B.a)(X,"ExternalLinksEnableContentBusinessBarEntry",C.a,[]);class T extends C.a{constructor(hb,ya){super(hb,ya);this.Sv=!0;this.l0=!1}Wp(hb){super.Wp(hb);this.businessBar.$.Ha.Me(new R.a(-722953877,
hb,this.businessBar.$.zf,10,null))}yI(hb){this.businessBar.removeEntry(5);L.g(hb)}}Object(B.a)(T,"ExternalLinksShowErrorBusinessBarEntry",C.a,[]);var ba=a(12);class Q extends C.a{constructor(hb,ya,Pa){super(hb,ya);this.sKb=Pa;this.Sv=!0}Wp(hb){super.Wp(hb);ba.HelperMethods.oX(this.businessBar.$.RI,this.sKb,this.businessBar.$.WI)}}Object(B.a)(Q,"HelpButtonBusinessBarEntry",C.a,[]);class P extends C.a{constructor(hb,ya,Pa){super(hb,ya);this.sKb=Pa;this.pEa=!0}eua(hb){super.eua(hb);ba.HelperMethods.oX(this.businessBar.$.RI,
this.sKb,this.businessBar.$.WI)}}Object(B.a)(P,"HelpTextBusinessBarEntry",C.a,[]);var ka=a(65);class ia extends C.a{constructor(hb,ya,Pa,wb){super(hb,ya);this.sKb=Pa;this.command=wb;this.pEa=!0;this.Sv=1461300262!==wb}Wp(hb){super.Wp(hb);this.businessBar.$.Ha.Me(new R.a(this.command,hb,this.businessBar.$.zf,10,null))}eua(hb){super.eua(hb);const ya=new R.a(-859308420,hb,this.businessBar.$.zf,12,null);this.businessBar.$.Ha.Me(ya,{[ka.a.Vi]:"HelpID="+this.sKb,["InputMethod"]:hb,[ka.a.ig]:u.a.PM,[u.a.ama]:!0})}}
Object(B.a)(ia,"HelpTextTaskPaneAndCommandBusinessBarEntry",C.a,[]);class Ba extends C.a{constructor(hb,ya){super(hb,ya);this.l0=this.Sv=!0}Wp(hb){super.Wp(hb);this.set_visible(!1);this.businessBar.$.GN();this.businessBar.$.Ha.Me(new R.a(-1081442996,hb,this.businessBar.$.zf,10,null))}h1(hb){super.h1(hb);this.businessBar.$.Ha.Me(new R.a(1702917262,hb,this.businessBar.$.zf,10,null))}yI(hb){this.businessBar.removeEntry(59);L.g(hb)}}Object(B.a)(Ba,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
C.a,[]);var va=a(1180);class W extends C.a{constructor(hb,ya){super(hb,ya);(this.policyManager=hb.$.ja.Qa(274))?(this.message=this.policyManager.wGc,this.title=this.policyManager.title,this.pEa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}eua(hb){super.eua(hb);(hb=this.policyManager.Utj)&&hb(null)}}Object(B.a)(W,"PolicyBusinessBarEntry",C.a,[]);var S=a(1178),da=
a(1182),aa=a(1181);a(694);var za=a(102),qa=a(24);class ta extends C.a{constructor(hb,ya){super(hb,ya);this.Sv=!0;this.title=""}Wp(hb){super.Wp(hb);za.c(qa.a.yhj);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(B.a)(ta,"UnsupportedBrowserBusinessBarEntry",C.a,[]);var Xa=a(1175),oa=a(128),ha=a(954),Za=a(1012),Fa=a(1240);class La{constructor(){this.lWc=new Fa.a;this.jWc=new Fa.a;this.iWc=new Fa.a;this.jph(this.lWc);this.iph(this.jWc);this.hph(this.iWc);this.z0c=
new Fa.a;this.y0c=new Fa.a;this.x0c=new Fa.a;this.Grh(this.z0c);this.Frh(this.y0c);this.Erh(this.x0c);this.FXc=new Fa.a;this.Cph(this.FXc);this.QOa(this.FXc);this.QOa(this.iWc);this.QOa(this.jWc);this.QOa(this.lWc);this.QOa(this.y0c);this.QOa(this.z0c);this.QOa(this.x0c)}Byi(hb,ya){switch(hb){case 1:return this.hCi(ya);case 2:return this.Sgi(ya)}return Za.a.ace?this.FXc:null}jph(hb){hb.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);hb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
hb.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}iph(hb){hb.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);hb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);hb.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}hph(hb){hb.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);hb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);hb.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Grh(hb){hb.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);hb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);hb.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);hb.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);hb.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);hb.add("OverlayBig","Get the Word app");hb.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");hb.add("OverlaySmallSplit1",
"Discover Word");hb.add("OverlaySmallSplit2","designed for the iPad.");hb.add("SkipButton","Skip for now")}Cph(hb){hb.add("Headline","Get the Office Online extension for Chrome");hb.add("UseAppButton","Get the extension");hb.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Frh(hb){hb.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);hb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);hb.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
hb.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);hb.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);hb.add("OverlayBig","Get the PowerPoint app");hb.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");hb.add("OverlaySmallSplit1","Discover PowerPoint");hb.add("OverlaySmallSplit2","designed for the iPad.");hb.add("SkipButton","Skip for now")}Erh(hb){hb.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
hb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);hb.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);hb.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);hb.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}QOa(hb){hb.add("Corporation","Microsoft Corporation")}hCi(hb){switch(hb){case 3:return this.z0c;case 2:return this.y0c;case 1:return this.x0c}return null}Sgi(hb){switch(hb){case 3:return this.lWc;case 2:return this.jWc;
case 1:return this.iWc}return null}static get instance(){La.Ka||(La.Ka=new La);return La.Ka}}La.Ka=null;Object(B.a)(La,"WildFireStringFactory",null,[]);var xa=a(5),db=a(55);class bb{constructor(hb,ya,Pa,wb,Ib,pb){this.Z4c=null;this._id=hb;this.K5c=ya;this.ZZg=void 0===Ib?null:Ib;this.Hub=wb;this.Uwb=void 0===pb?null:pb;this.mLa=null;this.p7a=Pa;this.vxb=La.instance.Byi(ya,hb)}e2e(){this.mLa=new ha.a(this.title,this.message,null);this.mLa.addButton(this.DUe,Object(oa.a)(this,this.IZf,"onButtonOneClick"),
"");this.p7a&&this.mLa.tbh(this.GUe,Object(oa.a)(this,this.LZf,"onButtonTwoClick"));this.mLa.aaa=Object(oa.a)(this,this.O7e,"dismissBar");this.mLa.image=3;this.mLa.id=16;this.mLa.closeable=!0}get title(){return this.vxb.ka("Headline")}get message(){return this.vxb.ka("CallToAction")}get tHk(){return this.p7a}get DUe(){return this.p7a?this.vxb.ka("InstallButton"):this.vxb.ka("UseAppButton")}get GUe(){return this.p7a?this.vxb.ka("OpenAppButton"):""}IZf(){this.p7a?this.nQi():this.jHk()}LZf(){this.p7a&&
this.zAj()}get openUrl(){this.Z4c||(this.Z4c=this.ZZg());return this.Z4c}nQi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Hub&&this.Uwb&&this.Uwb();Za.a.ohg(this._id,this.K5c)}zAj(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Hub&&this.Uwb&&this.Uwb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Za.a.yPe(this._id),this.openUrl,0,!1))}jHk(){Za.a.ace?this.Krh():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),Za.a.$$d("BizBarClicked"),1!==this.K5c&&2!==this.K5c||Za.a.Fyh(this.openUrl,this.Hub,this._id,this.Uwb))}Krh(){this.Hub?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");db.a.R_(xa.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}$Rh(){this.Hub?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Za.a.$$d(Za.a.rxh)}O7e(){Za.a.ace?
this.$Rh():(Za.a.$$d(Za.a.Emf(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static mMh(){const hb=xa.AFrameworkApplication.ra.Pa,ya=new bb(hb.Cj,Za.a.Qvf(),8<f.a.LKb,1===hb.OGa,()=>hb.Iw,hb.d3j());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return ya}}Object(B.a)(bb,"WildFireBusinessBar",null,[]);class kb extends C.a{constructor(hb,ya){super(hb,ya);this.VKa=bb.mMh();this.Sv=!0;this.l0=this.VKa.tHk;this.title=this.VKa.title;this.message=this.VKa.message}get actionButton(){return this.VKa.DUe}get rPa(){return this.VKa.GUe}Wp(hb){super.Wp(hb);
this.VKa.IZf(null)}h1(hb){super.h1(hb);this.VKa.LZf(null)}yI(hb){super.yI(hb);this.VKa.O7e(null)}}Object(B.a)(kb,"WildFireMobileAppBusinessBarEntry",C.a,[]);var Rb=a(263),zb=a(22),nc=a(197),Zb=a(161),Sa=a(52),Na=a(2),Ea=a(185),Aa=a(1183),Ka=a(69),nb=a(148),Qb=a(585),jb=a(1),qb=a(8),ab=a(146);class xb extends C.a{constructor(hb,ya,Pa,wb){super(hb,ya);this.officeScriptsCommandManager=qb.Oc.$e()?ab.a.mg(qb.Oc):Pa.ja.Qa(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=
Ea.a.create();this.$=Pa;this.title=O.a.instance.ia(2282);this.message="";this.Gee=O.a.instance.ia(2278);this.mOg=O.a.instance.ia(2279);this.kOg=O.a.instance.ia(2280);this.p0e=O.a.instance.ia(2281);this.update(wb)}update(hb){this.scriptLink=hb.scriptLink;this.runStatus=hb.runStatus;this.buttonText=hb.buttonText||"";this.d9i(hb.clickId);this.e_j();"preparing"===this.runStatus?(this.Iva(0),this.message=String.format(O.a.instance.He(208),this.buttonText),this.Sv=!0,this.Uza=this.Gee,this.ICb=this.coa=
this.hkb):"running"===this.runStatus?(this.Iva(0),this.message=String.format(O.a.instance.He(207),this.buttonText),this.Sv=!0,this.Uza=this.Gee,this.ICb=this.coa=this.hkb):"succeeded"===this.runStatus?(this.Iva(0),this.message=String.format(O.a.instance.He(210),this.buttonText),"true"===hb.hasLogs?(this.Sv=!0,this.Uza=this.kOg,this.coa=this.c9f,this.l0=!0,this.Hcd=this.mOg,this.Icd=this.d9f):(this.Sv=!0,this.Uza=this.mOg,this.coa=this.d9f)):"runFailed"===this.runStatus?(this.Iva(1),this.message=String.format(O.a.instance.He(209),
this.buttonText),this.Oeb=cb.qqa,"true"===hb.hasLogs?(this.Sv=!0,this.Uza=this.kOg,this.coa=this.c9f,"false"===hb.isOwner&&(this.l0=!0,this.Hcd=this.p0e,this.Icd=this.O_f)):"false"===hb.isOwner&&(this.Sv=!0,this.Uza=this.p0e,this.coa=this.O_f)):"fetchFailed"===this.runStatus?(this.Iva(1),this.Oeb=cb.qqa,this.message=O.a.instance.ia(2284)):"canceled"===this.runStatus?(this.Iva(0),this.Oeb=cb.EA,this.message=String.format(O.a.instance.He(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.Iva(5),
this.Oeb=cb.EA,this.message=String.format(O.a.instance.He(211),this.buttonText),this.Sv=!0,this.Uza=this.Gee,this.ICb=this.coa=this.hkb):"initializing"===this.runStatus&&(this.Iva(0),this.Oeb=cb.Sl,this.message=O.a.instance.ia(2283))}get Et(){return this.Oeb}get actionButton(){return this.Uza}get rPa(){return this.Hcd}Wp(hb){super.Wp(hb);this.coa&&this.coa()}h1(hb){super.h1(hb);this.rPa&&this.Icd()}yI(hb){super.yI(hb);this.ICb&&this.ICb()}e_j(){this.message="";this.Oeb=cb.Sl;this.Sv=!1;this.Uza="";
this.coa=void 0;this.l0=!1;this.Hcd="";this.Icd=void 0;this.hideCloseButton=!1;this.ICb=void 0}hkb(){const hb=Ea.a.create().toString();this.officeScriptsCommandManager.xDi(hb);this.pAc(-2186799,hb)}c9f(){const hb=Ea.a.create().toString();this.officeScriptsCommandManager.wDi(hb);this.pAc(1036446140,hb)}d9f(){const hb=Ea.a.create();if(this.scriptLink)if(jb.EwaSettings.getBooleanFeatureGate(Qb.a.QGa,!1))this.officeScriptsCommandManager.Psc(this.id.toString(),this.scriptLink,hb);else{const ya=new Aa.b(this.scriptLink);
this.officeScriptsCommandManager.Psc(this.id.toString(),JSON.stringify(ya),hb)}this.pAc(-585097204,hb.toString())}O_f(){const hb=Ea.a.create().toString();this.officeScriptsCommandManager.vDi(hb);this.pAc(-639858579,hb)}d9i(hb){const ya=[];ya.push(Object(Na.a)(new Ka.a,{name:"id",string:this.id.toString()}));ya.push(Object(Na.a)(new Ka.a,{name:"hasScriptLink",bool:!!this.scriptLink}));ya.push(Object(Na.a)(new Ka.a,{name:"runStatus",string:this.runStatus}));ya.push(Object(Na.a)(new Ka.a,{name:"clickId",
string:hb}));ya.push(Object(Na.a)(new Ka.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));za.a(nb.a.jkj,void 0,void 0,ya)}pAc(hb,ya){const Pa=[];Pa.push(Object(Na.a)(new Ka.a,{name:"id",string:this.id.toString()}));Pa.push(Object(Na.a)(new Ka.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Pa.push(Object(Na.a)(new Ka.a,{name:"runStatus",string:this.runStatus}));Pa.push(Object(Na.a)(new Ka.a,{name:"clickId",string:ya}));za.d(hb,void 0,void 0,void 0,void 0,void 0,Pa)}}Object(B.a)(xb,
"OfficeScriptsRunStatusBusinessBarEntry",C.a,[]);var Tb=a(54);class Cc extends w.a{constructor(hb,ya,Pa,wb,Ib,pb){super(hb,ya,Pa);Tb.a.instance.create(()=>{this.showCallout(ya,wb)},Ib,pb,!0,!0)}showCallout(hb,ya){if(this.businessBar&&this.businessBar.Yia(hb.MAa)&&this.uOe()){hb=new R.a(-847286761,0,this.businessBar.$.zf,0,null);var Pa={};Pa.CalloutName=ya;jb.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Pa.Target=this.tP():Pa.Target=jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.domElement.getElementsByTagName("button")[0]:this.JU.domElement;this.businessBar.$.Ha.Me(hb,Pa)}}uOe(){return!0}}Object(B.a)(Cc,"CalloutBusinessBarEntry",w.a,[]);class lb extends Cc{constructor(hb,ya,Pa,wb,Ib,pb){super(hb,ya,Pa,wb,Ib,pb)}uOe(){if(!jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0))return!0;if(!this.businessBar)return!1;const hb=ab.a.mg(qb.Sc);return hb&&hb.bLc?!1:!0}}Object(B.a)(lb,"OptimizeWorkbookCalloutBusinessBarEntry",
Cc,[]);var Ya=a(18),Hb=a(120),Lb=a(81),qc=a(116);class mc extends C.a{constructor(hb,ya,Pa){super(hb,ya);this.update(Pa)}update(hb){this.title=hb.title?hb.title:"";this.message=hb.message?hb.message:"";const ya=this.iEh(hb.businessBarType);this.Iva(ya);this.hideCloseButton=!!hb.hideCloseButton;if(jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const Pa=[];Pa.push(Hb.a.Ni("Reason",hb.reason,2));Pa.push(Hb.a.Ni("Type",ya.toString(),2));za.a("MsFormsDataSyncBizBarShown",
void 0,void 0,Pa)}jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormsDataSyncFGSurveyEnabled",!1)&&Lb.a.instance.We("Common.ISystemInitiatedFeedback").execute(Pa=>{xa.AFrameworkApplication.jl.Li(new qc.a(5,1,2E4,()=>{Pa.logActivity("ExcelFormsDataSync",null)}))})}iEh(hb){switch(hb){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(B.a)(mc,"MsFormsDataSyncStatusBusinessBarEntry",C.a,[]);
class Ta extends C.a{constructor(hb,ya,Pa,wb){super(hb,ya);this.l0=this.Sv=!0;this.mIj=Pa;this.nih=wb}Wp(hb){super.Wp(hb);this.businessBar.$.Ha.Me(new R.a(this.mIj,hb,this.businessBar.$.zf,10,null))}h1(hb){super.Wp(hb);this.businessBar.$.Ha.Me(new R.a(this.nih,hb,this.businessBar.$.zf,10,null))}}Object(B.a)(Ta,"DualCommandActionsBusinessBarEntry",C.a,[]);var Va=a(1179),Db=a(402),Ca=a(155);class cb extends A.a{constructor(hb,ya){super(ya);this.Vjf=h.DOMElementExtensions.jE+",div";this.f_=Array(74);
this.ewe=this.Iq=!1;this.k1=Pa=>{if(Pa.Ga.keyCode===b.a.bC){var wb=this.ng.querySelectorAll(this.Vjf);const Ib=h.DOMElementExtensions.Xz(wb);wb=h.DOMElementExtensions.H5(wb);return h.DOMElementExtensions.M0a(Pa.Ga,Ib,wb)}return!1};this.Ie=hb;this.set_visible(!1);jb.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")||(this.addCssClass(t.a.$qd),jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(t.a.Fbf));k.KeyInputManager.instance.va(m.a.Hf,
this.ng,this.k1);v.a(hb).sn(this)}get Qh(){return Rb.a.Tfd}get ng(){return this.domElement}get nl(){return this.get_visible()}get $(){return this.Ie}Wl(hb,ya){jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?ya||h.DOMElementExtensions.setFocus(h.DOMElementExtensions.Xz(this.ng.querySelectorAll(this.Vjf))):ya||h.DOMElementExtensions.setFocus(this.domElement.firstChild);return!ya}Bm(hb){return h.DOMElementExtensions.Ek(this.ng,hb)}Ko(){}Rp(){}dispose(){this.Iq||(k.KeyInputManager.instance.Da(m.a.Hf,
this.ng,this.k1),d.a.Wf(this.f_),this.f_=Array(74),this.Ie=null,super.dispose(),this.Iq=!0)}Yia(hb){if(!this.get_visible())return!1;hb=this.f_[hb];return!!hb&&hb.isVisible}kwd(hb){return this.Yia(hb)?this.f_[hb].tP():null}EJ(hb){return!!this.f_[hb]}x1b(hb,ya){if(hb=this.f_[hb])hb.update(ya),hb.OCk()}RA(hb,ya,Pa,wb){Pa=void 0===Pa?null:Pa;wb=void 0===wb?null:wb;jb.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")?Object(Ca.b)(()=>{this.BKe(hb,ya,Pa,wb)},this.Ie.qa):this.BKe(hb,
ya,Pa,wb)}BKe(hb,ya,Pa,wb){Pa=void 0===Pa?null:Pa;wb=void 0===wb?null:wb;let Ib=!1;if(jb.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")&&!this.ewe){var pb=jb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?`${t.a.$qd} ${t.a.Fbf}`:t.a.$qd;this.addCssClass(pb);this.ewe=!0}if(this.EJ(hb))Pa=this.f_[hb].get_visible();else{this.set_visible(!0);pb=cb.Xvf(this.$)[hb];this.f_[hb]=this.gS(hb,ya,Pa,wb);Pa=!1;Ib=!0;wb="";let xc=0;ya&&(wb=ya.MessageIdName,
xc=ya.MessageId);const ua=pb.ECa,U=Sa.a.instance.xba(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${hb}, time from app interactive: ${U}`);jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===pb.businessBarType||Zb.a(this.$).d5d(pb.hash,wb,xc,n.a.URc,!0,1,ya,ua)}Pa||!x.BusinessBarManager.asc().includes(hb)&&!Ib||(this.f_[hb].set_visible(!0),this.$.GN())}removeEntry(hb){return this.USj(hb)}U2d(){d.a.Wf(this.f_);this.f_=
Array(74);this.set_visible(!1)}USj(hb){if(!this.EJ(hb))return!1;d.a.Sa(this.f_[hb]);this.f_[hb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.GN();return!0}gS(hb,ya,Pa,wb){Pa=void 0===Pa?null:Pa;wb=void 0===wb?null:wb;const Ib=cb.Xvf(this.$)[hb],pb=!!(this.$.Wg&64),xc=this.$.Hgb()&&jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7976786_EnableFileSaveAsForSaveToOneDriveScenario");switch(hb){case 23:hb=xc?new w.a(this,Ib,617689800):new C.a(this,Ib);break;case 2:case 4:case 25:case 26:case 36:case 35:hb=
new C.a(this,Ib);break;case 12:case 29:case 30:case 31:case 32:case 57:hb=pb?new w.a(this,Ib,-8805455):new C.a(this,Ib);break;case 34:hb=pb?new Ta(this,Ib,-8805455,-104572626):new C.a(this,Ib);break;case 22:hb=new z(this,Ib,-8805455);break;case 46:case 45:hb=pb?new I(this,Ib,ya,0,-8805455):new J(this,Ib,ya,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:hb=new J(this,Ib,ya,0);break;case 19:hb=new C.a(this,Ib);break;case 47:hb=new J(this,Ib,ya,0);break;case 6:case 14:hb=new Q(this,Ib,
ya.HelpTopicId);break;case 67:case 65:hb=new P(this,Ib,ya.HelpTopicId);break;case 73:hb=new P(this,Ib,Db.a.zbg);break;case 72:hb=new z(this,Ib,-1698025133);break;case 37:hb=new P(this,Ib,u.a.pNh);break;case 38:hb=new C.a(this,Ib);break;case 71:hb=new C.a(this,Ib);break;case 68:hb=new z(this,Ib,924877417);break;case 16:hb=new C.a(this,Ib);hb.title=l.a.Qn(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);hb.message=l.a.Qn(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:hb=
new w.a(this,Ib,-1762562205);hb.hideCloseButton=!0;break;case 20:hb=new kb(this,Ib);break;case 21:case 56:hb=new C.a(this,Ib);break;case 28:hb=new C.a(this,Ib);break;case 24:hb=new ta(this,Ib);break;case 27:hb=new W(this,Ib);break;case 39:hb=new Xa.a(this,Ib);break;case 40:hb=new y.a(this,Ib);break;case 41:hb=new S.a(this,Ib);break;case 42:hb=new va.a(this,Ib);break;case 48:hb=new C.a(this,Ib);break;case 49:hb=new C.a(this,Ib);break;case 50:hb=new C.a(this,Ib);break;case 51:hb=new C.a(this,Ib);break;
case 52:hb=new C.a(this,Ib);break;case 53:hb=new aa.a(this,Ib);break;case 54:hb=new da.a(this,Ib);break;case 55:hb=new X(this,Ib);break;case 5:hb=new T(this,Ib);break;case 58:hb=new w.a(this,Ib,-1753056834);ya?(ya=ya.Directive,zb.a.vu(ya)||"&nbsp;"===ya||(hb.message=ya)):Pa&&(hb.message=Pa);break;case 59:hb=new Ba(this,Ib);break;case 60:hb=new C.a(this,Ib);break;case 63:hb=new P(this,Ib,u.a.kjj);break;case 61:hb=new ia(this,Ib,u.a.Ymh,-8805455);break;case 66:hb=new ia(this,Ib,u.a.GNj,1461300262);
break;case 62:hb=new lb(this,Ib,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");hb.message=Pa;break;case 70:hb=new Va.a(this,Ib,-1190551534);break;case 64:hb=new xb(this,Ib,this.$,wb);break;case 69:hb=new mc(this,Ib,wb);break;default:hb=new J(this,Ib,ya,7)}hb.e2e();return hb}static Xvf(hb){const ya=hb.Hgb()&&jb.EwaSettings.isChangeGateEnabled("OfficeVSO:7976786_EnableFileSaveAsForSaveToOneDriveScenario");hb=nc.a.Jsa()?261:260;return cb.uUe||(cb.uUe=[new Y(0,276,277,278,
0,0,cb.qqa,1,"BB_UnableToRefreshLock"),new Y(1,276,277,278,0,0,cb.qqa,1,"BB_UnableToRefreshLockExpected"),new Y(2,268,269,0,0,0,cb.EA,5,"BB_WorkbookAlmostTooLarge"),new Y(3,270,271,272,0,0,cb.qqa,1,"BB_WorkbookTooLarge"),new Y(4,259,hb,0,0,0,cb.EA,5,"BB_ExternalWorkbookLinksDisabled"),new Y(5,263,262,264,0,0,cb.qqa,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new Y(6,265,266,267,0,0,cb.Sl,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new Y(7,251,252,253,0,0,cb.Sl,5,"BB_UnsupportedFeatures"),
new Y(8,0,0,0,0,0,cb.Sl,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new Y(9,0,0,0,0,0,cb.Sl,0,"BB_CollabDataStringsLocaleMismatch"),new Y(10,0,0,0,0,0,cb.Sl,0,"BB_CollabDataLocaleMismatch"),new Y(11,279,280,281,0,0,cb.qqa,1,"BB_LastGenericStatusError"),new Y(12,282,283,284,0,0,cb.EA,5,"BB_ScratchPadWarning"),new Y(13,285,286,287,0,0,cb.qqa,1,"BB_AuthenticationLost"),new Y(14,288,289,290,0,0,cb.EA,5,"BB_OdfCompatibilityIssues"),new Y(15,0,575,0,0,0,cb.EA,5,"BB_PivotChartInteractivityMissingWarning"),
new Y(16,0,0,0,0,0,cb.Sl,2,"BB_WorkbookIsIrmProtected"),new Y(17,0,0,0,0,0,cb.Sl,0,"BB_BIFeatureNotAvailable"),new Y(18,291,292,287,0,0,cb.EA,5,"BB_AnonymousCreateMode"),new Y(19,254,255,0,0,0,cb.EA,5,"BB_UnsupportedInteractiveReportEditing"),new Y(20,0,0,0,0,0,cb.Sl,0,"BB_MobileAppCampaignBizBar"),new Y(21,297,298,0,0,0,cb.Sl,0,"BB_TransientServerCommunicationFailures"),new Y(22,1643,1654,1655,0,0,cb.Sl,5,"BB_EditAttemptInReadOnly"),new Y(23,1643,ya?2348:1654,ya?2349:0,0,0,cb.Sl,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),
new Y(24,0,ba.HelperMethods.jCk(),1632,0,0,cb.Sl,3,"BB_UnsupportedBrowser"),new Y(25,300,301,0,0,0,cb.Sl,2,"BB_ReadOnlyPermissions"),new Y(26,302,303,0,0,0,cb.Sl,2,"BB_DocumentIsIrmProtectedWarning"),new Y(27,0,0,0,0,0,cb.EA,5,"BB_PolicyWarningMessage"),new Y(28,1285,299,0,0,0,cb.Sl,0,"BB_WorkingOnIt"),new Y(29,1643,1641,1642,0,0,cb.Sl,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new Y(30,1656,1657,1658,0,0,cb.Sl,5,"BB_WorkbookIsReadOnlyRecommended"),new Y(31,1643,1659,1660,0,0,cb.Sl,5,"BB_WorkbookHasPasswordToModify"),
new Y(32,1643,1661,1664,0,0,cb.Sl,3,"BB_LegacySharedWorkbookEditWarning"),new Y(33,1651,1662,253,0,0,cb.Sl,5,"BB_LegacyConnectionsWarning"),new Y(34,1643,1960,1961,1962,0,cb.Sl,0,"BB_TooManyLoadBlockingFloatingObjects"),new Y(35,1652,1653,0,0,0,cb.Sl,2,"BB_GroupedSlicers"),new Y(36,313,314,0,0,0,cb.EA,5,"BB_ThirdPartyAddinDisabled"),new Y(37,1789,1790,0,0,1791,cb.Sl,5,"BB_FinanceLinkedEntityDisclaimerBar"),new Y(38,1818,1819,0,0,0,cb.EA,5,"BB_WolframDeprecationAlertBar"),new Y(39,0,0,0,0,0,cb.Sl,
0,"BB_WacGdprNotice"),new Y(40,0,0,0,0,0,cb.Sl,0,"BB_AutomaticSensitivityLabel"),new Y(41,0,0,0,0,0,cb.Sl,0,"BB_RecommendedSensitivityLabel"),new Y(42,0,0,0,0,0,cb.Sl,0,"BB_MandatorySensitivityLabel"),new Y(43,315,316,317,0,0,cb.Sl,0,"BB_LocalStorageDisabled"),new Y(44,632,633,0,0,0,cb.Sl,0,"BB_AutoRefreshDisabled"),new Y(45,1014,1012,1016,1314,0,cb.Sl,4,"BB_CorruptedFileRepaired"),new Y(46,1015,1013,1016,1314,0,cb.Sl,5,"CorruptedOdsFileRepaired"),new Y(47,273,274,275,0,0,cb.EA,5,"BB_MinorVersionLimitReached"),
new Y(48,304,305,0,0,0,cb.EA,5,"BB_SensitivityApplicationGenericError"),new Y(49,306,308,0,0,0,cb.EA,5,"BB_SensitivityApplicationTooLargeFileError"),new Y(50,307,308,0,0,0,cb.EA,5,"BB_SensitivityApplicationLabelNotSupportedError"),new Y(51,309,310,0,0,0,cb.EA,5,"BB_SensitivityApplicationLabelDisabledError"),new Y(52,311,312,0,0,0,cb.EA,5,"BB_SensitivityApplicationMandatoryConflictError"),new Y(53,0,0,0,0,0,cb.EA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new Y(54,0,0,0,0,0,cb.EA,
5,"BB_SensitivityApplicationSetLabelError"),new Y(55,2119,2120,2121,2124,0,cb.Sl,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new Y(56,297,298,0,0,0,cb.Sl,0,"BB_NetworkDown"),new Y(57,318,319,320,0,0,cb.Sl,2,"BB_DefaultToViewDueToCogs"),new Y(58,1815,1816,1817,0,0,cb.Sl,1,"BB_RefreshLinkedEntityErrorBar"),new Y(59,1792,1793,1794,1795,0,cb.Sl,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new K(60,250,0,0,0,cb.Sl,5,"BB_CanvasHealth"),new Y(61,1017,1018,1314,0,1019,cb.Sl,
5,"BB_MismatchedFileFormatConverted"),new Y(62,2238,0,2240,0,0,cb.Sl,5,"BB_OptimizeWorkbook"),new Y(63,321,322,0,0,323,cb.Sl,0,"BB_NovModePostDepreciation"),new Y(64,0,0,0,0,0,cb.Sl,0,"BB_OfficeScriptsRunning"),new Y(65,2214,2215,0,0,2217,cb.Sl,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new Y(66,324,325,0,0,326,cb.Sl,5,"BB_ReadOnlyPivotTable"),new Y(67,2214,2216,0,0,2217,cb.Sl,0,"BB_PowerQueryRefreshHostNotSupported"),new Y(68,1057,f.a.sxc?1059:1058,1056,0,0,cb.Sl,4,"BB_RefreshPageAfterEnablingTheExtension"),
new Y(69,0,0,0,0,0,cb.Sl,0,"BB_MsFormsDataSyncStatus"),new Y(70,0,0,0,0,0,cb.EA,5,"BB_DataCleansingSuggestions"),new K(71,2324,0,0,0,cb.Sl,4,"BB_EditInMiniWAC","EditExcel_16"),new Y(72,2326,2327,2325,0,0,cb.EA,5,"BB_PowerQueryUnsupportedTeams"),new Y(73,2326,2328,0,0,2217,cb.EA,5,"BB_PowerQueryEnableThirdPartyCookies")])}}cb.qqa=Ya.a.y1h;cb.EA=Ya.a.A1h;cb.Sl=Ya.a.z1h;cb.uUe=null;Object(B.a)(cb,"BusinessBarControl",A.a,[54])},1247:function(B,A,a){a.d(A,"a",function(){return W});B=a(0);var c=a(2),b=
a(15),k=a(35),m=a(98),d=a(16),n=a(137),l=a(334);A=a(82);var f=a(9),h=a(85),t=a(8),u=a(146),v=a(487);class y{constructor(S,da){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=da;this.parentElement=S}RFh(){const S=this.SFh();v.a(this.$,243,242,0,da=>{this.cardViewManager=da;da.$jk(this.parentElement,S)})}Pzf(){this.cardViewManager&&this.cardViewManager.Deb(-1,-1,this.parentElement)}SFh(){const S={layoutId:"AutoDetectTooltip"};
S.description=this.longDescription;S.convertToDomainName=this.convertToDomainName;S.longDescription=this.longDescription;S.urlValue=this.urlValue;S.imageAltText=this.imageAltText;S.helpText=this.helpText;S.helpId=this.helpId;return S}}Object(B.a)(y,"AutoDetectCardManager",null,[]);var C=a(34),x=a(230),w=a(32),z=a(266),F=a(18),J=a(58);class R extends A.a{constructor(S,da,aa){super();this.Hg=za=>{if(za.rf.id===this.TRa.firstChild.id){za=this.jSe;const qa={};qa.Id=za.DAb;this.convertToLinkedEntityManager.zkd(qa,
!0,za);this.TRa.removeChild(this.TRa.firstChild);return!0}return!1};this.jSe=S;this.convertToLinkedEntityManager=da;this.TRa=document.createElement("div");this.TRa.className="clip16x16";this.GEa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',w.a.Qn("autodetectid"+this.jSe.left),F.a.Krd,J.a.rk(11));aa.tm(this.TRa,this.GEa);S=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");z.a.instance.va(d.a.click,S,this.Hg)}get domElement(){return this.TRa}dispose(){if(this.TRa){const S=
document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");z.a.instance.Da(d.a.click,S,this.Hg)}super.dispose()}static get Mrh(){return"clip16x16"}}Object(B.a)(R,"AutoDetectColumnHeaderButton",A.a,[]);var I=a(1),O=a(1168),Y=a(12),K=a(19),L=a(220);class X extends A.a{constructor(S,da,aa){super();this.wf=null;this.$=S;this.gridView=K.h(S);this.convertToLinkedEntityManager=da;this.wf=aa;this.jjd=new L.a}dispose(){super.dispose()}qSh(S){for(const da of this.gridView.UZ)for(const aa of da){const za=
aa,qa=za.dy,ta=O.a(za.Eba);this.l$g(S,ta,qa);za.n$d(ta)}}l$g(S,da,aa){if(da.length){var za=aa.length;aa[za-1]<S.left||(aa=Y.HelperMethods.SD(new x.a(aa),0,za,S.left,Y.HelperMethods.EK),0>aa||!(da=da[aa]))||(this.gridView.rtl?da.classList.add(C.a.F4h):da.classList.add(C.a.E4h),this.jjd.$d(S.left)||this.jjd.add(S.left,new R(S,this.convertToLinkedEntityManager,this.wf)),S=this.jjd.ka(S.left).domElement,!da.getElementsByClassName(R.Mrh).length&&this.Fok(da)&&da.appendChild(S))}}Fok(S){const da=parseInt(S.style.width,
10);var aa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";aa=X.BHh(aa);S=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.wf.Gwi(S.firstChild.innerHTML),aa,!0,I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<da-(da/2+S/2)?!0:!1}static BHh(S){return`${"normal"} ${"normal"} ${S} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(B.a)(X,"AutoDetectColumnHeaderManager",A.a,[]);var T=a(453),ba=
a(23),Q=a(74),P=a(157),ka=a(14),ia=a(13),Ba=a(102),va=a(69);class W extends A.a{constructor(S,da,aa,za,qa){super();this.isMac=k.a.isMac;this.A7a=-1;this.Zic=null;this.BBa=-1;this.fXa=this.dzc=this.cde=this.TFa=this.kSe=!1;this.FZ=null;this.dk=()=>{this.QEa&&this.gridView&&this.ZX()};this.sg=()=>{this.fz()};this.Hg=()=>{this.dRa();K.h(this.$).Wl(!0,!1)};this.cHa=(Xa,oa)=>{oa?(this.hKg(this.Zic),this.pAg()):(Xa=[29],this.gridView.Se.Fl(Xa),this.gridView.Se.lo(null,Xa),this.FZ&&this.FZ.Pzf())};this.sm=
()=>{this.mgb()&&this.Xm.hide();1===this.gridView.ha.Yh&&this.ZX()};this.yB=()=>{const Xa=this.gridView.ha.Yh;this.gridView.ha.pa.activeCell&&1===Xa&&this.ZX()};this.onKeyUp=Xa=>this.Rzc?this.TFa?!1:17===Xa.Ga.keyCode&&this.cde?(this.fXa?(this.pAg(),this.Smb()):this.vug(),!0):!1:this.TFa=!1;this.onKeyDown=Xa=>{if(!this.Rzc)return this.TFa=!1;this.cde=!1;this.TFa=Xa.ctrlKey;switch(Xa.Ga.keyCode){case 27:return this.fXa?(this.cHa(null,!1),this.Smb()):this.FZ&&(this.FZ.Pzf(),this.vug()),!0;case 13:if(this.fXa)return this.fXa=
!1,this.dRa(),!0;break;case 17:return this.cde=!0}return!1};const {AutoDetectActionButton:ta}=a(1309);this.$=S;this.EAb=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);da||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=za;za.rUb();this.Xm=new ta(S,da,this.Hg,aa,"");this.omh=new X(this.$,za,qa);this.gridView=K.h(this.$);this.gridView.ha.KR(this.dk);this.gridView.kf.dzb(this.dk);
this.gridView.Dw(this.yB);S.Sm(this.sg);S.MD(this.sm);this.gridBlockManager=Object(n.a)(318,this.gridView.ya);this.kz=S.frame.wD;this.ZX()}get ng(){return this.Xm.domElement(1)}get Rzc(){const S=this.Xm.domElement(W.oma);return S?ka.DOMElementExtensions.isVisible(S):!1}get QEa(){return this.$.isEditMode&&I.EwaSettings.Ia(128)&&I.EwaSettings.Ia(131)&&(new P.a(this.$.sa)).Vk?!1:-1!==this.BBa}dispose(){this.gridView&&this.gridView.ha.ZT(this.dk);if(this.$){const S=this.$;S.ar(this.sg);S.wG(this.sm);
K.h(S).qz(this.yB)}m.a.Sa(this.Xm);this.kz=this.$=this.gridView=this.Xm=null;super.dispose()}fz(){this.cHa(null,!1);this.A7a=-1;this.Xm.hide();this.TAk();this.fXa=!1}Smb(){this.Xm.getButton(W.oma).$Wb();this.fXa=!1}vug(){this.Xm.getButton(W.oma).clb();this.hKg(this.Zic);this.fXa=!0;I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void u.a.Xn(t.i).then(S=>{S.D7(ia.a.instance.ia(1751))}):this.$.ja.Ne(211,S=>{S.D7(ia.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.QEa&&
-1!==this.A7a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}pmh(S){var da=new ba.Range(1===S.top?1:S.top-1,S.left,S.bottom,S.right,!0,!1);da=this.gridView.getRangeInformation(da);for(const aa of da)if(Object(l.a)(T.AutoDetectRange,aa)&&this.Dvc(S,!1,aa))return!0;return!1}dRa(){if(this.QEa&&-1!==this.A7a){this.Xm.getButton(W.oma).clb();var S={};S.Id=this.BBa;S.StringId=null;this.convertToLinkedEntityManager.zkd(S,!0,this.Zic);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");
S=[Object(c.a)(new va.a,{name:"Domain",int64:this.BBa})];Ba.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,S);this.BBa=-1}}kii(){let S=ia.a.instance.ia(1747);if(-1!==this.BBa){S+=" ";try{S+=this.convertToLinkedEntityManager.UOb(this.BBa.toString())}catch(da){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.BBa}`)}}S+=" ";return S=this.EAb?S+ia.a.instance.ia(1750):S+ia.a.instance.ia(this.isMac?1749:1748)}pAg(){this.EAb&&
(this.FZ||(this.FZ=new y(this.ng,this.$),this.FZ.convertToDomainName=ia.a.instance.ia(1752),this.FZ.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.FZ.imageAltText=ia.a.instance.ia(1754),this.FZ.helpId="HID_DataTypes_Wolfram",this.FZ.helpText=ia.a.instance.ia(1753)),this.FZ.longDescription=this.convertToLinkedEntityManager.Yge(this.A7a.toString()),this.FZ.RFh())}Dvc(S,da,aa){if((new ba.Range(aa.top,aa.left,aa.bottom===f.a.oi?aa.bottom:aa.bottom+
1,aa.right,!0,!1)).Zf(S)){if(da){if(aa&&aa.DAb!==this.A7a){this.A7a=aa.DAb;S=aa.DAb.toString();da=this.EAb?"":this.convertToLinkedEntityManager.Yge(S);const za=this.convertToLinkedEntityManager.iKi(S);this.Xm.Zqb(this.convertToLinkedEntityManager.UOb(S),da,za,W.oma)}this.BBa=aa.DAb;this.Zic=aa}return!0}return!1}ZX(){if(this.convertToLinkedEntityManager){var S=this.gridView.ha.Yh;if(this.gridBlockManager&&this.gridBlockManager.SCd){var da=this.gridView.ha.pa.activeCell,aa=!this.gridBlockManager.kv(da),
za=this.gridView.getRangeInformation(this.gridView.Xk);for(const qa of za)if(Object(l.a)(T.AutoDetectRange,qa))switch(za=qa,za.zxh){case 3:if(this.Dvc(da,!0,za)){if(1!==S||aa){this.fz();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.A2d();this.Xm.Kla(da,this.cHa);this.kSe||(this.kSe=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",
!1)||I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.omh.qSh(za);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.fz()}}hKg(S){const da=[29];this.gridView.Se.lo(S,da);this.gridView.Se.Ys(da)}mgb(){return this.$.ea.isNamedObjectViewMode&&Q.f(this.$.na)}A2d(){this.EAb&&!this.dzc&&this.kz&&(this.kz.oz(d.a.Hf,this.$.domElement,this.onKeyDown,!0),this.kz.oz(d.a.mh,
this.$.domElement,this.onKeyUp,!0),this.dzc=!0)}TAk(){this.EAb&&this.dzc&&this.kz&&(this.kz.Cz(d.a.Hf,this.$.domElement,this.onKeyDown,!0),this.kz.Cz(d.a.mh,this.$.domElement,this.onKeyUp,!0),this.dzc=!1)}static get oma(){return 1}static rki(S){return ia.a.instance.ia(1808)+h.a.space+S}}Object(B.a)(W,"AutoDetectManager",A.a,[])},1252:function(B,A,a){a.r(A);a.d(A,"BusinessBarManager",function(){return Q});B=a(203);A=a(0);var c=a(15),b=a(5),k=a(98),m=a(35),d=a(40),n=a(82),l;(function(P){P[P.unableToRefreshLock=
0]="unableToRefreshLock";P[P.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";P[P.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";P[P.workbookTooLarge=3]="workbookTooLarge";P[P.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";P[P.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";P[P.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";P[P.unsupportedFeatures=7]="unsupportedFeatures";P[P.collabDataAndDataStringsLocaleMismatch=
8]="collabDataAndDataStringsLocaleMismatch";P[P.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";P[P.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";P[P.lastGenericStatusError=11]="lastGenericStatusError";P[P.scratchPadWarning=12]="scratchPadWarning";P[P.authenticationLost=13]="authenticationLost";P[P.odfCompatibilityIssues=14]="odfCompatibilityIssues";P[P.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";P[P.workbookIsIrmProtected=16]="workbookIsIrmProtected";
P[P.biFeatureNotAvailable=17]="biFeatureNotAvailable";P[P.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";P[P.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";P[P.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";P[P.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";P[P.editAttemptInReadOnly=22]="editAttemptInReadOnly";P[P.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";P[P.unsupportedBrowser=
24]="unsupportedBrowser";P[P.readOnlyPermissions=25]="readOnlyPermissions";P[P.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";P[P.policyWarningMessage=27]="policyWarningMessage";P[P.workingOnIt=28]="workingOnIt";P[P.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";P[P.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";P[P.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";P[P.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";
P[P.legacyConnectionsBB=33]="legacyConnectionsBB";P[P.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";P[P.groupedSlicersBB=35]="groupedSlicersBB";P[P.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";P[P.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";P[P.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";P[P.wacGdprNotice=39]="wacGdprNotice";P[P.automaticSensitivityLabel=40]="automaticSensitivityLabel";P[P.recommendedSensitivityLabel=
41]="recommendedSensitivityLabel";P[P.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";P[P.localStorageDisabled=43]="localStorageDisabled";P[P.autoRefreshDisabled=44]="autoRefreshDisabled";P[P.corruptedFileRepaired=45]="corruptedFileRepaired";P[P.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";P[P.minorVersionLimitReached=47]="minorVersionLimitReached";P[P.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";P[P.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";
P[P.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";P[P.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";P[P.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";P[P.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";P[P.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";P[P.promptEnableExternalLinks=
55]="promptEnableExternalLinks";P[P.networkDown=56]="networkDown";P[P.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";P[P.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";P[P.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";P[P.canvasHealth=60]="canvasHealth";P[P.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";P[P.optimizeWorkbook=62]="optimizeWorkbook";P[P.novModePostDepreciation=63]="novModePostDepreciation";P[P.officeScriptsRunning=
64]="officeScriptsRunning";P[P.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";P[P.readOnlyPivotTable=66]="readOnlyPivotTable";P[P.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";P[P.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";P[P.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";P[P.dataCleansingSuggestions=70]="dataCleansingSuggestions";P[P.editInMiniWAC=71]="editInMiniWAC";P[P.powerQueryUnsupportedTeams=
72]="powerQueryUnsupportedTeams";P[P.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";P[P.count=74]="count"})(l||(l={}));Object(A.b)("EwaBusinessBarEntryType",l);var f=a(6),h=a(1177);class t extends Sys.EventArgs{constructor(P,ka,ia){ia=void 0===ia?null:ia;super();this.MAa=P;this.Jod=ka;this.data=ia}}Object(A.a)(t,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var u=a(1180),v=a(1178),y=a(1182);a(1181);var C=a(1175),x=a(500),w=a(41),z=a(698),F=a(33),J=a(1),R=a(19),
I=a(67),O=a(76),Y=a(1012),K=a(146),L=a(8),X=a(1179),T=a(94),ba;let Q=ba=class extends n.a{constructor(P,ka){ka=void 0===ka?!P.Mba:ka;super();this.Va=new d.a;this.sV=null;this.pZc=[];this.bDc=()=>{this.$.oa.rsa?this.removeEntry(13):this.Uj(13,null)};this.uk=(ia,Ba)=>{for(let va=0,W=ba.asc().length;va<W;va++)ia=ba.asc()[va],this.removeEntry(ia);Ba.context&&0<Ba.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
this.removeEntry(21));this.sYj()};this.Fp=(ia,Ba)=>{var va;ia=this.z9h(Ba.errors);let W=[];for(let da=0,aa=ia.length;da<aa;++da){const za=ia[da];if(1===za.Type&&za.Appearance&32)W=this.eGi(za,W);else if(Ba.N7j){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var S=(null===(va=Ba.context)||void 0===va?0:va.stopwatch)?Ba.context.stopwatch.gg:-1;5E3>S?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${S}ms).`):
b.AFrameworkApplication.M1i()||this.ich(za,Ba.context.methodName)}S=[...ba.asc()];for(let qa=0,ta=W.length;qa<ta;++qa){const Xa=W[qa];this.Uj(Xa,za);Array.remove(S,Xa)}for(let qa=0,ta=S.length;qa<ta;++qa)this.removeEntry(S[qa])}};this.vg=(ia,Ba)=>{this.sg(ia,Ba)};this.sg=()=>{const ia=this.$.ea;ia.tf||ia.Yj()||(this.U2d(),this.pZc.length=0)};this.Xg=(ia,Ba)=>{this.$.ea.Yj()&&!Ba.K0||this.VBf(Ba.K0)};this.vTb=()=>{const ia=this.$.userOperationManager.Prc();ia&&ia.operation.flags&1&&this.Czg()};this.y2f=
()=>{this.Czg()};this.ij=()=>{this.tXe();this.Ozg()};this.JK=()=>{if(this.$.y6&&this.$.ea.Yj()&&this.$.ea.tf)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ia=this.$.ja.Qa(331);ia&&ia.CSa||this.removeEntry(55);this.removeEntry(5)}};this.$=P;this.v8a=ka;this.jlh();b.AFrameworkApplication.lg&&b.AFrameworkApplication.lg.Tyb(this);
this.B7a=Array(74);for(let ia=0;74>ia;ia++)this.B7a[ia]=null;this.ol=z.EcmaDateClock.instance;this.bNf=this.ol.yf.getTime();ka&&(ka=P.oa,ka.Iy(this.Fp),ka.rt(this.uk),ka.YOa(this.bDc),ka.eAa(this.bDc),P.ea.wn(this.vg),P.ea.Jy(this.ij),P.Go(this.Xg),P.Sm(this.sg),P.ea.aM(this.JK),P.userOperationManager.pt(this.vTb),J.EwaSettings.Ia(158)&&P.ea.qk.get(45)&&b.AFrameworkApplication.fa.la("SupportsPolicies")||this.Mxf(),this.VBf(I.c(P)))}Mxf(){F.a.wt(this.$.ea.KK)&&this.Fp(this,new x.a(this.$.ea.KK,null,
!1,-1,-1,-1,-1,"",-1,"",-1))}Pch(P){this.Va.addHandler("bBarAttachedOrDetached",P)}get Ppd(){return this.pZc}get domElement(){return this.sV?this.sV.domElement:null}dispose(){if(this.$){const P=this.$,ka=P.oa;ka.rz(this.Fp);ka.Gu(this.uk);ka.vmb(this.bDc);ka.z_a(this.bDc);P.ea.En(this.vg);P.ea.pA(this.ij);P.Hp(this.Xg);P.ar(this.sg);P.ea.UK(this.JK);P.userOperationManager.Nr(this.vTb);R.h(P).kf.$q(this.y2f)}k.a.Sa(this.sV);this.$=this.sV=null;super.dispose()}nTi(P){switch(P){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;
default:return!1}}Uj(P,ka,ia,Ba,va){ia=void 0===ia?null:ia;Ba=void 0===Ba?null:Ba;va=void 0===va?null:va;if(!this.$.isMobileMode||this.nTi(P))this.v8a&&!this.EJ(P)&&(this.B7a[P]=this.ol.rma,this.sV.RA(P,ka,Ba,va),this.Va.raiseEvent("bBarAttachedOrDetached",new t(P,!0,ia))),ka&&32===ka.Appearance&&O.a(this.$).Ig.Uja(ka)}Ekk(P,ka,ia,Ba){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");C.a.initialize(P,ka,ia,Ba);this.Uj(39,null)}wjk(P,ka,ia,Ba){h.a.initialize(P,ka,ia,Ba);
this.Uj(40,null)}Vlk(P,ka,ia,Ba){v.a.initialize(P,ka,ia,Ba);this.Uj(41,null)}akk(P,ka,ia,Ba){X.a.initialize(P,ka,ia,Ba);this.Uj(70,null)}flk(P,ka,ia,Ba){u.a.initialize(P,ka,ia,Ba);this.Uj(42,null)}fmk(P,ka,ia,Ba){y.a.initialize(P,ka,ia,Ba);this.Uj(54,null)}removeEntry(P){this.v8a&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(l,P)}`),this.B7a[P]=null,this.sV.removeEntry(P)&&this.Va.raiseEvent("bBarAttachedOrDetached",
new t(P,!1)))}Yia(P){return this.v8a?this.sV.Yia(P):!1}EJ(P){return this.v8a?this.sV.EJ(P):!1}ejb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}yRb(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}jlh(){const {BusinessBarControl:P}=a(1227);if(this.v8a&&!this.sV){R.h(this.$).kf.jr(this.y2f);var ka=document.getElementById(this.$.Af+
f.a.wUe);this.sV=new P(this.$,ka)}}U2d(){this.v8a&&this.sV.U2d()}sYj(){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ka=this.ol.rma;if(3E5<=ka-this.bNf){this.bNf=ka;for(let ia=0;74>ia;ia++){var P=this.B7a[ia];if(P&&(P=ka-P,3E5<=P)){const Ba=Enum.toString(l,ia);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Ba}] was activated but not turned off for ${P} Millis`)}}}}}z9h(P){const ka=[];for(const ia of P)switch(ia.MessageId){case -113742550:const Ba=
[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||F.a.yk(P,Ba))&&ka.push(-113742550)}return F.a.vG(P,ka)}eGi(P,ka){switch(P.MessageId){case 2113407564:const ia=F.a.z9a([1821390342,-943219229,-502303485,1437034227]);for(let Ba=0;Ba<ia.length;Ba++)ia[Ba].HelpTopicId=P.HelpTopicId,ia[Ba].HelpDescription=P.HelpDescription,this.pZc.push(ia[Ba])}switch(P.MessageId){case -395951567:this.Uj(6,P);break;case 1643490758:this.Uj(4,P);break;
case -907264831:this.Uj(5,P);break;case 757111532:case 2113407564:this.Uj(7,P);break;case 2010656511:this.Uj(15,P);break;case 1321660996:this.$.m5e=!0;this.Uj(8,P);break;case 526339737:this.$.m5e=!0;this.Uj(9,P);break;case -407088521:this.Uj(10,P);break;case 1756116017:this.Uj(14,P);break;case -1703455218:this.Uj(17,P);break;case 1393475740:this.Uj(25,P);break;case -949523941:this.Uj(26,P);break;case 1779381952:this.Uj(44,P);break;case 1421575100:this.Uj(45,P);break;case 613676060:this.Uj(46,P);break;
case 1233668252:this.Uj(61,P);break;case 1911608588:P=!!(this.$.Wg&64);!this.$.ea.Yj()&&P&&ka.push(29);break;case 1544494907:break;case -655555355:ka.push(this.wLd()?1:0);break;case -1221382671:ka.push(2);break;case 1662282929:ka.push(3);break;case 104919273:this.$.ea.Yj()||ka.push(30);break;case -689453604:P=!!(this.$.Wg&64);this.$.ea.Zyf=!0;!this.$.ea.Yj()&&P&&ka.push(31);break;case 157762400:this.$.ea.Xwc=!0;!this.$.ea.Yj()&&this.$.Wg&64&&!this.$.isEditMode&&ka.push(32);break;case -1125398042:!this.$.ea.Yj()&&
this.$.Wg&64&&!this.$.isEditMode&&ka.push(34);break;case -73730134:!this.$.ea.Yj()&&this.$.Wg&64&&ka.push(33);break;case -293349236:ka.push(65);break;case 1580811823:ka.push(67);break;case -37299333:break;case 136737622:ka.push(47);break;case -1780327030:this.Uj(55,P);break;case -113742550:this.Uj(57,P);break;case -260312420:this.$.ea.Yj()||ka.push(66);break;case 784737213:this.$.ea.Yj()||ka.push(70);break;default:this.Uj(11,P)}return ka}ZMi(){if(b.AFrameworkApplication.fa.la("WildFireExcelBizBar")&&
!Y.a.DYi(Y.a.Emf(1))&&(m.a.zr||m.a.gk)){const P=Object(T.d)(K.a.resolve(L.J,{Aa:1}));w.TaskExtensions.Ca(P,()=>{this.Uj(20,null)},this.qa,3)}}lMi(P){P||3!==this.$.workbookContext.WorkbookNovType||this.Uj(63,null)}get iCk(){return b.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)}WMi(){this.iCk&&m.a.S2i&&this.Uj(24,null)}VBf(P){(!P&&!this.$.printingEnabled||this.$.oh.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Uj(16,null));this.ZMi();this.tXe();this.Ozg();this.lMi(P);this.WMi()}tXe(){this.$.workbookContext.Options&32768&&this.tkk()}tkk(){this.B7a[37]||this.Uj(37,null)}Omk(){this.B7a[38]||this.Uj(38,null)}Ozg(){this.$.workbookContext.Options&524288&&this.Uj(59,null)}lAg(P,ka){this.Uj(58,P,null,ka)}Rad(P,ka){var ia=null,Ba=null;ia=void 0===ia?null:ia;Ba=void 0===Ba?null:Ba;ka=void 0===ka?null:ka;
this.sV.EJ(P)?this.sV.x1b(P,ka):this.Uj(P,null,ia,Ba,ka)}Czg(){this.$.Wg&8&&this.Uj(12,null)}wLd(){const P=this.$.ja.Qa(38);return P?P.Pge:!1}ich(P,ka){if(!this.EJ(21)&&-1387426400!==P.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ia={};ia.FailedMethod=ka;this.Uj(21,P,ia)}}static asc(){return ba.sOe||(ba.sOe=[0,1,2,3])}kwd(P){return this.sV.kwd(P)}};Q.sOe=null;Q=ba=Object(B.__decorate)([Object(K.d)(L.s),Object(B.__param)(0,
Object(L.nb)())],Q);Object(A.a)(Q,"BusinessBarManager",n.a,[304,2,104])},1270:function(B,A,a){a.d(A,"a",function(){return d});B=a(0);var c=a(15),b=a(267);class k{constructor(n,l){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=n;this.caller=l;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";
this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(B.a)(k,"NetworkTestResult",null,[]);var m=a(619);class d{constructor(n,l,f,h,t){this.url="";this.Zeb=!1;this.jL=-1;this.testIteration=0;this.baseUrl=f;this.C_f=h;this.cEd=l;this.result=new k(l,t)}runTest(){try{if(this.Zeb)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.cEd} is already mid way, not starting a new one.`),!1;this.reset();this.Zeb=!0;this.result.startTimeMs=Date.now();const n=
new b.QueryStringBuilder(this.baseUrl);n.n$("tid",this.result.startTimeMs.toString());this.url=n.toString();this.g6j();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(n){return this.LGb("Exeption: "+n.message),!1}}reset(){this.url="";this.result.reset();this.Zeb=!1;this.jL=-1}clearTimeout(){-1!==this.jL&&(window.clearTimeout(this.jL),this.jL=-1)}g6j(){try{const n=new XMLHttpRequest;n.onreadystatechange=()=>{4===n.readyState&&(200===n.status?this.N$h():this.LGb(`Error when downloading resource. status code: ${n.status}, status text: ${n.statusText}`,
n.status.toString()))};n.onerror=()=>{this.LGb(`Client error when attempting to download resource. status code: ${n.status}, response: ${n.statusText}`)};this.jL=window.setTimeout(()=>{this.jL=-1;this.LGb("Request timeout")},1E4);n.open("GET",this.url,!0);n.send(null)}catch(n){this.LGb("Exeption: "+n.message)}}N$h(){this.Zeb&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=m.a(this.url),this.result.isSuccess=!0,this.shc())}LGb(n,
l){l=void 0===l?null:l;this.Zeb&&(this.clearTimeout(),this.result.errorMessage=n,this.result.isSuccess=!1,this.result.errorStatusCode=l,this.shc())}shc(){this.Zeb=!1;this.C_f&&this.C_f(this.result,this.cEd)}}Object(B.a)(d,"NetworkTestReq",null,[])},1309:function(B,A,a){a.r(A);a.d(A,"AutoDetectActionButton",function(){return d});B=a(0);A=a(82);var c=a(1247),b=a(58),k=a(13),m=a(19);class d extends A.a{constructor(n,l,f,h,t){super();this.$=n;this.wH=h.ODb(n,l,f,"",b.a.rk(11),t,"AutoDetectPointerDown",
k.a.instance.ia(1808)+"...")}get aA(){return this.wH.aA}dispose(){this.wH.dispose();this.$=null;super.dispose()}domElement(n){return this.wH.domElement(n)}getButton(n){return this.wH.getButton(n,!1)}Zqb(n,l,f,h){this.wH.d3a(c.a.rki(n),l,h);this.wH.JSc(f,l,h)}Kla(n,l){const f=m.h(this.$),h=f.Be.El(n);n=f.Oj(n,h);const t=f.wi(h).ap;if(n&&0<=n.x&&0<=n.y&&t.width>n.width+160){let u=n.bottomRight.x+this.aA,v=n.topLeft.y+this.aA,y=!1;u+160>t.bottomRight.x&&(u=n.topLeft.x-this.aA,y=!0);if(v<t.topLeft.y+
this.aA){if(f.Be.dKa){this.hide();return}v=t.topLeft.y+this.aA}this.wH.Xpd(l,h);this.iq(u,v,f.rtl,h,y)}else this.hide()}iq(n,l,f,h,t){this.wH.iq(n,l,f,h,!1,t)}hide(){this.wH.hide()}}Object(B.a)(d,"AutoDetectActionButton",A.a,[])},1381:function(B,A,a){function c(r,M){this.ID=r;this.type=M}function b(r,M){this.value=r;this.contextId=M}function k(r,M,la,Qa,Kb,hc,Ac,Zc){this.type=r;this.startTime=null==la||null==la.value?new b(la,null):la;this.endTime=null==Qa||null==Qa.value?new b(Qa,null):Qa;null!=
Kb&&null!=Kb.value||new b(Kb,null);null!=hc&&null!=hc.value||new b(hc,null);this.operationType=Zc}function m(r){this.ID=r}function d(){this.Fi=[];this.Rzb=[];this.Rcd=0;this.duration=this.startTime=null;this.Nlc={};this.kRd=this.MRd=this.Eed=-1}function n(r){const M=new Bc.StandardDialog;M.Ye=4;r=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,r)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;M.$X(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
r,Vi)}function l(r,M){return Lo(function*(){if(Object(Dg.m)(r.na)){const la=r.na.sheetProcessedData;Object(Ci.a)(la);return M.map(Qa=>tb(Qa,!0)).filter(Qa=>la.value.qgb(Qa))}return[]})}function f(r){switch(r){case 0:return 1;case 2:return 2;case 1:return 4;default:throw aa.ULS.sendTraceTag(508559903,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${r}`),Error.argument("illegal ExtraSpacesPaddingType");}}function h(r,M,la,Qa,Kb){return Lo(function*(){const hc=Object(jd.u)(r.activeItemName,
null,M),{lWd:Ac,kWd:Zc,HXd:Ad}=v();Object(ae.a)(r.userOperationManager,(re,Ge,kf)=>rd.B(r.oa.ua,Kb,hc,Qa,Object(Xc.b)(re,Ac),Object(Xc.a)(Ge,Zc),kf,null),re=>new Be.a(258,0,re),null);yield Ad;return la.length})}function t(r,M,la){return Lo(function*(){const Qa=Object(jd.u)(r.activeItemName,null,M),Kb=r.oa.ua.qf({wta:!0,ksa:1}),{lWd:hc,kWd:Ac,HXd:Zc}=v();Object(ae.a)(r.userOperationManager,(Ad,re,Ge)=>Bd.m(r.oa.ua,Qa,Object(jd.o)(Yb.h(r).ha.pa.activeCell,r),la,!1,null,null,!0,!1,Object(Xc.b)(Ad,hc),
Object(Xc.a)(re,Ac),Ge,null,Kb,null),Ad=>new Be.a(11,0,Ad),null);yield Zc;return-1})}function u(r,M,la){return Lo(function*(){const Qa=Object(jd.u)(r.activeItemName,null,M),{lWd:Kb,kWd:hc,HXd:Ac}=v(),Zc=la.reduce((re,Ge)=>re|Ge,0);Object(ae.a)(r.userOperationManager,(re,Ge,kf)=>{var sf=r.oa.ua;re=Object(Xc.b)(re,Kb);Ge=Object(Xc.a)(Ge,hc);const Lf=sf.Oa(9,null);Lf.ranges=Qa;Lf.trimWhitespaceType=Zc;return Bd.h(sf,"TrimWhitespace",Lf,re,Ge,kf,null,0)},re=>new Be.a(253,0,re),null);const {Result:Ad}=
yield Ac;return Ad})}function v(){const r=new Ue.a;return{lWd(M){M&&dg.a.Ai(M.Errors)?(aa.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),r.setResult(null)):M?(aa.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),r.setResult(M)):(aa.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),r.setResult(null))},kWd(M){aa.ULS.sendTraceTag(509617681,
0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${M.data.httpStatus}]`);r.setResult(null)},HXd:td.e(r.task)}}function y(r,M){if(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8222616_RefineDiscoverabilityTriggers")&&(Object(uf.c)(r)||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&r.isMobileMode))return!0;r=M.hostState;M=M.worksheetState;return!!r.errorState||r.isInViewMode||M.isInNamedSheetView||M.isProtected}a.r(A);var C=
{};a.r(C);a.d(C,"FirstRunExperienceManager",function(){return Ib});var x={};a.r(x);a.d(x,"InProductMessagingManagerFactory",function(){return U});var w={};a.r(w);a.d(w,"LineageTeachingCalloutTriggerManager",function(){return Pc});var z={};a.r(z);a.d(z,"EnrichmentTaskPane",function(){return kd});var F={};a.r(F);a.d(F,"ReactTaskPaneManager",function(){return $e});var J={};a.r(J);a.d(J,"ProactiveSuggestionManager",function(){return gb});var R={};a.r(R);a.d(R,"ZoomEventManager",function(){return Eg});
var I={};a.r(I);a.d(I,"ZoomManager",function(){return Ja});var O={};a.r(O);a.d(O,"HeaderSnappingFeature",function(){return Qh});var Y={};a.r(Y);a.d(Y,"StatusBarAggregateManager",function(){return Rh});var K={};a.r(K);a.d(K,"ProactiveSuggestionDebugToolsManager",function(){return Ai});var L={};a.r(L);a.d(L,"UnifiedConsentAdapter",function(){return Oh});var X={};a.r(X);a.d(X,"ExtendedTooltipsManager",function(){return Sh});var T={};a.r(T);a.d(T,"DataCleansingHostManager",function(){return og});var ba=
{};a.r(ba);var Q={};a.r(Q);a.d(Q,"SharedUIControlsFactory",function(){return ij});var P={};a.r(P);a.d(P,"AutoAdjustColumnsManager",function(){return jj});var ka={};a.r(ka);a.d(ka,"NetworkConnectionStateManager",function(){return qi});var ia={};a.r(ia);var Ba={};a.r(Ba);a.d(Ba,"SdxManifestPrefetcher",function(){return qj});var va={};a.r(va);a.d(va,"ThemesManager",function(){return rj});var W={};a.r(W);a.d(W,"CalcInterfaceAdapter",function(){return sj});var S={};a.r(S);a.d(S,"CalcManager",function(){return H});
var da=a(0),aa=a(15),za=a(5),qa=a(130),ta=a(426);class Xa extends ta.a{constructor(r){super(r)}get qDb(){return!1}createElement(){const r=document.createElement("link");r.setAttribute("rel","stylesheet");r.setAttribute("type","text/css");r.setAttribute("href",this.sz);return r}Ald(){return null}wIc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.HE.sz)}}Object(da.a)(Xa,"CssResource",ta.a,[]);var oa=a(486),ha=a(271),Za=a(32),Fa=a(64);class La{constructor(){this.f9b=this.f6b=
null}O7i(){this.f6b||(aa.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.f6b=Fa.Task.WAA(La.V7i(),La.J7i()),this.f6b.continueWith(r=>{aa.ULS.sendTraceTag(21030599,324,10,"{0}",Za.a.Dxd(r.exception))},5));return this.f6b}Q7i(){if(!this.f9b)try{aa.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.f9b=Fa.Task.WAA(La.hqd(ha.a.create(za.AFrameworkApplication.fa.Ta("DimeUrl"),null,null))),this.f9b.continueWith(r=>{aa.ULS.sendTraceTag(39978391,
324,10,"{0}",Za.a.Dxd(r.exception))},5)}catch(r){aa.ULS.sendTraceTag(594874951,324,10,"{0}",Za.a.Dxd(r))}return this.f9b}static V7i(){var r=La.Trc("inproductmessaging.js");r=ha.a.create(r,null,null);return La.hqd(r)}static J7i(){var r=La.Trc("inproductmessaging.css");r=new Xa(r);return La.hqd(r)}static Trc(r){return qa.a.TCb(String.format("ipm/{0}",r))}static hqd(r){oa.a.oqa(r);return r.fib}}Object(da.a)(La,"DependencyDownloader",null,[223]);class xa{}xa.OBj="inProductMessagingOverlayDiv";xa.UEj=
"PlayButtonImage";xa.nYj="ReplayButtonImage";Object(da.a)(xa,"Constants",null,[]);class db{constructor(){this.YFe=this.nAe=this.ape=!0;this.oYj=this.VEj=null;this.xgj=!1;this.locale=null;this.NIg={}}get qSe(){return this.ape}set qSe(r){this.ape=r}get nVf(){return this.nAe}set nVf(r){this.nAe=r}get Mzg(){return this.YFe}set Mzg(r){(this.YFe=r)&&this.tbk()}tbk(){this.MLe(xa.UEj,this.VEj);this.MLe(xa.nYj,this.oYj)}MLe(r,M){M&&(this.NIg[r]=M)}}Object(da.a)(db,"FirstRunExperienceUISettings",null,[222]);
class bb{constructor(){this.completed=this.oSj=!1}}Object(da.a)(bb,"FirstRunExperienceViewData",null,[218]);var kb=a(186),Rb=a(129),zb=a(24);class nc{constructor(r,M,la){this.mai=(Qa,Kb,hc,Ac,Zc)=>{2===hc&&this.N6b.e6i(Zc);return 32};this.ARh=(Qa,Kb,hc,Ac,Zc)=>{2===hc&&this.N6b.Y5i(Zc);return 32};this.TKi=(Qa,Kb,hc)=>2===hc?this.N6b.fSd():32;this.SKi=(Qa,Kb,hc)=>2===hc?this.N6b.cSd():32;this.Ma=r;this.ej=M;this.N6b=la}ik(){this.Ma.ji(zb.a.oai,Rb.a.frame,this.mai,64);this.Ma.hf(zb.a.ajf,Rb.a.frame,
this.TKi);this.Ma.hf(zb.a.$if,Rb.a.frame,this.SKi);this.Ma.hf(zb.a.zRh,Rb.a.frame,this.ARh);this.Ma.hf(zb.a.kmg,Rb.a.frame,kb.ActionManager.tj);this.Ma.hf(zb.a.RYj,Rb.a.frame,kb.ActionManager.tj);this.Ma.hf(zb.a.SYj,Rb.a.frame,kb.ActionManager.tj);this.ej&&this.ej.px()}}Object(da.a)(nc,"InProductMessagingActor",null,[]);var Zb=a(137);class Sa{constructor(){this.Gig=this.Vng=this.DEg=this.Szc=this.instance=null}}Object(da.a)(Sa,"DimeExperienceUISettings",null,[]);var Na=a(152),Ea=a(491);class Aa{constructor(r,
M,la,Qa,Kb){this.Moc=!1;this.SEb=null;this.Ma=r;this.qOa=M;this.I9b=la;this.Z8=Qa;this.pWc=Kb}eOi(r){Na.b("getHeaderApi")?(r.M2i()&&appChrome.getHeaderApi().then(M=>{M.updateAnonymousStatus(!0);return null}),r.isFeatureEnabled("MsoPremiumBadge",!0).then(M=>{const la=r.isFreemiumUpsellEnabled();la&&(appChrome.getHeaderApi().then(Qa=>{Qa.updatePremiumStatus(M,la);return null}),r.i_a("MsoPremiumBadge",Qa=>{appChrome.getHeaderApi().then(Kb=>{Kb.updatePremiumStatus(Qa.isEnabled,la);return null})}));return null})):
aa.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}e6i(r){this.I9b.O7i().continueWith(()=>{this.qOa.Fmk(r)})}Y5i(r){let M="gopremium",la=null,Qa=()=>{};r?(r.experience&&""!==Object(Zb.a)(String,r.experience)&&(M=Object(Zb.a)(String,r.experience)),r.onTaskComplete&&(Qa=r.onTaskComplete),r.campaignId&&""!==Object(Zb.a)(String,r.campaignId)&&(la=Object(Zb.a)(String,r.campaignId))):aa.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.hOf(M,Qa,la)}hOf(r,
M,la){la=void 0===la?null:la;if(this.Moc&&this.SEb){const Qa={};Qa.experience=r||"gopremium";Qa.campaignId=la||Ea.b(this.Z8,this.pWc,Object(Zb.a)(String,Qa.experience),!0);this.Ma.mi(zb.a.kmg,2);aa.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Qa.experience);try{const Kb=Object.assign(new Sa,{instance:this.SEb,Szc:Qa,DEg:M||(()=>{}),Vng:hc=>{aa.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+hc.status)},Gig:()=>{aa.ULS.sendTraceTag(51675406,324,10,"Dime launch error");
this.Moc=!1;this.SEb=null}});this.qOa.Dkk(Kb)}catch(Kb){aa.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Kb.message),this.Moc=!1,this.SEb=null,this.Ma.rh(zb.a.Noc,2,{["experience"]:Qa.experience})}}else aa.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ma.rh(zb.a.Noc,2,{["experience"]:r})}rOd(){this.I9b.Q7i().continueWith(()=>{try{var r=Za.a.Po(za.AFrameworkApplication.uiCulture);const Qa=Ea.c(this.Z8);if(Qa){var M={};M.partnerId=Qa;M.language=r;M.sessionId=
za.AFrameworkApplication.userSessionId;M.authHint=za.AFrameworkApplication.fa.Ta("UserPrincipalName");var la=za.AFrameworkApplication.fa.Ta("Puid")||"";""!==la&&(r={},r.puid=la,M.userInfo=r);this.SEb=new Dime(M);this.Moc=!0;aa.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else aa.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Qa){aa.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Qa.message)}},3)}fSd(){return this.qOa.fSd()}cSd(){return this.qOa.cSd()}}
Object(da.a)(Aa,"InProductMessagingUIManager",null,[216]);var Ka=a(128);class nb{constructor(){this.AHe=0;this.T5a=Array(5);this.T5a[0]=10;this.T5a[1]=15;this.T5a[2]=50;this.T5a[3]=100;this.T5a[4]=200}Init(r){this.AHe=r}SendTrace(r,M){aa.ULS.sendTraceTag(34182235,this.AHe,this.T5a[r],"{0}",M)}}Object(da.a)(nb,"DefaultNetworkingManager",null,[231]);var Qb=a(537),jb=a(338),qb=a(119);class ab{constructor(r){this.jg=r}Fmk(r){r&&(InProductMessaging.Networking.NetworkingMgr=new nb,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(r.Mzg,r.nVf,r.qSe,r.xgj,r.locale,Object(Ka.a)(this,this.Aoj,"onDismissFirstRunExperience"),r.NIg),this.O0a(xa.OBj,!0))}Dkk(r){if(r&&r.instance&&r.Szc){let M=document.getElementById("wacDimeContainer");M||(M=document.createElement("div"),M.id="wacDimeContainer",document.body.appendChild(M));za.AFrameworkApplication.fa.la("DimeFocusManagerIsEnabled")&&this.O0a("wacDimeContainer",!1);r.Szc.parentElementId="wacDimeContainer";r.instance.launch(r.Szc,r.DEg).then(la=>{this.aWb();
document.body.removeChild(M);r.Vng(la)}).catch(la=>{this.aWb();document.body.removeChild(M);r.Gig(la)})}else throw Error.argument("DimeExperienceUISettings");}O0a(r,M){if(this.jg&&r&&(r=document.getElementById(r),this.WNi(r),r=this.jg.oW("InProductMessagingFocusId"))){const la=this.jg.Nl;la&&"InProductMessagingFocusId"===la.name||this.jg.y7("InProductMessagingFocusId",!1);M&&this.Igg(r.scope)}}WNi(r){var M=!1;M=void 0===M?!0:M;const la=this.jg.yn("InProductMessagingFocusId");la.parent=Qb.AFrame.AZ;
const Qa=new jb.DOMFocusListing(()=>r);Qa.UVb=M;Qa.nt(3);Qa.nt(2);Qa.nt(4);M=this.jg.XPa(()=>r,la,Qa);M.yIc();M.Dca=!0;M.N$a=!0}Igg(r){r.ox(qb.FocusManager.instance().W9);r.ox(qb.FocusManager.instance().X9);r.bindAction(qb.FocusManager.instance().W9,zb.a.ajf);r.bindAction(qb.FocusManager.instance().X9,zb.a.$if)}aWb(){this.jg&&(this.jg.Fka("InProductMessagingFocusId"),this.jg.w_a("InProductMessagingFocusId"))}Aoj(r,M){this.aWb();r=Object.assign(new bb,{completed:r,oSj:M});za.AFrameworkApplication.Oe.rh(zb.a.lai,
2,r)}fSd(){const r=document.activeElement,M=this.jg.hW();return r&&M&&M.Wk&&r===M.Wk.pB?(M.Wk.ZB(r),M.hRb()?32:8):4}cSd(){const r=document.activeElement,M=this.jg.hW();return r&&M&&M.Wk&&r===M.Wk.firstElement?(M.Wk.ZB(r),M.Vib()?32:8):4}}Object(da.a)(ab,"InProductMessagingUIWrapper",null,[217]);var xb=a(147),Tb=a(262),Cc=a(35);class lb{constructor(){this.$b=null}get name(){return"Common.App.InProductMessaging"}dl(r){r.register(La,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").If().Rf(()=>
new La);r.register(ab,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").If().Rf(()=>new ab(qb.FocusManager.instance()));r.register(Aa,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").If().Rf(()=>new Aa(za.AFrameworkApplication.Oe,r.resolve("Common.IInProductMessagingUIWrapper"),r.resolve("Common.App.InProductMessaging.IDependencyDownloader"),za.AFrameworkApplication.ra.Pa.Cj,za.AFrameworkApplication.ra.Pa.OGa));
r.register(nc,"Common.App.InProductMessaging.InProductMessagingActor").If().Rf(()=>new nc(za.AFrameworkApplication.Oe,za.AFrameworkApplication.ra,r.resolve("Common.IInProductMessagingUIManager")));r.register(db,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").If().Rf(()=>new db);r.register(bb,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").If().Rf(()=>new bb);this.$b=r}init(){this.$b.resolve("Common.App.InProductMessaging.InProductMessagingActor").ik();
za.AFrameworkApplication.fa.Xw(()=>{za.AFrameworkApplication.ra.Pa.wu&&xb.a.get_instance().Mk(15,()=>{this.$b.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{this.$b.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").eOi(r)})});za.AFrameworkApplication.fa.la("FreemiumUpsellShowDialogIsEnabled")&&Ea.a()&&!Cc.a.gja&&1!==za.AFrameworkApplication.ra.Pa.Cj&&this.$b.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("MsoPremiumBadge",
!0).then(M=>{!M&&r.isFreemiumUpsellEnabled()&&this.$b.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").rOd();return null})})})}dispose(){}static main(){Tb.a.instance.Ul(new lb)}}Object(da.a)(lb,"InProductMessagingPackage",null,[4,5]);var Ya=a(200),Hb=a(44);class Lb{constructor(r,M,la,Qa,Kb){this.YTa=hc=>{let Ac=!1,Zc=null;try{if(0<hc.data.responseData.length){const Ad=Object(Zb.a)(Object,Hb.a(hc.data.responseData)),re=Ad?Ad[this.MA.Ycd]:null;re&&(Zc=Object(Zb.a)(Object,Hb.a(re.toString())))}Ac=
!0}catch(Ad){this.wra(null)}Ac&&this.gub&&this.gub(hc.data,Zc)};this.wra=hc=>{this.cub&&this.cub(hc?hc.data:null)};this.DGj=hc=>{this.JCe&&this.JCe(hc?hc.data:null)};this.Bua=hc=>{this.rwb&&this.rwb(hc?hc.data:null)};this.MA=r;this.gub=M;this.cub=la;this.JCe=void 0===Qa?null:Qa;this.rwb=void 0===Kb?null:Kb}ssd(r){const M=new Sys.StringBuilder(this.MA.xXb);M.append("RoamingServiceHandler.ashx?action=");M.append("getFirstRunExperienceSettings");M.append("&");M.append(this.Rzd(r));M.append("&");M.append(za.AFrameworkApplication.ml);
za.AFrameworkApplication.lg.ir(M.toString(),1,null,null,!0,2,this.YTa,this.wra,null)}enc(r){var M=new Sys.StringBuilder(this.MA.xXb);M.append("RoamingServiceHandler.ashx?action=");M.append("saveFirstRunExperienceSettings");M.append("&");M.append(za.AFrameworkApplication.ml);M=M.toString();r=Hb.c(r);za.AFrameworkApplication.lg.ir(M,2,r,null,!0,4,this.DGj,this.Bua,null)}Rzd(r){const M=new Sys.StringBuilder("requestedsettings=");for(let la=0;la<r.count;la++)M.append(r.ka(la)),la<r.count-1&&M.append(";");
return M.toString()}}Object(da.a)(Lb,"FirstRunExperienceRequestHandler",null,[]);var qc=a(236),mc=a(81);class Ta{constructor(){this.Vtb=this.g6b=this.MA=null;this.YTa=(r,M)=>{r=r?+r.G4-+r.sK:-1;r>this.MA.cpg?aa.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",r,this.MA.cpg):M?this.jjk(M)?(aa.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.MA.eVf),this.xce()):(this.Cod(!1),aa.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(aa.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.xce())};this.wra=r=>{this.Cod(!1);aa.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",r?r.httpStatus:-1)};this.Bua=r=>{aa.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
r?r.httpStatus:-1)};this.Fpj=r=>{if(r){var M=r.detail;r=r.type;var la=this.MA&&this.MA.campaignId?this.MA.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===r||la&&M&&M.id&&-1!==M.id.indexOf(la)){if("FRELaunchedEvent"===r||M&&M.success)aa.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.wqg(this.MA.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Vtb,!0),window.removeEventListener("FRELaunchedEvent",
this.Vtb,!0))}}}}wce(r){r?(this.MA=r,this.RYi()&&(aa.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),r=new Ya.a,r.add(this.MA.Ycd),this.g6b=new Lb(this.MA,this.YTa,this.wra,null,this.Bua),this.g6b.ssd(r)),(this.MA.Xgb||za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.xce()):aa.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}RYi(){try{if(this.MA.Xgb)return!0;
if(!za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||za.AFrameworkApplication.fa.la("IsAnonymousUser"))return!1;if(this.MA.RUi||this.MA.ahb||za.AFrameworkApplication.fa.la("IsO365ConsumerHost"))return!0;const r=za.AFrameworkApplication.fa.Ta("FlightId");return-1!==(r?r.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(r){aa.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",r?r.toString():null)}return!1}wqg(r){const M=
{},la={};la.FREDisplayedDate=(new Date).toUTCString();la.VersionDisplayed=r;la.RemindMeLater=!1;M[this.MA.Ycd]=Hb.c(la);aa.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.g6b&&this.g6b.enc(M)}xce(){this.Cod(!0);var r=mc.a.instance.pj("Common.ISystemInitiatedFeedback");r?this.wzg(r):(aa.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((r=mc.a.instance.We("Common.ISystemInitiatedFeedback"))?r.execute(M=>{this.wzg(M)}):aa.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}wzg(r){if(r){var M=this.MA.zai;M&&za.AFrameworkApplication.Lja(M);aa.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",M);r.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Vtb=this.Fpj,window.addEventListener("FGWebSurfaceEvent",this.Vtb,!0),window.addEventListener("FRELaunchedEvent",
this.Vtb,!0)):(aa.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.wqg(this.MA.currentVersion))}else aa.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}jjk(r){if("RemindMeLater"in r&&"FREDisplayedDate"in r){if("true"===r.RemindMeLater.toString()&&(+new Date-+new Date(r.FREDisplayedDate.toString()))/36E5>this.MA.eVf)return!0}else if(za.AFrameworkApplication.fa.la("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in r&&r.VersionDisplayed<
this.MA.currentVersion)return aa.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Cod(r){za.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&qc.a.dispatch("FREDecisionEvent",{["show"]:r})}}Object(da.a)(Ta,"FirstRunExperienceLauncher",null,[407]);class Va{constructor(){this.$b=null}get name(){return"Common.App.FirstRunExperienceLauncher"}dl(r){this.$b=r;this.$b.register(407,
"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").If().Rf(()=>new Ta)}init(){}dispose(){}static main(){Tb.a.instance.Ul(new Va)}}Object(da.a)(Va,"FirstRunExperienceLauncherPackage",null,[4,5]);var Db=a(8),Ca=a(11),cb=a(299),hb=a(203),ya=a(1);class Pa{constructor(r){this.$=r}get Ycd(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get RUi(){return this.isEnabled()&&ya.EwaSettings.Ia(295)}get ahb(){return this.isEnabled()&&
ya.EwaSettings.Ia(297)}get Xgb(){return ya.EwaSettings.Ia(296)}get zai(){return null}get eVf(){return 24}get cpg(){return 4E3}get xXb(){return this.$.xa.WebServiceBase||""}isEnabled(){if(za.AFrameworkApplication.fa?za.AFrameworkApplication.fa.la("IsAnonymousUser"):1)return!1;const r=za.AFrameworkApplication.pf?Object(Zb.a)(String,za.AFrameworkApplication.pf.AudienceGroup):"";return"Unknown"!==r&&"Automation"!==r}}Object(da.a)(Pa,"FirstRunExperienceLauncherSettings",null,[315]);var wb=a(146);let Ib=
class{constructor(r){this.bjf=mc.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher");this.nai=new Pa(r);this.wce()}wce(){this.bjf&&this.bjf.wce(this.nai)}};Ib=Object(hb.__decorate)([Object(wb.d)(Db.xb),Object(hb.__param)(0,Object(Db.nb)())],Ib);Object(da.a)(Ib,"FirstRunExperienceManager",null,[293]);var pb=a(796);class xc extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){const r=Object(pb.a)(this.$.ja,311,()=>new Ib(this.$));this.Df(r)}static ta(r){r.ja.$c(312,
new xc(r))}}Object(da.a)(xc,"FirstRunExperienceManagerFactory",cb.a,[]);var ua=a(60);Object(wb.b)(Db.jc,{nn:"singleton"})(()=>Lo(function*(){const r=mc.a.instance.pj("Common.IInProductMessagingUIManager"),M=()=>{mc.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(la=>{void la.isFeatureEnabled("MsoPremiumBadge",!0).then(Qa=>{!Qa&&la.isFreemiumUpsellEnabled()&&r.rOd();return null})})};ua.a.fj.wu?xb.a.get_instance().Mk(16,()=>{M()}):M();return r}));class U extends cb.a{constructor(r){super();
this.YEd=null;this.$=r;this.Dg()}create(){const r=Object(pb.a)(this.$.ja,361,()=>this.iIh());this.Df(r)}iIh(){this.YEd=mc.a.instance.pj("Common.IInProductMessagingUIManager");ua.a.fj.wu?xb.a.get_instance().Mk(16,()=>{this.MCf()}):this.MCf();return this.YEd}MCf(){mc.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("MsoPremiumBadge",!0).then(M=>{!M&&r.isFreemiumUpsellEnabled()&&this.YEd.rOd();return null})})}static ta(r){r.ja.$c(362,new U(r))}}
Object(da.a)(U,"InProductMessagingManagerFactory",cb.a,[]);var na=a(54),ob=a(334),bc=a(82),oc=a(557),Yb=a(19),Fc=a(611);class ld extends oc.a{constructor(r){super(1);this.Zma=!1;this.TZf=()=>{this.refresh()};this.UZf=()=>{this.refresh()};this.gridView=Yb.h(r);this.gridView.kf.jr(this.UZf);this.gridView.kf.Wr(this.TZf);this.refresh()}get rN(){return this.KBc(this.Zma)}kae(r){this.Zma!==r&&(this.Zma=r,this.eVb())}get name(){return Fc.a.cellEdit}dispose(){this.gridView.kf.$q(this.UZf);this.gridView.kf.Zq(this.TZf);
this.gridView=null;super.dispose()}eVb(){this.V0d(this.Zma)}refresh(){this.kae(!this.gridView.De)}}Object(da.a)(ld,"CellEditSafeStatePublisher",oc.a,[]);var qd=a(40),fe=a(138);class ge{constructor(r,M){this.handler=null;this.t0d=r;this.rN=M}}Object(da.a)(ge,"SafeStatePublisherState",null,[]);var Wd=a(649);const Zd=r=>r?`${r.Current} / ${r.Pending} @${r.SuspensionStartTimestamp}`:null,ke=r=>(null===r||void 0===r?void 0:r.SuspensionStartTimestamp)&&r.Pending>r.Current;class ne extends qd.a{constructor(r,
M){super();this.PNf=null;this.vzc=!1;this.MSb=(la,Qa)=>{3===Qa.QUf&&this.vzc&&aa.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.vzc=!0;this.hVb()};this.e0a=new Ya.a;this.Rib=r;this.wua=M;if(this.tMb=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1))this.wua.Y7a(this.eHa.bind(this)),this.Rib.OMe(this.MSb)}get WBk(){return fe.f(fe.c(this.e0a.toArray(),r=>0!=r.rN),r=>r.t0d.name)}Ecc(r){this.addHandler(ne.d0a,
r)}wJc(r){this.removeHandler(ne.d0a,r)}mIa(r,M){const la=new ge(r,M);this.e0a.add(la);M=(Qa,Kb)=>{la.rN=Kb.rN;this.hVb()};r.Ecc(M);la.handler=M;this.hVb()}zie(r){let M=null;for(const la of this.e0a)if(la.t0d===r){this.TJg(la);M=la;break}M&&(this.e0a.remove(M),this.hVb())}dispose(){for(const r of this.e0a)this.TJg(r);this.e0a.clear();this.tMb&&(this.wua.Amb(this.eHa.bind(this)),this.Rib.Rkg(this.MSb));super.dispose()}npc(){const r=Pd.npc(this.e0a.toArray().map(M=>M.rN));return this.vzc&&1===r?2:r}TJg(r){r.t0d.wJc(r.handler)}hVb(){const r=
this.npc();r!==this.PNf&&(this.raiseEvent(ne.d0a,new Wd.a(r)),this.PNf=r)}eHa(r,M){r=M.Yja;(M=!ke(r))||(M=this.r5i,M=(null===r||void 0===r?void 0:r.SuspensionStartTimestamp)!==(null===M||void 0===M?void 0:M.SuspensionStartTimestamp));M&&(this.vzc=!1);this.r5i=r;this.hVb()}}ne.d0a="SSC";Object(da.a)(ne,"ClientStateMonitor",qd.a,[]);var se=a(7),Cb=a(76);class ib extends oc.a{constructor(r,M){M=void 0===M?null:M;super(1);this.Zma=!1;this.xT=()=>{this.refresh()};this.$_f=()=>{this.refresh()};this.$=r;
this.mve=M||Cb.a(r).eW(se.a.idle);Cb.a(r).kbd(this.$_f);this.Qeb.$t(this.xT);this.refresh()}get rN(){return this.KBc(this.Zma)}kae(r){r!==this.Zma&&(this.Zma=r,this.eVb())}get name(){return Fc.a.Qeb}get Qeb(){return this.mve}dispose(){Cb.a(this.$).ZIc(this.$_f);this.Qeb.Eu(this.xT);this.mve=null;super.dispose()}eVb(){this.V0d(this.Zma)}refresh(){this.kae(1===this.Qeb.$y||Cb.a(this.$).ul===this.Qeb)}}Object(da.a)(ib,"IdleActivitySafeStatePublisher",oc.a,[]);var ac=a(339),Lc=a(4),ad=a(22);class te extends bc.a{constructor(){super()}Uf(){return!1}executeCommand(){return Fa.Task.Ra(!0)}Kf(r,
M){return 1905775613===M.command}Yf(){return!1}}Object(da.a)(te,"ToggleMergeSuspensionSafeState",bc.a,[165]);class Ma extends qd.a{constructor(r,M){super();this.statusBarManager=null;this.iTd=!1;this.eHa=(la,Qa)=>{la=`${Qa.Yja.Current===Qa.Yja.Pending?"\u26ad":"\u26ae"}${Qa.Yja.Current}`;ad.a.equals(this.uCc,la,!1)||(this.uCc=la,this.gA())};this.IYa=(la,Qa)=>{la=0==Qa.rN;this.iTd!==la&&(this.iTd=la,this.gA())};this.mergeSuspensionManager=M;this.mergeSuspensionManager.wua.Y7a(this.eHa);this.uCc="";
ac.a.j$(1905775613,Lc.a.Of,0,1);this.Ha=r.Ha;this.N0b=new te;r.ja.Ne(29,la=>{this.mergeSuspensionManager&&(this.statusBarManager=la,la.YL(this),this.mergeSuspensionManager.qpa.Ecc(this.IYa))});this.Ha.lZ(this.N0b)}$t(r){this.addHandler(Ma.FRd,r)}Eu(r){this.removeHandler(Ma.FRd,r)}gA(){this.raiseEvent(Ma.FRd)}wq(r){return r===Ma.kKj&&!!this.mergeSuspensionManager}Ov(r,M){if(!this.wq(r))return!1;this.mergeSuspensionManager&&(M.LabelText=this.uCc,M.On=this.iTd);return!0}dispose(){this.N0b&&(this.Ha.smb(this.N0b),
this.N0b.dispose(),this.N0b=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.wua.Amb(this.eHa),this.mergeSuspensionManager.qpa.wJc(this.IYa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null);this.uCc=null;super.dispose()}}Ma.FRd="MSMSC";Ma.kKj="QueryMergeSuspensionStatus";Object(da.a)(Ma,"MergeSuspensionIndicatorManager",qd.a,[256,169,2]);var V=a(2),fa=a(972);class ub extends Sys.EventArgs{constructor(r){super();this.rFa=
r}}Object(da.a)(ub,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class rb{}Object(da.a)(rb,"SuspensionState",null,[]);class hd extends rb{constructor(r){super();this.BOe=!1;this.BOe=r}}Object(da.a)(hd,"ReadyForPendingMergeState",rb,[]);const Eb=new rb,kc=new rb,zc=new hd(!1),Nc=new hd(!0);var Fd=a(973);class Xd extends Fd.a{constructor(r,M,la){super(r);this.jih=M;this.unk=la}}Object(da.a)(Xd,"ReadyForPendingMergesUpdatedEventArgs",Fd.a,[]);class ie extends qd.a{constructor(r,M,la){super();
this.eHa=(Qa,Kb)=>{Qa=this.getState();const hc=this.W6;this.W6=Kb.Yja;Kb=this.getState();this.Q$i(Qa,Kb,hc);this.raiseEvent(ie.BRd);this.Oif(Qa,Kb)};this.IYa=(Qa,Kb)=>{Qa=this.getState();this.rN=Kb.rN;Kb=this.getState();this.Oif(Qa,Kb)};this.MSb=(Qa,Kb)=>{4===Kb.QUf&&(aa.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",Zd(this.W6),Zd(Kb.W6)),this.hfg(this.getState(),!0))};this.tMb=
ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.qpa=r;this.qpa.Ecc(this.IYa);this.wua=M;this.wua.Y7a(this.eHa);this.Rib=la;this.Rib.OMe(this.MSb);this.W6=Object(V.a)(new fa.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.rN=this.hMi()}hMi(){return Object(ob.a)(ne,this.qpa)?Object(Zb.a)(ne,this.qpa).npc():1}Hcc(r){this.addHandler(ie.Nge,r)}zJc(r){this.removeHandler(ie.Nge,r)}zfh(r){this.addHandler(ie.D1d,r)}tWj(r){this.removeHandler(ie.D1d,
r)}Meh(r){this.addHandler(ie.BRd,r)}PVj(r){this.removeHandler(ie.BRd,r)}lMj(){this.S0d(this.getState()===kc)}dispose(){this.qpa.wJc(this.IYa);this.qpa=null;this.wua.Amb(this.eHa);this.wua=null;this.Rib.Rkg(this.MSb);this.Rib=null;super.dispose()}bzd(){return Object(V.a)(new fa.a,{Current:this.W6.Current,Pending:this.W6.Pending,SuspensionStartTimestamp:this.W6.SuspensionStartTimestamp})}getState(){return ke(this.W6)?0==this.rN?Nc:this.tMb&&1==this.rN?zc:kc:Eb}Oif(r,M){r!==M&&(M===kc?this.S0d(!0):r===
kc&&this.S0d(!1));this.hfg(M)}hfg(r,M){r instanceof hd&&this.raiseEvent(ie.D1d,new Xd(this.W6,r.BOe||!this.tMb,void 0===M?!1:M))}Q$i(r,M,la){r===Eb&&M!==Eb?(r=M===kc,M=M===zc,aa.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${M} publisher: ${M||r?this.qpa.WBk.join(","):""} counter: ${Zd(this.W6)} isBlockingAllMerges: ${r}`)):r!==Eb&&M===Eb&&aa.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${Zd(la)}`)}S0d(r){this.raiseEvent(ie.Nge,
new ub(r))}}ie.Nge="TPMBBC";ie.D1d="RFPMU";ie.BRd="MCC";Object(da.a)(ie,"MergeSuspensionStateHandler",qd.a,[]);class Ee extends qd.a{constructor(r){super();this.C9=null;this.uzc=0;this.VQb=(M,la)=>{(null===la||void 0===la?0:la.Yja)&&this.yYa(la.Yja,Ee.Hle)};this.eMc=()=>{this.Gng();this.Weg(this.C9,Ee.r_j)};this.lVd=(M,la)=>{la.committed&&this.C9.SuspensionStartTimestamp&&aa.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${Zd(this.C9)}`)};this.Gng();this.$=
r;this.$.ea.wn(this.eMc);this.$.ea.cM(this.eMc);Yb.h(this.$).kf.Wr(this.lVd);this.$.ja.Ne(292,M=>{M.Y7a(this.VQb);aa.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}Y7a(r){this.addHandler("MCU",r)}Amb(r){this.removeHandler("MCU",r)}get W6(){return this.C9}yYa(r,M){M=void 0===M?"":M;const la=this.C9.Current<r.Current||this.C9.Pending<r.Pending;if(r.SuspensionStartTimestamp&&this.uzc!==r.SuspensionStartTimestamp){if(this.uzc>r.SuspensionStartTimestamp){la&&aa.ULS.sendTraceTag(553736149,
0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${M}. S: ${Ee.UQb(r)}, C: ${Ee.UQb(this.C9)}`);return}la||aa.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Ee.UQb(r)}, C: ${Ee.UQb(this.C9)}`)}else if(!la)return;this.C9=r;this.Weg(r,M)}dispose(){this.$.ea.En(this.eMc);this.$.ea.yQ(this.eMc);Yb.h(this.$).kf.Zq(this.lVd);const r=this.$.ja.Qa(292);r&&r.Amb(this.VQb);
super.dispose()}Weg(r,M){M=void 0===M?"":M;ke(r)&&r.SuspensionStartTimestamp>this.uzc&&(aa.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${Zd(r)}, Origin: ${M}`),this.uzc=r.SuspensionStartTimestamp);this.raiseEvent("MCU",new Fd.a(r))}Gng(){aa.ULS.sendTraceTag(588276808,0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Ee.UQb(this.C9)}`);this.C9=Object(V.a)(new fa.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static UQb(r){return r?
`(${r.Current}/${r.Pending} @${r.SuspensionStartTimestamp})`:"null"}}Ee.Hle="PMM.RTC";Ee.Alc="PMM.EwaResult";Ee.r_j="PMM.resetMergeCounter";Object(da.a)(Ee,"PendingMergeMonitor",qd.a,[]);class He{}Object(da.a)(He,"ClientRevisions",null,[]);var gd=a(50),Bd=a(59);const ue=(r,M,la,Qa,Kb,hc,Ac)=>{Ac=r.Oa(1,void 0===Ac?null:Ac);Ac.suspensionStartTimestamp=M;return Bd.h(r,"KeepBlockingPendingMerges",Ac,la,Qa,Kb,hc,0)};class ye extends qd.a{constructor(r,M,la,Qa){super();this.PRa=null;this.NOb=0;this.OOb=
this.rhb=null;this.S5f=(Kb,hc)=>{this.PRa.Zlh(hc.Yja,hc.jih,hc.unk)};this.oTb=(Kb,hc)=>{hc.rFa?this.Kpk():this.zPc()};this.$3f=()=>{this.NOb=0};this.tsg=()=>{const Kb=this.Jca.bzd();ue(this.ua,null!=Kb.SuspensionStartTimestamp?Kb.SuspensionStartTimestamp:0,null,()=>{this.ztj(Kb)},null,null,this.ua.qf())};this.SKa=(Kb,hc)=>{if(hc){hc.Hzb.MergeCount=this.Jca.bzd();const {min:Ac,max:Zc}=Yb.h(this.$).efj();ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?hc.Hzb.ClientRevisions=
Object(V.a)(new He,{Min:Ac,Max:Zc,MaxFromBlockCache:Yb.h(this.$).ya.nUf}):hc.Hzb.ClientRevisions=Object(V.a)(new He,{Min:Ac,Max:Zc})}};this.$=r;this.Q8a=la;this.Jca=M;this.Jca.zfh(this.S5f);this.Jca.Hcc(this.oTb);this.Jca.Meh(this.$3f);this.$.oa.t$(this.SKa);this.ua=this.$.oa.ua;this.R5d=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;this.K4i=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.PRa=Qa;aa.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.oa.Bda(this.SKa);
this.zPc();this.Jca.tWj(this.S5f);this.Jca.zJc(this.oTb);this.Jca.PVj(this.$3f);this.Jca=null;super.dispose()}Kpk(){this.zPc();if(this.l7e()){const r=this.Jca.bzd();aa.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${Zd(r)} fail count: ${this.NOb}`)}else this.OOb=this.Q8a.create(this.tsg,this.R5d,gd.a.OOb),this.rhb=this.Q8a.MH(this.tsg,this.K4i,gd.a.rhb)}zPc(){this.rhb&&
(this.OOb.cancel(),this.rhb.cancel(),this.rhb=this.OOb=null)}ztj(r){let M;M=" fail count: "+this.NOb;this.NOb++;this.l7e()&&this.zPc();aa.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${Zd(r)}${M}`)}l7e(){return this.NOb>ye.Ndj}}ye.Ndj=5;Object(da.a)(ye,"RequestController",qd.a,[]);var Ue=a(184),Sb=a(214),cd=a(29),Xc=a(252);class fd extends Sys.EventArgs{constructor(r,M){super();this.QUf=r;this.W6=M}}Object(da.a)(fd,"MergeDidntOccurEventArgs",
Sys.EventArgs,[]);class mb extends qd.a{get kVa(){return 0<this.sXd}constructor(r,M,la,Qa,Kb){la=void 0===la?null:la;Qa=void 0===Qa?null:Qa;Kb=void 0===Kb?null:Kb;super();this.tzc=null;this.sXd=0;this.documentVisibilityObserver=null;this.cNf=!1;this.IBc=null;this.ua=r;this.R5d=M.xa.MergeSuspensionRequestThrottlingTimeInMs;const hc=M.xa.GetRangeContentPrefetchDelayForMergeInMs;this.PB=()=>{M.drg(hc)};this.ol=la||cd.a.Ae;this.eNg=0;this.VQ=Qa;this.UIa=Kb;ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void wb.a.resolve(Db.db).then(Ac=>{this.documentVisibilityObserver=Ac}):M.ja.Ne(291,Ac=>{this.documentVisibilityObserver=Ac})}OMe(r){this.addHandler(mb.CRd,r)}Rkg(r){this.removeHandler(mb.CRd,r)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.tk}Zlh(r,M,la){this.RZb(r,M,void 0===la?!1:la)?(new Ue.a).setResult(!0):(M=this.NDj(r,M),this.tzc=r,this.sXd++,M.continueWith(()=>{this.Eoj()},0,Sb.a.none,this.VQ))}NDj(r,M){this.eNg=this.ol.rma;this.cNf=M;
aa.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${r.Current} / ${r.Pending} @${r.SuspensionStartTimestamp}. allowSelectionAdjustment: ${M}`);this.isDocumentHidden||this.PB();return this.p6j(M,r)}RZb(r,M,la){la=void 0===la?!1:la;if(this.UIa&&!M&&!this.UIa.R1i())return aa.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.tzc||r.SuspensionStartTimestamp>
this.tzc.SuspensionStartTimestamp)return this.kVa&&aa.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${r.Current} / ${r.Pending} @${r.SuspensionStartTimestamp}`),!1;if(this.kVa)return!0;if(la)return!1;la=this.tzc;const Qa=this.ol.rma-this.eNg<this.R5d;M=this.cNf===M;return(r||la?r&&la?r.Current===la.Current&&r.Pending===la.Pending&&r.SuspensionStartTimestamp===la.SuspensionStartTimestamp:!1:!0)&&Qa&&
M}p6j(r,M){const la=this.ua.qf(),Qa=()=>{aa.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${M.Current} / ${M.Pending} @${M.SuspensionStartTimestamp}`)};return this.UIa?this.UIa.H2j(this.Uli(r,Qa,la)):this.rVe(null,!0,void 0,Qa,la)}Uli(r,M,la){return(Qa,Kb,hc)=>{let Ac=void 0;aa.ULS.shipAssertTag(523317955,0,null!=Qa||r,"!allowSelectionAdjustment requires a non-null initialViewportState.");Ac=this.Foj.bind(this);Kb&&(Ac=Xc.b.call(null,Zc=>{const Ad=
Zc.Result;let re=null===Ad||void 0===Ad?void 0:Ad.AdjustedViewportState;3===(null===Ad||void 0===Ad?void 0:Ad.MergeResultState)&&(re=void 0);Kb(re,Zc.StateId)},Ac));hc&&(M=Xc.a.call(null,hc,M));return this.rVe(Qa,r,Ac,M,la)}}rVe(r,M,la,Qa,Kb){var hc=this.ua;Kb=hc.Oa(1,void 0===Kb?null:Kb);Kb.viewportState=r;Kb.allowViewAdjustment=M;return Bd.h(hc,"DoPendingMerge",Kb,la,Qa,null,null,0)}Foj(r){var M=r.Result;void 0!=M&&(M=M.MergeResultState,2!==M&&(this.IBc=[M,r.MergeCount]))}ILj(r,M){this.raiseEvent(mb.CRd,
new fd(r,M))}Eoj(){this.sXd--;if(this.IBc){const r=this.IBc;this.IBc=null;this.ILj(...r)}}}mb.CRd="MDO";Object(da.a)(mb,"DoPendingMergeSender",qd.a,[468,469]);class Oc{constructor(r){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.PKi=void 0===r?!1:r}get reportName(){return this.PKi?"SelectionAdjustInHiddenDocument":
"SelectionAdjust"}}Object(da.a)(Oc,"SelectionAdjustSessionEndsReport",null,[480]);var jd=a(45);class ud{constructor(r,M,la,Qa,Kb,hc){this.Ie=r;this.wL=M;this.Wfa=la;this.aOa=Qa;this.joe=Kb;this.uR=hc}get activeCell(){return this.wL}get selectedRanges(){return this.Wfa}get qu(){let r=!1;if(null===this.uR||void 0===this.uR)r=!0;else if(this.uR>=this.selectedRanges.length||!this.selectedRanges[this.uR].contains(this.activeCell))aa.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.uR}, selectedRangesLength: ${this.selectedRanges.length}`),
r=!0;r&&(this.uR=this.qth());return this.uR}get activeRange(){return 0>this.qu?this.activeCell:this.selectedRanges[this.qu]}get sheetName(){return this.aOa}get activeItemName(){return this.joe}get XRg(){return 1===this.selectedRanges.length}pOg(r){const M=this.selectedRanges.map(la=>this.lzk(la,this.joe));for(const la of M)if(la)for(const Qa of la)if(Qa.nm&&Qa.Ah.Revision<r)return!1;return!0}Dvk(){var r;return{SheetName:this.sheetName,ActiveCell:null===(r=this.activeCell)||void 0===r?void 0:r.toString(),
TopLeft:void 0,SelectedRanges:jd.r(this.selectedRanges,this.Ie)}}toString(){var r,M;return`active cell: ${null!==(M=null===(r=this.activeCell)||void 0===r?void 0:r.toString())&&void 0!==M?M:"null"} selection: ${fe.f(this.selectedRanges,la=>{var Qa;return null!==(Qa=null===la||void 0===la?void 0:la.toString())&&void 0!==Qa?Qa:"null"}).join(",")}`}equals(r){return r?this.activeCell.equals(r.activeCell)&&jd.V(this.selectedRanges,r.selectedRanges)&&this.sheetName===r.sheetName:!1}qth(){for(const r of this.selectedRanges.entries()){const [M,
la]=r;if(null===la||void 0===la?0:la.contains(this.activeCell))return M}return-1}lzk(r,M){var la;const Qa=Yb.h(this.Ie).ya.qDa(r,M);Qa||aa.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==(la=null===r||void 0===r?void 0:r.toString())&&void 0!==la?la:"null"} ; activeItemNameIsDefined: ${!!M}`);return Qa}}Object(da.a)(ud,"SelectionState",null,[]);var pd=a(205),id=a(825);class Ed{constructor(r){this.sPc=0;this.dM=this.pK=null;this.zoe=new Oc;
this.Aoe=new Oc(!0);this.iN=0;this.Ntk=!1;this.jfj=1E4;this.Xg=()=>{this.R3e()};this.zl=()=>{this.hed(!0,!1)};this.Djb=()=>{this.hed(!1,!1)};this.$=r;this.gridView=Yb.h(this.$);this.gridView.ya.Uu(this.zl);this.gridView.ya.ot(this.Djb);this.gridView.ya.$Le(this.Djb);this.gridView.ya.nga(this.Djb);this.$.Go(this.Xg);this.R3e()}H2j(r){let M=null,la=null;const Qa=()=>{this.Tkj()};this.hEf()?(this.kV.parallel++,aa.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.dM}`)):
(M=(Kb,hc)=>{this.Ukj(Kb,hc)},la=this.Abk());return null===r||void 0===r?void 0:r(la,M,Qa)}R1i(){return!this.hEf()&&this.dia().XRg}Abk(){var r;aa.ULS.shipAssertTag(525135961,0,0===this.iN,"SelectionAdjustManager.setPreRequestState: unexpected state");this.dM&&(this.kV.errors++,aa.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.dM.toString()}`));this.dM=null;this.pK=this.dia();let M=null;const la=null===(r=this.pK)||void 0===
r?void 0:r.Dvk();la&&(M={ActiveSheetName:this.pK.sheetName,SheetViewportStateChanges:[la]});this.iN=1;return M}Tkj(){aa.ULS.shipAssertTag(525135960,0,1===this.iN,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.kV.errors++;this.iN=2;this.$u()}Ukj(r,M){try{aa.ULS.shipAssertTag(525135959,0,1===this.iN,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.sPc=M,M=2,this.pK?r?(this.dM=this.vfk(r))?(M=7,this.pK.equals(this.dM)?this.pK.equals(this.dia())?(this.kV.adjustedDidntChange++,
M=4):(this.kV.adjustedDidntChangeWithDivergence++,M=5):this.pK.sheetName!=this.dM.sheetName?(this.kV.differentSheetAdjust++,M=10):this.pK.equals(this.dia())||(this.kV.divergenceOnResponse++,M=6,this.fmg())):this.kV.errors++:(this.kV.errors++,aa.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.pK.toString()}`)):(this.kV.errors++,aa.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===
r||void 0===r?void 0:r.ActiveCell}`)),this.iN=M}catch(la){this.iN=12,aa.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${la}`)}finally{7!=this.iN?this.$u():this.hed(!1,!0)}}dispose(){this.gridView.ya.Ot(this.zl);this.gridView.ya.ys(this.Djb);this.gridView.ya.gkg(this.Djb);this.gridView.ya.A_a(this.Djb);this.$.Hp(this.Xg)}hEf(){return 1===this.iN||7===this.iN}vfk(r){let M;if(!(()=>{let hc=jd.gb(r.ActiveCell,this.$.sa);({range:M}=hc);return hc})().returnValue)return aa.ULS.sendTraceTag(537155411,
0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${r.ActiveCell}`),null;let la=[];const Qa=this.$.na,Kb=!!Qa&&2===Qa.PE;if(r.SelectedRanges)la=jd.g(r.SelectedRanges.Ranges);else if(!Kb)return aa.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Qa}`),null;return new ud(this.$,M,la,r.SheetName,this.pK.activeItemName,this.pK.qu)}dia(){const r=this.$.na;if((null===
r||void 0===r?0:r.activeCell)&&r.selectedRanges&&r.sheetName)return new ud(this.$,r.activeCell,r.selectedRanges,r.sheetName,this.$.activeItemName,r.qu);aa.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!r}, activeCell null: ${!(null===r||void 0===r?0:r.activeCell)}, selectedRanges null: ${!(null===r||void 0===r?0:r.selectedRanges)}, sheetName null: ${!(null===r||void 0===r?0:r.sheetName)}`);return null}R3e(){this.$.ja.Ne(276,()=>
{const r=pd.a(this.$);r.oZ(this.zoe);r.oZ(this.Aoe)})}hed(r,M){var la;if(this.W_i(r))if(8===this.iN)aa.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{M&&aa.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{aa.ULS.shipAssertTag(525135956,0,7===this.iN,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.pK.equals(this.dia())?(null===(la=this.gridView)||
void 0===la?0:la.De)?(this.kV.editBoxDivergence++,this.iN=11):(r=0,r=this.dM.qu,-1==r?(this.kV.errors++,aa.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.kV.adjusted++,this.iN=8,this.gridView.ha.ZK(this.dM.selectedRanges,r,this.dM.activeCell,0,void 0,"SelectionAdjust"))):(this.kV.divergenceOnViewportReady++,this.fmg(),this.iN=9)}catch(Qa){this.iN=12,aa.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Qa}`)}finally{this.$u()}}}W_i(r){if(!this.dM)return!1;
if(!this.pK)return aa.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.dM.toString()}`),!1;if(Yb.h(this.$).ya.nUf<this.sPc)return!1;if(r||this.Ntk)aa.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.pK.pOg(this.sPc)||!this.dM.pOg(this.sPc))return!1;return!0}$u(){this.pK=this.dM=
null;this.iN=0}fmg(){const r=this.dia();aa.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.pK.toString()} current: ${r?r.toString():""} adjusted: ${this.dM.toString()} sheetSameBetweenInitialAndAdjusted: ${this.pK.sheetName===this.dM.sheetName} sheetSameBetweenInitialAndCurrent: ${this.pK.sheetName===(r?r.sheetName:null)}`)}get kV(){return id.a.jI(this.jfj)?this.Aoe:this.zoe}}Object(da.a)(Ed,"SelectionAdjustManager",null,[458,2]);class Pd extends bc.a{constructor(r,
M,la){la=void 0===la?null:la;super();this.ELa=this.muc=this.Reb=this.$9a=null;this.$=r;this.l6a=new Ee(r);this.UIa=new Ed(this.$);this.PRa=new mb(this.$.oa.ua,this.$,void 0,void 0,this.UIa);this.GMi(r,la);this.jna=new ie(this.ELa,this.l6a,this.PRa);this.L5d=new ye(r,this.jna,M,this.PRa);ya.EwaSettings.Ia(230)&&(this.muc=new Ma(r,this));aa.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}Hcc(r){this.jna.Hcc(r)}zJc(r){this.jna&&this.jna.zJc(r)}get qpa(){return this.ELa}get wua(){return this.l6a}get Jca(){return this.jna}mIa(r,
M){this.ELa.mIa(r,M)}zie(r){this.ELa.zie(r)}yYa(r,M){this.l6a.yYa(r,void 0===M?"":M)}dispose(){this.muc&&(this.muc.dispose(),this.muc=null);this.UIa&&this.UIa.dispose();this.PRa.dispose();this.L5d&&(this.L5d.dispose(),this.L5d=null);this.jna&&(this.jna.dispose(),this.jna=null);this.l6a.dispose();this.l6a=null;this.ELa.dispose();this.ELa=null;this.$9a&&(this.$9a.dispose(),this.$9a=null);this.Reb&&(this.Reb.dispose(),this.Reb=null);this.$=null;super.dispose()}eVb(){this.jna.lMj()}static npc(r){let M=
0;for(const la of r){if(2==la)return 2;1==la&&(M=1)}return M}GMi(r,M){this.ELa=new ne(this.PRa,this.l6a);M?Object(ob.a)(ib,M)?this.mIa(M,Object(Zb.a)(ib,M).rN):Object(ob.a)(ld,M)?this.mIa(M,Object(Zb.a)(ld,M).rN):this.mIa(M,0):(this.$9a=new ld(r),this.Reb=new ib(r),this.mIa(this.$9a,this.$9a.rN),this.mIa(this.Reb,this.Reb.rN))}}Object(da.a)(Pd,"MergeSuspensionManager",bc.a,[429,2]);class lc extends cb.a{constructor(r){super();this.ug=r;this.Dg()}create(){aa.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");
this.Df(this.ug.ja.Qa(343)||this.ug.ja.$c(343,new Pd(this.ug,na.a.instance)))}static ta(r){aa.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");r.ja.$c(344,new lc(r))}}Object(da.a)(lc,"MergeSuspensionFactory",cb.a,[]);var Kc=a(531),td=a(94),zd=a(41);class me{constructor(r){this.bpb=!0;me.gTi()?this.bpb=!1:me.WEf()?(aa.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!r}`),this.bpb=r):this.bpb=!1}cgb(){return!this.bpb}static WEf(){return!ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableLineageTUI",
!1)}static gTi(){return ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(da.a)(me,"LineageCatchUpExperimentManager",null,[426]);class Ae extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){me.WEf()?zd.TaskExtensions.Ca(Object(td.d)(wb.a.resolve(Db.tc,{Aa:this.$a})),r=>{zd.TaskExtensions.Ca(r.result.cik(),M=>{this.B2e(M.result)},this.$.qa,3)},this.$.qa,3):this.B2e(!0)}B2e(r){this.Df(this.$.ja.Qa(458)||this.$.ja.$c(458,new me(r)))}static ta(r){r.ja.$c(459,
new Ae(r))}}Object(da.a)(Ae,"LineageCatchUpExperimentManagerFactory",cb.a,[]);var ze=a(68),Ne=a(6),hf=a(65),rf=a(91),df=a(703),Af;let Pc=Af=class{constructor(r,M){this.jKd=!1;this.ij=()=>{this.pHg()};this.$=r;this.$.ea.Zhb&&!Af.gKb&&(M&&!M.bpb||this.EJk(),Af.syf?aa.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):M&&!M.bpb||this.MJk());aa.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.n3d();
this.$=null;aa.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){Af.gKb||(Af.gKb=!0,aa.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.n3d()}MJk(){this.$.isAnonymousUser()||Bd.j(this.$.oa.ua,r=>{this.$?(r=r.Result,aa.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${r}.`),Af.syf=!0,r&&this.$Gg(0)):aa.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},
()=>{aa.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}EJk(){this.pHg()||(this.$.ea.Jy(this.ij),this.jKd=!0)}pHg(){return this.$.ea&&this.$.ea.Vq&&this.$.ea.Vq.ShouldTriggerLineageCalloutOnMerge?(aa.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.$Gg(1),!0):!1}$Gg(r){Af.gKb?aa.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):
(Af.gKb=!0,aa.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${r}.`),this.n3d(),ya.EwaSettings.Ia(418)&&(r=new rf.a(-847286761,hf.a.Ke,this.$.zf,0,Ne.a.I1),this.$.Ha.Me(r,{["CalloutName"]:4})))}n3d(){this.jKd&&(this.jKd=!1,this.$.ea.pA(this.ij))}};Pc.gKb=!1;Pc.syf=!1;Pc=Af=Object(hb.__decorate)([Object(wb.d)(Db.uc),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(df.j)())],Pc);Object(da.a)(Pc,"LineageTeachingCalloutTriggerManager",
null,[300,2]);class eb extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){zd.TaskExtensions.Ca(ze.GetServiceTaskFactory.vf(this.$.ja,458,459,this.$a),r=>{const M=r.result;r=Object(pb.a)(this.$.ja,403,()=>new Pc(this.$,M));this.Df(r)},this.$.qa,3)}static ta(r){r.ja.$c(402,new eb(r))}}Object(da.a)(eb,"LineageTeachingCalloutTriggerManagerFactory",cb.a,[]);var gc=a(841),Qc=a(446);class Vc extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){const r=Db.Bd.$e()?Object(td.d)(wb.a.resolve(Db.Bd,
{Aa:this.$a})):ze.GetServiceTaskFactory.create(this.$.ja,102,this.$.qa,this.$a),M=Object(td.d)(wb.a.resolve(Db.s,{Aa:this.$a})),la=ze.GetServiceTaskFactory.vf(this.$.ja,388,387,this.$a),Qa=Object(td.d)(wb.a.resolve(Db.fc,{Aa:this.$a})),Kb=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEnrichmentTaskPane",!1)?Object(td.d)(wb.a.resolve(Db.lb,{Aa:this.$a})):ze.GetServiceTaskFactory.vf(this.$.ja,257,258,this.$a),hc=Qc.a(this.$);zd.TaskExtensions.Ca(zd.TaskExtensions.Dh([r,Kb,hc,M,
la,Qa],this.qa),()=>{this.Df(Object(pb.a)(this.$.ja,271,()=>new gc.ConvertToLinkedEntityManager(this.$,r.result,la.result,Kb.result,hc.result,M.result,Qa.result)))},this.$.qa,3)}static ta(r){r.ja.$c(272,new Vc(r))}}Object(da.a)(Vc,"ConvertToLinkedEntityManagerFactory",cb.a,[]);var Id=a(253),be=a(280),Vb=a(263),Gc=a(14),Bb=a(829),uc=a(18);const Dc=uc.a.r4h;let kd=class extends Id.a{constructor(r,M){let la=document.getElementById(r.Af+Ne.a.paf);la||(la=Bb.a("div",r.Af+Ne.a.paf,"cui-taskpane"));super(la);
this.eY=0;this.D3a=!1;this.sg=()=>{this.WB(!1)};this.$=r;this.taskPaneManager=M;be.a(r).sn(this);this.$.Sm(this.sg);this.isVisible=!1}s$(r){this.addHandler("EnrichmentTaskPaneVilibilityChanged",r)}Ada(r){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",r)}Zeh(r){this.addHandler("EnrichmentTaskPaneOnFocus",r)}YVj(r){this.removeHandler("EnrichmentTaskPaneOnFocus",r)}get isVisible(){return super.isVisible}set isVisible(r){super.isVisible=r;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get nl(){return this.isVisible}get Qh(){return Vb.a.IXh}get r2a(){return 10}get Et(){return Dc}get titleText(){return ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")?
CommonUIStrings.l_EnrichmentPaneTitle:"Enrichment"}get CK(){return 300}get isResizable(){return!1}get ng(){return this.domElement}get height(){return this.taskPaneManager.sQc.offsetHeight}get UE(){return this.taskPaneManager.Tcb(this.ng,this.titleText,this.CK,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.CK)}HP(){return this.D3a}y0(){return this.D3a}dispose(){this.$&&this.$.ar(this.sg);this.taskPaneManager=this.$=null;super.dispose()}Wl(r,
M){M||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!M}Bm(r){return Gc.DOMElementExtensions.Ek(this.ng,r)}Ko(){}Rp(){}WB(r){(this.isVisible=this.D3a=r)?this.taskPaneManager.DN("EnrichmentTaskPane",this.UE):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane");r||(Yb.h(this.$).Wl(!0,!1),this.$.Tj())}};kd=Object(hb.__decorate)([Object(wb.d)(Db.lb),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(Db.rd)()),Object(hb.__param)(2,Object(df.d)()),Object(hb.__param)(3,Object(Db.J)())],
kd);Object(da.a)(kd,"EnrichmentTaskPane",Id.a,[298,2,211,54]);class xd extends cb.a{constructor(r){super();this.cw=this.ZU=null;this.$=r;this.Dg()}get QTb(){this.ZU||(this.ZU=zd.TaskExtensions.Ca(Qc.a(this.$),r=>{this.cw=this.$.ja.Qa(257)||this.$.ja.$c(257,new kd(this.$,r.result))},this.qa,3));return this.ZU}create(){const r=ze.GetServiceTaskFactory.create(this.$.ja,203,this.qa,this.$a),M=Object(td.d)(wb.a.resolve(Db.J,{Aa:this.$a}));zd.TaskExtensions.Ca(zd.TaskExtensions.ts(zd.TaskExtensions.Dh([r,
M],this.qa),()=>this.QTb,this.qa),()=>{this.Df(this.cw)},this.qa,3)}dispose(){this.cw=this.ZU=this.$=null;super.dispose()}static ta(r){r.ja.$c(258,new xd(r))}}Object(da.a)(xd,"EnrichmentTaskPaneFactory",cb.a,[]);var Pb=a(1292),Ec=a(99),ed=a(195);class Td{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}
Object(da.a)(Td,"TaskPaneGroupAppProps",null,[]);class Rd{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(da.a)(Rd,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var Ke=a(30),$d=a(25),we=a(153),bf=a(12);Object(wb.b)(Db.rd,{nn:"singleton"})(r=>Lo(function*(){const M=yield wb.a.resolve(Db.nb,r);return $e.ta(M)}));class $e extends qd.a{constructor(r,M){super();this.isVisible=!1;this.YOh=500;this.sZb=[];this.U4e=this.EYc=
null;this.wVd=()=>{this.Ang()};this.uQc=new Set;this.uQc.add("FieldListTaskPane");this.uQc.add("PivotTableSettingsTaskPane");this.uQc.add("SlicerSettingsTaskPane");this.Ie=M;be.a(this.$).sn(this);this.q0b=r;za.AFrameworkApplication.ra.Pa.Gh||(this.q0b.style.bottom=this.$.Wg&4?bf.HelperMethods.rg(this.$.GJa):"0");this.rnc={};this.r0b={};this.loe=new Set;this.Kfe=we.a.instance.Kh(this.ng);this.Kfe.ta("focusin",this.wVd);this.mPi()}get $(){return this.Ie}get ibc(){return this.loe}get BRa(){return this.EYc}get isCollapsed(){return!this.BRa}dispose(){be.a(this.$).rD(this);
const r=this.rnc;for(const M in r)({key:M,value:r[M]}).value();this.r0b=this.loe=this.rnc=null;this.Kfe.TJ();this.q0b=this.Kfe=null;super.dispose()}Tcb(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re,Ge,kf,sf,Lf,Pf,kg,yg){Ad=void 0===Ad?$e.U6i:Ad;re=void 0===re?$e.T6i:re;Ge=void 0===Ge?null:Ge;kf=void 0===kf?null:kf;sf=void 0===sf?!1:sf;Lf=void 0===Lf?!1:Lf;Pf=void 0===Pf?null:Pf;kg=void 0===kg?!1:kg;const Xg=Object(V.a)(new Rd,{getContent:()=>r});Xg.isSharedRuntime=sf;return Object(V.a)(new Pb.a,{hideHeader:Lf,contentProps:Xg,
title:M,titleTag:Pf,width:la,location:2,onOpen:Kb,onClose:hc,onShow:Ac,onHide:Zc,iconUrl:Ge,iconId:kf,enableResize:Qa,minResizeWidth:Ad,maxResizeWidth:re,showResizeChatButton:kg,onCloseButtonTabKeyDown:Ig=>{ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8039664_TaskpaneCloseShiftTab")&&(Ig.shiftKey&&Ig.keyCode===Ec.a.bC&&!Qa?void ed.UISurfaces.wl().then(th=>{1>=th.selectors.getTabbedTaskPaneCount()&&yg(Ig);return null}):Ig.keyCode!==Ec.a.bC||Ig.shiftKey||yg(Ig))}})}DN(r,M){ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.sZb.indexOf(r)&&(this.sZb[r]=!0);void ed.UISurfaces.wl().then(la=>{this.ibc.has(r)?la.setSelectedTaskPane(r):la.showTaskPane(r,M);return null})}omd(r,M){this.sZb[r]=!1;void ed.UISurfaces.wl().then(la=>{la.initializeHiddenSharedRuntimeTaskPane(r,M);const Qa=this.$.domElement;Qa.addEventListener("scroll",function hc(){0!=Qa.scrollLeft&&(Qa.scrollLeft=0,Qa.removeEventListener("scroll",hc))})})}updateTaskPane(r,M){ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.sZb.indexOf(r)&&
!this.sZb[r]||void ed.UISurfaces.wl().then(la=>{la.updateTaskPane(r,M);return null})}setSelectedTaskPane(r){void ed.UISurfaces.wl().then(M=>{M.setSelectedTaskPane(r);return null})}hideTaskPane(r){void ed.UISurfaces.wl().then(M=>{M.hideTaskPane(r,$e.ptk);return null})}get ng(){return this.q0b}get nl(){return this.isVisible}get Qh(){return Vb.a.Mfe}Wl(r,M){return M?!1:(this.Urg(),!0)}Bm(r){return Gc.DOMElementExtensions.Ek(this.ng,r)}Ko(){this.$.frame.zj.cr(this.Qh)}Rp(){}focusResizeHandle(){void ed.UISurfaces.wl().then(r=>
{r.focusResizeHandle();return null})}focusTabbedTaskPaneArea(){void ed.UISurfaces.wl().then(r=>{r.focusTabbedTaskPaneArea();return null})}mPi(){ed.UISurfaces.wl().then(r=>{const M=new Td;M.onOpen=la=>{this.isVisible=!0;this.ibc.add(la)};M.onClose=la=>{this.isVisible=0<r.selectors.getTabbedTaskPaneCount();aa.ULS.sendTraceTag(537014371,0,50,`Closing of ${la} TaskPane`);this.isVisible||this.Ojf();delete this.r0b[la];this.ibc.delete(la);za.AFrameworkApplication.ra.Pa.Gh||this.Bfc()};M.onShow=(la,Qa)=>
{this.EYc=la;this.Ang();1!==Qa&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.y2j()},0)});za.AFrameworkApplication.ra.Pa.Gh||this.Bfc()};M.onHide=(la,Qa,Kb)=>{this.EYc=null;Kb&&1!==Qa&&this.Ojf();za.AFrameworkApplication.ra.Pa.Gh||this.Bfc()};M.setFocusCallback=(la,Qa)=>{Qa&&(this.r0b[la]=Qa)};M.onResizeStart=()=>{};M.onResizeEnd=()=>{za.AFrameworkApplication.ra.Pa.Gh||this.Bfc();aa.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.BRa} TaskPane`)};r.renderTaskPaneGroups(null,this.q0b,
M);return null})}Bfc(){ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8426131_gridLayoutCleanup")&&Fa.Task.delay(this.YOh).continueWith(()=>{this.$.j_j()})}Ojf(){Yb.h(this.$).setFocus()}y2j(){if(this.r0b[this.BRa]){const r=this.r0b[this.BRa];r&&r(null,null)}else this.uQc.has(this.BRa)||this.Urg()}Urg(){ed.UISurfaces.wl().then(r=>{if(!ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<r.selectors.getTabbedTaskPaneCount())r.focusTabbedTaskPaneArea();else{const M=
Gc.DOMElementExtensions.Xz(this.ng.querySelectorAll(Gc.DOMElementExtensions.jE));M?M.focus():ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<r.selectors.getTabbedTaskPaneCount()&&r.focusTabbedTaskPaneArea()}return null})}Ang(){this.$.domElement.scrollLeft=0;Cc.a.EFa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}get sQc(){return this.q0b}Fic(r,M,la,Qa,Kb){let hc=r.Qa(M);hc||(hc=
$d.a(Ke.a,la,r,M),hc.SetScriptLoadFlavor(Kb));Qa&&hc.XLe(Qa);const Ac=""+M;let Zc=null;const Ad=()=>{hc.create();Zc()};this.rnc[Ac]=Zc=()=>{hc.O3d(Ad);delete this.rnc[Ac]};hc.nbd(Ad)}static ta(r){const M=$e.orh(r.Af,r.isChromeRtl);$e.Rlh(r,M);return new $e(M,r)}static orh(r,M){const la=document.createElement("div");la.id=r+Ne.a.Nfe;za.AFrameworkApplication.ra.Pa.Gh?la.classList.add(uc.a.yKk):(la.classList.add(M?uc.a.AKk:uc.a.zKk),za.AFrameworkApplication.ra.Pa.Gh&&la.classList.add(uc.a.jmb));return la}static Rlh(r,
M){r.isMobileMode&&M.setAttribute("aria-hidden","true");if(za.AFrameworkApplication.ra.Pa.Gh){let la;(la=document.getElementById("FarPaneRegion"))?la.appendChild(M):aa.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else document.getElementById(r.Af+Ne.a.Qgc).insertBefore(M,r.FJa)}}$e.U6i=300;$e.T6i=950;$e.ptk=2;Object(da.a)($e,"ReactTaskPaneManager",qd.a,[294,54,2]);class $a extends cb.a{constructor(r){super();
this.$=r;this.Dg()}create(){this.VPj(()=>$e.ta(this.$))}static ta(r){r.ja.$c(50,new $a(r))}VPj(r){r=Object(pb.a)(this.$.ja,183,r);this.Df(r)}}Object(da.a)($a,"TaskPaneManagerFactory",cb.a,[]);var Ia=a(27);let gb=class extends qd.a{constructor(){super()}Bhe(r,M){aa.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${r}, TriggerType: ${M}`);if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1))switch(M){case 0:this.raiseEvent("pssort",void 0,r);break;case 1:this.raiseEvent("psfilter",void 0,r);break;case 2:this.raiseEvent("pscrttbl",void 0,r)}}};gb=Object(hb.__decorate)([Object(wb.d)(Db.md)],gb);Object(da.a)(gb,"ProactiveSuggestionManager",qd.a,[308]);class Nb extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){const r=Object(pb.a)(this.$.ja,476,()=>new gb);this.Df(r)}static ta(r){r.ja.$c(475,new Nb(r))}}Object(da.a)(Nb,"ProactiveSuggestionManagerFactory",cb.a,[]);var ec=
a(536),Bc=a(167);class Wc{constructor(r,M,la){this.Hce=this.Ice=this.Jce=!1;this.Yce=!r&&!M;this.Zce=!r&&!la;this.Yce||this.Zce||(this.Jce=!r,this.Ice=!M,this.Hce=!la)}}Object(da.a)(Wc,"RenameDisabledDialogInfo",null,[]);class od extends Bc.StandardDialog{constructor(r,M,la,Qa,Kb){super();this.bge=[];this.x9=new Wc(r,M,la);this.Mza=Qa;this.Iya=Kb;this.xh="RenameDisabledDialog";this.Ye=0;this.uf(1,CommonUIStrings.l_DialogClose);this.Vck();this.HXj()}Vck(){this.x9.Yce?this.i_b(this.Mza?this.Iya?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:
CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.x9.Zce?this.i_b(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.nah();this.joa(this.bge)}i_b(r){Array.add(this.bge,r)}nah(){const r=[];this.x9.Jce||Array.add(r,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.x9.Ice||Array.add(r,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.x9.Hce||Array.add(r,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<r.length&&
Array.add(this.bge,r)}}Object(da.a)(od,"ReactRenameDisabledDialogBase",Bc.StandardDialog,[]);class G extends od{constructor(r,M,la,Qa,Kb){super(r,M,la,Qa,Kb)}HXj(){this.XQb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(da.a)(G,"ReactRenameDisabledDialog",od,[]);var pa=a(191);class Ra{static get Wi(){return pa.a.Rq(Ra.to,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,
CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Ra.to="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";Object(da.a)(Ra,"RenameDisabledDialogHtml",null,
[]);class yb extends pa.a{constructor(r,M,la,Qa,Kb){super();this.x9=new Wc(r,M,la);this.Mza=Qa;this.Iya=Kb;this.xh="RenameDisabledDialog";this.Ye=0;this.uf(1,CommonUIStrings.l_DialogClose);this.Wi=Ra.Wi;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.n2("RenameRow")}Ojb(){if(this.x9.Yce){let r;r=this.Mza?this.Iya?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;
yb.i_b(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),r)}else this.x9.Zce?yb.i_b(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.hJi()}hJi(){this.x9.Jce&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.x9.Ice&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.x9.Hce&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static i_b(r,M,la){r.style.display="none";M.innerText=la}}Object(da.a)(yb,"RenameDisabledDialog",pa.a,[]);class ic{constructor(r,M){this.eNa=0;this.Cpa=(la,Qa,Kb,hc,Ac)=>{if(1===Kb)return this.Ma.mi(zb.a.renameFile,1);la=Za.a.Ns(this.jfa.qq);Ac=(0,Ac.getNewDocumentTitle)();Ac.length>this.eNa&&(Ac=Ac.substr(0,this.eNa));if(32!==this.Ma.rh(zb.a.renameFile,2,Ac))return this.O2(la),8;this.O2(Ac);return 32};this.Ma=r;this.jfa=
M}initialize(r){if(!this.Ma||!this.jfa)return!1;this.eNa=r;this.ik();return!0}ik(){this.Ma.hf(zb.a.Cpa,Rb.a.frame,this.Cpa)}O2(r){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(r))}static Gyd(){return new ic(za.AFrameworkApplication.Oe,za.AFrameworkApplication.zp)}}Object(da.a)(ic,"ReactRenameUIHandler",null,[478]);var bd=a(107),Nd=a(548),ce=a(760),le=a(16),Le=a(150),Ve=a(283),Ub=a(444),Mc=a(55);class Kd{constructor(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re,Ge,kf){this._initialized=!1;this._element=
null;this.eNa=0;this.s7c=this.E0c=!1;this.Ma=r;this.NWc=M;this.Xh=la;this.oF=Qa;this.jfa=Kb;this.MEe=hc;this.$9b=Ac;this.IXc=Zc;this.wfa=Ad;this.Xwe=re;this.y5a=Ge;this.B1c=kf}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(r,M,la){if(!(this.Ma&&this.jfa&&this.MEe&&this.$9b&&this.IXc&&M)||0>=r)return!1;this._element=M;this._element.title=la;this._element.setAttribute(Ub.a.ih,Ub.a.Kz);this._element.setAttribute("Unselectable","on");this.eNa=r;this.pz();return this._initialized=
!0}pz(){this.NWc&&(this.NWc.va(le.a.blur,this._element,Object(Ka.a)(this,this.onBlur,"onBlur")),this.NWc.va(le.a.paste,this._element,Object(Ka.a)(this,this.onPaste,"onPaste")));this.Xh.va(le.a.Hf,this._element,Object(Ka.a)(this,this.onKeyDown,"onKeyDown"));this.oF.va(le.a.yg,this._element,Object(Ka.a)(this,this.onPointerDown,"onPointerDown"));this.oF.va(le.a.Hk,this._element,Object(Ka.a)(this,this.Yk,"onPointerUp"))}onBlur(){this.isActive&&!this.E0c&&(this.Xwe||this.IXc(this._element),this.s_e(),
this.vnd(!1));return this.E0c=!1}onPaste(){aa.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(r){return this.isActive?this.Dtj(r):this.Etj(r)}Dtj(r){let M=!1;switch(r.Ga.keyCode){case Sys.UI.Key.enter:this.s_e();this.vnd(this.y5a||this.B1c);M=!0;break;case Sys.UI.Key.tab:this.Xwe&&this.IXc(this._element);break;case Sys.UI.Key.esc:this.J6d(),this.vnd(this.y5a||this.B1c),M=!0}return M}Etj(r){let M=!1;switch(r.Ga.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.yHg(this.B1c),
this.isActive&&this.$9b(this._element),M=!0}return M}onPointerDown(){this.isActive||(this.yHg(!1),this.isActive&&(this._element.focus(),this.$9b(this._element),this.s7c=!0));return!1}Yk(){return this.s7c?(this.$9b(this._element),this.s7c=!1,!0):!1}Bgb(){return 32===this.Ma.mi(zb.a.renameFile,1)}s_e(){const r=Za.a.Ns(this.jfa.qq);let M=this._element.innerText.trim();M.length>this.eNa&&(M=M.substr(0,this.eNa));M!==r&&""!==M?32!==this.Ma.rh(zb.a.renameFile,2,M)?this.J6d():this.O2(M):this.J6d()}J6d(){this.O2(Za.a.Ns(this.jfa.qq))}O2(r){this._initialized&&
(this._element.innerText=r,this.MEe())}yHg(r){this.Bgb()?this.isActive||(r&&(this.E0c=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ub.a.ih,Ub.a.Ndd),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,bd.a.O9e),this.wfa&&this.wfa.execute(M=>{M.jfg(!0)}),r&&this._element.focus(),aa.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ma.mi(zb.a.apb,2)}vnd(r){this._element.removeAttribute("contentEditable");
this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ub.a.ih,Ub.a.Kz);Sys.UI.DomElement.removeCssClass(this._element,bd.a.O9e);this.wfa&&this.wfa.execute(M=>{M.jfg(!1)});r&&(this._element.blur(),this._element.focus())}static IE(){Nd.a.IE(za.AFrameworkApplication.isRtl)}static Gyd(){return new Kd(za.AFrameworkApplication.Oe,ce.a.instance,Le.KeyInputManager.instance,Ve.a.instance,za.AFrameworkApplication.zp,Kd.IE,Mc.a.y5j,Mc.a.oyh,mc.a.instance.We("Common.App.Header.HeaderEventSource"),
Cc.a.dca,Cc.a.gk,Cc.a.hj)}}Object(da.a)(Kd,"RenameUIHandler",null,[478]);class je{static get instance(){return za.AFrameworkApplication.ra.Pa.wu?je.Ka||(je.Ka=ic.Gyd()):je.Ka||(je.Ka=Kd.Gyd())}}je.Ka=null;Object(da.a)(je,"RenameUIHandlerFactory",null,[]);var qe=a(112),Fe=a(194);class We{constructor(){this.Fhj=this.Ahj=this.JMh=null}}Object(da.a)(We,"RenameMruEntryProperties",null,[]);var mf=a(538),qf=a(175),Ga=a(696),Ob;(function(r){r[r.unknown=-1]="unknown";r[r.success=0]="success";r[r.DYk=1]="renameInvalidFileName";
r[r.CYk=2]="renameInCoauthNotSupported";r[r.EYk=3]="renameNotSupportedInViewMode";r[r.mYk=4]="permissionDenied";r[r.UYk=5]="serverCommunicationFailure";r[r.tQk=6]="fileNameTooLong"})(Ob||(Ob={}));Object(da.b)("CommonOperationResult",Ob);var e=a(367);class sb{constructor(r,M){this.fileNameCandidate=r;this.disableFailedActionDialog=void 0===M?!1:M}}Object(da.a)(sb,"RenameActionData",null,[]);class dc{constructor(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re,Ge,kf){this.uLb=()=>je.instance.initialize(za.AFrameworkApplication.Mnc,
za.AFrameworkApplication.$ab,za.AFrameworkApplication.G4d||CommonUIStrings.l_RenameFileTooltip)?32:8;this.apb=()=>{const sf=this.zHk(),Lf=this.W7g();aa.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.ZMa,Lf,sf,this.Mza);za.AFrameworkApplication.ra&&za.AFrameworkApplication.ra.Pa.cA&&za.AFrameworkApplication.fa.la("ReactRenameDisabledDialogIsEnabled")?
new G(this.ZMa,!Lf,!sf,this.Mza,this.Iya()):new yb(this.ZMa,!Lf,!sf,this.Mza,this.Iya());return 32};this.renameFile=(sf,Lf,Pf,kg,yg)=>{var Xg;if(1===Pf)return this.Bgb();if(!za.AFrameworkApplication.gnc)return 8;if(8===this.Bgb())return this.Rm.mi(zb.a.apb,2),8;aa.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");sf=!1;(null===(Xg=za.AFrameworkApplication.fa)||void 0===Xg?0:Xg.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))&&yg instanceof sb&&(sf=yg.disableFailedActionDialog,
yg=yg.fileNameCandidate);za.AFrameworkApplication.gnc(yg,Object(Ka.a)(this,this.ZSb,"onRenameFileSuccess"),sf?()=>{}:this.qwj);za.AFrameworkApplication.wXj=!0;return 32};this.qwj=sf=>{const Lf=new Bc.StandardDialog;Lf.Ye=0;switch(sf){case 1:aa.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Lf.gwa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:aa.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");
Lf.gwa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:aa.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:sf}),Lf.gwa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}za.AFrameworkApplication.kK().execute(Pf=>{Pf.sendMessage(qf.a.$8h,{["FailureMessage"]:Ob[sf]})});this.mog()};this.CPj=(sf,Lf,Pf)=>{if(1===Pf)return this.Bgb();if(!za.AFrameworkApplication.ySa)return 8;za.AFrameworkApplication.ySa(Object(Ka.a)(this,
this.LEc,"onRefreshFilenameSuccess"),Object(Ka.a)(this,this.KEc,"onRefreshFilenameFailure"),!1);return 32};this.eCc=(sf,Lf,Pf,kg,yg)=>{if(1===Pf)return za.AFrameworkApplication.fa.la("UiHostSupportsMoveToFolder")?this.Bgb():8;if(2===Pf){if(!za.AFrameworkApplication.rsg)return qe.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!yg)return qe.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(yg[mf.a.FUi])if(yg[mf.a.zMg])if(sf=
yg[mf.a.zMg].toLowerCase(),Lf=za.AFrameworkApplication.fa.la("UiHostSupportsDocRebootFeatures"),Pf=za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Lf&&za.AFrameworkApplication.QP&&Pf){const Xg={};Xg[mf.a.WZa]="1";Xg[mf.a.documentUrl]=sf;Xg[mf.a.reason]=Ga.a.saveAs;qe.Health.instance.recordKpiSuccess("MoveToFolder",null);za.AFrameworkApplication.kK().execute(Ig=>{Ig.sendMessage(qf.a.Z4,Xg)})}else if(!za.AFrameworkApplication.QP&&Pf)qe.Health.instance.recordKpiSuccess("MoveToFolder",
null),Mc.a.Ph(sf,Mc.a.qY(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return qe.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else qe.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else za.AFrameworkApplication.ySa(Object(Ka.a)(this,this.LEc,"onRefreshFilenameSuccess"),Object(Ka.a)(this,this.KEc,"onRefreshFilenameFailure"),!1),za.AFrameworkApplication.rsg(),qe.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};
this.jxe=r;this.Ma=M;this.SXc=la;this.IA=Qa;this.ZMa=Kb;this.W7g=hc;this.Mza=Ac;this.RHe=Zc;this.s4g=Ad;this.Iya=re;this.Fa=Ge;this.r4g=kf}ik(){za.AFrameworkApplication.ra&&za.AFrameworkApplication.ra.Pa.wu||this.Rm.hf(zb.a.uLb,Rb.a.frame,this.uLb);this.Rm.hf(zb.a.apb,Rb.a.frame,this.apb);this.Rm.hf(zb.a.renameFile,Rb.a.frame,this.renameFile);this.Rm.ji(zb.a.Nnc,Rb.a.frame,this.CPj,64);this.Rm.ji(zb.a.eCc,Rb.a.frame,this.eCc,64);this.Rm.hf(zb.a.WXa,Rb.a.frame,Object(Ka.a)(this,this.WXa,"moveToFolder"));
(za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||za.AFrameworkApplication.ra&&(za.AFrameworkApplication.fa.la("PostMessageEmbedded")||za.AFrameworkApplication.fa.la("IsJsApi"))&&za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&za.AFrameworkApplication.kK().execute(r=>{r.rp(qf.a.DVf);r.Dn(qf.a.DVf,dc.kOj);r.rp(qf.a.btd);r.Dn(qf.a.btd,dc.iOj)})}Bgb(){return 0===this.r4g.ctf()?
32:8}zHk(){return this.YD?this.Mza?this.YD.I8e:this.YD.IHb:!0}ZSb(r,M){r?0!==r.OperationResult?this.kxf(r.OperationResult):(this.N6j(M,r.NewName),this.ACk(r,Object(Ka.a)(za.AFrameworkApplication.ra.Pa,za.AFrameworkApplication.ra.Pa.DLg,"updateOpenInClientDocumentUrl")),za.AFrameworkApplication.fa.la("DocumentNameInJewelInfoMenuIsEnabled")&&za.AFrameworkApplication.ra.px(),this.s4g.$Jg()):this.kxf(5)}N6j(r,M){const la={};la[mf.a.a9h]=M;r.sendMessage(qf.a.btd,la)}ACk(r,M){this.NCk(r);za.AFrameworkApplication.Bkc=
r.DirectInvokeDavUrl;M=M(r.EditDocInClientUrl);const la=new We;la.Fhj=this.IA.qq;la.JMh=M;la.Ahj=r.EditDocInClientUrl;this.Rm.rh(zb.a.renameMostRecentlyUsedFileEntry,2,la)}kxf(r){switch(r){case 1:r=new Bc.StandardDialog,r.Ye=0,r.$X(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.mog()}}NCk(r){this.IA.qq=dc.jjh(this.IA.qq,r.NewName);r.BreadcrumbFolderName&&(this.IA.breadcrumbFolderName=r.BreadcrumbFolderName);r.BreadcrumbFolderUrl&&(this.IA.breadcrumbFolderUrl=
r.BreadcrumbFolderUrl);this.RHe(r.NewName)}WXa(r,M,la,Qa,Kb){if(1===la)return za.AFrameworkApplication.fa.la("UiHostSupportsMoveToFolder")?32:8;if(2===la){const hc={};r=za.AFrameworkApplication.QP;M=za.AFrameworkApplication.fa.la("UiHostSupportsDocRebootFeatures");r=(!r||r&&M)&&za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);hc[mf.a.Trk]=r;Kb&&Kb.MoveButtonClickedTime&&(hc[mf.a.Yfj]=Kb.MoveButtonClickedTime.getTime());za.AFrameworkApplication.kK().execute(Ac=>
{Ac.sendMessage(qf.a.WXa,hc)});if(Kb&&Kb.MoveButtonClickedTime){if(r=Fe.a.fu())Kb=(new Date).getTime()-Kb.MoveButtonClickedTime.getTime(),r.set("MovePostDuration",Kb.toString());qe.Health.instance.recordKpiUsage("MoveToFolder",e.b.FailureBased,"smartfio",r)}return 32}return 8}$ik(r,M){return r&&M?r!==this.IA.breadcrumbFolderName||M!==this.IA.breadcrumbFolderUrl:!1}LEc(r,M){r&&(r.NewName!==Za.a.Ns(this.IA.qq)||this.$ik(r.BreadcrumbFolderName,r.BreadcrumbFolderUrl))&&this.ZSb(r,M)}KEc(){}mog(){this.RHe(Za.a.Ns(this.IA.qq))}get Rm(){return this.Ma.value}get YD(){return this.SXc.value}static get instance(){return dc.Ka||
(dc.Ka=dc.cTa())}static cTa(){return new dc(za.AFrameworkApplication.jWa,new ec.a(()=>za.AFrameworkApplication.Oe),new ec.a(()=>za.AFrameworkApplication.YD),za.AFrameworkApplication.zp,za.AFrameworkApplication.limitedEdit,()=>za.AFrameworkApplication.userCanRename,za.AFrameworkApplication.BJc,Object(Ka.a)(je.instance,je.instance.O2,"updateTitle"),mc.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>za.AFrameworkApplication.isReadOnlyRecommended,za.AFrameworkApplication.fa,mc.a.instance.resolve("Common.IRenameProps"))}static jjh(r,
M){r=Za.a.D5(r);return M+r}static kOj(r){const M=r.Values[mf.a.fZi];aa.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",M);M?za.AFrameworkApplication.Oe.rh(zb.a.eCc,2,r.Values):qe.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static iOj(r){za.AFrameworkApplication.Oe.rh(zb.a.renameFile,2,r.Values.NewName)}}dc.Ka=null;Object(da.a)(dc,"RenameActor",null,[]);a(602);class N{}Object(da.a)(N,"ActivityEventName",null,[]);class Da{}
Da.compatMode="CompatMode";Object(da.a)(Da,"ActivityEventReason",null,[]);var fb=a(543);class Wb{constructor(r,M){this.Ma=r;this.J4a=M}ik(){this.Ma.hf(zb.a.nAg,Rb.a.frame,Object(Ka.a)(this,this.Xlk,"showRenameDialogAction"))}Xlk(r,M,la){r=32;if(1===la)return fb.SessionStatusManager.instance.neb||za.AFrameworkApplication.bca?8:32;2===la&&(32!==this.Ma.mi(zb.a.renameFile,1)?(this.Ma.mi(zb.a.apb,2),r=8):32===this.Ma.mi(zb.a.h_b,1)?this.Ma.mi(zb.a.h_b,2):this.J4a.value.create().cOc());return r}}Object(da.a)(Wb,
"RenameDialogActor",null,[456]);class Jc{constructor(r,M,la){this.dialog=null;this.Ma=r;this.IA=M;this.tya=la}Mvi(){const r={};r.nameInputProps={["type"]:"AppInputProps",["id"]:Jc.Zab,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Za.a.Ns(this.IA.qq),["maxLength"]:this.tya};return r}cOc(){const r={["id"]:"RenameDialog",["bodyControls"]:this.Mvi()};this.dialog=new pa.a(!1,!1,!0);this.dialog.Ye=1;this.dialog.xh="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,
Object(Ka.a)(this,this.E4d,"renameDialogHandler"),r)}E4d(r,M){M&&1===r&&M[Jc.Zab]&&(r=Za.a.Ns(this.IA.qq),M=(M[Jc.Zab]||"").trim(),M!==r&&""!==M&&this.Ma.rh(zb.a.renameFile,2,M))}}Jc.Zab="txtDocumentName";Object(da.a)(Jc,"ReactRenameDialog",null,[479]);class md{static get Wi(){return pa.a.Rq(md.to,CommonUIStrings.l_RenameDialogLabel)}}md.to="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(da.a)(md,"RenameDialogHtml",null,[]);class sd extends pa.a{constructor(r,M,la){super();this.Ma=r;this.IA=M;this.tya=la;this.xh="RenameDialog";this.Wi=md.Wi}cOc(){var r={["txtDocumentName"]:Za.a.Ns(this.IA.qq)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(Ka.a)(this,this.E4d,"renameDialogHandler"),r);r=document.getElementById(sd.Zab);0<this.tya&&(r.maxLength=this.tya);r.focus()}E4d(r,M){1===r&&(r=Za.a.Ns(this.IA.qq),M=(M[sd.Zab]||"").trim(),M!==r&&""!==M&&this.Ma.rh(zb.a.renameFile,
2,M))}}sd.Zab="txtDocumentName";Object(da.a)(sd,"RenameDialog",pa.a,[479]);class Od{constructor(r){this.jfa=null;this.tya=0;this.Ma=r;this._initialized=!1}initialize(r,M){this.jfa=r;this.tya=M;this._initialized=!0}create(){return this._initialized?za.AFrameworkApplication.ra&&za.AFrameworkApplication.ra.Pa.cA&&za.AFrameworkApplication.fa.la("ReactRenameDialogIsEnabled")?new Jc(this.Ma,this.jfa,this.tya):new sd(this.Ma,this.jfa,this.tya):null}}Object(da.a)(Od,"RenameDialogFactory",null,[451]);var Ce=
a(102),Qe=a(116),lf=a(106);class Oe{constructor(r,M){this.Ma=r;this.jg=M}ik(){this.Ma.hf(zb.a.h_b,Rb.a.frame,Object(Ka.a)(this,this.Ylk,"showRenameFlyoutAction"))}vuh(){return Na.d("setDocumentTitleFlyoutOpened")&&za.AFrameworkApplication.ra.Pa.wu}Ylk(r,M,la){if(1===la)return this.vuh()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Abh(){Oe.v1i&&za.AFrameworkApplication.ogb&&lf.TaskManager.instance.Li(new Qe.a(5,1,5E3,()=>{32===this.Ma.mi(zb.a.h_b,1)&&this.jg&&
this.jg.Nl.name===Qb.AFrame.OV&&(Ce.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Ma.mi(zb.a.h_b,2))}))}static get v1i(){Oe.q7b&&null!=Oe.q7b||(za.AFrameworkApplication.fG("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Oe.q7b=za.AFrameworkApplication.fa?za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Oe.q7b}}Oe.q7b=null;Object(da.a)(Oe,"RenameFlyoutActor",null,[450]);class ag{constructor(r,
M,la,Qa,Kb){this.SXc=Kb;this.kxe=la;this.jxe=Qa;this.$7g=r;this.Iya=M}get YD(){return this.SXc.value}ctf(){if(!this.jxe())return 5;if(this.Iya())return 1;if(this.YD){if(this.kxe&&!this.YD.I8e)return 3;if(!this.kxe&&!this.YD.IHb)return 4}return this.$7g()?0:2}}Object(da.a)(ag,"RenameProps",null,[449]);var xg=a(111);class Yf{constructor(r,M,la,Qa,Kb,hc){this.LA=!1;this.b3c=new xg.a;this.Q4a=M;this.nR=la;this.UWg=Qa;this.Fa=Kb;this.zGe=hc}enable(){this.LA||(this.$Jg(),this.xee(),this.LA=!0)}generateKey(r,
M,la){return String.format("{0}/{1}/{2}",la,r,M)}gqi(){const r=Za.a.Ns(this.Q4a().qq);return this.generateKey(this.Q4a().breadcrumbFolderName,this.Q4a().breadcrumbFolderUrl,r)}hqi(r,M,la){return r&&M?this.generateKey(r,M,la):la}vRh(r,M,la){return r&&r!==this.Q4a().breadcrumbFolderName||M&&M!==this.Q4a().breadcrumbFolderUrl?!0:la!==Za.a.Ns(this.Q4a().qq)}$Jg(){const r=this.gqi();this.b3c.da(r,new Date)}LYd(r){this.ohk(r)&&this.bJe(r)}ohk(r){const M=this.UWg();return M?this.zGe&&this.zGe.eNb||!M.nGf||
!za.AFrameworkApplication.ySa?(this.QCg(r),this.LA=!1):!0:!1}R7f(r,M,la,Qa){const Kb=this.vRh(r,M,la),hc=this.hqi(r,M,la);r=(()=>this.b3c.Ag(hc))().returnValue;Kb&&!r&&(this.lxf(Qa),aa.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.dPd));Kb||this.b3c.da(hc,this.nR())}}Object(da.a)(Yf,"ARenamedFileChecker",null,[424]);class Wa extends Yf{constructor(r,M,la,Qa,Kb,hc,Ac,Zc){super(r,M,la,Qa,Kb,hc);this.Zxf=(Ad,re)=>{re&&re.CRb&&re.Ckj&&(re.Lgb("BreadcrumbDocName")||re.Lgb("BreadcrumbFolderName")||
re.Lgb("BreadcrumbFolderUrl")||re.Lgb("DirectInvokeDAVUrl")||re.Lgb("EditDocInClientUrl"))&&(aa.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.dPd),this.LYd(re))};this.CDe=Kb;this.q4g=Ac;this.F_g=Zc}get dPd(){return"RenamedFileCheckerUsingSettingsRefresh"}xee(){this.CDe.Mbd(this.Zxf)}QCg(){this.CDe.Xkg(this.Zxf)}bJe(r){if(r&&r.CRb){const M=r.CRb;this.R7f(M.Ta("BreadcrumbFolderName"),M.Ta("BreadcrumbFolderUrl"),M.Ta("BreadcrumbDocName"),r)}}lxf(r){const M={OperationResult:0,
classId:1};r=r.CRb;M.BreadcrumbFolderName=r.Ta("BreadcrumbFolderName");M.BreadcrumbFolderUrl=r.Ta("BreadcrumbFolderUrl");M.DirectInvokeDavUrl=r.Ta("DirectInvokeDAVUrl");M.EditDocInClientUrl=r.Ta("EditDocInClientUrl");r=r.Ta("BreadcrumbDocName");M.NewName=za.AFrameworkApplication.gCa?r:Za.a.Ns(r);this.F_g.execute(la=>{this.HRi(M,la)})}HRi(r,M){this.q4g().ZSb(r,M)}}Object(da.a)(Wa,"RenamedFileCheckerUsingSettingsRefresh",Yf,[]);class vb extends Yf{constructor(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re){super(r,la,
Qa,Kb,hc,Ad);this.Kwb=this.Hac=null;this.z3g=M;this.Ma=Ac;this.sh=Zc;re&&re.execute(Ge=>{this.ZRj(Ge)})}get dPd(){return"RenamedFileCheckerUsingTask"}ZRj(r){this.Hac=r;this.Hac.Nbd(Object(Ka.a)(this,this.zUa,"handleVisibilityChange"))}zUa(r,M){!this.LA||0!==M.newState&&1!==M.newState||this.Kwb||(this.xee(),this.LYd(this.Kwb))}xee(){this.Kwb=new Qe.a(3,2,this.z3g(),Object(Ka.a)(this,this.LYd,"performRenameFileCheckTick"),89);this.sh.Li(this.Kwb)}QCg(r){this.sh.At(r)}bJe(r){this.Hac&&2===this.Hac.oPk?
this.dTj(r):za.AFrameworkApplication.ySa(Object(Ka.a)(this,this.LEc,"onRefreshFilenameSuccess"),Object(Ka.a)(this,this.KEc,"onRefreshFilenameFailure"),!0)}dTj(r){this.sh.At(r);this.Kwb=null}LEc(r){r&&this.R7f(r.BreadcrumbFolderName,r.BreadcrumbFolderUrl,r.NewName,null)}lxf(){this.Ma.mi(zb.a.Nnc,2)}KEc(){}}Object(da.a)(vb,"RenamedFileCheckerUsingTask",Yf,[]);class cc{constructor(){this.Fa=this.$b=null;this.kG=()=>{const r=za.AFrameworkApplication.ra.Pa.wu;za.AFrameworkApplication.jWa()&&je.instance.initialize(za.AFrameworkApplication.Mnc,
r?null:za.AFrameworkApplication.$ab,r?null:za.AFrameworkApplication.G4d||CommonUIStrings.l_RenameFileTooltip)&&(this.$b.register(ag,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Rf(()=>new ag(()=>za.AFrameworkApplication.userCanRename,()=>za.AFrameworkApplication.isReadOnlyRecommended,za.AFrameworkApplication.BJc,za.AFrameworkApplication.jWa,new ec.a(()=>za.AFrameworkApplication.YD))).If(),dc.instance.ik(),this.Fa.la("RenameDialogIsEnabled")&&(this.$b.resolve("Common.App.Rename.RenameDialogFactory").initialize(za.AFrameworkApplication.zp,
za.AFrameworkApplication.Mnc),this.$b.resolve("Common.App.Rename.IRenameDialogActor").ik()),this.$b.resolve("Common.App.Rename.IRenameFlyoutActor").ik(),za.AFrameworkApplication.BJc&&this.$b.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.$b.resolve("Common.App.Rename.IRenameFlyoutActor").Abh())}}get name(){return"Common.App.RenameFile"}dl(r){this.$b=r;this.Fa=za.AFrameworkApplication.fa;this.$b.register(Wb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Rf(()=>
new Wb(za.AFrameworkApplication.Oe,this.$b.eXb("Common.App.Rename.IRenameDialogFactory"))).If();this.$b.register(Od,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Rf(()=>new Od(za.AFrameworkApplication.Oe)).If();this.$b.register(424,"Common.App.Rename.IRenamedFileChecker").Rf(()=>this.yKh()).If();this.$b.register(Oe,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Rf(()=>new Oe(za.AFrameworkApplication.Oe,qb.FocusManager.instance())).If()}yKh(){if(this.Fa.la("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const r=
this.$b.pj("Common.IRefreshableAppSettings");if(r&&r.GJf)return new Wa(()=>r.Ng("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>za.AFrameworkApplication.zp,()=>new Date,()=>za.AFrameworkApplication.YD,r,this.$b.pj("Common.ISessionStatus"),()=>dc.instance,this.$b.We("Postmessage.IHostPostmessenger"))}return new vb(()=>this.Fa.Ng("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Fa.Ng("RenamedFileCheckerPingIntervalInMs",12E4),()=>za.AFrameworkApplication.zp,()=>new Date,()=>za.AFrameworkApplication.YD,
za.AFrameworkApplication.fa,za.AFrameworkApplication.Oe,za.AFrameworkApplication.jl,this.$b.pj("Common.ISessionStatus"),this.$b.We("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Fa.Xw(this.kG)}dispose(){}}Object(da.a)(cc,"PackageManager",null,[4,5]);var Ic=a(98),dd=a(244),Cd=a(405),ae=a(395),Be=a(204),oe=a(241);class Te{constructor(r){this.$=r}get nGf(){return this.$.workbookContext.FileCoauthorable}get eNb(){return!1}get IHb(){return this.$.ea.xZ}get I8e(){if(this.IHb)return!0;
for(const r of this.$.ea.Zo)if(!r.SupportsRename)return!1;return!0}}Object(da.a)(Te,"EwaCoauthManager",null,[457]);class wf extends bc.a{constructor(r,M){super();this.Vka=this.F4d=this.qlg=this.Hnd=null;this.sia=()=>{var la=this.$.ea.Vq;if(la&&la.WorkbookFileName){var Qa=Za.a.Ns(la.WorkbookFileName),Kb=!!ad.a.compare(this.$.workbookContext.WorkbookFileName,la.WorkbookFileName,!1),hc=ya.EwaSettings.Ia(465)&&!!la.BreadcrumbFolderUrl&&!!ad.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,
la.BreadcrumbFolderUrl,!1);if(Kb||hc)this.Vka={},this.Vka.NewFileName=Qa,this.Vka.EditDocInClientUrl=la.EditDocInClientUrl,this.Vka.DirectInvokeDAVUrl=la.DirectInvokeDAVUrl,this.Vka.DownloadACopyUrl=la.DownloadACopyUrl,ya.EwaSettings.Ia(465)&&la.BreadcrumbFolderUrl&&(this.Vka.BreadcrumbFolderName=la.BreadcrumbFolderName,this.Vka.BreadcrumbFolderUrl=la.BreadcrumbFolderUrl),la=za.AFrameworkApplication.Oe.rh(zb.a.Nnc,2,Qa),this.Vka=null,aa.ULS.shipAssertTag(537154064,0,32===la,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.mpj=(la,Qa,Kb)=>{this.qlg=Qa;this.F4d=Kb;this.$.Ha.Me(new rf.a(1897077126,hf.a.Ke,2,3,null),{["newFileName"]:la})};this.lpj=la=>{this.Vka&&la(this.dtf(this.Vka),this.ns)};this.ZSb=la=>{oe.a(la)||!la.Result?(la=wf.hfi(la),Cb.a(this.$).Ig.JR([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.F4d(la)):this.qlg(this.dtf(la.Result),this.ns)};this.pwj=()=>{this.F4d(5)};this.$=r;this.ns=M;this.$.ea.Jy(this.sia)}initialize(){za.AFrameworkApplication.gnc=this.mpj;za.AFrameworkApplication.ySa=
this.lpj;this.Hnd=za.AFrameworkApplication.YD;za.AFrameworkApplication.YD=new Te(this.$)}dispose(){za.AFrameworkApplication.gnc=null;za.AFrameworkApplication.ySa=null;this.$.ea.pA(this.sia);za.AFrameworkApplication.YD=this.Hnd;this.$=this.Hnd=null;super.dispose()}renameFile(r,M){const la=r.newFileName;if(la&&(r=Za.a.Ns(this.$.workbookContext.WorkbookFileName),ad.a.compare(r,la,!1))){const Qa=this.$.oa.ua.qf();ae.a(this.$.userOperationManager,(Kb,hc,Ac)=>{var Zc=this.$.oa.ua;Kb=Xc.b(Kb,this.ZSb);hc=
Xc.a(hc,this.pwj);const Ad=Zc.Oa(9,Qa);Ad.newFileName=la;return Bd.h(Zc,"RenameFile",Ad,Kb,hc,Ac,null,0)},Kb=>new Be.a(134,0,Kb),M)}}mUi(){return 32===za.AFrameworkApplication.Oe.mi(zb.a.Cpa,1)}dtf(r){var M=this.$.workbookContext;za.AFrameworkApplication.a5=r.DownloadACopyUrl;const la=ya.EwaSettings.Ia(465)&&!!r.BreadcrumbFolderUrl;la&&(za.AFrameworkApplication.zp.breadcrumbFolderName=r.BreadcrumbFolderName,za.AFrameworkApplication.zp.breadcrumbFolderUrl=r.BreadcrumbFolderUrl,M.FullDocumentInfo.BreadcrumbFolderUrl=
r.BreadcrumbFolderUrl,M.FullDocumentInfo.BreadcrumbFolderName=r.BreadcrumbFolderName);M.FullDocumentInfo.BreadcrumbDocName=r.NewFileName;Cd.d(M,r.NewFileName);M={};M.NewName=r.NewFileName;M.DirectInvokeDavUrl=r.DirectInvokeDAVUrl;M.EditDocInClientUrl=r.EditDocInClientUrl;la&&(M.BreadcrumbFolderName=r.BreadcrumbFolderName,M.BreadcrumbFolderUrl=r.BreadcrumbFolderUrl);M.OperationResult=0;return M}static hfi(r){switch(r.Errors[0].MessageId){case -414480287:r=2;break;case 650565124:r=1;break;case 1636785843:r=
6;break;case -782844485:r=4;break;default:r=5}return r}}Object(da.a)(wf,"RenameFileManager",bc.a,[423,2]);var fg=a(56);class Og extends cb.a{constructor(r){super();this.wBa=this.renameFileManager=null;this.$=r;this.Dg()}create(){if(!this.wBa){const r=dd.a.fab(fg.b(),this.qa,"Task","IRenameFileManager");this.wBa=r.task;const M=ze.GetServiceTaskFactory.create(this.$.ja,137,this.qa,this.$a),la=Object(td.d)(wb.a.resolve(Db.J,{Aa:this.$a}));zd.TaskExtensions.Ca(zd.TaskExtensions.Dh([la,M],this.qa),()=>
{const Qa=new wf(this.$,M.result);this.$.ja.$c(120,Qa);r.setResult(Qa)},this.qa,3)}this.wBa.continueWith(r=>{this.Df(r.result)})}dispose(){Ic.a.Sa(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ta(r){r.ja.$c(119,new Og(r))}}Object(da.a)(Og,"RenameFileManagerServiceFactory",cb.a,[]);var yf=a(79),Sf=a(575),Wf=a(9),ng=a(53),Me=a(174),Dg=a(74),Tg=a(322),gg=a(148),Rg=a(115),qh=a(330),ug=a(149),Dh=a(397);class zg{constructor(r,M){this.dfb=this.yuc=0;this.XBb=null;this.yGf=
!1;this.$=r;this.zoomManager=M;this.yGf=r.Uyc}aXi(){return Yb.h(this.$).De?(aa.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Le.aD?(aa.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}xqj(r){this.XBb=new Sys.UI.Point(Math.round(r.lDa.center.x),Math.round(r.lDa.center.y));this.yuc=ya.EwaSettings.Pi()?this.zoomManager.zoom:yf.a(this.$).zoom;this.dfb=
r.lDa.scale;const M={["InitialZoom"]:this.yuc,["Location"]:"canvas",["InputMethod"]:r.Te};ug.b(this.$).Gg(gg.a.vEj,M);aa.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.XBb.x},${this.XBb.y}), initial zoom ${this.yuc}, initial scale ${this.dfb}`);this.Fib(r,"onGestureStart");return!0}wqj(r){if(!this.dfb)return aa.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.Fib(r,"OnGestureEvent"),
!0;if(!isFinite(this.dfb))return aa.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.dfb}`),this.Fib(r,"OnGestureEvent"),!0;const M=r.lDa.scale/this.dfb*this.yuc;ya.EwaSettings.Pi()?this.zoomManager.fme(M,this.XBb):yf.a(this.$).fme(M,this.XBb);aa.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${M}. Current scale ${r.lDa.scale}`);this.Fib(r,"OnGestureEvent");return!0}vqj(r){ya.EwaSettings.Pi()?
(this.zoomManager.gme(),aa.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture")):(yf.a(this.$).gme(),aa.ULS.sendTraceTag(508354561,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture"));this.Fib(r,"OnGestureEnd")}uqj(r){aa.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.Fib(r,"OnGestureCancel")}Fib(r,M){var la,Qa,Kb;this.yGf&&(aa.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${M},        eventArgs non-null: ${isNullOrUndefined(r)}, gestureData non-null: ${isNullOrUndefined(null===
r||void 0===r?void 0:r.lDa)},        srcEvent non-null: ${isNullOrUndefined(null===(la=null===r||void 0===r?void 0:r.lDa)||void 0===la?void 0:la.srcEvent)}`),null===(Kb=null===(Qa=null===r||void 0===r?void 0:r.lDa)||void 0===Qa?void 0:Qa.srcEvent)||void 0===Kb?void 0:Kb.preventDefault())}}Object(da.a)(zg,"PinchToZoomAdapter",null,[324]);let Eg=class extends qd.a{constructor(){super()}Lcc(r){this.addHandler("ZCIEK",r)}D4d(r){this.removeHandler("ZCIEK",r)}e8a(r){this.addHandler("ZCUIK",r)}GWb(r){this.removeHandler("ZCUIK",
r)}zNe(r){this.addHandler("ZDCEK",r)}vXj(r){this.removeHandler("ZDCEK",r)}vMj(){this.raiseEvent("ZCIEK")}uMj(){this.raiseEvent("ZCUIK")}wMj(){this.raiseEvent("ZCEK")}zfg(){this.raiseEvent("ZDCEK")}};Eg=Object(hb.__decorate)([Object(wb.d)(Db.xe)],Eg);Object(da.a)(Eg,"ZoomEventManager",qd.a,[299]);var Lg=a(93);class jg extends qd.a{constructor(r,M){super();this.statusBarManager=null;this.Gkf=!1;this.zoomManager=M;this.$=r;this.$.ja.Ne(29,la=>{this.statusBarManager=la;la.YL(this)})}$t(r){this.addHandler("Zoom",
r)}Eu(r){this.removeHandler("Zoom",r)}gA(){this.wq("QueryZoomStatus")&&this.raiseEvent("Zoom")}Ov(r,M){return"QueryZoomStatus"!==r?!1:this.GFi(M)}wq(){return Ia.a.rY(this.$)}dispose(){this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null);this.$=null;super.dispose()}Tvf(r){r=this.FBi(r);if(!r)return null;r=r.getElementsByClassName("cui-ctl-mediumlabel");return 1!==r.length?(aa.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),
null):r[0]}GFi(r){if(!this.$)return!1;const M=ya.EwaSettings.Pi()?this.zoomManager.V2b:yf.a(this.$).V2b;let la=!1;if(Ia.a.An(this.$))ad.a.equals(appChrome.selectors.getControlLabel(Lg.a.zoomStatusBarMenuOpen),M,!1)||(la=!0);else{const Qa=this.Tvf("HandleQueryZoomStatusCommand");Qa?ad.a.equals(r.LabelText.toString(),M,!1)||(Qa.innerText="",la=!0):la=!0}la&&this.wak(r,M);return!0}wak(r,M){r.LabelText=M;Ia.a.An(this.$)&&(r.Visible=!0)}FBi(r){var M=Gc.DOMElementExtensions.getElementById(this.$.domElement,
"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!M)return M=(M=this.$.ea.ff)?M.inEmbedView:!1,Cc.a.Ht||M||aa.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${r}`),null;this.Gkf||(this.Gkf=!0,aa.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${r}`));return M}}Object(da.a)(jg,"ZoomStatusBarManager",qd.a,[2,256,169]);var hh=a(120),Jh=a(300);class uh extends Jh.a{constructor(r){super(r);
this.zoomEventManager=null;this.ICi=(M,la)=>{aa.ULS.sendTraceTag(507908168,0,50,"GridDensityOptionsDialog button pressed");if(1===M){M=Wf.a.vI;if(!0===la.isDefaultOption)yf.a(this.$).RYb(Wf.a.vI),this.zoomEventManager&&this.zoomEventManager.zfg();else{switch(Ia.a.Fpf()){case 1:M=1.2;break;case 2:M=.8}yf.a(this.$).Jjh(M)}[].push(hh.a.Ni("ZoomSetting",M.toString(),2));Ce.b("GridDensityOptionsDialogTryIt")}else 0===M&&(yf.a(this.$).RYb(Wf.a.vI),this.zoomEventManager&&this.zoomEventManager.zfg(),Ce.b("GridDensityOptionsDialogNoThanks"))};
this.FVd=()=>{const M={};M[Ne.a.XH]="GridDensityOptionsFeedback";this.$.Lf(802602464,hf.a.Ke,8,M)};aa.ULS.sendTraceTag(507908169,0,50,"GridDensityOptionsDialog.GridDensityOptionsDialog");this.Ye=1;r=this.cI();this.initializeAndShow("",this.ICi,r);ya.EwaSettings.wja()?void wb.a.Xn(Db.xe).then(M=>{this.zoomEventManager=M}):this.$.ja.Ne(419,M=>{this.zoomEventManager=M});Ce.b("GridDensityOptionsDialog")}get Cf(){return"GridDensityOptionsDialog"}cI(){const r={["optionType"]:Ia.a.Fpf()-1,["isRightToLeft"]:Yb.h(this.$).rtl,
["onGiveFeedbackLinkAction"]:this.FVd},M={};M.id=this.Cf;M.isRightToLeft=!1;M.bodyProps=r;M.hideCloseButton=!0;return M}}Object(da.a)(uh,"GridDensityOptionsDialog",Jh.a,[]);let Ja=class extends Sf.a{constructor(r,M){super(r);this.zoomEventManager=this.VFa=this.iPb=null;this.oPb=-1;this.xGf=!1;this.Lg=()=>{this.oPb=-1};aa.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Brb=new jg(r,this);this.wEj()&&(aa.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),
this.Alh());ya.EwaSettings.wja()?this.zoomEventManager=M:this.bSj()}dispose(){this.Brb&&(Ic.a.Sa(this.Brb),this.Brb=null);this.zoomEventManager&&(ya.EwaSettings.wja()||this.$.ja.T4(419),this.zoomEventManager=null);this.xGf&&this.PQh();super.dispose()}fme(r,M){r=this.$Ca(r);if(Yb.h(this.$).rtl){const la=ya.EwaSettings.Pi()?Math.round(Gc.DOMElementExtensions.getBounds(this.$.Bi).width*this.zoom):Math.round(Gc.DOMElementExtensions.getBounds(this.$.Bi).width*yf.a(this.$).zoom);this.iPb=new Sys.UI.Point(la-
M.x,M.y)}else this.iPb=M;this.gJa(r,!1,"ZoomWithPinch")}Crb(){return!0}CUc(r,M){var la=Cc.a.isMac?.07:.15;r=this.zoom+(r?la:-la);r=this.$Ca(r);Yb.h(this.$).rtl?(la=ya.EwaSettings.Pi()?Math.round(Gc.DOMElementExtensions.getBounds(this.$.Bi).width*this.zoom):Math.round(Gc.DOMElementExtensions.getBounds(this.$.Bi).width*yf.a(this.$).zoom),this.VFa=new Sys.UI.Point(la-M.x,M.y)):this.VFa=M;M=this.zoom;this.gJa(r,!0,"ZoomWithMouse");M={["InitialZoom"]:M,["FinalZoom"]:r,["Location"]:"canvas"};ug.b(this.$).Gg(gg.a.zMk,
M)}gme(){this.iPb=null}DUc(r,M){this.gJa(this.$Ca(r),!1,M?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}hme(r){this.gJa(this.$Ca(r),!1,"ZoomWithGridDensityOptionsDialog")}IPg(r){isNaN(r)?aa.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.gJa(this.$Ca(r),!1,"ZoomToLevelInExcelLive")}EUc(r,M){this.gJa(this.$Ca(r),!0,M?"ZoomWithShortcuts":"ZoomWithButtons")}Htf(r,M){const la=Yb.h(this.$).rtl,[Qa,Kb]=this.Czd(la),[hc,Ac]=
this.xBd(r,Kb);return this.VFa?(r=this.izd(this.VFa,r,M,Kb,Qa,"ZoomWithMouse"),this.VFa=null,r):this.iPb?this.izd(this.iPb,r,M,Kb,Qa,"ZoomWithPinch"):Yb.h(this.$).ha.Ua.isFloatingObjectSelected?this.yMk(r,M,Kb,Qa,hc,Ac,Yb.h(this.$).rtl):this.AMk(r,M,Kb,Qa,hc,Ac,Yb.h(this.$).rtl)}Drg(r,M,la){if(r){aa.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${r.x} ${r.y}) (new top-left) from zoom:${M} to zoom:${la}`);r=new ng.a(r.x,r.y);la=Yb.h(this.$).rtl;[,la]=this.Czd(la);const [Qa,Kb]=this.xBd(M,la);Yb.h(this.$).cOe(r,
Qa,Kb,"ApplicationZoom")}else aa.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${M} to zoom:${la}`)}zoomFitToScreen(){const r=this.zoom;var M=Yb.h(this.$).rtl;const [la,Qa]=this.Czd(M),[Kb,hc]=this.xBd(r,Qa);var Ac=Yb.h(this.$).ha.Ua.isFloatingObjectSelected;(M=Ac?this.hpf(this.vkb,Kb,hc,!1):this.Ptf(this.vkb,Qa,la,Kb,hc,M,!1))?(M=Math.min(Kb/(M.width+100),hc/(M.height+100)),M=this.wai(M),this.gJa(M,!0,"ZoomWithFitToScreen"),Ac?Yb.h(this.$).ha.Ua.xQa(Yb.h(this.$).ha.Ua.gf,!1):(Ac=jd.v(Yb.h(this.$).ha.pa.activeRange,
this.$),Yb.h(this.$).Tk(Ac,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.oPb=r,this.xGf||this.ulh()):aa.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${Ac}`)}zoomFitToScreenUndo(){this.gJa(this.oPb,!1,"ZoomWithFitToScreen")}Wbe(){return-1!==this.oPb}ulh(){const r=Yb.h(this.$);r&&(r.ha.qt(this.Lg),r.tJ(this.Lg))}PQh(){const r=Yb.h(this.$);r&&(r.ha.Pt(this.Lg),r.VK(this.Lg))}wai(r){r=Math.min(r,Wf.a.qej);r=Math.max(r,Wf.a.kfj);
return Math.round(100*r)/100}gJa(r,M,la){if(this.AUc()){var Qa=Yb.h(this.$).view.visibleArea.toString();r=this.$Ca(r);var Kb=Dg.d(this.$.sa.na);Kb||(Kb=Sf.a.YWf);Yb.h(this.$).mj.l8(5,qh.a.zUc,la);Yb.h(this.$).mj.Vja(qh.a.zUc,this.$.ea.uh);aa.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${r} to sheet ${Kb} origin ${la} prevZoom ${this.zoom}`);this.ydk(Kb,r);this.zoomEventManager.wMj();this.Zxk(la);this.kyk(M);this.oPb=-1;Dh.b(this.$,la);r=Yb.h(this.$).view.visibleArea.toString();
aa.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Qa}, NewGridVisibleArea: ${r}, IsShyRibbonActive: ${this.$.N0}`)}}bki(r){return(r=bf.HelperMethods.aI(this.$.Bi,this.$.domElement,r))?r:new Sys.UI.Point(0,0)}Czd(r){const M=this.bki(r);r=this.Xoi(M,r);return[M,r]}xBd(r,M){const la=Gc.DOMElementExtensions.getBounds(this.$.Bi);return[Math.round((la.width-M.x)*r),Math.round((la.height-M.y)*r)]}Xoi(r,M){M=bf.HelperMethods.aI(Yb.h(this.$).domElement,this.$.domElement,
M);return M?(r=new Sys.UI.Point(Math.round(M.x-r.x),Math.round(M.y-r.y)),r):new Sys.UI.Point(0,0)}AMk(r,M,la,Qa,Kb,hc,Ac){return(Ac=this.Ptf(r,la,Qa,Kb,hc,Ac))?this.wsf(Ac,r,M,la,Qa,Kb,hc):null}Ptf(r,M,la,Qa,Kb,hc,Ac){Ac=void 0===Ac?!0:Ac;var Zc=jd.I(Yb.h(this.$).ha.pa.selectedRanges);if(Ac&&(Zc=Zc.Bh(jd.I(Yb.h(this.$).Yrc())),!Zc))return aa.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const Ad=Yb.h(this.$).Pe(Zc.topLeft);Zc=
Yb.h(this.$).Pe(Zc.bottomRight);if(!Ad||!Zc)return aa.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;r=Ad.cell.TC===Zc.cell.TC&&Ad.cell.XF===Zc.cell.XF?this.Tii(r,Zc,M,la,Qa,hc):this.hAi(r,Ad,Zc,M,la,Qa,hc);return r?Ac?this.ijf(r,Qa,Kb):r:(aa.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}ijf(r,M,la){if(0>r.x||r.x>M)r.x=0;if(0>r.y||r.y>la)r.y=
0;r.x+r.width>M&&(r.width=M-r.x);r.y+r.height>la&&(r.height=la-r.y);return r}hAi(r,M,la,Qa,Kb,hc,Ac){M=Yb.h(this.$).getCellBounds(M.cell);if(!M)return null;const Zc=Yb.h(this.$).getCellBounds(la.cell);if(!Zc)return null;let Ad=Kb.x;Ac&&(Ad=0,M.x=Math.round(hc/r)-M.x-Math.round(M.width),Zc.x=Math.round(hc/r)-Zc.x-Math.round(Zc.width));r=new Sys.UI.Bounds(Math.round((M.x-Qa.x)*r)-Ad,Math.round((M.y-Qa.y)*r-Kb.y),Math.round((Zc.x+Zc.width-M.x)*r),Math.round((Zc.y+Zc.height-M.y)*r));la=la.cell.getRange();
aa.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${la.top}, b:${la.bottom}, r:${la.right}, l:${la.left}) in bounds (${r.x}, ${r.y}, ${r.width}, ${r.height})`);return r}Tii(r,M,la,Qa,Kb,hc){const Ac=Yb.h(this.$).getCellBounds(M.cell);if(!Ac)return null;let Zc=Qa.x;hc&&(Zc=0,Ac.x=Math.round(Kb/r)-Ac.x-Math.round(Ac.width));r=new Sys.UI.Bounds(Math.round((Ac.x-la.x)*r)-Zc,Math.round((Ac.y-la.y)*r-Qa.y),Math.round(Ac.width*
r),Math.round(Ac.height*r));M=M.cell.getRange();aa.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${M.top}, l:${M.left}) in bounds (${r.x}, ${r.y}, ${r.width}, ${r.height})`);return r}yMk(r,M,la,Qa,Kb,hc){const Ac=this.hpf(r,Kb,hc);return Ac?this.wsf(Ac,r,M,la,Qa,Kb,hc):null}wsf(r,M,la,Qa,Kb,hc,Ac){r=new Sys.UI.Point(this.btf(hc,r.x,r.width),this.btf(Ac,r.y,r.height));return this.izd(r,M,la,Qa,Kb)}btf(r,M,la){return r===la?(aa.ULS.sendTraceTag(537149772,
0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),r/2):r*M/(r-la)}hpf(r,M,la,Qa){Qa=void 0===Qa?!0:Qa;const Kb=Yb.h(this.$).ha.Ua.gf.domElement;var hc=bf.HelperMethods.aI(Kb,Yb.h(this.$).domElement,Yb.h(this.$).rtl);if(!hc)return aa.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const Ac=Yb.h(this.$).BJb();hc=new Sys.UI.Point(Math.round((hc.x-Ac.topLeft.x)*r),Math.round((hc.y-
Ac.topLeft.y)*r));r=new Sys.UI.Bounds(hc.x,hc.y,Math.round(Kb.offsetWidth*r),Math.round(Kb.offsetHeight*r));return Qa?this.ijf(r,M,la):r}xXf(){this.Brb.gA()}ijj(r){"ZoomToLevelInExcelLive"===r?this.zoomEventManager.vMj():this.zoomEventManager.uMj()}bSj(){this.zoomEventManager=this.$.ja.$c(419,new Eg)}izd(r,M,la,Qa,Kb,hc){hc=void 0===hc?"":hc;var Ac=Yb.h(this.$).rtl?0:Kb.x;Kb="ZoomWithPinch"===hc||"ZoomWithMouse"===hc?new Sys.UI.Point(r.x-Ac-Math.round(Qa.x*M),r.y-Kb.y-Math.round(Qa.y*M)):r;Kb=new Sys.UI.Point(Math.round(Kb.x/
M),Math.round(Kb.y/M));aa.ULS.shipAssertTag(537149770,0,!!M,"Original zoom level must be different than 0");Ac=la/M;Kb=new Sys.UI.Point(Math.round(Kb.x*(1-1/Ac)),Math.round(Kb.y*(1-1/Ac)));"ZoomWithMouse"===hc||"ZoomWithPinch"===hc?(Kb.x+=Math.round((Qa.x-Yb.h(this.$).gw)*(Ac-1)),Kb.y+=Math.round((Qa.y-Yb.h(this.$).VO)*(Ac-1))):(Ac=Math.round(Qa.x*(la-M)),0<Ac&&Kb.x>Ac&&(Kb.x+=Ac),M=Math.round(Qa.y*(la-M)),0<M&&Kb.y>M&&(Kb.y+=M));"ZoomWithMouse"===hc&&(r.x||(Kb.x=0),r.y||(Kb.y=0));r=Yb.h(this.$).BJb();
return new Sys.UI.Point(Kb.x+r.topLeft.x,Kb.y+r.topLeft.y)}Alh(){const r=[];mc.a.instance.We("Common.IGestureInputManager").execute(M=>{0===M.soi()&&M.AQj(document.body,new zg(this.$,this),r)})}wEj(){return this.AUc()&&(Cc.a.Br&&Cc.a.TEa(67)||this.$.Uyc)}ydk(r,M){Dh.a(this.$)?this.fae(r,M,this.dme,Wf.a.kcg):this.fae(r,M,this.zoomPerSheetId,this.vkb)}fae(r,M,la,Qa){la.remove(r);M!==Qa&&la.add(r,M)}Zxk(r){this.Ovg();this.$.xHc(Tg.a.KDa("TriggerImmediateZoomOperations"));this.QGk();this.ijj(r)}QGk(){this.u0i()?
this.$.Tj():this.Brb.gA();const r=this.Brb.Tvf("UpdateZoomStatusBar");r&&(r.innerText=this.V2b)}u0i(){const r=Me.a(this.$);return r?r.ep.sA===(Ia.a.iWa(this.$)?Ne.a.Xlb:this.$.Af+Ne.a.Vog):!1}kyk(r){Yb.h(this.$).vMk(r);this.nhh()}nhh(){const r=Rg.a(this.$);if(r)for(const M of Yb.h(this.$).ya.cz()){if(!M){aa.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!M.nm)continue;const la=M.Cl;if(la)for(let Qa=0;Qa<la.count;Qa++)if(2===
la.Gj(Qa).type){const Kb=r.lv(la.Gj(Qa).sk());Kb?(Kb.ima(!1),aa.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):aa.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else aa.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}Yob(){aa.ULS.shipAssertTag(507908166,0,Ia.a.gFa(),"GridDensityOptions should be enabled.");new uh(this.$)}};
Ja=Object(hb.__decorate)([Object(wb.d)(Db.ye),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(Db.xe)())],Ja);Object(da.a)(Ja,"ZoomManager",Sf.a,[]);class Fb extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){const r=new Ja(this.$,null);this.Vje(r);this.$.ja.$c(368,r);this.Df(r)}Vje(r){const M=yf.a(this.$);if(M){var la=M.$rc("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");r.lZb(la);r.SXb(M.p1b)}else aa.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ta(r){r.ja.$c(369,
new Fb(r))}}Object(da.a)(Fb,"ZoomManagerFactory",cb.a,[]);var rc=a(976);class Hc extends cb.a{constructor(){super();this.Dg()}create(){this.Df(new rc.a)}}Object(da.a)(Hc,"CommonUIJsServiceFactory",cb.a,[]);var $c=a(1051);class Hd{}Object(da.a)(Hd,"LokiTokenResult",null,[]);class Ud{constructor(r){this.x8b=r}Vyd(){const r=this.Rqi();return r?Ud.yJd?new Promise((M,la)=>{this.x8b.continueWith(()=>{this.x8b.Uk||this.x8b.vj?la(Error.create("Error downloading auth library")):this.x8b.result.xD("Loki",r).then(Qa=>
{Qa=za.AFrameworkApplication.fa.la("ForceLokiFallbackToACLPTokenIsEnabled")?this.Uqi():Qa.IsSuccess&&Qa.Token?Object.assign(new Hd,{isSuccess:!0,token:Qa.Token,errorMessage:null}):Object.assign(new Hd,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Qa)});M(Qa);return Qa})})}):Promise.resolve(Object.assign(new Hd,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Hd,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",
$c.a.umf())}))}Uqi(){const r=za.AFrameworkApplication.fa.Ta("LokiUserDataSignature")||"";return Object.assign(new Hd,{isSuccess:!0,token:r,errorMessage:null})}Rqi(){let r=null;const M=$c.a.spc();2===M?r=za.AFrameworkApplication.fa.Ta("LokiAADAppId"):1===M&&(r=za.AFrameworkApplication.fa.Ta("LokiMSAAppId"));return r}static get yJd(){return za.AFrameworkApplication.fa.la("IsO365CommercialHost")||za.AFrameworkApplication.fa.la("IsO365ConsumerHost")}}Object(da.a)(Ud,"LokiTokenManager",null,[406]);var wa=
a(544);class sa{get name(){return"Common.App.LivePersonaUtils"}init(){mc.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}dl(r){r.register(Ud,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").If().Rf(()=>new Ud(wa.a.As(r.We("Common.App.OAuth.IOAuthManager"))))}static main(){Tb.a.instance.Ul(new sa)}}Object(da.a)(sa,"LivePersonaUtilsPackage",null,[4,5]);class fc{constructor(r){this.Ena=this.xna=this.Ina=this.Hna=null;this.Gue=this.kse=this.Hue=this.qye=this.iC=
this.vR=!1;this.u6c=this.Mye=null;this.Aye=0;this.Fa=this.Jye=null;this.m9=r;this.dC=3;this.u5a=!0}initialize(r,M,la){this.Hna=this.kAd(r,M);this.Ina=CommonUIStrings.l_SavingStatus;this.xna=CommonUIStrings.l_ReadOnlyStatus;this.Ena=CommonUIStrings.l_ReviewModeStatus;this.m9&&this.m9.execute(Qa=>{Qa.Ibd(Object(Ka.a)(this,this.Q1b,"updateToSavingStatus"))});this.iC=!0;this.Fa=la;this.kse=this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}nma(r,
M){this.vR=r;this.dC=M;this.jY(this.u5a)}jY(r){!this.u5a&&r&&(this.Jye=new Date);this.u5a=r;this.Gue=!1;r=null;3===this.dC&&(r=this.u5a?this.Hna:this.Ina);this.mSh(r)}kAd(r,M){return r?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):M&&M.length?String.format(CommonUIStrings.l_SavedToStatus,M):CommonUIStrings.l_SavedStatus}Q1b(){this.jY(!1)}rri(){switch(this.dC){case 1:return this.xna;case 2:return this.Ena;default:return null}}getMode(){if(3!==this.dC)switch(this.dC){case 1:return"ReadOnly";
case 2:return"ReviewOnly";default:return null}return this.Gue?"FailedToSave":this.u5a?"Saved":"Saving"}hVi(r){return this.qye===this.vR&&this.Aye===this.dC&&this.Mye===r}Bod(r){appChrome.getHeaderApi().then(M=>{M.updateDocumentTitleStatus(this.vR,r,this.rri(),this.Jye,this.u5a,this.kse?M.getHeaderSaveStatusIconProps(this.getMode()):null);this.Hue=!0;return null});this.u6c=null}mSh(r){this.iC&&Na.c()&&!this.hVi(r)&&(!this.Hue&&this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.Bod(r):Mc.a.YWb()?(this.u6c&&aa.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.u6c=window.requestIdleCallback(()=>{this.Bod(r)})):window.requestAnimationFrame(()=>{this.Bod(r)}),this.qye=this.vR,this.Mye=r,this.Aye=this.dC)}}Object(da.a)(fc,"ReactSaveStatusUIHandler",null,[421]);class yd{constructor(r,M){this.ns=null;this.Hna=CommonUIStrings.l_SavedStatus;this.Ina=CommonUIStrings.l_SavingStatus;this.xna=CommonUIStrings.l_ReadOnlyStatus;
this.Ena=CommonUIStrings.l_ReviewModeStatus;this.D6b=M;this.m9=r;this.dC=3;this.tza=!0}pz(){this.m9&&this.m9.execute(r=>{r.Ibd(Object(Ka.a)(this,this.Q1b,"updateToSavingStatus"))});this.D6b.execute(r=>{this.ns=r})}nma(r,M){this.dC=M;3===M?this.jY(this.tza):2===M?this.$he(this.Ena):this.$he(this.xna)}Q1b(){this.jY(!1)}jY(r){this.tza=r;this.$he(this.tza?this.Hna:this.Ina)}$he(r){this.ns&&this.ns.sendMessage(qf.a.sAk,this.DCh(r))}DCh(r){const M={};M.StatusText=r;return M}}Object(da.a)(yd,"SaveStatusPostMessageHandler",
null,[421]);var Sd=a(125),Ie=a(61);class pf{constructor(r,M,la,Qa){this.Ena=this.xna=this.Ina=this.Hna=null;this.dNa=0;this.pJ=this.h7c=this.nLa=this.qWc=this.nOa=null;this.lh=r;this.wfa=M;this.m9=la;this.$m=Qa;this.ywe=!0;this.vR=!1;this.dC=3;this.tza=!0}initialize(r,M){if(!this.lh)return!1;this.Hna=this.kAd(r,M);this.Ina=CommonUIStrings.l_SavingStatus;this.xna=CommonUIStrings.l_ReadOnlyStatus;this.Ena=CommonUIStrings.l_ReviewModeStatus;this.pz();return!0}kAd(r,M){return r?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):M&&M.length?String.format(CommonUIStrings.l_SavedToStatus,M):CommonUIStrings.l_SavedStatus}pz(){this.wfa&&this.wfa.execute(r=>{r.nfh(Object(Ka.a)(this,this.a4e,"createStatusAndModeElements"));r.hfh(Object(Ka.a)(this,this.Lkk,"showHideSaveStatusElement"));r.Mwk&&this.a4e(null,null)});this.m9&&this.m9.execute(r=>{r.Ibd(Object(Ka.a)(this,this.Q1b,"updateToSavingStatus"))})}zA(){this.pJ&&this.lh&&this.lh.rL(this.pJ)}Lkk(r,M){this.nma("true"===M,this.dC)}nma(r,M){this.vR=
r;this.dC=M;this.qWc&&(this.qWc.style.display=this.vR||3===this.dC||!this.nOa?"none":"");this.nLa&&(this.nLa.style.display=this.vR||3===this.dC?"none":"",this.nLa.innerText=1===this.dC?this.xna:this.Ena,this.nLa.title=1===this.dC?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.h7c&&(this.h7c.style.display=this.vR||1===this.dC||!this.nOa&&!this.nLa?"none":"");this.pJ&&(this.pJ.style.display=this.vR||1===this.dC?"none":"",this.jY(this.tza),this.pJ.title=CommonUIStrings.l_SaveStatusTooltip)}a4e(r,
M){r=document.getElementById(bd.a.vzf);M&&M.gLk||!r||""===this.Hna||""===this.Ina||""===this.xna||""===this.Ena||(this.nOa=document.getElementById(bd.a.Nec),this.qWc=bd.a.nBa(r,"BreadcrumbAppModeDash","-",null,!1),this.nLa=bd.a.nBa(r,"BreadcrumbAppModeStatus",1===this.dC?this.xna:this.Ena,null,!1),this.MKg(this.nLa),this.h7c=bd.a.nBa(r,"BreadcrumbSaveStatusDash","-",null,!1),this.pJ=bd.a.nBa(r,"BreadcrumbSaveStatus",this.Hna,null,!1),this.MKg(this.pJ),this.nma(this.vR,this.dC))}Q1b(){this.jY(!1)}jY(r){this.tza=
r;this.TFk(this.tza?this.Hna:this.Ina)}TFk(r){!this.pJ||3!==this.dC&&2!==this.dC||(this.ywe&&!this.tza?(this.dNa=this.pJ.offsetWidth<this.dNa?this.dNa:this.pJ.offsetWidth,this.zCk(this.Ina),this.ywe=!1):this.pJ.innerText=r)}MKg(r){r.style.direction=this.$m?"rtl":"ltr";r.style.width="auto";r.style.textAlign=this.$m?"right":"left";r.style.display=this.vR?"none":"";r.setAttribute("Unselectable","on")}zCk(r){this.pJ&&(this.pJ.style.width="",this.pJ.innerText=r,this.dNa=this.pJ.offsetWidth<this.dNa?this.dNa:
this.pJ.offsetWidth,r=Sd.a.Wz(this.pJ),this.pJ.style.width=this.dNa-Ie.a.BI(r.paddingLeft)-Ie.a.BI(r.paddingRight)+1+"px")}}Object(da.a)(pf,"SaveStatusUIHandler",null,[421]);var If=a(113);class bg{constructor(){this.i7c=this.g6c=this.Wwb=this.$b=null;this.kG=()=>{const r=za.AFrameworkApplication.fa,M=!!za.AFrameworkApplication.ra.Pa&&4===za.AFrameworkApplication.ra.Pa.Cj;if(r.la("WordEditorAutoSaveImprovementIsEnabled")||r.la("PptEditorSaveStatusInHeaderEnabled")||M&&r.la("SimplifiedReactRibbonUxIsEnabled")||
r.la("ExcelSaveStatusInHeaderEnabled")||r.la("VisioSaveStatusInHeaderEnabled"))za.AFrameworkApplication.fa.la("PostMessageEmbedded")&&za.AFrameworkApplication.hideHeaderEmbedded?(this.i7c=this.$b.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.i7c.pz():za.AFrameworkApplication.ra.Pa.VKf||za.AFrameworkApplication.hideHeader||(za.AFrameworkApplication.ra.Pa.wu?(this.g6c=this.$b.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.g6c.initialize(r.la("IsSkyDrive"),r.Ta("HostNameToIncludeInSavedStatus"),
za.AFrameworkApplication.fa):(this.Wwb=this.$b.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.Wwb.initialize(r.la("IsSkyDrive"),r.Ta("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}dl(r){this.$b=r;za.AFrameworkApplication.fa.la("PostMessageEmbedded")&&za.AFrameworkApplication.hideHeaderEmbedded?this.$b.register(yd,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").If().Rf(()=>new yd(this.$b.We("Common.App.HostNotification.EditNotificationEventSource"),
this.$b.We("Postmessage.IHostPostmessenger"))):za.AFrameworkApplication.ra.Pa.VKf||(za.AFrameworkApplication.ra.Pa.wu?this.$b.register(fc,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").If().Rf(()=>new fc(this.$b.We("Common.App.HostNotification.EditNotificationEventSource"))):this.$b.register(pf,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").If().Rf(()=>new pf(If.EventHandlerManager.instance,this.$b.We("Common.App.Header.HeaderEventSource"),
this.$b.We("Common.App.HostNotification.EditNotificationEventSource"),za.AFrameworkApplication.isRtl)))}init(){za.AFrameworkApplication.fa.Xw(this.kG)}dispose(){this.Wwb&&this.Wwb.zA()}}Object(da.a)(bg,"PackageManager",null,[4,5]);var hg=a(242),dg=a(33);class pg{constructor(r,M){this.JEe=this.l1c=!1;this.sHa=(la,Qa)=>{(null===Qa||void 0===Qa?0:Qa.xM)&&dg.a.Bkh([Qa.xM])&&(this.QXb=!0)};this.Ep=()=>{this.QXb=!1};this.vg=(la,Qa)=>{hg.b(Qa)&&this.nma(!0);this.QXb=!1};this.Xg=()=>{this.DW=this.$.DW;this.nma()};
this.z6f=()=>{this.jY()};this.F5f=()=>{this.DW=this.$.DW};this.HUd=()=>{Yb.h(this.$).ya.Ot(this.HUd);this.DW=this.$.DW};this.Jqg=M;this.$=r;this.$.userOperationManager.pt(this.F5f);this.$.Go(this.Xg);this.$.ea.Ofh(this.z6f);this.$.ea.wn(this.vg);this.$.ucc(this.sHa);this.$.ea.cM(this.Ep);this.nma()}get v5i(){return this.$.ea?this.$.ea.SNf:!1}get DW(){return this.l1c}set DW(r){r?this.l1c=!0:Yb.h(this.$)&&Yb.h(this.$).ya&&(Yb.h(this.$).ya.w0()?this.l1c=!1:Yb.h(this.$).ya.Uu(this.HUd));this.jY()}get QXb(){return this.JEe}set QXb(r){this.JEe=
r;this.jY()}dispose(){this.$&&(this.$.Hp(this.Xg),this.$.pJc(this.sHa),this.$.userOperationManager&&this.$.userOperationManager.Nr(this.F5f),this.$.ea&&(this.$.ea.JWj(this.z6f),this.$.ea.En(this.vg),this.$.ea.yQ(this.Ep)),Yb.h(this.$)&&Yb.h(this.$).ya&&Yb.h(this.$).ya.Ot(this.HUd))}nma(r){r=!this.$.isEditMode||(void 0===r?!1:r);this.Jqg.nma(r,this.$.isEditMode?3:1);this.jY()}jY(){this.$.isEditMode&&this.Jqg.jY(!this.DW&&!this.v5i&&!this.QXb)}}Object(da.a)(pg,"SaveStatusManager",null,[2]);class Ug extends cb.a{constructor(r){super();
this.ug=r;this.Dg()}create(){const r=mc.a.instance;r.We("Common.App.SaveStatus.ISaveStatusUIHandler").execute(M=>{const la=new pg(this.ug,M);r.register(pg,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").If().Rf(()=>la);M=Object(pb.a)(this.ug.ja,300,()=>r.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.Df(M)})}static ta(r){r.ja.$c(299,new Ug(r))}}Object(da.a)(Ug,"SaveStatusFactory",cb.a,[]);var $g=a(997),ih=a(610);class Zf extends Sys.EventArgs{constructor(){super()}}
Object(da.a)(Zf,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var gh=a(42),Zg=a(652),Sg=a(169);class Ah{constructor(r){this.data=r}}Object(da.a)(Ah,"NumberFormatDataHolder",null,[]);var rh=a(220),Oa=a(284);class Mb extends qd.a{constructor(r,M){super();this.sNd=Wf.a.th;this.mgd=null;this.vrb=this.qzc=!1;this.AYf=(la,Qa)=>{var Kb;(la=Yb.h(this.$))&&(Qa=null!==(Kb=Qa.cell)&&void 0!==Kb?Kb:la.Pe(null))&&this.Vwa(Qa.cell.Ok,!0)};this.Eqj=la=>{this.isActive()&&(dg.a.wt(la.Errors)||!la.Result?(la=la.Errors?
la.Errors.map(Qa=>JSON.stringify(Qa)).join(","):"None",aa.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${la}`)):(la=la.Result,aa.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${la.Index}, category = ${la.Category}`),this.Yak(la.Index,la.Category),this.raiseEvent(Mb.bhd,new $g.a(la.Index,la.Category),this)))};this.refresh=()=>{aa.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");
this.Pfc();this.isActive()&&this.ea.ff.allowEdits&&(this.vrb||this.Qs&&!(this.ea.UP>this.sNd)?this.fUc():(aa.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Hyd=ih.a(this.$.oa.ua,this.Qs?this.Qs.Digest:"",this.lrj,this.krj,null,null)),aa.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.Apf())};this.e2f=la=>{aa.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${la.data.status}, HTTP status = ${la.data.httpStatus}.`);
this.FTa=null};this.h7=()=>{this.vrb=!1;this.ea.xG(this.h7);this.l0a(this.qzc?Mb.bbe:Mb.tTd)};this.vg=(la,Qa)=>{aa.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");hg.a(Qa)&&this.l0a(Mb.bbe)};this.ij=()=>{aa.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.ETd(0===this.$.workbookContext.CalcMode)};this.Xg=()=>{aa.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.l0a(Mb.bbe);3!==this.$.workbookContext.CalcMode&&this.ETd(0===this.$.workbookContext.CalcMode)};this.erj=(la,Qa,Kb)=>{aa.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.FTa=null;this.isActive()?la.StateId===Wf.a.th?(aa.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.fUc()):!la.Result||this.q3&&this.q3.length?this.l0a(Mb.tTd):this.Z5f(la,Qa,
Kb):aa.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.Z5f=la=>{this.q3=la.Result;aa.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.q3?this.q3.length:-1} functions.`);la=!1;if(this.q3){for(const Qa of this.q3)Qa&&(this.Qkf[Qa.NameUI.toLocaleUpperCase()]=Qa.FunctionIndex.toString(),Qa.NameUI!==Qa.NameDataStrings&&
(this.Qkf[Qa.NameDataStrings.toLocaleUpperCase()]=Qa.FunctionIndex.toString(),la=!0),this.jdi.da(Qa.FunctionIndex,Qa.NameUI));this.raiseEvent(Mb.fvd,Sys.EventArgs.Empty,this)}la&&aa.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.lrj=la=>{if(this.isActive())if(aa.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.qzc=!1,this.sNd=la.StateId,this.sNd===Wf.a.th)this.qzc=!0,this.fUc();else{if(la.Result){var Qa=
this.Qs;this.Qs=la.Result;aa.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Qs.Digest}.`);la=[];if(Qa)la=Mb.vri(Qa.NumberFormats,this.Qs.NumberFormats);else for(Qa=0;Qa<this.Qs.NumberFormats.length;Qa++)this.MCc.da(Qa,this.Qs.NumberFormats[Qa].NumberFormatCategory);for(const Kb of la)this.MCc.da(Kb,this.Qs.NumberFormats[Kb].NumberFormatCategory);this.raiseEvent(Mb.UTd,new Zf(la),this);this.raiseEvent(Mb.EPf)}this.l0a(Mb.tTd)}};this.krj=la=>{this.isActive()&&
(10===la.data.status?aa.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(aa.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${la.data.status}, HTTP status = ${la.data.httpStatus}.`),this.qzc=!0,this.fUc()))};aa.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=r;this.$=M;this.Qs=this.FTa=this.Hyd=this.FVb=null;this.MCc=new rh.a;this.UHb=new rh.a;this.q3=[];this.jdi=new rh.a;
this.Qkf={};this.ea.wn(this.vg);this.$.Go(this.Xg);Yb.h(this.$).ha.soa(this.AYf);this.ea.Jy(this.ij);this.l0a(Mb.BBf);aa.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Gbd(r){this.addHandler(Mb.UTd,r)}jJc(r){this.removeHandler(Mb.UTd,r)}Wch(r){this.addHandler(Mb.bhd,r)}lUj(r){this.removeHandler(Mb.bhd,r)}xMe(r){this.addHandler(Mb.fvd,r)}T3d(r){this.removeHandler(Mb.fvd,r)}Heh(r){this.addHandler(Mb.EPf,r)}get gi(){return this.Qs?this.Qs.LocaleInformation:null}get LGa(){return this.Qs?
this.Qs.NumberFormats:[]}get Zqa(){this.q3&&this.q3.length||this.Apf();return this.q3}get rQi(){return this.Qs&&void 0!==this.Qs.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Qs.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Qs.InstantaneousCalcWebWorkerPrecisionSamplingRate:Mb.pOh}get uQi(){return this.Qs&&void 0!==this.Qs.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Qs.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Qs.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:
Mb.tOh}get tQi(){return this.Qs&&void 0!==this.Qs.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.Qs.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Qs.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Mb.sOh}get sQi(){return this.Qs&&void 0!==this.Qs.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Qs.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Qs.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Mb.rOh}get zLb(){return this.Qs?
this.Qs.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Mb.qOh}get Nuc(){return null!==this.mgd?this.mgd:!1}uzk(r){let M;if(!r)return{returnValue:!0,category:"General"};let la;M="";if(!(()=>{let Qa=this.Vwa(r,!1);({category:la}=Qa);return Qa})().returnValue)return{returnValue:!1,category:M};M=this.RDh(la);return{returnValue:!0,category:M}}RDh(r){let M="";switch(r){case 0:M="General";break;case 1:M="Number";break;case 2:M="Currency";break;case 3:M="Accounting";break;case 4:M="Date";break;case 5:M=
"Time";break;case 6:M="Percentage";break;case 7:M="Fraction";break;case 8:M="Scientific";break;case 9:M="Text";break;case 10:M="Special";break;case 11:M="Custom"}return M}Vwa(r,M){let la,Qa=(()=>{let Kb=this.MCc.Ag(r,0);({value:la}=Kb);return Kb})().returnValue;!Qa&&0<r&&this.$&&(aa.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${r}`),this.Qii(r),M&&(la=this.Pii(r),Qa=!0),Zg.a(r,this.$.RI)&&
(la=6));return{returnValue:Qa,category:la}}FWi(r){let M=0;if((()=>{let la=this.Vwa(r,!0);({category:M}=la);return la})().returnValue)return 6===M;aa.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${r}`);return!1}Pbi(r){aa.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.FTa=Bd.p(this.$.oa.ua,{FilterType:0},Xc.b(this.Z5f,
r),this.e2f,null,null,null)}fkf(){this.l0a(Mb.BBf)}hHh(){return Object(Oa.c)(this.gi.ErrorNames)?(aa.ULS.shipAssertTag(508699781,0,!1,"ErrorNames undefined"),this.tli()):this.gi.ErrorNames.map((r,M)=>excelOnlineCalc.calc.errorTypeName(M+1,r))}tli(){const r=[],M=Object.keys(Wf.a.errorNames);for(let la=0;la<M.length;la++){const Qa=excelOnlineCalc.calc.errorTypeName(la+1,M[la]);Qa&&r.push(Qa)}return r}ETd(r){this.mgd=r}Qii(r){if(this.UHb&&this.$){var M;if(!(()=>{let Qa=this.UHb.Ag(r);({value:M}=Qa);
return Qa})().returnValue||M.isCompleted){aa.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${r}`);var la=ih.c(this.$.oa.ua,r,this.Eqj,null,null,null);la&&this.UHb.da(r,la)}}else aa.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}Pii(r){return 1<=r&&8>=r?1:9<=r&&12>=r?2:13===r||14===r?6:15===r?8:17===r|18===r?7:19===r?4:16===r||20<=r&&29>=r||31===r?11:30===r?9:32<=r&&35>=r?
3:0}isActive(){const r=void 0===this.ea||null===this.ea,M=!r&&this.ea.tf;aa.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${M} - sessionStateManager IsNullOrUndefined: ${r}`);return M}Yak(r,M){this.MCc.da(r,M)}dispose(){Ic.a.Sa(this.FVb);this.FVb=null;this.Pfc();for(const r of this.UHb){const M=r.value;M&&!M.isCompleted&&za.AFrameworkApplication.lg.Az(M.My)}this.UHb=null;this.ea&&(this.ea.En(this.vg),this.vrb&&this.ea.xG(this.h7),
this.vrb=!1,this.ea.pA(this.ij));this.ea=null;this.$&&Yb.h(this.$)&&Yb.h(this.$).ha&&(Yb.h(this.$).ha.cla(this.AYf),this.$.Hp(this.Xg));this.$=null;super.dispose()}isFeatureEnabled(r){try{switch(r){case "LocaleLongDateFormat":return ya.EwaSettings.Ia(184);case "GetLocaleDayNames":return ya.EwaSettings.Ia(185);case "OfficeVSO:3657744_CalcFixForDateFormat":return ya.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return ya.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");
case "CalcAutocompleteExperiment":return ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return ya.EwaSettings.Ia(101);default:return r.startsWith("OfficeVSO:")?ya.EwaSettings.isChangeGateEnabled(r):!1}}catch(M){return aa.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${r}): feature parsing failed, returning false. Exception: ${M.toString()}.`),
!1}}l0a(r){this.isActive()&&this.ea.ff.allowEdits?(Ic.a.Sa(this.FVb),this.FVb=null,this.FVb=na.a.instance.create(this.refresh,r,gd.a.vQi)):aa.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.ff&&null!==this.ea.ff?this.ea.ff.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}Apf(){aa.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.FTa?aa.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.q3&&this.q3.length||(this.FTa=Bd.p(this.$.oa.ua,{FilterType:0},this.erj,this.e2f,null,null,null)):aa.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}fUc(){this.vrb||(this.vrb=!0,this.ea.wF(this.h7))}Pfc(){this.Az(this.Hyd);this.Az(this.FTa);this.FTa=this.Hyd=null}Az(r){r&&
!r.isCompleted&&this.$.oa.ua.wqb(r.My)}static vri(r,M){if(!r||!r.length)return[];if(!M||!M.length){var la=Array(r.length);for(var Qa=0;Qa<r.length;++Qa)la[Qa]=r[Qa].IfmtIndex;return la}la=new rh.a;for(var Kb of r)la.da(Kb.IfmtIndex,new Ah(Kb));r=new Ya.a;for(Qa of M)Kb=la.Ag(Qa.IfmtIndex),{value:M}=Kb,Kb.returnValue&&M.data.FormatString===Qa.FormatString||r.add(Qa.IfmtIndex);return r.toArray()}}Mb.UTd="isim0";Mb.bhd="isim1";Mb.fvd="isim2";Mb.EPf="isim3";Mb.BBf=100;Mb.bbe=1E3;Mb.tTd=3E5;Mb.pOh=.001;
Mb.tOh=.1;Mb.sOh=.2;Mb.rOh=.001;Mb.qOh=50;Object(da.a)(Mb,"InstantaneousSupportInformationManager",qd.a,[396,2]);class sc extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){if(this.$){aa.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var r=Object(pb.a)(this.$.ja,268,()=>new Mb(this.$.ea,this.$));this.Df(r)}}static ta(r){if(!r)throw Error.argumentNull("ewaControl");r.ja.$c(246,new sc(r))}}Object(da.a)(sc,"InstantaneousSupportInformationManagerFactory",
cb.a,[]);var vc=a(600),vd=a(590),Qd=a(587),de=a(1108);class xe{fKh(r,M){if(r&&!(1>r.length)&&M){var la=Object.assign(new Qd.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.xHh(r,la.ControlList);M.push(la)}}xHh(r,M){const la=Object.assign(new vc.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new vd.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(M,la);M=Object.assign(new Qd.a,{Title:"",
ControlList:[]});Array.add(la.Menu.MenuSectionList,M);this.JJh(r,M.ControlList)}JJh(r,M){for(let la=0;la<r.length;la++){const Qa=Object.assign(new de.a,{ExternalId:String.format("CoauthorPersona_{0}",la),Command:"336231556",DisplayName:r[la].userName,LabelText:r[la].userName,ImageBackColor:r[la].color,PersonaId:r[la].email,IsAnonymous:r[la].isAnonymous});Array.add(M,Qa)}}}Object(da.a)(xe,"PresenceContextMenuSectionBuilder",null,[395]);var ef=a(593);class Ff{constructor(r,M,la,Qa){this.Dpe=this.b9=
this.ym=this.dJ=this.Xea=null;this.jmh=()=>{this.F$b.cSe()};this.Xy=Kb=>{1===Kb?(ef.a.t1(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),za.AFrameworkApplication.Oe.mi(zb.a.LNd,2)):(this.Wob(),za.AFrameworkApplication.Oe.mi(zb.a.oWe,2))};this.Jrh=()=>{this.SRh();za.AFrameworkApplication.Oe.mi(zb.a.nWe,2)};this.F$b=r;this.I5g=Qa;this.F$b.rsa&&(this.ym=new Qe.a(3,2,5E3,this.jmh,2),za.AFrameworkApplication.jl.Li(this.ym),this.ik(M,la));this.F$b.YOa(()=>{this.gZf()});this.F$b.eAa(()=>
{this.hZf()})}get businessBar(){return this.b9||(this.b9=mc.a.instance.pj("CommonUI.IBusinessBar"))}get vUe(){return this.Dpe||(this.Dpe=mc.a.instance.pj("CommonUI.IBusinessBarEntryFactory"))}ik(r,M){const la=za.AFrameworkApplication.Oe;la.ji(zb.a.authenticationLost,Rb.a.frame,r,96);la.ji(zb.a.dSe,Rb.a.frame,M,96);la.hf(zb.a.nWe,Rb.a.frame,kb.ActionManager.Pod);la.hf(zb.a.oWe,Rb.a.frame,kb.ActionManager.Pod);la.hf(zb.a.LNd,Rb.a.frame,kb.ActionManager.Pod)}gZf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
za.AFrameworkApplication.Oe.mi(zb.a.authenticationLost,2)}hZf(){this.xtk();za.AFrameworkApplication.Oe.mi(zb.a.dSe,2)}xtk(){this.dJ&&(this.dJ.hide(),this.dJ.dispose(),this.dJ=null);this.Xea&&this.businessBar&&(za.AFrameworkApplication.Oi||this.businessBar.removeEntry(this.Xea),this.Xea.dispose(),this.Xea=null)}showDialog(r){Ic.a.Sa(this.dJ);this.dJ=new Bc.StandardDialog;this.I5g||(this.dJ.ay=!1,this.dJ.Ye=0);this.dJ.uf(1,CommonUIStrings.l_SignIn);this.dJ.$X(CommonUIStrings.l_DefaultDialogTitle,r,
this.Xy)}Wob(){this.businessBar&&this.vUe&&(this.Xea=this.vUe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Xea.closeable=!0,this.Xea.addButton(CommonUIStrings.l_SignIn,Ff.Hrh,""),this.Xea.aaa=this.Jrh,this.businessBar.RA(this.Xea,!1))}SRh(){this.ym&&(za.AFrameworkApplication.jl.At(this.ym),this.ym=null)}dispose(){this.ym=this.dJ=this.Xea=null}static Hrh(){ef.a.t1();za.AFrameworkApplication.Oe.mi(zb.a.LNd,2)}}Object(da.a)(Ff,"SignOutResponseUI",
null,[2]);class xf{get name(){return"Common.App.UI"}dl(r){r.register(xe,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").If()}init(){}dispose(){Ic.a.Sa(xf.U9);xf.U9=null}static main(){Tb.a.instance.Ul(new xf)}}xf.U9=null;Object(da.a)(xf,"CommonAppUIPackage",null,[4,5]);var cg=a(34),Bf=a(230),Mf=a(23),ah=a(1168),Eh=a(188),Uh=a(304),sh=a(266),oh=a(85),Wh=a(95),vh=a(157);let Qh=class{constructor(r,M,la){this.cXa=1;this.fga=[];this.active=!1;this.wf=
null;this.onPointerDown=Qa=>{this.gridView.setLastInputMethod(Qa.Ga.rawEvent);return!1};this.CB=()=>{const Qa=this.gridView.kBd();if(!(0>=Qa||Qa===this.cXa||this.gridView.vv)){var Kb=!1,hc=[],Ac=[];for(var Zc=this.fga.length-1;0<=Zc;Zc--){var Ad=this.fga[Zc];if(this.jBd(Ad)>Qa||Ad.bottom<Qa)hc.push(Ad),this.fga.splice(Zc,1),Kb=!0}for(Zc=this.Ug.rangeList.length-1;0<=Zc;Zc--){Ad=this.Ug.rangeList[Zc];const re=this.jBd(Ad);re<=Qa&&Ad.bottom>=Qa&&!(re<=this.cXa&&Ad.bottom>=this.cXa)&&Ad.Sra&&(Ac.push(Ad),
Kb=!0)}if(Kb){Ad=this.gridView.MFc;for(const re of Ad)for(const Ge of re)for(const kf of Ge)this.Kwc?this.dxh(kf,hc,Ac):this.exh(kf,hc,Ac,Kb)}else aa.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.cXa=Qa}};this.K2f=(Qa,Kb)=>{Kb.isRow||Kb.hcd(this.jtc)};this.L2f=(Qa,Kb)=>{Kb.isRow||(this.Ug.rangeList.length||this.deactivate(),Kb.y4d(this.jtc))};this.jtc=(Qa,Kb)=>{if(this.hh())this.activate();else if(Qa=this.active,this.deactivate(),
!Qa){aa.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Kb=Kb.ez)&&this.zBg(Kb.Eba,Kb)};this.G5f=(Qa,Kb)=>{!this.gridView.vv&&(this.hh()?this.activate():(Qa=this.active,this.deactivate(),Qa||aa.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Kb=Kb.ez)&&(Qa=ah.a(Kb.Eba),this.zBg(Qa,Kb)&&Kb.n$d(Qa))};this.vh=()=>{this.gridView.Be.BS?this.deactivate():
this.activate()};this.Ug=r;this.gridView=M;this.$=M.$;this.wf=la;r.Tbd(this.G5f);M.beh(this.K2f);M.ceh(this.L2f);this.$.sa.Vj(this.vh);this.$.nf.Vj(this.vh);this.AQe(Qa=>{Qa.hcd(this.jtc)});this.hh()&&(this.activate(),this.CB(this,null));this.$.ja.$c(68,this)}dispose(){this.deactivate();this.gridView&&(this.Ug.m4d(this.G5f),this.gridView.hVj(this.K2f),this.gridView.iVj(this.L2f),this.$.sa.vk(this.vh),this.$.nf.vk(this.vh),this.AQe(r=>{r.y4d(this.jtc)}));this.gridView=this.Ug=this.fga=null}get Kwc(){return this.gridView.$F}cRc(r,
M,la){if(!Dg.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.Be.dKa)return M&&aa.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const Qa=la.tvf();if(ya.EwaSettings.oId()&&!Qa)return aa.ULS.sendTraceTag(508368917,0,15,`HeaderSnappingFeature.toggleHeaderSnapping: HeaderNumbers should have been initialized, isActivate=${M}, headerViewBlock.hashCode=${la.hashCode}`),!1;var Kb=
Qa.length;if(Qa[Kb-1]<r.left)return!1;var hc=bf.HelperMethods.SD(new Bf.a(Qa),0,Kb,r.left,bf.HelperMethods.EK);if(0>hc)return!1;const Ac=r.Bge,Zc=r.nSe;Kb=Math.min(Ac.length+hc,Kb);let Ad=0;if(!Zc)return aa.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;hc<Kb;hc++){const re=Qa[hc],Ge=Zc[Ad];M?(la.updateCellText(hc,Ac[Ad]),la.updateCellAlignment(hc,!0),ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8133326_fixAceRegressionInAutoFilterMenu")?
Ge&&(la.activateCellAutoFilter(hc,Ge),this.Iad(r,Ad,re)):(la.activateCellAutoFilter(hc,Ge),this.Iad(r,Ad,re)),ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&la.kLg(hc,!0)):(la.updateCellText(hc,Mf.Range.EV(re)),la.updateCellAlignment(hc,!1),la.deactivateCellAutoFilter(hc),ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&la.kLg(hc,!1),this.r9e(re));M&&la.W$j();Ad++}la.Ip("HeaderSnappingFeature::toggleHeaderSnapping");
r.BJa=M;return!0}dRc(r,M,la,Qa){if(!Dg.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.Be.dKa)return!0;if(!la.length)return!1;var Kb=Qa.length;if(Qa[Kb-1]<r.left)return!1;var hc=bf.HelperMethods.SD(new Bf.a(Qa),0,Kb,r.left,bf.HelperMethods.EK);if(0>hc)return!1;const Ac=r.Bge,Zc=!!r.F9a&&0<r.F9a.length,Ad=!!r.menuModel&&0<r.menuModel.length;for(let kf=hc,sf=0,Lf=Math.min(Ac.length+hc,Kb);kf<Lf;kf++,sf++)if(Kb=la[kf]){var re=null;(hc=Kb.getElementsByClassName(cg.a.dsd))&&(re=hc[0]);if(re&&
re.innerText){if(hc=Kb.getElementsByClassName(cg.a.hOe))for(var Ge=hc.length-1;0<=Ge;Ge--)Kb.removeChild(hc[Ge]);hc=Qa[kf];M?(re.innerText=Ac[sf],Kb.classList.add(cg.a.iff),Zc&&r.F9a[sf]&&(re=document.createElement("div"),this.wf.tm(re,r.F9a[sf]),Ge=r.F9a[sf].split(oh.a.Nih),3===Ge.length?(Ge=Wh.a.si(Ge[1]),this.mKe(re.firstChild,Ge),Eh.a.instance.va(le.a.oj,re.firstChild,this.onPointerDown),Uh.a.instance.va(le.a.Lt,re.firstChild,this.onPointerDown)):(Ge=new vh.a(this.$.sa),(Ge.hh(2048)||Ge.hh(4096))&&
aa.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.mKe(re.firstChild,null)),Ad&&r.menuModel[sf]&&this.Iad(r,sf,hc),Kb.appendChild(re.firstChild))):(Kb.classList.remove(cg.a.iff),re.textContent=Mf.Range.EV(hc),this.r9e(hc))}}r.BJa=M;return!0}mKe(r,M){sh.a.instance.va(le.a.click,r,la=>{if(M){const {row:Qa,col:Kb}=bf.HelperMethods.vwi(M);this.gridView.Mog(la.Ga.rawEvent,966232027,M,this.$.get_id(),
Qa,Kb)}return!0})}Iad(r,M,la){this.$.ja.Ne(8,Qa=>{Qa.Rnc.Esj(r,M,la)})}r9e(r){this.$.ja.Ne(8,M=>{M.Rnc.Fsj(r)})}exh(r,M,la,Qa){const Kb=r.dy,hc=ah.a(r.Eba);let Ac;for(let Zc=M.length-1;0<=Zc;Zc--)Ac=M[Zc],this.dRc(Ac,!1,hc,Kb)&&M.splice(Zc,1);for(M=la.length-1;0<=M;M--)Ac=la[M],this.dRc(Ac,!0,hc,Kb)&&this.fga.push(Ac);Qa&&r.n$d(hc)}dxh(r,M,la){if(r.auh()){for(var Qa=M.length-1;0<=Qa;Qa--)this.cRc(M[Qa],!1,r)&&(aa.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),
M.splice(Qa,1));for(M=la.length-1;0<=M;M--)Qa=la[M],this.cRc(Qa,!0,r)&&(aa.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.fga.push(Qa))}else aa.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}zBg(r,M){const la=this.Kwc?M.tvf():M.dy;if(ya.EwaSettings.oId()&&!la)return aa.ULS.sendTraceTag(508368916,0,15,`HeaderSnappingFeature.snapHeadersAfterGetRange: HeaderNumbers should have been initialized, headerViewBlock.hashCode=${M.hashCode}`),
!1;var Qa=la[0];const Kb=la[la.length-1],hc=this.rAi(Qa,Kb);let Ac=!1;for(let Zc=this.fga.length-1;0<=Zc;Zc--){const Ad=this.fga[Zc];Kb>=Ad.left&&Qa<=Ad.right&&(this.Kwc?this.cRc(Ad,!1,M):this.dRc(Ad,!1,r,la),this.fga.splice(Zc,1),Ac=!0)}for(let Zc=0,Ad=hc.length;Zc<Ad;Zc++)if(Qa=hc[Zc],this.Kwc?this.cRc(Qa,!0,M):this.dRc(Qa,!0,r,la))this.fga.push(hc[Zc]),Ac=!0;return Ac}activate(){this.hh()&&!this.active&&(this.gridView.view.Fv(this.CB),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Fu(this.CB),
this.active=!1)}hh(){return Dg.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.Be.dR&&0<this.Ug.rangeList.length}AQe(r){const M=this.gridView.MFc;for(const la of M)for(const Qa of la)for(const Kb of Qa)r(Kb)}rAi(r,M){const la=[];if(!this.active)return la;this.cXa=this.gridView.kBd();for(let Qa=this.Ug.rangeList.length-1;0<=Qa;Qa--){const Kb=this.Ug.rangeList[Qa];Kb.bottom>=this.cXa&&this.jBd(Kb)<=this.cXa&&Kb.left>=r&&Kb.right<=M&&Kb.Sra&&la.push(Kb)}return la}jBd(r){const M=this.gridView.Je.gj(r);
return M&&this.Ug.cHf(r,M.usedRange.topLeft)?r.top+1:r.top}};Qh=Object(hb.__decorate)([Object(wb.d)(Db.cc),Object(hb.__param)(0,Object(Db.ie)()),Object(hb.__param)(1,Object(Db.bc)()),Object(hb.__param)(2,Object(Db.fc)())],Qh);Object(da.a)(Qh,"HeaderSnappingFeature",null,[2]);class yh extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){const r=Object(td.d)(wb.a.resolve(Db.ie,{Aa:this.$a})),M=Object(td.d)(wb.a.resolve(Db.fc,{Aa:this.$a}));zd.TaskExtensions.Ca(zd.TaskExtensions.Dh([M],this.qa),
()=>{zd.TaskExtensions.Ca(zd.TaskExtensions.Dh([r],this.qa),()=>{this.Df(this.$.ja.Qa(68)||new Qh(r.result,Yb.h(this.$),M.result))},this.qa,11)},this.qa,3)}static ta(r){r.ja.$c(67,new yh(r))}}Object(da.a)(yh,"HeaderSnappingFactory",cb.a,[]);var Kh=a(183),jh=a(642);class Xh extends jh.a{constructor(){super()}dispose(){Kh.WacAirSpace.DGd()&&Kh.WacAirSpace.aRc()}animate(r,M,la,Qa,Kb){M&&Kh.WacAirSpace.iU(r.element,M);Kh.WacAirSpace.animate(r,Qa,Kb);la&&Kh.WacAirSpace.xSj(r.element,la)}}Object(da.a)(Xh,
"AnimationManager",jh.a,[2]);var Tf=a(105);new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,
3,.8,0,.2,1);new c(21,3,.8,0,.2,1);k.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),jZk:new b(0,null),jQk:new b(0,null),operationType:0};var Ag=Array(1);Ag[0]=new b(0,0);new m(0,[new k(5,0,0,0,null,1,1,0)]);new m(1,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,50,null,1,1,0)]);new m(2,[new k(1,3,0,167,null,0,1,1),new k(2,3,0,167,null,0,1,1)]);new m(3,[new k(3,3,0,167,null,0,1,1),new k(4,3,0,167,null,0,1,1)]);new m(4,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,167,null,1,1,0)]);new m(5,[new k(5,
2,0,167,null,0,1,0)]);new m(6,[new k(1,3,0,100,null,0,1,1),new k(2,3,0,100,null,0,1,1)]);new m(7,[new k(3,3,0,100,null,0,1,1),new k(4,3,0,100,null,0,1,1)]);new m(8,[new k(5,2,0,100,null,1,1,0)]);new m(9,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,100,null,1,1,0)]);new m(10,[new k(5,2,0,100,null,0,1,0)]);new m(11,[new k(1,3,0,267,null,0,1,1),new k(2,3,0,267,null,0,1,1)]);new m(12,[new k(3,3,0,267,null,0,1,1),new k(4,3,0,267,null,0,1,1)]);new m(13,[new k(5,2,0,267,null,1,1,0)]);new m(14,[new k(5,2,0,0,null,
0,2,0),new k(5,2,0,267,null,1,1,0)]);new m(15,[new k(5,2,0,267,null,0,1,0)]);new m(16,[new k(6,3,0,267,null,0,1,1),new k(7,3,0,267,null,0,1,1)]);new m(17,[new k(1,3,0,750,null,0,1,1),new k(2,3,0,750,null,0,1,1)]);new m(18,[new k(3,3,0,750,null,0,1,1),new k(4,3,0,750,null,0,1,1)]);new m(19,[new k(5,2,0,750,null,1,1,0)]);new m(20,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,750,null,1,1,0)]);new m(21,[new k(6,3,0,1E3,null,0,1,1),new k(7,3,0,1E3,null,0,1,1)]);new m(22,[new k(1,3,0,367,null,0,1,1),new k(2,
3,0,367,null,0,1,1)]);new m(23,[new k(3,3,0,367,null,0,1,1),new k(4,3,0,367,null,0,1,1)]);new m(24,[new k(5,2,0,367,null,1,1,0)]);new m(25,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,367,null,1,1,0)]);new m(26,[new k(5,2,0,367,null,0,1,0)]);new m(27,[new k(6,2,0,Ag[0],null,0,1,1),new k(7,2,0,Ag[0],null,0,1,1)]);new m(28,[new k(5,2,0,0,null,1,1,0),new k(5,2,0,50,null,0,1,0)]);new m(29,[new k(1,3,0,433,null,0,1,1),new k(2,3,0,433,null,0,1,1)]);new m(30,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,50,null,1,1,
0),new k(2,3,0,0,null,40,1,1),new k(2,3,0,100,null,0,1,1)]);new m(31,[new k(2,0,0,0,null,32,1,1),new k(2,0,0,100,null,32,1,1),new k(2,3,101,350,null,0,1,1),new k(3,0,0,0,null,0,2,1),new k(3,0,0,100,null,0,2,1),new k(3,3,101,350,null,0,1,1),new k(5,0,0,0,null,0,2,0),new k(5,0,0,100,null,1,1,0)]);new m(32,[new k(2,3,0,267,null,32,1,1),new k(3,3,0,267,null,0,2,1),new k(5,2,0,0,null,1,0,0),new k(5,2,0,267,null,0,2,0)]);new m(33,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,100,null,0,2,0),new k(5,2,101,267,
null,1,1,0)]);new m(34,[new k(1,10,0,300,null,0,1,1),new k(2,10,0,300,null,0,1,1)]);new m(35,[new k(3,10,0,300,null,0,1,1),new k(4,10,0,300,null,0,1,1)]);new m(36,[new k(1,8,0,750,null,0,1,1),new k(2,8,0,750,null,0,1,1)]);new m(37,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,200,null,0,2,0),new k(5,3,201,500,null,1,1,0)]);new m(38,[new k(1,2,0,0,null,0,2,1),new k(2,2,0,0,null,0,2,1),new k(1,2,0,200,null,0,2,1),new k(2,2,0,200,null,0,2,1),new k(1,3,201,267,null,0,1,1),new k(2,3,201,267,null,0,1,1)]);new m(39,
[new k(1,3,0,267,null,0,1,1),new k(2,3,0,267,null,0,1,1)]);new m(40,[new k(5,2,0,0,null,0,2,0),new k(5,2,0,267,null,1,1,0)]);new m(41,[new k(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(r){window.setTimeout(r,16)};d.prototype={Fi:null,Dih:5,Rzb:null,Rcd:0,startTime:null,
duration:null,Nlc:null,Eed:-1,MRd:-1,kRd:-1};d.prototype.Start=function(){this.startTime=new Date;this.Nlc={}};d.prototype.GetRecentAnimationStats=function(){for(var r=[],M=0,la=Bh.Rcd;la<Bh.Dih;la++)null!=Bh.Rzb[la]&&(r[M]=Bh.Rzb[la],M++);for(la=0;la<Bh.Rcd;la++)null!=Bh.Rzb[la]&&(r[M]=Bh.Rzb[la],M++);return r};d.prototype.GetAnimationSqmStats=function(){var r=[];return 0>Bh.Eed?r[0]=0:r[0]=Bh.Eed,0>Bh.MRd?r[1]=0:r[1]=Bh.MRd,0>Bh.kRd?r[2]=0:r[2]=Bh.kRd,r};var Bh=new d,ea=a(86),Ab=a(202);class pc{constructor(){this.qFe=
this.y7c=!1;this.JYa=()=>{Ab.a.instance.s4d(this.JYa);aa.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.fGi()};this.i7f=()=>{Ab.a.instance.r4d(this.i7f);this.qFe||this.y7c||(aa.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.qFe=!0,this.hmk())};const r=za.AFrameworkApplication.accessTokenTtl;0>=r||(this.accessTokenTtl=r,aa.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:za.AFrameworkApplication.tH}),Ab.a.instance.$bd(this.JYa),Ab.a.instance.Ybd(this.i7f))}fGi(){this.y7c||(za.AFrameworkApplication.ty(ea.a.ZLc),this.y7c=!0,this.gmk())}}Object(da.a)(pc,"ASessionExpirationManager",null,[]);var wc=a(13),Ld=a(47),ee=a(264),Pe=a(92),cf=a(269);class vf extends pc{constructor(r){super();this.Va=new qd.a;this.ZJ=this.Mxb=!1;this.$=r}bNe(r){this.Va.addHandler("SessionExpired",r)}lzb(r){this.Va.addHandler("TokenRefreshed",r)}oJc(r){this.Va.removeHandler("TokenRefreshed",
r)}get accessTokenExpiringMessage(){const r=(new Date(this.accessTokenTtl)).format(this.$.xa.ShortTimeFormat);return String.format(wc.a.instance.He(78),r)}get Pge(){return this.Mxb}get Eob(){return!1}get oca(){return!1}get m2d(){return!1}get rca(){return!1}ftc(){return Ab.a.instance.MP(za.AFrameworkApplication.accessTokenTtl)}dispose(){Ic.a.Sa(this.Va);this.$=null}hmk(){this.$.isEditMode&&this.ysc(!1)}gmk(){this.Mxb=!0;this.ysc(!0);this.Va.raiseEvent("SessionExpired")}ysc(r){aa.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${r}, GotDeploymentOrTimedOutError ${this.$.ea.Q5}`);const M=this.$.Le.$r;r&&M&&M.isVisible&&1299163859===M.error.MessageId&&this.$.Le.$r.ZA();const la=this.Fg(r);Ld.a(this.$).Cu(new ee.a(se.a.az,5,()=>{const Qa=Cb.a(this.$),Kb=Qa.Ig.activityState;Kb[Pe.a.f$]=this.$.hBb(this.$.isEditMode);Kb[Pe.a.IR]=Pe.a.cjb;Kb[cf.a.Hs]=se.a.accessTokenExpiringWarning;Qa.Ig.Tu([la])}))}Fg(r){return r?dg.a.dmd():this.aLh()}aLh(){const r=
dg.a.Fg(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");r.Description=this.accessTokenExpiringMessage;return r}}Object(da.a)(vf,"EwaAccessTokenExpirationManager",pc,[397,398,2]);var Ef=a(185),ca=a(77),ra=a(693);class Gb{constructor(r,M){this.GVb=!1;this.correlationID=r;this.tmd=M;this.iRc=!1;this.creationTime=cd.a.Ae.yf}}Object(da.a)(Gb,"RefreshAccessTokenContext",null,[]);var tc=a(63),wd=a(168),he=a(124),Re=a(143),ff=a(162),jf=a(38),zf=a(136);class Qf{}Object(da.a)(Qf,"Error",null,[]);class Kf{}
Object(da.a)(Kf,"NamedResult",null,[]);class Gf extends Kf{}Object(da.a)(Gf,"ErrorInfo",Kf,[]);class lg{constructor(r,M){this.oac=r;this.GL=M}get tokens(){return this.oac}get errors(){return this.GL}}Object(da.a)(lg,"TokenRefreshArgs",null,[401]);class Hf{constructor(r,M){this.documentVisibilityObserver=null;this.Va=new qd.a;this.yH=null;this.tpb=this.Hwb=!1;this.fIc=null;this.OVb=!1;this.CPd=!0;this.oye=this.Fxe=this.ZJ=this.Mxb=!1;this.AY=null;this.Oi=!1;this.Lxf=()=>{if(this.$.ea.tf)this.fyf(!1);
else if(this.CPd){this.CPd=!1;const la=Cb.a(this.$);aa.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${la.ul?la.ul.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.RFg()}]`)}};this.vg=(la,Qa)=>{this.context&&(la=this.$.ea,Qa.hI&&this.context.GVb&&!this.context.iRc?(this.context.iRc=!0,Qa={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Qa.IsUserActive=
la.Ti.It,Qa.RefreshAccessTokenCorrelationID=this.context.correlationID,Qa=tc.a.Vf(Qa),aa.ULS.sendTraceTag(537170708,0,50,Qa)):!this.Hwb||la.tf||this.context.tmd||(Qa={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.yH&&(this.yH.cancel(),Qa.Aborted=!0,Qa.ResetStopRefreshRetriesUntilTokenExpired=!0,this.tpb=!1),Qa.TimeUntilTokenExpirationInMin=this.RFg(),Qa.RefreshAccessTokenCorrelationID=this.context.correlationID,Qa=tc.a.Vf(Qa),
aa.ULS.sendTraceTag(572019856,0,50,Qa)))};this.jHa=()=>{if(this.context&&this.context.GVb&&!this.context.iRc){var la={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};la.CreatedForExpired=this.context.tmd;la.RefreshAccessTokenCorrelationID=this.context.correlationID;la.OpenWorkbookErrors=dg.a.xf(this.$.ea.KK);la.ExecutionContextErrors=dg.a.xf(Cb.a(this.$).Ig.errors);la.accesstokenTTL=za.AFrameworkApplication.accessTokenTtl;la=tc.a.Vf(la);aa.ULS.sendTraceTag(537170707,0,15,la)}};
this.eyf=()=>{this.tpb=!1;this.fyf(!0)};this.kXd=()=>{this.OVb&&(this.$.ea.Ti.vIa(this.kXd),this.OVb=!1);this.oCg()};this.$=r;this.Rge=M;this.k2d=r.Ve.wj("WebServiceCall","refreshToken");Ab.a.instance.$bd(this.eyf);Ab.a.instance.Ybd(this.Lxf);M=this.$.ea;M.wn(this.vg);M.vcc(this.jHa);this.ifj=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.rxg=this.$.xa.ShortAccessTokenExpirationPromptSeconds;this.thg=this.$.xa.RefreshAccessTokenDurationLimitInSec;this.mMg(r.ea.o$f,za.AFrameworkApplication.accessTokenTtl);
r=JSON.stringify({["AccessTokenTtl"]:za.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:za.AFrameworkApplication.tH,["WopiTokenExpiresAfterMinutes"]:za.AFrameworkApplication.pxa,["WopiTokenTaskItemPriority"]:za.AFrameworkApplication.Ole});aa.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${r}`);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void wb.a.resolve(Db.db).then(la=>
{this.documentVisibilityObserver=la}):this.$.ja.Ne(291,la=>{this.documentVisibilityObserver=la})}bNe(r){this.Va.addHandler("SessionExpired",r)}lzb(r){this.Va.addHandler("TokenRefreshed",r)}oJc(r){this.Va.removeHandler("TokenRefreshed",r)}get Pge(){return this.Mxb}get oca(){return this.Fxe}get rca(){return this.oye}get context(){return this.AY}get Eob(){return this.rca?!1:this.$.ea.Ti.It?1>zf.a.Pca:6>zf.a.Qca}get m2d(){return this.Hwb}ftc(){return Ab.a.instance.MP(za.AFrameworkApplication.accessTokenTtl)}dispose(){Ab.a.instance.s4d(this.eyf);
Ab.a.instance.r4d(this.Lxf);const r=this.$.ea;r&&(r.En(this.vg),r.qJc(this.jHa));Ic.a.Sa(this.Va);this.documentVisibilityObserver=this.$=null}RFg(){return this.ftc()?0:(za.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}mMg(r,M){if(0<M&&!this.ftc()){const la=za.AFrameworkApplication.fa.Ng("AccessTokenExpirationPromptSeconds",za.AFrameworkApplication.WL),Qa=(M-r.getTime())/6E4;aa.ULS.shipAssertTag(537170713,0,0<=Qa,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${M}] creationTime [${r.getTime()}] tokenLifetimeInMin [${Qa}]`);
Qa<this.ifj?(aa.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.rxg}] tokenLifetimeInMin [${Qa}]`),za.AFrameworkApplication.WL=this.rxg):za.AFrameworkApplication.WL!==la&&(aa.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${la}] tokenLifetimeInMin [${Qa}]`),za.AFrameworkApplication.WL=la)}}tFh(r){return!this.context||
this.context.GVb||this.context.tmd!==r?(r=new Gb(Ef.a.create().toString(),r),this.context&&!this.context.iRc&&aa.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${r.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.GVb}] `),this.AY=r,!0):!1}n_j(r){r&&this.ZJ&&!this.oca&&this.$.ea.Ti.It&&!this.rca&&(this.ZJ=!1)}fyf(r){this.n_j(r);if(!(this.Hwb||this.tpb&&!r||this.ZJ)&&this.Eob){this.Hwb=
!0;var M=this.context?this.context.creationTime:null,la=this.tFh(r);this.CPd=!0;var Qa=this.$.ea;this.Oi=za.AFrameworkApplication.Oi;var Kb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Kb.newContextCreated=la;Kb.IsUserActive=Qa.Ti.It;Kb.IsSessionActive=Qa.tf;Kb.ContainsChangesWorkbookOperations=this.$.userOperationManager.XQa();Kb.isSessionExpired=r;Kb.stopRefreshRetriesUntilTokenExpired=this.tpb;Kb.FailedToRefreshExpiredToken=this.ZJ;Kb.numOfFailuresWhileUserIsActive=zf.a.Pca;
Kb.numOfFailuresWhileUserIsInActive=zf.a.Qca;Kb.numOfFailuresWhileOffline=zf.a.KGa;Kb.RefreshAccessTokenCorrelationID=this.context.correlationID;Kb.isShuttingDown=this.Oi;la&&M&&(Kb.TimeInMinFromPreviosContextCreation=Math.round(Re.b(cd.a.Ae,M)/60));M=tc.a.Vf(Kb);aa.ULS.sendTraceTag(40416199,0,50,M);if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SkipSessionExpiredVetoForShutdown",!1)&&this.Oi)aa.ULS.sendTraceTag(508126686,0,15,M);else{this.k2d.start();this.Fxe=Qa.Ti.It;this.yH=new ra.a;
this.h7i(r);var hc=this.Rge.RPj(!r,this.yH?this.yH.token:null);hc.continueWith(()=>{this.Uxh();const Ac=this.Rge.qJj(hc);this.k2d.stop();const Zc=this.ftc();if(!Ac||ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Zc){const Ad=hc.result.errors;Ac&&Zc&&this.N$g(Ad);this.KFi(Ad,r)}else this.tpb=!1,this.QFi(hc.result.tokens,r);this.Hwb=!1},8)}}}N$g(r){const M=[Object(V.a)(new Qf,{Id:"200",Details:"Expired access token received on successful token request."})];r.add(Object(V.a)(new Gf,
{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:M}))}h7i(r){r&&(this.$.ea.Ti.It?this.oCg():(this.$.ea.Ti.hAa(this.kXd),this.OVb=!0))}oCg(){this.fIc=wd.AsyncMethodContext.Rx(()=>{this.QPj()},1E3*this.thg,gd.a.tPj,this.fIc)}Uxh(){this.fIc&&this.fIc.cancel();this.OVb&&(this.$.ea.Ti.vIa(this.kXd),this.OVb=!1);this.yH=null}QPj(){aa.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.thg}]`);this.yH.cancel()}KFi(r,M){this.tpb=
!0;M&&(this.ZJ||(this.Mxb=this.ZJ=!0),this.Rge.ENb(r)&&(this.oye=!0));const la=!M||this.Eob&&!zf.a.LNc?40380379:39982555;M=this.u2e(M);M.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";M.FailedToRefreshExpiredToken=this.ZJ;M.LastErrorIsPermanent=this.rca;if(0<r.count){var Qa=r.ka(0);M.errorName=Qa.Name;0<Qa.Errors.length&&(M.ErrorId=Qa.Errors[0].Id,Qa=Qa.Errors[0].Details,M.ErrorDetails=this.STh(Qa.toString())?"PiiScrubbed":Qa)}M=tc.a.Vf(M);aa.ULS.sendTraceTag(la,0,15,M);this.Va.raiseEvent("TokenRefreshed",
new lg(null,r))}STh(r){return ad.a.contains(r,"makes the internet safe for businesses",!0)}u2e(r){const M={},la=this.$.ea;M.Name="";M.IsUserActive=la.Ti.It;M.IsSessionActive=la.tf;M.GotDeploymentOrTimedOutError=la.Q5;M.TimeInSecFromLastStatefulSuccessfulRequest=la.E2;M.TimeFromLastUserActivityInMs=la.Ti.Upb;M.calledFromSessionExpiredFlow=r;M.RefreshTokenDurationInMS=this.k2d.gg;M.numOfFailuresWhileUserIsActive=zf.a.Pca;M.numOfFailuresWhileUserIsInActive=zf.a.Qca;M.numOfFailuresWhileOffline=zf.a.KGa;
M.RefreshAccessTokenCorrelationID=this.context.correlationID;M.accessTokenTTL=za.AFrameworkApplication.accessTokenTtl;M.ContainsChangesWorkbookOperations=this.$.userOperationManager.XQa();M.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.tk.toString():"Unknown";M.TimeFromFirstOpenInHr=Math.floor(Re.b(cd.a.Ae,he.toUtc(la.o$f))/3600);return M}QFi(r,M){this.ZJ=!1;this.CGk();this.mMg(new Date,za.AFrameworkApplication.accessTokenTtl);const la=this.$.ea,Qa=!M&&la.Ti.It,
Kb=!this.$.isEditMode&&la.$lb;M=this.u2e(M);M.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";M.shouldTriggerSilentReloadAfterExpiring=Qa;M.WopiTokenTaskItemPriority=za.AFrameworkApplication.Ole;M.isDirtyViewSession=Kb;M=tc.a.Vf(M);aa.ULS.sendTraceTag(39982556,0,15,M);this.Va.raiseEvent("TokenRefreshed",new lg(r,null));Kb?la.Ti.It&&(aa.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
la.Cud()):la.Ti.It?Qa&&(r=Cb.a(this.$).Ig.activityState,r[zf.a.rqb]=!0,r[ff.a.T3]=!0,r[jf.a.Cv]=this.$.isEditMode,Ld.a(this.$).Cu(new ee.a(se.a.Gva,2,null))):la.tf&&Bd.k(this.$.oa.ua,!0,!1,!1,null,null,null,null,null)}CGk(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=ca.a.iV(this.$.ea.workbookContext.WorkbookUri,za.AFrameworkApplication.pH,za.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=
ca.a.iV(this.$.ea.workbookContext.WorkbookUri,za.AFrameworkApplication.DO,za.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.pFc()):aa.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.xa.AccessToken=za.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=za.AFrameworkApplication.accessTokenTtl;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&
(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=ca.a.iV(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,za.AFrameworkApplication.pH,za.AFrameworkApplication.accessToken),this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=ca.a.iV(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,za.AFrameworkApplication.DO,za.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=ca.a.iV(this.$.xa.EmbedConfiguratorUrl,
za.AFrameworkApplication.pH,za.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=ca.a.iV(this.$.xa.EmbedConfiguratorUrl,za.AFrameworkApplication.DO,za.AFrameworkApplication.accessTokenTtl.toString()));this.context.GVb=!0}}Object(da.a)(Hf,"EwaAccessTokenExpirationRefreshManager",null,[397,398,2]);class Of{}Of.lbc="ActivityDuration";Of.error="Error";Of.Pqd="Errors";Of.failed="Failed";Of.aai="FirstActivity";Of.initialized="Initialized";Of.k5i="LastActivity";Of.zog="RetryOverride";Of.IZj=
"RequestGroups";Of.requests="Requests";Of.fog="Responses";Of.$Lc="SessionDuration";Of.status="Status";Of.success="Success";Of.successful="Successful";Of.tokens="Tokens";Object(da.a)(Of,"SessionExpirationStrings",null,[]);class Yg{constructor(r){this.ft={};this.a3={};this.G3g={};this.AQf=15;this.yxe=!1;this.o5g=new Date;this.B7b=new Date;this.tPg=()=>{aa.ULS.sendTraceTag(41964821,217,50,aa.ULS.Vf({["Aggregate"]:this.a3,["Current"]:this.ft}))};this.sh=r;this.bac=new Qe.a(2,2,6E4*this.AQf,this.tPg,135,
"SL",!1);this.sh.Li(this.bac);this.uOi()}uOi(){this.a3[Of.IZj]=0;this.a3[Of.requests]=0;this.a3[Of.fog]=0;this.a3[Of.status]=Of.initialized;this.a3[Of.aai]=new Date;this.a3[Of.$Lc]=0;this.a3[Of.lbc]=0;this.a3[Of.$Lc]=0;this.ft[Of.$Lc]=0;this.a3[Of.lbc]=0;this.ft[Of.lbc]=0}fFd(r,M){var la=r[M];la=la?la:0;la++;r[M]=la;this.r$d(r)}r$d(r){const M=new Date;r[Of.lbc]=+M-+this.B7b;this.B7b=M;r[Of.$Lc]=+this.B7b-+this.o5g;r[Of.k5i]=this.B7b}h8(r,M){this.ft[r]=M;this.r$d(this.ft)}T9d(r,M){this.ft[r]=M;this.r$d(this.ft)}incrementCounter(r){this.fFd(this.ft,
r);this.fFd(this.a3,r);this.fFd(this.G3g,r)}flush(){this.yxe||(this.a3[Of.status]=this.ft[Of.status],this.tPg(this.bac),this.sh.jva(this.bac,6E4*this.AQf))}stop(){aa.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.yxe=!0;this.sh.At(this.bac)}}Object(da.a)(Yg,"SessionLogger",null,[519]);var eh=a(490),Hg=a(1045),Pg=a(122),Fg=a(545);class Ch{constructor(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re,Ge){Qa=void 0===Qa?null:Qa;Kb=void 0===Kb?!1:Kb;hc=void 0===hc?null:hc;Ac=
void 0===Ac?!1:Ac;Zc=void 0===Zc?!1:Zc;Ad=void 0===Ad?!1:Ad;re=void 0===re?!1:re;Ge=void 0===Ge?!1:Ge;this.Tfa=0;this.Y9=this.ym=null;this.oac=new Ya.a;this.GL=new Ya.a;this.ro=null;this.F5a=!1;this.Oxb=this.Pxb=null;this.TZj=()=>{this.Umg()};this.sh=r;this.KCe=M;this.KCe.execute(kf=>{kf.Dn(qf.a.iEd,Object(Ka.a)(this,this.Isj,"onHostResponseReceived"))});this.RL=la;this.vHe=new Hg.a("WebServiceCall","TokenRefresh");this.Yn=Qa||new Yg(r);this.j5g=Kb;this.aZ=hc?hc:fb.SessionStatusManager.instance;this.Xse=
Ac;this.N5b=Zc;this.u5g=Ad;this.v5g=re;this.JFe=Ge}Isj(r){if(r.MessageId!==qf.a.iEd)Pg.a(39408099,306,15,"Unexpected message.");else{var M=new Ya.a,la=new Ya.a;this.Yn.incrementCounter(Of.fog);var Qa=r.Values[mf.a.Vsg];if(!Qa||0>=Qa.length)Pg.a(40122317,306,15,"Found no tokens in the dictionary"),Qa=r.Values;Pg.a(40122318,306,100,"The Tokens array contains {0} tokens",Qa.length);this.Yn.h8("Correlation",r.CorrelationId);var Kb="";for(let Zc=0;Zc<Qa.length;Zc++){this.Yn.T9d(Of.tokens,Qa.length);var hc=
Qa[Zc],Ac=hc;if(!Ac||!Ac.Name)continue;this.Yn.incrementCounter(Ac.Name);const Ad=hc;if(Ad&&Ad.Value)Pg.a(39408128,306,100,"Received token with name: {0}",Ad.Name),M.add(Ad),this.oac.add(Ad),this.N5b||this.Yn.h8(Of.status,Of.success),this.Xse&&this.aZ&&this.aZ.K_j();else if(hc=this.Pwi(hc),Pg.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Ac.Name,JSON.stringify(hc),this.Y9),la.add(hc),this.N5b||(this.GL.add(hc),Kb=JSON.stringify(hc),this.Yn.h8(Of.error,
JSON.stringify(hc)),this.Yn.h8(Of.status,Of.failed)),this.Xse)for(const re of hc.Errors)Ac=this.Fmi(re),this.aZ&&this.aZ.ech(Ac)}this.N5b?(0<la.count?this.Oxb?this.Oxb(new lg(M,la)):Pg.a(512267295,306,15,"Received errors but the promise has completed"):this.Pxb?this.Pxb(new lg(M,la)):Pg.a(512267294,306,15,"Received valid tokens but the promise has completed"),Pg.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",M.count,la.count,r.CorrelationId,
this.Y9)):(0<la.count&&""!==Kb?(Qa=Object.assign({},{extendedProperties:new Map}),Qa.extendedProperties.set("Errors",Kb),Qa.extendedProperties.set("RetryCount",this.Tfa.toString()),Qa.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Qa.extendedProperties.set("IsTokenExpiring",this.F5a.toString()),this.uKd()&&Qa.extendedProperties.set("IsAppShuttingDown",za.AFrameworkApplication.Oi.toString()),qe.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,
!1,Qa)):qe.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Pg.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",M.count,la.count,r.CorrelationId,this.Y9),0<la.count&&!this.ENb(la)?(r=this.RL.otf(la),r!==this.RL.fnb&&(this.Yn.T9d(Of.zog,r),this.sh.jva(this.ym,r))):(this.Yn.flush(),this.ym&&(Pg.a(39408131,306,100,"Deleting task {0} from task manager",this.ym.name),this.sh.At(this.ym)),this.ro&&!this.ro.task.isCompleted?this.ro.setResult(new lg(M,
la)):Pg.a(512267293,306,15,"Received results but the task has completed")))}}Pwi(r){if(!r)return null;const M=Object.assign(new Gf,{Name:r.Name,Errors:[],SPCorrelationId:r.SPCorrelationId});for(const la of r.Errors)r=new Qf,r.Id=la.Id,r.Details=eh.a.eUa(la.Details,500),M.Errors.push(r);return M}Umg(){za.AFrameworkApplication.fG("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Tfa>=this.RL.mUf?(Pg.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.Y9),this.z2e(this.ro,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(qe.Health.instance.recordKpiUsage("WACTokenRefresh",e.b.SuccessBased,"wwrelfc",null),this.jsg())}jsg(){const r={};r[mf.a.Vsg]=this.RL.tokens;this.u5g&&(r[mf.a.$7j]=this.v5g);const M=Ef.a.create().toString();Pg.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.RL.tokens),this.Tfa+1,M,this.Y9);this.KCe.execute(la=>
{la.sendMessage(qf.a.tPe,r,M)});this.Tfa++;this.Yn.incrementCounter(Of.requests)}z2e(r,M,la){const Qa=new Ya.a;for(let Kb=0;Kb<this.RL.tokens.length;Kb++){const hc=Object.assign(new Gf,{Name:this.RL.tokens[Kb],Errors:[Object.assign(new Qf,{Id:M,Details:la})]});Qa.add(hc);this.GL.add(hc)}this.sh.At(this.ym);this.Yn.h8(Of.Pqd,JSON.stringify(this.GL));this.Yn.h8(Of.status,Of.failed);r&&!r.task.isCompleted&&r.setResult(new lg(new Ya.a,this.GL))}uKd(){return za.AFrameworkApplication.fa&&za.AFrameworkApplication.fa.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}RPj(r,
M){M=void 0===M?null:M;za.AFrameworkApplication.fG("ej4if276;fheca743");za.AFrameworkApplication.fG("5d4fi128;abe10395");Fg.a.iGa("7db39907;cegi0367;ijicc640");this.vHe.start();this.uKd()&&this.sh.DUa&&(Pg.a(508351137,306,15,"Restarting taskmanager, is shutting down {0}",za.AFrameworkApplication.Oi),this.sh.iXb());this.F5a=r;this.Y9=Ef.a.create().toString();Pg.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Y9,this.F5a);this.Tfa=0;this.GL.clear();this.oac.clear();
const la=new Ue.a;this.ro=la;M&&M.R(()=>{const Qa=!!la&&!la.task.isCompleted;Pg.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.Y9,this.F5a,Qa);Qa&&this.z2e(la,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.N5b?this.Vmg(this.RL.mUf).then(Qa=>{this.ro&&!this.ro.task.isCompleted&&this.ro.setResult(Qa);this.Oxb=this.Pxb=null;this.Yn.h8(Of.Pqd,JSON.stringify(this.GL));this.Yn.h8(Of.status,Of.success);this.Yn.flush()}).catch(Qa=>
{this.ro&&!this.ro.task.isCompleted&&this.ro.setResult(Object(Zb.a)(401,Qa));this.Oxb=this.Pxb=null;this.Yn.h8(Of.Pqd,JSON.stringify(this.GL));this.Yn.h8(Of.status,Of.failed);this.Yn.flush()}):(this.ym=new Qe.a(this.RL.priority,2,this.RL.fnb,this.TZj,98,qf.a.tPe,!0),this.j5g&&this.Umg(),this.sh.Li(this.ym));return this.ro.task}Vmg(r){const M=this,la=new Promise((Zc,Ad)=>{M.Pxb=Zc;M.Oxb=Ad;qe.Health.instance.recordKpiUsage("WACTokenRefresh",e.b.SuccessBased,"wwrelfc",null);M.jsg()}),Qa=this,Kb=new Promise((Zc,
Ad)=>{window.setTimeout(()=>{Ad(Qa.E2e("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Qa.RL.fnb)});let hc=r;const Ac=this;return new Promise((Zc,Ad)=>{hc--;Promise.race([la,Kb]).then(re=>{qe.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Zc(re)}).catch(re=>{var Ge=Ac.RL.fnb;if(Object(ob.a)(401,re)&&(re=Object(Zb.a)(401,re),0<re.errors.count)){Ac.K9i(re.errors);Ac.Tu(re.errors);if(Ac.ENb(re.errors)){Ad(re);return}const kf=Ac.RL.otf(re.errors);kf!==
Ac.RL.fnb?(Ac.Yn.T9d(Of.zog,kf),Ge=kf):Ac.E2i(re.errors)&&(Ge=0)}hc?window.setTimeout(()=>{Ac.Vmg(hc).then(Zc).catch(Ad)},Ge):(Ge=Ac.E2e("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Ac.Tu(Ge.errors),Ad(Ge),Pg.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Ac.Y9))})})}Tu(r){for(const M of r)this.GL.add(M)}E2i(r){if(!r.count)return!1;r=r.ka(r.count-1);return r.Errors.length?"TIMEOUT"==r.Errors[0].Id:
!1}E2e(r,M){const la=new Ya.a;for(let Qa=0;Qa<this.RL.tokens.length;Qa++){const Kb=this.fHh(this.RL.tokens[Qa],r,M);la.add(Kb)}return new lg(new Ya.a,la)}fHh(r,M,la){return Object.assign(new Gf,{Name:r,Errors:[Object.assign(new Qf,{Id:M,Details:la})]})}K9i(r){if(r.count){r=r.ka(r.count-1);r=JSON.stringify(r);var M=Object.assign({},{extendedProperties:new Map});M.extendedProperties.set("Errors",r);M.extendedProperties.set("RetryCount",this.Tfa.toString());M.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());M.extendedProperties.set("IsTokenExpiring",this.F5a.toString());this.uKd()&&M.extendedProperties.set("IsAppShuttingDown",za.AFrameworkApplication.Oi.toString());qe.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,M);this.Yn.h8(Of.error,r);this.Yn.h8(Of.status,Of.failed)}}qJj(r){this.vHe.stop();const M=this.eHi(r.result.errors);aa.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!M,this.Y9,this.F5a,this.Tfa,this.GL.count,0<r.result.errors.count?r.result.errors.ka(0).Name:"",0<r.result.errors.count&&0<r.result.errors.ka(0).Errors.length?r.result.errors.ka(0).Errors[0].Id:"",0<r.result.errors.count&&0<r.result.errors.ka(0).Errors.length?r.result.errors.ka(0).Errors[0].Details:"");return M?!1:this.pJj(r.result.tokens)}ENb(r){return this.RL.ENb(r)}pJj(r){for(let M=0;M<r.count;M++){const la=r.ka(M);if(la.Name===mf.a.accessToken){const Qa=(new Date).getTime();la.Expiry>za.AFrameworkApplication.accessTokenTtl?
(aa.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:la.Expiry,["NowGetTime"]:Qa,["BootTime"]:za.AFrameworkApplication.tH},"PreviousAccessTokenTtl",za.AFrameworkApplication.accessTokenTtl),za.AFrameworkApplication.accessToken=la.Value,za.AFrameworkApplication.accessTokenTtl=Math.floor(la.Expiry),za.AFrameworkApplication.H3a=Qa,za.AFrameworkApplication.ega=Math.floor(la.Expiry)):aa.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:la.Expiry,["NowGetTime"]:Qa,["BootTime"]:za.AFrameworkApplication.tH},"PreviousAccessTokenTtl",za.AFrameworkApplication.accessTokenTtl)}}return!0}eHi(r){let M=!1;for(let la=0;la<r.count;la++){M=!0;const Qa=r.ka(la);aa.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",Qa.Name,JSON.stringify(Qa.Errors),this.Y9,Qa.SPCorrelationId)}return M}tLf(r){return r.includes("aadInteractionRequired")||r.includes("sessionRevocation")||
r.includes("blockAccessForTenantRestrictions")||r.includes("revoked")||r.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}Fmi(r){let M=ea.a.ZLc;const la=parseInt(r.Id);r=r.Details.toString();if(isNaN(la))M=ea.a.lLk;else{switch(la){case 401:M=ea.a.oLk;this.JFe&&this.tLf(r)&&(M=ea.a.bPg);break;case 403:M=ea.a.jLk;this.JFe&&this.tLf(r)&&(M=ea.a.bPg);break;case 500:M=ea.a.kLk;break;case 503:M=ea.a.nLk}M===ea.a.ZLc&&(M=500<la?ea.a.mLk:ea.a.iLk)}return M}}
Object(da.a)(Ch,"TokenRefreshManager",null,[402]);class Vg{constructor(){this.fnb=za.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.WopiTokenRefreshRetryInterval",za.AFrameworkApplication.rLk);this.mUf=za.AFrameworkApplication.pLk;this.tokens=za.AFrameworkApplication.fCi();this.priority=za.AFrameworkApplication.Ole;this.ZDe=this.Qbk();this.f$c=za.AFrameworkApplication.eCi()}ENb(r){r=JSON.stringify(r);if(this.f$c&&0<this.f$c.length)for(const M of this.f$c)if(0<M.length&&0<=
r.indexOf(M))return!0;return!1}otf(r){try{if(r)for(const M of r)if(M.Errors)for(const la of M.Errors)if(la.Id in this.ZDe)return Number.parseInvariant(this.ZDe[la.Id].toString())}catch(M){aa.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",M.toString())}return this.fnb}Qbk(){const r={};try{if(!za.AFrameworkApplication.hsc()||0>=za.AFrameworkApplication.hsc().length||""===za.AFrameworkApplication.hsc()[0])return r;for(const M of za.AFrameworkApplication.hsc())0<
M.length&&(r[M]=za.AFrameworkApplication.qLk)}catch(M){aa.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",M.toString())}return r}}Object(da.a)(Vg,"TokenRefreshPolicy",null,[399]);class wh extends cb.a{constructor(r){super();this.$=r;this.Dg()}create(){za.AFrameworkApplication.fa.la("RefreshAccessTokenSilently")?this.Df(this.kHh()):this.Df(this.$.ja.Qa(38)||this.$.ja.$c(38,new vf(this.$)))}kHh(){var r=this.$.ja.Qa(38);if(r)return r;r=new Ch(za.AFrameworkApplication.jl,
za.AFrameworkApplication.kK(),new Vg);return this.$.ja.$c(38,new Hf(this.$,r))}static ta(r){r.ja.$c(39,new wh(r))}}Object(da.a)(wh,"AccessTokenExpirationManagerFactory",cb.a,[]);var kh=a(1169),Vh;(function(r){r[r.generalException=0]="generalException";r[r.invalidArgument=1]="invalidArgument";r[r.dXf=2]="notAllowed";r[r.sdc=3]="apiNotAvailable";r[r.UBk=4]="unresolvedPendingRequest";r[r.timeout=5]="timeout";r[r.mad=6]="adalTimeout";r[r.pke=7]="userNotSignedIn";r[r.drb=8]="userAborted";r[r.XAg=9]="silentSignInFailed";
r[r.lfb=10]="invalidResourceUrl";r[r.Xuc=11]="invalidGrant";r[r.j0e=12]="connectionLost";r[r.Rgc=13]="clientError";r[r.serverError=14]="serverError"})(Vh||(Vh={}));Object(da.b)("ErrorCodes",Vh);a(1291);class $h{constructor(r,M){this.requestCallback=this.requestParameters=null;this.requestParameters=r;this.requestCallback=M}}Object(da.a)($h,"OutstandingRequest",null,[]);class Mg{}Mg.eij="AADSTS50058";Mg.lfb="AADSTS50001";Mg.Yhj="AADSTS65001";Mg.rij="AADSTS70011";Mg.drb="13002";Mg.jGj="Popup Window is null";
Mg.iGj="Popup Window closed";Mg.mad="Token renewal operation failed due to timeout";Mg.owk="tokenRevoked";Object(da.a)(Mg,"WopiHostErrorType",null,[]);var Ye=a(542),E=a(608),ja=a(1290);class Ha{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(da.a)(Ha,"WopiIdentityInfo",null,[418]);class Jb{constructor(r,M,la){this.expiration=this.authority=this.accessToken=null;this.accessToken=r;this.authority=M;this.expiration=la}}Object(da.a)(Jb,
"WopiIdentityToken",null,[419]);var jc=a(179),Uc=a(69),Rc=a(369);class Dd{constructor(r){this._initialized=!1;this.iwj=M=>{let la=null;try{const Kb=M.Values[mf.a.dee],hc=M.Values[mf.a.cpk],Ac=M.Values[mf.a.RBg],Zc=M.Values[mf.a.kpk];let Ad=null,re=null;const Ge=this.Bkb[Kb];if("undefined"!==typeof Ge&&Ge){var Qa=[];Array.add(Qa,Object.assign(new Uc.a,{name:mf.a.cee,string:Ge.requestParameters.correlationId}));jc.a.sendTelemetryEvent(Object.assign(new Rc.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:Qa}));la=Ge.requestCallback;delete this.Bkb[Kb];"undefined"!==typeof hc&&hc&&hc.length?re=new Jb(hc,Ac,Zc):Ad=Vh[this.Ycj(M)];Qa="getAccessToken_"+Kb;Qa in this.DPc&&(this.DPc[Qa].stop(),delete this.DPc[Qa]);la(re,Ad)}else aa.ULS.sendTraceTag(37856066,344,10,Hb.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Kb}))}catch(Kb){M=M.Values[mf.a.dee],M in this.Bkb&&delete this.Bkb[M],this.qAc(),aa.ULS.sendTraceTag(37856067,344,10,Hb.c({["error"]:Kb.message,["stack"]:Kb.stack})),
la&&la(null,"generalException")}};this.Bkb={};this.DPc={};this.pU=za.AFrameworkApplication.ra.NG;this.gEd=r}fSa(r){this._initialized||(r.rp(qf.a.nbg),r.Dn(qf.a.nbg,this.iwj),this._initialized=!0)}getAccessToken(r,M,la){la=void 0===la?null:la;this.Nja(r,M);return new Promise((Qa,Kb)=>{if(this.CGd(M))if(M in this.Bkb)Kb("unresolvedPendingRequest");else{var hc=window.setTimeout(()=>{aa.ULS.sendTraceTag(37856032,344,10,Hb.c({["error"]:"Request timeout.",["callerId"]:M}));Kb("timeout")},12E4);this.Jvd(r,
M,la,(Ac,Zc)=>{window.clearTimeout(hc);Ac?Qa(Ac):(aa.ULS.sendTraceTag(37856033,369,15,Hb.c({["error"]:Vh[Zc]})),Kb(Zc))})}else aa.ULS.sendTraceTag(37856034,344,10,Hb.c({["error"]:"Caller is not allowed."})),Kb("notAllowed")})}getPrimaryIdentityInfo(r){return new Promise((M,la)=>{this.CGd(r)?this.tui((Qa,Kb)=>{Qa?M(Qa):(aa.ULS.sendTraceTag(37856064,369,10,Hb.c({["error"]:Kb.toString()})),la(Kb))}):(aa.ULS.sendTraceTag(37856065,344,10,Hb.c({["error"]:"Caller is not allowed."})),la("notAllowed"))})}getAuthContext(r){return new Promise((M,
la)=>{const Qa=this.getAuthContextSync(r);Qa?M(Qa):la("notAllowed")})}getAuthContextSync(r){if(this.CGd(r)){const M=new ja.a;M.upn=za.AFrameworkApplication.fa.Ta("UserPrincipalName");M.userId=za.AFrameworkApplication.fa.Ta("LoggableUserId");M.authority=za.AFrameworkApplication.fa.Ta("HostAuthAuthority");M.tenantId=za.AFrameworkApplication.fa.Ta("TenantId");M.isAnonymous=za.AFrameworkApplication.fa.la("IsAnonymousUser");M.supportsAuthToken=this.QJi(r);r=za.AFrameworkApplication.fa.Ta("HostAuthType");
M.authorityType="aad"===r.toLowerCase()?2:"msa"===r.toLowerCase()?1:0;return M}aa.ULS.sendTraceTag(40751647,344,10,Hb.c({["error"]:"Caller is not allowed."}));return null}QJi(r){const M=Ye.a.IKb;return Cc.a.HFa?M&&Ye.a.MEg?Array.contains(Ye.a.MEg,r.toLowerCase()):!1:M}Jvd(r,M,la,Qa){var Kb=[];Array.add(Kb,Object.assign(new Uc.a,{name:"CallerId",string:M}));Array.add(Kb,Object.assign(new Uc.a,{name:mf.a.cee,string:r.correlationId}));jc.a.sendTelemetryEvent(Object.assign(new Rc.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",
dataFields:Kb}));Kb=E.a.create().toString();const hc="getAccessToken_"+Kb,Ac=this.pU.Sf("ComponentAttach",hc);this.DPc[hc]=Ac;const Zc={};Zc[mf.a.dee]=Kb;Zc[mf.a.hpk]=r.resource;Zc[mf.a.ipk]=r.scope;Zc[mf.a.RBg]=za.AFrameworkApplication.fa.Ta("HostAuthType");Zc[mf.a.lpk]=za.AFrameworkApplication.fa.Ta("UserPrincipalName");Zc[mf.a.jpk]=r.silentLogin;Zc[mf.a.epk]=r.options;Zc[mf.a.cee]=r.correlationId;Zc[mf.a.fpk]=M;la&&(Zc[mf.a.addinName]=la.AddinName,Zc[mf.a.dpk]=la.AddinTrustId);this.gEd.execute(Ad=>
{this.fSa(Ad);Ad.sendMessage(qf.a.getAuthToken,Zc)});this.Bkb[Kb]=new $h(r,Qa)}tui(r){const M=za.AFrameworkApplication.fa.Ta("UserName"),la=za.AFrameworkApplication.fa.Ta("UserPrincipalName"),Qa=za.AFrameworkApplication.fa.Ta("LoggableUserIdSpace"),Kb=new Ha;Kb.email=la;Kb.displayName=M;switch(Qa){case "OrgIdPuid":Kb.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Kb.authority="MicrosoftAccount";break;default:Kb.authority=Qa}r(Kb,null)}CGd(r){var M=za.AFrameworkApplication.dCi();
r=r.toLowerCase();for(const la of M)if(r===la.toLowerCase())return!0;M=Ye.a.Xcd;for(const la in M)if(r===M[la].toLowerCase())return!0;return!1}Ycj(r){r=r.Values[mf.a.gpk];this.qAc();aa.ULS.sendTraceTag(39068821,344,15,Hb.c({["error"]:r}));return r?-1<r.indexOf(Mg.eij)?9:-1<r.indexOf(Mg.jGj)||-1<r.indexOf(Mg.iGj)?12:-1<r.indexOf(Mg.lfb)?10:-1<r.indexOf(Mg.drb)?8:-1<r.indexOf(Mg.rij)||-1<r.indexOf(Mg.Yhj)||r===Mg.owk?11:-1<r.indexOf(Mg.mad)?6:0:13}Nja(r,M){r=this.rPj(r.resource);aa.ULS.sendTraceTag(39921882,
344,50,Hb.c({["callerId"]:M,["resource"]:r}))}qAc(){aa.ULS.sendTraceTag(39068822,344,50,Hb.c({["userAgent"]:window.navigator.userAgent}))}rPj(r){return(r?r:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(da.a)(Dd,"WopiIdentityManager",null,[394]);class Yd{constructor(){this.$b=null;this.kG=()=>{try{this.$b.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(r){aa.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+r)}}}get name(){return"Common.App.WopiIdentity"}dl(r){this.$b=
r;r.register(Dd,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").If().Rf(()=>new Dd(r.We("Postmessage.IHostPostmessenger")))}init(){za.AFrameworkApplication.fa&&za.AFrameworkApplication.fa.Xw(this.kG)}dispose(){}static main(){Tb.a.instance.Ul(new Yd)}}Object(da.a)(Yd,"WopiIdentityPackage",null,[4,5]);var Jd=a(1310),Md=a(1170);class Je{constructor(r,M,la,Qa,Kb){this.R_c=this.qNa=null;this.k5a=this.FVc=!1;this.fig=()=>{const hc=document.getElementById(za.AFrameworkApplication.Bdc);
!this.k5a&&this.VU&&hc&&(this.VU.va(le.a.CGa,hc,this.$Rd,null),this.k5a=!0);this.R4c(()=>{this.dispose()})};this.$Rd=()=>{this.k5a&&(this.VU.Da(le.a.CGa,document.getElementById(za.AFrameworkApplication.Bdc),this.$Rd),this.k5a=!1);this.DJe();return!1};this.pYb=()=>{this.FVc&&(this.Aya.CWR(()=>this.Aya.result.sendMessage(qf.a.wHk,null)),aa.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.FVc=!1)};this.sh=M;this.t8b=r;this.Aya=la;this.VU=
Qa;this.R4c=Kb;this.fig(null)}DJe(){this.FVc=!0;this.R_c||(this.R_c=new Qe.a(3,2,this.t8b,this.fig,112),this.sh.Li(this.R_c));this.qNa||(this.pYb(null),this.qNa=new Qe.a(3,2,this.t8b,this.pYb,111),this.sh.Li(this.qNa))}dispose(){this.k5a&&(this.VU.Da(le.a.CGa,document.getElementById(za.AFrameworkApplication.Bdc),this.$Rd),this.k5a=!1)}}Object(da.a)(Je,"UserActivityHostNotificationManager",null,[390,2]);class af{constructor(){this.$b=null;this.kG=()=>{af.editNotificationIsEnabled&&0<af.Fpd&&(this.$b.register(Jd.a,
"Common.App.HostNotification.EditNotificationEventSource").If(),this.$b.register(Je,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").If().Rf(()=>new Je(6E4,lf.TaskManager.instance,wa.a.As(this.$b.We("Postmessage.IHostPostmessenger")),Uh.a.instance,za.AFrameworkApplication.b2a)),this.$b.register(Md.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").If().Rf(()=>new Md.a(af.Fpd,
lf.TaskManager.instance,wa.a.As(this.$b.We("Postmessage.IHostPostmessenger")),this.$b.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.$b.pj("Common.Interface.IUserActivityHostNotificationManager"),af.editNotificationPostMessageIsEnabled,af.gVh)),this.$b.resolve("Common.Interface.IEditNotificationManager"),aa.ULS.shipAssertTag(38086291,209,0<af.Fpd,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){za.AFrameworkApplication.fa&&
za.AFrameworkApplication.fa.Xw(this.kG)}dl(r){this.$b=r}dispose(){}static get Fpd(){return za.AFrameworkApplication.fa?parseInt(za.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get gVh(){return za.AFrameworkApplication.fa?parseInt(za.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get editNotificationIsEnabled(){return!!za.AFrameworkApplication.fa&&za.AFrameworkApplication.fa.la("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!za.AFrameworkApplication.fa&&
za.AFrameworkApplication.fa.la("EditNotificationPostMessageIsEnabled")}static main(){Tb.a.instance.Ul(new af)}}Object(da.a)(af,"CommonHostNotificationPackage",null,[4,5]);class gf{constructor(r,M,la){this.bOa=null;this.XZb=()=>{this.bOa=null;aa.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Qte.display()};this.vkk=(Qa,Kb,hc,Ac,Zc)=>Qa!==zb.a.XZb?2:1===hc?32:2===hc&&Zc?(aa.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",
Zc),Zc?this.tig():(this.bOa?(aa.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.sh.At(this.bOa)):(aa.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Qte.remove(null)),this.bOa=null),32):8;this.sh=r;this.Ma=M;this.Qte=la.create()}tig(){this.bOa?aa.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(aa.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.bOa=new Qe.a(2,1,3E4,this.XZb,
67),this.sh.Li(this.bOa))}g_a(){this.Ma.hf(zb.a.XZb,Rb.a.frame,this.vkk)}}Object(da.a)(gf,"FloatPaneActor",null,[393]);var of=a(178),Cf=a(48);class Df{constructor(r,M,la,Qa,Kb){this.p3c=this.pub=this.D9b=this.zna=this.YU=this.FA=this.cXc=this.xR=this.ewb=this.ovb=this.pvb=this.k_c=null;this.Ytj=()=>{const hc=this.Fa.Ng("O365AdPaneShowingDuration",60);this.zic();this.xR.style.display="block";this.xR.style.height=this.YU.height+"px";this.pub=new Qe.a(2,1,1E3*hc,Object(Ka.a)(this,this.hide,"hide"),67);
this.sh.Li(this.pub);this.sjg()};this.Xtj=()=>{aa.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.sjg();this.YU=null};this.V5f=()=>{aa.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.pub&&this.sh.At(this.pub);this.hide();return!0};this.sh=M;this.Fa=r;this.jq=la;this.$b=Kb;this.Z8=Qa}zic(){this.xR=document.createElement("div");this.xR.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.xR.style.width=this.YU.width+"px";(this.p3c=this.Dsi(this.Z8))?(this.zna=document.createElement("a"),this.zna.setAttribute(Ub.a.ih,Ub.a.Vu),this.jq.va(le.a.click,this.zna,this.V5f),this.zna.href=this.p3c,this.zna.target="_blank",this.zna.appendChild(this.YU),this.xR.appendChild(this.zna)):this.xR.appendChild(this.YU);this.FA=document.createElement("a");this.FA.setAttribute(Ub.a.ih,Ub.a.Kz);this.FA.className="StandardButton WACFloatPaneCloseButton";this.FA.title=
CommonUIStrings.l_Close;this.FA.tabIndex=-1;this.cXc=of.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.cXc.setAttribute(Ub.a.ih,Ub.a.Vu);this.FA.appendChild(this.cXc);this.jq.va(le.a.click,this.FA,this.onClose);this.xR.appendChild(this.FA);this.ewb.appendChild(this.xR)}npi(r){const M=this.Fa.la("O365PromotionHasStarted");switch(r){case 2:return qa.a.aBa(String.format("adppt{0}.png",M?"sale":""));case 1:return qa.a.aBa(String.format("adxls{0}.png",
M?"sale":""));case 3:return qa.a.aBa(String.format("addoc{0}.png",M?"sale":""))}return null}Dsi(r){const M=this.Fa.Ta("O365AdPaneRedirectedURL");switch(r){case 1:return String.format(M,"Excel");case 2:return String.format(M,"PowerPoint");case 3:return String.format(M,"Word")}return null}hide(r){this.pub=null;this.xR&&!this.D9b&&((void 0===r?0:r)?aa.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):aa.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),
this.xR.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.xR.style.height="0px",this.D9b=new Qe.a(2,1,1E3,Object(Ka.a)(this,this.remove,"remove"),67),this.sh.Li(this.D9b))}remove(){this.xR&&this.ewb&&(this.zna&&this.jq.Da(le.a.click,this.zna,this.V5f),this.jq.Da(le.a.click,this.FA,this.onClose),this.ewb.removeChild(this.xR),this.xR=null);this.D9b=null}display(){if(this.k_c=this.$b.pj("Common.IFloatPaneContainer"))if(this.ewb=this.k_c.container){var r=this.npi(this.Z8);r?
(aa.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",r),this.YU=document.createElement("img"),this.YU.className="WACFloatPaneImage",this.pvb=this.Ytj,Cf.a.addHandler(this.YU,le.a.load,this.pvb),this.ovb=this.Xtj,Cf.a.addHandler(this.YU,le.a.error,this.ovb),this.YU.src=r):aa.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else aa.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else aa.ULS.sendTraceTag(23674905,
207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}sjg(){this.pvb&&this.YU&&Cf.a.removeHandler(this.YU,le.a.load,this.pvb);this.pvb=null;this.ovb&&this.YU&&Cf.a.removeHandler(this.YU,le.a.error,this.ovb);this.ovb=null}dispose(){this.hide()}}Object(da.a)(Df,"FloatPane",null,[417]);class Vf{constructor(r,M,la,Qa,Kb){this.sh=M;this.Fa=r;this.jq=la;this.$b=Kb;this.Z8=Qa}create(){return new Df(this.Fa,this.sh,this.jq,this.Z8,this.$b)}}Object(da.a)(Vf,"FloatPaneFactory",
null,[392]);class qg{constructor(){this.$b=null}get name(){return"Common.App.FloatPane"}get zGf(){return za.AFrameworkApplication.fa.la("O365AdvertisementIsEnabled")&&za.AFrameworkApplication.fa.la("IsShowAdvertisementPaneEnabled")}init(){this.zGf&&(aa.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.$b.resolve("Common.App.FloatPane.IFloatPaneActor").tig(),aa.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.$b.resolve("Common.App.FloatPane.IFloatPaneActor").g_a())}dl(r){this.$b=
r;this.zGf&&(this.$b.register(Vf,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Rf(()=>new Vf(za.AFrameworkApplication.fa,za.AFrameworkApplication.jl,sh.a.instance,za.AFrameworkApplication.ra.Pa.Cj,this.$b)).If(),this.$b.register(gf,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Rf(()=>new gf(za.AFrameworkApplication.jl,za.AFrameworkApplication.Oe,this.$b.resolve("Common.App.FloatPane.IFloatPaneFactory"))).If())}dispose(){}static main(){Tb.a.instance.Ul(new qg)}}
Object(da.a)(qg,"FloatPanePackage",null,[4,5]);var Gg=a(993),eg=a(813);class Jf{constructor(r,M){this.Etb=null;this.FDk=(la,Qa,Kb,hc,Ac)=>{if(1===Kb)return 32;Ac[Gg.a.Value]=this.Etb;Ac[eg.a.xl]=this.Etb;Ac[Gg.a.Visible]=!0;return 32};this.Ma=r;this.Fa=M}ik(){(this.Etb=this.Fa.Ta("StatusBarEnvironmentNameToUse"))&&""!==this.Etb&&this.Ma.ji(zb.a.eeg,Rb.a.frame,this.FDk,96)}}Object(da.a)(Jf,"DisplayEnvironmentName",null,[]);class Rf{constructor(){this.$b=null}get name(){return"Common.App.DisplayEnvironmentName"}dl(r){this.$b=
r;this.$b.register(Jf,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").If().Rf(()=>new Jf(za.AFrameworkApplication.Oe,za.AFrameworkApplication.fa))}init(){this.$b.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ik()}dispose(){}static main(){Tb.a.instance.Ul(new Rf)}}Object(da.a)(Rf,"DisplayEnvironmentNamePackage",null,[4,5]);var Kg=a(222),Uf=a(170);class nh extends Kg.a{constructor(r){super();this.JK=()=>{this.MFd()};this.gka=()=>{this.MFd()};this.$=r}dispose(){this.$&&
Uf.a(this.$)&&(Uf.a(this.$).D_a(this.gka),this.$.ea.UK(this.JK));this.$=null;super.dispose()}gUh(){za.AFrameworkApplication.jWa()&&!this.MFd()&&(Uf.a(this.$).aPa(this.gka),this.$.ea.aM(this.JK))}MFd(){return this.$.isEditMode&&(za.AFrameworkApplication.$ab||ua.a.fj.wu)?(Uf.a(this.$).D_a(this.gka),zd.TaskExtensions.Ca(ze.GetServiceTaskFactory.create(this.$.ja,119,this.qa,1),r=>{r.result.initialize()},this.qa,3),!0):!1}static main(){Ca.a.Na(r=>{(new nh(r)).gUh()})}}Object(da.a)(nh,"FileOpSliceDownloaderBootStraper",
Kg.a,[]);var zh=a(96),Ph=a(485);class ii{constructor(r){this.U_=null;this.yRf=new Set;this.YKf=!1;this.P6=(M,la)=>{if(!this.yRf.has(M)){var Qa=[];if(la){const Kb=Yb.h(this.$).Je.gj(la,!1);if(!Kb){1!==la.top||1!==la.left||this.YKf||(Qa.push(hh.a.Ni("IsTableOnA1","false",1)),Ce.a("MsFormsTableUsage",void 0,void 0,Qa),this.YKf=!0);return}if(1!==Kb.usedRange.top||1!==Kb.usedRange.left)return}la=fg.b().hm(M);Qa.push(hh.a.Ni("Command",la,2));Ce.a("MsFormsTableUsage",void 0,void 0,Qa);this.yRf.add(M)}};
this.qje=(M,la)=>{if(!this.$.ea.qk.get(61)||zh.k(this.$.Rh))zh.k(this.$.Rh)&&la&&la.item.name===this.U_.rP&&this.pSe();else if(this.$.sa.uo(this.U_.nHb)){const Qa={};Qa.SheetName=this.U_.nHb;Qa.NamedObjectName=this.U_.nHb;Qa.FirstColumn=0;Qa.FirstRow=0;Qa.LastColumn=0;Qa.LastRow=2;const Kb=Ac=>{if(!zh.k(this.$.Rh)){if(null===Ac||void 0===Ac?0:Ac.Result)this.$.workbookContext.MsFormId=Ac.Result[0][0],this.U_.rP=Ac.Result[1][0],Ac=Ac.Result[2][0],this.LQ(!!this.$.workbookContext.MsFormId&&this.m3i(Ac),
1024),this.pSe();zh.c(this.$.Rh)&&(la?aa.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${Za.a.XA(this.$.workbookContext.MsFormId).toString()}`):aa.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${Za.a.XA(this.$.workbookContext.MsFormId).toString()}`));zh.c(this.$.Rh)&&!la&&aa.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${Za.a.XA(this.$.workbookContext.MsFormId).toString()}`);!zh.c(this.$.Rh)&&
la||this.LQ(!0,2048)}},hc=this.$.oa.ua.qf();this.$.userOperationManager.WJ(new Be.a(159,0,(Ac,Zc,Ad)=>Bd.s(this.$.oa.hA,Qa,!1,Xc.b(Ac,Kb),Zc,Ad,null,hc),16))}else la||this.LQ(!0,2048)};this.yuj=(M,la)=>{la&&la.item.name===this.U_.nHb&&(this.LQ(!1,1024),this.LQ(!0,2048))};this.$=r}Dzk(){this.U_=Ph.a.current;this.qje(null,null);this.$.sa.toa(this.qje);this.$.sa.a4(this.yuj)}dispose(){this.$.sa.Yua(this.qje)}m3i(r){if(!r)return!0;const M=RegExp("-","g"),la=this.$.workbookContext.MsFormDocUrl.toLowerCase();
return la.includes(r.toLowerCase())||la.includes(r.toLowerCase().replace(M,""))?!0:!1}pSe(){zh.c(this.$.Rh)&&this.U_.rP&&this.$.sa.na&&this.$.sa.na.name!==this.U_.rP&&this.$.sa.uo(this.U_.rP)&&this.$.sa.getItemByName(this.U_.rP).activate({scenario:"msForm"})}LQ(r,M){this.$.workbookContext.Options=bf.HelperMethods.kU(r,this.$.workbookContext.Options,M)}}Object(da.a)(ii,"MsFormInfoUpdatingService",null,[342,2]);class Fh extends cb.a{constructor(r){super();this.msFormInfoUpdatingService=null;this.$=
r;this.Dg()}create(){this.Df(Object(pb.a)(this.$.ja,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new ii(this.$))));this.msFormInfoUpdatingService.Dzk()}static ta(r){r.ja.$c(236,new Fh(r))}}Object(da.a)(Fh,"MsFormInfoUpdatingServiceFactory",cb.a,[]);var ji=a(232);class Ii extends qd.a{constructor(r,M,la,Qa){super();this.value=null;this.$=Qa;this.IMd=r;this.LA=M;this.W1g=la}Bdh(r){this.addHandler("EnabledStateChanged",r)}get isEnabled(){return this.LA}set isEnabled(r){r!==
this.LA&&(this.LA=r,Ia.a.An(this.$)&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.IMd.replace(" ","")+"Button",r)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get xl(){return this.value?String.format(wc.a.instance.He(79),this.IMd,this.value):this.IMd}get IAc(){return this.W1g}}Object(da.a)(Ii,"StatusBarAggregateControl",qd.a,[331]);class mg extends qd.a{constructor(r){super();this.controls=new gh.a(!1);this.yoe=null;this.Ceg=()=>
{this.raiseEvent("AggregatesChanged")};this.$=r;this.kga(0,415,"Average",!0);this.kga(1,416,"Count",!0);this.kga(2,417,"NumericalCount",!1);this.kga(3,418,"Minimum",!1);this.kga(4,419,"Maximum",!1);this.kga(5,420,"Sum",!0)}Cch(r){this.addHandler("AggregatesChanged",r)}ZTj(r){this.removeHandler("AggregatesChanged",r)}get s8a(){return this.yoe||mg.D$e}set s8a(r){r=r||mg.D$e;r!==this.s8a&&(this.bJa(0,r.Average),this.bJa(1,r.Count),this.bJa(2,r.NumericalCount),this.bJa(3,r.Minimum),this.bJa(4,r.Maximum),
this.bJa(5,r.Sum),this.yoe=r,this.Ceg())}dispose(){Ic.a.Wf(this.controls.values);this.controls.clear();super.dispose()}yDa(r){return this.controls.getItem(r)}o$g(r,...M){r=this.yDa(r.toString());for(const la of M)this.controls.add(la,r)}kga(r,M,la,Qa){M=new Ii(wc.a.instance.za(M),Qa,la,this.$);M.Bdh(this.Ceg);this.controls.add(r.toString(),M)}bJa(r,M){this.yDa(r.toString()).value=M}static get D$e(){mg.mya||(mg.mya={},mg.mya.Average=mg.mya.Count=mg.mya.NumericalCount=mg.mya.Minimum=mg.mya.Sum=null);
return mg.mya}}mg.mya=null;Object(da.a)(mg,"StatusBarAggregateControlCollection",qd.a,[]);var li=a(201),Mh=a(84),Ci=a(57),oi;const Wg=[{t8a:0,name:"Average",D2a:-1015637685,u8a:1,Dcb:!0},{t8a:1,name:"Count",D2a:1957769939,u8a:3,Dcb:!1},{t8a:2,name:"NumericalCount",D2a:-1292677035,u8a:2,Dcb:!1},{t8a:3,name:"Minimum",D2a:405783320,u8a:5,Dcb:!0},{t8a:4,name:"Maximum",D2a:1210824414,u8a:4,Dcb:!0},{t8a:5,name:"Sum",D2a:1265371067,u8a:9,Dcb:!0}];let Rh=oi=class{constructor(r){var M;this.mpc=this.lSc=this.mSc=
this.kSc=null;this.Mhb=new gh.a(!0);this.$Eg=0;this.wIg=la=>{const Qa=this.ha.pa.activeCell.clone(),Kb=jd.d(this.ha.pa.selectedRanges);var hc=this.$.na;const Ac=null===hc||void 0===hc?void 0:hc.sheetId,Zc=null===hc||void 0===hc?void 0:hc.hash,Ad=this.$.ea.uh,re=this.$.ea.UP;hc=this.$.listSeparator;const Ge=jd.i(jd.J(Kb),hc,this.$,!1),kf=`=${this.Zg.config.localeInfo.getWorksheetFuncName(485)}({0}${hc}5${hc}{1})`;Promise.all(Wg.map(sf=>this.Zg.evalFormula(String.format(kf,sf.u8a,Ge),Qa,void 0,sf.Dcb?
excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(sf=>{var Lf;const Pf=this.ha.pa.selectedRanges,kg=this.ha.pa.activeCell,yg=null===(Lf=this.$.na)||void 0===Lf?void 0:Lf.sheetId;if(jd.V(Kb,Pf)&&Qa.equals(kg)&&Ac===yg){Lf=[];for(var Xg of sf.entries()){[,sf]=Xg;if(void 0===(null===sf||void 0===sf?void 0:sf.formatted)||!excelOnlineCalc.util.isSuccess(sf.formatted)||!excelOnlineCalc.util.isSuccess(sf.value)){this.U7d();return}sf=this.Zg.iD.renderValue(sf.formatted.value,
excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(sf)){this.U7d();return}sf=excelOnlineCalc.numfmt.renderedValueToString(sf.value);Lf.push(sf)}Xg={};for(var Ig of Wg)Xg[Ig.name]="";Ig=Lf[1];sf=Lf[2];if(1<+Ig&&(Xg.Count=Ig,0<+sf))for(const th of Wg.entries()){const [Ih,ri]=th;Xg[ri.name]=Lf[Ih]}this.mZb(Xg);this.Ktk(Xg,Ig,Ad,re,Kb,Qa,Ac,Zc,la)}}).catch(sf=>{aa.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(sf)}`);
this.U7d()})};this.Lg=()=>{this.aKg()};this.Mh=(la,Qa)=>{la=Qa.wg.hash;Qa=Qa.wg.block;const Kb=Qa.Hha;if(Qa.state&4&&Kb&&Kb!==this.Mhb.getItem(la)){this.Mhb.add(la,Kb);var hc=(la=Qa.Ci)?Yb.g(la.getRowNumbers(),la.getColumnNumbers()):null;ji.a.any(this.ha.pa.selectedRanges,Ac=>Ac.Zf(hc))&&this.aKg()}};this.Yq=(la,Qa)=>{this.Mhb.remove(Qa.wg.hash)};this.Xg=()=>{this.$.ja.Ne(29,la=>{this.statusBarManager=la;la.YL(this);aa.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};
this.vg=(la,Qa)=>{!la.tf&&hg.b(Qa)&&this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null,aa.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.ruk=()=>{let la;const Qa=this.ha.pa.selectedRanges;(()=>{let Kb=this.Bzk(Qa);({yfc:la}=Kb);return Kb})().returnValue?this.mZb(la):this.Img()};this.Img=()=>{var la;const Qa=jd.d(this.ha.pa.selectedRanges),Kb=this.ha.pa.activeCell.clone(),hc=null===(la=this.$.na)||void 0===
la?void 0:la.sheetId;this.yTf(Kb,Qa,Ac=>{var Zc;const Ad=this.ha.pa.selectedRanges,re=this.ha.pa.activeCell,Ge=null===(Zc=this.$.na)||void 0===Zc?void 0:Zc.sheetId;jd.V(Qa,Ad)&&Kb.equals(re)&&hc===Ge&&this.mZb(Ac.Result)})};Db.ee.$e()&&(oi.initData(r),r.Ha.lZ(this));this.$Ef=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5809185_StatusBarAggregatesCSE");this.NOe=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=r;this.gridView=Yb.h(this.$);this.X$=za.AFrameworkApplication.lg;
this.ol=cd.a.Ae;this.mAa=new mg(this.$);this.$.ea.wn(this.vg);this.$.Go(this.Xg);this.ha.qt(this.Lg);this.ha.add_activeCellChanged(this.Lg);this.ya.ot(this.Mh);this.ya.bM(this.Yq);for(const la of Wg)this.ddk(la.t8a,la.name,la.D2a);null!==(M=this.statusBarManager)&&void 0!==M?M:this.statusBarManager=this.$.ja.Qa(29);this.statusBarManager&&this.statusBarManager.YL(this);this.$Ef&&(void wb.a.resolve(Db.u,{Aa:1}).then(la=>this.Zg=la),this.$.ja.Ne(268,la=>{this.instantaneousSupportInformationManager=la}))}$t(r){this.mAa.Cch(r)}Eu(r){this.mAa.ZTj(r)}get s8a(){return this.mAa.s8a}mZb(r){this.mAa.s8a=
r}get ya(){return this.gridView.ya}get ha(){return this.gridView.ha}dispose(){this.$&&(this.$.ea.En(this.vg),this.$.Hp(this.Xg),this.ha.Pt(this.Lg),this.ha.remove_activeCellChanged(this.Lg),this.ya.ys(this.Mh),this.ya.FN(this.Yq),this.fWe());this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null);Ic.a.Wf([this.kSc,this.mSc,this.lSc,this.mAa]);this.$=this.mAa=this.lSc=this.mSc=this.kSc=null;this.Mhb&&(this.Mhb.clear(),this.Mhb=null)}Ov(r,M){return this.yDa(r)&&this.Msf(r,
M)?!0:!1}Msf(r,M){const la=this.yDa(r);if(!la)return!1;const Qa=la.xl;if(r.endsWith("Label"))M.Visible=la.isVisible,Ia.a.An(this.$)?M.LabelText=Qa:M.Value=Qa;else if(r.endsWith("Button"))M.LabelText=Qa,M.On=la.isEnabled,qb.FocusManager.instance().ko(Qb.AFrame.xX);else return!1;return!0}wq(){return!0}Uf(){return!1}executeCommand(r,M){r=this.yDa(M.command);if(!r)return li.a(M.command);r.isEnabled=!r.isEnabled;this.y9i(r.IAc,r.isEnabled);return Fa.Task.Ra(!0)}Kf(r,M){return!!this.yDa(M.command)}Yf(){return!1}yTf(r,
M,la){var Qa=this.$;this.fWe();if(this.$.ea.tf){var Kb=Qa.oa.ua;r=jd.o(r,Qa);M=jd.r(M,Qa);Qa=Kb.Oa(1,null);Qa.activeCell=r;Qa.selectedRanges=M;this.mpc=Bd.h(Kb,"GetStatusBarAggregates",Qa,la,null,null,null,0)}}Bzk(r){let M,la=oi.vIg(r);({yfc:M}=la);return{returnValue:la.returnValue||this.kkh(r)&&this.hkh(r),yfc:M}}Ktk(r,M,la,Qa,Kb,hc,Ac,Zc,Ad){const re=this.NOe?1:.05,Ge=this.NOe?1E3:20;if(Ad||!(this.$Eg>Ge||Math.random()>re))this.$Eg++,this.yTf(hc,Kb,kf=>{var sf,Lf,Pf,kg;if(!oe.a(kf)){var yg=this.ha.pa.selectedRanges,
Xg=this.ha.pa.activeCell,Ig=null===(sf=this.$.na)||void 0===sf?void 0:sf.sheetId;sf=kf.StateId;if(jd.V(Kb,yg)&&hc.equals(Xg)&&Ac===Ig&&la===this.$.ea.uh&&Qa===this.$.ea.UP&&la===sf){var th=kf.Result;sf={};const sk={};Ig=!0;for(var Ih of Wg){var ri=th[Ih.name],lk=r[Ih.name];const tk=ri===lk;sf[Ih.name]=tk;sk[Ih.name]=[ri.length,lk.length];Ig&&(Ig=tk)}({category:Xg}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.uzk(null!==(kg=null===(Pf=null===(Lf=this.gridView.Pe(Xg))||
void 0===Lf?void 0:Lf.cell)||void 0===Pf?void 0:Pf.Ok)&&void 0!==kg?kg:0):{category:"uninitialized"});Lf=yg.length;yg=jd.b(yg);Pf=this.gridView.Pyf()||this.gridView.Oyf();Ih=this.gridView.Be;kg=Ih.RTb;ri=this.gridView.vl("StatusBarAggregates");Ih=Mh.c(hc,Ih.Pl,Ih.om,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(Ci.d)(ri)?ri.value:null);Ih=Ih.X+"_"+Ih.Y+"_"+Ih.PaneType;th=th.Count;ri=r.Count;lk=this.gridView.Je.brc(Kb);kf=`StatusBarAggregateManager.testCalcResult: allCorrect: ${Ig}, ${JSON.stringify(sf)}, numberFormatCategory: ${Xg}, resLength(server,calc): ${JSON.stringify(sk)}, stateId: ${la}, latestSuccessfulStateId: ${Qa}, prevSheetId: ${Ac}, prevSheetHash: ${Zc}, numOfRanges: ${Lf}, numOfCells: ${yg}, prevActiveCell: ${hc}, prevSelectedRanges: ${Kb.join(";")}, sheetHasHidden: ${Pf}, panesState: ${kg}, blockPositionString: ${Ih}, ReportCalcState: ${kf.ReportCalcState}, CalcComplete: ${kf.CalcComplete}, serverCount: ${th}, calcCount: ${ri}, calcCountUnfiltered: ${M}, enumeratorCount: ${lk}, forceTestResult: ${Ad}`;
aa.ULS.sendTraceTag(520426510,0,50,kf);Ig||Ad||window.setTimeout(()=>{this.wIg(!0)},100)}}})}kkh(r){const M=this.gridView.Xk,la=this.gridView.hr;return!!M&&ji.a.all(r,Qa=>M.contains(Qa))&&ji.a.all(r,Qa=>!la.qgb(Qa))}hkh(r){if(500<jd.b(r))return!1;const M=this.ol.zh;r=this.gridView.maa("StatusBarAggregateManager.AreAllCellsEmpty",r);try{for(let la=0;r.$$mn();la++)if(r.$$cu().qL||!(la%25)&&100<Re.c(this.ol,M))return!1}finally{r&&r.dispose()}return!0}yDa(r){return this.mAa.yDa(r)}ddk(r,M,la){this.mAa.o$g(r,
"Query"+M+"Label","Query"+M+"Button",la.toString())}aKg(){var r;if(this.$.Wg&4&&!this.gridView.De&&!this.gridView.Fm){var M;(()=>{let la=oi.vIg(this.ha.pa.selectedRanges);({yfc:M}=la);return la})().returnValue?this.mZb(M):(this.mZb(null),this.$Ef&&(null===(r=this.Zg)||void 0===r?0:r.Avc)?this.f4j():this.kSc=wd.AsyncMethodContext.Rx(this.ruk,500,gd.a.uqk,this.kSc))}}f4j(){this.lSc=wd.AsyncMethodContext.Rx(()=>this.wIg(!1),10,gd.a.vqk,this.lSc)}U7d(){this.mSc=wd.AsyncMethodContext.Rx(this.Img,500,gd.a.tqk,
this.mSc)}fWe(){this.mpc&&(this.X$.Az(this.mpc.My),this.mpc=null)}y9i(r,M){const la={};la.a=this.$.xa.UserSessionId;la.b=r;la.c=M;fg.b().Fi(29,la)}static initData(r){const M=ac.a.j$;for(const la of Wg)M(la.D2a,Ia.a.An(r)?Lc.a.Hi|8192:Lc.a.Hi,0,0)}static ta(r){oi.initData(r);const M=new oi(r);r.Ha.lZ(M);r.ja.$c(27,M)}static vIg(r){return{returnValue:1===r.length&&r[0].isSingle,yfc:null}}};Rh=oi=Object(hb.__decorate)([Object(wb.d)(Db.ee),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(df.l)())],
Rh);Object(da.a)(Rh,"StatusBarAggregateManager",null,[292,2,256,169,165]);var Di=a(1284),xh=a(966);class fh{}fh.Cuk=864E5;fh.Egh=3;fh.Ekj=144E5;Object(da.a)(fh,"AddinConstantsNum",null,[]);var bi=a(810),ei=a(887),Xf=a(886);class lh{constructor(r,M,la,Qa){this.fa=(Qa=void 0===Qa?null:Qa)?Qa:za.AFrameworkApplication.fa;this.R0c=2;this.aVa=r;this.X7g=M;this.Ve=la}get csa(){return this.R0c}get AHk(){return this.X7g}T6d(r){if(this.fa.la("AgaveSupportsLiveIdSpoofing")){var M=(new Date).getTime();this.aVa(r,
this.csa,{["ak0"]:M})}else if(Xf.a.Khk(r)){M=String.format(za.AFrameworkApplication.ra.Pa.g1+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",za.AFrameworkApplication.ra.Pa.Cj,this.AHk,za.AFrameworkApplication.ml);const la=za.AFrameworkApplication.lg;let Qa=null;this.Ve&&(Qa=this.Ve.Sf("ComponentAttach",ei.a[r]+xh.a[this.csa]));la.ir(M,1,null,null,!0,4,Kb=>{this.aAj(r,Kb.data.responseData);Qa&&Qa.stop()},Kb=>{aa.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",
Kb.data.httpStatus);this.ekb(r,1,"request failed");Qa&&Qa.stop()},null)}else Xf.a.myf(r)?(M=Xf.a.Ulf(r),this.aVa(r,this.csa,{["ak0"]:M})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.$H?this.ekb(r,1,"no local timestamp"):this.aVa(r,this.csa,null))}aAj(r,M){if(M&&""!==M)if(M=Sys.Net.XMLDOM(M)){Xf.a.mKa(bi.a.GNe,((new Date).getTime()+fh.Ekj).toString(),r);let la=M.getElementsByTagName("update");la&&la.length||(la=M.getElementsByTagName("o:update"));
la&&0<la.length?(M=Date.parse(la[0].firstChild.nodeValue),Xf.a.Ulf(r)<M||Xf.a.myf(r)?this.aVa(r,this.csa,{["ak0"]:M}):this.ekb(r,1,"outdate timestamp in reponse")):this.ekb(r,2,"no timestamp in response")}else this.ekb(r,1,"response data is invalid");else this.ekb(r,1,"no responseData")}ekb(r,M,la){this.$H&&this.aVa(r,this.csa,{["AddinServiceUserState"]:M,["DiagnosticInfo"]:la})}get $H(){return this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}}Object(da.a)(lh,"AddinCommandsAnonymousAPIInitializer",null,[379]);class Ei{constructor(r,M,la){this.R0c=la;this.aVa=r;this.ek=M}get csa(){return this.R0c}T6d(r){let M=null;this.ek&&(M=this.ek.Sf("ComponentAttach",ei.a[r]+xh.a[this.csa]));if(null==this.Rbe(r)?0:this.Rbe(r)){const la=(new Date).getTime()-fh.Egh*fh.Cuk;this.aVa(r,this.csa,{["ak0"]:la})}M&&M.stop()}}Object(da.a)(Ei,"AddinCommandsInitializerBase",null,[379]);class wi extends Ei{constructor(r,M){super(r,M,5)}Rbe(){return!0}}Object(da.a)(wi,
"AddinCommandsInitializer",Ei,[]);class yi extends Ei{constructor(r,M){super(r,M,1)}Rbe(r){try{const M=bi.a.dpf()+r;return Boolean.parse(this.sii(M)||"false")}catch(M){aa.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",M.toString())}return null}sii(r){const M=localStorage;return void 0!==M&&null!==M?M.getItem(r):null}}Object(da.a)(yi,"AddinCommandsLocalCacheInitializer",Ei,[]);var Ji=a(588);class Ki{constructor(r,M){M=void 0===M?null:M;this.Ve=r;this.fa=M?M:za.AFrameworkApplication.fa}get appUILocale(){return Ji.a.wP(za.AFrameworkApplication.lcid).name}kNi(){const r=
this.bwd();if(r)if(this.fa.la("OcpsIsEnabled"))mc.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(M=>{M.isFeatureEnabled("ConnectedServices",!0).then(la=>{for(const Qa of r){if(!la&&0===Qa.key){this.$H&&this.kHg(0,Qa.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Kb=this.tlf(Qa.value);Kb&&Kb.T6d(Qa.key)}return null})});else for(const M of r){const la=this.tlf(M.value);la&&la.T6d(M.key)}}U6d(r,M,la){la&&la[bi.a.ePa]?
(la[bi.a.c4]=r,la[bi.a.tZ]=M,this.X_d(zb.a.lla,la),Xf.a.mKa(bi.a.ePa,la[bi.a.ePa].toString(),r)):this.$H?this.kHg(r,M,la):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===r&&(la={},la[bi.a.c4]=r,la[bi.a.tZ]=M,this.X_d(zb.a.nA,la))}tlf(r){let M=null;switch(r){case 1:M=new yi(Object(Ka.a)(this,this.U6d,"retrieveAddinFlagCompleted"),this.Ve);break;case 2:M=new lh(Object(Ka.a)(this,this.U6d,"retrieveAddinFlagCompleted"),this.appUILocale,this.Ve,
this.fa);break;case 5:M=new wi(Object(Ka.a)(this,this.U6d,"retrieveAddinFlagCompleted"),this.Ve)}return M}kHg(r,M,la){0===r&&la&&la[bi.a.Scc]&&(la[bi.a.c4]=r,la[bi.a.tZ]=M,aa.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",la[bi.a.Scc].toString(),JSON.stringify(la)),this.X_d(zb.a.nA,la))}get $H(){return this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}}Object(da.a)(Ki,"AddinCommandsInitializerHost",null,[]);var zi=a(281),ig=a(855),ch=a(270),Li=a(370);let Vi;class Si extends Bc.StandardDialog{constructor(r,M){super();this.nqe=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.jte=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.kte=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.$vb=!1;this.MAb=()=>{this.hide();this.$vb&&n(this.Jma)};this.Bmj=()=>{ig.a.instance.getItem("optedIntoAddinDeveloperMode")?(ig.a.instance.removeItem("optedIntoAddinDeveloperMode"),
this.$vb=!1):(ig.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.$vb=!0)};this.Jma=r;Vi=M}showDialog(r,M){try{this.xh=void 0===this.xh||null===this.xh?ch.a.iVb(Li.a.T8).toString():this.xh,this.show({["type"]:"StandardDialogProps",["id"]:this.xh,["dialogIcon"]:3,["headerText"]:r,["titleText"]:M,["resultHandler"]:this.MAb,["messageAreaLink"]:this.uKh(),["permanentDismissCheckbox"]:this.qKh(),["renderMicrosoftLogoInHeader"]:!1})}catch(la){this.XUc(r,M)}}uKh(){return{["type"]:"AppLinkProps",
["id"]:"WACDialogExtraLink",["text"]:this.jte,["handler"]:{["href"]:this.kte,["target"]:"_blank"},["onExecute"]:null}}qKh(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.nqe,["onExecute"]:this.Bmj}}XUc(r,M){const la=new pa.a(!1,!1,!1);la.Ye=1;la.xh=ch.a.iVb(Li.a.T8).toString();la.Wi=String.format(this.$_(),M,this.kte,this.jte,this.nqe);la.initializeAndShow(r,this.tSg,{optInCheckbox:!1})}tSg(r,M){1==r&&M.optInCheckbox&&(ig.a.instance.getItem("optedIntoAddinDeveloperMode")?
(ig.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.$vb=!1):(ig.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.$vb=!0,n(this.Jma)))}$_(){return ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}
Object(da.a)(Si,"AppsForOfficeDeveloperModeOptInDialog",Bc.StandardDialog,[]);var Mi=a(399);class Ti extends Ki{constructor(r){super(r.Ve);this.Jma=this.n5b=null;this.aNa=new zi.a;this.Zhg=M=>{1===M&&this.Jma&&this.Yhg()};this.$=r;Di.a.HKb=Di.a.ygf}get appUILocale(){return this.$.xa.UICultureTag}bIg(){this.kNi();this.Tzk()}bwd(){const r=new Mi.a;this.$.ea.qk.get(27)&&(r.da(0,2),""!==za.AFrameworkApplication.fa.Ta("HostInstallAddIns")&&r.da(16,5));this.$.ea.qk.get(33)&&r.da(1,1);ya.EwaSettings.Ia(52)&&
r.da(8,1);this.$.oh.get(35)&&r.da(10,5);return r}X_d(r,M){this.TXh(()=>{const la=new rf.a(r,0,this.$.zf,0,null);this.$.Ha.Me(la,M)})}TXh(r){(M=>{M=this.$.ja.Qa(M);return!!M&&$d.d(M)})(198)?(new Ue.a,this.$.ja.Ne(198,M=>{r(M)})):r(null)}Tzk(){this.Jma=za.AFrameworkApplication.fa.Ta("DevAddinManifestFileUrl");this.n5b=za.AFrameworkApplication.fa.Ta("DevAddinManifestGuid");var r=za.AFrameworkApplication.fa.Ta("IsDevAddinTest");if(this.Jma&&this.n5b&&r){r="true"===r;var M=this.aNa.getItem("optedIntoAddinDeveloperMode");
const la=this.aNa.getItem(this.n5b);M||r&&za.AFrameworkApplication.fa.la("SuppressDeveloperAddinDialogs")?ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8479120_DisableAddInsWhenWholeAppsForOfficeFeatureDisabled")&&za.AFrameworkApplication.disableWholeAppsForOfficeFeature||!(la||r&&za.AFrameworkApplication.fa.la("SuppressDeveloperAddinDialogs"))?(r=new Bc.StandardDialog,r.Ye=4,M=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.Jma)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,r.$X(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,M,this.Zhg)):this.Yhg():(r=new Si(this.Jma,this.Zhg),r.Ye=0,r.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}Yhg(){const r=ze.GetServiceTaskFactory.create(this.$.ja,106,this.$.qa,1);zd.TaskExtensions.Ca(r,()=>{r.result.Ji.validateAndCacheNewDevAddinManifest(this.Jma);
this.aNa.setItem(this.n5b,"true")},this.$.qa,3)}}Object(da.a)(Ti,"AddinCommandsInitService",Ki,[341]);class Ni extends cb.a{constructor(r){super();this.addinCommandsInitService=null;this.vg=()=>{aa.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.tf}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.Wg&16384)}] `);this.addinCommandsInitService.bIg();this.$.ea.En(this.vg)};this.$=r;this.Dg()}create(){this.$.ja.Ne(53,()=>{this.Df(Object(pb.a)(this.$.ja,
202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new Ti(this.$))));this.$.ea.tf?(aa.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.Wg&16384)}] `),this.addinCommandsInitService.bIg()):this.$.ea.wn(this.vg)})}static ta(r){r.ja.$c(201,new Ni(r))}}Object(da.a)(Ni,"AddinCommandsInitServiceFactory",cb.a,[]);var Oi=a(142);let Ai=class{constructor(r){r.zP(M=>{void M.y5(1).then(()=>
{const la=document.createElement("div"),Qa=Object(Yb.h)(r).xn;appChrome.renderProactiveSuggestionDebugPane(la,Qa,Oi.a.vz)})});ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&void(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateRecognizedTableGridHighlighter")?wb.a.resolve(Db.td,{Aa:1}):ze.GetServiceTaskFactory.$Ib(r.ja,510,511,1))}};Ai=Object(hb.__decorate)([Object(wb.d)(Db.ld),Object(hb.__param)(0,Object(Db.nb)())],Ai);Object(da.a)(Ai,"ProactiveSuggestionDebugToolsManager",
null,[]);class Bi extends cb.a{constructor(r){super();this.$=r;this.Dg()}static ta(r){r.ja.$c(509,new Bi(r))}create(){this.Df(Object(pb.a)(this.$.ja,508,()=>new Ai(this.$)))}}Object(da.a)(Bi,"ProactiveSuggestionDebugToolsManagerFactory",cb.a,[]);class Yh{static qii(r){try{return caches.open(Yh.Kpe).then(M=>M.match(r))}catch(M){return Promise.reject(null)}}static tDa(r,M){try{return Yh.qii(r).then(la=>la&&Number.parseInvariant(la.headers.get("cachedTime"))>Date.now()-M?Promise.resolve(la.text().toLocaleString()):
Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(la){return Promise.reject(null)}}static store(r,M){try{return caches.open(Yh.Kpe).then(la=>{la.put(r,M).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(la){return Promise.resolve(!0)}}static Tqk(r,M){const la={};la.body=M;const Qa={};Qa.cachedTime=Date.now().toString();la.headers=Qa;M=new Response(M,la);Yh.store(r,M).then(()=>!0)}}Yh.Kpe="ConsentState";Object(da.a)(Yh,"CacheManager",null,[]);class vi{constructor(){this.message=
null;this.httpStatusCode=0}}Object(da.a)(vi,"HttpRequstToPromiseRejectData",null,[]);class ki{constructor(r){this.E3=r}d1(r,M,la,Qa,Kb,hc){jc.a.sendTelemetryEvent(Object.assign(new Rc.a,{name:"Office.Online."+r,dataFields:[Object.assign(new Uc.a,{name:"EventMessage",string:M}),Object.assign(new Uc.a,{name:"FormFactor",string:this.E3.formFactor}),Object.assign(new Uc.a,{name:"CorrelationId",string:this.E3.correlationId}),Object.assign(new Uc.a,{name:"AccountType",string:this.E3.accountType}),Object.assign(new Uc.a,
{name:"OSVersion",string:this.E3.osVersion}),Object.assign(new Uc.a,{name:"AppId",string:this.E3.appId}),Object.assign(new Uc.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new Uc.a,{name:"ConsentLanguage",string:this.E3.consentLanguage}),Object.assign(new Uc.a,{name:"EventCode",string:la}),Object.assign(new Uc.a,{name:"Region",string:this.E3.region}),Object.assign(new Uc.a,{name:"ModelType",string:Qa}),Object.assign(new Uc.a,{name:"ModelId",string:Kb}),Object.assign(new Uc.a,{name:"Platform",
string:this.E3.os}),Object.assign(new Uc.a,{name:"ReConsentReason",string:""}),Object.assign(new Uc.a,{name:"ConsentType",string:hc})]}))}}Object(da.a)(ki,"TelemetryLogger",null,[]);var Pi=a(227);class gi{constructor(r,M,la){this.qXg="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Fa=r;this.xk=M;this.Oza=la;this.cV=new ki(la)}hS(r,M){return new Promise((la,Qa)=>{const Kb=this.Fa.Ng("UCNoticeCheckinCallTimeoutMs",5E3);let hc=this.Fa.Ta("UCNoticeCheckinStateUrl");hc&&hc.length||
(hc=this.qXg);this.xk.o$(hc,1,null,this.CIb(r),null,!1,0,Ac=>{try{if(void 0===Ac||null===Ac||void 0===Ac.data||null===Ac.data||void 0===Ac.data.responseData||null===Ac.data.responseData){this.cV.d1("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const Ad=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Qa(this.LM(Ad,Ac))}else if(Ac.data.httpStatus!==
Pi.a.tL){this.cV.d1("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",Ac.data.httpStatus.toString(),null,null,null);const Ad=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Ac.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Qa(this.LM(Ad,Ac))}else{var Zc=M(Ac.data.responseData);if(Zc)la(Zc);else{this.cV.d1("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty",
"712",null,null,null);const Ad=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");Qa(this.LM(Ad,Ac))}}}catch(Ad){this.cV.d1("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Zc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Ad,"UnifiedConsent.ConsentGetFailed"),Qa(this.LM(Zc,Ac))}},Ac=>{this.cV.d1("UnifiedConsent.ConsentGetFailed",
"CheckInApi : Error in service call ",Ac.data.httpStatus.toString(),null,null,null);const Zc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",Ac.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Qa(this.LM(Zc,Ac))},null,void 0,void 0,2500,Kb)})}LM(r,M){const la=new vi;la.message=r;la.httpStatusCode=M&&M.data?M.data.httpStatus:-1;return la}CIb(r){const M={};M["Accept-Language"]=this.Oza.consentLanguage;M.consentsurface="AppStart";
M.platform="Web";M.formfactor=Cc.a.t6?"Mobile":"Desktop";M["x-Cid"]=this.Oza.correlationId;M.Authorization="Bearer "+r;return M}}Object(da.a)(gi,"HttpRequestToPromiseUtility",null,[]);class Qi{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=
!1}}Object(da.a)(Qi,"WebSdkAdapterProps",null,[]);class ph{constructor(r,M,la,Qa){this.ive=this.Ema=this.E9=this.y3=null;this.LCj=Kb=>{if(void 0===Kb||null===Kb)return this.cV.d1(ph.VMa,"Checkin response undefined or null","705",this.y3,this.E9,this.Ema),null;try{const {ev:hc}=Hb.d(Kb);return hc}catch(hc){this.cV.d1(ph.VMa,"Checkin response parse error : "+hc.message,"706",this.y3,this.E9,this.Ema)}return null};this.c4a=Qa;this.Fa=r;this.PVg=la;this.xk=M;this.Oza=this.getDimensions();this.cV=new ki(this.Oza)}hzg(){"MSA"===
(this.Fa.Ta("HostAuthType")||"").toUpperCase()&&Yh.tDa(this.Oza.userId,this.Fa.Ng("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.cV.d1(ph.VMa,"CacheFound","701",this.y3,this.E9,this.Ema);return{}}).catch(()=>{this.PVg.execute(r=>{r.xD("Consent",ph.M6g).then(M=>{M.IsSuccess?(this.cV.d1(ph.VMa,"CheckInTokenSuccess","702",this.y3,this.E9,this.Ema),this.aki(M.Token).then(la=>{this.tri(la);this.y3&&""!==this.y3&&r.xD("Consent",ph.O6g).then(Qa=>{Qa.IsSuccess?(this.cV.d1(ph.VMa,"WebTokenSuccess","703",
this.y3,this.E9,this.Ema),this.plk(Qa,this.y3)):this.cV.d1(ph.VMa,"WebTokenFailed : "+Qa.ErrorMessage,Qa.ErrorCode,this.y3,this.E9,this.Ema);return{}});return{}})):this.cV.d1(ph.VMa,"CheckInTokenFailed : "+M.ErrorMessage,M.ErrorCode,this.y3,this.E9,this.Ema);return{}})})})}aki(r){this.ive=new gi(this.Fa,this.xk,this.Oza);return this.ive.hS(r,this.LCj).then(M=>Promise.resolve(M),M=>Promise.reject("Error while getting result"+M))}tri(r){for(const M of r.consentValues)if(M.needConsent&&!M.maxPromptsReached){this.E9=
M.id;this.Ema=M.consentType;this.y3=M.modelType;return}Yh.Tqk(this.Oza.userId,Hb.c(r))}plk(r,M){if(Na.a("showConsentNotice")){const la=document.createElement("div");document.body.appendChild(la);appChrome.api.showConsentNotice(this.Kli(r.Token,M),la)}else this.cV.d1(ph.x1g,"1JS : ShowConsentNotice API not found","704",this.y3,this.E9,this.Ema)}Kli(r,M){const la=this.Oza;la.token=r;la.modelType=M;return la}getDimensions(){const r=this.tFd(this.Fa.Ta("SessionStartInfoJson"));return Object.assign(new Qi,
{emailId:this.Fa.Ta("UserPrincipalName"),userId:this.Fa.Ta("LoggableUserId"),accountType:"AAD"===(this.Fa.Ta("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Fa.Ta("OfficeApplicationId"),appVersion:this.Fa.Ta("appVersion"),appName:"Application"in r?r.Application:"",appEnv:this.c4a,consentLanguage:this.Fa.Ta("UICulture")||"en-US",formFactor:Cc.a.t6?"Mobile":"Desktop",os:"Os"in r?r.Os:"",osVersion:"OsVersion"in r?r.OsVersion:"",region:this.Fa.Ta("region"),correlationId:Ef.a.create().toString(),
isDarkMode:this.Fa.la("DarkModeIsOn"),useCache:!0})}tFd(r){let M={};try{M=Hb.b(r)}catch(la){}return M}}ph.O6g="https://consentservice.microsoft.com/web";ph.M6g="https://consentservice.microsoft.com/checkin";ph.x1g="UnifiedConsent.ConsentGetFailed";ph.VMa="UnifiedConsent.AuthTokenStatus";Object(da.a)(ph,"ConsentNoticeManager",null,[352]);class Nh{constructor(){this.$b=null}get name(){return"Common.App.ConsentNoticeDialog"}dl(r){this.$b=r;r.register(ph,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").If().Rf(()=>
new ph(za.AFrameworkApplication.fa,za.AFrameworkApplication.lg,r.We("Common.App.OAuth.IOAuthManager"),za.AFrameworkApplication.jSa))}init(){this.$b.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){Tb.a.instance.Ul(new Nh)}}Object(da.a)(Nh,"ConsentNoticeDialogPackage",null,[4,5]);let Oh=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");Nh.main();mc.a.instance.We("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(r=>r.hzg())}};
Oh=Object(hb.__decorate)([Object(wb.d)(Db.oe)],Oh);Object(da.a)(Oh,"UnifiedConsentAdapter",null,[]);let Sh=class{constructor(r){this.FZf=()=>{this.f3a(this.$.ea.pKa,this.$.ea.f_a);this.AEk()};this.$=r;this.shortcutKeyManager=this.$.shortcutKeyManager;this.isMac=Cc.a.isMac;ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.aMe(this.FZf)}dispose(){ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||
this.shortcutKeyManager.hkg(this.FZf);this.$=null}Z$j(){const r=this.$Ah.concat(this.xfj).map(M=>appChrome.actions.setControlCustomTooltip(M.commandId,this.Rdb(M)));appChrome.api.dispatch(r)}f3a(r,M){this.RAk&&(this.GR[0].title=this.GR[2].title=this.$qb(r),this.GR[1].title=this.F1b(M),this.GR[1].shortcut=this.isMac?this.shortcutKeyManager.vi(192):this.shortcutKeyManager.vi(154));r=this.Rdb(this.GR[1]);M=this.Rdb(this.GR[2]);r=[appChrome.actions.setControlCustomTooltip(this.GR[0].commandId,this.Rdb(this.GR[0])),
appChrome.actions.setControlCustomTooltip(this.GR[1].commandId,r),appChrome.actions.setControlCustomTooltip(this.GR[2].commandId,M)];appChrome.api.dispatch(r)}get xfj(){this.PL||(this.PL=[],this.PL.push(this.Al("Paste_MLR",wc.a.instance.za(513),wc.a.instance.za(767),this.shortcutKeyManager.vi(176))),this.PL.push(this.Al("Cut",wc.a.instance.za(511),wc.a.instance.za(768),this.shortcutKeyManager.vi(172))),this.PL.push(this.Al("Copy",wc.a.instance.za(512),wc.a.instance.za(769),this.shortcutKeyManager.vi(174))),
this.PL.push(this.Al("AlignTop_MLR",wc.a.instance.za(791),wc.a.instance.za(792))),this.PL.push(this.Al("AlignMiddle_MLR",wc.a.instance.za(793),wc.a.instance.za(794))),this.PL.push(this.Al("AlignBottom_MLR",wc.a.instance.za(795),wc.a.instance.za(796))),this.PL.push(this.Al("AlignLeft_MLR",wc.a.instance.za(797),wc.a.instance.za(799))),this.PL.push(this.Al("AlignCenter_MLR",wc.a.instance.za(800),wc.a.instance.za(801))),this.PL.push(this.Al("AlignRight_MLR",wc.a.instance.za(802),wc.a.instance.za(803))),
this.PL.push(this.Al("IncreaseIndent",wc.a.instance.za(804),wc.a.instance.za(805))),this.PL.push(this.Al("DecreaseIndent",wc.a.instance.za(806),wc.a.instance.za(807))),this.PL.push(this.Al("Wrap",wc.a.instance.za(808),wc.a.instance.za(809))),this.PL.push(this.Al("Merge",wc.a.instance.za(810),wc.a.instance.za(811))),this.PL.push(this.Al("NumberFormatPercentage_MLR",wc.a.instance.ia(453),wc.a.instance.za(814),this.shortcutKeyManager.vi(404))),this.PL.push(this.Al("NumberFormatComma_MLR",wc.a.instance.za(815),
wc.a.instance.za(816))));return this.PL}get $Ah(){this.Sr||(this.Sr=[],this.Sr.push(this.Al("UndoRedo",wc.a.instance.za(83),"",this.isMac?this.shortcutKeyManager.vi(191):this.shortcutKeyManager.vi(153))),this.Sr.push(this.Al("FormatPainter",wc.a.instance.ia(14),wc.a.instance.za(770))),this.Sr.push(this.Al("FontName_New",wc.a.instance.za(771),wc.a.instance.za(772))),ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModernFontPicker",!1)&&this.Sr.push(this.Al("FontPicker",wc.a.instance.za(771),
wc.a.instance.za(772))),this.Sr.push(this.Al("FontSize",wc.a.instance.za(773),wc.a.instance.za(774))),this.Sr.push(this.Al("Bold",wc.a.instance.ia(1333),wc.a.instance.za(775),this.isMac?this.shortcutKeyManager.vi(180):this.shortcutKeyManager.vi(179))),this.Sr.push(this.Al("Italic",wc.a.instance.ia(1334),wc.a.instance.za(776),this.isMac?this.shortcutKeyManager.vi(184):this.shortcutKeyManager.vi(183))),this.Sr.push(this.Al("BordersSplitButtonCompactMenu",wc.a.instance.za(777),wc.a.instance.za(779),
this.isMac?this.shortcutKeyManager.vi(190):this.shortcutKeyManager.vi(189))),this.Sr.push(this.Al("FillColor",wc.a.instance.ia(537),wc.a.instance.za(780))),this.Sr.push(this.Al("FontColor",wc.a.instance.za(781),wc.a.instance.za(782))),this.Sr.push(this.Al("GrowFontSize",wc.a.instance.za(783),wc.a.instance.za(784),this.shortcutKeyManager.vi(187))),this.Sr.push(this.Al("ShrinkFontSize",wc.a.instance.za(785),wc.a.instance.za(786),this.shortcutKeyManager.vi(188))),this.Sr.push(this.Al("Underline",wc.a.instance.ia(1335),
wc.a.instance.za(787),this.isMac?this.shortcutKeyManager.vi(182):this.shortcutKeyManager.vi(181))),this.Sr.push(this.Al("Strikethrough",wc.a.instance.ia(1336),wc.a.instance.za(788),this.isMac?this.shortcutKeyManager.vi(186):this.shortcutKeyManager.vi(185))),this.Sr.push(this.Al("DoubleUnderline",wc.a.instance.za(789),wc.a.instance.za(790))),this.Sr.push(this.Al("NumberFormatNew",wc.a.instance.za(812),wc.a.instance.za(813))),this.Sr.push(this.Al("NumberFormatAccountingNew",wc.a.instance.ia(449),wc.a.instance.za(817))),
this.Sr.push(this.Al("IncreaseDecimal",wc.a.instance.za(818),wc.a.instance.za(819))),this.Sr.push(this.Al("DecreaseDecimal",wc.a.instance.za(820),wc.a.instance.za(821))),this.Sr.push(this.Al("ConditionalFormatting",wc.a.instance.za(822),wc.a.instance.za(823))),this.Sr.push(this.Al("CellStylesGallery",wc.a.instance.za(824),wc.a.instance.za(825))),this.Sr.push(this.Al("FormatAsTableAlt",wc.a.instance.za(826),wc.a.instance.za(827))),this.Sr.push(this.Al("Format",wc.a.instance.za(828),wc.a.instance.za(829))),
this.Sr.push(this.Al("AutoSum",wc.a.instance.za(830),wc.a.instance.za(831),this.shortcutKeyManager.vi(259))),this.Sr.push(this.Al("SortAndFilter",wc.a.instance.za(832),wc.a.instance.za(833))),this.Sr.push(this.Al("FindAndSelect",wc.a.instance.za(834),wc.a.instance.za(835),this.shortcutKeyManager.vi(85))),this.Sr.push(this.Al("AnalyzeData",wc.a.instance.za(836),wc.a.instance.za(837))),this.Sr.push(this.Al("Sensitivity",wc.a.instance.za(838),wc.a.instance.za(839))),this.Sr.push(this.Al("InsertCells",
wc.a.instance.ia(345),wc.a.instance.za(840),this.shortcutKeyManager.pX?this.shortcutKeyManager.vi(409):"")),this.Sr.push(this.Al("DeleteCells",wc.a.instance.ia(409),wc.a.instance.za(841),this.shortcutKeyManager.pX?this.shortcutKeyManager.vi(407):"")),this.Sr.push(this.Al("ClearCells",wc.a.instance.za(842),wc.a.instance.za(843))));return this.Sr}get RAk(){this.GR||(this.GR=[],this.GR.push(this.Al("Undo",this.$qb(2),wc.a.instance.za(765),this.isMac?this.shortcutKeyManager.vi(191):this.shortcutKeyManager.vi(153))),
this.GR.push(this.Al("Redo",this.F1b(2),wc.a.instance.za(766),this.isMac?this.shortcutKeyManager.vi(192):this.shortcutKeyManager.vi(154))),this.GR.push(this.Al("UndoRedo",this.$qb(2),"",this.isMac?this.shortcutKeyManager.vi(191):this.shortcutKeyManager.vi(153))));return this.GR}Al(r,M,la,Qa){return{commandId:r,title:M,description:la,shortcut:Qa,MHi:Qa?!0:!1}}Rdb(r){let M;M=r.title;r.MHi&&(M+=" "+r.shortcut);"UndoRedo"!==r.commandId&&(M+="\n\n"+r.description);return M}$qb(r){switch(r){case 1:case 0:return r=
wc.a.instance.za(81);case 3:return r=wc.a.instance.za(84);case 2:return r=wc.a.instance.za(83);case 4:return r=wc.a.instance.za(82);default:return r=wc.a.instance.za(81)}}F1b(r){switch(r){case 1:case 0:return r=wc.a.instance.za(78);case 2:return r=wc.a.instance.za(80);case 4:return r=wc.a.instance.za(79);default:return r=wc.a.instance.za(78)}}AEk(){var r=this.Al("InsertCells",wc.a.instance.ia(345),wc.a.instance.za(840),this.shortcutKeyManager.pX?this.shortcutKeyManager.vi(409):"");const M=this.Al("DeleteCells",
wc.a.instance.ia(409),wc.a.instance.za(841),this.shortcutKeyManager.pX?this.shortcutKeyManager.vi(407):"");r=[appChrome.actions.setControlCustomTooltip(r.commandId,this.Rdb(r)),appChrome.actions.setControlCustomTooltip(M.commandId,this.Rdb(M))];appChrome.api.dispatch(r)}};Sh=Object(hb.__decorate)([Object(wb.d)(Db.tb),Object(hb.__param)(0,Object(Db.nb)())],Sh);Object(da.a)(Sh,"ExtendedTooltipsManager",null,[2]);var Z=a(368);const tb=(r,M)=>{M=void 0===M?!1:M;r=new Mf.Range(r.top,r.left,r.bottom,r.right,
!1,M);if(M&&(1>r.top||r.top>r.maxRows||1>r.bottom||r.bottom>r.maxRows||r.top>r.bottom||1>r.left||r.left>r.maxColumns||1>r.right||r.right>r.maxColumns||r.left>r.right))throw aa.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return r};var $b=a(904),Yc=a(872),rd=a(335),Vd=a(865);const pe={[0]:[45],[1]:[46]};class Ze{constructor(r){this.$=r;this.sessionStorage=new Map;this.doUndo=()=>{const M=this;return Lo(function*(){yield Object($b.e)(M.$)})};
this.highlightRangesOnGrid=(M,la,Qa)=>{const Kb=this;return Lo(function*(){Kb.highlightRanges(M,la,pe[Qa])})};this.openLearnMore=()=>{const M=this;return Lo(function*(){Object($b.f)(M.$)})};this.openCustomNumberFormat=()=>{const M=this;return Lo(function*(){return new Promise(la=>{Object($b.a)(M.$,Qa=>{la(Qa);aa.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Qa?"OK":"Cancel"}"`)})})})};this.openFeedback=M=>{const la=this;return Lo(function*(){Object($b.g)(la.$,
M)})};this.sendOtelEvent=M=>Lo(function*(){Object(Yc.b)(M)});this.containsHiddenCells=M=>l(this.$,M);this.getSessionStorageItem=(M,la)=>{const Qa=this;return Lo(function*(){var Kb;return null===(Kb=Qa.sessionStorage.get(M))||void 0===Kb?void 0:Kb.get(la)})};this.setSessionStorageItem=(M,la,Qa)=>{const Kb=this;return Lo(function*(){var hc;Kb.sessionStorage.has(M)||Kb.sessionStorage.set(M,new Map);null===(hc=Kb.sessionStorage.get(M))||void 0===hc?void 0:hc.set(la,Qa)})};this.replaceMultipleStrings=
(M,la,Qa,Kb)=>{const hc=this;return Lo(function*(){const Ac=M.map(Zc=>tb(Zc,!1));return h(hc.$,Ac,la,Qa,{["SheetName"]:hc.$.na.sheetName,["MatchCase"]:Kb.matchCase,["MatchEntireCell"]:Kb.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:la,["ReplaceWholeWordOnly"]:Kb.replaceWholeWordOnly})})};this.trimWhitespace=(M,la)=>{const Qa=this;return Lo(function*(){const Kb=M.map(hc=>tb(hc,!1));return u(Qa.$,Kb,la.map(f))})};this.formatCells=(M,la)=>{const Qa=
this;return Lo(function*(){const Kb=M.map(Ac=>tb(Ac,!1)),hc={NumberFormatOptions:Object(V.a)(new Vd.a,{NumberFormatCategory:-1,CustomFormatString:la}),ValidMembers:32,NumberFormat:15};return t(Qa.$,Kb,hc)})}}get grid(){return Yb.h(this.$)}highlightRanges(r,M,la){la=void 0===la?[45]:la;const Qa=this.grid.Se;Qa.Fl(la,!1,!0);Qa.lo(null,la,!1);if(null===r||void 0===r?0:r.length){const Kb=Z.a.C2a(Dg.d(this.$.na),r.map(hc=>tb(hc,!1)));Qa.GG(Kb,la,!0,void 0,!1);M&&this.igj(r)}Qa.update(!1)}igj(r){if(null===
r||void 0===r?0:r.length){const M=this.grid;[r]=r.sort((la,Qa)=>la.top<Qa.top?-1:la.top>Qa.top?1:0);r=Mf.Range.Pf(r.top,r.left);M.ZC(r)||(aa.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),M.jB(r,0,"DataCleansing"))}else aa.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(da.a)(Ze,"HostAppCallbacks",null,[323]);class tf{constructor(){this.errorState=null;this.isFeedbackAllowed=this.isInCoauthoring=
this.isInViewMode=!1}}Object(da.a)(tf,"HostState",null,[]);class Nf{constructor(){this.sheetName=this.sheetId=null;this.isProtected=this.isInNamedSheetView=!1}}Object(da.a)(Nf,"WorksheetState",null,[]);class Bg{constructor(){this.annotations=[];this.hostState=new tf;this.worksheetState=new Nf}}Object(da.a)(Bg,"DataCleansingHostState",null,[]);class Ng{constructor(r){this.$=r;this.o7e=this.n7e=!1}get isEnabled(){return ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",
!1)||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)}show(r,M){M=void 0===M?!1:M;const la=!M;if(this.isEnabled&&!(M&&this.o7e||la&&this.n7e)){if(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7813501_CalloutOneSuggestion")){if(1>r){aa.ULS.sendTraceTag(508913414,0,50,`DataCleansing.showCallout: suggestion count(${r}).`);return}if(2>r&&la){aa.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${r}) is below threshold to show teaching callout`);
return}}else if(2>r){aa.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${r}) is below threshold to show teaching callout`);return}aa.ULS.sendTraceTag(508887310,0,50,`DataCleansing.showCallout: dispatchShowCalloutCommand. coolDown:(${la}).`);Object($b.c)(this.$,r,M);M?this.o7e=!0:this.n7e=!0}}}Object(da.a)(Ng,"TeachingCallout",null,[]);var sg=a(180);class wg{constructor(r){this.$=r;this.m7e=!1}Wob(r){const M=this;return Lo(function*(){if(M.m7e)aa.ULS.sendTraceTag(509089825,
0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else{var la=String.format(wc.a.instance.He(213),r),Qa=sg.a.ia(1952),Kb=sg.a.ia(1954);M.ZPa||(M.ZPa=yield wb.a.resolve(Db.s,{Aa:1}));M.ZPa.akk(la,Kb,Qa,()=>{aa.ULS.sendTraceTag(508117194,0,20,"DataCleansingBusinessBar.showBusinessBar: Show suggestions was clicked.");M.wEa()});M.m7e=!0;aa.ULS.sendTraceTag(509089824,0,20,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${r} suggestions.`)}})}wEa(){this.ZPa&&
this.ZPa.EJ(70)&&this.ZPa.removeEntry(70)}}Object(da.a)(wg,"BusinessBar",null,[]);var vg=a(784);class si{constructor(r){vg.a.assign(si,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[si.getTypeName()])}}si.H_={T_:si.getTypeName(),B_:si.getBaseTypes()};class Lh{constructor(r){vg.a.assign(Lh,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=
r}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[Lh.getTypeName()])}}Lh.H_={T_:Lh.getTypeName(),B_:Lh.getBaseTypes()};class di{constructor(r){vg.a.assign(di,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[di.getTypeName()])}}di.H_={T_:di.getTypeName(),B_:di.getBaseTypes()};class ai{constructor(r){vg.a.assign(ai,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[ai.getTypeName()])}}ai.H_={T_:ai.getTypeName(),B_:ai.getBaseTypes()};
class ci{constructor(r){vg.a.assign(ci,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[ci.getTypeName()])}}ci.H_={T_:ci.getTypeName(),B_:ci.getBaseTypes()};class fi{constructor(r){vg.a.assign(fi,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,
[fi.getTypeName()])}}fi.H_={T_:fi.getTypeName(),B_:fi.getBaseTypes()};class Jg{constructor(r){vg.a.assign(Jg,this,r)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(r){return vg.a.gG(r,[Jg.getTypeName()])}}Jg.H_={T_:Jg.getTypeName(),B_:Jg.getBaseTypes()};class Hh{constructor(r){vg.a.assign(Hh,this,r)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(r){return vg.a.gG(r,
[Hh.getTypeName()])}}Hh.H_={T_:Hh.getTypeName(),B_:Hh.getBaseTypes()};class D{constructor(r){vg.a.assign(D,this,r)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(r){return vg.a.gG(r,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class ma{constructor(r){vg.a.assign(ma,this,r)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(r){return vg.a.gG(r,
[ma.getTypeName()])}}ma.H_={T_:ma.getTypeName(),B_:ma.getBaseTypes()};class Ua{constructor(r){vg.a.assign(Ua,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[Ua.getTypeName()])}}Ua.H_={T_:Ua.getTypeName(),B_:Ua.getBaseTypes()};class Xb{constructor(r){vg.a.assign(Xb,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=
r}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[Xb.getTypeName()])}}Xb.H_={T_:Xb.getTypeName(),B_:Xb.getBaseTypes()};class yc{constructor(r){vg.a.assign(yc,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,
[yc.getTypeName()])}}yc.H_={T_:yc.getTypeName(),B_:yc.getBaseTypes()};class Tc{constructor(r){vg.a.assign(Tc,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[Tc.getTypeName()])}}Tc.H_={T_:Tc.getTypeName(),B_:Tc.getBaseTypes()};class Sc{constructor(r){vg.a.assign(Sc,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=
r}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[Sc.getTypeName()])}}Sc.H_={T_:Sc.getTypeName(),B_:Sc.getBaseTypes()};class Gd{constructor(r){vg.a.assign(Gd,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,
[Gd.getTypeName()])}}Gd.H_={T_:Gd.getTypeName(),B_:Gd.getBaseTypes()};class De{constructor(r){vg.a.assign(De,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[De.getTypeName()])}}De.H_={T_:De.getTypeName(),B_:De.getBaseTypes()};class ve{constructor(r){vg.a.assign(ve,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=
r}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return vg.a.gG(r,[ve.getTypeName()])}}ve.H_={T_:ve.getTypeName(),B_:ve.getBaseTypes()};class Xe{constructor(r,M){this.zk=r;this.eZf=M;this.Koa=!1;this.Taa=new EventTarget;this.MDg=(la,Qa)=>{if(la=Qa.annotation)switch(Qa.operationType){case 1:case 2:this.Taa.dispatchEvent(new CustomEvent("suggestionsAnnotationReceived",{detail:la}));break;case 3:break;
default:aa.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${Qa.operationType}`)}else aa.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.")};this.m0j=(la,Qa)=>{if(la=Qa.annotation)switch(Qa.operationType){case 1:case 2:this.Taa.dispatchEvent(new CustomEvent("resolverAnnotationReceived",{detail:la}));break;case 3:break;default:aa.ULS.sendTraceTag(508560027,306,15,
`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${Qa.operationType}`)}else aa.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};this.zk=r;this.eZf=M}activateEvents(){this.Koa?aa.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):(this.dQj(),this.Koa=!0)}deactivateEvents(){this.Koa&&(this.qBk(),this.Koa=!1)}registerSuggestionsAnnotationReceived(r){this.Taa.addEventListener("suggestionsAnnotationReceived",
M=>{M instanceof CustomEvent&&r(null===M||void 0===M?void 0:M.detail)})}registerResolverAnnotationReceived(r){this.Taa.addEventListener("resolverAnnotationReceived",M=>{M instanceof CustomEvent&&r(null===M||void 0===M?void 0:M.detail)})}qBk(){this.zk.unregister("DataCleansing")}dQj(){aa.ULS.sendTraceTag(574482312,0,50,"AnnotationsProvider.registerCleanDataEvents: activate annotations");const r=this.zk.fW().WX("DataCleansing").VX(this.eZf).activateAnnotation({annotationType:di.getTypeName(),jy:!0,
r3a:this.MDg}).activateAnnotation({annotationType:Xb.getTypeName(),jy:!0,r3a:this.MDg}).activateAnnotation({annotationType:yc.getTypeName(),jy:!0,r3a:this.m0j});ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&r.activateAnnotation({annotationType:Sc.getTypeName(),jy:!0});ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&r.activateAnnotation({annotationType:De.getTypeName(),jy:!0});ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",
!1)&&r.activateAnnotation({annotationType:ve.getTypeName(),jy:!0});this.zk.register(r.build())}}Object(da.a)(Xe,"AnnotationsProvider",null,[]);var nf=a(1009),uf=a(154);class rg{constructor(r){this.$=r}isUsageRangeTable(r){const M=Yb.h(this.$).y8i;return 1===r.tableRange.top&&r.tableRange.bottom===M.bottom}logCtrlAComparisonResults(r){r={["range"]:new Mf.Range(r.tableRange.top,r.tableRange.left,r.tableRange.bottom-1,r.tableRange.right,!1,!1),["callback"]:this.uCd};Object($b.b)(this.$,r)}uCd(r,M){r.Result?
dg.a.wt(r.Errors)?(r=dg.a.xf(r.Errors),aa.ULS.sendTraceTag(507867614,0,15,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result return with errors: ${r}, AnnotationRange: ${M}`)):(r=jd.F(r.Result),M.bottom+=1,aa.ULS.sendTraceTag(507867613,0,20,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: AnnotationRange: ${M}, CtrlARange: ${r}, isSameAsCtrl+A: ${r.toString()===M.toString()}`)):aa.ULS.sendTraceTag(507867615,0,50,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result.Result is null. AnnotationRange: ${M}`)}}
Object(da.a)(rg,"AnnotationsHostCallbacks",null,[]);var $f;let og=$f=class extends qd.a{constructor(r,M,la){super();this.$=r;this.Ubb=la;this.Dkc=!1;this.uGf=!0;this.Fca=new Bg;this.Qxj=Kb=>{const hc=this;return Lo(function*(){hc.Ubb.suggestionsTelemetryUtils.logPotentialSuggestionsInfo(Kb.sheetId,Kb.annotations,hc.uGf);hc.uGf=!1;hc.stateChanged();yield hc.Ywf()})};this.Hm=(Kb,hc)=>{const Ac=this;return Lo(function*(){Ac.RJg(hc.pD);Ac.CDg(hc.na);Ac.stateChanged();Ac.businessBar.wEa();yield Ac.Ywf()})};
this.fua=()=>{this.stateChanged()};this.kA=()=>{this.stateChanged()};this.wB=()=>{ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActivateEventsOnlyOnEditMode",!1)?this.$.ea.isEditMode?(void this.zga.activateEvents(),this.$.ea.UK(this.wB)):aa.ULS.sendTraceTag(507856794,0,20,"DataCleansingHostManager.onApplicationModeChanged: the workbook is not in edit mode, therefore we don't activate the events."):this.stateChanged()};this.wzj=(Kb,hc)=>{aa.ULS.sendTraceTag(520987272,0,20,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:nf.a[void 0===
Kb?"Unknown":Kb],["errorCode"]:hc})}`);this.Fca.hostState.errorState=hc;this.stateChanged()};this.dda=(Kb,hc)=>{Dg.m(hc.item)&&hc.item.Vk!==this.Fca.worksheetState.isProtected&&(aa.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${hc.item.Vk}.`),this.stateChanged())};this.jua=(Kb,hc)=>{y(this.$,hc)&&this.Fkc()};this.Oih=new Ze(this.$);this.IEg=new Ng(this.$);this.businessBar=new wg(this.$);M=new Xe(M,this.wzj);const Qa=new rg(this.$);
this.zga=la.createAnnotationsManger(M,Qa);this.zga.registerSheetAnnotationsChanged(this.Qxj);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActivateEventsOnlyOnEditMode",!1)?this.$.ea.isEditMode?void this.zga.activateEvents():this.$.ea.aM(this.wB):(void this.zga.activateEvents(),r.ea.aM(this.wB));r.oq.Vj(this.Hm);r.ea.r$(this.kA);this.CDg(this.$.na);this.Fcc(this.jua);ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&this.$.ogc(()=>{this.stateChanged()})}Fcc(r){this.addHandler($f.Aee,
r)}jlg(r){this.removeHandler($f.Aee,r)}otk(){this.zga.pauseAugmentationLoop("taskPaneClosed")}stk(){this.zga.resumeAugmentationLoop("taskPaneOpened")}dispose(){this.$.oq.vk(this.Hm);this.$.ea.P1(this.kA);this.$.ea.UK(this.wB);this.RJg(this.$.na);super.dispose()}get state(){this.Fca.annotations=this.zga.allAnnotations();if(Dg.m(this.$.na)){const r=this.$.na.Vk,M=this.$.na.sheetId,la=this.$.na.sheetName;this.Fca.worksheetState.isInNamedSheetView=this.$.na.kh.tu;this.Fca.worksheetState.isProtected=r;
this.Fca.worksheetState.sheetId=M;this.Fca.worksheetState.sheetName=la}ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActivateEventsOnlyOnEditMode",!1)||(this.Fca.hostState.isInViewMode=!this.$.ea.isEditMode);this.Fca.hostState.isInCoauthoring=this.isInCoauthoring();ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&(this.Fca.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled);return this.Fca}Fkc(){this.businessBar.wEa();this.Dkc=!0}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent($f.Aee,
this.state)}CDg(r){Dg.m(r)&&(r.kh.Z7a(this.fua),r.b8a(this.dda))}RJg(r){Dg.m(r)&&(r.kh.Bmb(this.fua),r.xJc(this.dda))}r9g(){if(!Dg.m(this.$.na))return 0;const r=this.zga.sheetAnnotations(this.$.na.sheetId);return this.Ubb.annotationsUtils.getAggregateAnnotation(r)?this.Ubb.annotationsUtils.getSuggestionsCount(r):0}q9g(){if(!Dg.m(this.$.na))return new Map;const r=this.zga.sheetAnnotations(this.$.na.sheetId);return this.Ubb.annotationsUtils.getAggregateAnnotation(r)?this.Ubb.annotationsUtils.suggestionCountByType(r):
new Map}get ZRh(){return ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityBusinessBar",!1)}Ywf(){const r=this;return Lo(function*(){var M=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8222616_RefineDiscoverabilityTriggers");const la=M?r.q9g():new Map;M=M?r.Ubb.listsUtils.sum(la.values()):r.r9g();0===M?r.businessBar.wEa():r.Uik(M,la)&&(r.ZRh?(yield r.Txk(M),r.Dkc=!0):r.Qxk(M))})}Qxk(r){ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",
!1)&&this.IEg.isEnabled&&this.IEg.show(r,!1)}Txk(r){const M=this;return Lo(function*(){M.zga.pauseAugmentationLoop("triggerDiscoverabilityBusinessBar");yield M.businessBar.Wob(r)})}Uik(r,M){return ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8222616_RefineDiscoverabilityTriggers")?this.Dkc||y(this.$,this.state)||2>r||!M.get("TextInconsistency")?!1:!0:!this.Dkc&&0<r&&!(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode)}};og.Aee="scek";og=$f=Object(hb.__decorate)([Object(wb.d)(Db.T),
Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(Db.l)()),Object(hb.__param)(2,Object(Db.pb)())],og);Object(da.a)(og,"DataCleansingHostManager",qd.a,[]);var bh=a(495),mi=a(809);Object(wb.b)(Db.pb,{nn:"singleton"})(r=>Lo(function*(){yield Object(mi.a)("excelCleanData",{Aa:r.Aa});const M=window.excelCleanData.ExcelCleanDataGlobal;M.init(new bh.a);return M}));class ni extends bc.a{constructor(r,M,la,Qa,Kb){Kb=void 0===Kb?null:Kb;super();this.Gzb=null;this.LIf=!1;this.xE=()=>{this.MLb&&
aa.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.AQb}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.kVa}, AggregatedActionParams not null: ${this.MLb}`);this.iGd()};this.V8g=r;this.W8g=M;this.documentVisibilityObserver=la;this.AQb=Qa;this.VQ=Kb;la&&this.documentVisibilityObserver.rZ(this.xE)}get kVa(){return this.LIf}get MLb(){return!!this.Gzb}hag(r){aa.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.AQb}>.PerformThrottledAction: Start. IsActionOngoing: ${this.kVa}, AggregatedActionParams not null: ${this.MLb}`);
this.Gzb=this.W8g.lOe(r,this.Gzb);this.iGd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.sIa(this.xE);super.dispose()}nvg(r){this.LIf=r}O$h(){aa.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.AQb}>.FinishedCallback: Start. IsActionOngoing: ${this.kVa}, AggregatedActionParams not null: ${this.MLb}`);this.nvg(!1);this.iGd()}iGd(){if(!this.RZb()){var r=this.Gzb;this.Gzb=null;this.nvg(!0);aa.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.AQb}>.InternalPerformAction: Calling PerformAction.`);
zd.TaskExtensions.Ca(this.V8g.eag(r),()=>{this.O$h()},Sb.a.none,0,this.VQ)}}RZb(){return!this.MLb||this.kVa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.tk?(aa.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.AQb}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}}Object(da.a)(ni,"ActionAggregator",bc.a,[348,2]);class Ui extends qd.a{constructor(r){super();this.pB=this.firstElement=null;this.MVa=!1;this.rx=null;this.Kfk=Cc.a.hj;this.D3f=M=>{const la=
M.Ga.keyCode;return la===Ec.a.So?this.fpj():la===Ec.a.bC&&M.Ga.shiftKey?this.m7h(this.firstElement):!1};this.m9f=M=>{if(!this.MVa||M.Ga.keyCode!==Ec.a.DU)return!1;Ui.jAf();Fa.Task.delay(1).Jw(()=>{this.pB.focus();return!0},0,this.qa);return!0};this.hAj=()=>{document.activeElement&&document.activeElement.id===this.pB.id||(Ui.jAf(),Fa.Task.delay(1).Jw(()=>{this.pB.focus();return!0},0,this.qa))};this.q1f=()=>{this.TGg(this.pB)};this.C3f=M=>{M.stopPropagation();M.preventDefault();this.MVa&&(this.MVa=
!1)};this.$=r;(r=this.$.ea.ff)&&aa.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${r.cBa}; InWebPart = '${r.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${r.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);r&&(r.inWebPart||r.inEmbedView)?aa.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${r.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${r.inEmbedView?
"True (+Modern)":"False (not Modern)"}'`):(this.tHh(),this.tIh(),Le.KeyInputManager.instance.va(le.a.Hf,this.$.domElement,this.m9f));this.$.ja.$c(238,this)}zeh(r){this.addHandler("KBIS",r)}DVj(r){this.removeHandler("KBIS",r)}dispose(){this.firstElement&&Cf.a.removeHandler(this.firstElement,le.a.focus,this.q1f);this.rx&&this.rx.detach("focus");this.pB&&(Cf.a.removeHandler(this.pB,le.a.focus,this.C3f),Cf.a.removeHandler(this.pB,le.a.blur,Ui.onBlur),Le.KeyInputManager.instance.Da(le.a.Hf,this.pB,this.D3f));
Le.KeyInputManager.instance.Da(le.a.Hf,this.$.domElement,this.m9f);this.rx=this.pB=this.firstElement=this.$=null;super.dispose()}tHh(){this.Kfk?(this.firstElement=document.documentElement,this.rx=we.a.instance.qM(document.parentWindow),this.rx.ta("focus",this.hAj)):(this.firstElement=Ui.H2e(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Cf.a.addHandler(this.firstElement,le.a.focus,this.q1f))}tIh(){this.pB=Ui.H2e();this.pB.id=Ne.a.z$e;this.pB.setAttribute(Ne.a.Ly,wc.a.instance.ia(863));
document.body.appendChild(this.pB);Cf.a.addHandler(this.pB,le.a.focus,this.C3f);Cf.a.addHandler(this.pB,le.a.blur,Ui.onBlur);Le.KeyInputManager.instance.va(le.a.Hf,this.pB,this.D3f)}m7h(r){this.TGg(r);return!1}fpj(){this.MVa=!0;Yb.h(this.$).focus();Yb.h(this.$).ha.mxf();this.raiseEvent("KBIS");return!0}TGg(r){this.MVa?this.MVa=!1:(this.MVa=!0,r&&r.focus())}static H2e(){const r=document.createElement("div");r.tabIndex=0;return r}static jAf(){document.body.classList.add(uc.a.Wbf)}static onBlur(){document.body.classList.remove(uc.a.Wbf)}}
Object(da.a)(Ui,"EmbedViewFocusControl",qd.a,[347,2]);var Uj=a(70),Fj=a(550),xj=a(118);class aj extends qd.a{constructor(r,M){super();this.nXb=this.Jxd=this.rIb=this.RU=null;this.O7b=!1;this.qre=null;this.Asa=this.J0d=!1;this.Uqj=(la,Qa,Kb)=>{aa.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Kb);this.nXb&&this.nXb.stop();this.RU=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.Vqj=la=>{oe.a(la)||(this.nXb&&this.nXb.stop(),this.O7b=!1,(this.RU=
la.Result)&&0<this.RU.length&&aa.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.RU.length} rich value field list context for autocomplete`),this.v5a=!0,this.yHc())};this.v5a=!1;this.Ie=r;this.n6b=-1;this.Ug=M;this.J0d=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.Asa=ya.EwaSettings.Asa()}obd(r){this.addHandler("FieldInfoListContextLoaded",r)}P3d(r){this.removeHandler("FieldInfoListContextLoaded",r)}Ydh(r){this.addHandler("GetFieldInfoListContextOperationFailed",
r)}fVj(r){this.removeHandler("GetFieldInfoListContextOperationFailed",r)}get jId(){return this.v5a}get w8i(){return this.O7b}get Nkf(){return this.n6b}get Imd(){return this.qre}get $(){return this.Ie}get Bt(){return this.RU}get cni(){return!!this.rIb}dispose(){this.Ie=null;this.fKc();super.dispose()}qdb(r,M,la,Qa){Qa=void 0===Qa?null:Qa;if(r){this.Dgd();this.Mfc();var Kb=null,hc=!1;if(!Qa&&(()=>{let Ac=this.rzk(r,M,la);({Kkb:hc,Bt:Kb}=Ac);return Ac})().returnValue)if(this.J0d||this.iug(Kb),this.O7b=
!0,this.RU=Kb,this.J0d){if(!hc){this.v5a=!0;this.yHc();return}}else if(this.RU&&0<this.RU.length&&(this.v5a=!0,this.yHc()),!hc)return;this.iLg(r,Qa,M,la,!1)}}iLg(r,M,la,Qa,Kb){if(this.$.ea.tf){this.$.Ve&&(this.nXb=this.$.Ve.Sf("WebServiceCall","GetRichValueFieldInfoListContext"));this.rIb=null;var hc=this.$.oa.ua.qf(),Ac=this.$.oa.ua,Zc=this.Vqj,Ad=this.Uqj;const re=Ac.Oa(1,null);re.selectedRange=r;re.richValueKeyPath=M;re.singleColumn=la;re.searchForRange=Qa;re.calculateMajorityDataType=Kb;this.rIb=
Bd.h(Ac,"GetRichValueFieldListContextList",re,Zc,Ad,null,hc,4)}else this.RU=null}fKc(){this.RU=null;this.v5a=!1;this.Dgd();this.Mfc();this.rIb=null;this.n6b=-1}Dgd(){aj.RBb(this.rIb)}Mfc(){aj.RBb(this.Jxd)}yHc(){this.raiseEvent("FieldInfoListContextLoaded")}nu(r){r=jd.F(r);--r.left;--r.right;return this.Ug.nu(r)}vTa(r){r.FirstColumn=r.FirstColumn;r.LastColumn=r.LastColumn;r.FirstRow=r.FirstRow;r.LastRow=r.LastRow;this.Mfc();this.Jxd=null;return ae.a(this.$.userOperationManager,(M,la,Qa)=>rd.k(this.$.oa.ua,
r,Xc.b(M,Kb=>{this.drj(Kb)}),Xc.a(la,la,Kb=>{this.crj(Kb)}),Qa,null),M=>new Be.a(264,0,M,80),null)}crj(r){r=xj.a.Lh(r.data);aa.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${dg.a.xf(r)}`)}drj(r){if(oe.a(r))-315732528!==r.Errors[0].MessageId&&aa.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${dg.a.xf(r.Errors)}`);else if(r&&r.Result){r=r.Result;var M=
r.HasHeaderRow;M=new Fj.AutofilterRange(r.TableRange.FirstRow+(M?1:0)+1,r.TableRange.FirstColumn+1,r.TableRange.LastRow+1,r.TableRange.LastColumn+1,null,null,null,0,M);this.n6b=r.TableRange.FirstColumn;(r=this.Ddg(!1,!0,M))||aa.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.iug(r)}else aa.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}rzk(r,M,la){let Qa,Kb;Kb=
null;Qa=!1;if(r.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,Kkb:Qa,vTa:!1,Bt:Kb};let hc;this.n6b=-1;if(la){hc=this.nu(r);if(!hc||!hc.Sra)return{returnValue:!1,Kkb:Qa,vTa:!1,Bt:Kb};var Ac=this.Asa?(Ac=Yb.h(this.$).Je.stf(hc))&&0<Ac.size:(Ac=Yb.h(this.$).Je.ttf(hc))&&0<Ac.count;this.qre=hc;if(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Ac)return--r.FirstColumn,--r.LastColumn,this.Jxd=this.vTa(r),{returnValue:!0,
Kkb:Qa,vTa:!0,Bt:Kb};hc.top+=1;hc.right=jd.F(r).right-1}else hc=new Fj.AutofilterRange(r.FirstRow+1,r.FirstColumn+1,r.LastRow+1,r.LastColumn+1,null,null,null,0,!1);if(hc.top>hc.bottom||hc.left>hc.right)return{returnValue:!0,Kkb:Qa,vTa:!1,Bt:Kb};r=Yb.h(this.$);var Zc=r.Be.width,Ad=r.Be.height;Ac=r.view.visibleArea;Zc=new Uj.a(Ac.x-Zc,Ac.y-Ad,Ac.width+Zc,Ac.height+Ad);Ad=r.Oj(hc);if(!Ac||!Ad||!r.Lxc(hc))return{returnValue:!1,Kkb:Qa,vTa:!1,Bt:Kb};Zc.contains(Ad)||(Qa=!0);Kb=this.Ddg(M,la,hc);return{returnValue:!0,
Kkb:Qa,vTa:!1,Bt:Kb}}iug(r){r&&aa.ULS.sendTraceTag(25264348,0,50,`Retrieved ${r.length} rich value field contexts from block cache`);this.O7b=!0;(this.RU=r)&&0<this.RU.length&&(this.v5a=!0,this.yHc())}Ddg(r,M,la){let Qa;Qa=null;const Kb=la.clone();if(M)for(let hc=la.right,Ac=0;hc>=la.left;--hc){if(Kb.left=hc,Kb.right=hc,M=this.Uof(Kb,!0,la.left)){Qa||(Qa=[]);Qa[Ac]=M;if(r)break;++Ac}}else if(r=this.Uof(Kb,!1))Qa=[],Qa[0]=r;return Qa}Uof(r,M,la){la=void 0===la?0:la;var Qa=null;let Kb=[];if(this.Asa){var hc=
Yb.h(this.$).Je.stf(r);if(!hc||0>=hc.size)return Qa;Kb=Array(hc.size);let Zc=0;hc.forEach(Ad=>{const re={};re.Name=Ad.Value;re.RefersToDotFunction=Ad.RefersToDotFunction;Kb[Zc]=re;++Zc})}else{var Ac=Yb.h(this.$).Je.ttf(r);if(!Ac||0>=Ac.count)return Qa;Kb=Array(Ac.count);Qa=0;for(hc of Ac.values)Ac={},Ac.Name=hc,Kb[Qa]=Ac,++Qa}hc="";Ac=-1;0<r.top&&M&&(r=new Mf.Range(r.top-1,r.left,r.top-1,r.left,!1,!1),null!=Yb.h(this.$).Pe(r)&&null!=Yb.h(this.$).Pe(r).originalText&&(hc=Yb.h(this.$).Pe(r).originalText),
Ac=r.left-la);Qa={};Qa.ColumnName=hc;Qa.ColumnIndex=Ac;Qa.FieldInfoDataList=Kb;return Qa}static RBb(r){r&&za.AFrameworkApplication.lg.Az(r.My)}}Object(da.a)(aj,"FieldInfoManager",qd.a,[258,2]);class Th extends aj{constructor(r,M,la,Qa){super(r,M);this.mbb=null;this.k1f=()=>{this.P3d(this.k1f);if(this.Bt&&this.Bt.length&&this.contextMenuManager){var Kb=this.contextMenuManager.Swd("autoFilterRichFieldList"),hc=window.document.getElementById(this.mbb);Kb.dea(null,hc,this,null,!0)}};this.TVg=la;this.contextMenuManager=
Qa}get gM(){return this.TVg}pni(r,M){this.mbb=M;aa.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${r.FirstRow}, ${r.FirstColumn}, ${r.LastRow}, ${r.LastColumn})`);this.iLg(r,null,!0,!1,!0)}}Object(da.a)(Th,"FilterInfoManager",aj,[259,258,2]);var mk=a(1010),Vj=a(1171);class pi{}pi.l2h="ewa-sharedUi-launchButton";pi.o2h="ewa-sharedUi-launchButtonWithText";pi.m2h="ewa-sharedUi-launchButtonClick";
pi.p2h="ewa-sharedUi-launchButtonWithTextClick";pi.n2h="ewa-sharedUi-launchButtonText";Object(da.a)(pi,"CssClassNames",null,[]);a(540);var fj=a(306),Fi=a(75),Wj=a(268);class gj extends Id.a{constructor(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re){super(document.createElement("div"));this.GNf=null;this.kde=!1;this.zoom=this.wf=this.w0b=this.A1a=null;this.zT=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.yT=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.Qmk=()=>{this.oJe()};this.Hg=Ge=>{this.raiseEvent(this.mUb,
Ge);this.clb();return!0};this.Ioj=Ge=>{100<Re.a(cd.a.Ae,this.GNf)&&this.zCd(new Sys.UI.Point(Math.round(Ge.clientX),Math.round(Ge.clientY)))};this.vT=Ge=>{Fi.g(Ge.Ga,!1);return!1};this.zoom=re;this.Y4=this.Zh.jRa();this.set_visible(!1);this.qyc=Kb;this.mUb=hc;this.CCc=r;this.Mgc=M;this.wf=Ad;this.qyc&&(this.A1a=na.a.instance.create(this.Qmk,3E4,"OnObjectButton.ShyTimerFired",!1,!1));r&&this.domElement.classList.add(r);this.bQa=document.createElement("div");this.domElement.appendChild(this.bQa);la&&
this.bQa.classList.add(la);this.Pie(Qa);Ac&&(this.w0b=document.createElement("div"),this.domElement.appendChild(this.w0b),this.w0b.classList.add(Zc),this.w0b.innerText=Ac,this.domElement.style.padding="3px",Ve.a.instance.va(le.a.yg,this.domElement,this.vT));this.u9a=new fj.a(this.domElement,7);sh.a.instance.va(le.a.click,this.domElement,this.Hg);ya.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Ve.a.instance.va(le.a.yg,this.domElement,this.vT);r=Ge=>{Fi.g(Ge)};
this.tg.ta("mouseup",r);this.tg.ta("click",r);this.tg.ta("dblclick",r)}X3(r){this.addHandler(this.mUb,r)}xda(r){this.get_events().removeHandler(this.mUb,r)}Reh(r){this.addHandler("OnObjectButtonMouseOver",r)}TVj(r){this.get_events().removeHandler("OnObjectButtonMouseOver",r)}Qeh(r){this.addHandler("OnObjectButtonMouseOut",r)}SVj(r){this.get_events().removeHandler("OnObjectButtonMouseOut",r)}Pie(r){r&&this.wf.tm(this.bQa,r)}oSc(r){this.bQa&&r&&this.bQa.setAttribute("title",r)}PCk(r,M,la){var Qa=16,
Kb=16;Qa=void 0===Qa?0:Qa;Kb=void 0===Kb?0:Kb;this.wf.kM(this.bQa);r?r.Lia(M,16,16,this.bQa,Qa,Kb,void 0,la):aa.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}QCk(r,M){r&&(this.w0b.innerText=r);this.domElement.title=M}dispose(){this.get_isInitialized()&&(this.hide(),this.tg.TJ(),Ic.a.Wf([this.Y4,this.u9a]),sh.a.instance.Da(le.a.click,this.domElement,this.Hg),Ve.a.instance.Da(le.a.yg,this.domElement,this.vT),this.A1a&&this.A1a.dispose(),super.dispose())}$Wb(){this.Mgc&&
this.domElement.classList.remove(this.Mgc);this.CCc&&this.domElement.classList.add(this.CCc)}clb(){this.CCc&&this.domElement.classList.remove(this.CCc);this.Mgc&&this.domElement.classList.add(this.Mgc);this.Cbb()}Cbb(){this.qyc&&(this.A1a.cancel(),this.NCg(),this.setOpacity(1));this.set_visible(!0)}iq(r,M,la,Qa,Kb){Kb=void 0===Kb?!1:Kb;r=ya.EwaSettings.Pi()?this.zoom.zoomManager.Jk(r):yf.a(Qa).Jk(r);M=ya.EwaSettings.Pi()?this.zoom.zoomManager.Jk(M):yf.a(Qa).Jk(M);ya.EwaSettings.Pi()?this.zoom.zoomManager.eZb(this.domElement):
yf.a(Qa).eZb(this.domElement);this.domElement.style.top=bf.HelperMethods.rg(M);this.domElement.style.left=this.domElement.style.right="";M=r;Kb&&(M=r-this.domElement.offsetWidth);Wj.c(this.domElement.style,la,bf.HelperMethods.rg(M));this.set_visible(!0);this.setOpacity(1);this.qyc&&(this.kde=!1,this.Ppk(),this.A1a.tv())}hide(){this.$Wb();this.set_visible(!1);this.qyc&&(this.NCg(),this.A1a.cancel())}Xpd(){this.tg.ta("mouseover",this.zT,!0);this.tg.ta("mouseout",this.yT,!0)}Ppk(){this.Y4.Ar("mousemove")||
this.Y4.ta("mousemove",this.Ioj)}NCg(){this.Y4.Ar("mousemove")&&this.Y4.detach("mousemove")}zCd(r){if(this.domElement.parentNode){var M=Sys.UI.DomElement.getBounds(this.domElement);const la=new Sys.UI.Point(Math.round(M.x+M.width),Math.round(M.y+M.height));M=Math.abs(la.x-r.x);r=Math.abs(la.y-r.y);r=M>r?M:r;this.kde?this.setOpacity(gj.uth(r)):100>=r&&this.oJe()}}oJe(){this.kde=!0;this.A1a.cancel()}setOpacity(r){Cc.a.setOpacity(this.domElement,r);this.GNf=cd.a.Ae.yf}static uth(r){return 100>=r?1:250<=
r?0:.01*(100-(r-100)/150*100)}}Object(da.a)(gj,"OnObjectButton",Id.a,[337,221,2]);var Gj=a(860);const nk=pi.n2h;class hi extends bc.a{constructor(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re){re=void 0===re?"":re;super();this.GEa=null;this.LAf=!1;this.wf=this.$Bc=this.aCc=null;this.buttons={};this.rbf={};this.zoom=Ad;this.$=r;this.svgIconProvider=M;this.Qmj=la;this.OEd=Qa;this.NEd=Kb;this.altText=hc;this.mUb=Ac;this.wf=Zc;this.buttonText=re}get zoomManager(){return ya.EwaSettings.Pi()?this.zoom.zoomManager:yf.a(this.$)}get aA(){return this.zoomManager.lPa(Wf.a.avj)}get $Bb(){return Wf.a.$uj}get buttonWidth(){return this.zoomManager.lPa(Wf.a.bvj)}dispose(){this.MSh();
this.$=null;super.dispose()}getButton(r,M){return this.bra(r,void 0===M?!0:M)}bra(r,M){const la=r.toString();la in this.buttons||this.vIh(r,void 0===M?!0:M);return this.buttons[la]}iq(r,M,la,Qa,Kb,hc){Kb=void 0===Kb?!0:Kb;hc=void 0===hc?!1:hc;this.hide();if(this.$.ea.isNamedObjectViewMode&&Dg.i(this.$.na)){var Ac=Yb.h(this.$).PX.domElement;const Zc=r+this.buttonWidth-Ac.scrollWidth;Ac=M+this.buttonWidth-Ac.scrollHeight;r=0<Zc?r-Zc:r;M=0<Ac?M-Ac:M}this.bra(Qa,Kb).iq(r,M,la,this.$,hc)}hide(){const r=
this.buttons;for(const M in r)r[M].hide()}Xpd(r,M){!this.LAf&&(M=this.buttons[M.toString()])&&(this.aCc=(la,Qa)=>{r(Qa,!0)},M.Reh(this.aCc),this.$Bc=(la,Qa)=>{r(Qa,!1)},M.Qeh(this.$Bc),this.LAf=!0,M.Xpd())}vIh(r,M){this.GEa=String.format(this.OEd===uc.a.Lmc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Za.a.Qn(this.OEd),Za.a.Qn(this.NEd),"{0}");var la=String.format(this.GEa,Za.a.Qn(this.altText));
M=new gj(""===this.buttonText?pi.l2h:pi.o2h,""===this.buttonText?pi.m2h:pi.p2h,uc.a.dS,la,M,this.mUb,this.buttonText,nk,this.wf,this.zoom);la=(Qa,Kb)=>{this.Qmj(Kb,r)};M.X3(la);this.buttons[r.toString()]=M;this.rbf[r.toString()]=la;la=Yb.h(this.$).wi(r);la.domElement.insertBefore(M.domElement,la.domElement.firstChild)}MSh(){for(const r of Gj.a(this.buttons)){const M=this.buttons[r];M.xda(this.rbf[r]);Ic.a.Sa(M);delete this.buttons[r];this.aCc&&M.TVj(this.aCc);this.$Bc&&M.SVj(this.$Bc)}}domElement(r){return this.bra(r).domElement}Cbb(r){this.bra(r).Cbb()}R1b(r,
M,la){la=void 0===la?!0:la;this.GEa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Za.a.Qn(this.OEd),Za.a.Qn(this.NEd),"{0}");r=String.format(this.GEa,Za.a.Qn(r));this.bra(M,la).Pie(r)}d3a(r,M,la){this.bra(la,!1).QCk(r,M)}fLg(){var r=void 0===r?!1:r;this.GEa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Za.a.Qn(this.NEd),"{1}");const M=String.format(this.GEa,void 0,
Za.a.Qn(void 0));this.bra(void 0,r).Pie(M)}JSc(r,M,la){this.bra(la,!1).PCk(this.svgIconProvider,r,M)}oSc(r,M){this.bra(M,!1).oSc(r)}}Object(da.a)(hi,"OnObjectLaunchButton",bc.a,[322,2]);var Hj=a(103);class hj extends Hj.a{constructor(r,M){super(r);this.QPb=null;this.uSh=()=>{this.display()};this.tLi=Math.max(1,M)}dispose(){Ic.a.Sa(this.QPb);this.QPb=null;super.dispose()}P1a(){Ic.a.Sa(this.QPb);this.QPb=na.a.instance.create(this.uSh,this.tLi,gd.a.B8i)}W1a(){Ic.a.Sa(this.QPb);this.hide()}}Object(da.a)(hj,
"LoadingIndicatorBehavior",Hj.a,[335,2]);class ok extends hj{constructor(r,M,la,Qa){super(r,M);this.PPb=null;this.rYg=la;this.GIi=Qa;this.pah()}dispose(){this.PPb=null;super.dispose()}display(){this.rYg(this.PPb)}hide(){this.GIi(this.PPb)}pah(){this.PPb=document.createElement("div");this.domElement.appendChild(this.PPb)}}Object(da.a)(ok,"ShimmerLoadingIndicatorBehavior",hj,[]);var Zh=a(36),Qg=a(58);class Xj extends hj{constructor(r,M,la,Qa,Kb,hc){Qa=void 0===Qa?null:Qa;Kb=void 0===Kb?null:Kb;hc=void 0===
hc?0:hc;super(r,M);this.Meb=this.pXa=null;this.Meb=la;this.fuc=Qa||Qg.a.current.uq(101);this.BPf=hc;this.Mmd=Kb;this.oah()}dispose(){this.pXa=null;super.dispose()}display(){Gc.DOMElementExtensions.setVisible(this.pXa,!0)}hide(){Gc.DOMElementExtensions.setVisible(this.pXa,!1)}oah(){this.pXa=document.createElement("div");this.pXa.classList.add(Zh.a.v1h);const r=document.createElement("div");r.classList.add(Zh.a.w1h);this.Mmd&&""!=this.Mmd&&r.classList.add(this.Mmd);const M=0===this.BPf?"":wc.a.instance.ia(this.BPf),
la=String.format('<div class="'+Zh.a.x1h+'">{0}</div>',M);this.fuc?this.Meb.tm(r,`<img src="${this.fuc}" alt="${M}" title="${M}"/>`+la):this.Meb.tm(r,la);this.pXa.appendChild(r);this.domElement.appendChild(this.pXa)}}Object(da.a)(Xj,"SpinnerLoadingIndicatorBehavior",hj,[]);Object(wb.b)(Db.Ld)(r=>Lo(function*(){if(ya.EwaSettings.Pi()){const [la,Qa]=yield Promise.all([wb.a.resolve(Db.fc,{Aa:r.Aa}),wb.a.resolve(Db.ze)]);return new ij(la,Qa)}const M=yield wb.a.resolve(Db.fc,{Aa:r.Aa});return new ij(M,
null)}));class ij{constructor(r,M){this.Meb=r;this.zoom=M}Lld(r,M,la){return new mk.a(r,M,la)}Kic(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re){return new Vj.a(r,M,la,Qa,Kb,hc,Ac,Zc,Ad,re)}ZDb(r,M,la,Qa,Kb){return new Xj(r,M,this.Meb,la,Qa,void 0===Kb?0:Kb)}yzd(r){return r.ja.Qa(238)||new Ui(r)}ODb(r,M,la,Qa,Kb,hc,Ac,Zc){return new hi(r,M,la,Qa,Kb,hc,Ac,this.Meb,this.zoom,void 0===Zc?"":Zc)}F2e(r,M){return new aj(r,M)}oHh(r,M,la,Qa){return new Th(r,M,la,Qa)}H1e(r,M,la,Qa){return new ni(r,M,la,Qa)}}Object(da.a)(ij,
"SharedUIControlsFactory",null,[307]);let jj=class{constructor(r,M){this.ked=this.hSe=this.led=0;this.gSe=!1;this.proactiveSuggestionCard=null;this.J$a=this.f0e=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=0;this.qH=!1;this.vg=(la,Qa)=>{aa.ULS.sendTraceTag(508363741,0,50,"AutoAdjustColumnsManagerService::onSessionIdChanged detected.");Qa.tf?this.initialize():aa.ULS.sendTraceTag(508360707,0,15,"AutoAdjustColumnsManagerService::onSessionIdChanged but session is still not active.");this.$.ea.En(this.vg)};
this.YSb=la=>{if(dg.a.Ai(la.Errors)){const Qa=la.Errors[0].MessageId;ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")&&-315732528===Qa||aa.ULS.sendTraceTag(508641556,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${dg.a.xf(la.Errors)}.`)}else la.Result&&(this.autoAdjustColumnWidthSettings=parseInt(la.Result,10),this.J$a=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&
65280)>>8),this.qH=2!==(this.autoAdjustColumnWidthSettings&2),this.gSe||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.J$a=!1),this.jLi())};this.CWd=la=>{la=xj.a.Lh(la.data);aa.ULS.sendTraceTag(508641555,0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${dg.a.xf(la)}.`)};this.xTb=la=>{dg.a.Ai(la.Errors)?aa.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${dg.a.xf(la.Errors)}`):
la.Result||aa.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};this.dwj=la=>{if(dg.a.Ai(la.Errors))aa.ULS.sendTraceTag(508641552,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${dg.a.xf(la.Errors)}.`);else{var Qa=0;la.Result&&(Qa=parseInt(la.Result,10));Qa=Qa&-4|this.autoAdjustColumnWidthSettings&3;this.vPg(Qa)}};this.I_f=()=>{Ce.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&
1)&&(this.autoAdjustColumnWidthSettings|=1,this.pgg());this.J$a=!0;this.proactiveSuggestionCard.hide()};this.pnj=()=>{this.cCh();this.proactiveSuggestionCard.hide()};this.dBj=()=>{Ce.a("AutoAdjustColumnWidthHelp");const la=new rf.a(-859308420,hf.a.Ke,this.$.zf,9,null);this.$.Ha.Me(la,{[hf.a.Vi]:"HelpID=151880",["InputMethod"]:hf.a.Ke,["ShouldCanvasTakeFocus"]:!0,[hf.a.ig]:Ne.a.PM,[Ne.a.ama]:!0})};this.FVd=()=>{const la={};la[Ne.a.XH]="AutoAdjustColumnWidth";this.$.Lf(802602464,hf.a.Ke,8,la)};this.vzj=
()=>{Ce.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.pgg();this.J$a=!0;this.proactiveSuggestionCard.hide();this.qH=!1};this.$=r;this.proactiveSuggestionCard=M;this.hSe=ya.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",3);this.ked=ya.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",3);this.gSe=0===this.ked;!ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")||
this.$.ea.tf?this.initialize():this.$.ea.wn(this.vg)}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();this.$=null}initialize(){aa.ULS.shipAssertTag(508641557,0,Ia.a.REa(),"AutoAdjustColumnWidth feature is off");rd.A(this.$.oa.ua,5,this.YSb,this.CWd,null,null)}vPg(r){rd.H(this.$.oa.ua,5,r.toString(),this.xTb,this.CWd,null,null)}jLi(){if(2!==(this.autoAdjustColumnWidthSettings&2)){var r=this.sessionCount+1;r>=this.ked&&(r=0);this.vPg(this.autoAdjustColumnWidthSettings&
-65281|r<<8)}}pgg(){rd.A(this.$.oa.ua,5,this.dwj,this.CWd,null,null)}iZf(r){if(0===this.led){const M=[];M.push(hh.a.Ni("Command",r,2));Ce.a("AutoAdjustedColumnWidth",void 0,void 0,M)}++this.led;aa.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.J$a&&this.led>=this.hSe&&this.bCh()}bCh(){if(null!=this.proactiveSuggestionCard){Ce.a("AutoAdjustColumnWidthDialog");var r=wc.a.instance.za(858),M=wc.a.instance.za(859),
la=wc.a.instance.za(860),Qa=wc.a.instance.za(861),Kb=wc.a.instance.za(863);this.proactiveSuggestionCard.show(Yb.h(this.$).ha.pa.og,r,M,la,Qa,this.I_f,this.pnj,this.Vqc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,Kb,this.FVd);this.f0e?this.J$a=!0:this.f0e=!0}}Vqc(){return[{key:"learnMessage",text:wc.a.instance.za(862),onClick:this.dBj}]}cCh(){const r=wc.a.instance.za(864),M=wc.a.instance.za(865),la=wc.a.instance.za(866),Qa=wc.a.instance.za(861);this.proactiveSuggestionCard.show(Yb.h(this.$).ha.pa.og,
r,M,la,Qa,this.I_f,this.vzj,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};jj=Object(hb.__decorate)([Object(wb.d)(Db.m),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(Db.kd)())],jj);Object(da.a)(jj,"AutoAdjustColumnsManager",null,[2,306]);class bj{}bj.y7i=3;bj.connected=0;Object(da.a)(bj,"ConnectionStateConstants",null,[]);class Wi{constructor(r,M,la){var Qa;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=
null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.zZf=(hc,Ac)=>{this.blockedOperationsCount++;hc=`${Ac.componentName}_${Ac.actionName}_${Ac.details})`;this.blockedActions[hc]=this.blockedActions[hc]?this.blockedActions[hc]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};
this.lXd=hc=>{this.durationUntilUserInactive=he.getElapsedSeconds(this.startTime,cd.a.Ae.yf);hc.z4d(this.lXd)};this.HK=()=>{this.hasTabbedOut=!0};this.pka=(hc,Ac)=>{Ac.H$f!==this.type||this.isToastShown||(this.durationUntilToastShownMs=Re.a(cd.a.Ae,this.startTime),this.toastRaiser=Ac.toastRaiser,this.isToastShown=!0)};this.startTime=r;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=la;if(null===(Qa=M.ea)||void 0===Qa?0:Qa.Ti)this.wasUserActiveOnPIStart=M.ea.Ti.It;this.Kl(M);
this.isDialogShown=0<M.Le.NT;let Kb=null;Ia.a.vq()?void wb.a.resolve(Db.rd,{Aa:1}).then(hc=>{Kb=hc}):Kb=M.ja.Qa(183);this.isTaskPaneShown=!!Kb&&Kb.isVisible&&!Kb.isCollapsed;this.isTaskPaneCollapsed=!!Kb&&Kb.isVisible&&Kb.isCollapsed}cug(){this.durationMs=Re.a(cd.a.Ae,this.startTime)}pWd(r){var M;this.cug();Ld.a(r).wWb(this.zZf);Ld.a(r).Jj.rJc(this.pka);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void wb.a.resolve(Db.db).then(la=>{la.C_a(this.HK)}):
r.ja.Ne(291,la=>{la.C_a(this.HK)});if(null===(M=r.ea)||void 0===M?0:M.Ti)r.ea.Ti.z4d(this.lXd),this.wasUserActiveOnPIEnd=r.ea.Ti.It}Kl(r){Ld.a(r).wcc(this.zZf);this.isToastShown?this.toastRaiser="Immediate":Ld.a(r).Jj.Obd(this.pka);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void wb.a.resolve(Db.db).then(M=>{this.hasTabbedOut=M.tk;M.Y3(this.HK)}):r.ja.Ne(291,M=>{this.hasTabbedOut=M.tk;M.Y3(this.HK)});this.wasUserActiveOnPIStart&&r.ea.Ti.wNe(this.lXd)}}
Object(da.a)(Wi,"PartialInteractivityData",null,[]);var Yj=a(1174);class Ij extends Wi{constructor(r,M,la,Qa,Kb,hc){super(r,M,Qa);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=la;this.disconnectionSource=Enum.toString(Yj.a,
Kb);this.triggeringRequest=hc}tnj(r,M){this.swappedByOffline=M;this.pWd(r)}f$j(r){this.errorDataDuringConnectivityIssuesMode=r}HOj(r){10>this.failedRequests.length&&(r=r+"_"+he.getElapsedSeconds(this.startTime,cd.a.Ae.yf).toString(),this.failedRequests.push(r))}}Object(da.a)(Ij,"ConnectivityIssuesData",Wi,[]);var kj=a(161),yj=a(141),zj=a(140);class Gh{}Gh.PUh="DuringWork";Gh.connectivityIssues="ConnectivityIssues";Gh.offline="Offline";Object(da.a)(Gh,"UnavailabilityTypes",null,[]);class cj{constructor(r){this.ozc=
this.data=null;this.Psd=0;this.m0e=null;this.N_f=(M,la)=>{la.fV?(this.data=new Ij(cd.a.Ae.yf,this.$,5===la.xwa,0!==la.xwa,this.$.ni.disconnectionSource,this.m0e),this.ozc=this.$.ni.XNf,this.Psd=1,this.$.oa.ni.Cgh(this.Fp),kj.a(this.$).mbd(this.uqg)):(this.data.tnj(this.$,5===la.xwa),this.$.oa.ni.olg(this.Fp),this.data.lastFailedRequestToOnlineTimeGapSec=he.getElapsedSeconds(this.ozc,cd.a.Ae.yf),ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
fg.b().tYb(557682689,0,50,Gh.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",tc.a.Vf(this.data)):aa.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${tc.a.Vf(this.data)}`),this.data&&this.data.isToastShown&&qe.Health.instance.recordQosError(yj.a.zyh,[zj.a.$zc],!0,!1,!1,!1,null),kj.a(this.$).N3d(this.uqg),this.data=null)};this.uqg=
(M,la)=>{this.data.f$j(la.XJ)};this.Fp=(M,la)=>{this.data.HOj(la.context.methodName);M=cd.a.Ae.yf;la=he.getElapsedSeconds(this.ozc,M);this.ozc=M;la>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=la);this.Psd++;this.data.averageDurationBetweenFailedRequestsSec=this.Rsh(la)};this.K_f=(M,la)=>{this.m0e=la.Eyk};this.$=r;Ld.a(this.$).Jj.hMe(this.N_f);this.$.ni.gMe(this.K_f)}dispose(){this.$&&(Ld.a(this.$).Jj.pkg(this.N_f),this.$.ni&&this.$.ni.okg(this.K_f));
this.data&&this.$.oa.ni.olg(this.Fp);this.$=null}Rsh(r){const M=this.Psd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(M-1)+r)/M}}Object(da.a)(cj,"ConnectivityIssuesTelemetryManager",null,[2]);var Zj=a(955),Jj=a(1173),lj=a(1172);class mj{constructor(r){this.qpg=null;this.$Md=this.NRd=this.TRb=this.URb=0;this.Jbe=!1;this.Pjd=this.J1a=this.QOc=this.fjb=null;this.ckd=0;this.j6j=()=>{if(12E4>this.$.ea.Ti.Upb)for(const M of this.QOc)M.runTest();else this.Hee("UserInactive")};this.rZj=M=>
{M=Sys.Serialization.JavaScriptSerializer.serialize(M);aa.ULS.sendTraceTag(388821830,0,50,M)};this.EYj=M=>{if(M){var la=this.Pjd[M.testIteration.toString()];la?la.push(M):(la=[M],this.Pjd[M.testIteration.toString()]=la);if(la.length===this.qpg.length){la=Sys.Serialization.JavaScriptSerializer.serialize(la);if(this.$&&this.$.ni){if(M.EstimatedLatency=this.$.ni.wSe,this.$.ni.wSe>this.$.RD.ExcelRountripThresholdMs){aa.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${la}, consequtive slow ping iteration #: ${this.ckd++}`);
return}}else aa.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");aa.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${la}`);this.ckd=1}}};this.uk=(M,la)=>{M=la.context.methodName;if(M===Wf.a.fJb||M===Wf.a.YDa)this.TRb++,M=Date.now(),this.ghk(M)&&(this.TRb=0,this.$Md=M,this.bqk())};this.oka=()=>{this.jee("OnThrottledUserActivity")};this.HK=()=>{this.Hee("OnDocumentHidden")};this.xE=()=>{this.jee("OnDocumentUnhidden")};
this.$=r;if(this.Kbe=this.Vwh())this.qpg=[lj.a.HUc],this.ckd=1,this.Pjd={},this.$.ea.Ti.hAa(this.oka),ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void wb.a.resolve(Db.db).then(M=>{M.Y3(this.HK);M.rZ(this.xE)}):this.$.ja.Ne(291,M=>{M.Y3(this.HK);M.rZ(this.xE)})}dispose(){this.$&&(this.Jbe&&this.$.oa&&0<this.fjb.count&&this.$.oa.Gu(this.uk),this.Kbe&&(this.Hee("Dispose"),this.$.ea.Ti.vIa(this.oka)))}gMi(){ya.EwaSettings.Ia(199)&&this.bHj();
this.Kbe&&this.cHj()}HMi(){this.TRb=this.URb;this.$Md=0;var r={};if(!this.fjb){this.fjb=new Ya.a;const M=Jj.a.yvd(this.rZj,"InitSampleMeasurement",this.$);for(const la of M)r[la.cEd]=la.baseUrl,this.fjb.add(la)}r=Sys.Serialization.JavaScriptSerializer.serialize(r);aa.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.URb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.TRb}, testParams: ${r} `);0<this.fjb.count&&this.$.oa.rt(this.uk)}bqk(){for(const r of this.fjb)r.runTest()}jee(r){this.J1a&&
this.J1a.us||(aa.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${r}`),this.J1a=na.a.instance.MH(this.j6j,5E3,gd.a.Ynk),this.J1a.v0())}Hee(r){this.J1a&&this.J1a.us&&(aa.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${r}`),this.J1a.cancel())}ghk(r){return this.TRb>=this.URb&&r-this.$Md>this.NRd}Vwh(){return mj.epg(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}bHj(){this.URb=
this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;this.NRd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const r=this.$.xa.NetworkMeasurementsSamplePercentage;0<this.URb&&0<this.NRd&&(this.Jbe=mj.epg(r))&&this.HMi()}cHj(){if(!this.QOc){this.QOc=new Ya.a;const r=Jj.a.yvd(this.EYj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[lj.a.HUc]);for(const M of r)this.QOc.add(M);this.$.ea.Ti.It&&this.jee("PrepareAndInitSlowNetworkTests")}}static epg(r){return 100*Math.random()<r}}Object(da.a)(mj,
"NetworkMeasurement",null,[2]);var ti=a(923);class Kj{constructor(r){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=r}get count(){return this._count}get h_(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}oDk(){this.h_&&this.h_.cug()}Rah(r){this.allOfflinePartialInteractivitiesDataInSession.push(r);this._count++}}Object(da.a)(Kj,
"OfflinePartialInteractivitiesDataForLog",null,[]);class Lj extends Wi{constructor(r,M,la){super(r,M,la);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}Xck(r){this.timeFromLastOffline=r}g$j(r){this._errorDataDuringOfflineMode=r}}Object(da.a)(Lj,"OfflinePartialInteractivityData",Wi,[]);class xi{constructor(r,M){this.hYa=this.h_=null;this.A_d=-1;this.dHb=null;this.RNf=Fa.Task.delay(0);this.$jb=(la,Qa)=>{Qa.fV?this.evj(Qa.xwa):this.fvj()};this.pka=
(la,Qa)=>{5===Qa.H$f&&this.rcb()};this.vqg=(la,Qa)=>{this.h_.g$j(Qa.XJ)};this.rcb=()=>{this.hYa.oDk();this.G3j(xi.tYd,Sys.Serialization.JavaScriptSerializer.serialize(this.hYa))};this.gZj=la=>{if(la=la.result)this.FOg=!0,aa.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${la}`)};this.LSj=()=>{this.FOg&&(this.$?zd.TaskExtensions.Ca(this.indexedDB.Wnd(xi.tYd),()=>{aa.ULS.sendTraceTag(537155204,
0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.qa):aa.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.kYa=()=>{if(this.hYa&&0<this.hYa.count){const la=Sys.Serialization.JavaScriptSerializer.serialize(this.hYa);aa.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${la}`)}};
this.$=r;this.indexedDB=M;this.FOg=!1;this.indexedDB.Xi()&&(this.indexedDB.initialize(xi.gLb,xi.hLb),this.yYj(),this.hYa=new Kj(this.$.xa.UserSessionId),Ld.a(this.$).Jj.Hbd(this.$jb));this.Jp=we.a.instance.qM();this.Jp.ta("beforeunload",this.kYa)}dispose(){this.$&&Ld.a(this.$)&&Ld.a(this.$).Jj.f4d(this.$jb);Ic.a.Sa(this.dHb);this.$=this.dHb=null}evj(r){this.h_=new Lj(cd.a.Ae.yf,this.$,0!==r);this.h_.Xck(-1!==this.A_d?window.performance.now()-this.A_d:-1);this.hYa.Rah(this.h_);Ld.a(this.$).Jj.Obd(this.pka);
this.rcb();this.dHb=na.a.instance.MH(this.rcb,xi.Yai,gd.a.rcb);kj.a(this.$).mbd(this.vqg)}fvj(){this.h_.pWd(this.$);this.rcb();Ic.a.Sa(this.dHb);this.dHb=null;this.A_d=window.performance.now();Ld.a(this.$).Jj.rJc(this.pka);kj.a(this.$).N3d(this.vqg);this.FYj()}G3j(r,M){this.$?this.RNf=zd.TaskExtensions.Ca(this.RNf,()=>{this.indexedDB.j0a(new ti.a(r,M))},this.$.qa):aa.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}yYj(){const r=
this.$.qa;zd.TaskExtensions.Ca(zd.TaskExtensions.Ca(this.indexedDB.ETa(xi.tYd),this.gZj,r),this.LSj,r)}FYj(){if(this.h_){const r=Sys.Serialization.JavaScriptSerializer.serialize(this.h_);ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?fg.b().tYb(560791645,0,50,Gh.offline,this.h_.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",r):aa.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${r}`)}this.h_&&
this.h_.isToastShown&&qe.Health.instance.recordQosError(yj.a.IHk,[zj.a.$zc],!0,!1,!1,!1,null)}}xi.gLb="NetworkAvailability";xi.hLb="NetworkAvailabilityData";xi.tYd="partialInteractivityData";xi.Yai=3E3;Object(da.a)(xi,"OfflineModeTelemetryManager",null,[2]);var ak=a(1270);const Gi=r=>{r.isSuccess||(r=Sys.Serialization.JavaScriptSerializer.serialize(r),aa.ULS.sendTraceTag(509669840,0,10,r))};class Aj{constructor(r,M){this.Cta=this.USd=this.qYf=null;this.$=r;ya.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
Cc.a.hj||(this.qYf=new xi(r,M));ya.EwaSettings.Ia(199)&&(this.USd=new mj(this.$),this.USd.gMi());ya.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Cc.a.hj||(this.Cta=new Zj.NetworkConnectionHealthChecker(this.$));this.uCh=new cj(this.$);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(r=this.$,M=ya.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==M&&(new ak.a(r,"1CDN",M,Gi,"runOneCdnNetworkTest")).runTest())}dispose(){Ic.a.Sa(this.qYf);
Ic.a.Sa(this.USd);Ic.a.Sa(this.Cta);Ic.a.Sa(this.uCh);this.$=null}}Object(da.a)(Aj,"NetworkConnectionTelemetryManager",null,[2]);class bk extends Wi{constructor(r,M,la,Qa){super(r,M,la);this.wasInteruptedByOfflineMode=!1;this.type=Qa;this.wasInteruptedByOfflineMode=!1}$jb(){this.wasInteruptedByOfflineMode=!0}}Object(da.a)(bk,"SilentReopenData",Wi,[]);class nj{constructor(r){this.iea=null;this.N7f=(M,la)=>{this.L7f(la,3)};this.U3f=(M,la)=>{this.L7f(la,2)};this.$=r;this.Jj=Ld.a(this.$).Jj;this.Jj.LMe(this.U3f);
this.Jj.fgh(this.N7f)}dispose(){this.Jj.Pkg(this.U3f);this.Jj.aXj(this.N7f);this.iea=this.Jj=this.$=null}L7f(r,M){r.fV?this.iea=new bk(cd.a.Ae.yf,this.$,0!==r.xwa,M):(5===r.xwa&&(this.iea.wasInteruptedByOfflineMode=!0),3!==r.xwa&&2!==r.xwa||aa.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.iea.pWd(this.$),2===M?ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
fg.b().uYb(571289604,0,50,Gh.offline,this.iea.durationMs,this.iea):aa.ULS.sendTraceTag(571289604,0,50,tc.a.Vf(this.iea)):ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?fg.b().uYb(542782150,0,50,Gh.PUh,this.iea.durationMs,this.iea):aa.ULS.sendTraceTag(542782150,0,50,tc.a.Vf(this.iea)),this.iea=null)}}Object(da.a)(nj,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);let qi=class extends qd.a{constructor(r,M,la){la=void 0===la?!0:la;super();
this.k8=this.Ghc=this.iYa=this.iwa=this.D1a=null;this.tWf=0;this.sIc=this.mmb=this.nmb=!1;this.vWf=this.documentVisibilityObserver=null;this.Fya=!1;this.ZEd=this.qea=0;this.ONb=!1;this.VAg=0;this.Bbe=!1;this.z8=null;this.F4f=()=>{aa.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.WBc(1,!1)};this.xE=()=>{this.Bsa||this.lQb?window.setTimeout(()=>{this.Mge()},this.tWf):this.Mge();this.documentVisibilityObserver.sIa(this.xE);this.ONb=!1};this.Yi=
()=>{aa.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.lQb}, IsInDuringWorkSilentReopenMode:${this.KAc&&!this.Fya}`);this.lQb&&this.lJe();this.KAc&&!this.Fya&&this.gJe();Yb.h(this.$).cellTextEditBox.Zq(this.Yi);this.nmb=this.mmb=!1};this.H4f=()=>{aa.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.WBc(1,!0);this.mmb&&!this.nmb&&Yb.h(this.$).cellTextEditBox.Zq(this.Yi);this.mmb=
!1};this.oka=(Qa,Kb)=>{this.ZEd=this.qea;this.qea=Kb.SQc};this.M7f=()=>{this.$&&(this.sIc||(Cb.a(this.$).eW(se.a.TYa).Gdh(this.R4f),this.$.Go(this.Xg),this.sIc=!0),this.Fya=this.WSi(),this.WBc(2,!1))};this.R4f=()=>{var Qa=Cb.a(this.$).ul;const Kb=Qa.nkh();Qa=fe.f(Qa.sx.Ig.errors,hc=>hc.MessageIdName);aa.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Kb}, IsB2W:${this.Fya}, Errors: ${tc.a.Vf(Qa)}`);Kb&&(this.D1a?(this.Fya=
!1,this.w5e(),this.$Rc()):this.iwa&&(this.x5e(),this.$Rc()))};this.Xg=()=>{this.$?(aa.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.Fya=!1,this.k8&&this.k8.us&&(Ic.a.Sa(this.k8),this.k8=null),this.z8&&this.z8.us&&(Ic.a.Sa(this.z8),this.z8=null),this.WBc(2,!0),this.$Rc()):aa.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.L_f=()=>{this.oVf(!0)};this.M_f=()=>{this.oVf(!1)};
this.i$b=bj.y7i;this.Yjd=bj.connected;this.$=r;this.ni=r.oa.ni;la&&(this.vWf=new Aj(r,M));ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void wb.a.resolve(Db.db).then(Qa=>{this.documentVisibilityObserver=Qa}):this.$.ja.Ne(291,Qa=>{this.documentVisibilityObserver=Qa});this.tWf=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;this.ni.RMe(this.F4f);this.ni.izb(this.H4f);this.ni.gMe(this.L_f);this.ni.kdh(this.M_f);new nj(this.$,this);this.JRf=
this.$.xa.LongInactivityTimePeriodSeconds;this.$.ea.szb(this.M7f);this.$.ea.Ti.hAa(this.oka);this.VAg=this.$.xa.SilentReopenDuringWorkDelayMs}get oVi(){return this.Fya}get lQb(){return!(this.i$b&1)}get KAc(){return!(this.i$b&2)}get Bsa(){return!!(this.Yjd&2)}dispose(){this.ni&&(this.ni.Ukg(this.F4f),this.ni.vWb(this.H4f),this.ni.okg(this.L_f),this.ni.yUj(this.M_f));this.ONb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.sIa(this.xE),this.ONb=!1);this.$&&(this.sIc&&this.$Rc(),this.$.ea&&
(this.$.ea.yJc(this.M7f),this.$.ea.Ti&&this.$.ea.Ti.vIa(this.oka)));this.z8&&(this.z8.dispose(),this.z8=null);Ic.a.Sa(this.vWf);this.$=null;super.dispose()}gdj(){this.Bbe=!0}gJe(){this.iwa||(this.iwa=Ld.a(this.$).Jj.GOa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}WSi(){if(this.Bbe)return this.Bbe=!1,!0;const r=this.qea>this.JRf||this.ZEd>this.JRf&&10>this.qea;aa.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.qea}, Time gap between last two activities: ${this.ZEd}. return value:${r}`);
return r}uZj(){this.z8=na.a.instance.create(()=>{qe.Health.instance.recordQosError(yj.a.cok,[zj.a.$zc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}i9g(){this.iwa||this.k8?aa.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.k8=na.a.instance.create(()=>
{this.$?this.iwa?aa.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Yb.h(this.$).De?(this.mmb||(Yb.h(this.$).cellTextEditBox.Wr(this.Yi),aa.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.nmb=!0,aa.ULS.sendTraceTag(537155220,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.gJe():aa.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.VAg,gd.a.Vmk,void 0,!0)}oVf(r){this.Yjd=this.XUe(2,r,!0);this.VNe()}WBc(r,M){this.i$b=this.XUe(r,M,!1);this.VNe()}XUe(r,M,la){la=la?this.Yjd:this.i$b;
return M?la|r:la&~r}Mge(){const r=!!this.iYa,M=!!this.D1a,la=!!this.iwa,Qa=!!this.Ghc;this.lQb&&!r?this.h9g():!this.lQb&&r&&this.PNh();!this.KAc||M||la?this.KAc||(M?this.w5e():(la||this.k8&&this.k8.us)&&this.x5e()):this.Fya?this.g9g():this.k8||this.i9g();this.Bsa&&!Qa?this.hGg(!0):!this.Bsa&&Qa&&this.hGg(!1)}h9g(){this.$?this.iYa?aa.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
Yb.h(this.$).De?(this.nmb||(Yb.h(this.$).cellTextEditBox.Wr(this.Yi),aa.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.mmb=!0,aa.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.lJe():aa.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}lJe(){this.iYa||
(this.iYa=Ld.a(this.$).Jj.GOa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}PNh(){this.iYa&&(Ic.a.Sa(this.iYa),this.iYa=null)}w5e(){this.D1a&&(Ic.a.Sa(this.D1a),this.D1a=null);this.z8&&this.z8.us&&this.z8.cancel();this.z8=null}x5e(){this.iwa&&(Ic.a.Sa(this.iwa),this.iwa=null);this.k8&&(Ic.a.Sa(this.k8),this.k8=null);this.nmb&&!this.mmb&&Yb.h(this.$).cellTextEditBox.Zq(this.Yi);this.nmb=!1}g9g(){this.D1a||(this.D1a=Ld.a(this.$).Jj.GOa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,wc.a.instance.ia(2190)));this.uZj()}hGg(r){r?(this.Ghc=Ld.a(this.$).Jj.GOa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.mKj()):(Ic.a.Sa(this.Ghc),this.Ghc=null)}mKj(){if(this.$&&this.$.oa){const r=this.$.oa.ua.qf();Bd.J(this.$.oa.ua,null,null,null,r)}}$Rc(){Cb.a(this.$).eW(se.a.TYa).Eu(this.R4f);this.$.Hp(this.Xg);this.sIc=!1}VNe(){this.documentVisibilityObserver||aa.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.tk?this.ONb||(this.documentVisibilityObserver.rZ(this.xE),this.ONb=!0,aa.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.Mge()}};qi=Object(hb.__decorate)([Object(wb.d)(Db.Ec),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(Db.kc)())],qi);Object(da.a)(qi,"NetworkConnectionStateManager",
qd.a,[305,2]);var ck=a(288);class Mj{constructor(r){this.AXa=this.qQd=this.EXa=this.WAc=0;this.jQd=this.WSf=null;this.EEc=M=>{"pen"!==M.pointerType||this.EXa||(this.EXa=Math.floor(this.vEb()/1E3),this.EXa<=this.WAc&&(this.EXa=this.WAc),this.qQd=0)};this.nka=()=>{this.Qxf()};this.zUa=(M,la)=>{0!==la.newState&&this.Qxf()};this.P$i=()=>{0<this.AXa&&this.ysg(this.AXa);this.AXa=0};r?(this.eBc=r,this.vEb=Date.now,this.GJh(),this.nRj()):aa.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}nbk(){this.WSf=
"Office.Excel.Online.Data.Activity.PenMinutes"}nRj(){window.document.body.addEventListener("pointerenter",this.EEc);window.document.body.addEventListener("pointerleave",this.nka);mc.a.instance.We("Common.App.VisibilityManagement.IVisibilityManager").execute(r=>{r.Nbd(this.zUa)})}Qxf(){const r=Math.ceil(this.vEb()/1E3);this.EXa&&r>this.WAc&&(this.qQd=r,this.AXa+=this.qQd-this.EXa);this.WAc=r;this.EXa=0}GJh(){this.jQd=new Qe.a(4,2,6E4,this.P$i);this.eBc.Li(this.jQd)}ysg(r){const M=new ck.a;M.name=this.WSf;
const la=[];(r=hh.a.Ni("PenInputSec",r.toString(),3))&&Array.add(la,r);M.dataFields=la;jc.a.sendActivityEvent(M)}dispose(){0<this.AXa&&this.ysg(this.AXa);this.eBc.At(this.jQd)}}Object(da.a)(Mj,"PenMinutesManager",null,[334]);class oj{constructor(){this.v5c=this.$b=null}get name(){return"Common.App.PenMinutesManager"}dl(r){this.$b=r;const M=za.AFrameworkApplication.jl;this.$b.register(334,"Common.App.PenMinutesManager.IPenMinutesManager").If().Rf(()=>new Mj(M))}init(){this.v5c=this.$b.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.v5c&&
this.v5c.dispose()}static main(){Tb.a.instance.Ul(new oj)}}Object(da.a)(oj,"PenMinutesManagerPackage",null,[4,5]);Object(wb.b)(Db.Xc,{nn:"singleton"})(()=>{Type.registerNamespace("Common.App.PenMinutesManager");oj.main();const r=mc.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");r.nbk();return r});var pj;let qj=pj=class{constructor(){this.tRe=null;this.jxj=M=>{aa.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${M.data.httpStatus}.`);this.Wxf(M.data.responseData)};
this.ixj=M=>{200<=M.data.httpStatus&&300>M.data.httpStatus?(aa.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${M.data.httpStatus}.`),this.Wxf(M.data.responseData)):aa.ULS.sendTraceTag(508421218,0,15,`DMS call to get SDX list fails with status ${M.data.httpStatus}.`)};const r=ya.EwaSettings.getStringFeatureGate("Microsoft.Office.ExcelOnline.SdxManifestPrefetchAssetIds","");""!==r&&(this.tRe=r.split(";"),this.XGj())}XGj(){const r=Ef.a.create().toString();aa.ULS.sendTraceTag(508421250,
0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${r}).`);za.AFrameworkApplication.lg.ir(Qg.a.current.NK.SdxDmsUrl,2,pj.UKh(),pj.VKh(r),!1,4,this.jxj,this.ixj,null)}bXh(){return ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.UseSdx1CdnUrl",!1)||Qg.a.current.NK.ForceUseSdx1Cdn}Wxf(r){try{const M=Hb.b(r).Packages,la=this.bXh()?Qg.a.current.NK.Sdx1CdnUrl:Qg.a.current.NK.SdxCdnUrl;for(const Qa of M)if(this.tRe.includes(Qa.AssetId)){const Kb=String.format(la,
Qa.AssetId,Qa.FFN,Qa.Version,"en-us");Qg.a.MZd(Kb,!1,null,!0)}window.prefetchedDmsResponse=r}catch(M){aa.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${r.substring(0,40)}...".`)}}static UKh(){const r=Object(Zb.a)(String,za.AFrameworkApplication.pf.AudienceGroup)||"";return Hb.c({["Context"]:{["Hosts"]:["Workbook"],["ReactNativeVersion"]:"0.0.0.0",["Channel"]:"DevMain",["Capabilities"]:[{["Name"]:"addincommands",["Version"]:"1.1"},{["Name"]:"bindingevents",["Version"]:"1.1"},{["Name"]:"biplatvisualrichapi",
["Version"]:"1.8"},{["Name"]:"customfunctions",["Version"]:"1.9"},{["Name"]:"customfunctionsruntime",["Version"]:"1.2"},{["Name"]:"compressedfile",["Version"]:"1.1"},{["Name"]:"DataFromPicture",["Version"]:"1.1"},{["Name"]:"pivotfilters",["Version"]:"1.2"},{["Name"]:"pdffile",["Version"]:"1.1"},{["Name"]:"dialogapi",["Version"]:"1.2"},{["Name"]:"dialogorigin",["Version"]:"1.2"},{["Name"]:"documentevents",["Version"]:"1.1"},{["Name"]:"excelapi",["Version"]:"1.12"},{["Name"]:"excelapionline",["Version"]:"1.1"},
{["Name"]:"excelapiundo",["Version"]:"1.4"},{["Name"]:"firstpartyauthentication",["Version"]:"1.1"},{["Name"]:"identityapi",["Version"]:"1.3"},{["Name"]:"matrixbindings",["Version"]:"1.1"},{["Name"]:"matrixcoercion",["Version"]:"1.1"},{["Name"]:"numberformatting",["Version"]:"1.2"},{["Name"]:"pivot",["Version"]:"1.5"},{["Name"]:"richapiruntime",["Version"]:"1.2"},{["Name"]:"richapiruntimeflag",["Version"]:"1.2"},{["Name"]:"selection",["Version"]:"1.1"},{["Name"]:"settings",["Version"]:"1.1"},{["Name"]:"sharedruntime",
["Version"]:"1.1"},{["Name"]:"tablebindings",["Version"]:"1.1"},{["Name"]:"tablecoercion",["Version"]:"1.1"},{["Name"]:"tablestyle",["Version"]:"1.1"},{["Name"]:"textbindings",["Version"]:"1.1"},{["Name"]:"textcoercion",["Version"]:"1.1"},{["Name"]:"file",["Version"]:"1.1"},{["Name"]:"webauth",["Version"]:"1.1"}],["Ring"]:"Automation"===r?"Dogfood":r,["Platform"]:"Web",["Locales"]:[za.AFrameworkApplication.uiCulture],["ClientId"]:za.AFrameworkApplication.fa.Ta("LoggableUserId")},["SyncId"]:0})}static VKh(r){return{["Content-Type"]:"application/json",
["DMSActivityId"]:r}}};qj=pj=Object(hb.__decorate)([Object(wb.d)(Db.Ed)],qj);Object(da.a)(qj,"SdxManifestPrefetcher",null,[]);var dk=a(1228),ek=a(845),fk=a(229),Bj=a(217);class gk{constructor(){this.i7g=new Ya.a;this.j7g=new Ya.a}get u2a(){return this.i7g}get pFg(){return this.j7g}get Xl(){return this.fuk}Sbh(r,M){this.u2a.add(r);this.pFg.add(M)}Tbh(r,M){this.fuk={URd:r,DQd:M}}}Object(da.a)(gk,"ThemeInfoCache",null,[]);var pk=a(52);let rj=class{constructor(r){this.u2a=this.YQ=null;this.Fwc=!1;this.fge=
null;this.FBc=new Set;this.Ppb=this.s2c=!1;this.DGb=0;this.isj=M=>{this.Fwc=!1;if(!M||oe.a(M))aa.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${M?dg.a.xf(M.Errors):"(no result)"}]`),this.xog();else if(this.DGb=0,M=M.Result){this.Bn&&null!==this.YQ&&this.oBh(M);this.YQ=new gk;if(this.oI){this.u2a=M.ThemeColors;this.fge=[];for(var la=0;10>la;la++)this.fge.push(ek.a.NTa(fk.a.RF(this.u2a[la])));for(la=0;6>la;la++)for(let Qa=0;10>Qa;Qa++){const Kb=Bj.a.Cda(Bj.a.mL(this.u2a[10*
la+Qa])),hc=ek.a.wri(la,Qa,this.fge[Qa],this.u2a[Qa]);this.YQ.Sbh(Kb,hc)}}this.Bn&&(this.YQ.Tbh(M.MinorFont,M.MajorFont),this.Ppb=!1,ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModernFontPicker",!1)&&ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)&&dk.a.vPf([M.MajorFont,M.MinorFont]));ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)&&ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",
!1)&&"Aptos Narrow"===M.MinorFont&&(M=pk.a.instance.xba(new Date),27E4>M?window.setTimeout(()=>{this.$.Lf(-569754003,-1,0,null)},27E4-M):this.$.Lf(-569754003,-1,0,null));this.s2c=!1;this.Xka()}else aa.ULS.sendTraceTag(556656003,0,10,"ThemesManager: The obtained ThemeInfo is null")};this.hsj=()=>{this.Fwc=!1;this.xog()};this.xog=()=>{3>this.DGb?(this.DGb++,aa.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.DGb}`),this.ccb(null,!0)):(this.DGb=
0,aa.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.MEc=()=>{this.YQ&&(aa.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),this.Bn?this.Ppb=!0:this.YQ=null,this.ccb(null,!0))};this.vg=(M,la)=>{this.YQ&&(aa.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),la.hI&&(this.s2c=!0))};this.zE=()=>{this.FBc.clear()};this.$=r;this.$.ea.cM(this.MEc);this.$.ea.wn(this.vg);this.$.Ha.X7a(this.zE);
this.oI=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Bn=ya.EwaSettings.Bn()}get Qpb(){return!this.YQ||this.Ppb?null:this.YQ.u2a}get oFg(){return!this.YQ||this.Ppb?null:this.YQ.pFg}get Xl(){return!this.YQ||this.Ppb?null:this.YQ.Xl}get pLf(){return this.s2c}ccb(r,M){if(this.$.isEditMode||(void 0===M?0:M))if(!this.YQ||this.pLf||this.Ppb)if(r&&""!==r&&this.FBc.add(r),!this.Fwc){this.Fwc=!0;r=this.$.oa.ua;M=this.isj;var la=this.hsj;const Qa=r.Oa(1,null);Bd.h(r,"GetThemeInfo",
Qa,M,la,null,null,4)}}getThemeColor(r){let M,la=-1;M=-1;if(!this.Qpb)return aa.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,XJa:M};for(let Qa=0;Qa<this.Qpb.count;Qa++)if(r===this.Qpb.ka(Qa)){la=Qa;break}if(-1!==la)return M=Math.floor(la/10),{returnValue:!0,themeIndex:la%10,XJa:M};aa.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,XJa:M}}Xka(){for(const r of this.FBc)this.$.frame.$B(r);
this.FBc.clear()}oBh(r){const M=this.YQ.Xl.DQd;this.YQ.Xl.URd===r.MinorFont&&M===r.MajorFont||aa.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};rj=Object(hb.__decorate)([Object(wb.d)(Db.le),Object(hb.__param)(0,Object(Db.nb)())],rj);Object(da.a)(rj,"ThemesManager",null,[303]);var Nj=a(1252),Oj=a(940),Xi=a(1185),Cj=a(1184);let sj=class{constructor(){}Hud(r,M){r=r.units;var la=M.units;if(r.length!==la.length)return aa.ULS.sendTraceTag(508367051,0,15,
"CalcInterfaceAdapter.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;M=[];let Qa=-1;for(let Kb=0;Kb<r.length;Kb++)switch(r[Kb].kind){case Cj.a.blank:M.push(...fe.h(" ",la[Kb].str.length));break;case Cj.a.string:M.push(r[Kb].str);break;case Cj.a.ljf:M.push("");Qa=Kb;break;case Cj.a.general:M.push(la[Kb].str);break;default:aa.ULS.sendTraceTag(508367050,0,15,"CalcInterfaceAdapter.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=
Qa||""===la[Qa].str)return null;la={};la.Start=M.slice(0,Qa).join("");la.Separator=r[Qa].str;la.End=M.slice(Qa+1,M.length).join("");return la}bqf(r){switch(r.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return aa.ULS.sendTraceTag(508367049,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}mpf(r){if(r=r.color){if("String"===Object.getType(r).getName())return Bj.a.ls(r);if("Number"===Object.getType(r).getName())return null}else return null;
aa.ULS.sendTraceTag(508367048,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}HTi(r,M){r=excelOnlineCalc.calc.getCellValueKind(r.rangeDelta.data.value);switch(r){case "number":case "string":case "boolean":case "Blank":case "Error":return!0;case "Rich":return M.numberOfUnsupportedRichCellTypes++,!1;default:return aa.ULS.shipAssertTag(508367047,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${r}`),!1}}mnf(r){r=excelOnlineCalc.calc.getCellValueKind(r.rangeDelta.data.value);
let M=0;switch(r){case "number":M=1;break;case "string":M=2;break;case "boolean":M=3;break;case "Error":M=4;break;case "Blank":M=0;break;default:aa.ULS.shipAssertTag(508367046,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${r}`)}return M}cGh(r){const M=r.value;switch(r.type){case 2:return void 0===M||null===M?"":M;case 1:return r=parseFloat(M),isNaN(r)?null:r;case 3:return r=parseFloat(M),isNaN(r)?null:1===r;case 4:return r=parseFloat(M),isNaN(r)?null:excelOnlineCalc.calc.errorValue(r);
default:return excelOnlineCalc.calc.blankValue}}Bpc(r){"kind"in r&&aa.ULS.shipAssertTag(508367045,0,r.kind!==Oj.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");r=excelOnlineCalc.numfmt.getValueEditOperKind(r);let M=0;switch(r){case 0:case 128:M=0;break;case 1:M=1;break;case 2:M=2;break;case 4:M=3;break;case 8:M=4;break;case 16:case 32:case 64:case 256:aa.ULS.sendTraceTag(508367044,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${r} to a CellValueType`);
break;default:aa.ULS.shipAssertTag(508367043,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${r}`)}return M}Xsf(r,M){const la=this.urc(M);var Qa=!(void 0===M.rangeDelta.data.format||null===M.rangeDelta.data.format);aa.ULS.shipAssertTag(508367042,0,0===la||!Qa,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${M.priorityGroup}`);r=Math.max(r.cell.Ok,0);Qa&&(Qa=excelOnlineCalc.calc.getCellFormatKind(M.rangeDelta.data.format.format),
"number"===Qa?r=M.rangeDelta.data.format.format:"string"===Qa?aa.ULS.sendTraceTag(508367041,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Qa?aa.ULS.sendTraceTag(508367040,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):aa.ULS.shipAssertTag(508367011,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return r}urc(r){if(r.priorityGroup===Xi.a.editCell)return 0;if(r.priorityGroup===Xi.a.dependentCell)return 1;
aa.ULS.sendTraceTag(508367010,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}Gpi(r){r=this.urc(r);if(0===r)return 1;if(1===r)return 2;aa.ULS.sendTraceTag(508367009,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}Uii(r){return r.rangeDelta.range.column+1}aji(r){return r.rangeDelta.range.row+1}zwd(r){return r.rangeDelta.data.value.toString()}getCellValueKind(r){return excelOnlineCalc.calc.getCellValueKind(r.rangeDelta.data.value)}Awd(r){var M,
la;return null===(la=null===(M=null===r||void 0===r?void 0:r.value)||void 0===M?void 0:M.value)||void 0===la?void 0:la.toString()}};sj=Object(hb.__decorate)([Object(wb.d)(Db.t),Object(hb.__param)(0,Object(Db.sb)())],sj);Object(da.a)(sj,"CalcInterfaceAdapter",null,[302]);var Yi=a(104);class dj{}dj.local="Local";dj.iuk="Thread";Object(da.a)(dj,"RecalcServiceCreateMode",null,[]);var Dj=a(196);class tj{constructor(r){this.Eqe=null;this.init(r)}get dha(){return this.Eqe}init(r){this.Eqe=new rh.a;if(void 0!==
r&&null!==r&&void 0!==r.HeadersList&&null!==r.HeadersList&&0<r.HeadersList.length)for(const M of r.HeadersList)this.dha.da(M.Index,M.Name)}}Object(da.a)(tj,"ColHeadersListData",null,[]);var Pj=a(114);class Qj{constructor(r,M){this.WUe=r;this.sheetName=M;this.wYb=!1}}Object(da.a)(Qj,"CalcBlockInformation",null,[]);class hk{constructor(r,M,la,Qa,Kb){this.type=r;this.fullName=M;this.range=la;this.sheetId=Qa;this.attributes=Kb;this.GJ=null}}Object(da.a)(hk,"CalcNamedObject",null,[]);class Rj{get Vn(){return this.HFe}constructor(){this.HFe=
[];this.Iie=[];this.N9a={}}Tvg(r,M){this.HFe[r]=M}getSheetIndex(r){for(let M=1;M<this.Vn.length;M++)if(ad.a.equals(this.Vn[M].Wva.sheetName,r,!1))return M;return-1}}Object(da.a)(Rj,"GridCache",null,[]);var Sj=a(759),Zi=a(584);class Tj{constructor(r){this.Wva=r;this.Lca=new Sj.a(Zi.a.Ki());this.pCc=!1}}Object(da.a)(Tj,"SheetInformation",null,[]);var Ej=a(1043),uj;(function(r){r[r.initialization=0]="initialization";r[r.contentReady=1]="contentReady";r[r.cellEdit=2]="cellEdit"})(uj||(uj={}));Object(da.b)("UpdateDataTrigger",
uj);class mh{constructor(r){this.H1d=null;this.COd=this.G1d=this.DWd=!1;this.z_d=0;this.r_d=this.t_d=this.u_d=this.s_d=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.Xs=null;this.Zw=this.currentStateId=-1;this.CBa="";this.vha=null;this.getNameLoc=(M,la)=>this.ixc()?this.Di.ka(this.currentStateId).Vn[0].Lca.$d(la)?(M=excelOnlineCalc.location.nameLoc(M,la),excelOnlineCalc.util.success(M)):excelOnlineCalc.util.success(null):(M=excelOnlineCalc.util.unavailable([2]),
excelOnlineCalc.util.failure(M));this.getContainingTable=M=>{if(!this.ixc())return M=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(M);const la=M.range.col,Qa=M.range.row;var Kb=this.Di.ka(this.currentStateId).Vn[0].Lca,hc=null;for(const Ac of Kb)if(Kb=Ac.value,2===Kb.type&&ad.a.equals(M.sheet.index.toString(),Kb.sheetId,!0)){const Zc=Kb.range;la>=Zc.left-1&&la<=Zc.right-1&&Qa<=Zc.bottom-1&&Qa>=Zc.top-1&&(hc=excelOnlineCalc.location.nameScope(this.documentLoc,Kb.sheetId),hc=excelOnlineCalc.location.nameLoc(hc,
Kb.fullName))}return hc?excelOnlineCalc.util.success(hc):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(M,la)=>{if(!this.ixc()){var Qa=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Qa)}Qa=M.name;var Kb=this.Di.ka(this.currentStateId).Vn[0].Lca;if(Kb.$d(Qa)){Kb=Kb.ka(Qa);const Ac=Kb.range;if(2!==Kb.type)return excelOnlineCalc.util.failure(this.Fld(5));const Zc=Kb.GJ?Kb.GJ.dha:null;if(!Zc)return excelOnlineCalc.util.success(null);for(var hc of Zc)if(ad.a.equals(hc.value,
la,!0))return M=excelOnlineCalc.location.documentLoc(M.scope.document.path,M.scope.document.name),M=excelOnlineCalc.location.sheetIndex(M,Kb.sheetId),hc=excelOnlineCalc.location.gridRange(Ac.top-1,hc.key,Ac.bottom-Ac.top+1,1),hc=excelOnlineCalc.location.sheetGridRange(M,hc),Qa=excelOnlineCalc.location.structRefColumnLoc(Qa,hc,!!(Kb.attributes&16),!!(Kb.attributes&8)),excelOnlineCalc.util.success(Qa);return Ac.right-Ac.left+1!==Zc.count?(Qa=excelOnlineCalc.util.unavailable([17,M,la]),excelOnlineCalc.util.failure(Qa)):
excelOnlineCalc.util.failure(this.Fld(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(M,la)=>{if(!this.ixc())return la=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(la);var Qa=this.Di.ka(this.currentStateId).Vn[0].Lca;if(Qa.$d(M.name)){var Kb=Qa.ka(M.name);if(2!==Kb.type)return excelOnlineCalc.util.failure(this.Fld(5));Qa=!!(Kb.attributes&16);const hc=!!(Kb.attributes&8),Ac=Qa?1:0,Zc=hc?1:0;M=excelOnlineCalc.location.documentLoc(M.scope.document.path,
M.scope.document.name);M=excelOnlineCalc.location.sheetIndex(M,Kb.sheetId);Kb=Kb.range;let Ad={};if(1===la)Ad=excelOnlineCalc.location.gridRange(Kb.top-Ac-1,Kb.left-1,Kb.bottom+Zc-Kb.top+Ac+1,Kb.right-Kb.left+1);else if(2===la)Ad=excelOnlineCalc.location.gridRange(Kb.top-1,Kb.left-1,Kb.bottom-Kb.top+1,Kb.right-Kb.left+1);else if(3===la)if(Qa)Ad=excelOnlineCalc.location.gridRange(Kb.top-2,Kb.left-1,1,Kb.right-Kb.left+1);else return excelOnlineCalc.util.success(null);else if(4===la)if(hc)Ad=excelOnlineCalc.location.gridRange(Kb.bottom,
Kb.left-1,1,Kb.right-Kb.left+1);else return excelOnlineCalc.util.success(null);la=excelOnlineCalc.location.sheetGridRange(M,Ad);return excelOnlineCalc.util.success(la)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(M,la)=>{if((ad.a.equals(M,this.documentLoc.path,!0)||!M)&&ad.a.equals(la,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);M=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(M,la)]);return excelOnlineCalc.util.failure(M)};
this.getSheetIndex=(M,la)=>{if(!this.Di.$d(this.currentStateId)||!this.Di.ka(this.currentStateId).Vn)return la=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(la);M=this.Di.ka(this.currentStateId).Vn;for(let Qa=1;Qa<M.length;Qa++)if(ad.a.equals(M[Qa].Wva.sheetName,la,!0))return excelOnlineCalc.util.success(M[Qa].Wva.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(M,la)=>{if(!this.Di.$d(this.currentStateId)||!this.Di.ka(this.currentStateId).Vn)return la=excelOnlineCalc.util.unavailable([2]),
excelOnlineCalc.util.failure(la);M=this.Di.ka(this.currentStateId).Vn;for(let Qa=1;Qa<M.length;Qa++)if(ad.a.equals(M[Qa].Wva.sheetId,la,!0))return excelOnlineCalc.util.success(M[Qa].Wva.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);
this.O4f=()=>{this.setNumberFormats()};this.Xg=()=>{aa.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Di=new rh.a;this.currentStateId=this.Zw=-1;this.CBa="";this.pab=null;this.G1d=!1;this.Xs&&this.clearCache()};this.ug=r;this.Di=new rh.a;this.pab=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.ug.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Wwa();this.kca=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8373394_setCellEstimationPrefetch");
this.Uia=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableCrossVisibleRangeAndDifferentSheetCSE",!1)}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.jJc(this.O4f);this.ug&&this.ug.Hp(this.Xg);this.close()}v1b(r){if(!this.Xs)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.ug.ja.Qa(268),!this.instantaneousSupportInformationManager))return aa.ULS.sendTraceTag(537170198,0,50,
"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==r&&(this.currentStateId=this.ug.ea.UP,this.currentStateId===Wf.a.th&&(this.currentStateId=this.ug.ea.uh));if(1===r&&this.currentStateId<this.Zw)return aa.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Zw} - ignoring update`),!1;this.D9j();0!==r&&this.G1d||(this.udk(),this.oak(),this.cbk(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Gbd(this.O4f),
this.ug.Go(this.Xg),this.G1d=!0);this.tOj();let M=!1;0===r&&(M=this.$Ni());if(0!==r||M)this.Bck()?(this.fdk(r),this.edk(),this.Zw=this.currentStateId,this.Exh()):aa.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==r&&this.resumeRecalc();return!0}evalFormula(r,M,la,Qa){if(!this.Xs)return aa.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});M=excelOnlineCalc.calc.sheetCellLocation(null!==
la&&void 0!==la?la:Dg.d(this.ug.sa.na),M.top-1,M.left-1);r=this.Xs.evalFormula(this.ug.ea.uh,r,M,Qa);this.resumeRecalc();return r}eth(r,M,la,Qa){Qa=void 0===Qa?null:Qa;const Kb=Dg.d(this.ug.sa.na);let hc=r.cell.TC-1,Ac=r.cell.XF-1;var Zc=hc,Ad=Ac;let re=null;Qa&&(re=excelOnlineCalc.calc.cellLocation(hc,Ac),hc=Qa.top-1,Ac=Qa.left-1,Zc=Qa.bottom-1,Ad=Qa.right-1);la=this.h2b(r,la,"SetCell");0>la||(Ad=mh.naa("CalculateFormula.cell",Kb,hc,Ac,Zc,Ad),Zc=[],Qa=this.AJb(Kb),M=excelOnlineCalc.calc.inferredRangeFormulaEdit(Ad,
M,re,Qa),Zc.push(M),r=(M=this.yBd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Kb,hc,Ac,ad.a.UOe(r.cell.text),la,M.top-1,M.left-1,M.bottom-1,M.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Kb,hc,Ac,ad.a.UOe(r.cell.text),la,"","","",""),aa.ULS.sendTraceTag(537170180,0,50,r),this.Xs.editRangeFormulas(la,Zc),this.resumeRecalc())}fth(r,
M){const la=[];var Qa=Dg.d(this.ug.sa.na),Kb=this.AJb(Qa);M=this.h2b(r[0].zha,M,"SetCellBatched");if(0>M)return!1;for(var hc of r){var Ac=hc.zha.cell,Zc=Ac.TC-1;Ac=Ac.XF-1;Zc=mh.naa("CalculateFormulaBatched.cell",Qa,Zc,Ac,Zc,Ac);Zc=excelOnlineCalc.calc.inferredRangeFormulaEdit(Zc,hc.editText,null,Kb);la.push(Zc)}Kb=this.yBd();hc=r[0].zha.cell.TC-1;Zc=r[0].zha.cell.XF-1;Ac=r[r.length-1].zha.cell.TC-1;r=r[r.length-1].zha.cell.XF-1;Qa=Kb?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",
Qa,hc,Zc,Ac,r,M,Kb.top-1,Kb.left-1,Kb.bottom-1,Kb.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Qa,hc,Zc,Ac,r,M,"","","","");aa.ULS.sendTraceTag(508932947,0,50,Qa);this.Xs.editRangeFormulas(M,la);this.resumeRecalc();return!0}h5(r,M,la,Qa,Kb){if(!this.Xs)return aa.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");
if(!la||!M)return aa.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!la}, outputColumnRange null: ${!M}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");aa.ULS.shipAssertTag(537170178,0,la.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");const hc=Dg.d(this.ug.sa.na),Ac=this.AJb(hc);let Zc=null;if(r){Zc=[];for(const Ge of r)if(Ge.column!==la.left){r=Ge.row-1;var Ad=Ge.column-
1;r=mh.naa("EvalFormulaRangeOnClone.cell",hc,r,Ad,r,Ad);Ad=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?ik(Ge.im,Ge.formulaBarText,Ge.Ok):excelOnlineCalc.calc.valueCellData(Ge.text,Ge.text,Ge.Ok,null);Zc.push(excelOnlineCalc.calc.rangeWrite(r,Ad))}}la=excelOnlineCalc.calc.cellLocation(la.top-1,la.left-1);M=mh.naa("EvalFormulaRangeOnClone.outputColumnRange",hc,M.top-1,M.left-1,M.bottom-1,M.right-1);let re;Kb?this.kca&&(Qa=[excelOnlineCalc.calc.inferredRangeFormulaEdit(M,
Qa,la,Ac)],re=this.Xs.evalOnClonedModel(Zc,Qa,Kb)):(Kb=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(M,Qa,la,Ac)],re=this.Xs.evalOnClonedModel(Zc,Kb));this.resumeRecalc();return re}localizeEnglishFormula(r,M,la){M=excelOnlineCalc.calc.sheetCellLocation(Dg.d(M),la.top-1,la.left-1);return this.Xs.localizeEnglishFormula(r,M)}o4e(r){let M=null;try{if(r)if(this.CBa=Yb.h(this.ug).ya.pDa(r),this.currentStateId=r.d2a,this.currentStateId<this.Zw||this.currentStateId===Wf.a.th)aa.ULS.sendTraceTag(537170176,
0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.CBa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Zw}`);else{if(this.fOi(),1===r.TA.PaneType&&this.IGk(r.na),!this.Ynh())if(M=this.ug.Ve.Sf("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.CBa} StateId:${this.currentStateId}`),this.pab=this.pW(r.na.sheetName))if(Yb.h(this.ug).ya.Bq.iFb(r.Eg)){var la=r.Ci;if(la){var Qa=la.getCalcBlockModel();if(Qa)if(this.Qnh(Qa)){this.Di.ka(this.currentStateId).N9a[this.CBa]=
new Qj(Qa,r.na.sheetName);var Kb=r.gh;Kb?this.zah(Kb.NamedObjects):aa.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else aa.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else aa.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else aa.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.CBa}`)}else aa.ULS.sendTraceTag(509117972,
0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const hc=!!(this.ug.Wg&32),Ac=this.Di.$d(this.currentStateId)&&this.Di.ka(this.currentStateId).Vn?this.Di.ka(this.currentStateId).Vn.length:0;aa.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${Ac}, scratchPad:${hc}, sheetNameLength:${r.na.sheetName?r.na.sheetName.length:-1} Hash:${r.na.hash}`)}}else aa.ULS.shipAssertTag(537170177,
0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{M&&M.stop()}}jUa(r){var M;if(!this.Di.$d(this.currentStateId))return aa.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const la=null===(M=this.Di.ka(this.currentStateId))||void 0===M?void 0:M.Vn;if(!la||!la[0])return null;M=la[0].Lca;if(!M||!M.$d(r.name))return aa.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==
M}`),null;r=M.ka(r.name);if(!r||!r.GJ)return null;M=new Ya.a;for(const Qa of r.GJ.dha)M.add(Qa.value);return M}gth(r,M,la){var Qa=Yb.h(this.ug),Kb=Qa.Pe(r[0].targetRange);if(this.Uia){if(Kb=this.h2b(Kb,M,"CopyPaste"),0>Kb){aa.ULS.sendTraceTag(508065925,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPasteBatched(). Revision not valid. targetRevision:${Kb}.`);return}}else if(Kb=this.h2b(Kb,null,"CopyPaste"),M=this.h2b(Qa.Pe(r[0].sourceRange),M,"CopyPaste"),0>Kb||0>M||Kb!==M){aa.ULS.sendTraceTag(508065924,
0,15,`CalcAsyncEngine::CalculateFormulaForCopyPasteBatched(). Revision not valid. sourceRevision:${M}, targetRevision:${Kb}.`);return}M=Kb;Qa=[];for(const hc of r)r=this.hvi(M,la,hc.sourceRange,hc.targetRange),Qa.push(r);this.Xs.editRangePaste(Kb,Qa);this.resumeRecalc()}hvi(r,M,la,Qa){let Kb,hc,Ac;this.Uia?(hc=Dg.d(this.ug.sa.na),Kb=M?Dg.d(this.ug.sa.getItemByName(M)):hc,M=this.AJb(hc)):(Ac=Dg.d(this.ug.sa.na),M=this.AJb(Ac));la=mh.naa("getRangePasteEdit.srcRange",this.Uia?Kb:Ac,la.top-1,la.left-
1,la.bottom-1,la.right-1);Qa=mh.naa("getRangePasteEdit.targetRange",this.Uia?hc:Ac,Qa.top-1,Qa.left-1,Qa.bottom-1,Qa.right-1);Qa=excelOnlineCalc.calc.copyPasteRangePasteEdit(Qa,la,M);this.Uia?(la="CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",r=M?String.format(la,Kb,hc,r,M.row,M.column,M.lastRow,M.lastColumn):String.format(la,hc,r,"","","","")):(la="CalcAsyncEngine::getRangePasteEdit() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
r=M?String.format(la,Ac,r,M.row,M.column,M.lastRow,M.lastColumn):String.format(la,Ac,r,"","","",""));aa.ULS.sendTraceTag(537170142,0,50,r);return Qa}AJb(r){const M=this.yBd();let la=null;M?la=mh.naa("GetViewport.viewport",r,M.top-1,M.left-1,M.bottom-1,M.right-1):aa.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return la}yBd(){const r=Yb.h(this.ug);let M=r.Xk;if(Yb.h(this.ug).Be.Gl){M=r.wi(1).Xk;if(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!M)return aa.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;M.Ala(1,1);M.Ala(3,1)}return M}h2b(r,M,la){let Qa;if(!this.Xs||!r)return aa.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.Xs}, modifiedCell is null:${!r}, operation:${la}`),-1;const Kb=r.cell.TC-1,hc=r.cell.XF-1;if(r.cell.$z){if(Qa=r.cell.$z.Aec,Qa===Wf.a.th)return aa.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${r.cell.$z.Eg}, operation:${la}`),
-1}else return aa.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${r.cell.TC},${r.cell.XF}), operation:${la}`),-1;if(Qa<this.Zw)return aa.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Kb},${hc}) - blockRevision:${Qa} < lastUpdatedStateId:${this.Zw}, operation:${la}`),-1;if(Qa<this.currentStateId)return aa.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Kb},${hc}) - blockRevision:${Qa} < currentStateId:${this.currentStateId}, operation:${la}`),
-1;M&&!this.DWd&&(this.Xs.setOnRecalcResults(M),this.DWd=!0);return this.YBk()&&!this.v1b(2)?(aa.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${la}`),-1):Qa}getFormulaBarText(r,M,la){return M&&M.startsWith("'")?M:r.cell.formulaBarText||la.toString()}mKh(r,M,la){let Qa=null;this.pab=this.pW(la);if(this.IVe()&&this.Di.ka(this.Zw).N9a){const Zc=this.Di.ka(this.Zw).N9a[r];if(null===Zc||void 0===Zc?0:Zc.wYb)Qa=Zc.WUe}la=this.dTi(Qa,M,la);const {Mjj:Kb,
numberOfNonEmptyCells:hc,Kjj:Ac}=this.eBh(Qa,M,la);aa.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${r} StateId:${this.currentStateId} number of formulas ${Kb}, number of non-empty cells ${hc}, number of cells ${Ac}`)}dTi(r,M,la){let Qa=!1;const Kb=mh.Wmf(M);if(r){const hc=mh.Wmf(r);ad.a.equals(hc,Kb,!1)&&(Qa=!0)}Qa?this.dbh(r,this.Zw,la):this.fbh(M,la);return Qa}IVe(){let r=!1;this.Xs&&-1!==this.Zw&&(r=this.Xs.stateIdAvailable(this.Zw));return r&&
this.Di.$d(this.Zw)&&this.Zw<this.currentStateId}eBh(r,M,la){let Qa=0,Kb=0,hc=0,Ac,Zc;for(M.reset();Ac=M.getNextCell();)hc++,(Ac.value||Ac.formula)&&Kb++,Sg.f(Ac.formula)&&Qa++,(Zc=la?r.getCell(Ac.row,Ac.col):null)?this.bBh(M,Ac,Zc):this.ebh(M,Ac);if(la)for(r.reset();Zc=r.getNextCell();)(Ac=M.getCell(Zc.row,Zc.col))||this.hLe(r,Zc);return{Mjj:Qa,numberOfNonEmptyCells:Kb,Kjj:hc}}cbk(){this.Xs.setOnUpdateRequest(()=>{})}bbk(){this.Xs.setOnUnresponsive((r,M,la,Qa)=>{this.xzj(r,M,la,Qa)})}xzj(r,M,la,
Qa){aa.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${r}, waitTime:${M}, timeoutCount:${la}, hasBeenClosed:${Qa}.`);Qa&&(this.M_j(),this.Wwa())}M_j(){this.Xg(null,null);this.COd=this.DWd=!1;this.z_d=0;this.r_d=this.t_d=this.u_d=this.s_d=-1}close(){this.Xs.close()}clearCache(){this.Xs.clearCache()}resumeRecalc(){this.Xs.resumeRecalc()}oak(){this.Xs.setA1ReferenceStyle(!0)}tOj(){if(this.instantaneousSupportInformationManager){var r=this.instantaneousSupportInformationManager.rQi;
const la=this.instantaneousSupportInformationManager.uQi,Qa=this.instantaneousSupportInformationManager.tQi,Kb=this.instantaneousSupportInformationManager.sQi;var M=!1;r!==this.s_d&&(M=!0,this.s_d=r);la!==this.u_d&&(M=!0,this.u_d=la);Qa!==this.t_d&&(M=!0,this.t_d=Qa);Kb!==this.r_d&&(M=!0,this.r_d=Kb);const hc=[];ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(M=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),hc.push(M),M=!0);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",
!1)&&(M=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),hc.push(M),M=!0);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(M=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),hc.push(M),M=!0);M&&(r=excelOnlineCalc.calc.recalcServiceConfig(null,r,null,la,null,null,null,Qa,hc,Kb),this.Xs.reconfigure(r))}}fdk(r){let M=null;if(this.Di.$d(this.currentStateId))try{this.vha=[],M=this.ug.Ve.Sf("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${uj[r]}`),
Yi.a.forEach(this.Di.ka(this.currentStateId).N9a,(la,Qa)=>{Qa.wYb||(this.mKh(la,Qa.WUe,Qa.sheetName),Qa.wYb=!0)},null),this.Xs.updateRanges(this.currentStateId,this.vha)}finally{M&&M.stop()}else aa.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}edk(){const r=[],M=this.IVe();var la=M&&this.Di.ka(this.Zw).Vn&&this.Di.ka(this.Zw).Vn[0]&&this.Di.ka(this.Zw).Vn[0].pCc?this.Di.ka(this.Zw).Vn[0].Lca:null;this.E_e(la,this.Di.ka(this.currentStateId).Vn[0].Lca,
null,this.Zw,r);this.Di.ka(this.currentStateId).Vn[0].pCc=!0;for(let Qa=1;Qa<this.Di.ka(this.currentStateId).Vn.length;Qa++)la=-1,M&&this.Di.ka(this.Zw).Vn&&(la=this.BAd(this.Di.ka(this.currentStateId).Vn[Qa].Wva.sheetName,this.Zw)),la=-1!==la&&this.Di.ka(this.Zw).Vn[la].pCc?this.Di.ka(this.Zw).Vn[la].Lca:null,this.E_e(la,this.Di.ka(this.currentStateId).Vn[Qa].Lca,this.Di.ka(this.currentStateId).Vn[Qa].Wva.sheetId,this.Zw,r),this.Di.ka(this.currentStateId).Vn[Qa].pCc=!0;this.Xs.updateNamedObjects(this.currentStateId,
r)}E_e(r,M,la,Qa,Kb){if(void 0!==la&&null!==la){var hc=excelOnlineCalc.calc.undefinedNamesWrite(la);Kb.push(hc)}if(r){var Ac=!1;hc=[];var Zc=[];if(M)for(const re of M){const Ge=re.value;if(r.$d(re.key)){var Ad=r.ka(re.key);mh.Vhj(Ad,Ge)?Ac=!0:(Ad=excelOnlineCalc.calc.namedObject(re.key,null),hc.push(Ad),mh.Jad(re.key,Ge,Zc))}else mh.Jad(re.key,Ge,Zc)}for(const re of r)M&&M.$d(re.key)||(r=excelOnlineCalc.calc.namedObject(re.key,null),hc.push(r));Ac&&(M=excelOnlineCalc.calc.namedObjectsPromote(la,Qa),
Kb.push(M));0<hc.length&&(M=excelOnlineCalc.calc.namedObjectsWrite(la,hc),Kb.push(M));0<Zc.length&&(la=excelOnlineCalc.calc.namedObjectsWrite(la,Zc),Kb.push(la))}else if(M){Qa=[];for(Zc of M)mh.Jad(Zc.key,Zc.value,Qa);0<Qa.length&&(la=excelOnlineCalc.calc.namedObjectsWrite(la,Qa),Kb.push(la))}}Ynh(){const r=this.Di.ka(this.currentStateId).N9a[this.CBa];return r?(aa.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.CBa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Zw}. sentToRecalcEngine: ${null===
r||void 0===r?void 0:r.wYb}`),!0):!1}Qnh(r){return 1===r.getColumnNumbers().length&&r.getColumnNumbers()[0]===mh.lRd+1?!1:!0}$Ni(){let r=!1;Yb.h(this.ug).ya.ycb(M=>{M.state&1&&this.ug.ea.uh===M.Ah.Revision&&(this.o4e(M),r=!0)});return r}b2e(r,M){var la=r.getRowNumbers(),Qa=r.getColumnNumbers();r=la[0]-1;la=la[la.length-1]-1;const Kb=Qa[0]-1;Qa=Qa[Qa.length-1]-1;M=this.pW(M);if(!M){const hc=this.Di.$d(this.currentStateId)&&this.Di.ka(this.currentStateId).Vn?this.Di.ka(this.currentStateId).Vn.length:
0;aa.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${hc}`)}return mh.naa("CreateBlockRangeLocation",M,r,Kb,la,Qa)}dbh(r,M,la){if(la=this.b2e(r,la)){var Qa=mh.Eic(r.getRowNumbers());r=mh.Eic(r.getColumnNumbers());M=excelOnlineCalc.calc.rangePromote(la,M,Qa,r);this.vha[this.vha.length]=M}}fbh(r,M){if(M=this.b2e(r,M)){var la=mh.Eic(r.getRowNumbers());r=mh.Eic(r.getColumnNumbers());r=excelOnlineCalc.calc.rangeWrite(M,null,la,
r);this.vha[this.vha.length]=r}}bBh(r,M,la){let Qa=null,Kb=0,hc=0;switch(M.valueType){case 2:Qa=this.sBd(M);var Ac=this.sBd(la);Ac=ad.a.equals(Ac,Qa,!1);break;case 1:null===M.value&&null===la.value?Ac=!0:(Kb=parseFloat(M.value),Ac=parseFloat(la.value)===Kb);break;default:null===M.value&&null===la.value?Ac=!0:(hc=parseFloat(M.value),Ac=hc===parseFloat(la.value))}Ac&&M.valueType===la.valueType&&M.ifmt===la.ifmt&&M.formulaType===la.formulaType&&ad.a.equals(la.formula,M.formula,!1)||(void 0!==M.formula&&
null!==M.formula||void 0!==M.value&&null!==M.value||void 0!==M.text&&null!==M.text||0!==M.valueType?this.Rbc(r,M,Qa,Kb,hc):this.hLe(r,M))}zah(r){if(this.ug.nf&&this.ug.nf.items)for(let hc=0;hc<this.ug.nf.count;hc++){var M=this.ug.nf.items[hc];if(2!==M.type&&3!==M.type)continue;var la=0,Qa=M.name,Kb=Qa.lastIndexOf("!");if(0<Kb){la=Qa.substr(0,Kb);"'"===la.charAt(0)&&(la=la.substr(1,la.length-2));la=this.BAd(la,this.currentStateId);if(-1===la){Qa=this.Di.$d(this.currentStateId)&&this.Di.ka(this.currentStateId).Vn?
this.Di.ka(this.currentStateId).Vn.length:0;aa.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Qa}`);continue}Qa=Qa.substr(Kb+1)}Kb=this.Di.ka(this.currentStateId).Vn[la].Lca;let Ac=M.usedRange;2===M.type&&(Ac=Dj.a(M));if(Kb.$d(Qa)){if(la=Kb.ka(Qa),la.range=Ac,la.attributes=M.attributes,2===la.type)if(Qa=M.t8,!la.GJ)la.GJ=new tj(Qa);else if(Qa)for(const Zc of Qa.HeadersList)la.GJ.dha.da(Zc.Index,Zc.Name)}else if(la=this.pW(M.sheetName)){la=
new hk(M.type,M.name,Ac,la,M.attributes);if(2===la.type)if(M.t8)la.GJ=new tj(M.t8);else if(M=mh.q$h(M.name,r))la.GJ=new tj(M.ColHeadersList);Kb.da(Qa,la)}else Qa=this.Di.$d(this.currentStateId)&&this.Di.ka(this.currentStateId).Vn?this.Di.ka(this.currentStateId).Vn.length:0,aa.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Qa}`)}}Rbc(r,M,la,Qa,Kb){var hc=r.getRowNumbers()[M.row]-1;r=r.getColumnNumbers()[M.col]-1;hc=mh.naa("AddRangeUpdateCommand",
this.pab,hc,r,hc,r);r=null;let Ac=M.formula||M.text;const Zc=excelOnlineCalc.calc.blankValue;let Ad=null;void 0!==M.text&&null!==M.text||void 0!==M.value&&null!==M.value||(la="",Ad="This cell contains blanks only",0===M.formulaType&&(Ac=""));switch(M.valueType){case 2:null!==la&&(0===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData(Ac,la,M.ifmt,Ad)),1===M.formulaType&&(r=excelOnlineCalc.calc.cellFormulaCellData(Ac,la,M.ifmt,Ad)),2===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData("",Zc,0,
"This cell is a part of an array")));break;case 1:isNaN(Qa)?aa.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${M.row},${M.col}) invalid numeric value`):(0===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData(Ac,Qa,M.ifmt,null)),1===M.formulaType&&(r=excelOnlineCalc.calc.cellFormulaCellData(Ac,Qa,M.ifmt,null)),2===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData("",Zc,0,"This cell is a part of an array")));break;case 3:isNaN(Kb)?aa.ULS.sendTraceTag(537170115,0,
15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${M.row},${M.col}) invalid boolean value`):(la=1===Kb?!0:!1,0===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData(Ac,la,M.ifmt,null)),1===M.formulaType&&(r=excelOnlineCalc.calc.cellFormulaCellData(Ac,la,M.ifmt,null)),2===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData("",Zc,0,"This cell is a part of an array")));break;case 4:isNaN(Kb)?aa.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${M.row},${M.col}) invalid error value`):
(la=excelOnlineCalc.calc.errorValue(Kb),0===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData(Ac,la,M.ifmt,null)),1===M.formulaType&&(r=excelOnlineCalc.calc.cellFormulaCellData(Ac,la,M.ifmt,null)),2===M.formulaType&&(r=excelOnlineCalc.calc.valueCellData("",Zc,0,"This cell is a part of an array")));break;default:r=excelOnlineCalc.calc.valueCellData("",Zc,M.ifmt,null)}r&&(M=excelOnlineCalc.calc.rangeWrite(hc,r,null,null),this.vha[this.vha.length]=M)}ebh(r,M){switch(M.valueType){case 2:this.Rbc(r,
M,this.sBd(M),null,0);break;case 1:this.Rbc(r,M,null,parseFloat(M.value),0);break;default:this.Rbc(r,M,null,null,parseFloat(M.value))}}hLe(r,M){var la=r.getRowNumbers()[M.row]-1;r=r.getColumnNumbers()[M.col]-1;la=mh.naa("AddRangeUpdateCommandEmptyCell",this.pab,la,r,la,r);M=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,M.ifmt,null);M=excelOnlineCalc.calc.rangeWrite(la,M,null,null);this.vha[this.vha.length]=M}pW(r){r=this.BAd(r,this.currentStateId);return 0<r?this.Di.ka(this.currentStateId).Vn[r].Wva.sheetId:
null}BAd(r,M){if(!this.Di.$d(M))return aa.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${M} does not exist in GridCache`),-1;const la=this.Di.ka(M);return la.Vn?la.getSheetIndex(r):(aa.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${M}`),-1)}Bck(){if(!this.Di.$d(this.currentStateId)||!this.Di.ka(this.currentStateId).Vn.length)return aa.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),
!1;const r=[];for(let M=1;M<this.Di.ka(this.currentStateId).Vn.length;M++){const la=this.Di.ka(this.currentStateId).Vn[M];la&&r.push(la.Wva)}this.Xs.updateSheetNames(this.currentStateId,r);this.Xs.updateUnusedCells(this.currentStateId,this.Di.ka(this.currentStateId).Iie);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var r=[];for(const M of this.instantaneousSupportInformationManager.LGa){const la=excelOnlineCalc.calc.numberFormat(M.IfmtIndex,M.FormatString,M.Builtin);
r.push(la)}this.Xs.setNumberFormats(r,!0)}}D9j(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.gi){var r=this.dOi();if(!this.COd||r)this.instantaneousSupportInformationManager.gi.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.gi.TrueValueString),this.instantaneousSupportInformationManager.gi.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.gi.FalseValueString),r=Ej.CalcHelper.c3e(this.instantaneousSupportInformationManager,
r),this.Xs.setLocale(r),this.COd=!0}}udk(){var r=null;if(void 0!==this.ug.workbookContext.TimeZoneInformation&&null!==this.ug.workbookContext.TimeZoneInformation){r=null;this.ug.workbookContext.TimeZoneInformation.StandardDate.Month&&(r=excelOnlineCalc.date.dateTime(this.ug.workbookContext.TimeZoneInformation.StandardDate.Year,this.ug.workbookContext.TimeZoneInformation.StandardDate.Month,this.ug.workbookContext.TimeZoneInformation.StandardDate.Day,this.ug.workbookContext.TimeZoneInformation.StandardDate.Hour,
this.ug.workbookContext.TimeZoneInformation.StandardDate.Minute,this.ug.workbookContext.TimeZoneInformation.StandardDate.Second,this.ug.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.ug.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let M=null;this.ug.workbookContext.TimeZoneInformation.DaylightDate.Month&&(M=excelOnlineCalc.date.dateTime(this.ug.workbookContext.TimeZoneInformation.DaylightDate.Year,this.ug.workbookContext.TimeZoneInformation.DaylightDate.Month,
this.ug.workbookContext.TimeZoneInformation.DaylightDate.Day,this.ug.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.ug.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.ug.workbookContext.TimeZoneInformation.DaylightDate.Second,this.ug.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.ug.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));r=excelOnlineCalc.date.tzData(this.ug.workbookContext.TimeZoneInformation.Bias,r,this.ug.workbookContext.TimeZoneInformation.StandardBias,
M,this.ug.workbookContext.TimeZoneInformation.DaylightBias)}else aa.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");r=excelOnlineCalc.calc.workbookProps(this.ug.workbookContext.F1904,this.ug.workbookContext.FDateCompatibility,r);this.Xs.setWorkbookProps(r)}Wwa(){const r=ya.EwaSettings.Ia(570)?dj.local:dj.iuk,[M,la]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.H1d=td.d(excelOnlineCalc.calc.createRecalcService(r,
M,la));this.H1d.continueWith(Qa=>{Qa.exception?aa.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Qa.exception.toString()}`):(aa.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.Xs=this.H1d.result)?this.v1b(0)?this.bbk():aa.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):aa.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}dOi(){const r=
this.instantaneousSupportInformationManager.Zqa;if(!r||this.z_d===r.length)return null;this.z_d=r.length;return Ej.CalcHelper.L2e(r)}fOi(){if(!(this.Di.$d(this.currentStateId)&&0<this.Di.ka(this.currentStateId).Vn.length)){this.Di.da(this.currentStateId,new Rj);this.Di.ka(this.currentStateId).Tvg(0,new Tj(null));var r=this.ug.sa;for(let Qa=0;Qa<r.count;Qa++){var M=Object(Zb.a)(Pj.a,r.getItem(Qa));if(M){void 0!==M.sheetId&&null!==M.sheetId&&void 0!==M.name&&null!==M.name&&M.sheetId.length&&M.sheetName.length||
aa.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Qa} Id:${M.sheetId} Hash:${M.hash} NameLength:${M.name?M.name.length:-1}`);var la=excelOnlineCalc.calc.sheetName(M.sheetId,M.name);this.Di.ka(this.currentStateId).Tvg(Qa+1,new Tj(la));la=M.usedRange.WE();la=excelOnlineCalc.calc.rangeLocation(0,0,la.LastRow,la.LastColumn);M=excelOnlineCalc.calc.unusedCellsUpdate(M.sheetId,la);this.Di.ka(this.currentStateId).Iie.push(M)}else aa.ULS.sendTraceTag(537170073,
0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Qa}`)}}}IGk(r){if(r instanceof Pj.a){var M=r.usedRange.WE();M=excelOnlineCalc.calc.rangeLocation(0,0,M.LastRow,M.LastColumn);M=excelOnlineCalc.calc.unusedCellsUpdate(r.sheetId,M);this.Di.ka(this.currentStateId).Iie[r.index]=M}}Exh(){for(const r of this.Di)r.key<this.Zw&&this.Di.remove(r.key)}sBd(r){r=r.value||r.text;if(void 0===r||null===r)r="";return r}YBk(){if(!this.Di.$d(this.currentStateId))return!1;
let r=!1;Yi.a.forEach(this.Di.ka(this.currentStateId).N9a,(M,la)=>{la.wYb||(r=!0)},null);return r}Fld(r){const M={};M.reason=r;M.kind=1;return M}ixc(){return this.Di.$d(this.currentStateId)&&this.Di.ka(this.currentStateId).Vn&&this.Di.ka(this.currentStateId).Vn[0]&&this.Di.ka(this.currentStateId).Vn[0].Lca?!0:!1}static lGh(r){const M=[];if(null===r||void 0===r?0:r.dha)for(const la of r.dha)r=excelOnlineCalc.calc.columnData(la.key,la.value),M.push(r);return M}static Vhj(r,M){if(r.type!==M.type||r.attributes!==
M.attributes||!ad.a.equals(r.fullName,M.fullName,!1)||!r.range.equals(M.range))return!1;if(!r.GJ&&!M.GJ)return!0;if(!r.GJ||!M.GJ||r.GJ.dha.count!==M.GJ.dha.count)return!1;for(const la of r.GJ.dha){let Qa;if(r=la.value)r=M.GJ.dha.Ag(la.key),{value:Qa}=r,r=r.returnValue;if(!(r&&Qa&&ad.a.equals(la.value,Qa,!1)))return!1}return!0}static Jad(r,M,la){var Qa=mh.naa("NamedObject",M.sheetId,M.range.top-1,M.range.left-1,M.range.bottom-1,M.range.right-1);if(2===M.type){const Kb=!!(M.attributes&16),hc=!!(M.attributes&
8);M=mh.lGh(M.GJ);Qa=excelOnlineCalc.calc.namedTableData(Qa,Kb,hc,M);r=excelOnlineCalc.calc.namedObject(r,Qa)}else Qa=excelOnlineCalc.calc.namedRangeData(Qa),r=excelOnlineCalc.calc.namedObject(r,Qa);la.push(r)}static Wmf(r){const M=Sys.Serialization.JavaScriptSerializer.serialize(r.getRowNumbers());r=Sys.Serialization.JavaScriptSerializer.serialize(r.getColumnNumbers());return M+r}static Eic(r){let M=null;if(1<r.length)for(let la=1;la<r.length;la++){let Qa=0;for(;r[la-1]+1+Qa<r[la];)M=M||[],M.push(r[la-
1]+Qa),Qa++}return M}static q$h(r,M){if(!M)return null;for(let la=0,Qa=M.length;la<Qa;++la)if(ad.a.equals(r,M[la].Name,!1))return M[la];return null}static naa(r,M,la,Qa,Kb,hc){const Ac=(Zc,Ad,re,Ge)=>{(0>re||re>=Ge)&&aa.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${Zc} invalid ${Ad}:${re}`)};void 0!==M&&null!==M||aa.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${r} sheetId is null`);Ac(r,"top",la,mh.qUf);Ac(r,"left",
Qa,mh.lRd);Ac(r,"bottom",Kb,mh.qUf);Ac(r,"right",hc,mh.lRd);return excelOnlineCalc.calc.sheetRangeLocation(M,la,Qa,Kb,hc)}}mh.qUf=1048576;mh.lRd=16384;Object(da.a)(mh,"CalcAsyncEngine",null,[2]);const ik=(r,M,la)=>{switch(r.type){case 2:return excelOnlineCalc.calc.valueCellData(M,r.value,la,null);case 1:return excelOnlineCalc.calc.valueCellData(M,parseFloat(r.value),la,null);case 3:return excelOnlineCalc.calc.valueCellData(M,1===parseFloat(r.value),la,null);case 4:return excelOnlineCalc.calc.valueCellData(M,
excelOnlineCalc.calc.errorValue(parseFloat(r.value)),la,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,la,null)}};class jk{constructor(){this.NS=this.PS=this.XM=this.YM=this.ica=!1}}Object(da.a)(jk,"AbsoluteRelativeReferenceInfo",null,[]);class vj{}vj.xbg="#";Object(da.a)(vj,"Operators",null,[]);var ej=a(1186);class Hi{}Hi.sheet="Sheet";Hi.sheetRange="SheetRange";Hi.document="Document";Hi.oKi="Ident";Object(da.a)(Hi,"TraverseFormulaQualifierTypes",null,
[]);var wj=a(1014),Ri=a(905),qk=a(78),dh=a(303);class kk extends Sys.EventArgs{constructor(r){super();this.Um=r}}Object(da.a)(kk,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var rk=a(285),tg=a(1013);class $i{constructor(r,M,la){this.Jx=la;this.IVa=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FinalizeToPrefetch",!1);this.U0f=(Qa,Kb)=>{Qa=this.gridView.ha.pa.activeCell;const hc=this.gridView.Pe(Qa);null!=hc&&this.QGj(Qa,Kb.text,hc.cell.Ok,hc.cell.$z.Aec,this.gridView.$.activeItemName)};
this.pHa=()=>{this.IVa?this.S0=Object(dh.a)({message:"PrefetchNotStarted"}):this.XFa=Object(dh.a)({message:"PrefetchNotStarted"})};this.Zg=r;this.gridView=M;this.S0=Object(dh.a)({message:"Ctor"});this.XFa=Object(dh.a)({message:"Ctor"});r=ya.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.QGj=rk.a((Qa,Kb,hc,Ac,Zc)=>this.prefetch({text:Kb,range:Qa,ifmt:hc,stateId:Ac,sheetName:Zc}),r);this.gridView.kf.jr(this.pHa);this.gridView.lm.sMe(this.U0f)}dispose(){this.gridView.lm.xkg(this.U0f);
this.gridView.kf.$q(this.pHa);this.wYe()}fnf(r){if(Object(dh.b)(this.XFa))return Object(dh.a)(this.XFa.reason.message);if($i.SQe(r,this.XFa.value.key)){for(const M of this.XFa.value.results.results)if(Object(dh.c)(M)&&$i.o0i(r,M))return M;return Object(dh.a)("RangeNotFoundInPrefetchResult")}return Object(dh.a)("ResultUnavailable")}enf(r,M){return Object(dh.b)(this.S0)?Object(dh.a)(this.S0.reason.message):$i.SQe(r,this.S0.value.key)?Object(dh.c)(this.S0)?M?Object(dh.d)({key:this.S0.value.key,jtd:void 0,
tqa:this.S0.value.tqa}):this.S0:Object(dh.a)("RangeNotFoundInPrefetchResult"):Object(dh.a)("ResultUnavailable")}wYe(){this.IVa?this.S0=Object(dh.a)({message:"PrefetchResultCleared"}):this.XFa=Object(dh.a)({message:"PrefetchResultCleared"})}prefetch(r){this.IVa?this.S0=Object(dh.a)({message:"EvalInProgress",key:r}):this.XFa=Object(dh.a)({message:"EvalInProgress",key:r});this.Zg.h5([],r.range,r.range,r.text,!0).then(M=>{if(this.IVa){var la=this.gridView.Pe(r.range);M=M.results[0];if("Success"===M.kind&&
la&&this.Jx&&!Object(tg.b)(M.value)){const Qa=this.Jx.Bpc(M.value);la=this.Zg.$J(M.value.formatted,Qa,la.cell.oea,la.cell.d_,r.ifmt,!1);this.S0="Success"===la.kind?Object(dh.d)({key:r,jtd:la.value,tqa:M.value}):Object(dh.a)({message:"FinalizeNumberFormattedValueFailed"})}else this.S0=Object(dh.a)({message:"EvalOnCloneFailed"})}else this.XFa=Object(dh.d)({key:r,results:M})}).catch(M=>{this.S0=Object(dh.a)({message:"EvalFormulaRangeOnClonedModelFailed"});aa.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${M}`)})}static SQe(r,
M){return r.text===M.text&&r.range.toString()===M.range.toString()&&r.ifmt===M.ifmt&&r.stateId===M.stateId&&r.sheetName===M.sheetName}static o0i(r,M){return r.range.top-1===M.value.cell.row&&r.range.left-1===M.value.cell.col}}Object(da.a)($i,"SetCellEstimationPrefetcher",null,[319,2]);var ui;let H=ui=class extends qd.a{constructor(r,M,la){super();this.Jx=la;this.Yu=null;this.xle=!1;this.E6d=this.instantaneousSupportInformationManager=this.ndc=this.vua=null;this.RTd=new Map;this.WAe=null;this.hEc=
Qa=>{aa.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");Qa.jJc(this.hEc);Qa.Zqa.length?this.LDc(Qa,Sys.EventArgs.Empty):(aa.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),Qa.xMe(this.LDc))};this.LDc=Qa=>{aa.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");Qa.T3d(this.LDc);this.Czk(Qa)};this.onContentReady=()=>{this.Yu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Nuc||
Fa.Task.delay(0).continueWith(()=>{this.Yu.v1b(1)?this.raiseEvent(ui.Eid):aa.ULS.sendTraceTag(508368722,0,15,"CalcManager.onContentReady: calc engine failed to update in the calc model")},0,null,qk.a.current))};this.yZf=(Qa,Kb)=>{this.Yu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Nuc||this.Yu.o4e(Kb.wg.block))};aa.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Avc=!1;this.Ie=r;this.zx=Yb.h(r);this.rXc=null;this.gridView.Dw(this.onContentReady);
this.gridView.ya.T7a(this.yZf);this.$.ja.Ne(268,Qa=>{Qa.gi?(aa.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.hEc(Qa,Sys.EventArgs.Empty)):(aa.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),Qa.Gbd(this.hEc))});if(this.kca=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8373394_setCellEstimationPrefetch"))this.uFe=new $i(this,this.zx,la)}lbd(r){this.addHandler(ui.P9e,r)}oXf(r){this.raiseEvent(ui.P9e,new kk(r))}vch(r){this.addHandler(ui.M$c,
r)}STj(r){this.removeHandler(ui.M$c,r)}GCc(r){this.raiseEvent(ui.M$c,r)}ecc(r){this.addHandler(ui.Eid,r)}I3d(r){this.removeHandler(ui.Eid,r)}get bob(){return this.uFe}get MZ(){return this.rXc}get gridView(){return this.zx}get $(){return this.Ie}get iD(){return this.WAe}get localeInfo(){return this.MZ?this.MZ.config.localeInfo:null}get config(){var r;return null===(r=this.MZ)||void 0===r?void 0:r.config}dispose(){aa.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.ja.Ne(268,r=>
{r.jJc(this.hEc);r.T3d(this.LDc)});this.gridView&&(this.gridView.qz(this.onContentReady),this.gridView.ya&&this.gridView.ya.oWb(this.yZf),this.zx=null);this.rXc=null;this.Avc=!1;this.kca&&(Ic.a.Sa(this.bob),this.uFe=null)}hth(r,M,la,Qa){this.Yu&&this.Yu.eth(r,M,la,void 0===Qa?null:Qa)}ith(r,M){return this.Yu?this.Yu.fth(r,M):!1}evalFormula(r,M,la,Qa){return this.Yu?this.Yu.evalFormula(r,M,la,Qa):Promise.reject("calc engine not initialized")}h5(r,M,la,Qa,Kb){return this.Yu?this.Yu.h5(r,M,la,Qa,Kb):
Promise.reject("CalcEngine is null")}localizeEnglishFormula(r,M,la){return this.Yu?this.Yu.localizeEnglishFormula(r,M,la):Promise.resolve(void 0)}jUa(r){if(!r)return aa.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.Yu)return null;aa.ULS.shipAssertTag(537170059,0,2===r.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.Yu.jUa(r)}rOe(r,M){if(!M||2!==r.type)return!1;r=Dj.a(r);return r.right-r.left+1===M.count}Lsd(r,M){if(!this.vua)return this.xle||
aa.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var la=this.eic(Mf.Range.Pf(1,1));la=this.vua.parseFormula(excelOnlineCalc.parse.parseLocals(1,la.range),r);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(la))return aa.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{const Qa=null!==M&&void 0!==M?M:this.gridView.ha.pa.activeCell,Kb=excelOnlineCalc.location.gridCell(Qa.top-1,Qa.left-
1),hc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Ac=excelOnlineCalc.location.sheetIndex(hc,this.$.sa.na.sheetId),Zc=this.HKh(Kb,Ac);this.E6d||(this.E6d=excelOnlineCalc.util.createResolver(this.GKh()));const Ad=excelOnlineCalc.parse.parseResultHelper.extractReferences(la,this.MZ.config.localeInfo,!1,Zc,this.E6d);ya.EwaSettings.Ia(101)&&this.AFk(Ad,r);return Ad}catch(Qa){return aa.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Qa.message}`),
null}}QLd(r){if(!this.vua||!this.ndc)return this.xle||aa.ULS.sendTraceTag(507912481,0,15,this.vua||this.ndc?this.vua?"CalcManager.isValidReference - analyzer not initialized":"CalcManager.isValidReference - parser not initialized":"CalcManager.isValidReference - parser and analyzer not initialized"),null;var M=this.eic(Mf.Range.Pf(1,1));r=this.vua.parseFormula(excelOnlineCalc.parse.parseLocals(1,M.range),r);if(!excelOnlineCalc.util.isSuccess(r))return r.reason.kind===excelOnlineCalc.parse.ReasonKind.NotFormulaString?
"notFormulaString":"internalError";M=this.ndc.checkFormula(excelOnlineCalc.analyze.analyzeLocalsName(M),r.value);return excelOnlineCalc.util.isSuccess(M)?M.value.bRk?"valid":"illFormed":"internalError"}extractLetVariables(r,M){if(!this.vua)return this.xle||aa.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const la=this.eic(Mf.Range.Pf(1,1));r=this.vua.parseFormula(excelOnlineCalc.parse.parseLocals(1,la.range),r);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(r))return aa.ULS.sendTraceTag(537170053,
0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(r,M,this.MZ.config.localeInfo)}catch(Qa){return aa.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Qa.message}`),null}}extractReferences(r,M,la,Qa,Kb){if(!M)return aa.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!la)return aa.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;const hc=this.Lsd(r,Kb);if(!hc)return aa.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.DJh(hc,M,la,r,Qa,Kb)}catch(Ac){return aa.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${Ac.message}`),null}}eic(r,M){M=void 0===M?!0:M;return r&&this.MZ?this.MZ.cLh(this.MZ.OMh(),r.top-1,r.left-1,M):null}xwc(r,M){r=this.hia(r);if(!Object(dh.c)(r))return null;M=this.iD.parseEdit(M,r.value);return excelOnlineCalc.util.isSuccess(M)?
M.value.kind===Oj.a.formula:null}sLd(r){r=this.hia(r);return Object(dh.c)(r)?"Text"===r.value.valueType:null}xFf(r){r=this.hia(r);return Object(dh.c)(r)?"Date"===r.value.valueType&&!r.value.hasTime:null}hia(r){if(null==this.iD)return Object(dh.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(dh.a)("Instantaneous manager is null");if(this.RTd.has(r))return Object(dh.d)(this.RTd.get(r));if("number"===typeof r){var M=this.Qrf(r);if(null==M)return Object(dh.a)(`Invalid ifmt=${r}`);
var la=M.FormatString;M=M.Builtin}else la=r,M=!1;la=this.iD.createFormat(la,M);return excelOnlineCalc.util.isSuccess(la)?(this.RTd.set(r,la.value),Object(dh.d)(la.value)):Object(dh.a)("Could not create number format")}getWorksheetFuncId(r){return this.localeInfo.getWorksheetFuncId(r)}DJh(r,M,la,Qa,Kb,hc){const Ac={Items:[]};for(let re=0;re<r.length;re++){var Zc=r[re];const Ge={};Ge.Start=Zc.span.start;Ge.End=Zc.span.end;if(Kb||Zc.kind!==ej.a.func)if(Kb||Zc.kind!==ej.a.x7i){if(!this.VTh(Zc,M,la))continue;
var Ad=new jk;const kf=this.fvi(Zc,M,Ad,Qa,hc);if(kf){const sf={};sf.Span=Ge;sf.Range=kf;sf.IsRangeRef=Ad.ica;sf.IsAbsoluteFirstRow=Ad.YM;sf.IsAbsoluteFirstColumn=Ad.XM;sf.IsAbsoluteSecondRow=Ad.PS;sf.IsAbsoluteSecondColumn=Ad.NS;sf.IsStructRef=Zc.kind===ej.a.kDg;Ac.Items.push(sf)}}else Zc=Zc.ref.value.oper.kind,Ad={},Ad.Span=Ge,Ad.IsString=2===Zc,Ad.IsBoolean=4===Zc,Ad.IsNumber=1===Zc,Ac.Items.push(Ad);else Ge.End=Zc.span.start+Zc.ref.name.length,Zc={},Zc.Span=Ge,Zc.IsFunction=!0,Zc.FunctionId=this.getWorksheetFuncId(Qa.substring(Ge.Start,
Ge.End)),Ac.Items.push(Zc)}Ac.Items.sort((re,Ge)=>re.Span.Start-Ge.Span.Start);return Ac}fvi(r,M,la,Qa,Kb){if(r.kind===ej.a.range)return la.ica=!0,this.U0e(r,M,la,Qa);if(r.kind===ej.a.namedRange){la=r.ref;(r=this.$.nf.getItemByName(la.name))||(r=this.$.nf.getItemByName(M+"!"+la.name));if(!(r&&r.sheetName&&r.usedRange&&ad.a.equals(r.sheetName,M,!0)))return null;M=2===r.type?Dj.a(r):r.usedRange;return jd.m(M,r)}if(r.kind===ej.a.kDg){const hc=r.ref;hc.name?(Kb=this.$.nf.getItemByName(hc.name))||(Kb=
this.$.nf.getItemByName(M+"!"+hc.name)):Kb=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&Kb?this.gridView.Je.gj(Kb):this.gridView.Je.gj(this.gridView.ha.pa.activeCell);if(!(Kb&&Kb.sheetName&&Kb.usedRange&&ad.a.equals(Kb.sheetName,M,!0)))return null;la.ica=!1;return this.U0e(r,M,la,Qa)}return null}U0e(r,M,la,Qa){r=r.ref;if(r.type){if(r.type===wj.a.column){var Kb=r.startIndex;r=r.endIndex;la.XM=Kb.kind===Ri.a.abs;la.NS=r.kind===Ri.a.abs;return this.createRange(0,
Kb.index,Wf.a.oi,r.index,M)}if(r.type===wj.a.row)return Kb=r.endIndex,la.YM=r.startIndex.kind===Ri.a.abs,la.PS=Kb.kind===Ri.a.abs,this.createRange(r.startIndex.index,0,r.endIndex.index,Wf.a.hi,M);if(r.type===wj.a.cell){Kb=r.row;var hc=r.col;la.YM=la.PS=Kb.kind===Ri.a.abs;la.XM=la.NS=hc.kind===Ri.a.abs;return this.vQa(r.span.end,Qa)&&(la=Mf.Range.Pf(Kb.index+1,hc.index+1),la=this.gridView.Je.tuf(la))?jd.n(la,M):this.createRange(Kb.index,hc.index,Kb.index,hc.index,M)}if(r.type===wj.a.range){Kb=r.top;
hc=r.left;Qa=r.bottom;r=r.right;const Ac=Math.min(Kb.index,Qa.index),Zc=Math.min(hc.index,r.index),Ad=Math.max(Kb.index,Qa.index),re=Math.max(hc.index,r.index);la.YM=Kb.kind===Ri.a.abs;la.PS=Qa.kind===Ri.a.abs;la.XM=hc.kind===Ri.a.abs;la.NS=r.kind===Ri.a.abs;return this.createRange(Ac,Zc,Ad,re,M)}aa.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${r.type}'`);return null}aa.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");
return null}vQa(r,M){return M.length>=r&&0<r&&M.charAt(r-1)===vj.xbg}Xsh(r,M,la){this.Yu&&this.Yu.gth(r,M,la)}Qrf(r){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.LGa&&this.instantaneousSupportInformationManager.LGa[r]&&this.iD?this.instantaneousSupportInformationManager.LGa[r]:null}hFi(r){var M;"number"!==typeof r&&"string"!==typeof r?this.GCc(null):(r=this.hia(r),Object(dh.c)(r)?(r=r.value,Object(Oa.c)(r)||Object(Oa.c)(r.formatString)?this.GCc(null):
this.GCc({formatString:r.formatString,builtIn:null!==(M=r.isBuiltIn)&&void 0!==M?M:!1})):this.GCc(null))}toXLNumber(r){if(!this.iD)return null;r=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.iD,r);return excelOnlineCalc.util.isSuccess(r)?r.value:null}$J(r,M,la,Qa,Kb,hc,Ac){if(!r)return Object(dh.a)("Null");var Zc=excelOnlineCalc.numfmt.renderCallback(la,sf=>gridRenderer.CanvasRendererGlobals.measureTextWidth(sf,Qa,!0,ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",
!1)),hc),Ad=this.iD.renderValue(r,Zc);if(!excelOnlineCalc.util.isSuccess(Ad))return Object(dh.a)("Finalize");let re=null;const Ge=excelOnlineCalc.numfmt.isHashesValue(Ad.value);if(Ge){if(Ad=this.iD.renderHashesValue(Ad.value,Zc),!excelOnlineCalc.util.isSuccess(Ad))return Object(dh.a)("Hashes")}else re=this.Jx.Hud(r,Ad.value);var kf=Ad.value;Zc=excelOnlineCalc.numfmt.renderedValueToString(kf);Ad=this.Jx.bqf(kf);kf=this.Jx.mpf(kf);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.passiveTestToMeasureTextWithOffScreenCanvas",
!1)&&(r=this.bkj(this.iD,r,la,Qa,hc),Object(dh.c)(r)&&(r=excelOnlineCalc.numfmt.renderedValueToString(r.value),r!==Zc&&aa.ULS.sendTraceTag(508343314,0,50,"CalcResultProcessor.finalizeNumberFormattedValue: offScreenNumberFormattedText != numberFormattedText"+`offScreenNumberFormattedText: ${ad.a.g4(r)}, numberFormattedText: ${ad.a.g4(Zc)}`)));return Object(dh.d)({text:Zc,valueType:M,fontColor:kf,format:Kb,horizontalAlignment:Ad,numFmt:re,isHashesValue:Ge,cellValue:Ac})}bkj(r,M,la,Qa,Kb){la=excelOnlineCalc.numfmt.renderCallback(la,
hc=>gridRenderer.CanvasRendererGlobals.measureTextWidthOffscreen(hc,Qa,!0,ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),Kb);M=r.renderValue(M,la);return excelOnlineCalc.util.isSuccess(M)?excelOnlineCalc.numfmt.isHashesValue(M.value)&&(M=r.renderHashesValue(M.value,la),!excelOnlineCalc.util.isSuccess(M))?(aa.ULS.sendTraceTag(508343302,0,50,"CalcResultProcessor.offScreenCanvasFinalize: finalizedValueResultOffScreen hash is not a success"),Object(dh.a)("HashesOffScreen")):
Object(dh.d)(M.value):(aa.ULS.sendTraceTag(508343303,0,50,"CalcResultProcessor.offScreenCanvasFinalize: finalizedValueResultOffScreen is not a success"),Object(dh.a)("FinalizeOffScreen"))}AFk(r,M){if(r)for(const la of r)la.ref.type&&la.ref.type===wj.a.cell&&(r=la.ref,ui.EGj(r,M)&&(r.span.end+=1,la.span.end+=1))}createRange(r,M,la,Qa,Kb){const hc={};hc.FirstRow=r;hc.FirstColumn=M;hc.LastRow=la;hc.LastColumn=Qa;hc.SheetName=Kb;return hc}VTh(r,M,la){var Qa=r.ref.qualifier;if(!Qa)return!0;switch(r.ref.qualifier.type){case Hi.sheet:return r=
Qa.document,ad.a.equals(Qa.sheet,M,!0)&&(!r||ad.a.equals(r.document,la,!0));case Hi.sheetRange:return M=this.$.sa.getItemByName(M),la=this.$.sa.getItemByName(Qa.sheet1),Qa=this.$.sa.getItemByName(Qa.sheet2),!!M&&!!la&&!!Qa&&(la.index<=M.index&&M.index<=Qa.index||Qa.index<=M.index&&M.index<=la.index);case Hi.document:return ad.a.equals(Qa.document,la,!0);case Hi.oKi:return Qa=Qa.name,ad.a.equals(Qa,M,!0)||ad.a.equals(Qa,la,!0);default:return aa.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Qa.type}'`),
!1}}Czk(r){this.instantaneousSupportInformationManager=r;r.LGa.length&&r.Zqa.length?(this.rXc=new Ej.CalcHelper(this.gridView.$),this.vua=this.MZ.createParser(),this.ndc=this.MZ.createAnalyzer(),this.WAe=this.MZ.createNumberFormatter(),this.Avc=!0,aa.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.Yu||(aa.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.Yu=new mh(this.$))):aa.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${r.LGa.length}, functions info count = ${r.Zqa.length}`)}HKh(r,
M){const la={allowUnqualifiedCell:!0,wrapCellReferences:!0};la.config=this.MZ.config;la.originGridCell=excelOnlineCalc.util.success(r);la.originSheet=excelOnlineCalc.util.success(M);return la}GKh(){const r={};r.config=this.MZ.config;r.getNameLoc=this.Yu.getNameLoc;r.getContainingTable=this.Yu.getContainingTable;r.getStructRefColumn=this.Yu.getStructRefColumn;r.getStructRefSpecialRef=this.Yu.getStructRefSpecialRef;r.getDocumentLoc=this.Yu.getDocumentLoc;r.getSheetIndex=this.Yu.getSheetIndex;r.getSheetName=
this.Yu.getSheetName;r.getUserDefinedFuncLoc=this.Yu.getUserDefinedFuncLoc;r.getSheetRangeIndexes=this.Yu.getSheetRangeIndexes;return r}static EGj(r,M){return M.length>r.span.end&&M.charAt(r.span.end)===vj.xbg}};H.P9e="ECRC";H.M$c="ActiveCellNumberFormatChanged";H.Eid="ClientDataFlushedToWorkerKey";H=ui=Object(hb.__decorate)([Object(wb.d)(Db.u),Object(hb.__param)(0,Object(Db.nb)()),Object(hb.__param)(1,Object(Db.sb)()),Object(hb.__param)(2,Object(Db.t)())],H);Object(da.a)(H,"CalcManager",qd.a,[301,
2]);(()=>{Ca.a.Na(r=>{ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateProactiveSuggestionDebugToolsManager")||Bi.ta(r)})})();Type.registerNamespace("Common.App.InProductMessaging");lb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Va.main();(()=>{Ca.a.Na(()=>{Ca.a.Na(r=>{Db.xb.$e()||xc.ta(r)})})})();(()=>{Ca.a.Na(()=>{Db.jc.$e()||Ca.a.Na(U.ta)})})();Ca.a.Na(lc.ta);Kc.a.Rl(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
(()=>{Ca.a.Na(r=>{Ae.ta(r);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageTeachingCalloutTriggerManager",!1)||eb.ta(r)})})();(()=>{Ca.a.Na(r=>{ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEnrichmentTaskPane",!1)||xd.ta(r);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateConvertToLinkedEntityManager",!1)||Vc.ta(r)})})();(()=>{Ca.a.Na(r=>{Ia.a.vq()||$a.ta(r)})})();(()=>{Ca.a.Na(r=>{ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateProactiveSuggestionManager")||
Nb.ta(r)})})();Type.registerNamespace("Common.App.Rename");Tb.a.instance.Ul(new cc,7);(()=>{Ca.a.Na(r=>{Og.ta(r)})})();(()=>{Ca.a.Na(r=>{ya.EwaSettings.NWa()||Fb.ta(r)})})();Kc.a.Rl(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}");
(()=>{Ca.a.Na(r=>{r.ja.$c(203,new Hc)})})();Type.registerNamespace("Common.App.LivePersonaUtils");sa.main();Type.registerNamespace("Common.App.SaveStatus");Tb.a.instance.Ul(new bg);Ca.a.Na(Ug.ta);Ca.a.Na(sc.ta);Kc.a.Rl('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
ya.EwaSettings.Jwc()||Ca.a.Na(yh.ta);Type.registerNamespace("CAUI");xf.main();Tf.a.Tq.$c(141,new Xh);Ca.a.Na(wh.ta);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=kh.a;Type.registerNamespace("Common.App.WopiIdentity");Yd.main();Type.registerNamespace("Common.App.HostNotification");af.main();Type.registerNamespace("Common.App.FloatPane");qg.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");Rf.main();nh.main();
Ca.a.Na(Fh.ta);(()=>{Ca.a.Na(r=>{Db.ee.$e()||r.ja.Ne(29,()=>{Rh.ta(r)})})})();Ca.a.Na(Ni.ta);String(K);String(I);String(O);String(L);String(X);String(J);String(T);String(ba);String(Q);String(P);String(ka);String(ia);String(Ba);String(va);String(Nj);String(W);String(S);String(z);String(R);String(w);String(gc);String(F);String(Y);String(x);String(C);window.___1699049107554_closurehack=K;window.___1699049107554_closurehack=I;window.___1699049107555_closurehack=O;window.___1699049107555_closurehack=L;
window.___1699049107555_closurehack=X;window.___1699049107555_closurehack=J;window.___1699049107555_closurehack=T;window.___1699049107555_closurehack=ba;window.___1699049107555_closurehack=Q;window.___1699049107555_closurehack=P;window.___1699049107555_closurehack=ka;window.___1699049107555_closurehack=ia;window.___1699049107555_closurehack=Ba;window.___1699049107555_closurehack=va;window.___1699049107555_closurehack=Nj;window.___1699049107555_closurehack=W;window.___1699049107555_closurehack=S;window.___1699049107555_closurehack=
z;window.___1699049107555_closurehack=R;window.___1699049107555_closurehack=w;window.___1699049107555_closurehack=gc;window.___1699049107555_closurehack=F;window.___1699049107555_closurehack=Y;window.___1699049107555_closurehack=x;window.___1699049107555_closurehack=C},804:function(B,A,a){a.d(A,"a",function(){return Y});B=a(0);var c=a(2),b=a(15),k=a(98),m=a(266),d=a(16),n=a(150),l=a(195),f=a(5),h=a(99);A=a(253);var t=a(1176),u=a(18),v=a(6),y=a(345),C=a(58),x=a(14),w=a(75),z=a(13),F=a(19),J=a(95),
R=a(1011),I=a(1),O=a(155);class Y extends A.a{constructor(K,L){super(document.createElement("div"));this.NOf=this.KOe=this.cJe=this.Wgc=this.Jja=this.Uea=this.JU=this.WD=null;this.pEa=this.l0=this.Sv=this.hideCloseButton=!1;this.Vmj=X=>{this.yI(X)};this.anj=X=>{13===X.keyCode&&this.yI(X)};this.nUd=X=>{this.Wp(X.Te);return!0};this.tUd=X=>{this.h1(X.Te);return!0};this.eEc=X=>{this.eua(X.Te?X.Te:0);return!0};this.Wmj=X=>{this.yI(X.Ga);return!0};this.HSg=X=>{X=void 0===X?null:X;this.Wp(X.inputMethod?
X.inputMethod:0);return!0};this.ISg=X=>{X=void 0===X?null:X;this.h1(X.inputMethod?X.inputMethod:0);return!0};this.b9=K;this.Mw=L;this.Ded=L.MAa.toString();this.title=L.title;this.message=L.message;this.set_visibilityMode(1)}get MAa(){return this.Mw.MAa}get businessBar(){return this.b9}get actionButton(){return this.Mw?this.Mw.actionButton:""}get rPa(){return this.Mw?this.Mw.rPa:""}get linkText(){return this.Mw?this.Mw.link:""}get Et(){return this.Mw?this.Mw.Et:""}get alt(){return this.Mw?this.Mw.alt:
""}Iva(K){this.Mw.businessBarType=K}dispose(){k.a.Wf([this.Wgc,this.JU,this.Uea]);this.Sv&&this.JU&&(m.a.instance.Da(d.a.click,this.JU.domElement,this.nUd),n.KeyInputManager.instance.AU(this.domElement,this.cJe));this.l0&&this.Uea&&(m.a.instance.Da(d.a.click,this.Uea.domElement,this.tUd),n.KeyInputManager.instance.AU(this.domElement,this.KOe));this.pEa&&this.Jja&&(m.a.instance.Da(d.a.click,this.Jja,this.eEc),n.KeyInputManager.instance.AU(this.domElement,this.NOf));this.Jja=this.WD=this.b9=this.Uea=
this.JU=null;super.dispose()}update(){}OCk(){this.x3e(!0)}e2e(){this.x3e(!1)}oKh(){const K=this.businessBar.$.Ve.wj("DOMUpdate","ReactBusinessBar");K.start();this.message=J.a.si(this.message);this.title=J.a.si(this.title);l.UISurfaces.czd().then(L=>{L.initializeMessageBarInStore();const X=Object(c.a)(new R.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.Mw.businessBarType,dismissButtonAriaLabel:z.a.instance.ia(10)});this.hideCloseButton||(X.onDismiss=this.Wmj);this.pEa&&
(X.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.eEc});this.Sv&&(X.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.HSg});this.l0&&(X.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.rPa,["onExecute"]:this.ISg});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.Mw.iconName&&(X.messageBarIconProps={["iconName"]:this.Mw.iconName});L.createNewMessageBarWithCallback(this.domElement,
X,()=>{if(f.AFrameworkApplication.fa.la("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry");else{let T="1px solid ";switch(this.Mw.businessBarType){case 1:case 2:case 3:T+="#F1707B";break;case 4:T+="#92C353";break;case 5:T+="#FCE100";break;case 0:T+="#C8C6C4";break;default:T+="#C8C6C4"}this.domElement.style.border=T}I.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")&&(this.domElement.classList.add("ReactBusinessBarEntry"),
Object(O.c)(()=>{var T,ba;return null===(ba=null===(T=this.businessBar)||void 0===T?void 0:T.domElement)||void 0===ba?void 0:ba.appendChild(this.domElement)}));K.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.Mw.ECa} in: ${K.gg} milliSeconds.`)});return null},L=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.Mw.ECa} could not be initialized. ${L}`);return null});I.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")||(this.domElement.classList.add("ReactBusinessBarEntry"),
this.businessBar.domElement.appendChild(this.domElement))}wJh(K){const L=this.businessBar.$.Ve.wj("DOMUpdate","LegacyBusinessBar");L.start();K||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var X=this.businessBar.$.Af;K=X+"ewaBusinessBarEntryBody"+this.Ded;const T=X+"ewaBusinessBarEntryTitle"+this.Ded;var ba=X+"ewaBusinessBarEntryIcon"+this.Ded;this.domElement.className=t.a.yZh;x.DOMElementExtensions.kM(this.domElement);X=document.createElement("div");X.className=
t.a.zZh;X.id=K;var Q=document.createElement("div");Q.className=t.a.xZh;var P=document.createElement("a");P.className=t.a.FZh;P.title=this.alt;var ka=document.createElement("span");ka.classList.add(u.a.Jid);ka.classList.add(t.a.BZh);ka.id=ba;this.Et.length&&(ba=document.createElement("img"),ba.classList.add(this.Et),ba.src=C.a.rk(0),ka.appendChild(ba));P.appendChild(ka);Q.appendChild(P);P=document.createElement("span");P.classList.add(t.a.EZh);P.id=T;P.innerText=J.a.si(this.title);Q.appendChild(P);
P=document.createElement("span");P.classList.add(t.a.DZh);P.id="message";P.innerText=J.a.si(this.message);Q.appendChild(P);P=document.createElement("a");P.id="link";P.href="#";P.className=t.a.CZh;P.innerText=J.a.si(this.linkText);Q.appendChild(P);P=document.createElement("span");P.classList.add(t.a.Ebf);ka=document.createElement("button");ka.type="button";ka.id="action";ka.className=t.a.Dbf;ka.innerText=J.a.si(this.actionButton);P.appendChild(ka);Q.appendChild(P);P=document.createElement("span");
P.classList.add(t.a.Ebf);ka=document.createElement("button");ka.type="button";ka.id="altAction";ka.className=t.a.Dbf;ka.innerText=J.a.si(this.rPa);P.appendChild(ka);Q.appendChild(P);X.appendChild(Q);Q=document.createElement("a");Q.className=t.a.AZh;Q.tabIndex=0;Q.setAttribute("role","button");P=document.createElement("span");P.id="close";P.classList.add(u.a.dS);ka=document.createElement("img");ka.classList.add(u.a.Lrd);ka.src=C.a.rk(13);ka.alt=z.a.instance.ia(793);ka.title=z.a.instance.ia(793);ka.setAttribute("role",
"button");P.appendChild(ka);Q.appendChild(P);X.appendChild(Q);this.domElement.appendChild(X);x.DOMElementExtensions.ME(this.domElement,v.a.Moa,T,K);this.Jja=$get("link",this.domElement);x.DOMElementExtensions.setVisible(this.Jja,this.pEa);this.pEa&&(m.a.instance.va(d.a.click,this.Jja,this.eEc),this.NOf=n.KeyInputManager.instance.vQ(this.Jja,this.eEc,h.a.So,h.a.N8));this.JU=new y.a(x.DOMElementExtensions.getElementById(this.domElement,"action"));this.JU.isVisible=this.Sv;this.Uea=new y.a(x.DOMElementExtensions.getElementById(this.domElement,
"altAction"));this.Uea.isVisible=this.l0;this.Sv&&(m.a.instance.va(d.a.click,this.JU.domElement,this.nUd),this.cJe=n.KeyInputManager.instance.vQ(this.JU.domElement,this.nUd,h.a.So,h.a.N8),this.l0&&(m.a.instance.va(d.a.click,this.Uea.domElement,this.tUd),this.KOe=n.KeyInputManager.instance.vQ(this.JU.domElement,this.tUd,h.a.So,h.a.N8)));this.WD=$get("close",this.domElement);this.Wgc=this.Zh.Kh(this.WD);this.Wgc.ta("click",this.Vmj);this.Wgc.ta("keydown",this.anj);x.DOMElementExtensions.setVisible(this.WD,
!this.hideCloseButton);L.stop();b.ULS.sendTraceTag(508387361,0,50,`Legacy Business Bar created for ${this.Mw.ECa} in: ${L.gg} milliSeconds.`)}x3e(K){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.oKh():this.wJh(K)}Wp(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.Mw.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.Mw.ECa}`);F.h(this.businessBar.$).wv(!0)}h1(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.Mw.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.Mw.ECa}`);
F.h(this.businessBar.$).wv(!0)}eua(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.Mw.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.Mw.ECa}`);F.h(this.businessBar.$).wv(!0)}yI(K){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.Mw.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.Mw.ECa}`);this.set_visible(!1);this.businessBar.removeEntry(this.MAa);w.g(K)}tP(){return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:
this.JU.domElement}}Object(B.a)(Y,"BusinessBarEntry",A.a,[])},841:function(B,A,a){a.r(A);a.d(A,"ConvertToLinkedEntityManager",function(){return Ib});B=a(203);A=a(0);var c=a(15),b=a(98),k=a(232),m=a(5),d=a(32),n=a(893),l=a(147),f=a(81),h=a(40),t=a(18),u=a(6),v=a(174),y=a(1247),C=a(1038),x=a(185),w=a(588),z=a(370),F=a(59);const J=(pb,xc,ua,U,na,ob,bc,oc,Yb,Fc,ld)=>{ld=pb.Oa(1,void 0===ld?null:ld);ld.selectedRanges=xc;ld.isChangeObject=ua;ld.isFloodgateEnabled=U;ld.isStarterData=na;ld.starterDataDomainId=
ob;return F.h(pb,"GetDataSelectorPaneData",ld,bc,oc,Yb,Fc,4)};var R=a(128),I=a(829),O=a(976);class Y{}Y.cKi="EnrichmentContentFrame";Y.width=320;Object(A.a)(Y,"EnrichmentConstants",null,[]);class K{constructor(pb){this.messageType=0;this.messageType=pb}}Object(A.a)(K,"EnrichmentResponseMessage",null,[]);class L extends K{constructor(pb,xc){super(pb);this.messageContent=null;this.messageContent=xc}}Object(A.a)(L,"EnrichmentResponseMessageWithContent",K,[]);class X extends L{constructor(pb,xc,ua){super(pb,
xc);this.telemetryJson=null;this.telemetryJson=ua}}Object(A.a)(X,"EnrichmentResponseMessageWithContentAndTelemetryData",L,[]);var T=a(537),ba=a(16),Q=a(119),P=a(48),ka=a(99),ia=a(150),Ba=a(44),va=a(77),W=a(35),S=a(129),da=a(791),aa=a(24);class za{constructor(pb,xc,ua,U,na){this.FA=this.To=this.Dve=this.Bve=this.KA=this.Gz=null;this.iC=!1;this.v3f=ob=>{ob=ob.Ga.keyCode;return ob===Sys.UI.Key.enter||ob===Sys.UI.Key.space?(this.Ygc(),!0):!1};this.U2f=()=>{};this.VDc=()=>{};this.V2f=ob=>{ob=ob.rawEvent;
if(!this.KA||-1!==this.KA.src.indexOf(ob.origin)){try{var bc=Ba.a(ob.data)}catch(oc){return}if(!da.c(bc.messageType)){ob=window.g_badCastCallback;window.g_badCastCallback=null;switch(bc.messageType){case 2:this.EGc(new X(1,Ba.c(this.Bve),this.Dve));break;case 1:this.EGc(new L(0,this.Kgi()));break;case 3:this.Gz&&this.Gz.selectEntity(bc.messageContent);break;case 5:this.Gz&&this.Gz.jRb(bc.messageContent);break;case 8:this.Gz&&(bc=Ba.a(bc.messageContent),0<bc.DomainId?this.Gz.m8d(bc.Query,bc.TelemetryJson,
bc.DomainId,bc.DomainIdString):this.Gz.searchEntity(bc.Query,bc.TelemetryJson));break;case 6:this.Gz&&this.Gz.cancelSearch();break;case 11:bc=Ba.a(bc.messageContent);bc=za.Jic("keydown","f6",ka.a.w3b,!0,!1,bc,!0,!1);this.KA&&this.KA.dispatchEvent(bc);break;case 12:if(Ba.a(bc.messageContent).keyCode===ka.a.DU&&(bc=za.Jic("keydown","esc",ka.a.DU,!0,!1,!1,!1,!1),this.KA&&(this.KA.dispatchEvent(bc),this.hide(),this.Gz)))this.Gz.onPaneClosed();break;case 13:this.Gz&&this.Gz.eYb(bc.messageContent);break;
case 14:this.Gz&&this.Gz.Zob(bc.messageContent);break;case 15:this.Gz&&this.Gz.j_b(bc.messageContent);break;case 16:this.Gz&&(bc=Ba.a(bc.messageContent),this.Gz.eVa(bc.DomainId,bc.DomainIdString))}window.g_badCastCallback=ob}}};this.jq=pb;this.Xh=xc;this.mfa=ua;this.jg=U;this.Ma=na;this.oya=ia.KeyInputManager.ou(ka.a.JKa,0)}get Fob(){return!0}get PFb(){return m.AFrameworkApplication.fa.Ta("EnrichmentPaneUrl")}dispose(){this.Fob&&this.FA&&(this.jq.Da(ba.a.click,this.FA,Object(R.a)(this,this.Uta,"onClosePaneClick")),
this.Xh.Da(ba.a.mh,this.FA,this.v3f));this.FA=null;this.KA&&(this.CBk(),this.KA.parentNode.removeChild(this.KA),this.KA=null);this.jg.yn("EnrichmentPaneId").ox(this.oya)}show(pb,xc,ua){this.Gz=pb;this.iC||(this.To=this.zic(),this.n7d.appendChild(this.To),this.PQj(),this.Ma.hf(aa.a.cZe,S.a.frame,Object(R.a)(this,this.dEi,"handleEscapeKeyAction")),this.qae(),this.iC=!0);this.KA.src=this.PFb&&this.PFb.length?this.PFb+"?culture="+xc.market+"&appName="+xc.applicationName+"&themeId="+xc.themeId+"&featuresBitMask="+
xc.featuresBitMask:za.DXf;this.Bve=xc;this.Dve=ua;this.$ob()}FSc(pb,xc){pb=new X(2,pb,xc);this.EGc(pb)}qae(){const pb=this.jg.yn("EnrichmentPaneId");pb.parent=T.AFrame.Cib;this.jq.Hbc("EnrichmentPaneId",this.To);pb.bindAction(this.oya,aa.a.cZe)}rug(){if(this.KA){Q.FocusManager.Uwa(this.KA.contentWindow);const pb=new X(4,null,null);this.EGc(pb)}}Uta(){this.Ygc();return!0}Ygc(){this.hide();if(this.Gz)this.Gz.onPaneClosed()}zic(){const pb=I.a("div","EnrichmentPaneId","EnrichmentPane");this.Fob&&pb.appendChild(this.RHh());
this.jOi(pb);return pb}RHh(){const pb=I.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),xc=I.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");xc.innerText=CommonUIStrings.l_EnrichmentPaneTitle;xc.title=CommonUIStrings.l_EnrichmentPaneTitle;const ua=O.a.Ee("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.jq.va(ba.a.click,ua,Object(R.a)(this,this.Uta,"onClosePaneClick"));this.Xh.va(ba.a.mh,ua,this.v3f);pb.appendChild(xc);
pb.appendChild(ua);this.FA=ua;return pb}jOi(pb){this.KA=I.b("iframe","","EnrichmentFrame");pb.appendChild(this.KA);this.KA.id=Y.cKi;this.KA.setAttribute("role","presentation")}PQj(){P.a.addHandler(this.KA,"load",this.U2f);P.a.addHandler(this.KA,"error",this.VDc);$addHandler(window,"message",this.V2f)}CBk(){P.a.removeHandler(this.KA,"load",this.U2f);P.a.removeHandler(this.KA,"error",this.VDc);$removeHandler(window,"message",this.V2f)}QNh(){this.KA.src=za.DXf}hide(){this.Btc();this.QNh()}dEi(pb,xc,
ua){if(1!==ua&&(this.hide(),this.Gz))this.Gz.onPaneClosed();return 32}Kgi(){return Ba.c([2,1,3,5,8,6])}EGc(pb){pb=Ba.c(pb);this.KA.contentWindow.postMessage(pb,va.a.c0(this.PFb))}static Jic(pb,xc,ua,U,na,ob,bc,oc){W.a.JP?(ob=String.format("{0} {1} {2}",ob?"Shift":"",bc?"Control":"",oc?"Alt":""),ob.trim(),ua=document.createEvent("KeyboardEvent"),ua.initKeyboardEvent(pb,U,na,window.self,xc,0,ob,!1,"en-US")):(xc={},xc.keyCode=ua,xc.ctrlKey=bc,xc.shiftKey=ob,xc.altKey=oc,xc.bubbles=U,xc.cancelable=na,
ua=new KeyboardEvent(pb,xc));return ua}}za.DXf="about:blank";Object(A.a)(za,"EnrichmentPane",null,[345,2]);var qa=a(1);class ta extends za{constructor(pb){super(m.AFrameworkApplication.ra.VE,m.AFrameworkApplication.ra.wD,m.AFrameworkApplication.ra.Gwa,m.AFrameworkApplication.ra.zj,m.AFrameworkApplication.Oe);this.taskPane=pb;this.taskPane.Zeh(this.rug)}get n7d(){return this.taskPane.ng}$ob(){this.taskPane.isVisible||this.taskPane.WB(!0)}Btc(){this.taskPane.WB(!1)}get Fob(){return!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")}dispose(){this.taskPane&&
(this.taskPane.YVj(this.rug),this.taskPane=null);super.dispose()}}Object(A.a)(ta,"EnrichmentTaskPaneWrapper",za,[]);class Xa{constructor(pb){this.ED=null;this.Oma=pb}R5i(pb,xc){this.ED=pb;this.Oma&&this.Oma.show(this,xc,null)}FSc(pb,xc){this.Oma&&this.Oma.FSc(pb,xc)}HDd(){this.Oma&&this.Oma.hide()}dispose(){this.Oma&&(this.Oma.dispose(),this.Oma=null)}selectEntity(pb){return this.ED?this.ED.selectEntity(pb):!1}searchEntity(pb,xc){this.ED&&this.ED.searchEntity(pb,xc)}m8d(pb,xc,ua,U){this.ED&&this.ED.m8d(pb,
xc,ua,U)}jRb(pb){return this.ED?this.ED.jRb(pb):!1}onPaneClosed(){if(this.ED)this.ED.onPaneClosed()}cancelSearch(){this.ED&&this.ED.cancelSearch()}eYb(pb){this.ED&&this.ED.eYb(pb)}Zob(pb){this.ED&&this.ED.Zob(pb)}j_b(pb){this.ED&&this.ED.j_b(pb)}eVa(pb,xc){this.ED&&this.ED.eVa(pb,xc)}}Object(A.a)(Xa,"EnrichmentManager",null,[344,2]);class oa extends Xa{constructor(pb){super(pb)}dispose(){super.dispose()}}Object(A.a)(oa,"ExcelEnrichmentManager",Xa,[]);var ha=a(13);class Za{constructor(pb){this.campaignId=
this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=pb;this.commentQuestion=ha.a.instance.He(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=ha.a.instance.He(195);this.ratingValuesAscending=[ha.a.instance.He(196),ha.a.instance.He(197),ha.a.instance.He(198)];this.showPrompt=!1;this.showEmailRequest=
!0;this.surveyType=4;this.title=ha.a.instance.He(194)}}Object(A.a)(Za,"FloodgateSurvey",null,[]);var Fa=a(23),La=a(65),xa=a(447),db=a(45),bb=a(395),kb=a(204),Rb=a(91),zb=a(33),nc=a(252),Zb=a(19);class Sa{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(A.a)(Sa,"EnrichmentMessageContentAppProperties",null,[]);class Na{constructor(pb,xc,ua,
U,na){this.eCa=this.J7e=!1;this.Jnb=this.Esa=!0;this.ATb=this.KZb=!1;this.gpb=null;this.PFc=0;this.yB=()=>{(this.Jnb||this.eCa)&&2!==this.PFc&&(this.ATb||this.KNd(!1))};this.vg=()=>{c.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.Nnj=ob=>{zb.a.Ai(ob.Errors)?(ob=zb.a.xf(ob.Errors),ob.includes("OperationSucceededWithAlert")?c.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):c.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${ob}`)):
ob.Result&&(this.$.ea.En(this.vg),this.$.ea.wn(this.vg),ob=ob.Result,this.gpb=ob.SkydanceFeatureBitmask,this.kSd(ob),this.KZb=!0)};this.dk=()=>{(this.Jnb||this.eCa)&&this.KNd(!1)};this.ODc=(ob,bc)=>{zb.a.Ai(ob.Errors)?c.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${zb.a.xf(ob.Errors)}`):ob.Result&&(ob=ob.Result,ob.DisambiguationJson?(this.KZb=!1,this.tvg(bc),this.gpb=ob.SkydanceFeatureBitmask,bc=ob.DisambiguationJson,c.ULS.sendTraceTag(537166940,
0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.ATb=!1,this.oOf(bc)):c.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.Pqj=(ob,bc)=>{zb.a.Ai(ob.Errors)?(bc=zb.a.xf(ob.Errors),c.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${bc}`)):ob.Result&&(ob=ob.Result,ob.DisambiguationJson?(this.tvg(bc),this.gpb=
ob.SkydanceFeatureBitmask,bc=ob.DisambiguationJson,c.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.ATb=!0,this.oOf(bc)):c.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.xuj=ob=>{zb.a.Ai(ob.Errors)?(ob=zb.a.xf(ob.Errors),c.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${ob}`),
this.Jnb=!0):ob.Result&&(ob=ob.Result,this.gpb=ob.SkydanceFeatureBitmask,this.kSd(ob),this.KZb=!0)};this.rxj=ob=>{if(zb.a.Ai(ob.Errors)){const bc=zb.a.xf(ob.Errors);c.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${bc}`)}ob.Result?(this.kSd(ob.Result),this.KZb=!0):this.ZAa()};this.S6f=ob=>{zb.a.Ai(ob.Errors)?(ob=zb.a.xf(ob.Errors),c.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${ob}`)):
ob.Result?this.amc.FSc(ob.Result,null):(c.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.ZAa())};this.htj=ob=>{zb.a.Ai(ob.Errors)?(ob=zb.a.xf(ob.Errors),c.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${ob}`)):this.ZAa()};this.$=pb;this.gridView=Zb.h(this.$);this.gridView.ha.KR(this.dk);this.gridView.Dw(this.yB);this.Saf=U;this.convertToLinkedEntityManager=na;pb=
new ta(xc);this.amc=new oa(pb);f.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ob=>{ob.isFeatureEnabled("mso_sendASmile",!0).then(bc=>{this.Esa=bc;return null})})}dispose(){this.$&&(this.gridView.ha.ZT(this.dk),this.gridView.qz(this.yB))}selectEntity(pb){const xc=db.o(this.gridView.ha.pa.activeCell,this.$),ua=()=>new xa.a;bb.a(this.$.userOperationManager,(U,na,ob)=>{var bc=this.$.oa.ua;U=nc.b(U,this.rxj);const oc=bc.Oa(9,null);oc.activeCell=xc;oc.selectionIndex=
pb;return F.h(bc,"SelectLinkedEntityForDisambiguation",oc,U,na,ob,null,4)},U=>new kb.a(109,0,U,void 0,ua),null);return!0}searchEntity(pb,xc,ua,U,na){ua=void 0===ua?!1:ua;U=void 0===U?0:U;na=void 0===na?null:na;c.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${xc}`);const ob=db.o(this.gridView.ha.pa.activeCell,this.$);bb.a(this.$.userOperationManager,(bc,oc,Yb)=>{var Fc=this.$.oa.ua,ld=this.Esa,qd=ua,fe=U,ge=na;bc=nc.b(bc,this.S6f);
const Wd=Fc.Oa(1,null);Wd.searchCell=ob;Wd.searchQuery=pb;Wd.isFloodgateEnabled=ld;Wd.isStarterData=qd;Wd.starterDataDomainId=fe;Wd.starterDataDomainIdString=ge;return F.h(Fc,"LinkedEntitySearch",Wd,bc,oc,Yb,null,4)},bc=>new kb.a(110,0,bc,16),null)}jRb(pb){const xc=db.o(this.gridView.ha.pa.activeCell,this.$);this.Jnb=!1;bb.a(this.$.userOperationManager,(ua,U,na)=>{var ob=this.$.oa.ua;ua=nc.b(ua,this.xuj);const bc=ob.Oa(1,null);bc.activeCell=xc;bc.isBackward=pb;return F.h(ob,"MoveToNextAmbiguousLinkedEntity",
bc,ua,U,na,null,4)},ua=>new kb.a(111,0,ua,16),null);return!0}onPaneClosed(){this.eCa=!1;this.J7e=!0;this.PFc=0;this.ATb=!1}cancelSearch(){const pb=this.L8d();pb&&bb.a(this.$.userOperationManager,(xc,ua,U)=>{var na=this.$.oa.ua;xc=nc.b(xc,this.S6f);const ob=na.Oa(9,null);ob.activeCell=pb;return F.h(na,"CancelSearchLinkedEntity",ob,xc,ua,U,null,4)},xc=>new kb.a(112,0,xc,16),null)}eYb(pb){c.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");
this.ZAa();if(pb&&pb.length)if(pb=JSON.parse(pb))if(null==pb.domainId)c.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var xc={};xc.Id=pb.domainId;xc.StringId=pb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(xc)}else c.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else c.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}Zob(pb){const xc=
new Rb.a(-859308420,La.a.Ke,this.$.zf,9,null);this.$.Ha.Me(xc,{[La.a.Vi]:"HelpID="+pb,["InputMethod"]:La.a.Ke,["ShouldCanvasTakeFocus"]:!0,[La.a.ig]:u.a.PM})}j_b(pb){C.BrowserFeedbackControlOCV.x1a(new Za(pb))}eVa(pb,xc){const ua=this.L8d();ua&&bb.a(this.$.userOperationManager,(U,na,ob)=>{var bc=this.$.oa.ua;U=nc.b(U,this.htj);const oc=bc.Oa(1,null);oc.cell=ua;oc.starterDataDomainId=pb;oc.starterDataDomainIdString=xc;return F.h(bc,"InsertStarterDataTable",oc,U,na,ob,null,4)},U=>new kb.a(259,0,U,1),
null)}KNd(pb){this.launchOrCloseDisambiguationPane(pb)}launchDisambiguationPaneForSearch(){c.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const pb=this.P5j();pb&&bb.a(this.$.userOperationManager,(xc,ua,U)=>J(this.$.oa.ua,pb,!0,this.Esa,!1,null,nc.b(xc,this.Pqj),ua,U,1),xc=>new kb.a(114,0,xc,16),null)}launchLinkedEntityDataTypeSelectorPane(pb,xc){bb.a(this.$.userOperationManager,(ua,U,na)=>{var ob=
this.$.oa.ua;ua=nc.b(ua,this.ODc);const bc=ob.Oa(1,null);bc.selectedRanges=pb;bc.letyDomainId=xc;return F.h(ob,"GetDataTypeSelectorData",bc,ua,U,na,2,4)},ua=>new kb.a(233,0,ua,16),null)}L5i(pb,xc){pb&&bb.a(this.$.userOperationManager,(ua,U,na)=>J(this.$.oa.ua,pb,!1,!1,!0,xc,nc.b(ua,this.ODc),U,na,2),ua=>new kb.a(257,0,ua,16),null)}tvg(pb){pb&&(this.PFc=pb)}oOf(pb){var xc=new Rb.a(-90814711,La.a.Ke,0,10,null);this.$.Ha.Me(xc,null);this.eCa?this.amc.FSc(pb,null):(xc=3,null!=this.gpb?xc=this.gpb:c.ULS.shipAssertTag(537166937,
0,!1,"SkydanceFeatureBitmask was not set"),(pb=this.Cmi(pb,xc))||c.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.Saf||c.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.amc.R5i(this.Saf,pb),this.eCa=!0)}ZAa(){this.eCa&&(c.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.amc.HDd(),this.eCa=!1,this.PFc=0,this.ATb=!1)}kSd(pb){var xc=pb.Row+1;pb=pb.Column+
1;0>xc||0>pb?(c.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.ZAa(),this.$.ea.En(this.vg)):(xc=new Fa.Range(xc,pb,xc,pb,!0,!1),this.gridView.ha.updateSelection(xc,xc,60),this.Jnb=!0)}Cmi(pb,xc){const ua=new Sa;ua.applicationVersion=m.AFrameworkApplication.buildVersion;ua.applicationName="ExcelWac";ua.anid="00000000-0000-0000-0000-000000000000";ua.sessionId=m.AFrameworkApplication.userSessionId;ua.appCorrelationId=
x.a.create().toString();var U=w.a.wP(m.AFrameworkApplication.lcid);U=U?U.name:null;ua.uiLanguage=U;ua.market=this.Wpc(U);ua.themeId=0;ua.disambiguationJson=pb;xc<=z.a.T8?ua.featuresBitMask=xc:c.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return ua}Wpc(pb){pb=pb.split("-");return pb[pb.length-1]}launchOrCloseDisambiguationPane(pb){const xc=this.gridView.ha.pa.activeCell;if(this.L8d()&&xc)if(this.gridView.Je.OLb(xc)){if((!this.J7e||
pb||this.KZb)&&!this.gridView.De){pb&&(this.Jnb=!0);var ua=db.q(xc,this.$);bb.a(this.$.userOperationManager,(U,na,ob)=>J(this.$.oa.ua,ua,!1,this.Esa,!1,null,nc.b(U,this.ODc),na,ob,1),U=>new kb.a(114,0,U,16),null)}}else this.ZAa();else this.ZAa()}zPj(){if(this.eCa){var pb=this.gridView.ha.pa.activeCell;if(pb){var xc=db.q(pb,this.$);bb.a(this.$.userOperationManager,(ua,U,na)=>J(this.$.oa.ua,xc,!1,this.Esa,!1,null,nc.b(ua,this.ODc),U,na,1),ua=>new kb.a(114,0,ua,16),null)}else this.ZAa()}}L8d(){const pb=
this.gridView.ha.pa;return pb.qja()?db.o(pb.activeCell,this.$):null}P5j(){const pb=this.gridView.ha.pa;return pb.qja()?db.q(pb.activeCell,this.$):null}}Object(A.a)(Na,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Ea=a(2),Aa=a(398),Ka=a(1285),nb=a(58),Qb=a(805);class jb{constructor(pb,xc,ua){this.QOf=2;this.POf="Size64by48";this.$=pb;this.Wa=xc;this.convertToLinkedEntityManager=ua}Cei(pb,xc){var {ConvertToLinkedEntityManager:ua}=a(841);this.bEk();xc=this.Wa.zt(xc).xJ();let U=0,na=0,ob=!1;
for(var bc of pb.Categories){const oc=this.kfi(bc,U);oc&&(na===ua.aib&&(ob=!0),xc.MenuSectionList.push(oc),++U);++na}ob&&U<=ua.ROf&&xc.MenuSectionList.splice(ua.aib,1);ua=this.Wa.Tf().Wec();bc=nb.a.rk(11);for(const oc of pb.LongButtons)this.convertToLinkedEntityManager.vik(oc)&&this.qbh(ua,oc,bc);0<ua.ControlList.length&&xc.MenuSectionList.push(ua);return xc}qbh(pb,xc,ua){if(xc){var U="Data.ConvertToLinkedEntityMenuItem_"+xc.Name,na=this.convertToLinkedEntityManager.u_(xc.DomainId);na&&(xc=Object(Ea.a)(new Aa.a,
{Id:U,ExternalId:U,Command:"-1662108744",LabelText:xc.Name,Alt:xc.SuperTip,Visible:!0,MenuItemId:a(841).ConvertToLinkedEntityManager.cbb(xc.DomainId),Image16by16:ua,Image16by16Class:this.BKi(na.FontLocator)}),pb.ControlList.push(xc))}}efi(pb,xc){return Object(Ea.a)(new Ka.a,{Id:a(841).ConvertToLinkedEntityManager.D9e+pb.toString(),ExternalId:a(841).ConvertToLinkedEntityManager.D9e+pb.toString(),MenuItemId:a(841).ConvertToLinkedEntityManager.rpd+pb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.eBf(xc.FontLocator),LabelText:xc.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.ixd(xc)})}qmh(pb){switch(pb){case "Animal":return Qb.a.vih;case "Apple":return Qb.a.Bjh;case "Atom":return Qb.a.glh;case "Beaker":return Qb.a.hnh;case "Bridge":return Qb.a.Moh;case "Cat":return Qb.a.nvh;case "City":return Qb.a.wxh;case "Constellation":return Qb.a.yCh;case "Dog":return Qb.a.ZTh;case "Finance":return Qb.a.$mh;case "GradCap":return Qb.a.ACi;case "HumanAnatomy":return Qb.a.ZJi;
case "LocationPointer":return Qb.a.N8i;case "Map":return Qb.a.UAj;case "MedicineNeedle":return Qb.a.xej;case "Mountain":return Qb.a.Sfj;case "Movie":return Qb.a.jgj;case "Music":return Qb.a.wgj;case "OuterSpace":return Qb.a.DBj;case "Planet":return Qb.a.TEj;case "Satellite":return Qb.a.$2j;case "WolframGeneric":return Qb.a.O1j;default:return Qb.a.kEh}}BKi(pb){if("PowerBIRibbon"!==pb)return t.a.Krd;switch(pb){case "AnimalRibbon":return t.a.M3h;case "AppleRibbon":return t.a.N3h;case "AtomRibbon":return t.a.O3h;
case "BeakerRibbon":return t.a.P3h;case "BridgeRibbon":return t.a.Q3h;case "CenterMapRibbon":return t.a.R3h;case "CityRibbon":return t.a.S3h;case "CurrencyRibbon":return t.a.T3h;case "ExerciseRibbon":return t.a.U3h;case "FinanceRibbon":return t.a.Aef;case "FirstAidRibbon":return t.a.V3h;case "GlobeLightningRibbon":return t.a.W3h;case "GradCapRibbon":return t.a.X3h;case "HumanAnatomyRibbon":return t.a.Y3h;case "LeafRibbon":return t.a.Z3h;case "LocationPointerRibbon":return t.a.a4h;case "MapRibbon":return t.a.yef;
case "MountainRibbon":return t.a.b4h;case "MovieRibbon":return t.a.c4h;case "MusicRibbon":return t.a.d4h;case "NotablePeopleRibbon":return t.a.e4h;case "OuterSpaceRibbon":return t.a.f4h;case "PartlySunnyWeatherRibbon":return t.a.g4h;case "PowerBIRibbon":return t.a.zef;case "SatelliteRibbon":return t.a.h4h;case "WolframGenericRibbon":return t.a.$3h;case "YogaRibbon":return t.a.j4h;default:return t.a.xef}}eBf(pb){switch(pb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}kfi(pb,xc){xc=this.Wa.NH("ConvertToLinkedEntitySection_"+xc,this.QOf,this.POf);var ua=!1;for(var U of pb.DomainIds){const na=this.convertToLinkedEntityManager.u_(U);if(!na||
na.DomainBlocked||!na.ShowInRibbon)continue;ua=na.Name;const ob=a(841).ConvertToLinkedEntityManager.cbb(U);xc.Ex("Data.ConvertToLinkedEntityMenuItem_"+ob,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,ob,this.eBf(na.FontLocator),void 0,void 0,this.ixd(na),ua);ua=!0}if(!ua)return null;U=xc.Uec(!0);xc=this.Wa.Tf();xc.title=pb.Name;pb=xc.Wec();pb.ControlList.push(U);return pb}bEk(){this.QOf=5;this.POf="Size112by64"}ixd(pb){return pb.RibbonTooltipHeader?pb.RibbonTooltipHeader+"\n\n"+pb.RibbonTooltip:
pb.RibbonTooltip}}Object(A.a)(jb,"ConvertToLinkedEntityMenuRenderer",null,[317]);var qb=a(63),ab=a(335),xb=a(118),Tb=a(102),Cc=a(69);class lb{constructor(pb,xc){this.iDd=this.jDd=!1;this.YSb=ua=>{c.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.jDd=!0;if(zb.a.Ai(ua.Errors))c.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${zb.a.xf(ua.Errors)}`);else{var U=0,na=[],ob=!1;try{if(!ua.Result)return;const bc=ua.Result;if(!bc){c.ULS.sendTraceTag(537166678,
0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}na=this.WCj(bc);if(!na||!na.length)return;U=na.length;this.Mej(na);this.MIa.vng();c.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.MIa.dmb.length}`);if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const oc of this.MIa.dmb)if(1===(oc.Id&1048320)>>8){ob=!0;break}c.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${ob}`)}}finally{c.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${U} data types.`),ua=[],ua.push(Object(Ea.a)(new Cc.a,{name:"MruCount",int64:U})),ua.push(Object(Ea.a)(new Cc.a,{name:"MruWolframAvailable",bool:ob})),Tb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,ua)}this.iDd&&(this.uPg(this.MIa.dmb),this.iDd=!1)}};this.xTb=ua=>{c.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");zb.a.Ai(ua.Errors)?c.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${zb.a.xf(ua.Errors)}`):
ua.Result&&(ua.Result||c.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.aTb=(ua,U,na)=>{ua=xb.a.Lh(ua.data);c.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${na}. Errors: ${zb.a.xf(ua)}.`)};this.$=pb;this.MIa=xc}zvi(){!this.jDd&&this.$.ea.tf&&(c.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),ab.A(this.$.oa.ua,
0,this.YSb,this.aTb,null,null))}uPg(pb){pb&&pb.length?this.jDd?(pb=this.E7j(pb))?(c.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),ab.H(this.$.oa.ua,0,pb,this.xTb,this.aTb,null,null)):c.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.iDd=!0:c.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}E7j(pb){if(!pb||
!pb.length)return c.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var xc=[];for(const ua of pb)pb={},pb.Id=ua.Id,ua.StringId&&(pb.StringId=ua.StringId),xc.push(pb);xc="<DataTypes>"+qb.a.Vf(xc)+"</DataTypes>";return 1906<xc.length?(c.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):xc}WCj(pb){if(!pb)return c.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!pb.startsWith("<DataTypes>")||!pb.endsWith("</DataTypes>"))return c.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;pb=pb.substring(11,pb.length-12);if(!pb)return c.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let xc=[];try{xc=qb.a.qm(pb)}catch(ua){return c.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${ua.message}`),
null}c.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${xc.length} data types.`);return xc}Mej(pb){const xc=this.MIa.dmb,ua=this.MIa.pOj;if(xc.length!==ua){for(let U=0;U<pb.length&&xc.length<ua;++U){const na=pb[U];this.MIa.u_(na)&&!xc.includes(na)&&xc.push(na)}this.MIa.dmb=xc}}}Object(A.a)(lb,"LinkedDataTypeRoamingHandler",null,[]);var Ya=a(60),Hb=a(68),Lb=a(155),qc=a(41),mc=a(54),Ta=a(29),Va=a(241),Db=a(22),Ca=a(111),cb=a(94),hb=a(146),ya=a(8),Pa=a(703),wb;let Ib=wb=class extends h.a{constructor(pb,
xc,ua,U,na,ob,bc){super();this.MKf=this.gLd=this.dMd=this.UJd=this.TJd=this.Gxc=null;this.KRb=this.MCd=0;this.mta=null;this.UGd=!1;this.$ud=this.gs=this.k7d=null;this.ax=0;this.s4=null;this.AUa=8;this.wgd=this.OOf=this.vGf=this.xkb=!1;this.GHa=this.Llf=this.qif=null;this.Aed=0;this.Bmh=5;this.kec=3E4;this.WGg=!1;this.DAa=null;this.pCa=Array(5);this.XJg=this.Hie=!1;this.Yog=this.kOd=0;this.wf=this.Sze=null;this.HAg=!0;this.vg=(oc,Yb)=>{Yb.tf&&!Yb.dOb&&this.showUntrustedImageBusinessBarIfNecessary()};
this.Qrj=oc=>{if(oc.Result){var Yb=oc.Result;if(Yb&&Yb.length){c.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Yb.length} labels`);var Fc=Hb.GetServiceTaskFactory.vf(this.$.ja,274,275,0);qc.TaskExtensions.Ca(Fc,()=>{Fc.result.med(Yb,2)||c.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.qa,3)}}else c.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
this.ij=()=>{this.czk();this.UEi(this.$.ea.Vq.LinkedEntityAsyncRefreshStateId);this.bGi(this.$.ea.Vq.RichDataClassificationLabelStateId)};this.apj=()=>{this.Hie=!0;this.gs&&this.gs.zPj()};this.hrj=oc=>{if(oc&&!Va.a(oc))try{oc.Result.HasUntrustedImageUrl&&(this.businessBar.Uj(59,null),this.XJg=!0)}catch(Yb){c.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Yb}.`)}};this.lOf=()=>{if(!this.OOf&&
this.pMb()&&!this.KHd())if(Tb.a("DataTabActive"),Ya.a.fj.IW)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var oc=this.xic();if(oc){var Yb={};Yb.InputMethod=La.a.Ke;Yb.CalloutName=8;Yb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ha.Me(oc,Yb);this.OOf=!0}else c.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else c.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else c.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.Onj=oc=>{zb.a.Ai(oc.Errors)||this.raiseEvent("LinkedEntityConverted")};this.wyj=()=>{qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void hb.a.Xn(ya.i).then(oc=>{oc.readText(ha.a.instance.ia(1813))}):this.$.ja.Ne(211,oc=>{oc.readText(ha.a.instance.ia(1813))})};this.Xg=
(oc,Yb)=>{c.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Yb.K0?c.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.CXe():this.q_j(),this.Hie&&this.S$e())};this.prj=oc=>{this.Dgc();if(oc.Result){var Yb=oc.Result;oc=Yb.DomainDataArray;if(this.mta=Yb.Ribbon){var Fc={};Fc.Name=ha.a.instance.ia(1803);Fc.DomainIds=this.VP;this.mta.Categories.splice(wb.aib,0,Fc)}0<Yb.MaximumCellsToConvert&&
(this.Sze=Yb.MaximumCellsToConvert);this.ax=2;Yb=!1;if(oc){c.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${oc.length} domains`);this.iXa||(this.iXa=[]);Fc=ha.a.instance.ia(1800);const ld=ha.a.instance.ia(1802);for(const qd of oc)qd.DomainId?(this.iXa.push(qd),qd.DomainBlocked?(oc=!!qd.DomainId.StringId,c.ULS.sendTraceTag(537166861,0,50,`Domain: ${oc?qd.DomainId.Id.toString():qd.Name} is telemetry only, do not show in menu (Has String ID: ${oc})`)):(this.t_.da(wb.cbb(qd.DomainId),
qd),qd.Name===Fc||268435456===qd.DomainId.Id?this.qif=qd.DomainId.Id.toString():qd.Name===ld||536870912===qd.DomainId.Id?this.Llf=qd.DomainId.Id.toString():268435712===qd.DomainId.Id&&qd.ShowInRibbon&&(this.wgd=!0),Yb=!0)):c.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Yb||(this.iXa=null);this.KKg();this.k7d.zvi();this.WGg||(this.Xyk(),this.WGg=!0)}else this.iXa=null,this.ax=3,-1<this.AUa&&window.setTimeout(()=>{this.rUb()},100*(8-this.AUa)),c.ULS.sendTraceTag(537166863,
0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.j2d();this.$2e();this.wgd&&this.YHf&&Lb.d(this.lOf,this.$.qa,500)};this.orj=oc=>{oc=xb.a.Lh(oc.data);c.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${zb.a.xf(oc)}].`);this.iXa=null;this.ax=3;this.xkb=!0;this.j2d()};this.onContentReady=()=>{this.xIg()&&this.gridView.qz(this.onContentReady);this.HAg&&this.$.workbookContext.Options&1048576&&(this.businessBar.Omk(),this.HAg=!1)};this.sm=()=>{this.Dgc()};
this.Vtj=oc=>{if(Va.a(oc)){const Yb=Object(cb.d)(hb.a.resolve(ya.s,{Aa:0}));qc.TaskExtensions.Ca(Yb,()=>{let ld=null;if(null===oc||void 0===oc?0:oc.Errors)ld=oc.Errors[0];Yb.result.lAg(ld,null)},this.$.qa,3);c.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${zb.a.xf(oc.Errors)}].`);const Fc=zb.a.vG(oc.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");
this.$.ea.Kr(Fc)}};this.rgd=()=>{c.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.kec} millisecond interval`);this.MDf("Periodic auto-refresh check",this.Xlj,this.Wlj)};this.Xlj=oc=>{Va.a(oc)?(c.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${zb.a.xf(oc.Errors)}].`),++this.Aed):this.Aed=0;b.a.Sa(this.GHa);this.Aed>=this.Bmh?
(c.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.GHa=null):(c.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.GHa=mc.a.instance.create(this.rgd,this.kec,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.Wlj=oc=>{oc=xb.a.Lh(oc.data);k.a.$j(oc)?c.ULS.sendTraceTag(537166791,
0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):c.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${zb.a.xf(oc)}].`);b.a.Sa(this.GHa);this.GHa=mc.a.instance.create(this.rgd,this.kec,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.Yuj=oc=>{oc=!!oc.Result&&oc.Result;c.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${oc.toString()}`);
oc?(c.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Ta.a.Ae.zh.m-this.MCd} ms, retry count = ${this.KRb}`),this.rUb()):this.kPc()};this.Xuj=()=>{c.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.kPc()};this.Tqj=oc=>{oc.Result?(oc=oc.Result)?(this.y3d(),this.businessBar.lAg(null,oc)):c.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):c.ULS.sendTraceTag(537166726,
0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=pb;this.businessBar=ob;this.svgIconProvider=ua;this.wf=bc;this.iXa=[];this.VP=[];this.gridView=Zb.h(this.$);this.Tsc=-1;this.GYi=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.YHf=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.t_=new Ca.a;this.Pib=new jb(pb,xc,this);U&&(this.gs=new Na(pb,U,na,
this,this));this.$.Go(this.Xg);v.a(this.$)&&v.a(this.$).o9j(this);this.CXe();this.$.ea.Jy(this.ij);qa.EwaSettings.Ia(123)&&qa.EwaSettings.Ia(131)&&(this.xIg()||this.gridView.Dw(this.onContentReady));this.$.MD(this.sm);this.$.ea.wn(this.vg);this.showUntrustedImageBusinessBarIfNecessary();this.k7d=new lb(this.$,this)}dispose(){this.$.ea.pA(this.ij);this.$.ea.En(this.vg);!this.DAa&&qa.EwaSettings.Ia(123)&&qa.EwaSettings.Ia(131)&&this.gridView.qz(this.onContentReady);this.gs&&this.gs.dispose();this.$.wG(this.sm);
this.$.Hp(this.Xg);b.a.Sa(this.GHa)}KMe(pb){this.addHandler("LinkedEntityConverted",pb)}Mkg(pb){this.removeHandler("LinkedEntityConverted",pb)}get pOj(){return 5}get dmb(){return this.VP}set dmb(pb){this.VP=pb}selectEntity(pb){return this.gs?this.gs.selectEntity(pb):!1}searchEntity(pb,xc){this.gs&&this.gs.searchEntity(pb,xc)}m8d(pb,xc,ua,U){this.gs&&this.gs.searchEntity(pb,xc,!0,ua,U)}jRb(pb){return this.gs?this.gs.jRb(pb):!1}onPaneClosed(){if(this.gs)this.gs.onPaneClosed()}cancelSearch(){this.gs&&
this.gs.cancelSearch()}eYb(pb){this.gs&&this.gs.eYb(pb)}Zob(pb){this.gs&&this.gs.Zob(pb)}j_b(pb){this.gs&&this.gs.j_b(pb)}eVa(pb,xc){this.gs&&this.gs.eVa(pb,xc)}bGi(pb){if(this.$.isEditMode&&this.Yog!==pb&&m.AFrameworkApplication.fa.la("SupportsPolicies")){this.Yog=pb;c.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");pb=this.$.oa.ua;var xc=this.Qrj;const ua=pb.Oa(1,null);F.h(pb,"GetRichDataClassificationLabels",ua,xc,null,
null,null,4)}}S$e(){this.$.userOperationManager.enqueueOperation(new kb.a(589,0,(pb,xc,ua)=>{var U=this.$.oa.ua;pb=nc.b(pb,this.apj);const na=U.Oa(1,null);return F.h(U,"LinkedEntitiesEnableUntrustedImages",na,pb,xc,ua,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.Hie||this.XJg||!this.$.ea.tf||this.B6j()}B6j(){this.$.userOperationManager.enqueueOperation(new kb.a(588,0,(pb,xc,ua)=>{var U=this.$.oa.ua;pb=nc.b(pb,this.hrj);const na=U.Oa(1,null);return F.h(U,"GetHasUntrustedImageUrls",
na,pb,xc,ua,null,4)},80),null)}get LQb(){return this.pCa.length}get tej(){return this.Sze}lEh(pb){(pb=this.cUh(pb))?this.convertToLinkedEntity(pb):c.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(pb){c.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${pb.Id}].`);if(this.gridView){var xc=this.gridView.ha.pa.og,ua=xc.Bh(this.gridView.dW);this.UGd&&this.ach(pb);if(ua){ua=this.gridView.Je.zFa(ua);
if(!this.yyf(pb)&&this.fJf(pb.Id)){c.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Ya.a.fj.IW){xc=this.pwd();if(!xc){c.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}ua=this.xic();if(!ua){c.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var U={["InputMethod"]:La.a.Ke,CalloutName:3};U.Target=xc;U.RibbonButtonLabel=
qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.Kog(pb):this.UOb(pb.Id.toString());U.ExampleEntities=this.ogf(pb);this.$.Ha.Me(ua,U);return}c.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.fJf(pb.Id)&&!pb.StringId)this.launchLinkedEntityDataTypeSelectorPane(wb.cbb(pb));else{if(ua){c.ULS.sendTraceTag(537166914,
0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.bsk(pb)){xc=db.r(this.gridView.ha.pa.selectedRanges,this.$);this.gs.L5i(xc,pb);return}if(Ya.a.fj.IW){xc=this.pwd();if(!xc){c.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}ua=this.xic();if(!ua){c.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");
return}U={["InputMethod"]:La.a.Ke,CalloutName:2};U.Target=xc;U.RibbonButtonLabel=this.Kog(pb);U.ExampleEntities=this.ogf(pb);U.BlankCellResourceId=this.Hnh(pb);U.HasBlankCellWalkthrough=this.UGi(pb);U.ServiceDomain=pb.Id;this.$.Ha.Me(ua,U);return}c.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.zkd(pb,!1,xc)}}}else c.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.DAa&&
this.DAa.dRa()}onAutoDetectUIShown(){bb.a(this.$.userOperationManager,(pb,xc,ua)=>{var U=this.$.oa.ua;const na=U.Oa(1,null);return F.h(U,"OnAutoDetectUIShown",na,pb,xc,ua,null,4)},pb=>new kb.a(230,0,pb,80),null)}zkd(pb,xc,ua){const U=db.q(ua,this.$),na=()=>new xa.a;bb.a(this.$.userOperationManager,(ob,bc,oc)=>{var Yb=this.$.oa.ua;ob=nc.b(ob,this.Onj,this.wyj,this.gs.Nnj);const Fc=Yb.Oa(1,null);Fc.selectedRanges=U;Fc.domainId=pb;Fc.autodetect=xc;return F.h(Yb,"ConvertToLinkedEntity",Fc,ob,bc,oc,null,
4)},ob=>new kb.a(115,0,ob,void 0,na),null)}ach(pb){if(this.UGd){var xc={};xc.Id=pb.Id;pb.StringId&&(xc.StringId=pb.StringId);if(!(0<this.VP.length&&this.VP[0].Id===xc.Id&&this.VP[0].StringId===xc.StringId)){pb=!1;this.VP.splice(0,0,xc);for(let ua=1;ua<this.VP.length;++ua)if(this.VP[ua].Id===xc.Id&&this.VP[ua].StringId===xc.StringId){this.VP.splice(ua,1);pb=!0;break}for(;5<this.VP.length;)this.VP.splice(this.VP.length-1,1);this.mta.Categories[wb.aib].DomainIds=this.VP;this.vng();pb||this.k7d.uPg(this.VP)}}}convertLinkedEntityToText(){c.ULS.sendTraceTag(34719501,
0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var pb=db.q(this.gridView.ha.pa.og,this.$);bb.a(this.$.userOperationManager,(xc,ua,U)=>{var na=this.$.oa.ua;const ob=na.Oa(1,null);ob.selectedRanges=pb;return F.h(na,"ConvertLinkedEntityToText",ob,xc,ua,U,null,4)},xc=>new kb.a(116,0,xc),null)}else c.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){c.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");
if(Zb.h(this.$)){this.$.isEditMode||c.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.y3d();var pb=db.r(this.gridView.ha.pa.selectedRanges,this.$);bb.a(this.$.userOperationManager,(xc,ua,U)=>{var na=this.$.oa.ua;const ob=na.Oa(1,null);ob.selectedRanges=pb;return F.h(na,"RefreshLinkedEntitiesInRange",ob,xc,ua,U,null,4)},xc=>new kb.a(248,0,xc),null)}else c.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}vik(pb){pb=
this.u_(pb.DomainId);if(!pb||pb.DomainBlocked||!pb.HasCuratedData)return!1;if(this.GYi){for(const xc of this.t_)if(xc.value.DomainId.Id===pb.DomainId.Id&&xc.value.ShowInRibbon)return!0;return!1}return pb.ShowInRibbon}Sgk(pb){return 2!==this.ax||!this.pCa[pb]}launchDisambiguationPaneForSearch(){this.gs&&this.gs.launchDisambiguationPaneForSearch()}Yf(pb,xc,ua){if("PopulateConvertToLinkedEntityMenu"!==xc)return!1;this.$ud=ua.MenuId;if(0===this.ax||3===this.ax)return this.BFj(),!0;if(!this.mta)return c.ULS.sendTraceTag(537166873,
0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.t_)return c.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.s4=this.s4||this.Pib.Cei(this.mta,ua.MenuId);ua.MenuItems=this.s4;return this.UGd=!0}BFj(){-1===this.Tsc&&(this.rUb(),this.Tsc=window.setInterval(()=>{this.rUb()},2E3))}rUb(){if(this.$.ea.tf&&2!==this.ax){this.AUa--;c.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");
this.ax=1;var pb=this.$.oa.ua,xc=this.prj,ua=this.orj;const U=pb.Oa(1,null);F.h(pb,"GetLinkedEntityMetadata",U,xc,ua,null,null,4)}}KHd(){return this.$.isEditMode&&2!==this.ax&&(0<=this.AUa||!this.xkb)}wje(pb){m.AFrameworkApplication.Oi?c.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):v.a(this.$)?(this.NEk(),pb&&this.$.Tj()):c.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}q_j(){this.KRb=0;this.AUa=
8;this.xkb=!1;this.ax=this.Tsc=0;this.iXa=this.mta=null;this.Dgc();for(let pb=0;pb<this.LQb;++pb)this.pCa[pb]=null;this.pMb()&&this.wje(!0)}Dgc(){this.s4=null}pMb(){const pb=u.a.oVb,xc=v.a(this.$);return!!xc&&xc.ep.sA===pb}KKg(){if(this.mta){let ua=0;var pb=-1,xc=-1;let U=0,na=0,ob=0,bc=0;const oc=[null,null,null,null,null];for(const Yb of this.mta.Categories){let Fc=!1;for(const ld of Yb.DomainIds){const qd=this.u_(ld);qd&&!qd.DomainBlocked&&qd.ShowInRibbon&&(ua<this.LQb?(this.pCa[ua]=ld,na===wb.aib&&
(-1===pb&&(pb=ua),xc=ua,bc=xc-pb+1),++ua):ua===this.LQb&&U<bc&&na!==wb.aib&&(oc[U]=ld,++U),Fc=!0)}Fc&&++ob;++na}if(-1<pb&&ob<=wb.ROf){for(;xc>=pb;--xc)this.pCa.splice(xc,1);for(pb=0;pb<bc;++pb)this.pCa.splice(ua+pb,0,oc[pb])}for(;ua<this.LQb;)this.pCa[ua]=null,++ua}}xIg(){const pb=Zb.h(this.$).ya,xc=this.gridView.ha.Yh;if(pb&&pb.SCd&&1===xc&&this.gridView.ha.pa.activeCell){const ua=Object(cb.d)(hb.a.resolve(ya.Ld,{Aa:1}));qc.TaskExtensions.Ca(ua,()=>{this.DAa=new y.a(this.$,this.svgIconProvider,ua.result,
this,this.wf)},this.$.qa,3);return!0}return!1}O5i(){this.gs&&this.gs.KNd(!0)}launchLinkedEntityDataTypeSelectorPane(pb){if(this.gs)if(pb=this.Zod(pb))if(pb.DomainId.StringId)c.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var xc=db.r(this.gridView.ha.pa.selectedRanges,this.$);this.gs.launchLinkedEntityDataTypeSelectorPane(xc,pb.DomainId.Id)}else c.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}BCh(pb){const xc=
this.AKi(pb),ua=d.a.Qn(this.UOb(pb));pb=d.a.Qn(this.Yge(pb));return wb.gei(xc,nb.a.rk(11),ua,pb)}Yge(pb){try{return this.P8e(parseInt(pb,10)).Description}catch(xc){}return ha.a.instance.ia(1797)}UOb(pb){try{return this.P8e(parseInt(pb,10)).Name}catch(xc){}return ha.a.instance.ia(1783)}Kog(pb){try{return this.u_(pb).Name}catch(xc){}return this.UOb(pb.Id.toString())}Hnh(pb){try{return this.u_(pb).BlankCellResourceId}catch(xc){}return null}UGi(pb){try{return this.u_(pb).HasBlankCellWalkthrough}catch(xc){}return!1}yyf(pb){try{const xc=
wb.cbb(pb);if(this.t_.$d(xc))return this.t_.ka(xc).HasCuratedData}catch(xc){}return!1}bsk(pb){try{return this.u_(pb).SupportsStarterData}catch(xc){}return!1}fJf(pb){return 268435968===pb}pwd(){return 2===v.a(this.$).cU?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}xic(){return new Rb.a(-847286761,La.a.Ke,this.$.zf,0,u.a.I1)}$2e(){if(this.pMb()&&!this.KHd()&&!this.vGf&&qa.EwaSettings.Ia(387)&&this.yyf({Id:268435968,StringId:null}))if(c.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
Ya.a.fj.IW){const ua=this.pwd();if(ua){var pb=this.xic();if(pb){var xc={["InputMethod"]:La.a.Ke,CalloutName:6};xc.Target=ua;xc.ShouldCanvasTakeFocus=!0;this.$.Ha.Me(pb,xc);this.vGf=!0}else c.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else c.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else c.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}iKi(pb){pb=
this.Zod(pb);return pb?this.Pib.qmh(pb.SubdomainFontLocator):(c.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Dvc(pb){return this.DAa?this.DAa.pmh(pb):!1}qhi(){return this.DAa?this.DAa.kii():""}jmi(pb,xc){const ua=this.MBf(pb);if(0>ua)c.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${pb}`);else if(pb=(pb=this.Q8e(pb))?this.u_(pb):null)xc[n.a.GalleryButtonProps]=
this.Pib.efi(ua,pb),xc[n.a.Alt]=this.Pib.ixd(pb)}vng(){this.KKg();this.pMb()&&this.wje(!0);this.Dgc()}AKi(pb){return pb===this.qif?t.a.Aef:pb===this.Llf?t.a.yef:t.a.xef}ogf(pb){try{return this.u_(pb).ExampleEntities}catch(xc){}return ha.a.instance.ia(1805)}j2d(){(0>this.AUa||this.xkb)&&c.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.ax||0>this.AUa||this.xkb)&&window.clearInterval(this.Tsc);this.KHd()?this.$ud&&this.$.frame.$B(this.$ud):
this.wje(this.pMb())}mf(pb){return this.$.Af+pb}NEk(){var pb=!0;const xc=Array(this.LQb),ua=v.a(this.$)?v.a(this.$).ep:null;if(ua){for(let U=0;U<xc.length;++U)this.Sgk(U)?xc[U]=!0:pb=xc[U]=!1;ua.Jvg(["ConvertToLinkedEntityGallery"],pb);if(!pb)for(pb=0;pb<xc.length;++pb)xc[pb]&&ua.Jvg([this.imi(pb)],!0)}else c.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}u_(pb){const xc=wb.cbb(pb);if(this.t_.$d(xc))return this.t_.ka(xc);c.ULS.sendTraceTag(592729218,
0,15,`No domain data for domain ID ${pb.Id} (Has String ID: ${!!pb.StringId})`);return null}imi(pb){return"ConvertToLinkedEntityPreview"+pb.toString()}oje(){l.a.get_instance().Mk(10,()=>{this.$2e();this.wgd&&this.YHf&&Lb.d(this.lOf,this.$.qa,500)})}Gsc(pb,xc){switch(pb){case "QueryLinkedEntityGalleryButtons":if(!xc[n.a.InnerHTML]){pb=xc[La.a.ig].toString();const ua=Db.a.equals(pb,ha.a.instance.ia(1800),!0)||Db.a.equals(pb,ha.a.instance.ia(1801),!0),U=Db.a.equals(pb,ha.a.instance.ia(1802),!0);ua||
U||this.jmi(pb,xc)}break;case "QueryLinkedEntityMenuGalleryButtons":xc[n.a.InnerHTML]||(xc[n.a.InnerHTML]=this.BCh(xc[La.a.ig]))}return xc}cUh(pb){var xc=this.Q8e(pb);if(xc)return xc;if(xc=this.Zod(pb))return xc.DomainId;c.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${pb}`);return null}P8e(pb){const xc={};xc.Id=pb;return this.u_(xc)}Zod(pb){return this.t_.$d(pb)?this.t_.ka(pb):null}MBf(pb){if(!pb.startsWith(wb.rpd))return-1;const xc=parseInt(pb.substr(wb.rpd.length),10);return isNaN(xc)?
(c.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${pb}`),-1):xc}Q8e(pb){pb=this.MBf(pb);return 0>pb?null:this.pCa[pb]}MDf(pb,xc,ua){if(this.t_&&this.t_.count){c.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${pb})`);var U=this.$.oa.ua.qf();this.$.ea.tf&&(pb=this.$.oa.ua,xc=nc.b(this.Vtj,xc),U=pb.Oa(1,void 0===U?null:U),F.h(pb,"LinkedEntityTryAutoRefresh",U,xc,ua,null,null,0))}}Xyk(){this.MDf("Auto-refresh on load",
null,null)}czk(){this.t_&&this.t_.count&&(this.GHa?c.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Vq.HasAutoRefreshableLinkedEntityDomainsEver?(c.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.GHa=mc.a.instance.create(this.rgd,
this.kec,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):c.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}kPc(){if(this.$.ea.tf&&null!=this.Gxc&&null!=this.TJd&&null!=this.UJd&&null!=this.dMd&&null!=this.gLd)if(++this.KRb,12>=this.KRb){1===this.KRb&&(this.MCd=Ta.a.Ae.zh.m,c.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));
const pb=this.$.oa.ua.qf();ab.y(this.$.oa.ua,this.b7i,this.c7i(),this.Yuj,this.Xuj,null,pb)}else c.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Ta.a.Ae.zh.m-this.MCd} ms`),this.xkb=!0,this.j2d()}CXe(){if(this.$.isEditMode)if(null!=this.Gxc)this.kPc();else{var pb=Ta.a.Ae.zh.m,xc=[];f.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ua=>{ua.isFeatureEnabled("ExcelPowerBiPro",!1).then(U=>{c.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Ta.a.Ae.zh.m-pb} Millisecond.`);c.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${U}]`);return this.Gxc=U}).then(()=>{xc.push(ua.isFeatureEnabled("ExcelWolframAlpha",!1).then(U=>{c.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Ta.a.Ae.zh.m-pb} Millisecond.`);c.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${U}]`);return this.dMd=U}))}).then(()=>{xc.push(ua.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(U=>{c.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Ta.a.Ae.zh.m-pb} Millisecond.`);c.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${U}]`);
const na=[Object(Ea.a)(new Cc.a,{name:"IsRestrictedByLicense",bool:U})];Tb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,na);this.MKf=U&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return U}))}).then(()=>{xc.push(ua.isFeatureEnabled("StockHistory",!1).then(U=>{c.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Ta.a.Ae.zh.m-pb} Millisecond.`);c.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${U}]`);
return this.gLd=U}))}).then(()=>{xc.push(ua.isFeatureEnabled("ExcelPowerBiFree",!1).then(U=>{c.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Ta.a.Ae.zh.m-pb} Millisecond.`);c.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${U}]`);return this.TJd=U}))}).then(()=>{xc.push(ua.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(U=>{c.ULS.sendTraceTag(537166734,0,
50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Ta.a.Ae.zh.m-pb} Millisecond.`);c.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${U}]`);return this.UJd=U}))}).then(()=>{Promise.all(xc).then(()=>{this.kPc()})})})}}get b7i(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}c7i(){return[this.Gxc,
this.dMd,this.gLd,this.TJd,this.UJd,this.MKf]}y3d(){this.businessBar&&this.businessBar.Yia(58)&&this.businessBar.removeEntry(58)}UEi(pb){if(this.kOd!==pb&&this.businessBar)if(this.kOd=pb){pb=this.$.oa.ua;var xc=this.Tqj;const ua=pb.Oa(1,null);F.h(pb,"GetErrorMessageForLinkedDataTypeRefresh",ua,xc,null,null,null,4)}else this.y3d()}static gei(pb,xc,ua,U){pb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',pb,xc,U);ua=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
ua);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',pb,ua)}static cbb(pb){return pb.StringId?pb.Id.toString()+"."+pb.StringId:pb.Id.toString()}};Ib.D9e="ConvertToLinkedEntityPreview";Ib.rpd="PreviewGalleryButtonIndex.";Ib.aib=0;Ib.ROf=2;Ib=wb=Object(B.__decorate)([Object(hb.d)(ya.N),Object(B.__param)(0,Object(ya.nb)()),Object(B.__param)(1,Object(ya.Bd)()),Object(B.__param)(2,Object(Pa.m)()),Object(B.__param)(3,Object(ya.lb)()),Object(B.__param)(4,
Object(ya.rd)()),Object(B.__param)(5,Object(ya.s)()),Object(B.__param)(6,Object(ya.fc)())],Ib);Object(A.a)(Ib,"ConvertToLinkedEntityManager",h.a,[295,296,2,297])},939:function(B,A,a){a.d(A,"a",function(){return b});B=a(0);A=a(804);var c=a(91);class b extends A.a{constructor(k,m,d){super(k,m);this.Sv=!0;this.command=d}Wp(k){super.Wp(k);this.businessBar.$.Ha.Me(new c.a(this.command,k,this.businessBar.$.zf,10,null))}}Object(B.a)(b,"CommandActionBusinessBarEntry",A.a,[])},955:function(B,A,a){a.r(A);a.d(A,
"NetworkConnectionHealthChecker",function(){return C});B=a(0);var c=a(2),b=a(15),k=a(449),m=a(33),d=a(12),n=a(281);class l{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(B.a)(l,"ConnectionErrorLogInfo",null,[]);var f=a(1172),h=a(1173);class t{constructor(x){this.lEd=[f.a.pQg,f.a.HUc];this.Lp=(w,z)=>{this.bU[z]=w;this.HHi()&&this.lZj("OnNetworkDownImmediatePing"===w.caller)};this.Cta=x;this.$=x.$;this.bU={}}J5i(){const x=h.a.yvd(this.Lp,"OnNetworkDownImmediatePing",
this.$,this.lEd);for(const w of x)w.runTest()}HHi(){for(const x of this.lEd)if(void 0===this.bU[x]||null===this.bU[x])return!1;return!0}lZj(x){const w=this.$.ni.gca;x&&this.ark(w);for(var z of this.lEd)this.bU[z]=Sys.Serialization.JavaScriptSerializer.serialize(this.bU[z]);x=Date.now();z=(()=>this.Cta.dBd(a(955).NetworkConnectionHealthChecker.xRb))().returnValue;const F=(()=>this.Cta.dBd(a(955).NetworkConnectionHealthChecker.xYb))().returnValue;this.bU.isOfflineMode=w;this.bU.networkDownBBAge=-1===
z?z:x-z;this.bU.transientServerCommunicationFailuresBBAge=-1===F?F:x-F;this.Cta.businessBar?(this.bU.isNetworkDownBBShown=this.Cta.businessBar.EJ(56).toString(),this.bU.isServerErrorBBShown=this.Cta.businessBar.EJ(21).toString()):(this.bU.isNetworkDownBBShown="unknown",this.bU.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.bU)}`)}ark(x){const {NetworkConnectionHealthChecker:w}=
a(955),z={};for(const F of Object.keys(this.bU)){const J=this.bU[F];z[J.testName]=J.isSuccess}z.isOfflineMode=x;this.Cta.Pee(w.Xjd,Sys.Serialization.JavaScriptSerializer.serialize(z))}}Object(B.a)(t,"ConnectionHealthTestsRunner",null,[]);var u=a(146),v=a(8),y=a(1);class C{constructor(x){this.businessBar=this.Dhb=null;this.ho=y.EwaSettings.ho("NetworkConnectionHealthChecker");this.Mlj=(w,z)=>{z.Jod?this.Olj(z):this.Nlj(z)};this.uk=(w,z)=>{w=z.context.methodName;this.Dhb&&w===this.Dhb&&(b.ULS.sendTraceTag(537155230,
0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.Dhb}" has now succeeded. Querying local storage for BB showings.`),this.nib(C.xYb,!0),this.Dhb=null);this.QQf(!1);this.Ehc=!1};this.Fp=(w,z)=>{m.a.yk(z.errors,[-1387426400])&&!this.Ehc&&(this.Ehc=!0,this.Zxg()&&window.performance.mark(C.pYf),(new t(this)).J5i())};this.yAc=()=>{this.QQf(!0);this.nib(C.xRb,!1);this.nib(C.xYb,!1)};this.gHa=()=>{this.nib(C.xRb,!0)};this.$=x;this.oa=this.$.oa;this.localStorage=new n.a;this.Ehc=
!1;this.ho?this.$.ea.IO(this.yAc):this.$.ea.zm(this.yAc);this.oa.ni.izb(this.gHa);this.oa.rt(this.uk);void u.a.Xn(v.s).then(w=>{const z=this;return Lo(function*(){z.businessBar=w;w.Pch(z.Mlj)})});this.oa.Iy(this.Fp)}dispose(){this.$&&(this.$.ea&&(this.ho?this.$.ea.CX(this.yAc):this.$.ea.cq(this.yAc)),this.oa&&(this.oa.ni.vWb(this.gHa),this.oa.rz(this.Fp),this.oa.Gu(this.uk)))}Olj(x){const w={};w.Timestamp=Date.now().toString();switch(x.MAa){case 21:this.Dhb=x.data.FailedMethod;w.FailedMethod=this.Dhb;
this.Pee(C.xYb,JSON.stringify(w));break;case 56:this.Pee(C.xRb,JSON.stringify(w))}}Nlj(x){switch(x.MAa){case 21:this.nib(C.xYb,!0);break;case 56:this.nib(C.xRb,!0)}}Pee(x,w){try{this.localStorage.Xi()&&this.localStorage.setItem(x,w)}catch(z){b.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${z.message||"Unknown"}`)}}dBd(x){if(this.localStorage.Xi()&&(x=this.localStorage.KTa(x))&&"null"!==x){var w=JSON.parse(x);
x=parseInt(w.Timestamp,10);w=Sys.Serialization.JavaScriptSerializer.serialize(w);return{returnValue:x,rawData:w}}return{returnValue:-1,rawData:null}}QQf(x){if(this.localStorage.Xi()){const w=this.localStorage.KTa(C.Xjd);if(w&&"null"!==w){let z=-1;this.Ehc&&(z=this.gmi(C.pYf,C.tkj));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(w)}, Period offline: ${z}, New session: ${x}`);this.localStorage.removeItem(C.Xjd)}}}gmi(x,
w){if(!this.Zxg())return-1;window.performance.measure(w,x);x=window.performance.getEntriesByName(w);return x.length&&x[x.length-1]?x[x.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${w} returned no measures.`),-1)}nib(x,w){try{let z;const F=(()=>{let J=this.dBd(x);({rawData:z}=J);return J})().returnValue;if(-1!==F){const J=Object(c.a)(new l,{timeElapsed:Date.now()-F,scenario:x,isNewSession:!w,rawData:z});b.ULS.sendTraceTag(537155227,
0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(J)}`)}this.localStorage.removeItem(x)}catch(z){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${z.message||"Unknown"}`)}}Zxg(){return d.HelperMethods.xfd&&k.a.UPa}}C.xRb="NetworkDownBBShown";C.xYb="ServerCommunicationFailureBBShown";C.Xjd="ConnectionHealthPingRsults";C.pYf="offMoStMa";C.tkj="offMoDuMea";Object(B.a)(C,"NetworkConnectionHealthChecker",
null,[2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/8647f64e181ea0acc158df243b3f70cf/EwaTS.pi.js.map