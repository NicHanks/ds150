'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1390:function(B,A,a){a.r(A);var c={};a.r(c);a.d(c,"SheetTabBarFactory",function(){return me});var b={};a.r(b);a.d(b,"MoreColorsHelper",function(){return Vb});var k={};a.r(k);a.d(k,"PopulateDynamicHelper",function(){return Bc});var m={};a.r(m);a.d(m,"RibbonControlsManager",function(){return We});var d={};a.r(d);a.d(d,"OAuthManagerWrapper",function(){return Ga});var n={};a.r(n);var l={};a.r(l);a.d(l,"IndexedDB",
function(){return dc});var f=a(0),h=a(15),t=a(1377),u;(function(N){N[N.unknown=0]="unknown";N[N.supported=1]="supported";N[N.LZk=2]="userUnsupportedAnonymous";N[N.MZk=3]="userUnsupportedNoLoginHint";N[N.MQk=4]="hostUnsupported";N[N.kYk=5]="perfAutomation"})(u||(u={}));Object(f.b)("SupportStatus",u);var v;(function(N){N[N.external=0]="external";N[N.BRk=1]="msa";N[N.XOk=2]="aad"})(v||(v={}));Object(f.b)("AuthorityType",v);var y=a(857);class C{constructor(N){this.o2g=N}initialize(){return Promise.resolve(0)}fAc(){return Promise.resolve(0)}xD(){h.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new y.a,{IsSuccess:!0,Token:this.o2g}))}FRc(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bQc(){return!1}sJb(){return"MockAuthTokenStrategy"}}Object(f.a)(C,"MockAuthTokenStrategy",null,[225]);var x=a(1051);class w{static get(N,Da,fb){if(!fb)return N;
let Wb=0;return Promise.race([N,new Promise(Jc=>{Wb=window.setTimeout(()=>{Jc(Da)},fb)})]).then(Jc=>{window.clearTimeout(Wb);return Promise.resolve(Jc)}).catch(()=>{window.clearTimeout(Wb);return Promise.resolve(Da)})}}Object(f.a)(w,"PromiseWithTimeout",null,[]);var z=a(5),F=a(542);class J{constructor(N,Da,fb,Wb,Jc){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=N;this.scope=Da;this.silentLogin=fb;this.options=Wb;this.correlationId=Jc}}Object(f.a)(J,
"TokenRequestParameters",null,[235]);var R=a(35),I=a(81);class O{constructor(){this.EIe=null;let N=z.AFrameworkApplication.fa.Ta(z.AFrameworkApplication.K2),Da=z.AFrameworkApplication.fa.Ta(z.AFrameworkApplication.MIg);this.Y6a=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",N&&""!==N?N:"Unspecified",Da&&""!==Da?Da:"Unspecified")}initialize(){return new Promise(N=>{I.a.instance.We("Common.App.WopiIdentity.IWopiIdentity").execute(Da=>{this.EIe=Da;N(0)})})}yn(N){const Da=
["HTTPS:","API:"];let fb=!1;const Wb=N.toLocaleUpperCase();for(const Jc of Da)if(Wb.startsWith(Jc)){fb=!0;break}return fb||this.mXi(N)?N+"/.default":N}mXi(N){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(N)}fAc(){return Promise.resolve(0)}xD(N,Da,fb,Wb,Jc,md,sd){if(R.a.HFa){Jc=F.a.BKk;if(!Jc)return Da=Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Da);if(!Array.contains(Jc,
N))return Da=Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+N}),Promise.resolve(Da)}N=this.yn(fb);fb=new J(fb,N,!Wb,null,z.AFrameworkApplication.userSessionId);return this.EIe.getAccessToken(fb,Da,sd).then(Od=>Object.assign(new y.a,{IsSuccess:!0,Token:Od.accessToken}),Od=>Object.assign(new y.a,{IsSuccess:!1,ErrorCode:Od}))}FRc(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bQc(){return!1}sJb(){return this.Y6a}}
Object(f.a)(O,"ParentFrameTokenStrategy",null,[225]);var Y=a(954),K=a(200);class L{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Odg=this.GSe=null}}Object(f.a)(L,"PromiseWrapper",null,[]);class X{constructor(N){N=void 0===N?0:N;this.ZG=0;this.kwb=!1;this.Tr=new K.a;this._timeout=N}enqueue(N){return new Promise((Da,fb)=>{this.Tr.add(Object.assign(new L,{Odg:N,resolve:Da,reject:fb}));this.process()})}process(){if(this.kwb||this.ZG===this.Tr.count)return!1;const N=this.Tr.ka(this.ZG++);
try{this.kwb=!0,N.Odg().then(Da=>{this.kwb=!1;this.Mjd(N,Da,null,!0)}).catch(Da=>{this.kwb=!1;this.Mjd(N,null,Da,!1)})}catch(Da){this.kwb=!1,this.Mjd(N,null,Da,!1)}return!0}Mjd(N,Da,fb,Wb){if(Wb){const Jc=()=>{N.resolve(Da);this.process()};0<this._timeout?window.setTimeout(()=>{Jc()},this._timeout):Jc()}else{const Jc=()=>{N.reject(fb);this.process()};0<this._timeout?window.setTimeout(()=>{Jc()},this._timeout):Jc()}}}Object(f.a)(X,"PromiseQueue",null,[]);class T{constructor(){this.correlationId=this.resolve=
null}}Object(f.a)(T,"ResolveWithCorrelation",null,[]);var ba=a(137),Q=a(191),P=a(859),ka=a(175);class ia extends Q.a{constructor(N,Da,fb,Wb,Jc,md){super(!1,!1,!0);this.cse=this.g9=null;this.Oxj=()=>{this.gkf()};this.FHh=()=>this.Bx;this.Rek=sd=>{0===sd&&(this.F7g.reject(Object.assign(new y.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.KMa(null))};this.J3=N;this.U3g=fb;this.HA=Wb;this.F7g=Jc;this.KMa=md;this.Bx=document.createElement("iframe");this.Bx.id=
"SharedAuthInteractiveFrame";this.Bx.setAttribute("name","SharedAuthInteractiveFrame");this.Bx.setAttribute("title","SharedAuthInteractiveFrame");this.Bx.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.Bx.style.border="0";this.Bx.style.height="48px";this.Bx.style.width="190px";$addHandler(this.Bx,"error",this.Oxj);N=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.J3,Da,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",
z.AFrameworkApplication.userType);this.Bx.src=N;this.oYg=new Promise(sd=>{this.cse=sd});this.dse=!1}cOc(){this.g9={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.U3g,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.FHh,["resolveDialogStyles"]:this.cse}};this.Ye=5;this.initializeAndShow(CommonUIStrings.l_SignIn,this.Rek,this.g9)}a3a(N,Da,fb){N=void 0===N?!1:N;Da=void 0===Da?!1:Da;fb=void 0===fb?5:
fb;this.g9&&this.g9.bodyControls&&(N!==Object(ba.a)(Object,this.g9.bodyControls).frameLoaded&&(Object(ba.a)(Object,this.g9.bodyControls).frameLoaded=N),Da!==Object(ba.a)(Object,this.g9.bodyControls).frameLoadSuccess&&(Object(ba.a)(Object,this.g9.bodyControls).frameLoadSuccess=Da),fb!==this.g9.dialogButtonsOption&&(this.g9.dialogButtonsOption=null,this.Ye=fb),this.update(this.g9))}jmk(N,Da){const fb=new P.a(ka.a.Vek);fb.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,
["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:N,["dialogStyles"]:Da};this.HA.Bva(fb,this.Bx.contentWindow,this.J3)}gkf(){this.a3a(!0,!1,6)}get Xwg(){return this.Bx}get qRh(){return this.oYg.then(N=>{this.dse=!0;return N})}get rRh(){return this.dse}}Object(f.a)(ia,"SharedAuthConsentDialog",Q.a,[234]);var Ba=a(1046),va=a(112),W=a(194),S=a(55),da=a(185);class aa{}aa.kpiName="OAuthManager";Object(f.a)(aa,"OAuthManagerConstants",null,[]);class za{constructor(){this.Bx=null;this.F6b=0;
this.yvb=this.m7a=this.zWc=this.KMa=this.FR=this.BHe=null;this.Msj=()=>{const N=S.a.Yg()-this.F6b;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",N)};this.VDc=N=>{const Da=S.a.Yg()-this.F6b,fb=Object.assign({},{durationMs:Da});va.Health.instance.recordKpiFailure(aa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,fb);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Da,this.Wse?JSON.stringify(N):"")};this.exj=N=>{const Da=
this.lza.loadFrame;var fb=S.a.Yg()-Da.startTime,Wb=N.Values.AuthLibrary.toString();N=N.Values.Success.toString();h.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",N,Wb,fb);Wb&&(this.Y6a="SharedAuthTokenStrategy "+Wb);Wb=Boolean.parse(N);Wb||(N=W.a.fu(),void 0!==N&&null!==N&&(N.set("AuthLibrary",this.sJb()),fb=Object.assign({},{durationMs:fb,extendedProperties:N}),va.Health.instance.recordKpiFailure(aa.kpiName,"SharedAuthStrategyInitFailed",
!1,!0,fb)));Da.resolve(Wb?0:1)};this.dxj=N=>{if(N.Values.interactive&&this.m7a&&this.m7a.Values.messageCorrelationId){const fb=this.m7a.Values.messageCorrelationId.toString();if(N.Values.interactive&&this.FR){this.FR.qRh.then(Wb=>{this.HA.Bva(this.m7a,this.FR.Xwg.contentWindow,this.J3);this.FR.jmk(fb,Wb);this.FR.a3a(!0,!0);this.m7a=null});return}}N=this.lza.initFrame;const Da=S.a.Yg()-N.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Da);N.resolve(0)};
this.ksj=N=>{if(N.Values.messageCorrelationId&&N.Values.messageCorrelationId.toString()){var Da=N.Values.messageCorrelationId.toString(),fb=this.lza[Da];if(fb){var Wb=S.a.Yg()-fb.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Wb);N.Values.isSuccess&&N.Values.isSuccess?fb.resolve(N.Values.response):fb.reject(N.Values.response);this.pIg(Da)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.jtj=()=>{if(this.FR.rRh)this.FR.gkf();else if(this.zWc&&this.FR){const N=new P.a(ka.a.$wg);N.Values=this.aSe(this.zWc,!0);this.HA.Bva(N,this.FR.Xwg.contentWindow,this.J3)}};this.Gsj=()=>{this.FR&&this.FR.Aeb()};this.Xmj=N=>{N.Values.cancelled&&N.Values.cancelled&&N.Values.messageCorrelationId&&this.pIg(N.Values.messageCorrelationId.toString());this.FR&&this.FR.hide()};this.cuj=N=>{if(N.Values.messageCorrelationId&&
N.Values.messageCorrelationId.toString()){var Da=this.lza[N.Values.messageCorrelationId.toString()];if(Da){var fb=S.a.Yg()-Da.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",fb);N.Values.isSuccess&&N.Values.isSuccess?Da.resolve(N.Values.response):Da.reject(N.Values.response)}else h.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,3E3,10,
"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.HA=new Ba.a(null,null);this.Y6a="SharedAuthTokenStrategy Unloaded";this.J3=F.a.Tek;this.zFe=F.a.Sek;this.Wse=F.a.enableConsoleLogging;this.JYg=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.b6g=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.U7g=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",
!1);this.lza={};this.e0g=new X(1500)}sJb(){return this.Y6a}initialize(){if("loadFrame"in this.lza)return this.lza.loadFrame.GSe;if(!this.J3)return va.Health.instance.recordKpiFailure(aa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const N=this.EPc("loadFrame");this.F6b=S.a.Yg();var Da=this.J3+this.zFe+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+
z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.U7g&&(Da+="&webworker=1");this.Bx=document.createElement("iframe");this.esa(this.Bx);this.Bx.style.cssText="height:0;width:0;display:none;";this.Bx.id="SharedAuthFrame";this.Bx.setAttribute("name","SharedAuthFrame");this.Bx.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.Bx.setAttribute("title","SharedAuthFrame");this.Bx.src=Da;document.body.appendChild(this.Bx);Da=S.a.Yg()-
this.F6b;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Da,this.Bx.src);return N}fAc(N){this.zWc=N;const Da=new P.a(ka.a.$wg);Da.Values=this.aSe(N);N=this.EPc("initFrame");this.HA.Bva(Da,this.Bx.contentWindow,this.J3);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return N}xD(N,Da,fb,Wb,Jc,md){const sd=new P.a(ka.a.Wek),Od=this.itf();sd.Values=this.YHg(N,Da,fb,Wb,
Jc,md,Od);N=this.EPc(Od);Wb&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.e0g.enqueue(()=>new Promise(Ce=>{this.Azk(md,sd,Ce,Od)})):(this.HA.Bva(sd,this.Bx.contentWindow,this.J3),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Da));return N}Azk(N,Da,fb,Wb){const Jc=this.lza[Wb];Jc&&(this.m7a=Da,this.KMa=Object.assign(new T,{resolve:fb,correlationId:Wb}),this.FR=new ia(this.J3,
this.zFe,N,this.HA,Jc,fb),this.FR.cOc())}itf(){return da.a.create().toString()}YHg(N,Da,fb,Wb,Jc,md,sd){const Od={};Od.appName=N;Od.appId=Da;Od.target=fb;Od.withPopup=Wb;Od.claims=Jc;Od.promptMessage=md;Od.messageCorrelationId=sd;return Od}esa(N){$addHandler(N,"load",this.Msj);$addHandler(N,"error",this.VDc);this.HA.kZ(this.J3);this.HA.rp(ka.a.cxg);this.HA.Dn(ka.a.cxg,this.exj);this.HA.rp(ka.a.bxg);this.HA.Dn(ka.a.bxg,this.dxj);this.HA.rp(ka.a.Ywg);this.HA.Dn(ka.a.Ywg,this.ksj);this.HA.rp(ka.a.dxg);
this.HA.Dn(ka.a.dxg,this.cuj);this.HA.rp(ka.a.axg);this.HA.Dn(ka.a.axg,this.jtj);this.HA.rp(ka.a.Zwg);this.HA.Dn(ka.a.Zwg,this.Gsj);this.HA.rp(ka.a.Wwg);this.HA.Dn(ka.a.Wwg,this.Xmj)}EPc(N){const Da=new L;Da.startTime=S.a.Yg();const fb=new Promise((Wb,Jc)=>{Da.resolve=Wb;Da.reject=Jc});Da.GSe=fb;this.lza[N]=Da;return fb}aSe(N,Da){Da=void 0===Da?!1:Da;const fb={};fb.appIds=this.Vgi();fb.upn=N.loginHint;fb.authority=N.authority;fb.authorityType=Object(t.a)(v,N.authorityType);fb.tenantId=N.tenantId;
fb.correlationId=z.AFrameworkApplication.userSessionId;fb.enableConsoleLogging=this.Wse;fb.enablePopupFlash=this.JYg;fb.skipUpnCheck=this.b6g;fb.interactive=Da;return fb}Vgi(){const N=[],Da=F.a.Xcd;for(const Wb in Da){var fb=Da[Wb];Array.contains(N,fb)||Array.add(N,fb)}return N}FRc(N,Da,fb,Wb,Jc,md){const sd=new P.a(ka.a.Uek),Od=this.itf();sd.Values=this.YHg(N,Da,fb,Wb,Jc,md,Od);this.BHe=sd;N=this.EPc(Od);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
Da);this.Bjk();return N}bQc(){return!0}Bjk(){this.yvb||(this.yvb=new Y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.yvb.id=16,this.yvb.qJd=!1,this.yvb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.HA.Bva(this.BHe,this.Bx.contentWindow,this.J3)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),h.ULS.sendTraceTag(555049438,
3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}pIg(N){this.KMa&&this.KMa.correlationId===N&&(this.KMa.resolve(null),this.KMa=null)}}Object(f.a)(za,"SharedAuthTokenStrategy",null,[225]);class qa{constructor(N){this.l6c=N;this.Y6a="UnsupportedAuthTokenStrategy Reason="+u[this.l6c]}initialize(){return Promise.resolve(0)}fAc(){return Promise.resolve(0)}xD(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:u[this.l6c],ErrorMessage:"Unable to get a token. Reason: ["+
u[this.l6c]+"]"}))}FRc(){return Promise.resolve(Object.assign(new y.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}bQc(){return!1}sJb(){return this.Y6a}}Object(f.a)(qa,"UnsupportedAuthTokenStrategy",null,[225]);var ta=a(810),Xa=a(367);class oa{constructor(N){N=void 0===N?null:N;this.xL=0;this.iR=null;this.A4g=0;this.cxe=!!window.location.search.match(RegExp("wdpa=1","gi"));const Da=
S.a.Yg();this.U_g=this.zQh(N).then(fb=>fb?this.ELi():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.Wx(),Math.floor(S.a.Yg()-Da)),fb=W.a.fu(),void 0!==fb&&null!==fb&&(fb.set("AuthLibrary",this.Wx()),fb=Object.assign({},{durationMs:Math.floor(S.a.Yg()-Da),extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"StrategyPickFailed",!1,!0,fb)),Promise.resolve(1))).then(fb=>0!==fb?Promise.resolve(fb):
this.B7i())}AQh(){if(this.cxe)this.xL=5,this.iR=new qa(this.xL);else{var N=F.a.Cfj;N&&0<N.length?(this.xL=1,this.iR=new C(N)):z.AFrameworkApplication.fa.la("IsO365ConsumerHost")||z.AFrameworkApplication.fa.la("IsO365CommercialHost")?z.AFrameworkApplication.fa.la("IsAnonymousUser")?(this.xL=2,this.iR=new qa(this.xL)):(N=x.a.getAuthContext().loginHint)&&N.length?F.a.IKb?(this.xL=1,this.iR=new O):(this.xL=1,this.iR=new za):(this.xL=3,this.iR=new qa(this.xL)):(this.xL=4,this.iR=new qa(this.xL))}}Wx(){return this.iR?
this.iR.sJb()||"Unknown":"None"}zQh(N){N=void 0===N?null:N;h.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Da=S.a.Yg();return z.AFrameworkApplication.fa.gyd().then(fb=>{fb?(this.AQh(),N&&(this.iR=N),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",F.a.clientVersion,F.a.appVersion,F.a.JTh,this.Wx(),Math.floor(S.a.Yg()-Da))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(S.a.Yg()-Da));return Promise.resolve(fb)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(S.a.Yg()-Da));return Promise.resolve(!1)})}ELi(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.Wx());const N=S.a.Yg();return w.get(this.iR.initialize(),2,F.a.j0d).then(Da=>{if(0===Da)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.Wx(),Math.floor(S.a.Yg()-N));else if(1===Da){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.Wx(),Math.floor(S.a.Yg()-N));var fb=W.a.fu();void 0!==fb&&null!==fb&&(fb.set("AuthLibrary",this.Wx()),fb=Object.assign({},{durationMs:Math.floor(S.a.Yg()-N),extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"StrategyInitFailed",!1,!0,fb))}else 2===Da&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.Wx(),Math.floor(S.a.Yg()-N)),fb=W.a.fu(),void 0!==fb&&null!==fb&&(fb.set("AuthLibrary",this.Wx()),fb=Object.assign({},{durationMs:Math.floor(S.a.Yg()-N),extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"StrategyInitTimedOut",!1,!0,fb)));return Promise.resolve(Da)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Wx(),Math.floor(S.a.Yg()-N));return Promise.resolve(1)})}B7i(){h.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.Wx());const N=S.a.Yg();return w.get(this.iR.fAc(x.a.getAuthContext()),2,F.a.j0d).then(Da=>{if(0===Da)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.Wx(),Math.floor(S.a.Yg()-N));else if(1===Da){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Wx(),Math.floor(S.a.Yg()-N));var fb=W.a.fu();void 0!==fb&&null!==fb&&(fb.set("AuthLibrary",this.Wx()),fb=Object.assign({},{durationMs:Math.floor(S.a.Yg()-
N),extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"StrategyLoadFailed",!1,!0,fb))}else 2===Da&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.Wx(),Math.floor(S.a.Yg()-N)),fb=W.a.fu(),void 0!==fb&&null!==fb&&(fb.set("AuthLibrary",this.Wx()),fb=Object.assign({},{durationMs:Math.floor(S.a.Yg()-N),extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"StrategyLoadTimedOut",!1,!0,fb)));
return Promise.resolve(Da)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Wx(),Math.floor(S.a.Yg()-N));return Promise.resolve(1)})}xD(N,Da,fb,Wb){return this.DRc(N,Da,!1,Wb,"",void 0===fb?null:fb)}ZHg(N,Da,fb,Wb,Jc){return this.DRc(N,Da,!0,fb,Wb,void 0===Jc?null:Jc)}DRc(N,Da,fb,Wb,Jc,md,sd){sd=void 0===sd?0:sd;sd+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
N,this.g0a(N,Da),this.Wx(),sd);var Od=W.a.fu();void 0!==Od&&null!==Od&&(Od.set("AuthLibrary",this.Wx()),Od.set("AppName",N),Od.set("Target",this.g0a(N,Da)),va.Health.instance.recordKpiUsage(aa.kpiName,Xa.b.FailureBased,"WacOAuthFC",Od));if(!F.a.isEnabled||this.cxe){var Ce;return this.SOd((Ce=new y.a,Ce.IsSuccess=!1,Ce.Token=null,Ce.ErrorCode="NotEnabled",Ce.ErrorMessage="OAuthManager is disabled.",Ce),N)}const Qe=F.a.Xcd[N];if(void 0===Qe||null===Qe){h.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
N);var lf;return this.SOd((lf=new y.a,lf.IsSuccess=!1,lf.Token=null,lf.ErrorCode="DisallowedApp",lf.ErrorMessage="Disallowed appName: "+N,lf),N)}const Oe=S.a.Yg();let ag=Oe;const xg=this;Od=this.U_g.then(cc=>{ag=S.a.Yg();return xg.SRi(N,Qe,Da,fb,Wb,Jc,md,cc)});Ce=fb?0:F.a.j0d;let Yf;lf=(Yf=new y.a,Yf.IsSuccess=!1,Yf.Token=null,Yf.ErrorCode="authTokenStrategy_timeout",Yf.ErrorMessage="Auth Strategy timed out after ["+Ce+"] ms when fetching token",Yf);const Wa=this,vb=this;return w.get(Od,lf,Ce).then(cc=>
sd<=oa.fej&&(cc.ErrorCode===oa.UFg||cc.ErrorCode===oa.drk)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",sd,Math.floor(S.a.Yg()-Oe)),Wa.DRc(N,Da,fb,Wb,Jc,md,sd)):cc.ErrorCode===oa.mMf&&!fb&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",sd,oa.M$e),oa.ZWh&&Wa.iR.bQc()&&Wa.iR.FRc(N,Qe,Da,fb,Wb,Jc).then(Ic=>Promise.resolve(Wa.AAc(Ic,N,Da,Qe,Oe,ag))).catch(()=>{let Ic;const dd=
(Ic=new y.a,Ic.IsSuccess=!1,Ic.Token=null,Ic.ErrorCode="authTokenStrategy_failure",Ic.ErrorMessage="LoginPopup failed, GetToken could not be called",Ic);return Promise.resolve(Wa.AAc(dd,N,Da,Qe,Oe,ag))}),oa.M$e)?Wa.DRc(N,Da,!0,Wb,Jc,md,sd):Promise.resolve(Wa.AAc(cc,N,Da,Qe,Oe,ag))).catch(()=>{let cc;const Ic=(cc=new y.a,cc.IsSuccess=!1,cc.Token=null,cc.ErrorCode="authTokenStrategy_failure",cc.ErrorMessage="Auth Strategy failed with an unknown error",cc);return Promise.resolve(vb.AAc(Ic,N,Da,Qe,Oe,
ag))})}SRi(N,Da,fb,Wb,Jc,md,sd,Od){return 1===Od||2===Od?this.SOd(Object.assign(new y.a,{IsSuccess:!1,Token:null,ErrorCode:1===Od?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),N):this.iR.xD(N,Da,fb,Wb,Jc,md,sd).then(Ce=>Promise.resolve(this.bXf(Ce,!0,N))).catch(Ce=>Promise.resolve(this.bXf(Ce,!1,N)))}AAc(N,Da,fb,Wb,Jc,md){const sd={},Od=S.a.Yg()-md;sd.IsSuccess=N.IsSuccess;sd.ErrorCode=N.IsSuccess?"Success":N.ErrorCode||"";sd.ErrorMessage=N.IsSuccess?"Success":
this.g0a(Da,N.ErrorMessage||"");sd.Target=this.g0a(Da,fb||"");sd.TimeInMS=Math.floor(Od);sd.LoadTimeInMS=Math.floor(md-Jc);sd.AuthLibrary=this.Wx();sd.AppName=Da;sd.AuthorityType=Object(t.a)(v,x.a.spc());sd.UserType=this.RAi(x.a.getAuthContext());sd.IsAuthSupportedInSession=u[this.xL];sd.RequestCount=++this.A4g;sd.AppId=Wb;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(sd));N.IsSuccess||(fb=W.a.fu(),void 0!==fb&&null!==fb&&(fb.set("AppName",Da),fb.set("AuthLibrary",this.Wx()),fb.set("ErrorCode",
N.ErrorCode),fb.set("ErrorMessage",this.g0a(Da,N.ErrorMessage)),Da=Object.assign({},{durationMs:Od,extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"TryGetTokenFailure",!1,!0,Da)));return N}SOd(N,Da){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Da,this.g0a(Da,N.ErrorMessage));const fb=W.a.fu();void 0!==fb&&null!==fb&&(fb.set("AppName",Da),fb.set("AuthLibrary",this.Wx()),fb.set("ErrorCode",N.ErrorCode),fb.set("ErrorMessage",
this.g0a(Da,N.ErrorMessage)),Da=Object.assign({},{extendedProperties:fb}),va.Health.instance.recordKpiFailure(aa.kpiName,"FailureBeforeGetToken",!1,!0,Da));return Promise.resolve(N)}KGf(N){return N===ta.a.OQc}g0a(N,Da){return this.KGf(N)&&Da?"REDACTED":Da}RAi(N){return z.AFrameworkApplication.fa.la("IsAnonymousUser")?"anonymous":!N.loginHint||1>N.loginHint.length?"empty":-1<N.loginHint.indexOf("guest#")?"guest":-1<N.loginHint.indexOf("ext#")?"external":0>N.upn.indexOf("@")?"no-at":"supported"}qVa(){return 1===
this.xL}bXf(N,Da,fb){let Wb=null,Jc=null,md=null,sd=null;N?N.ErrorCode||N.ErrorMessage?(Jc=N.ErrorCode?N.ErrorCode:oa.zgf,md=N.ErrorMessage?N.ErrorMessage:"No message"):N.Token?Da?Wb=N.Token:(Jc=oa.eSj,md="A rejected promise returned a token."):(Jc=oa.zgf,md=JSON.stringify(N)):(Jc=oa.Zhj,md="No result came from Auth Token Strategy");N&&N.Telemetry&&!this.KGf(fb)&&(sd=N.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(sd)));if(Jc===oa.Lfj||Jc===oa.mwk)Jc=oa.UFg,md="Auth Library Timed Out";
Jc===oa.imh&&-1<md.indexOf(oa.z8g)&&(Jc=oa.mMf);if(Jc||md)Wb=null;return Object.assign(new y.a,{IsSuccess:!!Wb,Token:Wb,ErrorCode:Jc,ErrorMessage:md,Telemetry:sd})}static get M$e(){return z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get ZWh(){return z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}oa.mwk="token_renewal_error";oa.zgf="Exception";oa.Zhj="NoResult";
oa.eSj="RejectToken";oa.Lfj="monitor_window_timeout";oa.UFg="Timeout";oa.drk="authTokenStrategy_timeout";oa.imh="login_required";oa.z8g="AADSTS50058";oa.mMf="Cookies Disabled";oa.fej=2;Object(f.a)(oa,"OAuthManager",null,[186]);var ha=a(262),Za=a(44),Fa=a(77),La=a(104),xa=a(111);class db{get name(){return"Common.App.OAuth.OAuthPackage"}dl(N){N.register(186,"Common.App.OAuth.IOAuthManager").If().Rf(()=>new oa)}init(){const N=I.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.jAk(N);this.iAk(N)}iAk(N){if(z.AFrameworkApplication.fa&&
z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Da=z.AFrameworkApplication.fa.Ta("FileSource");if(z.AFrameworkApplication.fa.la("IsO365ConsumerHost")||z.AFrameworkApplication.fa.la("IsO365CommercialHost")||"WopiTest"===Da){var fb=F.a.pDb;if(fb&&fb.IsEnabled){var Wb=fb.Application,Jc=F.a.authority;if(void 0!==Wb&&null!==Wb&&Wb.length&&void 0!==Jc&&null!==Jc&&Jc.length){var md=u[N.xL],sd=R.a.J$,Od=N.Wx();Jc=JSON.stringify({ZOk:{["xms_cc"]:{values:["cp1"]}}});
var Ce=S.a.Yg();N.xD("CAETest",Wb,null,Jc).then(Qe=>{const lf=Math.floor(S.a.Yg()-Ce);md=u[N.xL];sd=R.a.J$;Od=N.Wx();h.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',lf,Qe.IsSuccess,md,Qe.ErrorCode,Da,sd,Od);if(Qe.IsSuccess){Qe="Bearer "+Qe.Token;var Oe=fb.Endpoint;if(Oe){var ag=S.a.Yg();Qe={["Authorization"]:Qe};var xg=new xa.a;xg.add("EnforceCAE",
"1");xg.add("IsCAEToken","1");Oe=Fa.a.Iah(Oe,xg);z.AFrameworkApplication.lg.O7a(Oe,1,null,Qe,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Yf=>{var Wa,vb=Math.floor(S.a.Yg()-ag),cc=null;Yf.Uk?Yf="Canceled":Yf.vj?Yf="Faulted":(cc=Yf.result,Yf=cc.succeeded?"Completed":"Failed");vb={["TaskResult"]:Yf,["BrowserTokenDurationMS"]:lf,["BrowserValidationDurationMS"]:vb};cc&&(vb.HttpStatus=cc.ll.data.httpStatus,cc.succeeded&&(cc=Za.a(cc.ll.data.responseData),vb.ServerValidationDurationMS=
cc.ElapsedMilliseconds,vb.ServerValidationResult=cc.ValidatedToken,vb.KMSI=cc.KMSI,vb.Scopes=cc.Scopes,vb.TokenExpirationS=Math.floor(parseInt(cc.Expiration)-(new Date).getTime()/1E3),vb.ClaimChallenge=null===(Wa=cc.ClaimChallenge)||void 0===Wa?void 0:Wa.length));h.ULS.sendTraceTag(508950354,3E3,"Completed"===Yf?50:15,La.a.toJSON(vb))})}}else h.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",Qe.ErrorCode,Qe.ErrorMessage)}).catch(Qe=>{const lf=Math.floor(S.a.Yg()-
Ce);h.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",Qe.toString(),lf)})}}}}}jAk(N){const Da=z.AFrameworkApplication.fa.Ta("FileSource");if(z.AFrameworkApplication.fa.la("IsO365ConsumerHost")||z.AFrameworkApplication.fa.la("IsO365CommercialHost")||"WopiTest"===Da){var fb=F.a.pDb;if(fb&&fb.IsEnabled){var Wb=fb.Application,Jc=F.a.authority;if(void 0!==Wb&&null!==Wb&&Wb.length&&void 0!==Jc&&null!==Jc&&Jc.length){var md=u[N.xL],sd=R.a.J$,Od=N.Wx();try{var Ce=new Map;void 0!==
Ce&&null!==Ce?(Ce.set("SupportStatus",md),Ce.set("Browser",sd),Ce.set("AuthStrategy",Od)):Ce=null}catch(lf){Ce=null}va.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Ce);var Qe=S.a.Yg();N.xD("Core",Wb).then(lf=>{const Oe=Math.floor(S.a.Yg()-Qe);md=u[N.xL];sd=R.a.J$;Od=N.Wx();h.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Oe,lf.IsSuccess,md,lf.ErrorCode,Da,sd,Od);Ce&&(Ce.set("SupportStatus",md),Ce.set("Browser",sd),Ce.set("AuthStrategy",Od));var ag=Object.assign({},{durationMs:Oe,extendedProperties:Ce});if(lf.IsSuccess){if(va.Health.instance.recordKpiSuccess("WacCorePFT",ag),ag="Bearer "+lf.Token,z.AFrameworkApplication.lg.B3a=ag,z.AFrameworkApplication.lg.uma=lf.Telemetry&&lf.Telemetry.expiresOn?1E3*(lf.Telemetry.expiresOn-60):null,lf=fb.Endpoint){var xg=S.a.Yg();z.AFrameworkApplication.lg.O7a(lf,1,null,{["Authorization"]:ag},
"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Yf=>{var Wa=Math.floor(S.a.Yg()-xg),vb=null;Yf.Uk?Yf="Canceled":Yf.vj?Yf="Faulted":(vb=Yf.result,Yf=vb.succeeded?"Completed":"Failed");Wa={["TaskResult"]:Yf,["BrowserTokenDurationMS"]:Oe,["BrowserValidationDurationMS"]:Wa};vb&&(Wa.HttpStatus=vb.ll.data.httpStatus,vb.succeeded&&(vb=Za.a(vb.ll.data.responseData),Wa.ServerValidationDurationMS=vb.ElapsedMilliseconds,Wa.ServerValidationResult=vb.ValidatedToken,Wa.KMSI=vb.KMSI,Wa.Scopes=
vb.Scopes,Wa.TokenExpirationS=Math.floor(parseInt(vb.Expiration)-(new Date).getTime()/1E3),z.AFrameworkApplication.lg.uma=vb.Expiration?1E3*(parseInt(vb.Expiration)-60):null));h.ULS.sendTraceTag(520632322,3E3,"Completed"===Yf?50:15,La.a.toJSON(Wa))})}}else va.Health.instance.recordKpiFailure("WacCorePFT",lf.ErrorCode,!1,!1,ag)}).catch(lf=>{var Oe=Math.floor(S.a.Yg()-Qe);Oe=Object.assign({},{durationMs:Oe,extendedProperties:Ce});va.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+
lf.toString(),!1,!1,Oe)})}}}}dispose(){}static main(){ha.a.instance.Ul(new db)}}Object(f.a)(db,"OAuthPackage",null,[4,5]);var bb=a(531),kb=a(11),Rb=a(299),zb=a(41),nc=a(307),Zb=a(234);class Sa{}Sa.Xcf="ewa-svg-icon";Object(f.a)(Sa,"CssClassNames",null,[]);var Na=a(14),Ea=a(401),Aa=a(146),Ka=a(8),nb=a(1),Qb=a(809);class jb{constructor(N){this.el=()=>{this.ZOf();this.$.ea.cq(this.el)};this.$=N;this.dEg={};this.rfe={};const Da=this.iqf("excelInitialAppSprite");Da?(this.ELe(Da),this.$.ea.ei?this.ZOf():
N.ea.zm(this.el),this.$.ja.$c(388,this)):h.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.rfe=null;this.$.ea.cq(this.el)}iUa(N,Da,fb,Wb){fb=void 0===fb?null:fb;Wb=void 0===Wb?null:Wb;let Jc;(Jc=this.rfe[N])||(this.rfe[N]=Jc=this.cDj(this.dEg[N]));if(!Jc)return h.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${N} was not found in loaded SVG sprites.`),null;const md=Jc.cloneNode(!0);if(!md.style){const sd=Ea.b(Jc),Od=Ea.b(md),
Ce={};Ce.iconId=N;Ce.isOriginalNodeStyleNull=void 0===Jc.style||null===Jc.style;Ce.isOriginalNodeCurrentStyleNull=void 0===Jc.currentStyle||null===Jc.currentStyle;Ce.isClonedNodeCurrentStyleNull=void 0===md.currentStyle||null===md.currentStyle;Ce.originalNode=sd.substring(0,sd.indexOf(">")+1);Ce.clonedNode=Od.substring(0,Od.indexOf(">")+1);h.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(Ce)}`)}md.setAttribute("style",`height: ${Da}px; width: ${Da}px;`);
Wb&&(N=document.createElement("title"),N.textContent=Wb,md.insertBefore(N,md.childNodes[0]));if(fb)for(const sd of fb)Sys.UI.DomElement.addCssClass(md,sd);return md}Lia(N,Da,fb,Wb,Jc,md,sd,Od){Jc=void 0===Jc?0:Jc;md=void 0===md?0:md;sd=void 0===sd?null:sd;Od=void 0===Od?null:Od;Jc&&md||(md=Na.DOMElementExtensions.getBoundingClientRect(Wb),Jc=md.height,md=md.width);if(sd=this.iUa(N,Da,sd,Od))Wb.appendChild(sd),(Wb=Na.DOMElementExtensions.hba(sd,"style",null))?sd.setAttribute("style",Wb+` margin: ${(Jc-
Da)/2}px ${(md-fb)/2}px;`):h.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${N}`);return sd}ZOf(){nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?void Object(Qb.a)("excel-uiSlice20-sprite",{Aa:0}).then(()=>this.DLe()):void Aa.a.resolve(Ka.hb,{Aa:0}).then(N=>N("excel-uiSlice20-sprite")).then(()=>this.DLe())}DLe(){const N=this.iqf("excelUiSlice20Sprite");N?this.ELe(N):h.ULS.sendTraceTag(537151259,
0,15,"window[excelUiSlice20Sprite].icons returned null.")}ELe(N){for(const Da of N)Da.type===Zb.a.pfe&&(this.dEg[Da.id]=Da)}cDj(N){if(!N)return null;const Da=N.viewBox;N=N.children;const fb=document.createElementNS(nc.a.sfe,Zb.a.pfe);Sys.UI.DomElement.addCssClass(fb,Sa.Xcf);fb.setAttribute("focusable","false");fb.setAttribute("viewBox",Da);this.Nbh(fb,N);return fb}Nbh(N,Da){for(const Wb of Da){const Jc=document.createElementNS(nc.a.sfe,Wb.type);for(const md in Wb){Da=md;var fb=Wb[md];"className"===
Da?Jc.setAttribute("class",fb):Jc.setAttribute(Da,fb)}N.appendChild(Jc)}}iqf(N){return(N=window[N])?N.icons:null}}Object(f.a)(jb,"SvgIconProvider",null,[698,2]);var qb=a(94);class ab extends Rb.a{constructor(N){super();this.$=N;this.Dg()}create(){const N=[this.I7i()];zb.TaskExtensions.Ca(zb.TaskExtensions.Dh(N,this.$.qa),()=>{window.excelInitialAppSprite?this.Df(this.$.ja.Qa(388)||new jb(this.$)):h.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.qa,3)}I7i(){return nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?
Object(qb.d)(Object(Qb.a)("excel-app-intl",{Aa:this.$a})):Object(qb.d)(Aa.a.resolve(Ka.hb,{Aa:this.$a}).then(N=>Lo(function*(){return N("excel-app-intl")})))}static ta(N){N.ja.$c(387,new ab(N))}}Object(f.a)(ab,"SvgIconProviderFactory",Rb.a,[]);var xb=a(793),Tb=a(68),Cc=a(201),lb=a(64);class Ya{constructor(N){this.EUh=N}Uf(){return!1}executeCommand(N,Da){N=Da.command;Da=null;switch(N){case 1243860697:this.EUh.fwk();break;default:Da=Cc.a(N)}return Da||lb.Task.Ra(!0)}Kf(N,Da){return 1243860697===Da.command}Yf(){return!1}}
Object(f.a)(Ya,"SheetDropdownMenuCommandHandler",null,[165]);class Hb extends xb.a{constructor(N){super(N)}lj(){void Aa.a.resolve(Ka.pd,{Aa:this.$a}).then(()=>{zb.TaskExtensions.Ca(nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)?Object(qb.d)(Aa.a.resolve(Ka.Qd,{Aa:this.$a})):Tb.GetServiceTaskFactory.vf(this.$.ja,32,33,this.$a),N=>{this.Gi([new Ya(N.result.efk)])},this.$.qa)})}static ta(N){xb.a.Kk(392,new Hb(N))}}Object(f.a)(Hb,"SheetDropdownMenuCommandHandlerFactory",
xb.a,[]);var Lb=a(6),qc=a(89),mc=a(304),Ta=a(16),Va=a(98),Db=a(48),Ca=a(283),cb=a(188),hb=a(150),ya=a(334),Pa=a(13),wb=a(42);class Ib{constructor(){this.I7e=new wb.a(!0);this.aZc=0}get sod(){return this.aZc}get navigationButtonsDisabled(){return!!(this.sod&1)}get operationButtonsDisabled(){return!!(this.sod&2)}Mjh(N,Da){this.I7e.add(N,Da);this.kY()}kY(){this.aZc=0;wb.a.forEach(this.I7e.$w,N=>{this.aZc=this.sod|N.value})}}Object(f.a)(Ib,"SheetTabBarDisabledStateManager",null,[]);var pb=a(253),xc=a(34);
class ua{}ua.S2h="ewa-stb-uir";ua.E2h="ewa-stb-navarea";ua.F2h="ewa-stb-navarea-dimensions";ua.H2h="ewa-stb-navbutton";ua.L4="cui-disabled";ua.G2h="ewa-stb-navareaextra";ua.zBa="cui-img-container";ua.y2h="ewa-stb-contentarea";ua.Pcf="ewa-stb-left-scrollable";ua.Ucf="ewa-stb-right-scrollable";ua.Q2h="ewa-stb-tabarea";ua.P2h="ewa-stb-sheettabmoveindicator";ua.Wcf="ewa-stb-tabs";ua.Csk="tab-active";ua.Ksk="tab-inactive";ua.Jsk="tab-hover";ua.R2h="ewa-stb-tabs-ghost";ua.Esk="tab-anchor-text";ua.dark=
"dark";ua.light="light";ua.Dsk="tab-active-text";ua.Hsk="tab-content-container";ua.Msk="tab-text";ua.J2h="ewa-stb-nsv-inactive-svg";ua.I2h="ewa-stb-nsv-active-svg";ua.G1h="ewa_nsv_margin";ua.z2h="ewa-stb-disable-scrollbar";ua.H6i="leave-size-fixed-on-tab-hover-old";ua.G6i="leave-size-fixed-on-tab-hover";ua.Qcf="ewa-stb-locked-sheet-svg-16px";ua.A2h="ewa-stb-dropdown-menu-button";ua.rZh="ewa-active-sheet-menu-item";Object(f.a)(ua,"CssClassNames",null,[]);var U=a(873),na=a(18),ob=a(280),bc=a(96),oc=
a(204),Yb=a(27),Fc=a(263),ld=a(50),qd=a(306),fe=a(58),ge=a(75),Wd=a(285),Zd=a(12),ke=a(114),ne=a(371),se=a(19),Cb=a(133),ib=a(397),ac=a(391),Lc=a(47),ad=a(266),te=a(99);class Ma extends pb.a{constructor(N,Da,fb){fb=void 0===fb?!1:fb;super(N);this.FUb=this.cQa=null;this.$=Da;this.m3=fb}get disabled(){return this.m3}dispose(){this.FUb=this.cQa=this.$=null;super.dispose()}fY(N){this.m3=N;this.domElement.setAttribute(Lb.a.DPa,N.toString());Na.DOMElementExtensions.toggleCssClass(this.domElement,U.a.L4,
N)}}Object(f.a)(Ma,"SheetBarButton",pb.a,[]);var V=a(805);class fa extends Ma{constructor(N,Da,fb,Wb){Wb=void 0===Wb?!1:Wb;super(document.createElement("a"),Da,Wb);this.Hg=Jc=>{this.disabled||(se.h(this.$).Nea.navigationStart("insert-sheet"),this.$.Lf(-1935155518,Jc.Te,30,null));return!0};this.hk=()=>{this.fY(!0)};this.Yi=()=>{se.h(this.$).cellTextEditBox.De||this.fY(!1)};this.cQa=fb.Ee(this.domElement,Pa.a.instance.ia(509),0,fa.dQa,Pa.a.instance.ia(510),V.a.Fjd,Wb);N.appendChild(this.domElement);
this.tg.ta("contextmenu",Jc=>{ge.g(Jc)});ad.a.instance.va(Ta.a.click,this.domElement,this.Hg);this.RWa=hb.KeyInputManager.instance.vQ(this.domElement,this.Hg,te.a.So,te.a.N8);se.h(this.$).cellTextEditBox.jr(this.hk);se.h(this.$).cellTextEditBox.q$(this.Yi)}dispose(){ad.a.instance.Da(Ta.a.click,this.domElement,this.Hg);hb.KeyInputManager.instance.AU(this.domElement,this.RWa);se.h(this.$)&&se.h(this.$).cellTextEditBox&&(se.h(this.$).cellTextEditBox.$q(this.hk),se.h(this.$).cellTextEditBox.Xua(this.Yi));
super.dispose()}fY(N){const Da=fa.Lxg(this.$);super.fY(N||Da)}static Lxg(N){return!N.isEditMode||!N.sa.count}}fa.dQa=na.a.srd;Object(f.a)(fa,"InsertSheetButton",Ma,[]);class ub extends Ma{constructor(N,Da,fb){super(document.createElement("a"),Da);this.Hg=Wb=>{this.$.Lf(-684145703,Wb.Te,0,null);return!0};this.j4f=Wb=>{Zd.HelperMethods.Wvk(this.BUe,ub.dQa,ub.dQa+Lb.a.MAf,("mouseover"===Wb.type||"focus"===Wb.type)&&!se.h(this.$).inRangePicker)};this.$=Da;this.BUe=fb.Ee(this.domElement,Pa.a.instance.ia(511),
0,ub.dQa,Pa.a.instance.ia(512),V.a.Fjd);N.appendChild(this.domElement);this.tg.ta("contextmenu",Wb=>{ge.g(Wb)});this.tg.ta("mouseover",this.j4f);this.tg.ta("mouseout",this.j4f);ad.a.instance.va(Ta.a.click,this.domElement,this.Hg);this.RWa=hb.KeyInputManager.instance.vQ(this.domElement,this.Hg,te.a.So,te.a.N8)}dispose(){ad.a.instance.Da(Ta.a.click,this.domElement,this.Hg);hb.KeyInputManager.instance.AU(this.domElement,this.RWa);this.BUe=null;super.dispose()}}ub.dQa=na.a.srd;Object(f.a)(ub,"InsertTemplateButton",
Ma,[]);class rb{constructor(N,Da){this.sheetName=null;this.newSheetIndex=0;this.sheetName=N;this.newSheetIndex=Da}getSheetName(){return this.sheetName}}Object(f.a)(rb,"MacroRecorderSheetReorderedPayload",null,[124]);var hd=a(91);class Eb extends pb.a{constructor(N,Da){super(document.createElement("div"));this.mX=()=>{h.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.Mlg(!1,"OnSheetsChanged")};this.Noj=()=>{this.Kl()};this.Moj=()=>{this.Qk()};this.$=N;this.ktk=Da;this.I_=
!1;this.P0b=0}dispose(){this.Qk();super.dispose()}fwk(){this.Mlg(!0,"TogglerSheetDropdownMenu")}Mlg(N,Da){h.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${Da}, toggle: ${N}, toggleStateId: ${this.P0b}`);N&&(this.P0b+=1);const fb=this.$.Ve.Sf("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${Da}, toggle: ${N}, toggleStateId: ${this.P0b}, sheetCount: ${this.$.sa.count}`);N=this.eLh();appChrome.renderSheetDropdownMenu(this.domElement,
this.ktk,N,this.P0b,this.Noj,this.Moj,()=>{fb.stop()},ib.a(this.$))}eLh(){const N=this.$.sa,Da=[];for(let Wb=0;Wb<N.count;Wb++){var fb=Object(ba.a)(ke.a,N.getItem(Wb));0===fb.QE&&(fb=this.dLh(fb),Da.push(fb))}return Da}dLh(N){const Da={};Da.key=N.name;Da.text=N.name;Da.onClick=this.fLh(N);N.active&&(Da.className=ib.a(this.$)?"ewa-active-sheet-menu-item-present-mode":ua.rZh);return Da}fLh(N){return()=>{const Da=new hd.a(-1876836819,0,this.$.zf,30,null);this.$.Ha.Me(Da,{[Lb.a.Tae]:N.name})}}Kl(){if(!this.I_){const N=
this.$.sa;N.Vj(this.mX);N.ibd(this.mX);N.a4(this.mX);N.toa(this.mX);N.uoa(this.mX);N.HMe(this.mX);N.W7a(this.mX);this.I_=!0}}Qk(){if(this.I_){const N=this.$.sa;N.vk(this.mX);N.G3d(this.mX);N.yda(this.mX);N.Yua(this.mX);N.Zua(this.mX);N.Kkg(this.mX);N.tWb(this.mX);this.I_=!1}}}Object(f.a)(Eb,"SheetDropdownMenu",pb.a,[699,2]);var kc=a(343);class zc extends Ma{constructor(N,Da,fb){super(document.createElement("a"),N,!0);this.el=()=>{this.fY(!1);this.$.ea.cq(this.el)};this.Hg=Wb=>{this.kGg(Wb.Te);return!0};
this.onKeyDown=Wb=>13===Wb.Ga.keyCode||32===Wb.Ga.keyCode?(this.kGg(Wb.Te),!0):!1;this.cQa=Da.Ee(this.domElement,Pa.a.instance.ia(513),0,na.a.x2h,Pa.a.instance.ia(513),V.a.hDi,this.disabled);this.domElement.classList.add(ua.A2h);fb.appendChild(this.domElement);this.RWh();this.pQj()}dispose(){this.wBk();super.dispose()}fY(N){super.fY(N||!this.$.ea.UEa)}RWh(){const N=this.$.ea;N.ei?this.fY(!1):N.zm(this.el)}kGg(N){this.disabled||(h.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${kc.a[N]}`),
this.$.Ha.Me(new hd.a(1243860697,N,this.$.zf,30,null)))}pQj(){ad.a.instance.va(Ta.a.click,this.domElement,this.Hg);hb.KeyInputManager.instance.va(Ta.a.Hf,this.domElement,this.onKeyDown)}wBk(){ad.a.instance.Da(Ta.a.click,this.domElement,this.Hg);hb.KeyInputManager.instance.Da(Ta.a.Hf,this.domElement,this.onKeyDown)}}Object(f.a)(zc,"SheetDropdownMenuAnchor",Ma,[]);var Nc=a(59),Fd=a(195),Xd=a(163),ie=a(148),Ee=a(60),He=a(229),gd=a(217),Bd=a(189),ue=a(149);class ye{constructor(N){this.sheet=N;this.altText=
Pa.a.instance.ia(1994)}OP(){return this.sheet.active}Ksa(){return this.sheet.isLockPausedInSession}wwa(){return this.sheet.Vk?V.a.Sdg:V.a.hBk}qfe(){return 16}VAa(){return null}WAa(){return ua.Qcf}Wge(){return null}mw(){return null}$cd(){return!0}}Object(f.a)(ye,"LockPausedSheetIconDataSource",null,[711]);class Ue{constructor(N){this.sheet=N;this.altText=Pa.a.instance.ia(1993)}OP(){return this.sheet.active}Ksa(){return this.sheet.Vk}wwa(){return V.a.Sdg}qfe(){return 16}VAa(){return null}WAa(){return ua.Qcf}Wge(){return null}mw(){return null}$cd(){return!0}}
Object(f.a)(Ue,"LockedSheetIconDataSource",null,[711]);class Sb{constructor(N,Da,fb){this.sheet=N;this.altText=Pa.a.instance.ia(1908);this.vwk=Da;this.fjk=fb}OP(){return this.sheet.active}Ksa(){return this.sheet.kh.tu}VAa(){return this.OP()?ua.I2h:ua.J2h}wwa(){return!this.OP()&&this.fjk()?V.a.ufk:V.a.tfk}qfe(){return 14}WAa(){return ua.G1h}Wge(){return this.sheet.kh.vyb}mw(){return this.vwk}$cd(){return!1}}Object(f.a)(Sb,"NamedSeetViewSheetIconDataSource",null,[711]);var cd=a(184),Xc=a(153);class fd{constructor(N,
Da){this.r3c=this.l9=this.MJa=this.Tv=null;this.mJf=!1;this.l8c=this.wwa=this.WAa=this.VAa=null;this.zT=()=>{this.dataSource.OP()&&zb.TaskExtensions.Ca(this.qPf,()=>{dialogControls.renderToolTip(this.dataSource.mw(),"SheetIconTooltip",this.dataSource.Wge(),this.dY,10,!1,!1,1)},this.$.qa,3)};this.yT=()=>{this.dataSource.OP()&&this.clearToolTip()};this.$=N;this.dataSource=Da}get tg(){return this.l9||(this.l9=Xc.a.instance.Kh(this.dY))}get qPf(){if(this.r3c)return this.r3c;const N=new cd.a;this.$.zP(Da=>
{zb.TaskExtensions.Ca(Da.qOd(),()=>{N.setResult(!0)},this.$.qa,3)});return this.r3c=N.task}get dY(){return this.l8c}fLg(){if(this.dY&&(this.Tv||this.MJa)){var N=this.dataSource.wwa();this.wwa!==N&&(this.MJa&&this.MJa.parentNode.removeChild(this.MJa),this.VCf(),this.wwa=N);N=this.dataSource.VAa();this.VAa!==N&&(this.ZXj(this.MJa,this.VAa,N),this.VAa=N);N=this.dataSource.WAa();this.WAa!==N&&(this.YXj(this.dY,this.WAa,N),this.WAa=N);this.dataSource.mw()&&!this.dataSource.OP()&&this.clearToolTip()}}Ikk(N,
Da,fb){this.ePi(N,Da,fb);Na.DOMElementExtensions.setVisible(this.dY,this.dataSource.Ksa())}clearToolTip(){zb.TaskExtensions.Ca(this.qPf,()=>{dialogControls.clearToolTip(this.dataSource.mw())},this.$.qa,3)}ePi(N,Da,fb){this.dY&&this.mJf!==N&&(this.dY.parentNode.removeChild(this.dY),this.WAa=this.VAa=this.wwa=this.l8c=null,this.dataSource.mw()&&(this.tg.detach("mouseover",!0),this.tg.detach("mouseout",!0)));this.dY||(this.l8c=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.dY,U.a.zBa),
Sys.UI.DomElement.addCssClass(this.dY,na.a.dS),N===this.dataSource.$cd()?Da.appendChild(this.dY):Da.insertBefore(this.dY,fb),this.VCf(),this.dataSource.mw()&&(this.tg.ta("mouseover",this.zT,!0),this.tg.ta("mouseout",this.yT,!0)),this.mJf=N)}ZXj(N,Da,fb){N&&(Sys.UI.DomElement.removeCssClass(N,Da),Sys.UI.DomElement.addCssClass(N,fb))}YXj(N,Da,fb){Da&&Sys.UI.DomElement.removeCssClass(N,Da);fb&&Sys.UI.DomElement.addCssClass(N,fb)}dispose(){Va.a.Sa(this.l9)}VCf(){const N=this.$.ja.Qa(388);N?(this.MJa=
N.iUa(this.dataSource.wwa(),this.dataSource.qfe()))?this.dY.appendChild(this.MJa):h.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.wwa()} was not found.`):h.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to receive SvgIconProvider service.")}}Object(f.a)(fd,"SheetIcon",null,[2]);var mb=a(454),Oc=a(103),jd=a(192);class ud extends Oc.a{constructor(N,Da){super(N.domElement);this.onKeyDown=fb=>{121===fb.keyCode&&fb.shiftKey&&!this.Xva.disabled&&
(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Xva.anchor),ge.g(fb))};this.ika=fb=>{if(!this.$.isEditMode||this.Xva.disabled)return!0;this.rename(!1,fb.Te);return!0};this.Xp=fb=>this.Xva.disabled?!0:this.showContextMenu(fb.clientPoint,fb.Te,fb.rf);this.FFe=N;this.$=Da;ad.a.instance.va(Ta.a.fo,N.domElement,this.ika);mb.a.instance.va(N.domElement,this.Xp);this.tg.ta("keydown",this.onKeyDown)}get Xva(){return this.FFe}dispose(){this.Xva&&(ad.a.instance.Da(Ta.a.fo,this.Xva.domElement,this.ika),mb.a.instance.Da(this.Xva.domElement,
this.Xp),this.FFe=null);this.$=null;super.dispose()}showContextMenu(N,Da,fb){this.Xva.activate(Da,Yb.a.WKf());Da=new hd.a(-1075099431,Da,this.$.zf,30,null);let Wb;return!jd.a(Wb=this.$.Ha.Me(Da,{[Lb.a.ixg]:N,[ud.ffk]:this.Xva.sheet,[Lb.a.jxg]:fb}))&&(6!==Wb.status||Wb.result)}rename(N,Da){this.$.Lf(817296323,Da,N?19:0,null)}}ud.ffk="Sheet";Object(f.a)(ud,"SheetOpsSheetClickHelper",Oc.a,[]);var pd=a(57);class id extends Ma{constructor(N,Da,fb,Wb,Jc){super(document.createElement("li"),N);this.cfk=100;
this.dfk=500;this.JZe=this.IZe=0;this.P4e=.5;this.I_=this.Rae=!1;this.color=this.OYc=this.ZO=this.sRb=this.vU=null;this.Exc=this.WHf=!1;this.rjc="#BEBBB8";this.gWc=null;this.onKeyDown=md=>13!==md.Ga.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.yE=md=>32!==md.Ga.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.zT=()=>{this.disabled||this.$K.JW||this.Pva(!0,void 0,"OnMouseOver")};this.yT=()=>{this.disabled||this.Pva(!1,void 0,"OnMouseOut")};this.OSb=()=>{this.$K.JW||(this.Ipk(),
Object(pd.d)(this.sheet.sheetProcessedData)||se.h(this.$).zIa(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.$ca=()=>{this.aaf(!1);return!1};this.Hg=md=>{if(this.disabled)return!0;const sd=se.h(this.$);this.sheet.active||3!==md.Te||!Yb.a.GWa()&&!this.COb||sd.De||sd.Fm||sd.VEb();this.activateSheet(md.Te);return 3!==md.Te};this.onPointerDown=md=>{if(this.disabled)return!0;this.aaf(!0);se.h(this.$).inRangePicker&&h.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var sd=3===md.Te;if(2===md.Te||sd&&this.AFa)this.Pva(!0,!sd,"OnPointerDown"),sd=lb.Task.delay(sd?this.dfk:this.cfk).Jw(()=>!0),this.RNb&&(this.Exc=!0,this.$K.LJc=zb.TaskExtensions.Ca(sd,()=>{this.Exc&&this.$K.Vxj(this,md)},this.qa,11));return!1};this.Yk=md=>{if(this.disabled||!this.RNb&&nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.Exc=!1;this.Pva(2===md.Te,void 0,"OnPointerUp");this.$K.LJc&&(zb.TaskExtensions.Ca(this.$K.LJc,()=>{this.$K.Uxj()},
this.qa,11),this.$K.LJc=null);return!1};this.KT=()=>{this.Exc=!1;this.Rae||this.Pva(!1,void 0,"OnTouchMove");return!1};this.NYe=new ud(this,N);this.COb=Yb.a.COb();this.IZe=18;this.JZe=20;this.$=N;this.p$b=Wb;this.$K=Jc;this.RNb=Jc.AOe();this.qLh();this.kFh();this.oEd=N.Ve.wj("UserAction",this.name);this.MId=!1;Na.DOMElementExtensions.ME(this.domElement,Lb.a.Vu,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.ZO);this.Vva=new K.a;N=new Ue(this.sheet);this.Vva.add(new fd(this.$,
N));this.$.ea.wZb&&(N=new ye(this.sheet),this.Vva.add(new fd(this.$,N)));N=new Sb(this.sheet,this.$K.pNc,()=>this.color?id.dce(this.color):!1);this.sRb=new fd(this.$,N);this.Vva.add(this.sRb);this.AFa=this.$K.AFa;this.Zqb();this.JRj();this.GTe=new qd.a(this.domElement,1);Da.insertBefore(this.domElement,fb);ib.a(this.$)&&this.aMg(!0)}get JOh(){return this.OYc||(this.OYc=gd.a.ls("#F5F5F5"))}get name(){return this.vU.innerText}set name(N){this.vU&&(this.vU.innerText=N,this.nSc(),this.bMg())}get sheet(){return this.p$b}get anchor(){return this.gWc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(N){this.anchor.tabIndex=
N}Pni(){return Na.DOMElementExtensions.nl(this.anchor)?this.anchor:null}dispose(){if(this.I_){Ca.a.instance.Da(Ta.a.yg,this.domElement,this.onPointerDown);hb.KeyInputManager.instance.Da(Ta.a.Hf,this.domElement,this.onKeyDown);hb.KeyInputManager.instance.Da(Ta.a.Ps,this.domElement,this.yE);ad.a.instance.Da(Ta.a.click,this.domElement,this.Hg);Ca.a.instance.Da(Ta.a.x1,this.domElement,this.OSb);Ca.a.instance.Da(Ta.a.pG,this.domElement,this.$ca);if(this.RNb||nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))Ca.a.instance.Da(Ta.a.Hk,
this.domElement,this.Yk),this.AFa&&(cb.a.instance.Da(Ta.a.Uh,this.domElement,this.Yk),cb.a.instance.Da(Ta.a.mk,this.domElement,this.KT));this.I_=!1;this.rjc="#BEBBB8"}Va.a.Wf([this.NYe,this.GTe]);this.vU=this.ZO=this.gWc=this.$K=this.GTe=this.NYe=null;if(this.Vva){for(const N of this.Vva)N.dispose();this.Vva=null}this.color=this.p$b=null;super.dispose()}fY(N){N&&this.Pva(!1,!1);super.fY(N)}Tzg(N){Ee.a.fj.IW&&(this.R7e(),void Aa.a.resolve(Ka.Dc,{Aa:1}).then(Da=>{Fd.UISurfaces.TF().then(fb=>{Da.Wak(fb);
Da.show(N);return null},fb=>{h.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${fb}`);return null})}))}kbh(){if(this.sheet.active&&this.$.cu){var N=this.$.cu,Da=se.h(this.$),fb=Da.Hl;if(this.sheet.kh.tu){if(!this.sRb){const Wb=new Sb(this.sheet,this.$K.pNc,()=>this.color?id.dce(this.color):!1);this.sRb=new fd(this.$,Wb);this.Vva.add(this.sRb)}fb&&Da.Oqb(1);N.classList.add(na.a.Mff);N=id.urf(Lb.a.gWf);Da=id.urf(Lb.a.BSd);"true"===N&&
"true"===Da?this.$.ea.Ube&&this.$.ea.PZb&&(this.sheet.kh.fN?(N=1,Xd.a.UB(Lb.a.BSd,"false",Xd.a.U6),this.$.ea.PZb=!1):N=0,Xd.a.UB(Lb.a.gWf,"false",Xd.a.U6),this.$.ea.Ube=!1,this.Tzg(N)):this.sheet.kh.fN&&"true"===Da&&this.$.ea.PZb&&(Xd.a.UB(Lb.a.BSd,"false",Xd.a.U6),this.$.ea.PZb=!1,this.Tzg(2))}else this.R7e(),fb&&Da.Oqb(0),N.classList.remove(na.a.Mff)}}R7e(){const N=Aa.a.mg(Ka.Dc);N&&N.dismiss()}Zqb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.pgb()?ua.Csk:ua.Ksk;
nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.vU.parentNode.classList.add(ua.G6i):this.vU.parentNode.classList.add(ua.H6i);this.bMg();this.Jkk();this.hMg();this.nSc();this.kbh()}Txj(){this.Rae=!0;this.Pva(!0,!0,"OnSheetReorderStarted")}Sxj(){this.Rae=!1;this.Pva(!1,void 0,"OnSheetReorderEnded")}activate(N,Da){N=void 0===N?0:N;Da=void 0===Da?!1:Da;this.mgc()||(this.sheet.activate({scenario:"switchSheet"}),Da&&se.h(this.$).focus(),N={["InputMethod"]:kc.a[N],["AppMode"]:this.$.zf,
["Location"]:"canvas"},ue.b(this.$).Gg(ie.a.$ek,N))}aMg(N){this.rjc=N?"#797775":"#BEBBB8";this.P4e=N?-.5:.5;this.OYc=N?gd.a.ls("#3B3A39"):gd.a.ls("#F5F5F5");this.hMg()}q8j(N){this.RNb=N}$Ud(N){N.Ujd();this.YWe(N)}YWe(N){N.G$a();this.sheet.activate({scenario:"switchSheet"})}l9g(N){N=new hd.a(-1876836819,N,this.$.zf,30,null);return this.$.Ha.Me(N,{[Lb.a.Tae]:this.sheet.name})}bMg(){this.vU.parentNode.setAttribute("sheet-title",this.vU.innerText)}nSc(){const N=this.ehi();this.anchor.setAttribute(Lb.a.Ly,
N);this.anchor.setAttribute(Lb.a.Fga,this.sheet.active.toString())}ehi(){const N=this.sheet.kh.tu,Da=this.sheet.kh.vyb,fb=this.sheet.Vk,Wb=this.sheet.isLockPausedInSession;return N&&fb?String.format(Pa.a.instance.He(20),this.name,Da):N&&Wb?String.format(Pa.a.instance.He(22),this.name,Da):N?String.format(Pa.a.instance.He(19),this.name,Da):fb?String.format(Pa.a.instance.He(18),this.name):Wb?String.format(Pa.a.instance.He(21),this.name):this.name}activateSheet(N){N=void 0===N?0:N;if(Yb.a.WKf()){if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.mgc())return lb.Task.Ra(!1);Bd.a.current.eU="ActivateSheet";se.h(this.$).Nea.navigationStart("switch-sheet");this.sheet.activate({scenario:"switchSheet"});return lb.Task.Ra(!0)}return this.l9g(N)}hMg(){const N=this.sheet.tabColor;this.color=N?gd.a.ls(N):this.JOh;this.WHf=id.dce(this.color);this.Pva(!1,void 0,"UpdateTabColor")}Pva(N,Da,fb){Da=void 0===Da?!1:Da;fb=void 0===fb?null:fb;if(this.sheet){fb=this.sheet.active;var Wb=this.pgb(),Jc=!!this.sheet.tabColor,md=gd.a.lL(fb||Wb?He.a.wrb:this.color);
this.ZO.style.background="";fb||Wb?(Jc&&(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.KUa?this.Sck():this.Rck()),this.ZO.style.height=this.IZe.toString()+"px"):(this.ZO.style.filter="",this.ZO.style.backgroundColor=md,this.ZO.style.height=this.JZe.toString()+"px");this.vU.className=fb?ua.Dsk:Wb?ua.dark:this.WHf?ua.light:ua.dark;for(const sd of this.Vva)sd.fLg();N&&!Jc&&(this.ZO.style.backgroundColor="#E1DFDD");Na.DOMElementExtensions.toggleCssClass(this.domElement,
ua.Jsk,N);Da?(Jc||(this.ZO.style.backgroundColor=this.rjc),this.domElement.style.backgroundColor=this.rjc):(Jc||(this.ZO.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.vU.style.fontWeight=fb||Wb?"600":""}else h.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, which means its not rendered. caller: ${fb}`)}Rck(){const N=this.ZO.style,Da=gd.a.lL(id.Zvh(this.color,this.P4e));N.background=Da}Sck(){this.ZO.style.background=
"transparent"}kFh(){this.gWc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=ua.Esk;Na.DOMElementExtensions.ME(this.anchor,Lb.a.oAb,null,null);this.tabIndex=-1}qLh(){this.ZO=document.createElement("span");this.ZO.className=ua.Hsk;this.vU=document.createElement("span");this.vU.className=ua.Msk;this.vU.dir=this.sheet.rtlName?"rtl":"ltr";this.ZO.appendChild(this.vU)}Jkk(){const N=this.$.HR;for(const Da of this.Vva)Da.Ikk(N,this.ZO,this.vU)}pgb(){return se.h(this.$).pgb(this.sheet)}Ipk(){this.oEd.start();
this.MId=!0}aaf(N){this.MId&&(this.oEd.stop(),h.ULS.sendTraceTag(537153686,0,50,Za.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.oEd.gg,["Has been clicked"]:N})),this.MId=!1)}JRj(){Ca.a.instance.va(Ta.a.yg,this.domElement,this.onPointerDown);hb.KeyInputManager.instance.va(Ta.a.Hf,this.domElement,this.onKeyDown);hb.KeyInputManager.instance.va(Ta.a.Ps,this.domElement,this.yE);this.tg.ta("mouseover",this.zT);this.tg.ta("mouseout",this.yT);Ca.a.instance.va(Ta.a.x1,
this.domElement,this.OSb);Ca.a.instance.va(Ta.a.pG,this.domElement,this.$ca);if(this.RNb||nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))Ca.a.instance.va(Ta.a.Hk,this.domElement,this.Yk),this.AFa&&(cb.a.instance.va(Ta.a.Uh,this.domElement,this.Yk),cb.a.instance.va(Ta.a.mk,this.domElement,this.KT));ad.a.instance.va(Ta.a.click,this.domElement,this.Hg);this.I_=!0}mgc(){const N=this.$.ja.Qa(65);return N&&N.xsa()?(N.WKc(),this.YWe(N),!0):!1}static urf(N){let Da=
Xd.a.get(N);Da||(Xd.a.UB(N,"true",Xd.a.U6),Da=Xd.a.get(N));return Da}static Zvh(N,Da){if(1<Da||-1>Da)return N;let fb=N.r,Wb=N.g;N=N.b;0<Da?(fb=fb*(1-Da)+255*Da,Wb=Wb*(1-Da)+255*Da,N=N*(1-Da)+255*Da):(fb*=1+Da,Wb*=1+Da,N*=1+Da);return He.a.xHb(Math.round(fb),Math.round(Wb),Math.round(N))}static dce(N){return 128>=(222*N.r+707*N.g+71*N.b)/1E3}}Object(f.a)(id,"SheetTabButton",Ma,[]);class Ed extends Ma{constructor(N,Da,fb){super(document.createElement("a"),Da);this.dQa=na.a.srd;fb.Ee(this.domElement,
Pa.a.instance.ia(713),0,this.dQa,Pa.a.instance.ia(713),V.a.Fjd,!0);N.appendChild(this.domElement);this.tg.ta("contextmenu",Wb=>{ge.g(Wb)})}}Object(f.a)(Ed,"WorkbookProtectionButton",Ma,[]);var Pd=a(56),lc=a(52),Kc=a(67);class td extends pb.a{constructor(N,Da,fb){fb=void 0===fb?null:fb;super(Da);this.sheetTabActivatePreviousHidden=Pa.a.instance.ia(722);this.sheetTabActivateNextHidden=Pa.a.instance.ia(724);this.svgIconProvider=null;this.$k=[];this.nT=Array(6);this.JSd=Array(6);this.a1a=this.xLb=this.wW=
this.zob=this.Zae=this.Yae=this.Dq=null;this.isRtl=!1;this.U0=this.hE=0;this.klc=this.KJc=!1;this.uGc=this.uva=0;this.jS=this.Gaa=this.Eha=this.wlc=null;this.isc=this.dI=0;this.h0b=null;this.YOb=-1;this.saa=null;this.AFc=0;this.mPc=-1;this.Jua=0;this.dCa=new Ib;this.d2c=!1;this.LJc=this.Bob=this.Aob=this.DFe=this.Z6=null;this.lxe=!1;this.CFe=null;this.XBf=()=>{this.lFd();this.$.Hp(this.XBf)};this.AI=(Wb,Jc)=>{this.z7f(Jc.item)};this.lX=(Wb,Jc)=>{Wb=this.$.sa.na.index;for(let md=0,sd=this.$k.length;md<
sd;md++){const Od=this.e0(md);if(Od.name===Jc.oldName){Od.name=Jc.newName;this.G7();md===Wb&&this.rla(6);break}}};this.D7f=(Wb,Jc)=>{(Wb=this.IGb(Jc.item))&&Wb.Zqb()};this.E7f=(Wb,Jc)=>{Jc.visible?(this.V0a(!1),this.A7f(Jc.item)):this.z7f(Jc.item)};this.Vta=Wb=>{this.JW?(this.saa=Wb,this.w1b()):(this.saa&&(this.uGc+=this.saa.clientPoint.x-Wb.clientPoint.x),this.saa=Wb,Math.abs(this.uGc)>=this.xUh&&this.w1b());return!0};this.KT=Wb=>{Wb.Ga.preventDefault();return!1};this.Frg=Wb=>{this.Crg(Wb,!0)};this.Erg=
Wb=>{this.Crg(Wb,!1)};this.Wta=Wb=>{if(this.JW){this.klc=this.SVi(Wb);let Jc;Wb=(Jc=this.e0(this.dI+1))?Jc.sheet:null;this.reorderSheets(Wb,this.dI+1===this.Wae,!0)}this.A_();return!0};this.Hm=(Wb,Jc)=>{Jc.pD&&this.Sje(Jc.pD);this.uMc(!1);this.G7();Jc.na&&(this.Sje(Jc.na),this.rla(6),this.ea.oua())};this.EYf=(Wb,Jc)=>{this.iTc(Jc.item)};this.FYf=(Wb,Jc)=>{this.iTc(Jc.item)};this.GYf=(Wb,Jc)=>{this.iTc(Jc.item)};this.vYa=(Wb,Jc)=>{this.iTc(Jc.item)};this.WGa=()=>{this.qid()};this.Xg=()=>{this.isVisible=
!this.ea.isNamedObjectViewMode;this.qid();this.hmd();if(Kc.d(this.$)||Kc.e(this.$))lc.a.instance.R7(Lb.a.Yda,["sheetTabBar"]),lc.a.instance.Q7(Lb.a.Yda,["sheetTabBar"]);this.Qld();this.G7();this.V0a(!0);this.rla(6)};this.sm=()=>{this.isVisible&&(this.G7(),this.rla(6))};this.ij=()=>{Object(ya.a)(fa,this.wW)===bc.m(this.$.Rh)&&this.Qld();for(const Wb of this.$k)Wb.q8j(!bc.m(this.$.Rh))};this.C7f=(Wb,Jc)=>{this.PXj(Jc.item,Jc.isUserOperation)};this.eTb=(Wb,Jc)=>{this.A7f(Jc.item)};this.onKeyDown=Wb=>
{switch(Wb.keyCode){case 9:var Jc=this.domElement.querySelectorAll(Na.DOMElementExtensions.jE);const md=Na.DOMElementExtensions.Xz(Jc);Jc=Na.DOMElementExtensions.H5(Jc);Na.DOMElementExtensions.M0a(Wb,md,Jc);break;case 39:case 37:Na.DOMElementExtensions.wug(Wb,this.domElement.querySelectorAll(Na.DOMElementExtensions.jE),39===Wb.keyCode?!this.isRtl:this.isRtl)}h.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${Wb.keyCode}`)};this.jQ=()=>{this.Dq.scrollLeft!==this.uva&&this.puk()};
this.DT=Wb=>{if(Wb.ctrlKey||Wb.caa)return!1;this.Dq.scrollLeft+=Math.floor(30*Wb.UKa);if(this.JW){const Jc=this.Cpf("OnMouseWheel");Jc&&this.tfe(0<Wb.UKa,Jc.x+Jc.width/2)}return!0};this.HT=(Wb,Jc)=>{if(this.dCa)this.Sxf("PartialInteractivity",Jc.fV?3:0);else{this.A_(!1);this.z$d(Jc.fV);for(const md of this.ESe)md&&md.fY(Jc.fV);for(const md of this.$k)md&&md.fY(Jc.fV)}};this.qSb=(Wb,Jc)=>{Wb=0;Jc.zJe&&(Wb=2|(Jc.gfk?1:0));this.Sxf("ComponentRangePicker",Wb)};this.$=N;this.svgIconProvider=fb;nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8339172_SheetTabBarEarlyLoad")?
null!==this.$.sa?this.lFd():this.$.Go(this.XBf):this.lFd()}lFd(){this.ea=this.$.ea;this.Dlc=!nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.yKf=!this.$.iy;this.lxe=!R.a.JP;this.RXi=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.Wgj=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.Vgj=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.xUh=this.$.xa.SheetTabDragStartPixelThreshold;this.pZa=
this.qZa=-1;this.rkd=!1;this.uH=new qd.a(this.domElement,3);this.domElement.classList.add(ua.S2h);this.XIh();this.vGh();this.YIh();document.getElementById(Lb.a.uia)||this.dKh();this.uMc(!0);this.Xg(null,null);const N=this.$.sa;N.Vj(this.Hm);N.ibd(this.WGa);N.a4(this.AI);N.toa(this.eTb);N.uoa(this.lX);N.HMe(this.C7f);N.W7a(this.E7f);N.reh(this.D7f);N.zbd(this.EYf);N.EMe(this.FYf);N.FMe(this.GYf);N.GMe(this.vYa);this.$.Go(this.Xg);this.$.MD(this.sm);ob.a(this.$).sn(this);nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||this.$.ja.$c(32,this);nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.Jy(this.ij);this.rNc=this.Zh.Kh(this.domElement);this.rNc.ta("keydown",this.onKeyDown);Lc.a(this.$).Gt()&&this.HT(null,new ac.a(!0));Lc.a(this.$).Jj.voa(this.HT);se.h(this.$).fMe(this.qSb);this.rNc.ta("mousedown",Da=>{Da.preventDefault()});mc.a.instance.va(Ta.a.uI,this.domElement,this.DT);this.Xae=this.Zh.Kh(this.Dq);this.Xae.ta("scroll",this.jQ);this.puk=Wd.b(()=>{this.G7()},
200,this.$.qa,ld.a.ofk,!0);this.$.nK(Lb.a.eBg);this.yKf&&(this.CFe=new Eb(this.$,this.a1a.domElement));lc.a.instance.gla(Lb.a.Yda,["sheetTabBar"])}get ng(){return this.domElement}get nl(){return this.isVisible}get Qh(){return Fc.a.Vae}get JW(){return this.d2c}get Wae(){return this.$k.length}get pNc(){return this.DFe}get AFa(){return this.lxe}get navigationButtonsDisabled(){return!!this.dCa&&this.dCa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.dCa&&this.dCa.operationButtonsDisabled}get ihj(){return this.$.HR?
[na.a.Ocf,na.a.Scf,na.a.Tcf,na.a.Ncf,na.a.Imc,na.a.Imc]:[na.a.Ncf,na.a.Tcf,na.a.Scf,na.a.Ocf,na.a.Imc,na.a.Imc]}get KSd(){return this.$.HR?[null,V.a.w_e,V.a.u_e]:[null,V.a.u_e,V.a.w_e]}get lcg(){return this.$.HR?[null,V.a.x_e,V.a.v_e]:[null,V.a.v_e,V.a.x_e]}get yPb(){if(this.isRtl){if(R.a.bD)return 0;if(R.a.hj)return-1*(this.Dq.scrollWidth-this.Dq.clientWidth);if(R.a.JP)return this.Dq.scrollWidth-this.Dq.clientWidth;h.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get vXb(){if(this.isRtl){if(R.a.bD)return this.Dq.scrollWidth-
this.Dq.clientWidth;if(R.a.hj||R.a.JP)return 0;h.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Dq.scrollWidth-this.Dq.clientWidth}get ESe(){return this.dCa?[this.wW,this.xLb]:[this.wW,this.xLb,this.a1a]}get Lsk(){return this.$k.concat(this.a1a)}get efk(){return this.CFe}Ee(N,Da,fb,Wb,Jc,md,sd){sd=void 0===sd?!1:sd;N.removeAttribute("Href");N.setAttribute(Lb.a.ih,Lb.a.Kz);N.className=ua.H2h;N.title=Da;N.tabIndex=0;md?fb=this.svgIconProvider.Lia(md,
12,12,N,24,24):(Da=document.createElement("span"),Da.className=na.a.Lyh,Da.classList.add(U.a.zBa),Da.tabIndex=-1,N.appendChild(Da),md=document.createElement("img"),md.src=fe.a.rk(fb),md.className=Wb,md.alt=Jc,md.tabIndex=-1,Da.appendChild(md),fb=md);sd&&N.classList.add(U.a.L4);return fb}dispose(){if(this.$){var N=this.$.sa;N.vk(this.Hm);N.G3d(this.WGa);N.yda(this.AI);N.Yua(this.eTb);N.Zua(this.lX);N.Kkg(this.C7f);N.tWb(this.E7f);N.vVj(this.D7f);N.Z3d(this.EYf);N.Hkg(this.FYf);N.Ikg(this.GYf);N.Jkg(this.vYa);
this.$.Hp(this.Xg);this.$.wG(this.sm);Lc.a(this.$)&&Lc.a(this.$).Jj.$ua(this.HT);this.dCa&&se.h(this.$).nkg(this.qSb);mc.a.instance.Da(Ta.a.uI,this.domElement,this.DT)}Va.a.Wf(this.JSd);this.JSd=null;if(this.nT)for(N=0;N<this.nT.length;N++){const Da=Na.DOMElementExtensions.eK(this.nT[N],this.domElement,!1,"a");Da&&Db.a.oIa(Da)}Va.a.Sa(this.uH);Va.a.Sa(this.rNc);Va.a.Sa(this.Xae);this.Xae=this.rNc=this.xLb=this.wW=this.uH=null;this.$&&this.A_(!1);this.Eha=null;this.$9d(null,"Dispose");this.h0b=this.jS=
this.wlc=null;this.qid();this.zob=this.Zae=this.Yae=this.Dq=this.nT=this.$=this.ea=null;super.dispose()}Wl(N,Da){if(!Da){h.ULS.shipAssertTag(537153760,0,0<this.$k.length,"There is no sheet tab button.");if(!this.$k.length)return!1;N=null;for(const fb of this.$k)if(N=fb.Pni())break;if(!N)return h.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Na.DOMElementExtensions.setFocus(N)}return!Da}Bm(N){return Na.DOMElementExtensions.Ek(this.ng,N)}Ko(){}Rp(){}reorderSheets(N,Da,fb){if(this.Z6&&
this.Z6!==N){const Wb=this.Z6.index;this.OXj(this.Z6,N,Da);N=N?N.index-1:Da?this.$.sa.count-1:0;Wb!==N&&(this.laj(Wb,N,fb),this.BXh(this.Z6.name,N))}}nBi(N){N=this.Fqa(N);return-1!==N&&this.hE<=N&&N<=this.U0?this.$k[N].domElement:null}$Lg(N){for(var Da=0;Da<this.nT.length;Da++){const fb=this.nT[Da];if(fb&&this.svgIconProvider){const Wb=fb.parentNode;this.Rjg(fb);Wb&&(this.nT[Da]=this.svgIconProvider.Lia(N?this.lcg[Da]:this.KSd[Da],12,12,Wb,24,24))}}for(Da=0;Da<this.$k.length;Da++)this.$k[Da].aMg(N);
this.a1a&&this.a1a.cQa&&this.ZLg(V.a.iDi,this.a1a,N);this.wW&&this.wW.cQa&&this.ZLg(V.a.ZAh,this.wW,N)}ZLg(N,Da,fb){Da.FUb||(Da.FUb=this.svgIconProvider.Lia(N,12,12,Da.cQa.parentNode,24,24));Da.FUb&&(Na.DOMElementExtensions.setVisible(Da.cQa,!fb),Na.DOMElementExtensions.setVisible(Da.FUb,fb))}Vxj(N,Da){var fb=se.h(this.$);const Wb=fb.inRangePicker,Jc=Zd.HelperMethods.Rv(Da);if(fb.De&&!Wb){const md=fb.ov?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let sd;sd=[Object(Cb.a)(fb.cellTextEditBox.Ja.TJa)];
Cb.b(this.$).pL(Jc.rawEvent,md,sd);fb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}fb=this.AFa&&3===Da.Te;!(2===Da.Te&&Jc.button===Sys.UI.MouseButton.leftButton||fb)||Wb||this.JW||Lc.a(this.$).Gt()||(fb&&N.Txj(),this.YOb=Da.clientPoint.x,this.saa=Da,this.unh(N))}Uxj(){this.G7()}AOe(){return this.$.isEditMode&&!bc.m(this.$.Rh)}G7(){const N=Zd.HelperMethods.zK(()=>{this.MDk();this.rck();this.z$d()});h.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${N}`)}rck(){const N=
this.U0===this.$k.length-1;Na.DOMElementExtensions.toggleCssClass(this.zob,this.$.HR?ua.Ucf:ua.Pcf,!!this.hE);Na.DOMElementExtensions.toggleCssClass(this.zob,this.$.HR?ua.Pcf:ua.Ucf,!N)}z$d(N){N=void 0===N?!1:N;const Da=!this.hE,fb=this.U0===this.$k.length-1;this.evg(4,this.sheetTabActivatePreviousHidden,!Da);this.evg(5,this.sheetTabActivateNextHidden,!fb);this.KMc(0,Da||N);this.KMc(1,Da||N);this.KMc(2,fb||N);this.KMc(3,fb||N)}evg(N,Da,fb){if(N=this.nT[N]){Na.DOMElementExtensions.setVisible(N,fb);
var Wb=this.yrf(N);Wb.title="img"===N.nodeName?N.alt=0<this.$k.length&&fb?Da:"":N.title=0<this.$k.length&&fb?Da:"";Wb.tabIndex=fb?0:-1}}yrf(N){return N.parentNode}KMc(N,Da){if(N=this.nT[N])N=this.yrf(N),void 0!==N&&null!==N&&(!this.$k.length||Da?(N.classList.add(U.a.L4),N.setAttribute(Lb.a.DPa,"true")):(N.classList.remove(U.a.L4),N.setAttribute(Lb.a.DPa,"false")))}V0a(N){const Da=this.$.HR?this.$k.length-1:0;let fb=this.guf(this.$.HR?0:this.$k.length-1);fb&&(fb.borderRightWidth=N?"1px":"0");this.hE!==
this.U0&&(fb=this.guf(Da))&&(fb.borderRightWidth="0")}zLe(N,Da){this.$k||(this.$k=[]);-1===Da?this.$k.push(N):this.$k.splice(Da,0,N)}Pic(N,Da){let fb=-1,Wb=null;Da||(fb=this.osi(N.index),-1!==fb&&(Wb=this.gUa(fb)));N=new id(this.$,this.Dq,Wb,N,this);this.zLe(N,fb);Na.DOMElementExtensions.setVisible(N.domElement,!0)}rla(N){const Da=Zd.HelperMethods.zK(()=>{switch(N){case 0:this.lLc(0);break;case 1:this.lLc(this.hE-1);break;case 2:this.lLc(this.hE+1);break;case 3:this.scrollIntoView(this.$k.length-
1);break;case 4:this.hE&&1<=this.$k.length&&(this.nJe(this.hE-1),this.h8d());break;case 5:this.U0!==this.$k.length-1&&1<=this.$k.length&&(this.nJe(this.U0+1),this.h8d());break;case 6:this.h8d()}});this.Dlc&&this.JW&&this.w1b();h.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${N}, duration = ${Da}`)}nJe(N){(N=this.e0(N))&&N.activate()}K$h(N){if(0===N.QE){const Da=this.$.sa;let fb=0;for(let Wb=0,Jc=Da.count;Wb<Jc;Wb++){const md=Object(ba.a)(ke.a,Da.getItem(Wb));if(md===
N)return fb;0===md.QE&&fb++}}return-1}w$h(N){const Da=this.$.sa;for(let fb=N.index+1,Wb=Da.count;fb<Wb;fb++)if(N=Object(ba.a)(ke.a,Da.getItem(fb)),0===N.QE)return N;return null}Fqa(N){for(let Da=0;Da<this.$k.length;Da++){const fb=this.e0(Da);if(!fb)h.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${Da}] is null even though index is not out of bounds!`);else if(fb.sheet===N)return Da}return-1}IGb(N){N=this.Fqa(N);return this.e0(N)}laj(N,Da,fb){const Wb=
{};Wb.a=this.$.xa.UserSessionId;Wb.b=fb;Wb.c=this.klc;Wb.d=N;Wb.e=Da;Wb.f=this.$.sa.count;Pd.b().Fi(2,Wb,fb)}OXj(N,Da,fb){const Wb=Object(ba.a)(ne.a,this.$.sa);Da?(Da=Da.index,Da=N.index<Da?Da-1:Da):Da=fb?Wb.count-1:0;Wb.reorderSheet(N,Da,!0)}Q$j(N){se.h(this.$).Dk.iw(N)}unh(N){if(!this.KJc){const Da=this.domElement.ownerDocument.body;Ca.a.instance.va(Ta.a.Yp,document.documentElement,this.Vta);this.AFa&&(cb.a.instance.va(Ta.a.mk,document.documentElement,this.Vta),cb.a.instance.va(Ta.a.mk,this.domElement,
this.KT));Ca.a.instance.va(Ta.a.Hk,document.documentElement,this.Wta);cb.a.instance.va(Ta.a.Uh,Da,this.Wta);this.KJc=!0}this.Z6=N.sheet;this.klc=!1;this.jS=null;this.wlc=N;this.Eha=N.domElement;this.$9d(Na.DOMElementExtensions.getBoundingClientRect(this.Eha),"BeginSheetTabButtonDrag")}A_(N){N=void 0===N?!0:N;if(this.KJc){this.Q$j(Lb.a.S5);const Da=this.domElement.ownerDocument.body;Ca.a.instance.Da(Ta.a.Yp,document.documentElement,this.Vta);this.AFa&&(cb.a.instance.Da(Ta.a.mk,document.documentElement,
this.Vta),cb.a.instance.Da(Ta.a.mk,this.domElement,this.KT));Ca.a.instance.Da(Ta.a.Hk,document.documentElement,this.Wta);cb.a.instance.Da(Ta.a.Uh,Da,this.Wta);this.d2c=this.KJc=!1}this.uGc=0;this.klc=!1;this.Z6=null;this.Eha&&(this.Eha.style.visibility="visible",this.Eha=null);this.wlc=null;this.$9d(null,"EndSheetTabButtonDrag");this.jS&&(this.jS.parentNode&&this.jS.parentNode.removeChild(this.jS),this.jS=null);this.m_j(N)}m_j(N){this.Lee(N);this.dI=this.YOb=-1}BXh(N,Da){const fb=this.$.oa,Wb=fb?
fb.ua:null;this.$.userOperationManager.enqueueOperation(new oc.a(557,0,(Jc,md,sd)=>{const Od=Wb.Oa(9,null);Od.sheetName=N;Od.newSheetIndex=Da;return Nc.h(Wb,"ReorderSheets",Od,Jc,md,sd,null,0)},64,()=>new rb(N,Da)),null)}e0(N){return 0<=N&&N<this.$k.length?this.$k[N]:null}Hxi(N){return(N=this.e0(N))?N.sheet:null}gUa(N){return(N=this.e0(N))?N.domElement:null}guf(N){return(N=this.gUa(N))?N.style:null}osi(N){const Da=this.$.sa;N+=1;let fb=-1;const Wb=this.$k?this.$k.length:0;for(;N<Da.count;){const Jc=
Object(ba.a)(ke.a,Da.getItem(N));if(0===Jc.QE){for(fb=0;fb<Wb&&this.Hxi(fb)!==Jc;fb++);break}N++}return-1===fb||fb===Wb?-1:fb}z7f(N){var Da=this.IGb(N);Da&&(this.JW&&(h.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.A_()),this.Dq.removeChild(Da.domElement),Da=Array.indexOf(this.$k,Da),this.$k.splice(Da,
1),this.G7(),(!this.isRtl&&Da===this.$k.length||this.isRtl&&!Da)&&this.V0a(!0),this.Dlc&&this.JW?N===this.Z6?(this.A_(),this.rla(6)):this.w1b():this.rla(6))}A7f(N){const Da=Object(ba.a)(ke.a,N);this.JW&&(h.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.A_());if(0===Da.QE){this.V0a(!1);
var fb=this.Fqa(N);-1===fb&&(h.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.Pic(Da,!1),fb=this.Fqa(N));this.$xf(fb,!0)}}PXj(N,Da){const fb=this.IGb(N);fb&&(this.JW&&!Da&&(h.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.A_()),N=this.xsk(N,fb),!nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&N&&Da&&N.Sxj())}xsk(N,Da){var fb=Array.indexOf(this.$k,Da);const Wb=this.K$h(Object(ba.a)(ke.a,N));if(-1===Wb||-1===fb)return null;this.V0a(!1);({pai:this.hE,y5i:this.U0}=td.LXj(fb,Wb,this.hE,this.U0));Da&&Da.domElement.parentNode===this.Dq&&(this.Dq.removeChild(Da.domElement),this.$k.splice(fb,1));Da=this.w$h(N);Da=this.Fqa(Da);fb=new id(this.$,this.Dq,this.gUa(Da),Object(ba.a)(ke.a,
N),this);this.zLe(fb,Da);Da=this.Fqa(N);this.$xf(Da,!1);return fb}sYh(){const N=this.$k?this.$k.length:0,Da=this.hE,fb=this.U0;for(let Wb=0;Wb<N;Wb++){const Jc=this.e0(Wb),md=Wb>=Da;Jc&&(Jc.tabIndex=md&&Wb<=fb?0:-1)}}xCk(){const N=this.$k?this.$k.length:0;for(let Da=0;Da<N;Da++){const fb=this.e0(Da);fb&&fb.Zqb()}}$xf(N,Da){Da&&N<=this.hE&&this.hE++;this.sYh();this.V0a(!0);this.G7();this.Dlc&&this.JW&&this.w1b()}uMc(N){const Da=this.$.HR;if(N||this.isRtl!==Da)this.isRtl=Da,this.domElement.classList.remove(this.isRtl?
na.a.Rcf:na.a.Vcf),this.domElement.classList.add(this.isRtl?na.a.Vcf:na.a.Rcf),this.domElement.dir=this.isRtl?"rtl":"ltr",this.xCk();N||this.V0a(!0);for(N=0;N<this.nT.length;N++)0!==N&&3!==N&&4!==N&&5!==N&&this.fvg(N)}XIh(){const N=this.Yae=document.createElement("div");N.className=ua.E2h;N.classList.add(ua.F2h);this.domElement.appendChild(N);this.h3e(N,1,717,716);this.h3e(N,2,719,718);this.yKf&&(this.a1a=new zc(this.$,this,N))}YIh(){const N=this.Zae=document.createElement("div");N.className=ua.G2h;
this.domElement.appendChild(N);this.Qld()}dKh(){const N=document.getElementById(Lb.a.afk),Da=document.getElementById(Lb.a.bfk);N&&!Da&&h.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${N.parentNode.id}. progressBar div has child: ${!!N.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(Lb.a.Pae)}`);const fb=Yb.a.FKf(this.$);if(fb&&N&&Da)this.domElement.appendChild(N),this.Aob=N.firstChild,
this.Bob=document.getElementById(Lb.a.Pae),Da.style.visibility="visible";else{const Wb=document.createElement("div"),Jc=document.createElement("div");Wb.className=na.a.N2h;Jc.className=na.a.L2h;Jc.id=Lb.a.Oae;Jc.style.display="none";const md=document.createElement("div");md.className=na.a.O2h;const sd=document.createElement("div");sd.className=na.a.M2h;const Od=document.createElement("div");Od.className=na.a.K2h;Jc.appendChild(md);Jc.appendChild(sd);Jc.appendChild(Od);Wb.appendChild(Jc);this.domElement.appendChild(Wb);
this.Aob=Jc;this.Bob=sd;h.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",fb,N,Da)}}fvg(N){var Da=this.nT[N];if(Da){const fb=Da.parentNode;this.Rjg(Da);Da=ib.a(this.$)?this.lcg[N]:this.KSd[N];this.nT[N]=this.svgIconProvider.Lia(Da,12,12,fb,24,24)}}Rjg(N){(null===N||void 0===N?0:N.parentNode)&&N.parentNode.removeChild(N)}vGh(){const N=
this.zob=document.createElement("div");N.className=ua.y2h;this.domElement.appendChild(N);this.gLh(N)}gLh(N){const Da=document.createElement("div");Da.className=ua.Q2h;Da.classList.add(ua.z2h);this.$.printingEnabled||Da.classList.add(xc.a.Aff);N.appendChild(Da);this.Dq=document.createElement("ul");Na.DOMElementExtensions.ME(this.Dq,Lb.a.Mdd,null,null);this.Dq.className=xc.a.Wcf;Da.appendChild(this.Dq);this.RIh();this.DFe=document.createElement("div");this.pNc.id="SheetIconTooltipContainer";Da.appendChild(this.pNc)}RIh(){const N=
document.createElement("div"),Da=document.createElement("div"),fb=fe.a.Bnf(na.a.F3h);Da.className=na.a.Pyh;Da.appendChild(fb);N.appendChild(Da);N.className=ua.P2h;Na.DOMElementExtensions.setVisible(N,!1);this.Dq.appendChild(N)}hmd(){const N=this.$.sa;for(let Da=0,fb=N.count;Da<fb;Da++){const Wb=Object(ba.a)(ke.a,N.getItem(Da));0===Wb.QE&&(this.Pic(Wb,!0),Wb.active&&Wb.activate({scenario:"createSheetTabs"}))}}qid(){Va.a.Wf(this.$k);this.$k=[];this.U0=this.hE=0}h3e(N,Da,fb,Wb){const Jc=document.createElement("a");
N.appendChild(Jc);N=this.KSd[Da];this.nT[Da]=this.Ee(Jc,Pa.a.instance.ia(Wb),0,this.ihj[Da],Pa.a.instance.ia(fb),N);if(5===Da||4===Da)Na.DOMElementExtensions.eK(this.nT[Da],Jc,!1,"span").style.marginTop="10px";this.fvg(Da);fb=this.JSd[Da]=this.Zh.Kh(Jc);Ca.a.instance.va(Ta.a.yg,Jc,sd=>sd.ctrlKey&&this.$nj(Da)?!0:this.A4f(Da));Ca.a.instance.va(Ta.a.Hk,Jc,()=>this.B4f());cb.a.instance.va(Ta.a.Uh,Jc,()=>this.B4f());Ca.a.instance.va(Ta.a.gx,Jc,()=>this.gid());hb.KeyInputManager.instance.va(Ta.a.Hf,Jc,
sd=>13!==sd.Ga.keyCode&&32!==sd.Ga.keyCode||this.rkd?!1:(this.rkd=!0,this.A4f(Da)));hb.KeyInputManager.instance.va(Ta.a.mh,Jc,sd=>13===sd.Ga.keyCode||32===sd.Ga.keyCode?(this.rkd=!1,this.gid()):!1);const md=this.AOe();Wb=sd=>{"mouseup"===sd.type&&this.JW||ge.g(sd);!Jc.classList.contains(U.a.L4)&&md&&this.Cuj(sd,Da)};fb.ta("mouseover",Wb);fb.ta("mouseout",Wb);fb.ta("focus",Wb);fb.ta("blur",Wb);md&&fb.ta("mouseup",Wb)}SVi(N){let Da=!1;const fb=this.$.Bi;fb&&(Da=S.a.$S(Na.DOMElementExtensions.getBoundingClientRect(fb),
N.clientPoint));return Da}w1b(){if(!this.jS){h.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.jS=this.Eha.cloneNode(!0);if(!this.$pg(this.jS,this.Eha,!0,"UpdateDragAndDropState"))return;this.Eha.style.visibility="hidden";this.jS.classList.add(ua.R2h);this.jS.style.borderRightWidth="";this.isc=this.saa.clientPoint.x-this.Gaa.width/2;this.jS.style.left=this.isc+"px";this.dI=this.Fqa(this.Z6);0>this.dI&&h.ULS.sendTraceTag(537153742,
0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Dlc&&(this.dI=this.Fqa(this.Z6));var N=Na.DOMElementExtensions.getBoundingClientRect(this.Dq);const Da=N.x;N=N.x+N.width;let fb=this.saa.clientPoint.x-this.Gaa.width/2;fb=Math.min(fb,N-this.Gaa.width);fb=Math.max(fb,Da);this.jS.style.transform="translateX("+Math.abs(fb-this.isc)*(this.isc<fb?1:-1)+"px)";const Wb=this.saa.clientPoint.x>this.YOb;let Jc=this.saa.clientPoint.x;fb>=N-this.Gaa.width?(Jc=N-this.Gaa.width/2,this.d8d()||
this.Jua||(h.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.AFc=this.Dq.scrollLeft,this.Jua=window.requestAnimationFrame(this.Frg))):fb<=Da?(Jc=Da+this.Gaa.width/2,this.c8d()||this.Jua||(h.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.AFc=this.Dq.scrollLeft,this.Jua=window.requestAnimationFrame(this.Erg))):
this.Jua&&(h.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.Lee());this.saa.clientPoint.x!==this.YOb&&(this.tfe(Wb,Jc),this.YOb=this.saa.clientPoint.x);this.d2c=!0}tfe(N,Da){let fb;for(;(()=>{let Wb=this.yUh(Da,N);({Rfc:fb}=Wb);return Wb})().returnValue;)this.h0b=fb,this.zih(N)}zih(N){if(this.h0b){var Da=(N?1:-1)*this.Gaa.width;if(N&&!this.$.HR||!N&&this.$.HR){var fb=this.Eha;var Wb=this.dI+1;var Jc=!0}else fb=
(Wb=this.e0(this.dI+1))?Wb.domElement:null,Wb=this.dI-1,Jc=!1;if(this.$pg(this.h0b,fb,Jc,"AnimateSheetSwap")){h.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.dI} and other sheet-index ${Wb}. amount of sheets in the bar: ${this.Wae} isMovingRight: ${N}`);0<=this.dI&&this.dI<this.$k.length&&0<=Wb&&Wb<this.$k.length?(N=this.$k[Wb],this.$k[Wb]=this.$k[this.dI],this.$k[this.dI]=N):(h.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.$k.length}, ghostIndex: ${this.dI}, swappedSheetIndex: ${Wb}`),
this.A_());this.dI=Wb;var md=this.h0b;md.style.transform="translateX("+Da+"px)";window.requestAnimationFrame(()=>{md.style.transform="translateX(0px)"})}}}$pg(N,Da,fb,Wb){const Jc=md=>md?`Node ID: ${md.id} , Node class: ${md.className}, Node name: ${md.nodeName},`:null;try{return this.Dq.insertBefore(N,Da),!0}catch(md){return N=this.IGb(this.Z6),h.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
N?N!==this.wlc?"Changed":"NoChange":"Removed",Wb,Jc(Da),Jc(Da.parentNode),Jc(this.Dq),fb,this.dI,this.Wae,md),this.A_(),!1}}yUh(N,Da){var fb=this.$.HR===Da?this.e0(this.dI-1):this.e0(this.dI+1);if(!fb)return{returnValue:!1,Rfc:null};fb=fb.domElement;const Wb=Na.DOMElementExtensions.getBoundingClientRect(fb);return this.Gaa?Da?{returnValue:N+this.Gaa.width/2>=Wb.x+.5*Wb.width,Rfc:fb}:{returnValue:N-this.Gaa.width/2<=Wb.x+.5*Wb.width,Rfc:fb}:(h.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.A_(),{returnValue:!1,Rfc:fb})}Crg(N,Da){let fb;fb=Da?this.Frg:this.Erg;if(-1===this.mPc)this.mPc=N,this.Jua=window.requestAnimationFrame(fb);else{N=Math.floor((N-this.mPc)/1E3*300);var Wb=this.vXb>this.yPb?1:-1;this.scrollLeft(Math.abs(this.Dq.scrollLeft-(Da?this.AFc+N*Wb:this.AFc-N*Wb))*(Da?-1:1));if(N=this.Cpf("ScrollStep"))this.tfe(Da,N.x+N.width/2),Da&&!this.d8d()||!Da&&!this.c8d()?this.Jua=window.requestAnimationFrame(fb):(h.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.Lee())}}d8d(){const N=this.vXb>this.yPb;return N&&this.uva>=this.vXb||!N&&this.uva<=this.vXb}c8d(){const N=this.vXb>this.yPb;return N&&this.uva<=this.yPb||!N&&this.uva>=this.yPb}Lee(N){N=void 0===N?!0:N;this.Dq&&(this.uva=this.Dq.scrollLeft);window.cancelAnimationFrame(this.Jua);this.Jua=0;this.mPc=-1;N&&this.G7()}$9d(N,Da){N||h.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${Da}`);this.Gaa=N}$nj(N){return 2===N?(this.rla(3),
!0):1===N?(this.rla(0),!0):!1}A4f(N){h.ULS.shipAssertTag(537153732,0,-1===this.qZa&&-1===this.pZa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.qZa&&(window.clearTimeout(this.qZa),this.qZa=-1);-1!==this.pZa&&(window.clearInterval(this.pZa),this.pZa=-1);this.rla(N);this.qZa=window.setTimeout(()=>{this.Wpk(N)},this.Wgj);return!0}Wpk(N){this.pZa=window.setInterval(()=>{this.rla(N)},this.Vgj)}B4f(){this.gid();
return!this.JW}gid(){window.clearTimeout(this.qZa);window.clearInterval(this.pZa);this.pZa=this.qZa=-1;return!0}Cuj(N,Da){const fb=this.Lwc(Da),Wb=5===Da;"mouseup"!==N.type||!Wb&&4!==Da||(fb||this.reorderSheets(null,Wb,!1),this.A_())}Lwc(N){return!!Na.DOMElementExtensions.$of(this.nT[N],"a").title}iTc(N){this.Sje(N);this.G7()}Sje(N){(N=this.IGb(N))&&N.Zqb()}h8d(){var N=this.$.sa;if(N.na&&(!Kc.e(this.$)||N.count))if(N=this.Fqa(N.na),-1===N)h.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");
else{var Da=this.gUa(N);N<this.hE?this.lLc(N):N>this.hE&&!this.mLd(Da)&&this.scrollIntoView(N)}}MDk(){this.hE=0;this.U0=this.$k.length-1;let N=!1;for(let Da=0;Da<this.$k.length;Da++){const fb=this.e0(Da);if(!fb)break;const Wb=this.mLd(fb.domElement);fb.tabIndex=Wb?0:-1;if(!N&&Wb)this.hE=Da,N=!0;else if(N&&!Wb){this.U0=Da-1;break}}}lLc(N){this.$.sa.count&&(this.$k.length||this.hmd(),this.otg(this.gUa(Math.max(0,Math.min(N,this.$k.length-1)))),this.G7())}scrollIntoView(N){h.ULS.shipAssertTag(537153697,
0,N>=this.hE,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.sa.count){this.$k.length||this.hmd();var Da=this.gUa(Math.max(0,Math.min(N,this.$k.length-1))),fb=this.gUa(this.hE);if(!this.mLd(Da)){Da=Na.DOMElementExtensions.getBoundingClientRect(Da);var Wb=Na.DOMElementExtensions.getBoundingClientRect(this.zob);Da=this.isRtl?Wb.x-Da.x:Da.x+Da.width-(Wb.x+Wb.width);for(Wb=0;fb&&Wb<Da;){const Jc=Na.DOMElementExtensions.getBoundingClientRect(fb);
Wb+=Jc.width;fb=fb.nextSibling}fb?this.otg(fb):h.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.hE}, lastVisibleSheetTabIndex = ${this.U0}, scroll to index: ${N}`)}this.G7()}}otg(N){const Da=Na.DOMElementExtensions.getBoundingClientRect(this.Dq);N=Na.DOMElementExtensions.getBoundingClientRect(N);this.isRtl?this.scrollLeft(Math.floor(Da.x+Da.width-(N.x+N.width+.5))):this.scrollLeft(Math.ceil(Da.x-N.x-.5))}scrollLeft(N){(0>
N&&this.d8d()||0<N&&this.c8d())&&h.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const Da=this.Dq.scrollLeft;if(this.isRtl){if(R.a.bD||R.a.hj){this.Dq.scrollLeft=this.uva=Da-N;return}if(R.a.tK){this.Dq.scrollLeft=this.uva=Da+N;return}h.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Dq.scrollLeft=this.uva=Da-N}mLd(N){N=Na.DOMElementExtensions.getBoundingClientRect(N);const Da=Na.DOMElementExtensions.getBoundingClientRect(this.zob);
return N&&Da?N.x>=Da.x-1&&N.x+N.width<=Da.x+Da.width+1:(h.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}tJh(){const N=this.Zae;fa.Lxg(this.$)?(Va.a.Sa(this.wW),this.wW=new fa(N,this.$,this,!0)):(Va.a.Sa(this.wW),bc.m(this.$.Rh)?this.wW=new Ed(N,this.$,this):this.wW=new fa(N,this.$,this))}q3e(N,Da){var fb=this.$.sa;if(!this.$.isEditMode||!fb.count)Va.a.Sa(Da),Da=null;else if(!Da)if(fb=this.Yae,bc.m(this.$.Rh))Da=new Ed(fb,
this.$,this);else switch(N){case 0:Da=new fa(fb,this.$,this);break;case 1:Da=new ub(fb,this.$,this);break;default:h.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Da}Qld(){this.RXi?(this.wW=this.q3e(0,this.wW),this.xLb=this.q3e(1,this.xLb)):this.tJh()}Cpf(N){const Da=Na.DOMElementExtensions.getBoundingClientRect(this.jS);
Da||(h.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${N}: GetBoundingClientRect returned null for the dragged sheet.`),this.A_());return Da}Sxf(N,Da){this.dCa.Mjh(N,Da);this.A_(!1);this.z$d(this.navigationButtonsDisabled);for(const fb of this.Lsk)fb&&fb.fY(this.navigationButtonsDisabled);for(const fb of this.ESe)fb&&fb.fY(this.operationButtonsDisabled)}static LXj(N,Da,fb,Wb){N<fb?(Da>fb&&fb--,Da>Wb&&Wb--):N>Wb?(Da<fb&&fb++,Da<Wb&&Wb++):Da<fb&&fb++;return{pai:fb,y5i:Wb}}}Object(f.a)(td,"SheetTabBarControl",
pb.a,[685,2,54]);var zd=a(703);Object(Aa.b)(Ka.Qd,{nn:"singleton"})(N=>Lo(function*(){const Da=yield Aa.a.resolve(Ka.nb,N);var fb=Da.Af;if(qc.a(Da.xa,1))return lc.a.instance.K_a(Lb.a.Yda,["sheetTabBar"]),null;fb=document.getElementById(fb+Lb.a.Hjc);if(!fb)return lc.a.instance.K_a(Lb.a.Yda,["sheetTabBar"]),null;lc.a.instance.zla(Lb.a.Yda);const Wb=yield Aa.a.resolve(zd.m,N);return new td(Da,fb,Wb)}));class me extends Rb.a{constructor(N){super();this.$=N;this.Dg()}create(){var N=this.$.Af;if(qc.a(this.$.xa,
1))lc.a.instance.K_a(Lb.a.Yda,["sheetTabBar"]);else{var Da=document.getElementById(N+Lb.a.Hjc);if(Da){if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8494154_FixSheetTabBarInitTime")&&(N=this.$.ja.Qa(32))){this.Df(N);return}lc.a.instance.zla(Lb.a.Yda);var fb=Tb.GetServiceTaskFactory.vf(this.$.ja,388,387,this.$a);zb.TaskExtensions.Ca(zb.TaskExtensions.Dh([fb],this.$.qa),()=>{this.Df(this.$.ja.Qa(32)||new td(this.$,Da,fb.result))},this.$.qa,3)}else lc.a.instance.K_a(Lb.a.Yda,["sheetTabBar"])}}static ta(N){N.ja.$c(33,
new me(N))}}Object(f.a)(me,"SheetTabBarFactory",Rb.a,[]);var Ae=a(32),ze=a(342),Ne=a(370),hf=a(395),rf=a(33),df=a(241),Af=a(252);class Pc{constructor(N,Da,fb,Wb){this.red=N;this.green=Da;this.blue=fb;this.alpha=Wb}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(f.a)(Pc,"ColorObject",null,[]);class eb{constructor(N){this.N3=this.ML=null;this.Mgd=N}get head(){return this.ML}get Ife(){return this.N3}r6e(N){this.head&&(N.pre?N.next?(N.pre.next=
N.next,N.next.pre=N.pre):(this.N3=N.pre,this.Ife.next=null):N.next?(this.ML=N.next,this.head.pre=null):this.N3=this.ML=null,N.next=null,N.pre=null)}Zbh(N){this.head?(N.next=this.head,this.ML=N,N.next.pre=this.head):this.N3=this.ML=N}Kyd(){if(!this.head)return null;const N=new K.a;let Da=this.head;for(;Da;)if(N.add(Da.value),Da=Da.next,N.count>this.Mgd){h.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return N}}Object(f.a)(eb,"CustomLinkedList",
null,[]);class gc{constructor(N){this.pre=this.next=null;this.value=N}}Object(f.a)(gc,"CustomLinkedListNode",null,[]);class Qc{constructor(N){this.Mgd=N;this.fCc={};this.bib=new eb(N);this.count=0}add(N,Da){N&&Da?(Da=new gc(Da),this.contains(N)?this.bib.r6e(this.fCc[N]):this.count<this.Mgd?this.count++:(delete this.fCc[this.bib.Ife.value.toString()],this.bib.r6e(this.bib.Ife)),this.bib.Zbh(Da),this.fCc[N]=Da):h.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${N} or Value ${Da} is null.`)}Kyd(){return this.bib.Kyd()}contains(N){return N?
N in this.fCc:!1}}Object(f.a)(Qc,"MRUCache",null,[]);class Vc extends Q.a{constructor(N,Da,fb,Wb){Wb=void 0===Wb?null:Wb;super(!1,!1,!0);this.moreColorsHelper=null;this.Xzh=(Jc,md)=>{this.MZe(Jc,md)};this.$=N;this.ILi=Da;this.TBf=fb;this.NZe=Wb}uj(){const N=Pa.a.instance.ia(1346),Da={};Da[Vc.SRg]=this.ILi;Da[Vc.XPg]=Vc.c3b;Da[Vc.NRg]=Vc.c3b;Da[Vc.nTg]=Vc.c3b;Da[Vc.aTg]=Vc.c3b;Da[Vc.FSg]=Pa.a.instance.ia(2105);Da[Vc.GRg]=Pa.a.instance.ia(2089);Da[Vc.lQg]=Pa.a.instance.ia(2076);Da[Vc.LRg]=Pa.a.instance.ia(1347);
Da[Vc.YPg]=Pa.a.instance.ia(1348);this.TBf!==Vc.ZPg&&(Da[Vc.$Pg]=Vc.ALPHA,Da[Vc.ALPHA]=this.TBf);this.initializeAndShow(N,this.Xzh,{[Vc.pRg]:Vc.MQg,[Vc.mQg]:Da})}MZe(N,Da){Da=Da[Vc.cVc];1===N&&this.sXf(gd.a.Cda(Da));this.NZe&&this.NZe(1===N,1===N?Da:null)}sXf(N){this.moreColorsHelper||(this.moreColorsHelper=Ka.yc.$e()?Aa.a.mg(Ka.yc):this.$.ja.Qa(398));N=He.a.RF(gd.a.dK(N,!1));this.moreColorsHelper.YKc(N.r,N.g,N.b,Ne.a.b3b)}}Vc.SRg="initColor";Vc.pRg="id";Vc.MQg="ColorPickerDialog";Vc.mQg="bodyControls";
Vc.cVc="selectedColorText";Vc.NRg="hueAriaLabel";Vc.nTg="transparencyAriaLabel";Vc.aTg="svAriaLabel";Vc.c3b="Use left & right arrows keys to change values in color picker & hue slider";Vc.ALPHA="alpha";Vc.IUc="alphaValue";Vc.XPg="alphaAriaLabel";Vc.$Pg="alphaSliderType";Vc.ZPg=-1;Vc.kSg=100;Vc.FSg="redLabel";Vc.lQg="blueLabel";Vc.GRg="greenLabel";Vc.LRg="hexLabel";Vc.YPg="alphaLabel";Object(f.a)(Vc,"MoreColorsDialog",Q.a,[]);var Id=a(547);class be extends Vc{constructor(N,Da,fb,Wb,Jc){super(N,Wb,
Jc);this.commandName=null;this.jEf=!1;this.command=Da;this.xg=fb;this.yLi=Jc}uj(){super.uj();this.commandName=Pd.b().hm(this.xg.command);h.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.xg.Ch}`)}MZe(N,Da){if(1===N)if(N=this.$.Ve.wj("UserAction",this.commandName),N.start(),Id.a(N),Da)if(Vc.cVc in Da){var fb=Da[Vc.cVc];if(N=gd.a.Cda(fb)){fb=new hd.a(this.command,this.xg.method,this.xg.mode,this.xg.Ch,this.xg.tabName?
this.xg.tabName:1378078823===this.command||-400966242===this.command?Lb.a.eIa:Lb.a.rQ);var Wb={};Wb.Color=N;Wb.UILocation=this.xg.Ch;Vc.IUc in Da&&(this.yLi!==Da[Vc.IUc]&&(this.jEf=!0),Wb.Alpha=(Da[Vc.IUc]/Vc.kSg).toString(),h.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ha.Me(fb,Wb);this.$.Tj();this.sXf(N);Da={["Command"]:this.commandName,["Location"]:this.xg.Ch};Da.AlphaApplied=this.jEf.toString();ue.b(this.$).Gg(ie.a.Pfj,Da,null,!0)}else this.hide(),
h.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${fb}, Command: ${this.commandName}`)}else this.hide(),h.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),h.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(f.a)(be,"MoreColorsRibbonDialog",Vc,[]);Object(Aa.b)(Ka.yc,{nn:"singleton"})(N=>Lo(function*(){const Da=yield Aa.a.resolve(Ka.nb,
N),fb=(yield Aa.a.resolve(Ka.qd,N)).qOd();return new Vb(Da,fb)}));class Vb{constructor(N,Da){this.zDe="00FFFF";this.ADe="0000FF";this.Ogg="00FFFF";this.Pgg="BF7000";this.YZa=null;this.$qf=!1;this.ize=null;this.Vv=nb.EwaSettings.ho("MoreColorsHelper");this.Tid=()=>{var fb;null===(fb=this.SPd)||void 0===fb?void 0:fb.abort()};this.hxf=fb=>{fb&&fb.key&&(1===fb.key.length||"Backspace"===fb.key||"Delete"===fb.key||"Enter"===fb.key?(fb.preventDefault(),fb.stopImmediatePropagation()):this.Tid())};this.rrj=
fb=>{if(!df.a(fb)){fb=fb.Result;this.YZa=new Qc(10);for(let Jc=fb.length-1;0<=Jc;Jc--){var Wb=fb[Jc];Wb=new Pc(Wb.Red,Wb.Green,Wb.Blue,Wb.Alpha);this.YZa.add(Wb.toString(),Wb)}this.Vag();h.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.qrj=()=>{h.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.i1=()=>{this.Enc()};this.jD=()=>{this.Enc()};this.$=N;this.LPb=
Da;Ka.yc.$e()||this.$.ja.$c(398,this);this.Vv?this.$.ea.nv?this.jD():this.$.ea.IO(this.jD):this.$.ea.ei?this.Enc():this.$.ea.zm(this.i1)}get FPb(){return this.ize}get ZZa(){return this.zDe}set ZZa(N){this.zDe=N}get cmb(){return this.ADe}set cmb(N){this.ADe=N}get UHc(){return this.Ogg}set UHc(N){this.Ogg=N}get VHc(){return this.Pgg}set VHc(N){this.Pgg=N}Thb(N,Da,fb,Wb){Wb=void 0===Wb?-1:Wb;return this.LPb?zb.TaskExtensions.Ca(this.LPb,()=>{(new be(this.$,N,Da,fb,Wb)).uj()},this.$.qa):null}vPb(N,Da){const fb=
window.EyeDropper;if(!fb||!N||!Da)return lb.Task.Ra(!1);let Wb=null;switch(N){case 1188510340:Wb=1650812936;break;case -1828502776:Wb=1970784898;break;case -1252156667:Wb=1378078823;break;case -2063061844:Wb=-400966242;break;case -260488795:Wb=-236759591;break;case -605730035:Wb=467002767;break;case -984702347:Wb=409031041;break;default:return h.ULS.shipAssertTag(508063765,0,!1,`Invalid eyedropper command ${N}`),lb.Task.Ra(!1)}N=new fb;this.SPd=new AbortController;const Jc=Pd.b().hm(Da.command);N.open({signal:this.SPd.signal}).then(md=>
{var sd=this.$.Ve.wj("UserAction",Jc);sd.start();Id.a(sd);md=gd.a.Cda(md.sRGBHex);if(!md)return h.ULS.shipAssertTag(508065669,0,!1,"MoreColorsHelper.launchEyedropper: Failed to return the color in expected format BBGGRR."),lb.Task.Ra(!1);sd=new hd.a(Wb,Da.method,Da.mode,Da.Ch,Da.tabName);this.$.Ha.Me(sd,{["Color"]:md,["UILocation"]:Da.Ch});this.$.Tj();md=He.a.RF(gd.a.dK(md,!1));null!=md&&this.YKc(md.r,md.g,md.b,Ne.a.b3b);md={["Command"]:Pd.b().hm(Da.command),["Location"]:Da.Ch};ue.b(this.$).Gg(ie.a.a8h,
md,null,!0);return lb.Task.Ra(!0)}).catch(md=>{h.ULS.sendTraceTag(508065668,0,10,"MoreColorsHelper.launchEyedropper: Failed to apply eyedropper color. Exception: {0}",md.toString());return lb.Task.Ra(!1)}).finally(()=>{window.removeEventListener("blur",this.Tid);window.removeEventListener("keydown",this.hxf,!0);this.SPd=null});window.addEventListener("blur",this.Tid);window.addEventListener("keydown",this.hxf,!0);return lb.Task.Ra(!0)}k6i(N,Da){var fb=void 0;fb=void 0===fb?-1:fb;Da=void 0===Da?null:
Da;this.LPb&&zb.TaskExtensions.Ca(this.LPb,()=>{(new Vc(this.$,N,fb,Da)).uj()},this.$.qa)}xvi(N){let Da=null;switch(N){case "QueryRecentFillColor":Da=this.ZZa;break;case "QueryRecentFontColor":Da=this.cmb;break;case "QueryRecentShapesFillColor":Da=this.UHc;break;case "QueryRecentShapesOutlineColor":Da=this.VHc}return Da?Ae.a.Jdb(Da):null}dispose(){this.LPb=null;this.$&&(this.Vv?this.$.ea.CX(this.jD):this.$.ea.cq(this.i1))}Enc(){if(this.$.isEditMode)if(this.YZa)this.Vag();else{this.$qf&&h.ULS.sendTraceTag(575939106,
0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var N=this.$.oa.ua;this.$.userOperationManager.enqueueOperation(new oc.a(1009,0,(Da,fb,Wb)=>{Da=Af.b.call(null,Da,this.rrj);fb=Af.a.call(null,fb,this.qrj);const Jc=N.Oa(1,null);return Nc.h(N,"GetMRUColors",Jc,Da,fb,Wb,null,4)},80),null);this.$qf=!0}}Vag(){var N=this.YZa.Kyd();if(N){this.ize=new K.a;for(const Da of N)N=Da,N=new He.a(N.red,N.green,N.blue),this.FPb.add(gd.a.lL(N))}}YKc(N,
Da,fb,Wb){this.YZa||(this.YZa=new Qc(10));const Jc=new Pc(N,Da,fb,Wb);this.YZa.add(Jc.toString(),Jc);this.saveMRUColor(null,N,Da,fb,Wb)}Ska(N,Da,fb){(N||this.$.isEditMode)&&this.tyg(N.SqmControlId)&&(N=He.a.RF(gd.a.dK(Da,!1)))&&(this.YKc(N.r,N.g,N.b,Ne.a.b3b),fb={["Command"]:Pd.b().hm(fb.command),["Location"]:ze.a[fb.Ch],["InputMethod"]:kc.a[fb.method]},ue.b(this.$).Gg(ie.a.Ska,fb,null,!0))}tyg(N){return!!N&&N.startsWith("RecentColorPicker")}saveMRUColor(N,Da,fb,Wb,Jc){return hf.a(this.$.userOperationManager,
(md,sd,Od)=>{var Ce=this.$.oa.ua;md=Af.b(md,Vb.Uwj());sd=Af.a(sd,Vb.Twj());const Qe=Ce.Oa(9,null);Qe.bRed=Da;Qe.bGreen=fb;Qe.bBlue=Wb;Qe.bAlpha=Jc;return Nc.h(Ce,"SaveMRUColor",Qe,md,sd,Od,null,0)},md=>new oc.a(1008,0,md),N)}static Uwj(){return N=>{rf.a.Ai(N.Errors)?h.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):h.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static Twj(){return()=>
{h.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(f.a)(Vb,"MoreColorsHelper",null,[663,2]);class Gc extends Rb.a{constructor(N){super();this.$=N;this.Dg()}create(){const N=new cd.a;this.$.zP(fb=>{fb=fb.qOd();zb.TaskExtensions.Ca(fb,()=>{N.setResult(!0)},this.$.qa)});const Da=N.task;this.Df(this.$.ja.Qa(398)||new Vb(this.$,Da))}static ta(N){N.ja.$c(397,new Gc(N))}}Object(f.a)(Gc,"MoreColorsHelperFactory",Rb.a,[]);var Bb=a(2),uc=a(590),Dc=
a(587),kd=a(398),xd=a(662);class Pb{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(f.a)(Pb,"ColorCellProps",null,[]);var Ec=a(232),ed=a(230),Td=a(315),Rd=a(22);class Ke{constructor(N){this.UWc=null;this.$=N;this.grid=se.h(this.$)}get borderFormatManager(){this.UWc||(this.UWc=this.$.ja.Qa(296));return this.UWc}cpi(N){var Da=null;switch(N){case 467002767:Da={};this.$.Pn(Da);Da=Object(ba.a)(ne.a,this.$.sa).huf(Da.SheetName,!0);break;case -236759591:Da=this.Uhi();break;
case 1970784898:Da=this.Zxd(0);break;case 1650812936:case 1378078823:Da=this.Zxd(1);break;case -400966242:Da=this.getShapeOutlineColor();break;case 1597684571:nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&this.grid.ha.Ua&&this.grid.ha.Ua.gf&&(N=this.grid.ha.Ua.gf.floatingObject,0===N.type&&N.kg&&(Da=this.Zxd(1)));break;case 409031041:nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&(Da=this.onf(N));break;default:h.ULS.sendTraceTag(537154460,
0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${N}'`)}return Da}Uhi(){let N=null;this.borderFormatManager&&(N=this.borderFormatManager.oaa);(N="black"===N?"000000":N)&&(N=Ae.a.Jdb(N));return N}getShapeOutlineColor(){let N=null;if(this.grid.ha.Ua&&this.grid.ha.Ua.gf){const Da=this.grid.ha.Ua.gf.floatingObject;5===Da.type&&Da.Ue&&-1!==Da.Ue.ShapeOutlineColor&&(N=gd.a.mL(Da.Ue.ShapeOutlineColor),N=N.toUpperCase())}return N}onf(N){let Da=
null;if(this.grid.ha.Ua&&this.grid.ha.Ua.gf){const fb=this.grid.ha.Ua.gf,Wb=fb.floatingObject;0===Wb.type&&Wb.kg&&(Da=fb.lJb(N))}return Da}Zxd(N){let Da=null;if(this.grid.ha.Ua&&this.grid.ha.Ua.gf){var fb=this.grid.ha.Ua.gf.floatingObject;if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&0===fb.type&&fb.kg){if(0===N||1===N)Da=this.onf(1970784898);return Da}5===fb.type&&fb.Ue?1===N&&-1!==fb.Ue.ShapeFillColor?(Da=gd.a.mL(fb.Ue.ShapeFillColor),Da=Da.toUpperCase()):h.ULS.sendTraceTag(537154459,
0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):h.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return Da}fb=this.grid.maa("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.pa.selectedRanges,1,!0);try{for(fb.$$rst();fb.$$mn();){const Wb=fb.$$cu().cell;if(!Wb)continue;let Jc="#000000";if(0===N){Jc=
Wb.color;if(this.grid.De)return this.Rni();Wb.hasRichText&&(Jc=this.Sni(Wb))}else if(1===N){const md=Wb.backgroundColor;Jc=Rd.a.compare(md,"transparent",!0)&&md?Wb.backgroundColor:null}if(!Da)Da=Jc;else if(Da!==Jc){Da=null;break}}}finally{fb&&fb.dispose()}return Da}Rni(){var N=null,Da=this.grid.kf,fb=this.grid.cellTextEditBox.formattedText;if(fb){N=fb.TextRuns;const Wb=Ec.a.map(N,Jc=>Jc.StartIndex);fb=fb.Fonts;Da=Da.Ja.caretPosition;Da=Zd.HelperMethods.xif(new ed.a(Wb),Wb.length,Da,Zd.HelperMethods.EK);
N=fb[N[Da].FontID].Color}return N?N.toUpperCase():null}Sni(N){N=Td.a(N.formattedText.Fonts);if(Td.e(N,32))(N=gd.a.Cda(gd.a.mL(N.FontColor)))&&(N="#"+N.toUpperCase());else return null;return N}}Object(f.a)(Ke,"ColorHighlighterHelper",null,[723]);var $d=a(282);class we{constructor(N,Da,fb){this.THc=this.M_b=this.WJa=null;this.asg="-1";this.$=N;this.moreColorsHelper=Da;this.Bs=fb;this.KZe=new Ke(N);this.oI=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}erf(N,Da,fb,Wb,Jc,
md,sd,Od,Ce,Qe){Da=void 0===Da?null:Da;fb=void 0===fb?null:fb;Wb=void 0===Wb?null:Wb;Od=void 0===Od?null:Od;return this.JV(null!=Da,null!=fb,null!=Wb,null!=Od,!0,N,Da,fb,Wb,void 0===Jc?null:Jc,void 0===md?null:md,void 0===sd?null:sd,Od,void 0===Ce?null:Ce,void 0===Qe?null:Qe)}jyi(N,Da,fb,Wb){return this.JV(N,Da,fb,Wb,!1)}frf(N,Da,fb,Wb,Jc,md,sd){const Od=[];N=this.erf(N,void 0===Da?null:Da,void 0===fb?null:fb,void 0===Wb?null:Wb,void 0,void 0,void 0,void 0===Jc?null:Jc,void 0===md?null:md,void 0===
sd?null:sd);for(let Ce=0,Qe=N.length;Ce<Qe;Ce++)Od.push($d.r(N[Ce]));return Od}JV(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe,lf,Oe,ag,xg,Yf){md=void 0===md?null:md;sd=void 0===sd?null:sd;Od=void 0===Od?null:Od;Ce=void 0===Ce?null:Ce;Qe=void 0===Qe?null:Qe;lf=void 0===lf?null:lf;Oe=void 0===Oe?null:Oe;ag=void 0===ag?null:ag;xg=void 0===xg?null:xg;Yf=void 0===Yf?null:Yf;h.ULS.shipAssertTag(537154456,0,!Jc||null!=md,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const Wa=[];
let vb=null,cc=3,Ic=null,dd=null,Cd=null;this.tYh();if(nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.ZFj(Yf))return h.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${Yf} menu opening`),Wa;N&&(Jc&&null==sd?h.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):Wa.push(this.bEa(we.Imh,this.Hdi(we.tSe,sd,Oe,lf))));Jc&&null!=md&&this.KZe&&(dd=
Ic="-1",vb=this.KZe.cpi(md))&&(h.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${md} is not null .`),vb=gd.a.Cda(vb),cc=this.Zpf(vb),Ic=this.qAd(vb,cc,0,!0),dd=this.qAd(vb,cc,1,!1));Wa.push(this.bEa(we.euk,this.lvd(we.nFg,Ic,this.WJa,md,Qe,lf),1341));Wa.push(this.bEa(we.rpk,this.lvd(we.qpk,dd,this.M_b,md,Qe,lf),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.XFj(),Jc&&(Cd="-1",vb&&(Cd=this.qAd(vb,cc,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.FPb&&
0<this.moreColorsHelper.FPb.count&&Wa.push(this.bEa(we.oOj,this.lvd(we.nOj,Cd,this.THc,md,Qe,lf),1349)));Da&&(Jc&&null==Od?h.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):Wa.push(this.bEa(we.Whj,this.Idi(we.mYe,Od,this.qji(Od),Oe,lf))));!fb||nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode||(z.AFrameworkApplication.Lja("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),
nb.EwaSettings.isChangeGateEnabled("OfficeVSO:8219921_HighlightWhenCG")&&z.AFrameworkApplication.fa.la("IsO365ConsumerHost")&&(Jc&&!Ce?h.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):Wa.push(this.bEa(we.xJi,this.lei(we.nAf,Ce)))));Wb&&(Jc&&null==ag?h.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):Wa.push(this.bEa(we.Qfj,this.Lei(we.tVf,ag,this.Bri(ag)))));
Yb.a.lI()&&null!=xg&&Wa.push(this.bEa(we.thf,this.$di(we.thf,xg)));return Wa}qAd(N,Da,fb,Wb){3===Da&&(Da=this.Zpf(N));return this.oI&&0===fb&&Da===fb?this.asg.toLowerCase():Da===fb?Wb?N.toLowerCase():N:"-1"}Zpf(N){if(!N)return 3;const Da=N.toLowerCase();if(this.oI){if(this.WJa&&this.A2i(Da,this.WJa))return 0}else if(this.WJa&&this.iHd(Da,this.WJa))return 0;return this.M_b&&this.iHd(N,this.M_b)?1:this.THc&&this.iHd(Da,this.THc)?2:3}bEa(N,Da,fb){fb=void 0===fb?null:fb;N=Object(Bb.a)(new Dc.a,{Id:N,
Title:null!=fb?Pa.a.instance.ia(fb):"",ControlList:[],ControlsId:N+".Controls"});N.ControlList.push(Da);return N}Idi(N,Da,fb,Wb,Jc){return this.flf(N,Da,fb,na.a.cdf,"transparent",void 0===Wb?null:Wb,void 0===Jc?null:Jc)}lei(N,Da){return Object(Bb.a)(new kd.a,{Command:null!=Da?Da.toString():null,LabelText:Pa.a.instance.ia(1433),Id:N,ExternalId:this.tTa(N,Da),ExternalImageId:"ConditionalFormatting_20"})}Hdi(N,Da,fb,Wb){return this.flf(N,Da,542,na.a.bdf,"000000",void 0===fb?null:fb,void 0===Wb?null:
Wb)}flf(N,Da,fb,Wb,Jc,md,sd){md=void 0===md?null:md;sd=void 0===sd?null:sd;return Object(Bb.a)(new kd.a,{Command:null!=Da?Da.toString():null,CommandPreviewId:null!=md?md.toString():null,CommandRevertId:null!=sd?sd.toString():null,MenuItemsStatefulData:this.gri(N,Da,Jc),LabelText:Pa.a.instance.ia(fb),Id:N,ExternalId:this.tTa(N,Da),Image16by16:fe.a.rk(1),Image16by16Class:Wb})}gri(N,Da,fb){const Wb={};N=this.tTa(N,Da);Wb[N]={};Wb[N].iconColor=fb;return Wb}iHd(N,Da){for(let fb=0;fb<Da.length;fb++)if(N===
Da[fb].Color)return!0;return!1}P0i(N,Da){N=gd.a.ls(N);Da=gd.a.ls(Da);return 1>=Math.abs(N.r-Da.r)&&1>=Math.abs(N.g-Da.g)&&1>=Math.abs(N.b-Da.b)?!0:!1}A2i(N,Da){for(let fb=0;fb<Da.length;fb++){const Wb=Da[fb].Color;if(this.P0i(N,Wb))return this.asg=Wb.toLowerCase(),!0}return!1}lvd(N,Da,fb,Wb,Jc,md){Jc=void 0===Jc?null:Jc;md=void 0===md?null:md;return Object(Bb.a)(new xd.a,{McuLayout:!0,Command:null!=Wb?Wb.toString():null,CommandPreviewId:null!=Jc?Jc.toString():null,CommandRevertId:null!=md?md.toString():
null,Width:10,Id:`${N}.ColorPicker`,SelectedColorId:Da,Colors:fb,Stateful:!0,ExternalId:this.tTa(N,Wb),McuExternalId:`${this.tTa(N,Wb)}.MCU`})}tTa(N,Da){return`${N}.${null!=Da?Da.toString():""}`}Voc(...N){const Da=[];for(let fb=0,Wb=N.length;fb<Wb;fb+=2)Da.push(Object(Bb.a)(new Pb,{Color:N[fb],DisplayColor:gd.a.lL(He.a.RF(parseInt(String("0x"+N[fb]),16))),Alt:Object(ya.a)(String,N[fb+1])&&this.$?N[fb+1]:Pa.a.instance.ia(N[fb+1])}));return Da}Lei(N,Da,fb){const Wb=na.a.tdf;N=Object(Bb.a)(new kd.a,
{Command:null!=Da?Da.toString():null,LabelText:Pa.a.instance.ia(fb),Id:N,ExternalId:this.tTa(N,Da),Image16by16:fe.a.rk(1),Image16by16Class:Wb});N.ShouldTakeFocus=!1;return N}$di(N,Da){N=Object(Bb.a)(new kd.a,{Command:null!=Da?Da.toString():null,LabelText:Pa.a.instance.ia(2401),Id:N,ExternalId:this.tTa(N,Da),Image16by16:fe.a.rk(1),ExternalImageId:"EyedropperFillColor_20"});N.ShouldTakeFocus=!1;return N}tYh(){this.WJa||(this.WJa=this.Voc("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",
1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,"cab9ac",1383,"e7c6b4",1384,"adcbf8",1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",
1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,"235637",1419));this.M_b||(this.M_b=this.Voc("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}XFj(){this.moreColorsHelper.Enc();if(this.moreColorsHelper.FPb){var N=
this.moreColorsHelper.FPb;const Da=[];for(const fb of N)N=gd.a.Cda(fb.substr(1)),Da.push(N,fb);this.THc=this.Voc(...Da)}}ZFj(N){this.Bs.ccb(N);if(this.Bs.Qpb&&this.Bs.oFg&&!this.Bs.pLf){N=this.Bs.Qpb;const Da=this.Bs.oFg,fb=[];for(let Wb=0;Wb<N.count;Wb++)fb.push(N.ka(Wb),Da.ka(Wb));this.WJa=this.Voc(...fb);return!0}return!1}Bri(N){switch(N){case -458147525:N=1344;break;case 1610379174:N=1345;break;default:N=1343}return N}qji(N){switch(N){case 1549407384:N=541;break;case -1744769642:N=539;break;default:N=
540}return N}}we.Whj="NoColor";we.Imh="Automatic";we.euk="ThemeColors";we.rpk="StandardColors";we.oOj="RecentColors";we.mYe="ClearColor";we.xJi="HighlightWhen";we.nAf="HighlightWhen";we.tSe="AutomaticColor";we.nFg="ThemeColorPicker";we.qpk="StandardColorPicker";we.Qfj="MoreColors";we.tVf="MoreColors";we.nOj="RecentColorPicker";we.thf="Eyedropper";Object(f.a)(we,"ColorPickerBuilder",null,[]);class bf{constructor(){this.sections=null}}Object(f.a)(bf,"ColorPickerButtonMenuProps",null,[]);class $e{constructor(){this.title=
null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(f.a)($e,"ColorPickerButtonMenuSection",null,[]);class $a{constructor(){this.id=this.label=this.color=null;this.index=0}}Object(f.a)($a,"ColorPickerColorProps",null,[]);class Ia{constructor(){this.type=0;this.label=null}}Object(f.a)(Ia,"ColorPickerSectionButtonProps",null,[]);class gb{constructor(){this.colors=null;this.isThemeColorSection=this.notifyOnColorUsed=!1}}Object(f.a)(gb,"ColorPickerSectionColorSwatchProps",null,[]);class Nb{constructor(){this.row=
this.index=0}}Object(f.a)(Nb,"ThemeColorInfo",null,[]);class ec{constructor(N,Da,fb,Wb){this.$=N;this.rv=Da;this.moreColorsHelper=fb;this.Bs=Wb;this.y2i=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(N){N=this.rv.vuf(N.automaticColor,N.clearColor,N.highlightWhen,N.moreColors);const Da=new bf;Da.sections=this.ovi(N);return Da}showMoreColorsDialog(N,Da){this.moreColorsHelper.k6i(N,Da)}onColorUsed(N){N=He.a.RF(gd.a.dK(gd.a.Cda(N),!1));this.moreColorsHelper.YKc(N.r,
N.g,N.b,Ne.a.b3b)}getThemeColor(N){const Da=gd.a.Cda(N);let fb,Wb;if(!(()=>{let Jc=this.Bs.getThemeColor(Da);({themeIndex:fb,XJa:Wb}=Jc);return Jc})().returnValue)return h.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;N=new Nb;N.index=fb;N.row=Wb;return N}ovi(N){const Da=[];for(let Wb=0;Wb<N.length;Wb++){var fb=Object(ba.a)(Dc.a,N[Wb]);const Jc=new $e;Jc.title=fb.Title;const md=Object(ba.a)(xd.a,fb.ControlList[0]);md?(Jc.type=1,Jc.colorSwatchProps=
this.Cji(md),Da.push(Jc)):(fb=Object(ba.a)(kd.a,fb.ControlList[0]))&&null!=this.Cnf(fb.Id)?(Jc.type=2,Jc.buttonProps=new Ia,Jc.buttonProps.type=this.Cnf(fb.Id),Jc.buttonProps.label=fb.LabelText,Da.push(Jc)):h.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return Da}Cji(N){const Da=new gb,fb=N.Colors;Da.colors=Array(fb.length);Da.notifyOnColorUsed=this.moreColorsHelper.tyg(N.ExternalId);Da.isThemeColorSection=this.y2i&&!!N.ExternalId&&N.ExternalId.includes(we.nFg);
for(N=0;N<fb.length;N++)Da.colors[N]=new $a,Da.colors[N].id=fb[N].DisplayColor,Da.colors[N].color=fb[N].DisplayColor,Da.colors[N].label=fb[N].Alt,Da.colors[N].index=N;return Da}Cnf(N){switch(N){case we.tVf:return 1;case we.mYe:return 2;case we.tSe:return 3;case we.nAf:return 4}return null}}Object(f.a)(ec,"ColorPickerButtonController",null,[675]);Object(Aa.b)(Ka.bd,{nn:"singleton"})(N=>Lo(function*(){const Da=yield Aa.a.resolve(Ka.nb,N),fb=yield Aa.a.resolve(Ka.yc,N),Wb=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)||nb.EwaSettings.Bn()?yield Aa.a.resolve(Ka.le,N):null;return new Bc(Da,fb,Wb)}));class Bc{constructor(N,Da,fb){this.yu=this.Gn=null;this.$=N;this.moreColorsHelper=Da;this.Arh();this.zrh();this.Bs=fb;this.ghc=new we(N,Da,fb)}Arh(){this.Gn={};this.Gn.style0=1535;this.Gn.style1=1536;this.Gn.style2=1537;this.Gn.style3=1538;this.Gn.style4=1539;this.Gn.style5=1540;this.Gn.style6=1541;this.Gn.style7=1542;this.Gn.style8=1543;this.Gn.style9=1544;this.Gn.style10=1545;this.Gn.style11=1546;this.Gn.style12=
1547;this.Gn.style13=1548;this.Gn.style14=1549;this.Gn.style15=1550;this.Gn.style16=1551;this.Gn.style17=1552;this.Gn.style18=1553;this.Gn.style19=1554;this.Gn.style20=1555;this.Gn.style21=1556;this.Gn.style22=1557;this.Gn.style23=1558;this.Gn.style24=1559;this.Gn.style25=1560;this.Gn.style26=1561;this.Gn.style27=1562;this.Gn.style28=1563;this.Gn.style29=1564;this.Gn.style30=1565;this.Gn.style31=1566;this.Gn.style32=1567;this.Gn.style33=1568;this.Gn.style34=1569;this.Gn.style35=1570;this.Gn.style36=
1571;this.Gn.style37=1572;this.Gn.style38=1573;this.Gn.style39=1574;this.Gn.style40=1575;this.Gn.style41=1576}zrh(){this.yu={};this.yu.style0=1507;this.yu.style1=1508;this.yu.style2=1509;this.yu.style3=1510;this.yu.style4=1511;this.yu.style5=1512;this.yu.style6=1513;this.yu.style7=1514;this.yu.style8=1515;this.yu.style9=1516;this.yu.style10=1517;this.yu.style11=1518;this.yu.style12=1519;this.yu.style13=1520;this.yu.style14=1521;this.yu.style15=1522;this.yu.style16=1523;this.yu.style17=1524;this.yu.style18=
1525;this.yu.style19=1526;this.yu.style20=1527;this.yu.style21=1528;this.yu.style22=1529;this.yu.style23=1530;this.yu.style24=1531;this.yu.style25=1532;this.yu.style26=1533;this.yu.style27=1534}Dnf(N){return $d.i(this.ghc.frf(N,null,null,null,null,null,null))}Npc(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe){Da=void 0===Da?null:Da;fb=void 0===fb?null:fb;Wb=void 0===Wb?null:Wb;Jc=void 0===Jc?null:Jc;md=void 0===md?null:md;sd=void 0===sd?null:sd;Od=void 0===Od?null:Od;Ce=void 0===Ce?null:Ce;Qe=void 0===Qe?null:Qe;
return Object(Bb.a)(new uc.a,{MenuSectionList:this.ghc.erf(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe),UpdateDynamically:!0})}vuf(N,Da,fb,Wb){return this.ghc.jyi(N,Da,fb,Wb)}Dji(N,Da,fb,Wb,Jc,md,sd){return this.ghc.frf(N,void 0===Da?null:Da,void 0===fb?null:fb,void 0===Wb?null:Wb,void 0===Jc?null:Jc,void 0===md?null:md,void 0===sd?null:sd)}Nrc(N,Da){return(void 0===Da?0:Da)?this.yu[N]:this.Gn[N]}kGh(){return new ec(this.$,this,this.moreColorsHelper,this.Bs)}O5(N){var Da;if(!nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShortcutsInContextMenus",
!1))return null;const fb=null===(Da=this.$.shortcutKeyManager)||void 0===Da?void 0:Da.vi(N);return fb?fb.substring(1,fb.length-1):null}}Object(f.a)(Bc,"PopulateDynamicHelper",null,[660]);class Wc extends Rb.a{constructor(N,Da){super();this.rv=null;this.$=Da;N.$c(111,this);this.Dg()}create(){if(nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)||nb.EwaSettings.Bn()){const N=Ka.yc.$e()?Object(qb.d)(Aa.a.resolve(Ka.yc,{Aa:this.$a})):Tb.GetServiceTaskFactory.vf(this.$.ja,398,
397,this.$a),Da=Object(qb.d)(Aa.a.resolve(Ka.le,{Aa:this.$a}));zb.TaskExtensions.Ca(zb.TaskExtensions.Dh([N,Da],this.qa),()=>{this.Df(this.rv||(this.rv=new Bc(this.$,N.result,Da.result)))},this.qa,3)}else zb.TaskExtensions.Ca(Ka.yc.$e()?Object(qb.d)(Aa.a.resolve(Ka.yc,{Aa:this.$a})):Tb.GetServiceTaskFactory.vf(this.$.ja,398,397,this.$a),N=>{this.Df(this.rv||(this.rv=new Bc(this.$,N.result,null)))},this.qa,3)}}Object(f.a)(Wc,"PopulateDynamicHelperFactory",Rb.a,[]);var od=a(203),G=a(978);class pa{constructor(N,
Da,fb,Wb,Jc,md,sd,Od,Ce,Qe){this.vQe=Da;this.sSe=void 0===fb?null:fb;this.lYe=void 0===Jc?null:Jc;this.mAf=void 0===md?null:md;this.sVf=void 0===Od?null:Od;this.rv=N;this.shf=void 0===Ce?null:Ce;this.menuId=void 0===Qe?null:Qe}q4(){let N="";const Da=this.rv.Dji(this.vQe,this.sSe,this.lYe,this.mAf,this.sVf,this.shf,this.menuId);for(const fb of Da)N+=fb;return N}xJ(){return this.rv.Npc(this.vQe,this.sSe,this.lYe,this.mAf,void 0,void 0,void 0,this.sVf,this.shf,this.menuId)}}Object(f.a)(pa,"RibbonColorPicker",
null,[682]);var Ra=a(613);class yb{constructor(N,Da){this._id=N;this.nH=void 0===Da?"":Da}get id(){return this._id}get text(){return this.nH}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(N){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");
}q4(){return`<Label id="${this._id}" LabelText="${this.nH}" />`}XX(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}OYb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}l2(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");}Egc(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}epa(){return Object(Bb.a)(new Ra.a,{Id:this.id,LabelText:this.text})}}Object(f.a)(yb,
"RibbonLabel",null,[684,681,682]);class ic{constructor(N){this.l2g=[];this.id=N}get Bf(){return this.l2g}q4(){return $d.q(this.xJ())}xJ(){const N=Object(Bb.a)(new uc.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const Da of this.Bf)Object(ya.a)(pa,Da)?N.MenuSectionList.push(...Object(ba.a)(pa,Da).xJ().MenuSectionList):N.MenuSectionList.push(Da.Wec());return N}}Object(f.a)(ic,"RibbonMenu",null,[683,682]);class bd{constructor(){this.title=null;this.c3=[];this.gv="Menu16";this.XFg=this.DAg=
this.EAg=!0}get buttons(){return this.c3}q4(){return $d.r(this.Wec())}Wec(){const N=Object(Bb.a)(new Dc.a,{ControlList:[]});if(1===this.buttons.length&&Object(ya.a)(680,this.buttons[0]))N.ControlList.push(this.buttons[0].Uec());else{let fb="";for(let Wb=0;Wb<this.buttons.length;Wb++){var Da=Object(ba.a)(681,this.buttons[Wb]);Da&&(Da=Da.epa(),N.ControlList.push(Da),fb+=Da.Id)}N.ControlsId=fb+".Controls"}N.Title=this.title;N.DisplayMode=this.gv;N.ShowMenuSectionTitleIcon=this.EAg;N.ShowMenuSectionTitleBackground=
this.DAg;N.MenuSectionTitleFocusable=this.XFg;return N}}Object(f.a)(bd,"RibbonMenuSection",null,[246,682]);class Nd{constructor(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe,lf,Oe,ag){ag=void 0===ag?null:ag;this.id=N;this.command=fb;this.Yag=Wb;this.populateOnlyOnce=Jc;this.LZa=md;this.UFj=sd;this.alt=Od;this.idc=Ce;this.width=Qe;this.dih=lf;this.EZ=Oe;this.Wya=new ic(Da);this.nRe=ag;Wb&&sd&&(N=new bd,N.gv="MenuLoading",Da=new yb(Da+"LoadingLabel"),N.buttons.push(Da),this.menu.Bf.push(N))}q4(){return this.Hph()}get menu(){return this.Wya}Hph(){let N=
$d.d(this.id,this.command,this.Yag,this.populateOnlyOnce,this.LZa,this.UFj,this.alt,this.idc,this.width);const Da=N.indexOf(" />");N=N.substring(0,Da);N+=` ${"AllowDefaultContent"}="${this.dih.toString()}"`;N+=` ${"AutoComplete"}="${this.EZ?"true":"false"}"`;this.nRe&&(N+=` ${"ArrowImgId"}="${this.nRe}"`);N=N+">"+this.menu.q4();return N+"</ComboBox>"}}Object(f.a)(Nd,"RibbonComboBox",null,[713,682]);var ce=a(931),le=a(979);class Le extends le.a{constructor(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe,lf,Oe,ag){Oe=
void 0===Oe?null:Oe;ag=void 0===ag?null:ag;super(N,Da,fb,Jc,md,sd,Od,lf,0);this.bub=null;this.k9=0===Ce?null:Pa.a.instance.ia(Ce);this.Z3c=Qe;this.$5c=Wb;this.z6g=Oe;this.Gq=ag}get description(){return this.k9}get FHb(){return this.bub}get menuItemId(){return this.Z3c}get LZa(){return this.$5c}get styles(){return this.z6g}get data(){return this.Gq}q4(){return $d.n(this.epa())}Z9d(N){this.k9=N}toString(){this.FHb||(this.bub=this.q4());return this.FHb}epa(){const N=new ce.a;this.Pnc(N);N.MenuItemId=
this.menuItemId;N.QueryCommand=this.LZa;N.Description=this.description;N.Styles=this.styles;N.Data=this.data;return N}}Object(f.a)(Le,"RibbonComboBoxItem",le.a,[247,681,682]);var Ve=a(600);class Ub extends le.a{constructor(N,Da,fb,Wb,Jc,md,sd,Od,Ce){super(N,fb,Wb,Jc,md,sd,Od,!1,0);this.populateOnlyOnce=!1;this.POb=this.menuCloseCommand=this.menuOpenCommand=this.GB=null;this.Wya=new ic(Da);this.yBf=!0;this.H8c=Ce}get menu(){return this.Wya}q4(){return $d.o(this.epa())}epa(){const N=new Ve.a;this.Pnc(N);
N.PopulateOnlyOnce=this.populateOnlyOnce;N.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();N.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();N.PopulateQueryCommand=this.GB;N.KeyTip=this.POb;N.Menu=this.menu.xJ();N.ImageIsVisible=this.yBf;N.ExternalImageId=this.H8c;return N}}Object(f.a)(Ub,"RibbonFlyoutAnchor",le.a,[248,681,682]);var Mc=a(1285),Kd=a(622);class je{constructor(){this.Ncb=[];this.id=null;this.width=0;this.title=this.lqa=
null}q4(){return $d.p(this.Uec())}Ex(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe,lf){Wb=void 0===Wb?0:Wb;Jc=void 0===Jc?null:Jc;md=void 0===md?null:md;sd=void 0===sd?null:sd;Od=void 0===Od?null:Od;Ce=void 0===Ce?null:Ce;Qe=void 0===Qe?null:Qe;lf=void 0===lf?null:lf;lf=nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShortcutsInContextMenus",!1)&&lf?Pa.a.instance.ia(Wb)+Zd.HelperMethods.EWe+lf:Pa.a.instance.ia(Wb);this.XCf(this.Ncb.length,N,Da,fb,0===Wb?Ce:lf,Jc,md,sd,Od,Qe)}XCf(N,Da,fb,Wb,Jc,md,sd,Od,
Ce,Qe){md=void 0===md?null:md;sd=void 0===sd?null:sd;Od=void 0===Od?null:Od;Ce=void 0===Ce?null:Ce;Qe=void 0===Qe?null:Qe;(N>this.Ncb.length||0>N)&&Error.argumentOutOfRange("Invalid Index");this.Ncb.splice(N,0,Object(Bb.a)(new Mc.a,{Id:Da,Command:fb.toString(),QueryCommand:null!==Wb&&void 0!==Wb?Wb:null,Alt:Jc,MenuItemId:md,Icon:sd,Image:Od?fe.a.rk(Od):null,ImageClass:Ce,LabelText:Qe}))}Uec(N){N=void 0===N?!1:N;let Da=null,fb=null;switch(this.lqa){case "Size120by20":Da=this.iBb(120,20,N);fb=this.gBb(130,
30,N);break;case "Size90by21":Da=this.iBb(90,21,N);fb=this.gBb(100,33,N);break;case "Size24by24With7Options":Da=this.iBb(24,24,N);fb=this.gBb(34,34,N);break;case "Size24by24":Da=this.iBb(28,28,N);fb=this.gBb(38,38,N);break;case "Size112by64":Da=this.iBb(24,24,N),fb=this.gBb(112,64,N)}for(N=0;N<this.Ncb.length;N++)this.Ncb[N].FullIconStyle=Da;return Object(Bb.a)(new Kd.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.lqa,GalleryItems:this.Ncb,GalleryStyle:fb})}iBb(N,
Da,fb){const Wb={},Jc={};Jc.width=N;Jc.height=Da;fb&&(Jc.alignSelf="center",Jc.marginBottom="4px");Wb.root=Jc;return Wb}gBb(N,Da,fb){const Wb={},Jc={},md={};md.width=N;md.height=Da;Jc.root=md;fb&&(Jc.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});Wb.galleryButtonInExpanded=Jc;return Wb}}Object(f.a)(je,"RibbonGallery",null,[680,682]);var qe=a(1104),Fe;let We=Fe=class{constructor(N){this.rv=void 0===N?null:N}get orc(){return this.rv}zt(N){return new ic(void 0===N?null:N)}Tf(){return new bd}Ee(N){var Da=
wb.a.Ag(Fe.E9a,N.toString());if(Da)return Da;switch(N){case 236:return this.Lq(N,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.Lq(N,"ContextMenu.Show.IdeasNLPane",-1336341324,744);case 238:return this.Lq(N,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.Nf(N,"ContextMenu.Show.ChartTaskPane",1221897806,na.a.wef,4,983);case 287:return this.Nf(N,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.Ml(N,
"DataLabels.None.BoxWhisker",374300079,na.a.def,929,930,1600);case 0:return this.Ml(N,"DataLabels.None.Column",374300079,na.a.cef,929,930,1600);case 1:return this.Ml(N,"DataLabels.None.Line",374300079,na.a.eef,929,930,1600);case 2:return this.Ml(N,"DataLabels.None.Pie",374300079,na.a.fef,929,930,1600);case 3:return this.Ml(N,"DataLabels.Show.Column",-1809877936,na.a.Rmc,931,932,1601);case 143:return this.Ml(N,"DataLabels.Show.Funnel",-1809877936,na.a.Rmc,931,934,1601);case 144:return this.Ml(N,"DataLabels.Show.Treemap",
-1809877936,na.a.Jrd,931,938,1601);case 145:return this.Ml(N,"DataLabels.Show.Sunburst",-1809877936,na.a.Ird,931,934,1601);case 4:return this.Ml(N,"DataLabels.Center.Column",-1996266048,na.a.Rmc,933,934,1602);case 5:return this.Ml(N,"DataLabels.Center.Line",-1996266048,na.a.Ydf,933,934,1602);case 6:return this.Ml(N,"DataLabels.Center.Pie",-1996266048,na.a.Ird,933,934,1602);case 7:return this.Ml(N,"DataLabels.InsideEnd.Column",493396546,na.a.Zdf,935,936,1603);case 8:return this.Ml(N,"DataLabels.InsideEnd.Pie",
493396546,na.a.$df,935,936,1603);case 9:return this.Ml(N,"DataLabels.InsideBase.Column",1599247052,na.a.Jrd,937,938,1604);case 10:return this.Ml(N,"DataLabels.OutsideEnd.Column",342855531,na.a.gef,939,940,1605);case 11:return this.Ml(N,"DataLabels.OutsideEnd.Pie",342855531,na.a.hef,939,940,1605);case 140:return this.Ml(N,"DataLabels.Left.BoxWhisker",-472675112,na.a.bef,941,942,1606);case 12:return this.Ml(N,"DataLabels.Left.Line",-472675112,na.a.aef,941,942,1606);case 142:return this.Ml(N,"DataLabels.Right.BoxWhisker",
-1774499423,na.a.jef,943,944,1607);case 13:return this.Ml(N,"DataLabels.Right.Line",-1774499423,na.a.ief,943,944,1607);case 138:return this.Ml(N,"DataLabels.Above.BoxWhisker",-204160914,na.a.Udf,945,946,1608);case 14:return this.Ml(N,"DataLabels.Above.Line",-204160914,na.a.kef,945,946,1608);case 139:return this.Ml(N,"DataLabels.Below.BoxWhisker",-87783054,na.a.Vdf,947,948,1609);case 15:return this.Ml(N,"DataLabels.Below.Line",-87783054,na.a.Xdf,947,948,1609);case 16:return this.Ml(N,"DataLabels.BestFit.Pie",
1650379138,na.a.Wdf,949,950,1610);case 17:return this.Ml(N,"Axes.Horizontal.None",895828731,na.a.Jdf,929,951,1613);case 18:return this.Ml(N,"Axes.Horizontal.ShowLTR",683614408,na.a.Grd,952,953,1614);case 19:return this.Ml(N,"Axes.Horizontal.NoLabels",-1612014670,na.a.Idf,956,957,1615);case 20:return this.Ml(N,"Axes.Horizontal.ShowRTL",1259259728,na.a.Kdf,958,959,1616);case 21:return this.Ml(N,"Axes.Horizontal.Default",683614408,na.a.Grd,954,955,1617);case 22:return this.Ml(N,"Axes.Horizontal.Thousands",
-220179662,na.a.Ldf,960,961,1618);case 23:return this.Ml(N,"Axes.Horizontal.Millions",1534680966,na.a.Hdf,962,963,1619);case 24:return this.Ml(N,"Axes.Horizontal.Billions",-238895611,na.a.Fdf,964,965,1620);case 25:return this.Ml(N,"Axes.Horizontal.LogScale",-892714755,na.a.Gdf,966,967,1621);case 26:return this.Ml(N,"Axes.Vertical.None",2006508979,na.a.Qdf,929,951,1613);case 27:return this.Ml(N,"Axes.Vertical.Default",252405382,na.a.Sdf,954,955,1617);case 28:return this.Ml(N,"Axes.Vertical.Thousands",
670842692,na.a.Tdf,960,961,1618);case 29:return this.Ml(N,"Axes.Vertical.Millions",-572426128,na.a.Odf,962,963,1619);case 30:return this.Ml(N,"Axes.Vertical.Billions",-806496391,na.a.Mdf,964,965,1620);case 31:return this.Ml(N,"Axes.Vertical.LogScale",-1700998151,na.a.Ndf,966,967,1621);case 32:return this.Ml(N,"Axes.Vertical.NoLabels",2104548628,na.a.Pdf,956,957,1615);case 33:return this.Ml(N,"Axes.Vertical.ShowRTL",1717508862,na.a.Rdf,958,959,1616);case 34:return this.Ml(N,"Gridlines.Horizontal.None",
80515665,na.a.pef,929,970,1624);case 35:return this.Ml(N,"Gridlines.Horizontal.Major",-306129902,na.a.mef,972,973,1625);case 36:return this.Ml(N,"Gridlines.Horizontal.Minor",2147076534,na.a.nef,975,976,1626);case 37:return this.Ml(N,"Gridlines.Horizontal.MajorMinor",-1253752845,na.a.oef,978,979,1627);case 38:return this.Ml(N,"Gridlines.Vertical.None",1711257557,na.a.vef,929,971,1624);case 39:return this.Ml(N,"Gridlines.Vertical.Major",-1772953364,na.a.sef,972,974,1625);case 40:return this.Ml(N,"Gridlines.Vertical.Minor",
680253336,na.a.tef,975,977,1626);case 41:return this.Ml(N,"Gridlines.Vertical.MajorMinor",-215161981,na.a.uef,978,980,1627);case 135:return this.Nf(N,"ContextMenu.NumberFormating",2105621672,na.a.xrd,1,476,135!==N,null,null,this.rv.O5(406));case 300:return this.Nf(N,"ContextMenu.FormatCells",2055979337,null,1,477,300!==N,void 0,"PaintBrushandBucket_20",this.rv.O5(406));case 136:return this.Nf(N,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,na.a.xrd,1,476,136!==N);case 42:return this.Nf(N,
"ContextMenu.Cut",-1985798686,na.a.fdf,1,12,!1,null,null,this.rv.O5(172));case 43:return this.Nf(N,"ContextMenu.Copy",-911352779,na.a.urd,1,11,!1,null,null,this.rv.O5(174));case 212:return this.Nf(N,"ContextMenu.InsertCopiedCells",-160032004,na.a.Zrd,3,15);case 213:return this.Nf(N,"ContextMenu.InsertCutCells",-1065525230,na.a.Zrd,3,21);case 44:case 57:return this.Nf(N,"ContextMenu.Paste",237279923,na.a.Brd,1,13,44!==N,"Paste");case 248:return this.Nf(N,"PasteAdvancedOptionsGallery",237279923,na.a.Brd,
1,13,44!==N,"Paste");case 45:case 120:return this.Nf(N,"ContextMenu.EditHyperlink",-1583422759,na.a.Ord,8,1140,45!==N,"EditHyperlink");case 46:case 121:return this.Nf(N,"ContextMenu.InsertHyperlink",-1583422759,na.a.Ord,8,1141,46!==N,"InsertHyperlink",null,this.rv.O5(156));case 47:case 122:return this.Nf(N,"ContextMenu.RemoveHyperlink",-1253126584,na.a.Rrd,8,1142,47!==N,"RemoveHyperlink");case 48:case 123:return this.Nf(N,"ContextMenu.RemoveHyperlinks",-1253126584,na.a.Rrd,8,1143,48!==N,"RemoveHyperlinks");
case 250:return this.Lq(N,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.Nf(N,"ContextMenu.InsertCellsShiftRight",1035996630,na.a.odf,1,165===N||173===N?341:342,173===N||188===N,"InsertCellsShiftRight");case 166:case 174:return this.Nf(N,"ContextMenu.InsertCellsShiftDown",1035996630,na.a.ndf,1,344,166!==N,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Nf(N,"ContextMenu.DeleteCellsShiftLeft",1035996630,na.a.idf,1,167===
N||175===N?342:341,175===N||190===N,"DeleteCellsShiftLeft");case 168:case 176:return this.Nf(N,"ContextMenu.DeleteCellsShiftUp",1035996630,na.a.jdf,1,343,168!==N,"DeleteCellsShiftUp");case 177:case 181:return this.Nf(N,"ContextMenu.InsertRowsSheet",-1113896058,na.a.yrd,1,nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?430:429,177!==N,"InsertRows");case 49:case 116:return this.Nf(N,"ContextMenu.InsertRows",-1113896058,na.a.yrd,1,nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",
!1)?2420:346,49!==N,"InsertRows");case 161:case 169:return this.Nf(N,"ContextMenu.InsertRowsTable",942362098,na.a.rdf,1,421,161!==N,"InsertRowsTable");case 50:case 117:return this.Nf(N,"ContextMenu.InsertColumns",1415868706,na.a.qSa,1,406,50!==N,"InsertColumns");case 336:case 337:return this.Nf(N,"ContextMenu.InsertColumnsToTheLeft",1415868706,na.a.qSa,1,407,336!==N,"InsertColumns");case 288:case 289:return this.Nf(N,"ContextMenu.contextMenuInsertColumnsToTheRight",1415868706,na.a.qSa,1,408,288!==
N,"InsertColumns");case 178:case 182:return this.Nf(N,"ContextMenu.InsertColumnsSheet",1415868706,na.a.qSa,1,426,178!==N,"InsertColumns");case 334:case 335:return this.Nf(N,"ContextMenu.InsertColumnsSheetToTheLeft",1415868706,na.a.qSa,1,427,334!==N,"InsertColumns");case 290:case 291:return this.Nf(N,"ContextMenu.InsertColumnsSheet",1415868706,na.a.qSa,1,428,290!==N,"InsertColumns");case 191:case 192:case 162:case 170:return this.Nf(N,"ContextMenu.InsertColumnsTable",622604322,na.a.qdf,1,162===N||
170===N?419:420,170===N||192===N,"InsertColumnsTable");case 179:case 183:return this.Nf(N,"ContextMenu.DeleteRowsSheet",1554436520,na.a.Omc,1,429,179!==N,"DeleteRows");case 51:case 118:return this.Nf(N,"ContextMenu.DeleteRows",1554436520,na.a.Omc,1,410,51!==N,"DeleteRows");case 163:case 171:return this.Nf(N,"ContextMenu.DeleteRowsTable",1405456548,na.a.Omc,1,418,163!==N,"DeleteRowsTable");case 180:case 184:return this.Nf(N,"ContextMenu.DeleteColumnsSheet",674605324,na.a.Nmc,1,426,180!==N,"DeleteColumns");
case 52:case 119:return this.Nf(N,"ContextMenu.DeleteColumns",674605324,na.a.Nmc,1,411,52!==N,"DeleteColumns");case 164:case 172:return this.Nf(N,"ContextMenu.DeleteColumnsTable",284490184,na.a.Nmc,1,417,164!==N,"DeleteColumnsTable");case 53:case 124:return this.Lq(N,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==N,"OpenHyperlink",this.rv.O5(101));case 263:return this.Nf(N,"SheetOpsContextMenu.ShowChanges",1834994092,na.a.Srd,8,443,void 0,Lb.a.Mjk);case 264:return this.Nf(N,"GridContextMenu.ZoomFitToScreen",
1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Nf(N,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.Nf(N,"GridContextMenu.ShowChanges",1834994092,na.a.Srd,8,443,void 0,Lb.a.bzg);case 54:return this.Nf(N,"ContextMenu.InsertSheet",-1935155518,na.a.sdf,1,514);case 56:case 127:return this.Nf(N,"ContextMenu.DeleteSheet",1880294140,na.a.ldf,1,515,56!==N,"DeleteSheet");case 55:return this.Lq(N,"ContextMenu.RenameSheet",
817296323,516);case 125:case 126:return this.Lq(N,"ContextMenu.ReorderSheet",-383100692,517,125!==N,"ReorderSheet");case 158:return this.Lq(N,"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.Lq(N,"ContextMenu.HideSheet",1458540255,519,112!==N,"HideSheet");case 113:case 115:return this.Lq(N,"ContextMenu.UnhideSheet",1129633328,520,113!==N,"UnhideSheet");case 277:return this.Nf(N,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Nf(N,
"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Nf(N,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Lq(N,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Nf(N,"ContextMenu.PivotExpand",-1687560254,na.a.Drd,9,1168);case 244:return this.Nf(N,"ContextMenu.PivotCollapse",1176256599,na.a.Crd,9,1169);case 245:return this.Nf(N,"ContextMenu.PivotExpandEntireField",
-1751201991,na.a.Drd,9,1170);case 246:return this.Nf(N,"ContextMenu.PivotCollapseEntireField",-232434744,na.a.Crd,9,1171);case 247:return this.Nf(N,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");case 301:return this.Nf(N,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,V.a.CEj);case 306:return this.Nf(N,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.Nf(N,"ContextMenu.ManualGroup",660506187,null,
17,2346,void 0,void 0);case 59:return this.Nf(N,"ContextMenu.PivotFieldListShow",2140436015,na.a.Erd,9,1173);case 58:return this.Nf(N,"ContextMenu.PivotFieldListHide",-1006032470,na.a.Erd,9,1174);case 258:return this.Nf(N,"ContextMenu.PivotSettingsPaneShow",1529441790,na.a.kGb,17,636);case 257:return this.Nf(N,"ContextMenu.PivotSettingsPaneHide",1529441790,na.a.kGb,17,637);case 259:return this.Lq(N,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.Lq(N,"ContextMenu.PivotTableSubtotalOnTop",
671485366,639);case 261:return this.Lq(N,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return Da=60!==N,this.Lq(N,Da?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,Da,null);case 61:case 65:return Da=61!==N,this.Lq(N,Da?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,Da,null);case 62:case 66:return Da=62!==N,this.Lq(N,Da?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",
389774337,1091,Da,null);case 63:case 67:return Da=63!==N,this.Lq(N,Da?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,Da,null);case 68:case 72:return Da=68!==N,this.Nf(N,Da?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,na.a.Jmc,9,1093,Da,null);case 69:case 73:return Da=69!==N,this.Nf(N,Da?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,na.a.Pbb,9,1094,Da,
null);case 70:case 74:return Da=70!==N,this.Nf(N,Da?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,na.a.Obb,9,1095,Da,null);case 71:case 75:return Da=71!==N,this.Nf(N,Da?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,na.a.Kmc,9,1098,Da,null);case 76:return this.Nf(N,"ContextMenu.FieldWellRemoveField",-1092351914,na.a.gdf,9,1099);case 77:return this.Nf(N,"ContextMenu.FieldWellValueFieldSettings",-2141589616,
na.a.Edf,9,1100);case 79:case 83:return this.Nf(N,"ContextMenu.FieldListMoveToReportFilter",359279088,na.a.Jmc,9,1082,79!==N,null);case 80:case 84:return this.Nf(N,"ContextMenu.FieldListMoveToRowLabels",-67292059,na.a.Pbb,9,1083,80!==N,null);case 81:case 85:return this.Nf(N,"ContextMenu.FieldListMoveToColumnsLabels",745182485,na.a.Obb,9,1084,81!==N,null);case 82:case 86:return this.Nf(N,"ContextMenu.FieldListMoveToValues",926905850,na.a.Kmc,9,1087,82!==N,null);case 95:case 97:return Da=95!==N,this.Nf(N,
Da?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,na.a.Pbb,9,1096,Da,null);case 96:case 98:return Da=96!==N,this.Nf(N,Da?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,na.a.Obb,9,1097,Da,null);case 78:return this.Nf(N,"ContextMenu.FieldListAddAsSlicer",547535945,na.a.trd,9,1088);case 332:case 333:return this.Nf(N,"ContextMenu.FieldListAddAsTimeline",-2108836646,null,9,2393,333===
N,void 0,"TimeSlicerInsert_20");case 91:case 93:return this.Nf(N,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,na.a.Pbb,9,1085,91!==N,null);case 92:case 94:return this.Nf(N,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,na.a.Obb,9,1086,92!==N,null);case 99:return this.Nf(N,"ContextMenu.BIExploreShowCallout",1529658657,na.a.Lmc,9,1193);case 100:return this.Nf(N,"ContextMenu.ContextMenuRefresh",2054778433,na.a.zdf,9,1181);case 102:return this.Nf(N,"ContextMenu.EditCell",324156914,
na.a.Qrd,8,579);case 101:return this.Nf(N,"Contextenu.DeleteChart",2045211913,na.a.Smc,8,578);case 308:return this.Nf(N,"Contextmenu.DeleteChartElement",2045211913,na.a.Smc,8,2358);case 321:return this.Nf(N,"Contextmenu.AddDataLabels",1849330294,na.a.I3h,8,2359,!1);case 146:return this.Nf(N,"Contextenu.AltText",1804967129,na.a.Nrd,8,817);case 302:return this.Nf(N,"ContextMenu.CellImageAltText",1516436924,na.a.Nrd,8,817);case 147:return this.Nf(N,"ContextMenu.EditShapeText",-445658892,na.a.Fef,8,818);
case 186:return this.Nf(N,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Nf(N,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",V.a.bringForward);case 282:return this.Nf(N,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",V.a.bringToFront);case 283:return this.Nf(N,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",V.a.sendBackward);case 284:return this.Nf(N,"ContextMenu.SendToBack",
-884976206,null,8,823,!1,"ContextMenu.SendToBack",V.a.sendToBack);case 273:return this.Nf(N,"ContextMenu.OfficeScriptsViewScript",-585097204,na.a.adf,8,2151);case 160:return this.Nf(N,"ContextMenu.InsertComment",-1667294294,na.a.Hef,8,1146,!1,null,null,this.rv.O5(351));case 221:return this.Nf(N,"ContextMenu.DeleteComment",467845448,na.a.Eef,8,1162);case 159:return this.Nf(N,"ContextMenu.InsertReply",-1667294294,na.a.Ief,8,1145);case 226:return this.Nf(N,"ContextMenu.NewNote",2041505397,null,8,1156,
void 0,void 0,"AddNoteboardNote_20",this.rv.O5(348));case 227:return this.Nf(N,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Nf(N,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.Nf(N,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Lq(N,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.$Z(N,"Form.InsertForm",1305810481,na.a.Ard,
1,"Image16by16",1267,0,null,!1,1595);case 107:return this.$Z(N,"Form.ViewForm",330035228,na.a.Ard,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.$Z(N,"Form.EditForm",1305810481,na.a.mdf,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.$Z(N,"Form.DeleteForm",-509039657,na.a.hdf,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.$Z(N,"Form.ShareForm",1334518759,na.a.Adf,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.Lq(N,"ContextMenu.ClearContent",-848953656,
445,148!==N);case 150:case 151:return this.Nf(N,"ContextMenu.RowHeight",2040891415,na.a.Jef,8,434,151===N);case 152:case 153:return this.Nf(N,"ContextMenu.ColumnWidth",957527587,na.a.Def,8,433,153===N);case 108:case 154:return this.Lq(N,"ContextMenu.HideRows",1051390410,432,154===N);case 110:case 156:return this.Lq(N,"ContextMenu.UnhideRows",1542466017,439,156===N);case 109:case 155:return this.Lq(N,"ContextMenu.HideColumns",-706918724,438,155===N);case 111:case 157:return this.Lq(N,"ContextMenu.UnhideColumns",
369708605,440,157===N);case 216:return this.Lq(N,"ContextMenu.ShowCard",-843616717,1786,216!==N);case 217:return this.Lq(N,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.Nf(N,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.Nf(N,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.Nf(N,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");
case 215:case 268:return this.Lq(N,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===N);case 218:case 269:return this.Lq(N,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===N);case 220:case 271:return this.Lq(N,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===N);case 219:case 270:return this.Lq(N,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===N);case 234:return this.Nf(N,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");
case 235:return this.Nf(N,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Nf(N,"ContextMenu.FilterByValue",1803952894,null,1,222);case 313:return this.Nf(N,"ContextMenu.FilterByCellColor",486423932,null,1,2375);case 314:return this.Nf(N,"ContextMenu.FilterByCellFontColor",-652157481,null,1,2376);case 315:return this.Nf(N,"ContextMenu.FilterByCellIcon",-1656122924,null,1,2377);case 223:return this.Nf(N,"ContextMenu.SortAscending",-1010737776,
na.a.Cdf,1,228);case 292:return this.Lq(N,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.Lq(N,"ContextMenu.PutSelectedFontColorOnTop",-764711886,231);case 294:return this.Lq(N,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.Nf(N,"ContextMenu.SortDescending",2123420468,na.a.Ddf,1,229);case 225:return this.Nf(N,"ContextMenu.SortCustom",-207540907,na.a.Qmc,1,233);case 232:return this.Nf(N,"ContextMenu.ConvertToRange",323142015,na.a.edf,
1,740);case 272:return this.Nf(N,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,na.a.Qrd,8,661);case 239:return this.Nf(N,"ContextMenu.IgnoreError",886009118,na.a.Prd,8,2112,239!==N);case 240:return this.Nf(N,"ContextMenu.IgnoreErrors",886009118,na.a.Prd,8,2113,240!==N);case 241:return this.Lq(N,"ContextMenu.ShowError",-1779556985,2114,241!==N);case 251:return this.Nf(N,"ContextMenu.SlicerRefresh",-231711729,na.a.ydf,0,2177,251!==N);case 252:return this.Nf(N,"ContextMenu.SlicerClearFilter",-1909381757,
na.a.kdf,0,2178,252!==N);case 254:return this.Lq(N,"ContextMenu.SlicerDelete",2045211913,2181,254!==N);case 253:return this.Nf(N,"ContextMenu.SlicerMultiSelect",2108047455,na.a.zrd,0,2180,253!==N);case 255:return this.Nf(N,"ContextMenu.SlicerSortAscending",-923375148,na.a.Tmc,8,2183,255!==N);case 256:return this.Nf(N,"ContextMenu.SlicerSortDescending",1164937340,na.a.Umc,8,2182,256!==N);case 267:return this.Nf(N,"ContextMenu.SlicerSettingsPaneShow",522377926,na.a.kGb,17,636);case 266:return this.Nf(N,
"ContextMenu.SlicerSettingsPaneHide",522377926,na.a.kGb,17,637);case 128:return this.mBa(N,-619033944,1,1438);case 129:return this.mBa(N,-619033944,2,1440);case 130:return this.mBa(N,-619033944,3,1442);case 131:return this.mBa(N,-619033944,4,1443);case 132:return this.jaa(N,-1736601456,7,1447);case 133:return this.jaa(N,-1736601456,8,1449);case 134:return this.jaa(N,-1736601456,0,1450);case 196:return this.mBa(N,-2136556471,1,1438);case 198:return this.mBa(N,-2136556471,2,1440);case 200:return this.mBa(N,
-2136556471,3,1442);case 201:return this.mBa(N,-2136556471,4,1443);case 204:return this.jaa(N,1201641489,0,1447);case 205:return this.jaa(N,1201641489,1,1448);case 206:return this.jaa(N,1201641489,7,1449);case 207:return this.jaa(N,1201641489,2,1450);case 208:return this.jaa(N,1201641489,4,1451);case 209:return this.jaa(N,1201641489,3,1452);case 210:return this.jaa(N,1201641489,5,1453);case 211:return this.jaa(N,1201641489,6,1454);case 274:return this.Nf(N,"ContextMenu.ShareChart",353606613,null,
1,2261,void 0,void 0,"ShareSectionEntry_20");case 275:return this.Nf(N,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.Nf(N,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");case 317:return this.Nf(N,"ContextMenu.ShareNamedSheetView",-1592351768,null,1,2382,void 0,void 0,"ShareSectionEntry_20");case 319:return this.Nf(N,"ContextMenu.ExitNamedSheetView",1690118309,null,3,2381,void 0,void 0,"ExitSheetView_20");
case 299:return this.Nf(N,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 312:return this.Nf(N,"ContextMenu.ShareSheet",783415632,null,1,2374,void 0,void 0,"ShareSectionEntry_20");case 309:return this.Nf(N,"ContextMenu.FlyoutShareSheet",783415632,null,1,2355,void 0,void 0);case 310:return this.Nf(N,"ContextMenu.FlyoutShareRange",-1099009678,null,1,2356,void 0,void 0);case 311:return this.Nf(N,"ContextMenu.FlyoutShareTable",192430811,null,1,2357,void 0,void 0);
case 285:return this.Nf(N,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Nf(N,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20");case 330:return this.Nf(N,"ContextMenu.CopyHyperlink",-1257360929,na.a.urd,1,2410,330!==N);case 331:return this.Nf(N,"ContextMenu.ShowLinkPreview",1915212877,null,1,2411,331!==N)}return null}$Z(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe,lf,Oe,ag){Da=new G.a(Da,sd,fb,null,Jc,Wb,md,sd,Od,Ce,
Qe,lf,!0,void 0===Oe?null:Oe,void 0===ag?null:ag);return Fe.E9a[N.toString()]=Da}Nf(N,Da,fb,Wb,Jc,md,sd,Od,Ce,Qe){Ce=void 0===Ce?null:Ce;return this.$Z(N,Da,fb,Ce?null:Wb,Jc,"Image16by16",md,0,void 0===Od?null:Od,void 0===sd?!1:sd,0,Ce,void 0===Qe?null:Qe)}Yld(N,Da,fb,Wb,Jc,md){return new Le(N,0,-1006427574,null,fb,Da,Wb,0,0,Jc,!1,null,void 0===md?null:md)}Z2e(N,Da){return new yb(N,void 0===Da?"":Da)}qFh(N,Da,fb,Wb){return new qe.a(N,0,Da,null,8,null,"None",0,0,null,!1,0,fb,Wb)}hRa(N,Da,fb,Wb,Jc,
md,sd,Od,Ce){Od=void 0===Od?null:Od;Ce=void 0===Ce?!1:Ce;let Qe=wb.a.Ag(Fe.E9a,N);if(Qe)return Qe;Qe=new G.a(N,0,fb,null,3,null,"None",0,0,md,sd,0);Qe.l2(Da);Qe.label=Da;Qe.Z9d(Ce?null:Da);Qe.OYb(Jc,Wb,Od);return Fe.E9a[N]=Qe}Z2d(N){this.VGd(N)&&delete Fe.E9a[N]}VGd(N){return N in Fe.E9a}Ty(N,Da,fb,Wb){N=new Ub(N,Da,0,Wb,3,null,"None",0);N.l2(fb);N.label=fb;return N}Aic(N,Da,fb,Wb,Jc,md,sd){N=new Ub(N,Da,0,Wb,Jc,sd?null:md,"Image16by16",0,sd);N.l2(fb);N.label=fb;return N}BDb(N,Da,fb,Wb,Jc,md){return new pa(this.rv,
N,null,null,void 0===Da?null:Da,null,void 0===fb?null:fb,void 0===Wb?null:Wb,void 0===Jc?null:Jc,void 0===md?null:md)}NH(N,Da,fb,Wb){fb=void 0===fb?null:fb;Wb=void 0===Wb?null:Wb;return Object(Bb.a)(new je,{id:N,width:Da,lqa:fb,title:Wb})}Ml(N,Da,fb,Wb,Jc,md,sd){return this.$Z(N,Da,fb,Wb,4,"Image32by32",Jc,md,null,!1,sd)}Lq(N,Da,fb,Wb,Jc,md,sd){return this.$Z(N,Da,fb,null,1,"None",Wb,0,void 0===md?null:md,void 0===Jc?!1:Jc,0,null,void 0===sd?null:sd)}Q1e(N,Da,fb,Wb,Jc,md){return this.$Z(N,Da,fb,Wb,
4,"Image16by16",Jc,0,md.toString(),!1,0)}jaa(N,Da,fb,Wb){return this.Q1e(N,"OutlineDashStylePresent,"+fb,Da,na.a.Mmc,Wb,fb)}mBa(N,Da,fb,Wb){return this.Q1e(N,"OutlineWidthPresent,"+fb,Da,na.a.Pmc,Wb,fb)}};We.E9a={};We=Fe=Object(od.__decorate)([Object(Aa.d)(Ka.Bd),Object(od.__param)(0,Object(Ka.bd)()),Object(od.__param)(1,Object(Ka.J)())],We);Object(f.a)(We,"RibbonControlsManager",null,[664]);class mf extends Rb.a{constructor(N){super();this.Wa=null;this.$=N;this.Dg()}create(){var N=this.$;const Da=
Ka.bd.$e()?Object(qb.d)(Aa.a.resolve(Ka.bd,{Aa:this.$a})):Tb.GetServiceTaskFactory.create(N.ja,111,this.qa,this.$a);N=Object(qb.d)(Aa.a.resolve(Ka.J,{Aa:this.$a}));zb.TaskExtensions.Ca(zb.TaskExtensions.Dh([Da,N],this.qa),()=>{this.Df(this.Wa||(this.Wa=new We(Da.result)))},this.qa,3)}static ta(N){N.ja.$c(102,new mf(N))}}Object(f.a)(mf,"RibbonControlsFactory",Rb.a,[]);var qf=a(948);let Ga=class{constructor(N){this.NGa=N}xD(N,Da){return this.NGa?this.NGa.xD(N,Da).then(fb=>{fb.IsSuccess||h.ULS.sendTraceTag(51401292,
0,15,"Error retrieving auth token. Message: "+fb.ErrorMessage+" Error code: "+fb.ErrorCode+" App name: "+N);return Object(Bb.a)(new qf.a,{IsSuccess:fb.IsSuccess,Token:fb.Token,ErrorCode:fb.ErrorCode,ErrorMessage:fb.ErrorMessage})}):(h.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(Bb.a)(new qf.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}qVa(){return this.NGa?this.NGa.qVa():null}};Ga=
Object(od.__decorate)([Object(Aa.d)(Ka.Jc),Object(od.__param)(0,Object(Ka.Ic)())],Ga);Object(f.a)(Ga,"OAuthManagerWrapper",null,[662]);Object(Aa.b)(Ka.Ic)(()=>I.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var Ob=a(222),e=a(29);class sb{constructor(N){this.keyPath=N}}Object(f.a)(sb,"KeyPathClass",null,[]);let dc=class extends Ob.a{constructor(N){super();this.vpb=this.jnd=null;this.o5e=1;this.q5a=null;this.$=N}get indexedDBFactory(){this.q5a||(window.indexedDB?this.q5a=window.indexedDB:window.webkitIndexedDB?
this.q5a=window.webkitIndexedDB:window.mozIndexedDB?this.q5a=window.mozIndexedDB:window.msIndexedDB&&(this.q5a=window.msIndexedDB));return this.q5a}get initialized(){return!!this.jnd&&!!this.vpb}initialize(N,Da,fb){this.jnd=N;this.vpb=Da;this.o5e=fb}Xi(){try{return nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&R.a.EFa||R.a.hj&&91===R.a.Etd?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(N){return h.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${N.message}`),
!1}}j0a(N){return this.Xi()&&this.initialized?zb.TaskExtensions.Hpa(this.AXd(),Da=>{if(void 0===Da.result&&nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;Da=Da.result;this.Bic(Da);const fb=e.a.Ae.zh.m;this.LAd(Da,!1).put(N);h.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${e.a.Ae.zh.m-fb} Millisecond.`);return!0},this.qa):(h.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),lb.Task.Ra(!1))}Wnd(N){return this.Xi()&&
this.initialized?zb.TaskExtensions.Hpa(this.AXd(),Da=>{if(void 0===Da.result&&nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;Da=Da.result;this.Bic(Da);const fb=e.a.Ae.zh.m;this.LAd(Da,!1)["delete"](N);h.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${e.a.Ae.zh.m-fb} Millisecond.`);return!0},this.qa):(h.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),lb.Task.Ra(!1))}ETa(N){return this.Xi()&&
this.initialized?zb.TaskExtensions.wDh(this.AXd(),Da=>void 0===Da.result&&nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?lb.Task.Ra(""):this.hoi(Da.result,N),this.qa):(h.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),lb.Task.Ra(""))}deleteDatabase(N){if(!this.Xi())return h.ULS.sendTraceTag(507872215,0,15,"IndexedDB.deleteDatabase: not supported."),lb.Task.Ra(!1);const Da=new cd.a;N=this.indexedDBFactory.deleteDatabase(N);
N.onsuccess=()=>{Da.setResult(!0)};N.onerror=()=>{Da.setResult(!1)};return Da.task}Bic(N){N.objectStoreNames.contains(this.vpb)||N.createObjectStore(this.vpb,new sb("key"))}AXd(){const N=new cd.a,Da=this.indexedDBFactory.open(this.jnd,this.o5e);Da.onsuccess=()=>{const fb=Da.result;h.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${fb.name} success`);N.setResult(fb)};Da.onupgradeneeded=()=>{const fb=Da.result;h.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${fb.name} upgrade needed`);try{this.Bic(fb),
h.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${fb.name} upgrade done`)}catch(Wb){h.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${Wb}`),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?N.setResult(void 0):N.setException(Error.create("Failed to upgrade IndexedDB"))}};Da.onerror=fb=>{h.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${fb} failed`);N.setResult(void 0)};return N.task}LAd(N,Da){return N.transaction([this.vpb],Da?"readonly":"readwrite").objectStore(this.vpb)}hoi(N,
Da){const fb=new cd.a;this.Bic(N);const Wb=e.a.Ae.zh.m,Jc=this.LAd(N,!0).get(Da);Jc.onsuccess=md=>{(md=md.target.result)?(fb.setResult(md.value),h.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${e.a.Ae.zh.m-Wb} Millisecond.`)):fb.setResult("")};Jc.onerror=()=>{fb.setException(Error.create(Jc.error?Jc.error.message:"DB error"))};return fb.task}};dc=Object(od.__decorate)([Object(Aa.d)(Ka.kc,{nn:"transient"}),Object(od.__param)(0,Object(Ka.nb)())],dc);Object(f.a)(dc,"IndexedDB",Ob.a,
[661]);Type.registerNamespace("Common.App.OAuth");db.main();bb.a.Rl(".ewa-svg-icon{height:100%;width:100%}");kb.a.Na(ab.ta);bb.a.Rl('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
(()=>{kb.a.Na(N=>{nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)||me.ta(N);Hb.ta(N)})})();(()=>{kb.a.Na(N=>{Ka.yc.$e()||Gc.ta(N)})})();(()=>{kb.a.Na(N=>{Ka.bd.$e()||new Wc(N.ja,N)})})();(()=>{kb.a.Na(N=>{Ka.Bd.$e()||mf.ta(N)})})();String(c);String(d);String(n);String(l);String(m);String(k);String(b);window.___1699049107607_closurehack=c;window.___1699049107607_closurehack=d;window.___1699049107607_closurehack=n;window.___1699049107607_closurehack=l;window.___1699049107607_closurehack=
m;window.___1699049107607_closurehack=k;window.___1699049107607_closurehack=b}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/414ce9b037f9134993490398ba0b741c/EwaTS.vrs.js.map