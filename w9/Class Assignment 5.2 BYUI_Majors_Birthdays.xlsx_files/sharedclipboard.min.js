var sharedClipboard=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(9);t.utils=n;var o=r(4);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return o.ConsoleLogger}});var a=r(10);t.browserSupport=a;var i=r(11);t.perfWatch=i;var s=r(12);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var c=r(16);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return c.initStopwatchFactory}});var l=r(17);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return l.TelemetryCollector}});var u=r(18);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return u.getNewGuid}});var d=r(19);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}});var g=r(20);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return g.replaceChildren}})},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return l})),r.d(t,"__runInitializers",(function(){return u})),r.d(t,"__propKey",(function(){return d})),r.d(t,"__setFunctionName",(function(){return g})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return f})),r.d(t,"__generator",(function(){return h})),r.d(t,"__createBinding",(function(){return m})),r.d(t,"__exportStar",(function(){return y})),r.d(t,"__values",(function(){return S})),r.d(t,"__read",(function(){return w})),r.d(t,"__spread",(function(){return v})),r.d(t,"__spreadArrays",(function(){return b})),r.d(t,"__spreadArray",(function(){return C})),r.d(t,"__await",(function(){return _})),r.d(t,"__asyncGenerator",(function(){return T})),r.d(t,"__asyncDelegator",(function(){return E})),r.d(t,"__asyncValues",(function(){return L})),r.d(t,"__makeTemplateObject",(function(){return I})),r.d(t,"__importStar",(function(){return M})),r.d(t,"__importDefault",(function(){return A})),r.d(t,"__classPrivateFieldGet",(function(){return O})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return W}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=n.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),g=!1,p=r.length-1;p>=0;p--){var f={};for(var h in n)f[h]="access"===h?{}:n[h];for(var h in n.access)f.access[h]=n.access[h];f.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var m=(0,r[p])("accessor"===c?{get:d.get,set:d.set}:d[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=i(m.get))&&(d.get=s),(s=i(m.set))&&(d.set=s),(s=i(m.init))&&o.push(s)}else(s=i(m))&&("field"===c?o.push(s):d[l]=s)}u&&Object.defineProperty(u,n.name,d),g=!0}function u(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))}function h(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var m=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)n[o]=a[i];return n}function C(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function T(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof _?Promise.resolve(r.value.v).then(c,l):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function E(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:_(e[n](t)),done:!1}:o?o(t):t}:o}}function L(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return P(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function W(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(5),o={};function a(){return void 0===n.globalThis.__get_feature_gate_dictionary_variable?o:n.globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=a()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(5);function o(){return void 0===n.globalThis.__get_change_gate_dictionary_variable?{}:n.globalThis.__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,o){return t.traceTag(e,r,n,o)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,o){return t.debugTraceTag(e,r,n,o)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,o){return t.assertTag(e,r,n,o)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,o){return t.shipAssertTag(e,r,n,o)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,o){return t.dnmTraceTag(e,r,n,o)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(21);t.globalThis=n},function(e,t,r){"use strict";r.d(t,"a",(function(){return et}));var n={};r.r(n),r.d(n,"sharedClipboardSettingsVariableName",(function(){return F})),r.d(n,"defaultPromiseTimeoutInMinutes",(function(){return N})),r.d(n,"getSharedClipboardSettings",(function(){return J})),r.d(n,"initializeSharedClipboardSettingsFromWindow",(function(){return H})),r.d(n,"initializeSharedClipboardSettings",(function(){return z})),r.d(n,"createEmptySharedClipboardSettings",(function(){return V}));var o,a=r(0);function i(){return o}function s(e){if(!e)throw new Error("The 'logger' argument is missing");o=a.ULS.getFromExternalLogger(e)}var c,l,u,d,g,p=r(1);function f(e){if(e&&"object"==typeof e){if(h(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(h(JSON.parse(e.innerError).reason))return!0}catch(e){}}if("string"==typeof e)try{if(h(JSON.parse(e).reason))return!0}catch(e){}return!1}function h(e){return e===l.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage"}(c||(c={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(l||(l={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(d||(d={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var m=function(e){function t(r,n,o){var s=this,c=t.augmentParameterValue(r);if((s=e.call(this,c)||this).name=t.augmentParameterValue(n),s.errorName=s.name,s.name?i().ULS.traceTag(596456211,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Error '".concat(s.name,"': ").concat(c)):i().ULS.traceTag(596456212,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Error message: ".concat(c)),o){s.innerError=o;var l=s.innerError.message;l||(l=s.innerError.name);var u=t.augmentParameterValue(l);u.length>0&&i().ULS.traceTag(596456213,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Inner error message: ".concat(u))}return s.stack||(s.stack=(new Error).stack),s}return Object(p.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),y=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return Object(p.__extends)(t,e),t}(m),S=function(e){function t(r,n,o){var a=this,i=m.augmentParameterValue(n),s=t.getDefaultMessage(i),c=m.augmentParameterValue(r);return 0===c.length&&(c=s),(a=e.call(this,c,"MissingArgumentError",o)||this).name=i,a}return Object(p.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '".concat(e,"'")),t},t}(m),w=function(e){function t(r,n,o,a){var i=this,s=m.augmentParameterValue(n),c=o;c||(c="");var l=t.getDefaultMessage(s,c),u=m.augmentParameterValue(r);return 0===r.length&&(u=l),(i=e.call(this,u,"InvalidArgumentError",a)||this).name=s,i.value=c,i}return Object(p.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '".concat(e,"' argument: '").concat(t,"'"):"Invalid argument"},t}(m),v=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(p.__extends)(t,e),t}(m);(function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}Object(p.__extends)(t,e)})(m),function(e){function t(t,r,n,o,a){return e.call(this,"".concat(t,". Data version: ").concat(r,", Infra version: ").concat(n,", blockMismatchDataVersion: ").concat(o),"MismatchVersionError",a)||this}Object(p.__extends)(t,e)}(m),function(e){function t(t,r,n,o){return e.call(this,"".concat(t,". Duration in clipboard (ms) : ").concat(r,", TTL (ms): ").concat(n),"TTLClipboardDataError",o)||this}Object(p.__extends)(t,e)}(m),function(e){function t(t,r,n,o){return e.call(this,"".concat(t,". Data User Hash : ").concat(r,", infra User Hash: ").concat(n),"UserHashMismatchError",o)||this}Object(p.__extends)(t,e)}(m),function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}Object(p.__extends)(t,e)}(m);function b(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var C=function(e){function t(t,r,n,o,a){var i=e.call(this,r||"reason=".concat(t),n,o)||this;return i.reason=t,a&&(i.errorName=a),i}return Object(p.__extends)(t,e),t}(m),_=(function(e){function t(t,r,n){return e.call(this,t,r,"CopyError",n,b(t,u))||this}Object(p.__extends)(t,e)}(C),function(e){function t(t,r,n){return e.call(this,t,r,"PasteError",n,b(t,d))||this}Object(p.__extends)(t,e)}(C),function(e){function t(t,r,n){return e.call(this,t,r,"CancelError",n,b(t,g))||this}Object(p.__extends)(t,e)}(C),function(e){function t(t,r,n){return e.call(this,t,r,"ClipboardPlatformError",n,b(t,l))||this}return Object(p.__extends)(t,e),t}(C));!function(e){function t(t,r,n){return e.call(this,t,r,"SharedClipboardError",n,b(t,l))||this}Object(p.__extends)(t,e)}(C);new RegExp("(\\bTrident/| MSIE )"),new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");var T={postMessage:function(e,t,r,n){e.postMessage(t,r,n)}};var E,L,I,P,M=(E={items:{}},{getData:function(){return E},getItem:function(e){},setItem:function(e,t){throw new v("Cannot set an item with clipboard data format '".concat(e,"' in an immutable empty clipboard (content is ").concat(t&&t.length>0?"not ":"","empty)"))},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return D(void 0)}});function A(){return M}function O(e){return e&&e.items?Object.keys(e.items).length:0}function x(e){return O(e&&e.getData())}function W(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return j(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return D(t)}}}function j(e,t){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");return e.items[t]}function D(e){var t=[];if(0===O(e))return t;for(var r in e.items){var n=j(e,r);n||(n="");var o={clipboardDataFormat:r,data:n,deferred:!1};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(L||(L={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell"}(I||(I={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(P||(P={}));var F="sharedClipboardSettings",U=V(),R=!1,N=2;function J(){if(!R)throw new v("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return U}function H(){R=!1,function(){if(!window||!(F in window))return U=V(),void(R=!0);var e=window[F];if(!e||"object"!=typeof e)return U=V(),void(R=!0);k(e)}()}function z(e){R=!1,k(e)}function k(e){if(!e)throw new S("","sharedClipboardSettingsCandidate");var t=V();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return U=t,void(R=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return i().ULS.traceTag(596124181,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),U=t,void(R=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,n=r.indexOf("-");n>=0&&(r=r.substr(n+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){i().ULS.traceTag(579737680,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return i().ULS.traceTag(596124182,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],U=t,void(R=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){i().ULS.traceTag(579737681,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return i().ULS.traceTag(596124183,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],U=t,void(R=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return i().ULS.traceTag(596124184,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],U=t,void(R=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return i().ULS.traceTag(596124185,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' or '").concat(r,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],U=t,void(R=!0)}t.whitelistOriginComponents=!0,U=t,R=!0}function V(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:N,remoteLoggerPath:""}}var G,B,K=new RegExp("^\\d+$"),q=!1;function Q(e){if(!e)throw new S("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new w("Missing protocol","origin",e);if(1===r.length)throw new w("Missing domain","origin",e);if(r.length>2)throw new w("'".concat("://","' should appear once"),"origin",e);var n=r[1];if(!n)throw new w("Missing domain","origin",e);if(t=r[0]+"://",!(r=(n=n.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2)throw new w("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new w("The last part of the origin should be the domain","origin",e);if(!(r=n.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new w("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=n=r[0].trim(),2===r.length){var o=r[1].trim(),s=K.exec(o);if(!s||1!==s.length)throw new w("Invalid port number","origin",e);var c=Number(o);if(isNaN(c))throw new w("Invalid port number","origin",e);t+=":"+o}return i().ULS.traceTag(596452423,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"getValidatedOrigin: origin = '".concat(e,"'; validated origin = '").concat(t,"'")),t}function X(e){ee();var t,r=Q(e),n=Q((t="",window&&window.location&&window.location.origin?(t=window.location.origin)||(t=""):(i().ULS.traceTag(595932950,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: ".concat(!!window,". is window.location exist: ").concat(window&&!!window.location,". is window.location.origin exist ").concat(window&&window.location&&!!window.location.origin,". is window.location.protocol exist ").concat(window&&window.location&&!!window.location.protocol,". is window.location.hostname exist ").concat(window&&window.location&&!!window.location.hostname,". is window.location.port exist ").concat(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(t=window.location.protocol+"//"+window.location.hostname,window.location.origin=t)),{origin:t}).origin);if(r===n)return r;if(!J().whitelistOriginComponents)throw new v("validateOriginForReceivedMessage: Caller origin '".concat(e,"' doesn't match the current window's origin '").concat(n,"'"));var o=$(r),s=$(n);if(o.protocol!==s.protocol)throw new v("validateRemoteWindowOrigin: Caller origin's protocol '".concat(o.protocol,"' doesn't match the current window origin's protocol '").concat(s.protocol,"'"));if(o.environment!==s.environment)throw new v("validateRemoteWindowOrigin: Caller origin's environment '".concat(o.environment,"' doesn't match the current window origin's environment '").concat(s.environment,"'"));return r}function $(e){ee();var t=e.split("://",2),r=t[0],n=Y(t[1]),o={protocol:r};if(o.environment=Z(e,n,B),n.length<=o.environment.length+1)throw new w("Missing app component","origin",e);if("."!==n.charAt(o.environment.length))throw new w("Missing a domain separator after the environment component","origin",e);var a=n.substr(o.environment.length+".".length);if(o.app=Z(e,a,G),o.app.length<a.length&&"-"!==a.charAt(o.app.length))throw new w("When the Office Online app name is not the domain prefix, '".concat("-","' should precede it"),"origin",e);return o}function Y(e){if(!e)throw new S("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function Z(e,t,r){if(!t)throw new S("","reversedValidatedHostname");if(!r)throw new S("","reversedStringsToLengthMap");var n=t.length,o=Object.keys(r).filter((function(e){var o=r[e];return o<=n&&t.substr(0,o)===e}));if(o&&o.length>0)return Y(o[0]);throw new w("Invalid origin","validatedOrigin",e)}function ee(){if(!q){var e=J();e.whitelistOriginComponents&&(G=te(e.sharedClipboardHostingApps),B=te(e.sharedClipboardHostingEnvironments),q=!0)}}function te(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[Y(e)]=e.length})),t):t}function re(){return oe()}function ne(e){if(!e)throw new S("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new w("","id");return t}function oe(){return(Math.random()+1).toString(36).substring(7)}var ae=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function ie(e){return"get"===e||"set"===e||"init"===e}var se=function(e){if(!e)throw new S("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if(!e.destination)throw new S("","destination");if(!ie(e.operationCode))throw new w("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects no clipboard items"),"clipboardItemsData")};function ce(e,t,r,n,o){var a={id:e,operationCode:t,failed:r,error:n,clipboardItemsData:o};return le(a),a}var le=function(e){if(!e)throw new S("","clipboardOperationResultMessage");for(var t=!1,r=0,n=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<n.length;r++){var o=n[r];if(e.hasOwnProperty(o)){t=!0;break}}if(!t)throw new y("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw i().ULS.traceTag(553747865,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Missing argument 'id'. keys: ".concat(JSON.stringify(Object.keys(e)),", isConstructorObject: ").concat(e.constructor===Object,", operationCode: ").concat(e.operationCode,", id: ").concat(e.id,", failed: ").concat(e.failed,", error: ").concat(e.error,".")),new S("","id");if(!e.operationCode)throw new S("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new w("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new w("A failed '".concat(e.operationCode,"' operation expects a non-empty error argument"),"error");if(e.clipboardItemsData)throw new w("A failed '".concat(e.operationCode,"' operation does not expect a clipboardItemsData argument"),"clipboardItemsData")}else{if(e.error)throw new w("'".concat(e.operationCode,"' expects an empty error argument"),"error");if("unknownresult"===e.operationCode)throw new w("'".concat(e.operationCode,"' can only be used with a failure message"),"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects a clipboardItems argument"),"clipboardItemsData")}else if(e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects no clipboardItemsData argument"),"clipboardItemsData")};function ue(e){if(!e||0===e.trim().length)throw new w("","className",e);return function(){var t=!1;function r(t){return"".concat(e,":").concat(t,": already disposed")}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&i().ULS.traceTag(596456217,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new v(r(e))}}}()}var de=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=ue("".concat(e))}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,i().ULS.traceTag(596453007,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Clipboard strategy type '".concat(t.clipboardStrategyType,"' was initialized.")),Promise.resolve(t)}),(function(e){return i().ULS.traceTag(596453008,a.LogCategory.msoulscat_ES_EWAJS,f(e)?a.TraceLevel.Info:a.TraceLevel.Error,"Failed to initialize clipboard strategy type '".concat(t.clipboardStrategyType,"'. Error: ").concat(a.utils.getStringifiedError(e))),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return i().ULS.shipAssertTag(596121485,a.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new _(l.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new _(l.SetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").set"),e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return i().ULS.shipAssertTag(596121486,a.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new _(l.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new _(l.GetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").get"),e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(A(),e):(i().ULS.shipAssertTag(595882508,a.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new _(l.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new _(l.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),ge=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function pe(e){var t=e;return t&&0!==t.trim().length||(t=re()),new ye(t)}function fe(){return ge?window.performance.now():Date.now()}function he(e){return ge?new Date(e+window.performance.timing.navigationStart):new Date(e)}function me(e,t,r){if(!r)throw new S("","creationTimestamp");return"".concat(e?"Fulfilled":"Still unfulfilled"," after ").concat(e?t?t-r:"?":fe()-r,"ms")}var ye=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=ne(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=fe(),i().ULS.traceTag(596456225,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: creating deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' on ").concat(he(this.creationTimestamp))),this.promise=new Promise((function(e,t){i().ULS.traceTag(596456226,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: registering callback for promise #".concat(r.sequenceId," with id '").concat(r.id,"' on ").concat(he(fe()))),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):i().ULS.traceTag(596456257,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):i().ULS.traceTag(596456260,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=fe(),i().ULS.traceTag(596456261,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: marking promise #".concat(this.sequenceId," with id '").concat(this.id,"' as fulfilled (").concat(this.rejected?"rejected":"resolved","). ").concat(me(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))))},e.prototype.fulfillmentCheck=function(e){return i().ULS.traceTag(596456258,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: asked to ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"'")),this.isFulfilled&&i().ULS.traceTag(596456259,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise: cannot ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"' since it was ").concat(this.rejected?"rejected":"resolved"," already on ").concat(he(this.fulfillmentTimestamp),". ").concat(me(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))),this.isFulfilled},e.sequenceId=0,e}();!function(){function e(){this.deferredResultMessagePromiseCache={}}e.prototype.getDeferredPromise=function(e){var t=ne(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return i().ULS.traceTag(596456218,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '".concat(e,"'.")),t.promise;i().ULS.traceTag(596456219,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '".concat(e,"'."))},e.prototype.addNewPromise=function(e){var t=pe(e);if(this.getDeferredPromise(t.id))throw new w("A deferred promise already exists in the cache for the specified id","id",t.id);var r=ne(t.id);return this.deferredResultMessagePromiseCache[r]=t,i().ULS.traceTag(596456220,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '".concat(t.id,"'.")),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=ne(e);delete this.deferredResultMessagePromiseCache[t],i().ULS.traceTag(596456222,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: deleted id '".concat(e,"'."))}else i().ULS.traceTag(596456221,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '".concat(e,"' since this id is not associated with an existing deferred promise."))},e.prototype.clear=function(){if(i().ULS.traceTag(596456223,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: clearing ".concat(this.getLength()," items from the cache")),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){i().ULS.traceTag(596456224,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '".concat(e,"' with this exception: ").concat(t.message,". Ignoring."))}}this.deferredResultMessagePromiseCache={}}}();function Se(e){if(!e)throw new S("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new S("","incomingMessage");if(!t)throw new S("","validator");if(0===e.length)throw new w("An empty message is invalid","incomingMessage");var r,n=e.trim();if(0===n.length)throw new w("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(n)}catch(t){throw new w("Deserialization failed","incomingMessage","Contains ".concat(e.length.toString()," characters"),t)}if(!r)throw new w("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function we(e){if(!e)throw new S("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new S("","outgoingMessage");if(!t)throw new S("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new w("Serialization failed","outgoingMessage","".concat(Object.keys(e).length," properties"),t)}return i().ULS.traceTag(596452375,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"The length of the serialized message is ".concat(t.length)),t}(e)}(t,e)}}}function ve(e){if(!e)throw new S("","remoteWindow");if(!("window"in e)||!e.window)throw new S("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new S("","remoteWindow.windowOrigin");var t=X(e.windowOrigin);return{window:e.window,windowOrigin:t}}var be=function(){function e(e,t,r,n){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=ue(n)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(!function(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){i().ULS.traceTag(596456216,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," threw an exception: ").concat(e.message)),r||(r=new v(e.message,e))}else i().ULS.traceTag(596456215,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," is empty"))})),r)throw r}else i().ULS.traceTag(596456214,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw i().ULS.shipAssertTag(596121484,a.LogCategory.msoulscat_ES_EWAJS,!1,t),new v(t)}this.sender.postMessage(e)},e}();function Ce(){return _e}var _e={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};var Te=function(){function e(e,t,r){var n=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return n.onMessageReceived(e)},!e)throw new S("","deserializer");if(!t)throw new S("","handler");if(!r)throw new S("","windowRPC");this.disposableImplementationExtension=ue("WindowRPCReceiverInternal"),this.remoteWindow=ve(r.remoteWindow),Ce().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Ce().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return i().ULS.traceTag(596452370,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return i().ULS.traceTag(596452371,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return i().ULS.traceTag(596452372,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return i().ULS.traceTag(596452373,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){i().ULS.traceTag(596452374,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. ".concat(a.utils.getStringifiedError(e)));try{this.handler.handleDeserializationError(e)}catch(e){i().ULS.traceTag(596452184,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. ".concat(a.utils.getStringifiedError(e)))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){i().ULS.traceTag(595985880,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(a.utils.getStringifiedError(e)))}))}catch(e){i().ULS.traceTag(596452186,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(a.utils.getStringifiedError(e)))}else i().ULS.traceTag(596452185,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();var Ee=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S("","serializer");if(!t)throw new S("","windowRPC");this.disposableImplementationExtension=ue("WindowRPCSenderInternal"),this.remoteWindow=ve(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new S("","outgoingMessage");if(!this.remoteWindow.window)throw new v("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new v("The remote window does not support postMessage");var t=this.serializer.serialize(e);T.postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Le(e){return"OfficeOnlineCCP_Metadata_"+e}var Ie;!function(){function e(){this.startTime=a.perfWatch.timeStamp()}e.prototype.profilingMessage=function(e){var t=a.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: ".concat(e,", pasteId: ").concat(this.id,", timeMS: ").concat(t.toFixed())}}();!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Ie||(Ie={}));var Pe=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new _(l.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new _(l.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=L.LocalStorage,this.disposableImplementationExtension=ue("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),i().ULS.traceTag(595716238,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='".concat(e?e.id:"","'"));var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(A());try{var r=JSON.parse(t);if(!r||0===O(r))return Promise.resolve(A());var n=W(r);return Promise.resolve(n)}catch(e){return Promise.resolve(A())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),i().ULS.traceTag(595716239,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"localStorageClipboardStorage.set: item count=".concat(x(e),"'; commandParameters.id='").concat(t?t.id:"","'")),0===x(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r="".concat(this.localStorageKey+"_LocalStorageChangedFlag"),n=re();return i().ULS.traceTag(595654546,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = ".concat(r,". eventFlagValue = ").concat(n)),localStorage.setItem(r,n),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Me(e){return i().ULS.traceTag(595716236,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Attempting to create clipboard strategy type '".concat(c.LocalStorage,"' with localStorageKey: '").concat(e,"'")),(new Ae).initialize(function(e){try{i().ULS.traceTag(595716237,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Attempting to create clipboard storage type '".concat(L.LocalStorage,"'"));var t=new Pe(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}var Ae=function(e){function t(t){return e.call(this,c.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(p.__extends)(t,e),t}(de),Oe=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;i().ULS.shipAssertTag(595716249,a.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),i().ULS.traceTag(595716288,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ".concat(e.key,". localStorageKeyToWatch = ").concat(this.localStorageKeyToWatch,". lastLocalStorageValue = ").concat(this.lastLocalStorageValue)),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),i().ULS.traceTag(595716289,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){i().ULS.traceTag(595716295,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return i().ULS.traceTag(595715525,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),i().ULS.traceTag(595716232,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ".concat(e.lastLocalStorageValue))}),(function(e){i().ULS.traceTag(595716233,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return i().ULS.traceTag(595715526,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ".concat(this.lastLocalStorageValue,". currentLocalStorageValue = ").concat(e)),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(i().ULS.traceTag(595715527,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged())return i().ULS.traceTag(595715528,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),Promise.resolve();var r=pe(),n=new Date,o=setInterval((function(){var s=(new Date).getTime()-n.getTime();i().ULS.traceTag(595715529,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ".concat(n,". elapseTime = ").concat(s,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),t.isLocalStorageValueChanged()?(clearInterval(o),i().ULS.traceTag(595716234,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ".concat(n,". elapseTime = ").concat(s,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.resolve()):s>e&&(clearInterval(o),i().ULS.traceTag(595716235,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ".concat(n,". elapseTime = ").concat(s,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.reject())}),200);return r.promise},e}(),xe=(r(7),"\n"),We=(new RegExp("(".concat(xe).concat("\r",")|(").concat("\r").concat(xe,")|(").concat("\r",")"),"g"),new RegExp("(".concat("\t",")"),"g"),new RegExp("<","g"),new RegExp(">","g"),"\x3c!--EndFragment--\x3e");"Version:0.9".concat(xe,"StartHTML:0000000").concat(100).concat(xe,"EndHTML:{EndHTML0}").concat(xe,"StartFragment:0000000").concat(134).concat(xe,"EndFragment:{EndFragm}").concat(xe,"<html>").concat(xe,"<body>").concat(xe).concat("\x3c!--StartFragment--\x3e").concat(xe),"".concat(We).concat(xe,"</body>").concat(xe,"</html>");var je,De=r(4);function Fe(e,t,r){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,r){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,r),n.send(e))}(e,t,r)}}function Ue(e,t,r,n){var o=[],a=e.map((function(e){return function(e,t,r){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=r.findIndex((function(t){return t===e.correlationId}));o<0&&(o=r.push(e.correlationId)-1),n.I=o}var a=1e3*e.type+e.level;return n.D=a,n}(e,n,o)})),i=function(e,t,r,n,o){var a={};a.T=e,a.L=t,a.S=r,a.I=n,o&&o.length>0&&(a.W=o);return a.V=1,a}(n,a,t,r,o);return JSON.stringify(i)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(je||(je={}));var Re;!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(Re||(Re={}));var Ne=function(){function e(t,r,n){var o=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){o.triggerUpload(!1,!1)},this.flush=function(){o.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return o.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,r){(window.clearTimeout(o.timeoutId),o.logCache.length>0)&&(o.uploadId+=1,Fe(Ue(o.logCache,o.userSessionId,o.uploadId,o.timestampBase),o.remoteUrlEndpoint,r),o.logCache=[],o.timestampBase=Date.now());t&&(o.timeoutId=window.setTimeout(o.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t;var a=r+"?usid="+t;void 0!==n&&n.forEach((function(e,t){a+="&"+t+"="+e})),this.remoteUrlEndpoint=a,window.setTimeout((function(){return o.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===Re.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}();!function(){function e(e,t,r){this.correlationId="",this.cache=new Ne(e,t,r)}e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.sendTraceTag=function(e,t,r,n){Je(this.cache,e,t,r,n,this.correlationId)},e.prototype.debugAssertTag=function(e,t,r,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(e,t,r,n){r&&Je(this.cache,e,t,Re.Error,n,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose}}();function Je(e,t,r,n,o,a){if(!(n>Re.Info)){var i={timestamp:Date.now(),category:r,tag:t,level:n,type:je.Trace,message:o,correlationId:a};e.handleTrace(i)}}function He(e,t){var r=function(e,t){var r=new Ne(e,t);return{sendTraceTag:function(e,t,n,o){return Je(r,e,t,n,o,"")},shipAssertTag:function(e,t,n,o){n&&Je(r,e,t,Re.Error,o,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose,setCorrelationId:function(){}}}(t,e);return{assertTag:function(e,t,n,o){return r.shipAssertTag(e,t,!n,o)},shipAssertTag:function(e,t,n,o){return r.shipAssertTag(e,t,!n,o)},debugTraceTag:r.sendTraceTag,traceTag:r.sendTraceTag}}var ze=function(e){function t(t){var r=e.call(this)||this;return r.clipboardStrategy=t,r.nameForTelemetry="ClipboardStrategyMessageHandler_StrategyType_".concat(t.clipboardStrategyType),r.addMessageHandler("get",{handleMessage:r.get.bind(r)}),r.addMessageHandler("set",{handleMessage:r.set.bind(r)}),r}return Object(p.__extends)(t,e),t.prototype.get=function(e,t){var r={userHash:e.userHash};return this.clipboardStrategy.get(r).then((function(e){return t.clipboardItemsData=e.getData(),Promise.resolve(t)}),(function(e){return ke(t,e)}))},t.prototype.set=function(e,t){var r={userHash:e.userHash},n=void 0;return e.clipboardItemsData&&(n=e.clipboardItemsData),this.clipboardStrategy.set(W(n),r).then((function(){return Promise.resolve(t)}),(function(e){return ke(t,e)}))},t}(function(){function e(){this._handlers={}}return e.prototype.handleMessage=function(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):ke(t,new _(l.UnsupportedOperationCode,"Operation code '".concat(e?e.operationCode:"incomingMessage is null","' is unsupported")))},e.prototype.addMessageHandler=function(e,t){e?e in this._handlers?i().ULS.shipAssertTag(595944464,a.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: handle for operation: ".concat(e," already exist")):this._handlers[e]=t:i().ULS.shipAssertTag(595944463,a.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")},e}());function ke(e,t){return Ve(e,t),Promise.resolve(e)}function Ve(e,t){e.failed=!0,e.error=a.utils.getStringifiedError(t)}var Ge=function(e){function t(t,r,n,o){var a=e.call(this,r,t,n,"WindowRPCServerInternal")||this;if(a.windowRPCServerState=o,!o)throw new _(l.CreateWindowRPCServer,"windowRPCServerState is undefined.");return a.receiver=function(e,t,r){return new Te(e,t,r)}(t,a,a),a.sender=function(e,t){return new Ee(e,t)}(r,a),a}return Object(p.__extends)(t,e),t.prototype.handleMessage=function(e){var t=this;if(i().ULS.traceTag(596452360,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"RPC Server - handleMessage: incomingMessage.id='".concat(e&&e.id,"'; incomingMessage.operationCode='").concat(e&&e.operationCode,"'; incomingMessage.clipboardItems.length=").concat(O(e&&e.clipboardItemsData))),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return i().ULS.traceTag(596129562,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();var r=e&&e.id?e.id:"unknownmessageid",n=!e||!e.operationCode||!ie(e.operationCode),o={id:r,failed:n,error:void 0,operationCode:n?"unknownresult":"".concat(e.operationCode,"result")};return this.routeOperation(e,o).then((function(e){return t.postMessage(e)})).catch((function(e){return i().ULS.traceTag(596452182,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"RPC Server - handleMessage: unable to send result message. Sending a failure message. ".concat(a.utils.getStringifiedError(e))),o.clipboardItemsData=void 0,Ve(o,e),t.postMessage(o)})).catch((function(e){return i().ULS.traceTag(596452183,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"RPC Server - handleMessage: unable to send failure result message. ".concat(a.utils.getStringifiedError(e))),Promise.reject(e)}))},t.prototype.routeOperation=function(e,t){if(this.windowRPCServerState.isInitializationPending())return ke(t,new _(l.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return ke(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);var r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):ke(t,new _(l.SelectClipboardStrategy,"messageHandler does not exist"))},t.prototype.handleDeserializationError=function(e){return this.postMessage({id:"unknownmessageid",failed:!0,error:a.utils.getStringifiedError(e),operationCode:"unknownresult"}).catch((function(e){i().ULS.traceTag(596451867,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"RPC Server - handleDeserializationError: unable to send failure result message. ".concat(a.utils.getStringifiedError(e)))}))},t.prototype.postMessage=function(t){try{return e.prototype.postMessage.call(this,t),Promise.resolve()}catch(e){return Promise.reject(new v("Unable to post message for operation '".concat(t&&t.operationCode?t.operationCode:"","'"),e))}},t}(be),Be=function(e){function t(t,r,n){var o=e.call(this,n,"getMetadata_longPollingresult")||this;return o.localStorageKeyChangeTracker=new Oe(r,t,o.raiseMetadataChangedEvent.bind(o)),o}return Object(p.__extends)(t,e),t.prototype.raiseMetadataChangedEvent=function(e){this.sendMessage(e.getData())},t}(function(){function e(e,t){this.windowRPCServer=e,this.operationCode=t}return e.prototype.sendMessage=function(e){if(this.windowRPCServer){var t=ce(re(),this.operationCode,!1,void 0,e);this.windowRPCServer.postMessage(t)}},e}());function Ke(e,t){if(!t)return Promise.resolve(!1);var r=function(e,t){try{var r=window.parent,n=e;if(!n)throw new S("remoteWindowOrigin is undefined","remoteWindowOrigin");return new Ge(Se(se),we(le),{window:r,windowOrigin:n},t)}catch(e){return void i().ULS.shipAssertTag(595981475,a.LogCategory.msoulscat_ES_EWAJS,!1,"createWindowRPCServer failed with exception: ".concat(a.utils.getStringifiedError(e)))}}(e,qe);if(!r)return i().ULS.traceTag(595947554,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);var n=pe("initmessageid");return(Qe={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:n,windowRPCServer:r}).initializationDeferredPromise.promise.then((function(){return function(){var e=$e();if(i().ULS.shipAssertTag(595947555,a.LogCategory.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new v("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));var t=ce(Ye(),"initresult",!1);return e.postMessage(t)}()}),(function(e){return function(e){var t=$e();if(i().ULS.shipAssertTag(595947584,a.LogCategory.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new v("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));var r=ce(Ye(),"initresult",!0,a.utils.getStringifiedError(e));return t.postMessage(r)}(e)})).catch((function(){})),t.then((function(e){return Qe&&(Qe.metadataDataChangedMessageSender=new Be(e.metadataClipboardStrategy,e.localStorageMetadataKeyToWatch,r)),function(e){var t=Object.keys(e).map((function(t){return"Name: ".concat(t,", handlerName: ").concat(e[t]&&e[t].nameForTelemetry)})).join(", ");if(i().ULS.traceTag(595947585,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"markInitializationSuccess: Created and initialized ClipboardStrategies '".concat(t,"'")),i().ULS.shipAssertTag(595947586,a.LogCategory.msoulscat_ES_EWAJS,!!Qe,"markInitializationSuccess: windowRPCServerInternalState must be defined"),!Qe)return;Qe.clipboardOperationMessageHandlerMap=e,Qe.clipboardInitError=void 0,Qe.clipboardInitTimestamp=Date.now(),Qe.initializationDeferredPromise&&Qe.initializationDeferredPromise.resolve()}(e.messageHandlers),Promise.resolve(!0)}),(function(e){return function(e){if(i().ULS.traceTag(595947587,a.LogCategory.msoulscat_ES_EWAJS,f(e)?a.TraceLevel.Info:a.TraceLevel.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),i().ULS.shipAssertTag(595947588,a.LogCategory.msoulscat_ES_EWAJS,!!Qe,"markInitializationFailure: windowRPCServerInternalState must be defined"),!Qe)return;Qe.clipboardOperationMessageHandlerMap=void 0,Qe.clipboardInitError=e,Qe.clipboardInitTimestamp=Date.now(),Qe.initializationDeferredPromise&&Qe.initializationDeferredPromise.reject(Qe.clipboardInitError)}(e),Promise.resolve(!1)}))}var qe={getMessageHandler:function(e){if(!Qe)return;if(!e)return void i().ULS.shipAssertTag(595945235,a.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined");if(!Qe.clipboardOperationMessageHandlerMap)return void i().ULS.shipAssertTag(595945236,a.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");if(!(e in Qe.clipboardOperationMessageHandlerMap))return void i().ULS.shipAssertTag(595945237,a.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: ".concat(e," is not part of ClipboardStrategyMap"));return Qe.clipboardOperationMessageHandlerMap[e]},isInitializationPending:Xe,isInitializedSuccessfully:function(){if(Qe)return!Xe()&&!!Qe.clipboardOperationMessageHandlerMap;return!1},getClipboardInitError:function(){if(Qe)return Qe.clipboardInitError;return}},Qe=void 0;function Xe(){return!Qe||!Qe.initializationDeferredPromise||!Qe.initializationDeferredPromise.fulfilled()}function $e(){if(Qe)return Qe.windowRPCServer}function Ye(){if(!Qe)return"";var e=Qe.initMessageIdUniqueRunningSuffix;return Qe.initMessageIdUniqueRunningSuffix+=1,"".concat("initmessageid").concat(e)}function Ze(e){return-1===decodeURIComponent(window.location.href).indexOf(e)}function et(){s(new De.ConsoleLogger),Object(a.initEwaUtils)({isChangeGateEnabled:Ze}),n.initializeSharedClipboardSettingsFromWindow();var e=a.utils.getQueryParameterByName(window.location.href,"CreatorOrigin")||"";if(!e)throw new S("remoteWindowOrigin is undefined","remoteWindowOrigin");e=X(e);try{var t=a.utils.getQueryParameterByName(window.location.href,"usid")||"",r=a.utils.getQueryParameterByName(window.location.href,"BulsEndpointUrl")||"";if(!r){var o=n.getSharedClipboardSettings().remoteLoggerPath;o&&t&&(r="".concat(e).concat(o))}r&&s(He(r,t))}catch(e){}var i=n.getSharedClipboardSettings().sharedClipboardSchemaVersion;return Ke(e,Me(function(e){return"OfficeOnlineCCP_Data_"+e}(i)).then((function(e){var t=Le(i),r=function(e){return Le(e)+"_LocalStorageChangedFlag"}(i);return Me(t).then((function(t){var n={};return n[ae.localStorageData]=new ze(e),n[ae.localStorageMetadata]=new ze(t),{messageHandlers:n,localStorageMetadataKeyToWatch:r,dataClipboardStrategy:e,metadataClipboardStrategy:t}}))})))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(2),t),n.__exportStar(r(24),t),n.__exportStar(r(3),t),n.__exportStar(r(25),t),n.__exportStar(r(26),t),n.__exportStar(r(27),t)},function(e,t,r){"use strict";r.r(t);var n=r(0);for(var o in n)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(o);var a=r(6);r.d(t,"initialize",(function(){return a.a}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var o=Object.getPrototypeOf(t);o&&"object"==typeof o&&Object.keys(o).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a={};return Object.keys(n).forEach((function(t){a[t]=e(n[t],r+1)})),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},o=1;o<=t;o+=1)n(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var o=e[n];r=r.catch((function(){return t(o)}))},o=1;o<e.length;o+=1)n(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,o=0;o<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==n-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.getBoundingRectForText=function(e,t,r,n){function o(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var a=e.childNodes,i=0;i<a.length&&t>=0;i+=1)t=o(a[i],t,r),n&&"DIV"===a[i].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var a=document.createRange();return o(e,t,(function(e,t){return a.setStart(e,t)})),o(e,r,(function(e,t){return a.setEnd(e,t)})),a.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=n(),r=e,a=t,i={},s=function(e,t,n){return function(e,t,r,n,a,i){o(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:i,marks:e},c=JSON.stringify(s);a(c)}(i,r,a,e,t,n)};return i.start=0,{mark:function(e){return function(e){return o(i,e,a)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var n=r(13),o={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return o},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,n.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),o=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(14),t),n.__exportStar(r(15),t)},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){n=e};t.isChangeGateEnabled=function(e){return!n||n.isChangeGateEnabled(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var o=n(),a=r;return{reset:function(e){null!=e&&(a=e),o=n()},stop:function(r){var i=n()-o,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var n=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var o=!1,a=r.performance;try{a&&a.now&&a.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var i=0;i<e.length;i+=1){try{if(o){t.perfNow=!0;var s=Math.floor(100*a.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0;t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)};t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},function(e,t,r){"use strict";e.exports=r(22)()?globalThis:r(23)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(2);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(3);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(1),o=r(3);function a(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(1),o=r(2);function a(e){for(var t,r,a={},i=0,s=Object.keys(e);i<s.length;i++){var c=s[i];a[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var l=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},l()),a)})),l}t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/sharedClipboard.min.js.map/9ce7abb60c7c34cf3771872947407908/sharedClipboard.min.js.map