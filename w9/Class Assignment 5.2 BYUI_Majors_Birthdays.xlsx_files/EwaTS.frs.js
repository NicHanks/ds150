'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1325:function(B,A,a){(function(c){a.d(A,"a",function(){return R});var b=a(0),k=a(15),m=a(185),d=a(137),n=a(1326),l=a(40),f=a(265),h=a(45),t=a(395),u=a(204),v=a(59),y=a(91),C=a(13),x=a(19),w=a(44),z=a(1327),F=a(1),J=a(102);class R extends l.a{constructor(I,O,Y){super();this.GKi=n.a.getTypeName();this.TKb=this.WZ=this.xg=null;this.imageHeight=this.imageWidth=0;this.YUa=this.errorMessage=this.tableData=null;this.rEd=
0;this.t$c=!1;this.h5e=K=>{if(K){var L={};if((()=>{let ba=w.d(this.ZNh(K.data));({ev:L}=ba);return ba})().returnValue){var X=Object(d.a)(Object,L);if("."===X.DataFromPictureWildcard)if(X.SessionId!==this.YUa)k.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(k.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
X.CmdType){case "ACK":this.t$c=!0;this.GEg.stop();k.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.F6j();0<this.errorMessage.length?this.psg():0<this.tableData.length&&this.Gsg();break;case "insert_html":const ba=this.$.oa.ua,Q={};var T=x.h(this.$).ha.pa.og.clone();Q.PasteId=m.a.create().toString();Q.DestinationRanges=h.s(h.v(T,this.$));T=X.Parameters.split("|",3);F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||k.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${T[0]}|${T[1]}|${T[2]}.`);T=X.Parameters.indexOf("|");T=X.Parameters.indexOf("|",T+1);T=X.Parameters.indexOf("|",T+1);Q.SourceHtml=X.Parameters.substring(T+1);Q.CopyOperationId=null;const P=ba.Oa(1,ba.qf());P.pasteHtmlParameters=Q;t.a(this.$.userOperationManager,(ka,ia,Ba)=>v.h(ba,"pasteHtmlContent",P,ka,ia,Ba,null,64),ka=>new u.a(204,0,ka,1),null);this.rEd++;k.ULS.sendTraceTag(523805135,
0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.rEd.toString()}`);J.b("DataFromPictureCompleted")}}}};this.FKi=(K,L)=>{if(K=L.annotation)if(!L.parentPath||1>=L.parentPath.length||L.parentPath[1]!==this.YUa)k.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{k.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
L=K.errorCode;switch(L){case null:case -1:this.errorMessage=C.a.instance.ia(2273);break;case 1:this.errorMessage=C.a.instance.ia(2274);break;case 2:this.errorMessage=C.a.instance.ia(2275)}0<this.errorMessage.length&&k.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${L?L.toString():"null"}.`);this.$Oe.stop();this.tableData=K.html;this.t$c&&(0<this.errorMessage.length?this.psg():0<this.tableData.length&&this.Gsg())}else k.ULS.sendTraceTag(523805125,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=I;this.zk=O;this.uploaderCreator=Y;this.initialize()}dispose(){window.removeEventListener("message",this.h5e,!1);this.zk.unregister("DataFromPicture");super.dispose()}yyj(I,O){k.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let Y=new Image;Y.onload=()=>{var K=document.createElement("canvas");K.width=Y.width;K.height=Y.height;const L=K.getContext("2d");
try{L.drawImage(Y,0,0,Y.width,Y.height)}catch(ba){k.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${ba.message}`);return}let X;try{X=K.toDataURL("image/jpeg")}catch(ba){k.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${ba.message}`);return}K=X.split(",");if(2>K.length)k.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{K=K[1];try{var T=window.self.atob(K)}catch(ba){k.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${ba.message}`);return}28E5<T.length?(k.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),O.skk()):(this.z2j(this.xg,this.WZ,K,Y.width,Y.height),URL.revokeObjectURL(Y.src),Y=null,k.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
Y.src=I}sHj(I,O,Y,K){this.xg=I;this.WZ=K;this.uploaderCreator.ONi(this.$,O,Y,K,this)}z2j(I,O,Y,K,L){this.YUa=m.a.create().toString();this.rEd=0;this.TKb=Y;this.imageWidth=K;this.imageHeight=L;this.errorMessage=this.tableData="";this.t$c=!1;this.GEg=this.$.Ve.wj("LoadResource","DataFromPictureTaskpaneLaunch");this.GEg.start();this.bBj(I,O);this.$Oe=this.$.Ve.wj("LoadResource","DataFromPictureAnnotation");this.$Oe.start();this.aHk()}aHk(){if(this.TKb.length){var I=window.self.atob(this.TKb),O=new Uint8Array(I.length);
for(let Y=0;Y<I.length;Y++)O[Y]=I.charCodeAt(Y);this.zk.$Gk(O,this.YUa,this.imageWidth,this.imageHeight)}else k.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}bBj(I,O){O.SessionID=this.YUa;O.DataFromPictureAssetId="FA000000050";O.LoadDataFromPictureTaskpane=!0;I=new y.a(-859308420,I.method,I.mode,I.Ch,I.tabName);this.$.Ha.Me(I,O)}$pd(I){try{const O=c.from(I,"utf16le").toString("base64");return z.a.dRa(this.YUa,O)}catch(O){return k.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}ZNh(I){try{const O=z.a.dRa(this.YUa,I);return c.from(O,"base64").toString("utf16le")}catch(O){return k.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}F6j(){if(this.TKb.length){var I=f.a(this.$).Vha("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.imageData=this.$pd(this.TKb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",
O,Y=>{Y&&k.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else k.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}Gsg(){if(this.tableData.length){var I=f.a(this.$).Vha("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.tableHtml=this.$pd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",O,
Y=>{Y&&k.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else k.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}psg(){if(this.errorMessage.length){var I=f.a(this.$).Vha("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.errorMessage=this.$pd(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",
O,Y=>{Y&&k.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else k.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.h5e,!1);this.zk.register(this.zk.fW().WX("DataFromPicture").VX(()=>{}).activateAnnotation({annotationType:this.GKi,jy:!1,gX:this.FKi}).build())}}
Object(b.a)(R,"DataFromPictureManager",l.a,[659])}).call(this,a(699).sme)},1326:function(B,A,a){a.d(A,"a",function(){return b});B=a(0);A=a(823);var c=a(795);class b extends A.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(B.a)(b,"DetectedHtmlTableAnnotation",
A.a,[])},1327:function(B,A,a){a.d(A,"a",function(){return c});B=a(0);class c{static dRa(b,k){if(!(b&&k&&b.length&&k.length)||256<b.length)return"";const m=Array(256),d=Array(256);let n,l=0,f=0;let h,t="";for(n=0;256>n;n++)m[n]=n;for(n=0;256>n;n++){var u=b.charCodeAt(n%b.length);if(256<=u)return"";l=(l+m[n]+u)%256;u=m[n];m[n]=m[l];m[l]=u}for(n=0;256>n;n++)d[n]=m[256-n-1];l=n=0;for(b=0;b<k.length;b++){n=(n+1)%256;l=(l+m[n])%256;u=m[n];m[n]=m[l];m[l]=u;u=k.charCodeAt(b);if(256<=u)return"";h=u^m[(m[n]+
m[l])%256];f=(f+d[n])%256;u=d[n];d[n]=d[f];d[f]=u;t+=String.fromCharCode(h^m[(d[n]+d[f])%256])}return t}}Object(B.a)(c,"RC4A",null,[])},1382:function(B,A,a){a.r(A);var c={};a.r(c);a.d(c,"PasteShortcutManager",function(){return xg});var b={};a.r(b);a.d(b,"DataFromPictureCommandHandler",function(){return ae});var k={};a.r(k);a.d(k,"PictureCommandHandler",function(){return Hd});var m={};a.r(m);a.d(m,"FocusBasedReadout",function(){return oh});var d={};a.r(d);a.d(d,"AriaLiveNotifier",function(){return Wh});
var n={};a.r(n);a.d(n,"SelectionReadoutHandler",function(){return Ag});var l={};a.r(l);a.d(l,"EwaAccessibilityManager",function(){return Vh});var f={};a.r(f);a.d(f,"TableManager",function(){return nh});var h={};a.r(h);a.d(h,"SparklineManager",function(){return zh});var t={};a.r(t);a.d(t,"GridHighlightBehaviorEventManager",function(){return Ph});var u={};a.r(u);a.d(u,"GridHighlightsBehaviorManager",function(){return tb});var v={};a.r(v);a.d(v,"SessionReloadActivity",function(){return $b});var y={};
a.r(y);a.d(y,"UploaderCreator",function(){return ci});var C={};a.r(C);a.d(C,"WorkbookReadoutHandler",function(){return Jg});var x={};a.r(x);a.d(x,"EmbeddedWorkbookReadoutHandler",function(){return Hh});var w=a(0),z=a(15),F=a(759),J=a(584),R=a(137),I;(function(D){D[D.pPk=0]="applicationFeatureHelperHandler";D[D.LPk=1]="cloudPolicySettings";D[D.hPk=2]="alternateAuthToken"})(I||(I={}));Object(w.b)("ApplicationFeatureHelperRequestType",I);class O{constructor(){this.message=null;this.httpStatusCode=0}}
Object(w.a)(O,"HttpRequstToPromiseRejectData",null,[]);var Y=a(112),K=a(77),L=a(227),X=a(490),T=a(367),ba=a(194);class Q{constructor(D,ma){this.Fa=D;this.xk=ma}hS(D,ma,Ua,Xb,yc,Tc,Sc,Gd){Xb=void 0===Xb?null:Xb;yc=void 0===yc?null:yc;Tc=void 0===Tc?null:Tc;Sc=void 0===Sc?null:Sc;Gd=void 0===Gd?null:Gd;const De=I[Ua],ve=De+"RequestFailure";Y.Health.instance.recordKpiUsage(ve,T.b.FailureBased,"jpittsdirects",null);return new Promise((Xe,nf)=>{z.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
De);const uf=null!=Sc?Sc:this.Fa.Ng("ApplicationFeatureHelperRequestQueueTimeout",15E3),rg=null!=Gd?Gd:this.Fa.Ng("ApplicationFeatureHelperRequestSentTimeout",3E4);this.xk.o$(D,1,null,this.CIb(Ua,Xb),Tc,!1,1,$f=>{z.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",De);try{if(void 0===$f||null===$f||void 0===$f.data||null===$f.data||void 0===$f.data.responseData||null===$f.data.responseData){Y.Health.instance.recordKpiFailure(ve,"Invalid RequestSucceededEventArgs",
!1,!0,null);const bh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",De);nf(this.LM(bh,$f))}else if($f.data.httpStatus!==L.a.tL){Y.Health.instance.recordKpiFailure(ve,"HttpStatusCode_"+$f.data.httpStatus.toString(),!1,!0,null);const bh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
$f.data.httpStatus,De);nf(this.LM(bh,$f))}else{void 0!==yc&&null!==yc&&void 0!==$f.data.responseHeaders&&null!==$f.data.responseHeaders&&yc($f.data.responseHeaders);var og=ma($f.data.responseData);if(og)z.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",De),Xe(og);else{Y.Health.instance.recordKpiFailure(ve,"Parse Failure",!1,!0,null);const bh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
De);nf(this.LM(bh,$f))}}}catch(bh){Y.Health.instance.recordKpiFailure(ve,"Unexpected Failure",!1,!0,null),og=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",bh,De),nf(this.LM(og,$f))}},$f=>{var og;if($f.data){if(og=ba.a.fu())try{og.set("useCommonDomain",D.toLowerCase().includes("common").toString())}catch(bh){z.ULS.sendTraceTag(507876040,3004,50,"Failed to set useCommonDomain")}Y.Health.instance.recordKpiFailure(ve,"HttpStatusCode_"+$f.data.httpStatus.toString(),
!1,!0,{extendedProperties:og});og=X.a.eUa($f.data.responseData||"No Data");og=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",$f.data.httpStatus,og,De)}else Y.Health.instance.recordKpiFailure(ve,"Invalid RequestFailedEventArgs",!1,!0,null),og=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",De);nf(this.LM(og,$f))},null,void 0,void 0,
uf,rg)})}LM(D,ma){const Ua=new O;Ua.message=D;Ua.httpStatusCode=ma&&ma.data?ma.data.httpStatus:-1;return Ua}CIb(D,ma){const Ua={};Ua["x-UserDataSignature"]=this.Fa.Ta("UserDataSignature");Ua["x-LicensingIsEnabled"]=this.Fa.la("LicensingIsEnabled").toString();Ua["x-CacheIsEnabled"]=this.Fa.la("LicensingRedisIsEnabled").toString();Ua["x-OcpsIsEnabled"]=this.Fa.la("OcpsIsEnabled").toString();Ua["x-LicensingAADIdIsEnabled"]=this.Fa.la("LicensingAadIdIsEnabled").toString();0===D&&(Ua["x-LicenseCheckOnTenantEnabled"]=
"true",Ua["x-SupportUserConsentDependentFeatures"]="true",Ua["x-AFHUserConsentGroupValue"]="0",Ua["x-UseShellServiceForUserConsentGroup"]="true",Ua["x-SMBUserLicensingEnabled"]="true",Ua["x-AFHPIPLComplianceEnabled"]=K.a.$x(window.location.href,"wd_afhpipl")||"false",Ua["x-ConsumerLicensingSNICertIsEnabled"]=this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),Ua["x-MSGraphInLicensingIsEnabled"]=this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(ma)for(const Xb of ma.keys)Ua[Xb]=ma.ka(Xb);return Ua}}Object(w.a)(Q,"HttpRequestToPromiseUtility",null,[]);var P=a(5),ka;(function(D){D[D.ibj=0]="loki";D[D.sPk=1]="augloopACLP"})(ka||(ka={}));Object(w.b)("AlternateAuthSupportApp",ka);var ia=a(542),Ba=a(44);class va{constructor(){this.Token=null;this.ExpirationTime=0}}Object(w.a)(va,"WacAlternateAuthToken",null,[]);class W{constructor(D,ma){this.lwk=3E5;this.lYd=Ua=>{let Xb=null;({ev:Xb}=Ba.d(Ua));return Xb};if(void 0===D||null===
D||void 0===ma||null===ma)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Fa=D;this.Q3b=new F.a(J.a.Ki());this.v9=new Q(D,ma);void 0!==ia.a.GPd&&null!==ia.a.GPd&&void 0!==ia.a.JAc&&null!==ia.a.JAc&&0<ia.a.JAc&&(D=new va,D.Token=ia.a.GPd,D.ExpirationTime=ia.a.JAc,this.Q3b.da("loki",D))}Ogi(){let D=null;this.Q3b.$d(ka[0])&&(D=this.Q3b.ka(ka[0]));return void 0===D||null===D||this.wLd(D)?this.D8h():Promise.resolve(D.Token)}wLd(D){return D.ExpirationTime-Date.now()<this.lwk}D8h(){const D=
new F.a(J.a.Ki());D.da("X-AlternateAuthApp",ka[0]);return(this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.v9.hS(this.fK("/afhs/AlternateAuthHelperHandler.ashx",!0),this.lYd,2,D),this.v9.hS(this.fK("/afhs/AlternateAuthHelperHandler.ashx",!1),this.lYd,2,D)]):this.v9.hS(this.fK("/afhs/AlternateAuthHelperHandler.ashx",this.Fa.la("SuiteOriginForAFHSIsEnabled")),this.lYd,2,D)).then(ma=>{z.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",
ka[0]);this.Q3b.da(ka[0],ma);return ma.Token},ma=>{ma=Object(R.a)(O,ma);z.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",ma.message,ma.httpStatusCode);return null})}fK(D,ma){return String.format("{0}{1}?{2}",ma?this.Fa.Ta("SuiteOrigin"):this.Fa.Ta("WebServiceBase"),D,P.AFrameworkApplication.ml)}}Object(w.a)(W,"AlternateAuthHelper",null,[190]);var S=a(484);class da{constructor(D,ma,Ua){this.featureName=null;this.isEnabled=!1;this.tierName=
0;this.featureName=D;this.isEnabled=ma;this.tierName=Ua}}Object(w.a)(da,"FeatureStateChangeArgs",null,[]);var aa=a(267),za=a(35),qa=a(104),ta=a(185),Xa;(function(D){D[D.Enabled=0]="Enabled";D[D.Disabled=1]="Disabled"})(Xa||(Xa={}));Object(w.b)("FeatureState",Xa);var oa=a(81),ha=a(24),Za=a(465);class Fa{constructor(D,ma,Ua,Xb,yc){Ua=void 0===Ua?null:Ua;Xb=void 0===Xb?null:Xb;yc=void 0===yc?null:yc;this.RCa=this.M9b=this.ODe=this.Qya=this.P$b=null;this.oYd=Tc=>{(Tc=Ba.b(Tc))?(z.ULS.sendTraceTag(50436170,
3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),z.ULS.sendTraceTag(50938594,3004,50,"{0}",Tc)):z.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Tc.Features};this.TDi=()=>{z.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.RCa.then(Tc=>{this.Dhg(Tc)}).catch(()=>{this.Dhg({})})};this.T_d=Tc=>{try{Tc&&"Date"in Tc&&(this.M9b=new Date(Tc.Date),
z.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.M9b.toString()))}catch(Sc){z.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Sc)}};this.v9=new Q(D,ma);this.Fa=D;this.H1g=D.Ng("LicensingMaxRetryAttempts",0);this.Mub=D.la("IsO365ConsumerHost");this.T1c=D.la("IsO365CommercialHost");this.E1c=D.la("PremiumUpsellIsEnabled");this.w5a=!1;this.f3c=0;this.zqe=Ua;this.iIe=Xb;this.Ma=yc;this.Pya=D.la("LicensingIsEnabled");
this.rNa=D.la("OcpsIsEnabled")&&this.T1c;this.M9c=D.la("ShowPrivacyDialog")&&!!Xb;this.U6b=D.la("IsAnonymousUser");this.vnc=new Promise(Tc=>{Tc(!1)});this.kKa=new Promise(Tc=>{Tc(!0)});this.QCa=new F.a(J.a.Ki());this.Dac=!0;this.cze=this.Fqi();this.yJd()&&!this.U6b?(void 0!==P.AFrameworkApplication.ra&&null!==P.AFrameworkApplication.ra&&(this.P$b=P.AFrameworkApplication.ra.NG,void 0!==this.P$b&&null!==this.P$b&&(this.Qya=this.P$b.wj("WebServiceCall","ApplicationFeatureHelperService"))),this.RCa=this.She()):
this.RCa=new Promise(Tc=>{Tc({})});this.RCa.catch(Tc=>{Tc=Object(R.a)(O,Tc);z.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Tc?Tc.httpStatusCode.toString():"Unknown")});this.Dac&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Tc=>{this.w5a=Tc;return null})}Fqi(){const D=this.Fa.Zr("AllLicensedFeatures")?this.Fa.Pw("AllLicensedFeatures"):[],ma=new S.a;for(let Ua=0;Ua<D.length;Ua++)ma.add(D[Ua]);return ma}yJd(){return this.T1c||this.Mub}She(D,ma){D=
void 0===D?0:D;ma=void 0===ma?!1:ma;z.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",ma);const Ua=ba.a.fu();Ua&&(Ua.set("retryAttempt",D.toString()),Ua.set("forceRefresh",ma.toString()),Ua.set("isO365ConsumerHost",this.Mub.toString()),Ua.set("isO365CommercialHost",this.T1c.toString()),Ua.set("isFreemiumUpsellSettingEnabled",this.E1c.toString()),Ua.set("useCommonDomain",(this.Fa.la("SuiteOriginForAFHSIsEnabled")&&0===D).toString()),Ua.set("useRace",
this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString()));Y.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Ua);Y.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",T.b.SuccessBased,"waclicensing",Ua);void 0!==this.Qya&&null!==this.Qya&&this.Qya.start();let Xb=null;ma&&(Xb=new F.a(J.a.Ki()),Xb.da("x-LicensingForceRefresh","true"));this.ODe=new Date;return(this.Pya?this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",
!1)?Promise.race([this.v9.hS(this.fK("/afhs/ApplicationFeatureHelperHandler.ashx",!0),this.oYd,0,Xb,this.T_d,["Date"]),this.v9.hS(this.fK("/afhs/ApplicationFeatureHelperHandler.ashx",!1),this.oYd,0,Xb,this.T_d,["Date"])]):this.v9.hS(this.fK("/afhs/ApplicationFeatureHelperHandler.ashx",this.Fa.la("SuiteOriginForAFHSIsEnabled")&&0===D),this.oYd,0,Xb,this.T_d,["Date"]):Promise.resolve({})).then(yc=>{const Tc={durationMs:this.GCg(),extendedProperties:Ua};Tc.extendedProperties&&yc&&(Tc.extendedProperties.set("featureCount",
qa.a.count(yc).toString()),Tc.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in yc).toString()),Tc.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in yc).toString()),"FreemiumUpsell"in yc&&Tc.extendedProperties.set("isFreemiumUpsellEnabled",yc.FreemiumUpsell.toString()),this.M9b&&Tc.extendedProperties.set("fromCache",(this.M9b<this.ODe).toString()));Y.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Tc);return yc},yc=>{const Tc=Object.assign({},
{durationMs:this.GCg()}),Sc=Object(R.a)(O,yc);if(!Sc)return z.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Y.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Tc),new Promise((Gd,De)=>{De(yc)});Tc.extendedProperties=Ua;Tc.extendedProperties&&Tc.extendedProperties.set("status",Sc.httpStatusCode.toString());Y.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,Tc);return 408===Sc.httpStatusCode&&++D<=this.H1g?this.She(D):new Promise((Gd,De)=>{De(Sc)})})}fK(D,ma){ma=String.format("{0}{1}",ma?this.Fa.Ta("SuiteOrigin"):this.Fa.Ta("WebServiceBase"),D);this.Fa.Zr("ApplicationFeatureHelperHttpCachingEnabled")&&this.Fa.la("ApplicationFeatureHelperHttpCachingEnabled")&&(D=Fa.Oqc(this.Fa))&&0<D.length&&(this.Dac&&(D+="ucbf"),ma=new aa.QueryStringBuilder(ma),ma.am("afhskey",D),ma=ma.toString());return ma}isFeatureEnabled(D,ma){if(!this.rNa&&
!this.M9c&&!this.Pya)return this.kKa;z.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",D);if("ConnectedServices"===D){var Ua=this.rNa?this.zqe.sP("ControllerConnectedServicesEnabled"):this.kKa;const Tc=this.M9c?this.iIe.getSettings().then(Sc=>2!==Sc.Sy,()=>ma):this.kKa;return Ua.then(Sc=>Sc?Tc:this.vnc)}if("FreemiumUpsell"===D&&(!this.E1c||!this.Mub||this.U6b))return this.vnc;Ua=null;Ua=this.rNa?this.zqe.isFeatureEnabled(D):
this.kKa;let Xb=null;Xb=this.Pya?this.bWi(D,ma):this.kKa;let yc=null;yc=this.M9c?this.iIe.isFeatureEnabled(D):this.kKa;return Ua.then(Tc=>Tc?yc.then(Sc=>Sc?Xb:this.vnc):this.vnc).then(Tc=>{this.pQf(D,Tc,!0);return Tc},()=>{this.pQf(D,ma,!1);return ma})}pQf(D,ma,Ua){z.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",D,ma,Ua)}getFeatureTier(D,ma){if(!this.Pya)return new Promise(Ua=>{Ua(2)});z.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
D);return this.RCa.then(Ua=>this.Qrc(D,Ua,ma),()=>ma)}isFreemiumUpsellEnabled(){if(this.E1c&&this.Mub&&!this.U6b){if(this.w5a&&2!==this.f3c||!this.w5a&&1!==this.f3c)z.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.w5a.toString()),this.f3c=this.w5a?2:1;return this.w5a}return!1}M2i(){return Object(Za.g)()&&this.Mub&&this.U6b}launchUpsellExperience(D,ma){ma=void 0===ma?null:ma;z.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
D));var Ua=ba.a.fu();Ua&&(Ua.set("experienceId",D),ma&&Ua.set("campaignId",ma));Y.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",T.b.SuccessBased,"waclicensing",Ua);(Ua=oa.a.instance.pj("Common.IInProductMessagingUIManager"))?Ua.hOf(D,this.TDi,ma):(z.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Y.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ma.rh(ha.a.Noc,2,{["experience"]:D}))}i_a(D,ma){if(!this.Pya)return null;
if(!D||!ma)return z.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const Ua=ta.a.create().toString();this.QCa.$d(D)||this.QCa.da(D,new F.a(J.a.Ki()));this.QCa.ka(D).add(Ua,ma);z.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ua,D));return Ua}b3d(D,ma){this.Pya&&(D&&this.QCa.$d(D)?ma&&ta.a.isValid(ma)?this.QCa.ka(D).$d(ma)?
(z.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",ma,D)),this.QCa.ka(D).remove(ma)):z.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",ma,D)):z.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
ma,D)):z.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",D)))}Qrc(D,ma,Ua){return this.Dac?D in ma?ma[D].LicenseTier:Ua:D in ma?this.eDj(ma[D],Ua):Ua}eDj(D,ma){switch(D.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return ma}}Dhg(D){z.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const ma=this.She(0,
!0);ma.then(Ua=>{this.RCa=ma;qa.a.count(Ua)>qa.a.count(D)?Y.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Y.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const Xb of this.QCa.keys)if(Xb in Ua){const yc=this.Qrc(Xb,Ua,0);Xb in D?this.Qrc(Xb,D,0)!==yc&&this.HTd(Xb,!0,yc):this.HTd(Xb,!0,yc)}else Xb in D&&this.HTd(Xb,!1,this.Qrc(Xb,D,0))}).catch(Ua=>{Y.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",
!1,!0,null);z.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ua))})}HTd(D,ma,Ua){z.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",D,ma,Ua);ma=new da(D,ma,Ua);Ua=this.QCa.ka(D);for(const Xb of Ua)try{Xb.value(ma)}catch(yc){z.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
D,Xb.key,yc.message))}}hh(D,ma){if(this.Pya){const Ua=this.cze.contains(D);let Xb=!0,yc="",Tc=!1;return this.RCa.then(Sc=>{D in Sc?(Sc=Sc[D],yc=Xa[Sc.FeatureState],Xb=1!==Sc.FeatureState):Xb=!Ua;this.BQf(D,Ua,yc,Tc,ma,Xb);return Xb},()=>{Tc=!0;Ua&&(Xb=ma);this.BQf(D,Ua,yc,Tc,ma,Xb);return Xb})}return this.kKa}BQf(D,ma,Ua,Xb,yc,Tc){z.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",D,ma,
Xb,Ua,yc,Tc)}bWi(D,ma){if(this.Dac)return this.hh(D,ma);if(this.Pya){if(this.cze.contains(D))return this.RCa.then(Ua=>D in Ua,()=>ma);z.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",D)}return this.kKa}GCg(){if(void 0!==this.Qya&&null!==this.Qya){const D=this.Qya.gg;this.Qya.stop();return D}return null}static Oqc(D){try{if(za.a.esk){const ma=D.Ta("UserDataSignature").split(".");if(1<ma.length){const Ua=
window.self.atob(ma[1]),Xb=JSON.parse(Ua).LocalStorageKey;if(void 0!==Xb&&null!==Xb&&0<Xb.length)return Xb}}}catch(ma){z.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",ma.toString())}return null}}Object(w.a)(Fa,"ApplicationFeatureHelper",null,[191]);var La=a(200);class xa{constructor(D,ma){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=D.PolicySettings;D=new Date;D.setMinutes(D.getMinutes()+ma);this.ExpirationTime=D.getTime()}}Object(w.a)(xa,"CloudPolicySettingsCacheData",
null,[]);var db=a(855),bb=a(486),kb=a(271);class Rb{static KAg(){return P.AFrameworkApplication.fa.la("SideCarIsEnabled")?Rb.jLc&&Rb.LHd?new Promise(D=>{D(!0)}):new Promise((D,ma)=>{Rb.jLc=kb.a.create(P.AFrameworkApplication.fa.Ta("SideCarUrl"));bb.a.oqa(Rb.jLc);Rb.jLc.pga((Ua,Xb)=>{(Rb.LHd=Xb.succeeded)?D(Xb.succeeded):ma(Xb.succeeded)})}):new Promise(D=>{D(!1)})}}Rb.LHd=!1;Rb.jLc=null;Object(w.a)(Rb,"SideCarLoader",null,[]);class zb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(w.a)(zb,"CloudPolicySettingsData",null,[]);class nc{constructor(D,ma){this.DXc=0;this.$gc=null;this.KCj=Ua=>{let Xb=null;({ev:Xb}=Ba.d(Ua));Ua=!!Xb;z.ULS.sendTraceTag(50622687,3004,Ua?50:10,"ParseCloudPolicySettingsResponse: Success={0}",Ua);return Xb};this.V_d=Ua=>{try{if(void 0!==Ua&&null!==Ua&&"CheckIn-Interval"in Ua){const Xb=parseInt(Ua["CheckIn-Interval"]);void 0!==Xb&&null!==Xb&&0<Xb&&(this.DXc=Xb)}}catch(Xb){z.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
Xb)}};this.v9=new Q(D,ma);this.Fa=D;ma=D.Ta("HostAuthType");this.rNa=D.la("OcpsIsEnabled")&&D.la("IsO365CommercialHost")&&!(void 0===ma||null===ma)&&"aad"===ma.toLowerCase();this.gBe=Ba.b(D.Ta("OcpsDefaultSettings")||"{}");this.qvb=this.Oqc();ma=this.Fa.Zr("ServicesControlsMicrosoftControllerServicesList")?this.Fa.Pw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.yYc=new S.a;for(let Ua=0;Ua<ma.length;Ua++)this.yYc.add(ma[Ua]);this.rNa&&!D.la("IsAnonymousUser")&&D.la("SideCarIsEnabled")?
this.$gc=this.Ezk():this.$gc=this.Wwa(this.rNa,this.KCj);this.$gc.then(()=>null).catch(Ua=>{Ua=Object(R.a)(O,Ua);z.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Ua?Ua.httpStatusCode.toString():"Unknown")})}sP(D,ma,Ua){ma=void 0===ma?!0:ma;Ua=void 0===Ua?!0:Ua;if(!this.rNa){const Sc=this;return new Promise(Gd=>{Gd(Sc.WIb(D))})}const Xb=this,yc=this,Tc=this.$gc.then(Sc=>{try{let Gd=null;Sc.PolicySettings&&"unknown"in Sc.PolicySettings&&(Gd=Sc.PolicySettings.unknown);
if(Gd){if(D in Gd&&void 0!==Gd[D]&&null!==Gd[D])return new Promise(ve=>{ve("0"!==Gd[D])});const De=D.toLowerCase();if(De in Gd&&void 0!==Gd[De]&&null!==Gd[De])return new Promise(ve=>{ve("0"!==Gd[De])});if(Ua)return z.ULS.sendTraceTag(51512667,3004,50,"Policy"+D+" not found, using default"),new Promise(ve=>{ve(Xb.WIb(D))});z.ULS.sendTraceTag(508395746,3004,50,"Policy"+D+" not found, returning PolicyNotConfigured error");return new Promise((ve,Xe)=>{Xe("PolicyNotConfigured")})}return new Promise(De=>
{De(Xb.WIb(D))})}catch(Gd){return z.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+D+" policy value. Error Message: {0}",Gd.message),Xb.handleError(Gd.toString(),ma,Xb.WIb(D))}},Sc=>yc.handleError(Sc,ma,yc.WIb(D)));Tc.then(Sc=>{z.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",D,Sc);return null});return Tc}isFeatureEnabled(D,ma){return this.dWi(D,void 0===ma?!0:ma)}dWi(D,ma){ma=void 0===ma?!0:ma;let Ua=new Promise(yc=>{yc(!0)}),Xb=
"";"mso_sendASmile"===D?Xb="Enabled":"Survey"===D||"FloodgateSurvey"===D?Xb="SurveyEnabled":this.yYc.contains(D)&&(Xb="ControllerConnectedServicesEnabled");""!==Xb&&(Ua=this.sP(Xb,ma));Ua.then(yc=>{z.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",D,yc,Xb);return null});return Ua}handleError(D,ma,Ua){return ma?new Promise(Xb=>{Xb(Ua)}):new Promise((Xb,yc)=>{yc(D)})}Wwa(D,ma){if(!D)return Promise.resolve(new zb);let Ua=
!1,Xb=null;if(D=ba.a.fu())D.set("useCommonDomain",this.Fa.la("SuiteOriginForAFHSIsEnabled").toString()),D.set("useRace",this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString());Y.Health.instance.recordKpiUsage("GetCloudPolicySettings",T.b.SuccessBased,"jpittsdirects",D);let yc=this.dld("GetCloudPolicySettings");return(new Promise((Tc,Sc)=>{if(void 0!==this.qvb&&null!==this.qvb&&0<this.qvb.length){const Gd=this.ozk();if(void 0!==Gd&&null!==Gd){Ua=
!0;Tc(Gd);return}}(this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.v9.hS(this.fK("/afhs/CloudPolicySettings.ashx",!0),ma,1,null,this.V_d,["CheckIn-Interval"],this.Fa.Ng("CloudPolicySettingsRequestQueueTimeout",15E3),this.Fa.Ng("CloudPolicySettingsRequestSentTimeout",3E4)),this.v9.hS(this.fK("/afhs/CloudPolicySettings.ashx",!1),ma,1,null,this.V_d,["CheckIn-Interval"],this.Fa.Ng("CloudPolicySettingsRequestQueueTimeout",15E3),this.Fa.Ng("CloudPolicySettingsRequestSentTimeout",
3E4))]):this.v9.hS(this.fK("/afhs/CloudPolicySettings.ashx",this.Fa.la("SuiteOriginForAFHSIsEnabled")),ma,1,null,this.V_d,["CheckIn-Interval"],this.Fa.Ng("CloudPolicySettingsRequestQueueTimeout",15E3),this.Fa.Ng("CloudPolicySettingsRequestSentTimeout",3E4))).then(Gd=>{z.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.cAk(Gd);Tc(Gd);return Gd},Gd=>{Sc(Gd);return null})})).then(Tc=>{({stopwatch:yc,returnValue:Xb}=this.vPc(yc));var Sc=ba.a.fu();Sc&&(Sc.set("FromCache",
Ua.toString()),Sc.set("useCommonDomain",this.Fa.la("SuiteOriginForAFHSIsEnabled").toString()),Sc.set("useRace",this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString()));Sc=Object.assign({},{durationMs:Xb,extendedProperties:Sc});Y.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Sc);return Tc})}Ezk(){return Rb.KAg().then(()=>{z.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}fK(D,ma){return String.format("{0}{1}",ma?this.Fa.Ta("SuiteOrigin"):this.Fa.Ta("WebServiceBase"),D)}WIb(D){return D in this.gBe?"0"!==this.gBe[D]:!0}ozk(){try{const D=db.a.instance.getItem(this.qvb);if(void 0===D||null===D)return z.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;z.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
D);const ma=JSON.parse(D);if(void 0===ma||null===ma)return z.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===ma.ExpirationTime||null===ma.ExpirationTime)return z.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(ma.ExpirationTime)).getTime()<Date.now())return z.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const Ua=new zb;Ua.PolicySettings=ma.PolicySettings;Ua.ControllerConnectedServicesFeatureNames=new La.a;this.Fa.Zr("ServicesControlsMicrosoftControllerServicesList")&&this.Fa.Pw("ServicesControlsMicrosoftControllerServicesList");for(const Xb of this.yYc)Ua.ControllerConnectedServicesFeatureNames.add(Xb);z.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ua}catch(D){return z.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
D.toString()),null}}cAk(D){try{if(void 0===D||null===D||void 0===D.PolicySettings||null===D.PolicySettings)z.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.DXc)z.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const ma=new xa(D,this.DXc),Ua=JSON.stringify(ma);z.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ua);db.a.instance.setItem(this.qvb,
Ua);z.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ma){z.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ma.toString())}}Oqc(){const D=Fa.Oqc(this.Fa);return D&&0<D.length?"OCPS"+D:null}dld(D){const ma=oa.a.instance.pj("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==ma&&null!==ma?ma.Sf("WebServiceCall",D):null}vPc(D){if(void 0!==D&&null!==D){const ma=D.gg;D.stop();return{returnValue:ma,
stopwatch:null}}return{returnValue:null,stopwatch:D}}}Object(w.a)(nc,"CloudPolicySettingsHelper",null,[188]);class Zb{constructor(){this.W8e=this.VMg=this.Sy=0;this.X8e=this.WMg=this.cRa="";this.o8c=this.qma=2}clone(){const D=new Zb;D.Sy=this.Sy;D.VMg=this.VMg;D.W8e=this.W8e;D.cRa=this.cRa;D.WMg=this.WMg;D.X8e=this.X8e;D.qma=this.qma;D.o8c=this.src;return D}get src(){return this.o8c}serialize(D){D=void 0===D?null:D;const ma={};if(!D||D.contains(Zb.gYa))ma[Zb.gYa]=this.Sy;if(!D||D.contains(Zb.ZRb))ma[Zb.ZRb]=
this.cRa;if(!D||D.contains(Zb.$Rb))ma[Zb.$Rb]=this.qma;return JSON.stringify(ma)}static create(D,ma){ma=void 0===ma?null:ma;const Ua=new Zb;Ua.o8c=D;void 0!==ma&&null!==ma&&(Zb.gYa in ma&&(Ua.Sy=ma[Zb.gYa]),Zb.ZRb in ma&&(Ua.cRa=ma[Zb.ZRb]),Zb.$Rb in ma&&(Ua.qma=ma[Zb.$Rb]));return Ua}static deserialize(D,ma){try{const Ua=JSON.parse(D);if(void 0!==Ua&&null!==Ua)return Zb.create(ma,Ua);z.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",D);throw Error.argument("settingsData");
}catch(Ua){throw z.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ua.toString()),Ua;}}}Zb.gYa="CCS";Zb.ZRb="CCSTime";Zb.$Rb="OfficePrivacyRoamedNoticeShown";Object(w.a)(Zb,"UserPrivacySettings",null,[]);var Sa=a(163);class Na{constructor(D,ma){if(void 0===D||null===D||void 0===ma||null===ma)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Fa=D;this.xk=ma;this.C7c=this.Jh=null}fK(D){var ma=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Fa.appSettings.RoamingServiceHandlerWebServiceBase||"");ma=new Sys.StringBuilder(ma);ma.append(D);ma.append("&");ma.append(P.AFrameworkApplication.ml);return ma.toString()}executeRequest(D,ma,Ua,Xb){return this.xk.O7a(D,ma,void 0===Xb?null:Xb,null,Ua,"33",!1,null,6E4)}saveSettings(D){return new Promise((ma,Ua)=>{try{if(void 0===this.Jh||null===this.Jh||void 0===D||null===D)z.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ua("Can't determine setting changes to save");
else{var Xb=this.Jh.Sy!==D.Sy;if(2===this.Jh.src&&Xb)this.A3j(D),ma(!0);else{var yc=this.G7j(D);if(void 0===yc||null===yc||!yc.length)z.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ua("No changes to save");else if(1===this.Jh.src)ma(this.qIg(yc));else if(0===this.Jh.src){z.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",yc);const Tc=this.executeRequest(this.fK("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
yc);Tc.continueWith(()=>{if(Tc.Uk||Tc.vj)z.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),ma(!1);else{var Sc=Tc.result;void 0!==Sc.ll&&null!==Sc.ll&&void 0!==Sc.ll.data&&null!==Sc.ll.data&&Sc.ll.data.httpStatus===L.a.tL?(z.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),ma(!0)):(z.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),ma(!1))}})}}}}catch(Tc){z.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",Tc.toString()),ma(!1)}})}G7j(D){if(void 0===this.Jh||null===this.Jh||void 0===D||null===D)throw Error.invalidOperation("User Privacy settings have not been initialized");const ma=new La.a;0===D.src?(this.Jh.Sy!==D.Sy&&(ma.add(Zb.gYa),ma.add(Zb.ZRb)),this.Jh.qma!==D.qma&&ma.add(Zb.$Rb)):1===D.src&&this.Jh.Sy!==D.Sy&&ma.add(Zb.gYa);return ma.count?D.serialize(ma):(z.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.C7c){const D=this;this.C7c=new Promise(ma=>{try{D.Jh?ma(D.Jh.clone()):D.yzk().then(Ua=>{D.Jh=Ua;ma(D.Jh.clone());return null},()=>{D.wzk().then(Ua=>{D.Jh=Ua;ma(D.Jh.clone());return null},()=>{D.xzk().then(Ua=>{D.Jh=Ua;ma(D.Jh.clone());return null},()=>{z.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");D.Jh=new Zb;ma(D.Jh.clone());return null});return null});return null})}catch(Ua){z.ULS.sendTraceTag(50860932,3004,
10,"UserPrivacySettings GetSettings: Exception = {0}",Ua.toString()),D.Jh=new Zb,ma(D.Jh.clone())}})}return this.C7c}yzk(){return new Promise((D,ma)=>{try{const Xb=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Fa.la("PrivacyDialogShouldCheckRoaming")||Xb){var Ua=this.executeRequest(this.fK("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ua.continueWith(()=>{try{if(Ua.Uk||Ua.vj)z.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{const yc=Ua.result;if(yc&&yc.ll&&yc.ll.data)if(yc.ll.data.httpStatus!==L.a.tL)z.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",yc.ll.data.httpStatus);else{if(yc.ll.data.responseData){D(Na.parse(yc.ll.data.responseData,0));z.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",yc.ll.data.responseData);return}z.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else z.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");ma("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(yc){z.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",yc.toString()),ma("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else z.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),ma("Roaming should not be used")}catch(Xb){z.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Xb.toString()),ma("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}wzk(){return new Promise((D,ma)=>{try{const Ua=Sa.a.get("WacUPToggleState");let Xb=null;void 0!==Ua&&null!==Ua&&0<Ua.length&&(Xb=decodeURIComponent(Ua));if(void 0!==Xb&&null!==Xb&&0<Xb.length){const yc=Na.parse(Xb,1);z.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",yc.toString());D(yc)}else{const yc=Zb.create(1),
Tc=new La.a;Tc.add(Zb.gYa);const Sc=yc.serialize(Tc);this.qIg(Sc)?(z.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Sc),D(yc)):(z.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Sc),ma("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ua){z.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Ua.toString()),ma("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}xzk(){return new Promise(D=>{try{var ma=-1!==window.location.href.indexOf("&wdccsoff=1");const Ua=Zb.create(2);ma?(Ua.Sy=2,P.AFrameworkApplication.v7e(),z.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ua.toString())):(Ua.Sy=1,z.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",Ua.toString()));D(Ua)}catch(Ua){z.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ua.toString()),ma=Zb.create(2),ma.Sy=1,D(ma)}})}A3j(D){z.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===D.Sy?P.AFrameworkApplication.v7e():P.AFrameworkApplication.UWh();z.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",D)}qIg(D){try{z.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",D);const ma=
this.Fa.Ta("PrivacyCookieDomain")||"";if(!ma||!ma.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");z.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",D);return Sa.a.eae("WacUPToggleState",D,Sa.a.U6,"/",ma)}catch(ma){return z.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",ma.toString()),!1}}isFeatureEnabled(D){return this.getSettings().then(ma=>{const Ua=this.Fa.Zr("ServicesControlsMicrosoftControllerServicesList")?
this.Fa.Pw("ServicesControlsMicrosoftControllerServicesList"):[],Xb=new S.a;for(let yc=0;yc<Ua.length;yc++)Xb.add(Ua[yc]);return Xb.contains(D)?2!==ma.Sy:!0},()=>{z.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",D);return!0})}static parse(D,ma){try{return z.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",D,ma),Zb.deserialize(D,ma)}catch(Ua){throw z.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ua.toString()),
Ua;}}}Object(w.a)(Na,"UserPrivacySettingsHelper",null,[189]);var Ea=a(262);class Aa{constructor(){this.$b=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}dl(D){this.$b=D;this.$b.register(188,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").If().Rf(()=>new nc(P.AFrameworkApplication.fa,P.AFrameworkApplication.lg));this.$b.register(189,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").If().Rf(()=>new Na(P.AFrameworkApplication.fa,
P.AFrameworkApplication.lg));this.$b.register(190,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").If().Rf(()=>new W(P.AFrameworkApplication.fa,P.AFrameworkApplication.lg));this.$b.register(191,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").If().Rf(()=>new Fa(P.AFrameworkApplication.fa,P.AFrameworkApplication.lg,this.$b.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.$b.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
P.AFrameworkApplication.Oe))}init(){P.AFrameworkApplication.fa.Xw(()=>{const D=this.$b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");P.AFrameworkApplication.fa.la("LicensingIsEnabled")&&(D.isFeatureEnabled("LicensingTestFeature",!1).then(ma=>{z.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",ma,P.AFrameworkApplication.fa.Ta("IsAnonymousUser"));return null}),D.getFeatureTier("LicensingTestFeature",
0).then(ma=>{z.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",ma,P.AFrameworkApplication.fa.Ta("IsAnonymousUser"));return null}));this.$b.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.Itk()})}dispose(){}Itk(){try{P.AFrameworkApplication.fa.la("SideCarIsEnabled")&&Rb.KAg().then(D=>{z.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",
D);return D})}catch(D){}}static main(){Ea.a.instance.Ul(new Aa)}}Object(w.a)(Aa,"ApplicationFeatureHelperPackage",null,[4,5]);var Ka=a(2),nb=a(64),Qb=a(299),jb=a(32),qb=a(343),ab=a(342),xb=a(23),Tb=a(1),Cc=a(40),lb=a(56);const Ya=D=>{D?(D.isAsyncCopy=!1,D.isSelectionAllowed=!1,D.isFromCache=!1,D.plainTextPayloadSize=0,D.shadowWorkbookPayloadSize=0,D.htmlPayloadSize=0,D.htmlSizeExceedsLimit=!1,D.clientSideCopyTime=0,D.encounteredDeploymentErrors=!1,D.shadowWorkbookSizeExceedsLimit=!1,D.originalSourceRangesCountExceedsLimit=
!1,D.copyTotalSizeExceedsLimit=!1):z.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.")},Hb=(D,ma,Ua,Xb,yc)=>{const Tc=D.Stopwatch,Sc={};Sc.a=yc;Sc.e=Tc.id;Sc.c="RearrangeRowColumn";Sc.b="mouse";Sc.d=D.OperationId.toString();Sc.f=Ua.toString();Sc.g=Xb.toString();Sc.h=ma.toString();Sc.i=D.DragDropIsShiftKeyDown;Sc.j=!0;Sc.o=Tc.gg;Sc.q=!1;Sc.r=D.CopyPasteTargetType.toString();Sc.s=D.EncounteredDeploymentErrors;return Sc};class Lb{constructor(D,ma){this.Ndi=
()=>{const Ua={};Ua.SourceItem=this.toString();return Ua};this.sessionStateId=D;this.sessionId=ma;this.toJSON=this.Ndi}aId(D){return D?this.sessionStateId===D.sessionStateId&&this.sessionId===D.sessionId:!1}isFromCurrentSession(D){return this.sessionId===D.xa.UserSessionId}}Object(w.a)(Lb,"SourceItem",null,[]);class qc extends Lb{constructor(D,ma,Ua,Xb,yc){super(Ua,Xb);this.activeFloatingObjectControlId=D;this.sheetName=ma;this.type=yc}isEqual(D){return D&&Object.getType(D)===qc?this.aId(D)&&this.activeFloatingObjectControlId===
D.activeFloatingObjectControlId&&this.sheetName===D.sheetName:!1}toString(){return this.type.toString()}}Object(w.a)(qc,"ArtSourceItem",Lb,[]);var mc;(function(D){D[D.valid=0]="valid";D[D.notPairwiseDisjoint=1]="notPairwiseDisjoint";D[D.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";D[D.notValidForm=3]="notValidForm";D[D.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(mc||(mc={}));Object(w.b)("CopySourceValidationOptions",mc);class Ta extends Lb{constructor(D,
ma){super(D,ma)}isEqual(D){return this.aId(D)}}Object(w.a)(Ta,"NonGridSourceItem",Lb,[]);var Va=a(45);class Db extends Lb{constructor(D,ma,Ua,Xb,yc){super(Xb,yc);z.ULS.shipAssertTag(537167645,0,!!ma&&0<ma.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=D;this.ranges=ma;this.sheetName=Ua}isEqual(D){return D&&Object.getType(D)===Db?this.aId(D)&&Va.V(this.ranges,D.ranges)&&this.sheetName===D.sheetName:!1}toString(){return Va.i(this.ranges,",",this.$,!1)}}Object(w.a)(Db,"RangeSourceItem",
Lb,[]);const Ca=D=>!!D&&Object.getType(D)===Db,cb=D=>!!D&&Object.getType(D)===Ta;class hb{}hb.FHk="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(w.a)(hb,"ExpectedErrorNames",null,[]);class ya{}ya.plainText="text/plain";ya.html="text/html";ya.png="image/png";ya.shadowWorkbook="data/shadow-workbook";ya.vYi="metadata/is-last-copy-was-external";ya.XTi="metadata/is-last-copy-was-external-XLO-source";ya.txh="metadata/chrome-extension-id";ya.Lkd="copyId";ya.Wgh="metadata/additional-signature-data-attributes";
Object(w.a)(ya,"ClipboardDataFormat",null,[]);const Pa=D=>D.clipboardItems&&(D=D.clipboardItems.getItem(ya.vYi))&&"1"===D?!0:!1,wb=D=>Pa(D)&&!(void 0===D.clipboardItems||null===D.clipboardItems)&&!!D.clipboardItems.getItem(ya.png)&&!D.clipboardItems.getItem(ya.plainText),Ib=D=>D.clipboardItems&&(D=D.clipboardItems.getItem(ya.XTi))&&"1"===D?!0:!1,pb=D=>D&&(D=D.getCachedMetadata(),null===D||void 0===D?0:D.lastCopy)?D.lastCopy:null;var xc=a(53),ua=a(19),U=a(79);class na{constructor(D,ma,Ua,Xb,yc){this.$=
D;this.zoom=yc;this.originalDestinations=ma;this.inc=Ua;this.$Ug=Xb;this.k4g=this.originalDestinations;this.WYg=this.inc;this.D1g="PasteRecoveryUI"}get zoomManager(){return Tb.EwaSettings.Pi()?this.zoom.zoomManager:U.a(this.$)}get Vgh(){return this.$Ug}get tOf(){return this.D1g}get iPj(){return this.k4g}get Zgf(){return this.WYg}zDa(){return na.xDj}Rli(){return this.inc&&1===this.inc.length?this.Sli(this.inc[0]):null}nxd(){return"PasteRecoveryUI-Floatie"}Sli(D){var ma=ua.h(this.$);const Ua=ma.Be.El(D);
var Xb=ma.Oj(D,Ua);ma=ma.rtl;if(!Xb)return null;D=ua.h(this.$).wi(Ua);const yc=D.ap;if(!yc.Zf(Xb))return null;Xb=yc.Bh(Xb);const Tc=Xb.topLeft.y;var Sc=Xb.bottomRight.y;const Gd=ma?Xb.bottomRight.x:Xb.topLeft.x;Xb=ma?Xb.topLeft.x:Xb.bottomRight.x;var De=new xc.a(Xb+(ma?-81:81),Sc+38+6);if(yc.Gpa(De))return this.Hdb(D,yc,Ua,Xb,Sc,ma?12:-3,66);De=new xc.a(Xb+(ma?-81:81),Sc);if(yc.Gpa(De))return this.Hdb(D,yc,Ua,Xb,Sc,ma?20:3,22);De=new xc.a(Xb,Sc+38+6);if(yc.Gpa(De))return this.Hdb(D,yc,Ua,Xb,Sc,-81+
(ma?18:0),66);Xb=new xc.a(Gd+(ma?81:-81),Sc);if(yc.Gpa(Xb))return this.Hdb(D,yc,Ua,Gd,Sc,-81+(ma?12:-6),22);Sc=new xc.a(Gd,Tc-38-6);return yc.Gpa(Sc)?this.Hdb(D,yc,Ua,Gd,Tc,ma?15:0,16):this.Hdb(D,yc,Ua,ma?yc.topLeft.x:yc.bottomRight.x,yc.bottomRight.y,-81+(ma?15:-6),22)}Hdb(D,ma,Ua,Xb,yc,Tc,Sc){var Gd=ua.h(this.$);const De=Gd.rtl;D=Sys.UI.DomElement.getLocation(D.domElement);Xb=new Sys.UI.Point(Xb+(De?0:D.x)-ma.topLeft.x,yc+D.y-ma.topLeft.y);De&&(Gd=Gd.view.visibleArea,Xb.x=Gd.bottomRight.x-Gd.topLeft.x-
Xb.x,2===Ua||4===Ua)&&(Xb.x+=ma.bottomRight.x);Xb=this.zoomManager.ura(Xb);return new Sys.UI.Point(Xb.x+Tc,Xb.y+Sc)}}na.xDj=["PasteRecoveryUI"];Object(w.a)(na,"PasteRecoveryUI",null,[875]);var ob=a(65),bc=a(372);class oc{}oc.p9g="ActiveSelection";oc.shadowWorkbook="ShadowWorkbook";oc.HRg="GVML";oc.plainText="PlainText";oc.html="Html";oc.Dnh="Bitmap";Object(w.a)(oc,"PayloadType",null,[]);class Yb{}Yb.Bnk="Slice6";Object(w.a)(Yb,"SliceName",null,[]);class Fc{}Fc.qij="NotCalled";Fc.success="Success";
Fc.failed="Failed";Object(w.a)(Fc,"SucceededPopulatingSystemClipboardOptions",null,[]);var ld=a(297);const qd=(D,ma)=>D?ma&&ma.xa?D.sessionId!==ma.xa.UserSessionId:(z.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(z.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),fe=D=>{switch(D){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},ge=D=>{if(!D)return"null";const ma=[];for(const Ua of D.get())ma.push(`${Ua.clipboardDataFormat}(${Ua.data.length})`);
ma.sort();return ma.join(",")};var Wd;(function(D){D[D.valid=0]="valid";D[D.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";D[D.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";D[D.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";D[D.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";D[D.multipleDestinationsAreNotMultiplyOfSourceRange=
5]="multipleDestinationsAreNotMultiplyOfSourceRange";D[D.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";D[D.copySourceNotValid=7]="copySourceNotValid";D[D.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";D[D.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";D[D.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";D[D.unknown=100]="unknown"})(Wd||(Wd={}));Object(w.b)("PasteValidationOptions",Wd);var Zd=
a(68),ke=a(157),ne=a(41),se=a(336),Cb=a(33),ib=a(285),ac=a(12),Lc=a(22),ad=a(13),te=a(141),Ma=a(140),V=a(599),fa=a(111),ub=a(94);class rb extends Sys.EventArgs{constructor(D,ma,Ua){super();this.command=D;this.destinationRange=ma;this.sourceRange=Ua}}Object(w.a)(rb,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var hd=a(134),Eb=a(146),kc=a(8);class zc extends na{constructor(D,ma,Ua,Xb,yc){super(D,ma,Ua,Xb,yc);this.y6i="DragRecoveryUI"}get tOf(){return this.y6i}zDa(){return zc.sUh}nxd(){return"DragRecoveryUI-Floatie"}}
zc.sUh=["DragRecoveryUI"];Object(w.a)(zc,"DragFillRecoveryUI",na,[]);var Nc=a(680),Fd=a(300);class Xd extends Fd.a{constructor(D,ma,Ua){super(D);this.Ye=0;this.initializeAndShow(ad.a.instance.ia(1060),ma,Ua)}get Cf(){return"CopyPasteShortcutReactDialog"}}Object(w.a)(Xd,"CopyPasteShortcutReactDialog",Fd.a,[]);var ie=a(396);class Ee{constructor(D){this.BF=null;this.FQa=ma=>{this.BF(1===ma?Ee.HCb:Nc.a[ma],!1);Ee.jda=!1};this.$=D}showDialog(D,ma,Ua,Xb){this.BF=Xb;Ee.gNb=za.a.isMac||za.a.gk;this.BF||(this.BF=
()=>{});Ee.jda?Xb(Ee.GCb,!1):(Ee.jda=!0,ma={},D?(ma.forwardElementText=ad.a.instance.ia(1061),ma.cutText=Ee.gNb?ad.a.instance.ia(1050):ad.a.instance.ia(1062),ma.copyText=Ee.gNb?ad.a.instance.ia(1051):ad.a.instance.ia(1063),ma.pasteText=Ee.gNb?ad.a.instance.ia(1052):ad.a.instance.ia(1064),ma.pasteTextOnly=Ee.gNb?ad.a.instance.ia(1055):ad.a.instance.ia(1065)):(ma.forwardElementText=ad.a.instance.ia(1066),ma.cutText=ad.a.instance.ia(1067)),new Xd(this.$,this.FQa,{[ie.a.fv]:Ee.id,["bodyControls"]:ma}))}}
Ee.jda=!1;Ee.gNb=!1;Ee.GCb="notOpened";Ee.HCb="ok";Ee.id="CopyPasteShortcutDialog";Object(w.a)(Ee,"CopyPasteShortcutDialog",null,[740]);var He=a(55);class gd extends Fd.a{constructor(D,ma,Ua){super(D);this.Ye=0;this.uf(1,ad.a.instance.ia(1054));this.m2(1);this.initializeAndShow(ad.a.instance.ia(1046),ma,Ua)}get Cf(){return"CopyPasteInstallReactDialog"}}Object(w.a)(gd,"CopyPasteInstallReactDialog",Fd.a,[]);class Bd{constructor(D){this.BF=null;this.FQa=ma=>{1===ma?(z.ULS.sendTraceTag(508359137,0,50,
"User clicked the install button"),this.ZFh(),this.gGj(),this.BF(Bd.HCb,!0)):(z.ULS.sendTraceTag(508359136,0,50,"User clicked the cancel button"),this.BF(Nc.a[ma],!1));Bd.jda=!1};this.$=D}showDialog(D,ma,Ua,Xb){this.BF=Xb=void 0===Xb?()=>{}:Xb;ma=za.a.isMac||za.a.gk;Bd.jda?Xb(Bd.GCb,!1):(Bd.jda=!0,Xb={},D&&(Xb.extensionStartText=Xb.extensionStartText=za.a.sxc?ad.a.instance.ia(1048):ad.a.instance.ia(1047),Xb.extensionLink=null,Xb.extensionEndText=null,Xb.shortcutsMessageText=ad.a.instance.ia(1049),
Xb.cutText=ma?ad.a.instance.ia(1050):ad.a.instance.ia(1062),Xb.copyText=ma?ad.a.instance.ia(1051):ad.a.instance.ia(1063),Xb.pasteText=ma?ad.a.instance.ia(1052):ad.a.instance.ia(1064),Xb.pasteTextOnly=ma?ad.a.instance.ia(1055):ad.a.instance.ia(1065)),new gd(this.$,this.FQa,{[ie.a.fv]:Bd.id,["bodyControls"]:Xb}))}ZFh(){void Eb.a.resolve(kc.s,{Aa:0}).then(D=>{D.Uj(68,null)})}gGj(){const D=this.$.xa;He.a.Ph(`${D.ChromeClipboardAccessExtensionLink}${za.a.sxc?D.ChromeClipboardAccessExtensionId:D.OfficeOnlineChromeExtensionId}`,
"_blank",void 0,"ChromeCCPInstallDialog")}}Bd.jda=!1;Bd.GCb="notOpened";Bd.HCb="ok";Bd.id="CopyPasteInstallDialog";Object(w.a)(Bd,"CopyPasteInstallDialog",null,[740]);class ue extends Sys.EventArgs{constructor(D,ma){super();this.$Ph=D;this.Jm=ma}}Object(w.a)(ue,"PasteSucceededEventArgs",Sys.EventArgs,[]);var ye=a(155);class Ue extends Fd.a{constructor(D,ma,Ua){super(D);this.Ye=0;this.uf(1,CommonUIStrings.l_DialogOk);this.m2(1);this.initializeAndShow(ad.a.instance.ia(2390),ma,Ua)}get Cf(){return"CopyPasteNoClipboardAccessReactDialog"}}
Object(w.a)(Ue,"CopyPasteNoClipboardAccessReactDialog",Fd.a,[]);class Sb{constructor(D){this.BF=null;this.FQa=ma=>{1===ma?this.BF(Sb.HCb,!0):this.BF(Nc.a[ma],!1);Sb.jda=!1;this.Mkd&&URL.revokeObjectURL(this.Mkd)};this.$=D}showDialog(D,ma,Ua,Xb){this.BF=Xb=void 0===Xb?()=>{}:Xb;ma=za.a.isMac||za.a.gk;Sb.jda?Xb(Sb.GCb,!1):(Sb.jda=!0,Xb={},D&&(Xb.startText=ad.a.instance.ia(2391),Xb.endText=ad.a.instance.ia(2392),Xb.cutText=CommonUIStrings.l_CutString,Xb.copyText=CommonUIStrings.l_CopyString,Xb.pasteText=
CommonUIStrings.l_PasteString,Xb.cutShortcutText=ma?CommonUIStrings.l_CutShortcut_Mac:CommonUIStrings.l_CutShortcut,Xb.copyShortcutText=ma?CommonUIStrings.l_CopyShortcut_Mac:CommonUIStrings.l_CopyShortcut,Xb.pasteShortcutText=ma?CommonUIStrings.l_PasteShortcut_Mac:CommonUIStrings.l_PasteShortcut,Xb.imageAltText=CommonUIStrings.l_NoClipboardAccessDialogImageAltText,this.Mkd=URL.createObjectURL(new Blob(['\n<svg width="440" height="114" viewBox="0 0 457 114" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_dd_2_4645)">\n<rect x="15" y="8" width="427" height="85" rx="8" fill="#F3F3F3"/>\n<g clip-path="url(#clip0_2_4645)">\n<rect x="15" y="8" width="427" height="40" fill="#CECECE"/>\n<mask id="mask0_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="15" y="40" width="427" height="12">\n<rect x="15" y="40" width="427" height="12" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask0_2_4645)">\n<g filter="url(#filter1_dd_2_4645)">\n<rect x="15" y="48" width="427" height="4" fill="#F3F3F3"/>\n</g>\n</g>\n<mask id="mask1_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="23" y="12" width="256" height="36">\n<rect x="23" y="12" width="256" height="36" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask1_2_4645)">\n<g filter="url(#filter2_dd_2_4645)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 24C31 19.5817 34.5817 16 39 16H263C267.418 16 271 19.5817 271 24V40C271 44.4183 274.582 48 279 48V52H271H31H23V48C27.4183 48 31 44.4183 31 40V24Z" fill="#F3F3F3"/>\n</g>\n</g>\n<g clip-path="url(#clip1_2_4645)">\n<path d="M251.089 28.2157L251.146 28.1464C251.32 27.9729 251.589 27.9536 251.784 28.0886L251.854 28.1464L255 31.293L258.146 28.1464C258.342 27.9512 258.658 27.9512 258.854 28.1464C259.049 28.3417 259.049 28.6583 258.854 28.8536L255.707 32L258.854 35.1464C259.027 35.32 259.046 35.5894 258.911 35.7843L258.854 35.8536C258.68 36.0271 258.411 36.0464 258.216 35.9114L258.146 35.8536L255 32.707L251.854 35.8536C251.658 36.0488 251.342 36.0488 251.146 35.8536C250.951 35.6583 250.951 35.3417 251.146 35.1464L254.293 32L251.146 28.8536C250.973 28.68 250.954 28.4106 251.089 28.2157L251.146 28.1464L251.089 28.2157Z" fill="#1A1A1A"/>\n</g>\n<g clip-path="url(#clip2_2_4645)">\n<path d="M55 28.6641V32L52.3359 33L49.6641 32L43 28.6641V25.3359C43 25.1484 43.0651 24.9896 43.1953 24.8594C43.3255 24.7292 43.4818 24.6641 43.6641 24.6641H49.6641L55 28.6641Z" fill="#21A366"/>\n<path d="M55 25.3359V28.6641H49.6641V24.6641H54.3359C54.4245 24.6641 54.5104 24.6823 54.5938 24.7188C54.6719 24.7552 54.7422 24.8047 54.8047 24.8672C54.862 24.9245 54.9089 24.9948 54.9453 25.0781C54.9818 25.1562 55 25.2422 55 25.3359Z" fill="#33C481"/>\n<path d="M55 35.3359V38.6641C55 38.8516 54.9349 39.0104 54.8047 39.1406C54.6745 39.2708 54.5182 39.3359 54.3359 39.3359H43.6641C43.4818 39.3359 43.3255 39.2708 43.1953 39.1406C43.0651 39.0104 43 38.8516 43 38.6641V35.375V32H49.6641L55 35.3359Z" fill="#185C37"/>\n<path d="M49.6641 28.6797V32H43V28.6797H49.6641ZM55 35.3359H49.6641V32.0078H55V35.3359Z" fill="black" fill-opacity="0.5"/>\n<path d="M48.2188 28C48.4375 28 48.6224 28.0755 48.7734 28.2266C48.9245 28.3776 49 28.5625 49 28.7812V36.4297C49 36.5391 48.974 36.6484 48.9219 36.7578C48.8698 36.862 48.7995 36.9583 48.7109 37.0469C48.6224 37.1302 48.5234 37.2005 48.4141 37.2578C48.2995 37.3099 48.1849 37.3359 48.0703 37.3359H43V28H48.2188Z" fill="black" fill-opacity="0.498"/>\n<path d="M47.5547 36.6641H39.7812C39.5625 36.6641 39.3776 36.5911 39.2266 36.4453C39.0755 36.2943 39 36.1094 39 35.8906V28.1094C39 27.8906 39.0755 27.7083 39.2266 27.5625C39.3776 27.4115 39.5625 27.3359 39.7812 27.3359H47.5547C47.7734 27.3359 47.9583 27.4115 48.1094 27.5625C48.2604 27.7083 48.3359 27.8906 48.3359 28.1094V35.8906C48.3359 36.1094 48.2604 36.2943 48.1094 36.4453C47.9583 36.5911 47.7734 36.6641 47.5547 36.6641Z" fill="#107C41"/>\n<path d="M41.2812 34.6641L43.0078 31.9922L41.4297 29.3359H42.7031L43.5625 31.0312C43.6042 31.1146 43.638 31.1849 43.6641 31.2422C43.6849 31.2995 43.7057 31.349 43.7266 31.3906H43.7422C43.7682 31.3281 43.7969 31.2656 43.8281 31.2031C43.8542 31.1406 43.8854 31.0781 43.9219 31.0156L44.8438 29.3359H46.0078L44.3828 31.9766L46.0469 34.6641H44.8047L43.8125 32.7969C43.7656 32.7292 43.724 32.6458 43.6875 32.5469H43.6719C43.6615 32.5781 43.6484 32.6146 43.6328 32.6562C43.612 32.6927 43.5885 32.737 43.5625 32.7891L42.5312 34.6641H41.2812Z" fill="white"/>\n</g>\n<rect x="67" y="29" width="96" height="6" rx="3" fill="#B2AFAC"/>\n<path d="M289 24.5C289 24.2239 288.776 24 288.5 24C288.224 24 288 24.2239 288 24.5V31H281.5C281.224 31 281 31.2239 281 31.5C281 31.7761 281.224 32 281.5 32H288V38.5C288 38.7761 288.224 39 288.5 39C288.776 39 289 38.7761 289 38.5V32H295.5C295.776 32 296 31.7761 296 31.5C296 31.2239 295.776 31 295.5 31H289V24.5Z" fill="#1A1A1A"/>\n</g>\n<rect x="15" y="48" width="427" height="38" fill="#F3F3F3"/>\n<rect x="15" y="86" width="427" height="1" fill="#CCCCCC"/>\n<path d="M42.159 73.3666C42.3629 73.5528 42.6792 73.5384 42.8654 73.3345C43.0515 73.1305 43.0371 72.8143 42.8332 72.6281L36.6653 66.9974H50.4961C50.7722 66.9974 50.9961 66.7735 50.9961 66.4974C50.9961 66.2212 50.7722 65.9974 50.4961 65.9974H36.6682L42.8332 60.3693C43.0371 60.1831 43.0515 59.8668 42.8654 59.6629C42.6792 59.459 42.3629 59.4446 42.159 59.6307L35.2426 65.9448C35.1027 66.0725 35.0229 66.2401 35.0031 66.4132C34.9985 66.4406 34.9961 66.4687 34.9961 66.4974C34.9961 66.5242 34.9982 66.5506 35.0023 66.5763C35.0205 66.7522 35.1006 66.9229 35.2426 67.0526L42.159 73.3666Z" fill="#1A1A1A"/>\n<g opacity="0.3">\n<path d="M87.8371 59.6307C87.6332 59.4446 87.3169 59.459 87.1307 59.6629C86.9446 59.8668 86.959 60.1831 87.1629 60.3693L93.3307 66H79.5C79.2239 66 79 66.2239 79 66.5C79 66.7761 79.2239 67 79.5 67H93.3279L87.1629 72.6281C86.959 72.8143 86.9446 73.1305 87.1307 73.3345C87.3169 73.5384 87.6332 73.5528 87.8371 73.3666L94.7535 67.0526C94.8934 66.9248 94.9732 66.7573 94.993 66.5841C94.9976 66.5568 95 66.5287 95 66.5C95 66.4731 94.9979 66.4468 94.9938 66.421C94.9756 66.2451 94.8955 66.0745 94.7535 65.9448L87.8371 59.6307Z" fill="#1A1A1A"/>\n</g>\n<path d="M124.066 66.05C124.59 62.2198 128.121 59.5401 131.951 60.0648C133.894 60.3309 135.54 61.3695 136.623 62.8297L136.749 63H133.5C133.224 63 133 63.2239 133 63.5C133 63.7761 133.224 64 133.5 64H137.5C137.776 64 138 63.7761 138 63.5V59.5C138 59.2239 137.776 59 137.5 59C137.224 59 137 59.2239 137 59.5V61.7073C135.776 60.3185 134.065 59.3451 132.087 59.074C127.709 58.4744 123.675 61.5369 123.075 65.9143C122.475 70.2917 125.538 74.3264 129.915 74.926C134.293 75.5256 138.327 72.4631 138.927 68.0857C139.001 67.5445 139.019 67.0079 138.986 66.4821C138.968 66.2065 138.73 65.9974 138.455 66.015C138.179 66.0326 137.97 66.2703 137.988 66.5459C138.017 67.0055 138.001 67.4752 137.936 67.95C137.412 71.7802 133.881 74.4599 130.051 73.9353C126.221 73.4106 123.541 69.8802 124.066 66.05Z" fill="#1A1A1A"/>\n<g filter="url(#filter3_d_2_4645)">\n<rect x="159" y="52" width="275" height="30" rx="8" fill="#FBFBFB"/>\n</g>\n<rect x="171" y="55" width="27" height="24" rx="4" fill="#F3F2F1"/>\n<path d="M190.051 65.3663V73H178.527V65.3663H180.686V62.1832C180.686 61.7458 180.782 61.3333 180.973 60.9457C181.159 60.558 181.415 60.2201 181.741 59.9318C182.067 59.6436 182.45 59.4175 182.888 59.2535C183.327 59.0845 183.794 59 184.289 59C184.784 59 185.251 59.0845 185.689 59.2535C186.128 59.4175 186.51 59.6436 186.837 59.9318C187.163 60.2201 187.422 60.558 187.613 60.9457C187.798 61.3333 187.891 61.7458 187.891 62.1832V65.3663H190.051ZM181.412 65.3663H187.166V62.1832C187.166 61.8353 187.09 61.5073 186.938 61.1991C186.786 60.886 186.581 60.6152 186.322 60.3866C186.063 60.158 185.76 59.9766 185.411 59.8424C185.057 59.7082 184.683 59.6411 184.289 59.6411C183.889 59.6411 183.515 59.7082 183.167 59.8424C182.818 59.9766 182.514 60.158 182.256 60.3866C181.997 60.6152 181.792 60.886 181.64 61.1991C181.488 61.5073 181.412 61.8353 181.412 62.1832V65.3663ZM189.325 66H179.252V72.3589H189.325V66Z" fill="black"/>\n</g>\n<defs>\n<filter id="filter0_dd_2_4645" x="0.6" y="4.76837e-07" width="455.8" height="113.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="6.4"/>\n<feGaussianBlur stdDeviation="7.2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1.2"/>\n<feGaussianBlur stdDeviation="1.8"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter1_dd_2_4645" x="7.8" y="44" width="441.4" height="18.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter2_dd_2_4645" x="15.8" y="12" width="270.4" height="50.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter3_d_2_4645" x="155" y="50" width="283" height="38" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="2"/>\n<feGaussianBlur stdDeviation="2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_4645" result="shape"/>\n</filter>\n<clipPath id="clip0_2_4645">\n<path d="M15 16C15 11.5817 18.5817 8 23 8H434C438.418 8 442 11.5817 442 16V48H15V16Z" fill="white"/>\n</clipPath>\n<clipPath id="clip1_2_4645">\n<rect width="12" height="12" fill="white" transform="translate(249 26)"/>\n</clipPath>\n<clipPath id="clip2_2_4645">\n<rect width="16" height="16" fill="white" transform="translate(39 24)"/>\n</clipPath>\n</defs>\n</svg>\n'],
{type:"image/svg+xml"})),Xb.imageSrc=this.Mkd,Xb.learnMoreLink=null,Xb.primaryButtonLabel=CommonUIStrings.l_DialogOk),new Ue(this.$,this.FQa,{[ie.a.fv]:Sb.id,["bodyControls"]:Xb}))}}Sb.jda=!1;Sb.GCb="notOpened";Sb.HCb="ok";Sb.id="CopyPasteNoClipboardAccessDialog";Object(w.a)(Sb,"CopyPasteNoClipboardAccesslDialog",null,[740]);var cd=a(72),Xc;(function(D){D[D.source=0]="source";D[D.destination=1]="destination"})(Xc||(Xc={}));Object(w.b)("RangeType",Xc);class fd extends Cc.a{constructor(D,ma,Ua,Xb,yc,
Tc,Sc,Gd,De,ve){ve=void 0===ve?null:ve;super();this.sFg=this.tFg=this.pasteShortcutManager=this.nFb=null;this.Mgb=!1;this.P7e=()=>{var Xe;(null===(Xe=this.nFb)||void 0===Xe?0:Xe.EJf())&&!Va.V(ua.h(this.$).ha.pa.selectedRanges,this.nFb.Azc)&&(this.nFb.dqa(),this.nFb=null);this.gridView.ha.Pt(this.P7e)};this.cWd=Xe=>{this.agk(Xe)&&(this.Lv.FDd(),z.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.Caj=(Xe,nf)=>{z.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Xe}]. userPressedExtensionLink=${nf}`);this.gridView.focus()};this.G$i=(Xe,nf)=>{z.ULS.sendTraceTag(508130372,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got No Clipboard Access Dialog, user pressed [${Xe}]. userPressedOK=${nf}`);this.gridView.focus()};this.Xg=(Xe,nf)=>{nf.cT||nf.Yj||this.$u("OnWorkbookOpened",!1).catch(()=>{})};this.Hm=
(Xe,nf)=>{Xe=pb(this.BK);const uf=this.Lv.jJb(Xe);uf&&(nf.na&&nf.na.sheetName===uf.sheetName&&uf.isFromCurrentSession(this.$)?this.Lv.kAf(uf.ranges,Xe.commandParameters.commandType):this.Lv.FDd())};this.$Dc=(Xe,nf)=>{Xe=pb(this.BK);(Xe=this.Lv.jJb(Xe))&&nf.item&&nf.item.sheetName===Xe.sheetName&&Xe.isFromCurrentSession(this.$)&&this.$u("OnItemDeleting",!1).catch(()=>{})};this.pHa=()=>{this.tFg()};this.wT=()=>{this.sFg()};this.jX=(Xe,nf)=>{1===nf.Bu&&nf.Zi.operation.flags&2&&this.$u("OnQueueItemChanged/ItemRemoved",
!1).catch(()=>{})};this.$=D;this.zoom=De;this.$h=Ua;this.gridView=ua.h(D);this.Lv=yc;this.PPi=Tc;this.BK=ma;this.oDb=Xb;this.getStringifiedError=ve||copyPasteInfra.getStringifiedError;this.Eyg=1===Gd;this.Kl();Sc||(z.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Sc=fd.NOh);this.userHash=jb.a.XA(Sc);this.Qej="CultureTag: "+ad.a.instance.Tjc+" HASH: ";this.BK.addMetadataChangeListener(fd.XUf,this.cWd);this.$dj=this.$.xa.CCPPastePlainTextLimit;
this.OQb=this.$.xa.CCPCopyPasteHtmlLimit;Tb.EwaSettings.qFa()?void Eb.a.Xn(kc.Wc).then(Xe=>{this.pasteShortcutManager=Xe}):D.ja.Ne(478,Xe=>{this.pasteShortcutManager=Xe});this.tFg=ib.b(()=>{this.qyj()},1,this.$.qa,"CopyPasteInfrastructure.OnStartEditInternal",!0);this.sFg=ib.b(()=>{this.epj()},1,this.$.qa,"CopyPasteInfrastructure.onEndEditInternal",!0)}llc(){var D=pb(this.BK);return D?(D=D.sourceItem)&&!D.isFromCurrentSession(this.$)?(z.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return this.$.ja.Qa(373)}cNe(D){this.addHandler(fd.aXd,D)}eWj(D){this.removeHandler(fd.aXd,D)}ycc(D){this.addHandler(fd.$Uc,D)}lWj(D){this.removeHandler(fd.$Uc,D)}copy(D){D.stopwatch=this.$.Ve.Sf("UserAction",lb.b().hm(D.ribbonCommandInfo.command)+"ClientSide");if(Tb.EwaSettings.qFa())void Eb.a.resolve(kc.Wc).then(Tc=>{this.pasteShortcutManager=Tc});else{const Tc=Zd.GetServiceTaskFactory.vf(this.$.ja,478,479,0);ne.TaskExtensions.Ca(Tc,()=>{this.pasteShortcutManager=
Tc.result},this.qa,3)}const ma=!!pb(this.BK);bc.a.oVa&&(this.Mgb=!1);this.$u("Copy/before/"+qb.a[D.ribbonCommandInfo.method],!1,void 0,!0,D.copyPasteTargetType).catch(()=>{});var Ua=-1985798686===D.ribbonCommandInfo.command;if(1===this.gridView.Yh&&(Ua=this.Lv.mFf(this.gridView.ha.pa.selectedRanges,Ua),0!==Ua)){const Tc=fd.FDh(Ua);this.NHa(Tc,mc[Ua],!1);return Promise.reject(!1)}D.userHash=this.userHash;D.id=ta.a.create().toString();const Xb=this,yc=this;return this.oDb.onCopy(D).then(Tc=>{Tc.isAsyncCopy||
D.stopwatch.stop();Xb.pasteIndicationManager.b9e();const Sc=ld.d(D);z.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${Sc}`);Xb.w9i(Tc,ma);Tc=1===D.copyPasteTargetType;!D.isFormatPainter&&Tc&&(Xb.pasteShortcutManager?Xb.pasteShortcutManager.aXh():z.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},Tc=>{let Sc=!1,Gd="none",De=fd.Dab,ve=!0,Xe=-1,nf=fd.copyErrorName+fd.FCa,uf=!1,rg=null;if(Tc){rg=
Tc.copyContext;Xe=Tc.reason;nf+=fd.HDa(Tc);Tc.message&&(De=Tc.message);var $f=fd.EDh(Tc);if($f)if(3===$f.copyErrorName)Sc=!0,De=Gd="Async Copy canceled by the user.",ve=!1;else if(Cb.a.wt($f.ewaErrors))if(De=yc.kqc($f.ewaErrors),Cb.a.yk($f.ewaErrors,fd.operationSucceededWithAlert))uf=Sc=!0;else if(Cb.a.yk($f.ewaErrors,fd.pasteDataLimitHit)||Cb.a.yk($f.ewaErrors,fd.copyThrottlingError))Sc=!0;13===Tc.reason?(Sc=!0,ve=!1):11===Tc.reason&&(ve=!1)}$f=Tc?yc.getStringifiedError(Tc):"null";Sc?($f=ld.d(D),
z.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${ve}, Friendly message: ${Gd}, Error Message: ${De}, CommandParameters: ${$f}`)):z.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${ve}, Error Message: ${$f}, CommandParameters: ${ld.d(D)}`);ve&&yc.$u("Copy/fail/"+qb.a[D.ribbonCommandInfo.method],!0,void 0,void 0,D.copyPasteTargetType).catch(()=>
{});yc.eQf(D,Sc,De,nf,Xe,uf,rg);return Promise.reject(Tc)})}writeToClipboard(D){D.stopwatch=this.$.Ve.Sf("UserAction",lb.b().hm(D.ribbonCommandInfo.command)+"ClientSide");this.$u("Copy/before/"+qb.a[D.ribbonCommandInfo.method],!1,void 0,!0,D.copyPasteTargetType).catch(()=>{});D.userHash=this.userHash;D.id=ta.a.create().toString();return this.oDb.onCopy(D).then(()=>{D.stopwatch.stop();return Promise.resolve(!0)},ma=>{let Ua=fd.Dab,Xb=-1,yc=fd.copyErrorName+fd.FCa,Tc=null;ma&&(Tc=ma.copyContext,Xb=
ma.reason,yc+=fd.HDa(ma),ma.message&&(Ua=ma.message));const Sc=ld.d(D);z.ULS.sendTraceTag(508074081,0,15,`CopyPasteInfrastructure.writeToClipboard: Copy operation failed with an error. Error Message: ${Ua}, CommandParameters: ${Sc}`);this.eQf(D,!1,Ua,yc,Xb,!1,Tc);return Promise.reject(ma)})}PDj(D){if(this.llc())return ub.a(this.YFd(D.commandType,D.ribbonCommandInfo));const ma=Va.d(this.gridView.ha.pa.selectedRanges);D.originalDestinations=ma;D.expandDestinations=this.ufc(D.originalDestinations,D.commandType);
if(this.Hfc(D.commandType,D.expandDestinations)||this.GVe())D.userHash=this.userHash,D.id=ta.a.create().toString(),this.oDb.onPaste(D).then(()=>Promise.resolve(!0),Ua=>Promise.reject(Ua));return Promise.resolve(!0)}j1f(D,ma){if(D.method){var Ua=new zc(this.$,Va.d(this.gridView.ha.pa.selectedRanges),Va.d(this.gridView.ha.pa.selectedRanges),{},this.zoom);(Xb=>{const yc=kc.ud.$e()?Object(ub.d)(Eb.a.resolve(kc.ud,{Aa:0})):Zd.GetServiceTaskFactory.vf(this.$.ja,406,405,0);ne.TaskExtensions.Ca(yc,()=>{D.method&&
Xb(yc.result)},this.qa,8)})(Xb=>{Xb.$ed(Ua);Xb.Tce(D.method,ma);this.nFb=Xb});z.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.gridView.ha.qt(this.P7e)}}paste(D){D.stopwatch=this.$.Ve.Sf("UserAction",lb.b().hm(D.ribbonCommandInfo.command)+"ClientSide");bc.a.oVa&&(z.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.Mgb=!1);ua.h(this.$).mj&&ua.h(this.$).mj.l8(this.vzd(D.ribbonCommandInfo.command),
D.stopwatch.id);if(D.isPasteCommandFromRecoveryUI){var ma=kc.ud.$e()?Eb.a.mg(kc.ud):this.$.ja.Qa(406);var Ua=Va.d(ma.Azc);if(!Ua)return z.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);ma=ma.LMd;D.pasteRecoveryCachedClipboardItems=ma?ma[fd.S$f]:null}else Ua=Va.d(this.gridView.ha.pa.selectedRanges);D.originalDestinations=Ua;D.expandDestinations=this.ufc(D.originalDestinations,D.commandType);if(this.Hfc(D.commandType,D.expandDestinations)||
this.GVe())return D.userHash=this.userHash,D.id=ta.a.create().toString(),Od(this.$)&&(D.isAsyncSystemClipboardEnabled=!0),this.oDb.onPaste(D).then(Xb=>this.BEc(Xb,D),Xb=>this.USb(D,Xb));this.$.Lf(927125067,ob.a.Ke,30,null);Ua=Va.i(D.expandDestinations,",",this.$,!1);z.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${Ua}, CommandType: ${D.commandType}, copyPasteTargetType="${D.copyPasteTargetType}"`);
return Promise.resolve(!0)}vzd(D){switch(D){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}GVe(){return!!ua.h(this.$).ha.Ua.activeFloatingObjectControlId&&this.$.Zu(null,!1,470)}Hhb(){const D=pb(this.BK);return D&&D.commandParameters?D.commandParameters.copyPasteTargetType:0}uYi(){return!!pb(this.BK)&&qd(pb(this.BK),this.$)}$u(D,ma,Ua,Xb,yc){Ua=void 0===Ua?!1:Ua;Xb=void 0===Xb?!1:Xb;yc=void 0===yc?0:yc;try{this.pasteShortcutManager&&
this.pasteShortcutManager.Gkc();let Tc=yc;const Sc=this.m5i();if(!Xb&&2===Sc)return z.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${ma}', isExplicit = '${Ua}', isForce = '${Xb}', Current CCP operation copyPasteTargetType = '${yc}', LastCopyPasteTargetType = '${Sc}'`),Promise.reject(null);0===Tc&&(Tc=Sc);const Gd=this.$.Ve.Sf("UserAction","ClearCopyState"),De=Gd.id;z.ULS.sendTraceTag(537167820,
0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${ma}', isExplicit = '${Ua}', isForce = '${Xb}', Current CCP operation copyPasteTargetType = '${yc}', LastCopyPasteTargetType = '${Sc}'`);this.Lv.FDd();this.kMj();return this.oDb.onCancelCopy(ma).then(()=>{ma&&bc.a.oVa&&(this.Mgb=!1);Gd.stop();this.dQf(D,De,!0,Ua,ma,"","",Gd.gg,Tc);return Promise.resolve(!0)},ve=>{var Xe=ve?this.getStringifiedError(ve):"null";z.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Xe}`);
Gd.stop();Xe=fd.Nuh+fd.FCa;let nf=fd.Dab;ve&&(Xe+=fd.HDa(ve),ve.message&&(nf=ve.message));this.dQf(D,De,!1,Ua,ma,nf,Xe,Gd.gg,Tc);return Promise.reject(ve)})}catch(Tc){return Promise.reject(null)}}xid(D,ma,Ua,Xb){var yc=void 0;yc=void 0===yc?!1:yc;Ua=void 0===Ua?!1:Ua;Xb=void 0===Xb?0:Xb;return Ua||this.llc()?this.$u(D,ma,yc,Ua,Xb):(z.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),
Promise.reject(null))}NHa(D,ma,Ua){z.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${ma}`);const Xb=new fa.a;Xb.da("reason",ma);V.a(te.a.discontinuousSelectionBlocking,[Ua?Ma.a.qDj:Ma.a.EEh],!0,!0,!1,!1,Xb);D=Cb.a.Fg(1,1,751,D,0,371863010,"DiscontinuousSelectionBlocking");new se.a(this.$,D)}m5i(){const D=pb(this.BK);return D&&D.sourceItem&&Object.getType(D.sourceItem)!==Ta?Object.getType(D.sourceItem)===
qc?2:1:0}rUh(D,ma,Ua,Xb,yc){yc=void 0===yc?!1:yc;D.stopwatch=this.$.Ve.Sf("UserAction","DragDropReplaceClientSide");D.isDragDrop=!0;this.xid("DragDropReplace/before/"+qb.a[D.ribbonCommandInfo.method],!1,void 0,D.copyPasteTargetType).catch(()=>{});const Tc=yc?2:1;let Sc=0;Sc=yc?4:Xb?256:128;const Gd={encounteredDeploymentErrors:!1};Gd.commandParameters=D;D.isDragInsert=!1;D.userHash=this.userHash;D.id=ta.a.create().toString();return this.Lv.pasteRange(D.ribbonCommandInfo,Va.q(ma,this.$),Va.q(Ua,this.$),
Tc,Sc,[D.stopwatch],Gd,!1,()=>{z.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${D.copyPasteTargetType}"`);this.jQf(D,Tc,ma,Ua,Gd)},De=>this.v0f(De,D,Tc,ma,Ua,Gd)).then(()=>{this.gridView.ha.selectionType=-1;return Promise.resolve(!0)},De=>Promise.reject(De))}qUh(D,ma,Ua,Xb,yc){yc=void 0===yc?!1:yc;D.stopwatch=this.$.Ve.Sf("UserAction","DragDropInsertClientSide");this.xid("DragDropInsert/before/"+qb.a[D.ribbonCommandInfo.method],!1,void 0,
D.copyPasteTargetType).catch(()=>{});const Tc=yc?2:1,Sc=Va.P(this.ufc([Ua],Tc));var Gd=this.$.ea.na.sheetName;const De=this.$.ea.na.sheetName,ve=Va.v(ma,this.$);ve.SheetName=Gd;Gd=Va.v(Sc,this.$);Gd.SheetName=De;Xb=Sc.isRow||ma.isRow||Xb?1:0;const Xe={encounteredDeploymentErrors:!1};D.isDragInsert=!0;Xe.commandParameters=D;D.userHash=this.userHash;D.id=ta.a.create().toString();yc=this.Lv.uUh(Xe,ve,Gd,yc,Xb,D.ribbonCommandInfo,()=>{z.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${D.copyPasteTargetType}"`);
this.jQf(D,Tc,ma,Ua,Xe)},nf=>{this.v0f(nf,D,Tc,ma,Ua,Xe)});return ub.d(yc.then(()=>{this.gridView.ha.selectionType=-1;return Promise.resolve(!0)},nf=>Promise.reject(nf))).Jw(()=>!0)}YFd(D,ma,Ua,Xb,yc,Tc){var Sc=pb(this.BK);if(!Sc)return z.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),nb.Task.Ra(!1);if(!Ca(Sc.sourceItem))return z.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),nb.Task.Ra(!1);var Gd=Sc.sourceItem;
if(!Gd)return z.ULS.shipAssertTag(537167810,0,!!Gd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),nb.Task.Ra(!1);if(1<Gd.ranges.length)return z.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.NHa(2192,"InsertCopiedCutCells",!0),nb.Task.Ra(!1);Sc=Va.P(Gd.ranges);var De=this.gridView.ha.pa.og.clone();D=Va.P(this.ufc([De],D));const ve=this.HNf();Gd=Gd.sheetName;De=this.$.ea.na.sheetName;const Xe=Va.v(Sc,this.$);Xe.SheetName=
Gd;const nf=Va.v(D,this.$);nf.SheetName=De;Gd=this.gridView.ha.pa.activeRange;const uf=()=>{z.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},rg=()=>{z.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(D.Ei||Sc.Ei||this.Lv.Whk(this.$,Sc,Gd)?nb.Task.Ra(0):D.isRow||Sc.isRow||this.Lv.Xhk(this.$,Sc,Gd)?nb.Task.Ra(1):this.PPi.uic(this.$,ua.h(this.$).rtl)).Jw($f=>this.llc()?this.Lv.executeInsertCopiedCutCellsOperation(Xe,nf,ve,$f.result,ma,
null,null):this.Lv.executeInsertCopiedCutCellsAcrossSession(Xe,nf,ve,$f.result,ma,uf,rg,Ua,Xb,yc,Tc)).continueWith(()=>{this.$u("InsertCopiedCutCells/success/"+qb.a[ma.method],!0)})}bNb(){const D=pb(this.BK),ma=this.gridView.ha.pa.Fk;return!!D&&Ca(D.sourceItem)&&ma&&1===D.sourceItem.ranges.length}HNf(){return this.INf(-911352779)}TKd(){var D,ma;const Ua=pb(this.BK);return Ua?(null===(D=Ua.asyncClipboardItemsKeys)||void 0===D?void 0:D.includes(ya.shadowWorkbook))||(null===(ma=Ua.syncClipboardItemsKeys)||
void 0===ma?void 0:ma.includes(ya.shadowWorkbook))||3!==Ua.copyStatus:!1}zzc(){return this.INf(-1985798686)}Hfc(D,ma){var Ua=new ke.a(this.$.sa),Xb=36===D;const yc=Ua.hh(4);D=2===this.Hhb()&&Ua.hh(1);Xb=Xb&&yc;Ua=!Ua.Vk||!this.zzc()||!ke.a.blc(ma,ua.h(this.$));return Xb||D||this.$.Zu(ma,!0)&&Ua}MMb(D,ma){return this.Lv.MMb(D,ma)}dispose(){super.dispose();this.Qk();this.BK.removeMetadataChangeListener(fd.XUf)}Qod(D,ma,Ua,Xb,yc,Tc){if(!this.Byh(D.commandParameters.ribbonCommandInfo.command))return D.cseStatus=
2,!1;if(!bc.a.Uia&&Ua!==yc)return D.cseStatus=6,!1;if(Xb.width%ma.width||Xb.height%ma.height)return D.cseStatus=16,!1;yc=Xb.Bh(this.gridView.Xk);var Sc=null===ma.Bh(this.gridView.Xk);const Gd=D.commandParameters.ribbonCommandInfo.command;if(bc.a.Uia){if(!yc)return D.cseStatus=7,!1}else if(Sc&&1804571062!==Gd&&-185374993!==Gd&&-875588320!==Gd||!yc)return D.cseStatus=7,!1;Sc=this.bTe(this.gridView,D.commandParameters.ribbonCommandInfo.command,ma,Xc.source);if(0!==Sc)return D.cseStatus=Sc,!1;Sc=this.bTe(this.gridView,
D.commandParameters.ribbonCommandInfo.command,yc,Xc.destination);if(0!==Sc)return D.cseStatus=Sc,!1;Sc=Va.v(ma,this.$);Sc.SheetName=Ua;Ua=this.$h.uDj(this.gridView,Sc,Va.v(yc,this.$),D.commandParameters.ribbonCommandInfo.command,D.commandParameters.stopwatch);1===Ua&&(Tc&&(ma.Zf(Xb)?(Xb=Va.cb(ma,D.commandParameters.expandDestinations[0]),this.$h.iid(Xb,!1,D.commandParameters.id),this.$h.iid(Xb,!0,D.commandParameters.id)):(this.$h.Ggc(ma,!1),this.$h.Ggc(ma,!0))),ma=new rb(D.commandParameters.ribbonCommandInfo.command,
yc,ma),ua.h(this.$).cfg(ma),this.pasteIndicationManager.ytc(D.commandParameters.id,!0),this.hYb(D.commandParameters.expandDestinations,D.commandParameters.isPasteCommandFromRecoveryUI),this.wid("DoPasteClientEstimation/"+qb.a[D.commandParameters.ribbonCommandInfo.method],D));D.cseStatus=Ua;return 1===Ua}bTe(D,ma,Ua,Xb){const yc=new hd.a("CopyPasteInfrastructure.blockCseForPaste",D,Ua);try{for(;yc.moveNext();){const Tc=yc.get_current().cell;if(Tc.nB)return 8;if(237279923===ma||1804571062===ma){if(!Tb.EwaSettings.MFa()&&
Tc.UG)return 18;if(Tc.EP)return 19}if(Xb===Xc.source&&!Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CloneCellBordersNew",!1)&&(237279923===ma||1804571062===ma)&&this.P_i(D,Ua))return 20}}catch(Tc){Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8421658_ErrorLogsForBlockingPasteCSE")&&cd.a.Vl(Tc,"CopyPasteInfrastructure.BlockCseForPasteRange: exception thrown before CSE")}finally{yc&&yc.dispose()}return 0}kbg(){Od(this.$)?(new Sb(this.$)).showDialog(!0,!1,!1,this.G$i):(za.a.Br||za.a.sxc||
za.a.YEf?new Bd(this.$):new Ee(this.$)).showDialog(!0,!1,!1,this.Caj)}faj(D,ma,Ua,Xb){D=Hb(D,ma,Ua,Xb,this.$.xa.UserSessionId);D.k=!0;lb.b().Fi(45,D,!0)}hwj(D,ma,Ua,Xb,yc){var Tc=!1,Sc=!1,Gd=fd.Dab,De=fd.e9e+fd.FCa;D&&(De+=fd.HDa(D),Cb.a.wt(D.ewaErrors)?(Gd=this.kqc(D.ewaErrors),Cb.a.yk(D.ewaErrors,[-103190598])&&(Tc=!0)):D.message&&(Gd=D.message));Sc||(Sc=this.hId(D));ma=Hb(ma,Ua,Xb,yc,this.$.xa.UserSessionId);ma.k=!1;ma.l=Sc;ma.n=Gd;ma.p=De;ma.q=Tc;lb.b().Fi(45,ma,!0);return Promise.reject(D)}P_i(D,
ma){const Ua=D.Ln("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new xb.Range(ma.top,ma.right,ma.bottom,ma.right,!0,!0));for(;Ua.$$mn();){const Xb=Ua.$$cu();if(Xb&&Xb.Ora())return z.ULS.sendTraceTag(509436432,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0}for(D=D.Ln("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new xb.Range(ma.bottom,ma.left,ma.bottom,ma.right,!0,!0));D.$$mn();)if((ma=D.$$cu())&&ma.Lra())return z.ULS.sendTraceTag(509436431,
0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0;return!1}$lh(D,ma,Ua){D.cseStatus=0;D.cseStatus=this.YVi(D.commandParameters.ribbonCommandInfo.command,Ua,this.gridView,ma);if(0!==D.cseStatus)return!1;D.cseStatus=this.$h.vDj(this.gridView,ma,Ua,D.commandParameters.stopwatch);ma=new rb(D.commandParameters.ribbonCommandInfo.command,Ua,null);1===D.cseStatus&&(ua.h(this.$).cfg(ma),this.pasteIndicationManager.ytc(D.commandParameters.id,!0),this.hYb(D.commandParameters.expandDestinations,
D.commandParameters.isPasteCommandFromRecoveryUI),this.wid("AttemptExternalPlainTextPasteClientEstimation/"+qb.a[D.commandParameters.ribbonCommandInfo.method],D));return 1===D.cseStatus}YVi(D,ma,Ua,Xb){if(-875588320!==D&&-185374993!==D&&237279923!==D)return 2;if(Ua.Je.mNb(ma))return 8;if(!Tb.EwaSettings.MFa()&&Ua.Je.R3i(ma))return 18;if(Ua.Je.G0(ma))return 11;if(this.$h.L8e(ma))return 12;D=this.Zsh(ma,Xb);return ua.j(this.gridView,D)?0:7}Zsh(D,ma){var Ua=ma.indexOf("\r");Ua=-1!==Ua?"\n"===ma[Ua+1]?
ma.split("\r\n"):ma.split("\r"):ma.split("\n");ma=Ua.length;Ua=Ua[0].split("\t").length;return new xb.Range(D.top,D.left,D.top+ma-1,D.left+Ua-1,!0,!0)}Byh(D){switch(D){case 237279923:case 808159687:case -185374993:case 1804571062:case -875588320:return!0;default:return!1}}INf(D){const ma=pb(this.BK);return ma?ma.commandParameters.ribbonCommandInfo.command===D:!1}agk(D){return D&&D.lastCopy?qd(D.lastCopy,this.$):!0}Aof(D,ma,Ua,Xb,yc){const Tc={};Tc.a=this.$.xa.UserSessionId;Tc.e=D.stopwatch.id;Tc.c=
lb.b().hm(D.ribbonCommandInfo.command);Tc.b=qb.a[D.ribbonCommandInfo.method];Tc.d=D.id;Tc.f=Ua.toString();Tc.g=Xb.toString();Tc.h=ma.toString();Tc.o=D.stopwatch.gg;Tc.q=!1;Tc.r=D.copyPasteTargetType.toString();Tc.s=yc.encounteredDeploymentErrors;Tc.i=yc.commandParameters.dragDropIsShiftKeyDown;Tc.j=yc.commandParameters.isDragInsert;Tb.EwaSettings.Wv()&&(Tc.t=yc.commandParameters.isHeaderDrag);return Tc}jQf(D,ma,Ua,Xb,yc){D=this.Aof(D,ma,Ua,Xb,yc);D.k=!0;lb.b().Fi(45,D,!0)}E9i(D,ma,Ua,Xb,yc,Tc,Sc,
Gd,De){D=this.Aof(D,ma,Ua,Xb,De);D.k=!1;D.l=yc;D.n=Tc;D.p=Sc;D.q=Gd;lb.b().Fi(45,D,!0)}dQf(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De){const ve={};ve.a=this.$.xa.UserSessionId;ve.b=ma;ve.c=D;ve.f=Ua;ve.e=Xb;ve.d=yc;ve.g=Tc;ve.h=Sc;ve.i=Gd;ve.j=De.toString();lb.b().Fi(46,ve,!0)}w9i(D,ma){D=this.Wnf(D.commandParameters,D);D.l=!0;D.j=ma;lb.b().Fi(43,D,!0)}eQf(D,ma,Ua,Xb,yc,Tc,Sc){D=this.Wnf(D,Sc);D.l=!1;D.m=ma;D.o=Ua;D.y=Xb;D.x=yc;D.z=Tc;lb.b().Fi(43,D,!0);z.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${D.y},ErrorReason=${D.x},IsExpectedError=${D.m},IsSucceededWithAlert=${D.z},ErrorMessage=${D.o}`)}Wnf(D,
ma){const Ua={};Ua.a=this.$.xa.UserSessionId;Ua.f=D.stopwatch.id;Ua.g=D.id;Ua.c=lb.b().hm(D.ribbonCommandInfo.command);Ua.b=qb.a[D.ribbonCommandInfo.method];Ua.q=D.stopwatch.gg;Ua.bd=fd.wpc();Ua.bg=D.copyPasteHandlerName;Ua.bj=void 0===D.ribbonCommandInfo.Ch||null===D.ribbonCommandInfo.Ch?null:ab.a[D.ribbonCommandInfo.Ch];Ua.bq=D.uploadToClipService;Ua.br=D.floatingObjectType;Ua.s=D.copyPasteTargetType.toString();Ua.bc=fe(D.copyPasteTargetType);Ua.z=!1;if(ma){Ua.bk=ma.id;Ua.bl=ma.serverRequestTimeInMs;
ma.requestTelemetryData&&(Ua.bm=ma.requestTelemetryData.EcsOperationDuration,Ua.bn=ma.requestTelemetryData.EcsRequestDuration,Ua.bo=ma.requestTelemetryData.WfeRequestDuration);Ua.d=ma.sourceItem?ma.sourceItem.toString():null;Ua.e=-1;if(Ca(ma.sourceItem)){Ua.e=0;D=ma.sourceItem.ranges;for(const Xb of D)Ua.e+=Xb.Gv}Ua.h=ma.isAsyncCopy;Ua.i=ma.isFromCache;Ua.k=ma.isSelectionAllowed;Ua.r=ma.plainTextPayloadSize;Ua.u=ma.htmlPayloadSize;Ua.v=ma.htmlSizeExceedsLimit;Ua.w=ma.copyTotalSizeExceedsLimit;Ua.t=
ma.shadowWorkbookPayloadSize;Ua.p=ma.clientSideCopyTime;Ua.ba=ma.encounteredDeploymentErrors;Ua.bb=ma.shadowWorkbookSizeExceedsLimit;Ua.be=ma.syncClipboardItemsKeys;Ua.bf=ma.asyncClipboardItemsKeys;Ua.bh=this.g1e(ma.succeededPopulatingSystemClipboardSync);Ua.bi=this.g1e(ma.succeededPopulatingSystemClipboardAsync);Od(this.$)&&(Ua.bs=ma.commandParameters.isAsyncClipboardAPI)}return Ua}hYb(D,ma){ma=void 0===ma?!1:ma;if(!this.gridView.De&&!this.gridView.Fm){var Ua=this.gridView.ha.pa,Xb=!ma&&1===D.length&&
Va.V(D,Ua.selectedRanges),yc=Xb?Ua.activeCell:D[0].topLeft;D[0].contains(yc)||(z.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${Ua.selectedRanges}, IndexOfActiveRange ${Ua.qu}, ActiveCell ${Ua.activeCell}, calculatedDestinationRanges ${D}, keepThePreviousActiveCell ${Xb}, newActiveCell ${yc}, isPasteCommandFromRecoveryUI ${ma}`),yc=D[0].topLeft);this.gridView.ha.ZK(D,0,yc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}nsf(D,ma){const Ua={};Ua.a=
this.$.xa.UserSessionId;Ua.g=D.stopwatch.id;Ua.t=D.stopwatch.gg;Ua.bz=!1;ma&&(Ua.bv=ma.id,Ua.bw=ma.serverRequestTimeInMs,Ua.n=ma.commandParameters.clipboardFormatReadTimes,Ua.o=ma.commandParameters.clipboardFormatReadStatus,Ua.q=ma.commandParameters.asyncApiReadTimedOut,ma.requestTelemetryData&&(Ua.cb=ma.requestTelemetryData.EcsOperationDuration,Ua.cc=ma.requestTelemetryData.EcsRequestDuration,Ua.cd=ma.requestTelemetryData.WfeRequestDuration));Ua.x=D.copyPasteTargetType.toString();Ua.bl=fe(D.copyPasteTargetType);
Ua.br=D.copyPasteHandlerName;Ua.i=Va.i(D.expandDestinations,",",this.$,!1);Ua.h=Va.i(D.originalDestinations,",",this.$,!1);Ua.e=D.id;Ua.d=D.commandType;Ua.c=lb.b().hm(D.ribbonCommandInfo.command);Ua.b=qb.a[D.ribbonCommandInfo.method];Ua.bf=!1;Ua.bg=!1;Ua.bp=fd.wpc();Ua.bt=void 0===D.ribbonCommandInfo.Ch||null===D.ribbonCommandInfo.Ch?null:ab.a[D.ribbonCommandInfo.Ch];Ua.cj=D.isPasteCommandFromEnterShortcut;if(Ua.ca=D.isPasteCommandFromRecoveryUI)Ua.cf=D.pasteRecoveryUndoStopwatch.id,Ua.cg=D.pasteRecoveryUndoStopwatch.gg;
if(ma){if((D=ma.copyContextSnapshot)&&!ma.wasLastCopyExternal){Ua.f=D.commandParameters.id;Ua.j=D.sourceItem.toString();Ua.k=-1;if(Ca(D.sourceItem)){Ua.k=0;const Xb=D.sourceItem.ranges;for(const yc of Xb)Ua.k+=yc.Gv}Ua.bg=1===D.commandParameters.commandType}else ma.clipboardItems?Ua.f=ma.clipboardItems.getItem(ya.Lkd):z.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");Ua.bz=ma.pasteRecoveryUIDisplayed;Ua.ci=ma.cseStatus}else z.ULS.sendTraceTag(537167773,
0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Ua}N$i(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De){var ve,Xe;D=this.nsf(D,Gd);D.l=!1;D.m=ma;D.s=Ua;D.bc=Xb;D.be=yc;D.bd=Tc;D.bf=Sc;if(Gd){D.y=Pa(Gd)||!Gd.copyContextSnapshot;D.bi=!D.y&&qd(Gd.copyContextSnapshot,this.$);D.bj=Gd.shadowWorkbookSizeExceedsLimit;D.v=Gd.shadowWorkbookPayloadSize;D.w=Gd.htmlPayloadSize;D.bq=ge(Gd.clipboardItems);D.bb=Gd.activeSelectionType;D.bs=Gd.isSameSession;D.bn=Gd.payloadOrigin;D.bo=Gd.payloadType;D.bu=Gd.externalAppSource;
D.bx=Gd.indicationDisplayScheduled;D.by=Gd.pasteIndicationDisplayStatus;D.ck=Gd.pasteDestinationHasMergedCells;if(Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))D.cl=Gd.ArtSourceItemType;Od(this.$)&&(D.cm=null===(ve=Gd.commandParameters)||void 0===ve?void 0:ve.isAsyncClipboardAPI);Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&
(D.cn=null===(Xe=Gd.commandParameters)||void 0===Xe?void 0:Xe.isChromiumExtension)}else D.bi=qd(De,this.$);lb.b().Fi(44,D,!0);z.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${D.be},ErrorReason=${D.bd},IsExpectedError=${D.m},IsSucceededWithAlert=${D.bf},ErrorMessage=${D.s}`)}O$i(D){var ma,Ua;const Xb=this.nsf(D.commandParameters,D);Xb.y=D.wasLastCopyExternal;Xb.l=!0;Xb.u=D.plainTextPayloadSize;Xb.v=D.shadowWorkbookPayloadSize;Xb.w=D.htmlPayloadSize;Xb.z=
D.isClipboardDataContainShadowWorkbook;Xb.ba=D.isShadowWorkbookParsedSuccessfully;Xb.bb=D.activeSelectionType;Xb.bc=D.pasteResult;Xb.bh=D.encounteredDeploymentErrors;Xb.bj=D.shadowWorkbookSizeExceedsLimit;Xb.bk=Ib(D);Xb.bq=ge(D.clipboardItems);Xb.bs=D.isSameSession;Xb.bn=D.payloadOrigin;Xb.bo=D.payloadType;Xb.bu=D.externalAppSource;Xb.bx=D.indicationDisplayScheduled;Xb.by=D.pasteIndicationDisplayStatus;Xb.ck=D.pasteDestinationHasMergedCells;Xb.bm=D.clipboardItems?D.clipboardItems.getItem(ya.txh):
null;Xb.bi=!D.isSameSession&&!D.wasLastCopyExternal;Xb.ci=D.cseStatus;if(Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))Xb.cl=D.ArtSourceItemType;Od(this.$)&&(Xb.cm=null===(ma=D.commandParameters)||void 0===ma?void 0:ma.isAsyncClipboardAPI);Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(Xb.cn=null===(Ua=D.commandParameters)||
void 0===Ua?void 0:Ua.isChromiumExtension);lb.b().Fi(44,Xb,!0)}Kl(){this.$.sa.Vj(this.Hm);this.$.sa.seh(this.$Dc);this.$.userOperationManager.pt(this.jX);this.$.Go(this.Xg);ua.h(this.$).kf.jr(this.pHa);ua.h(this.$).kf.q$(this.wT)}Qk(){this.$&&this.$.sa&&(this.$.sa.vk(this.Hm),this.$.sa.wVj(this.$Dc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.Nr(this.jX);this.gridView&&this.gridView.kf&&(this.gridView.kf.$q(this.pHa),this.gridView.kf.Xua(this.wT))}USb(D,ma){var Ua=null;let Xb=
!1;var yc=null;let Tc="UnknownFailure",Sc=-1,Gd=fd.Dab,De=fd.pasteErrorName+fd.FCa,ve=!1;this.pasteIndicationManager.ytc(D.id,!1);this.pasteDestinationHasMergedCells(D.expandDestinations)&&(ma.pasteContext.pasteDestinationHasMergedCells=!0);const Xe=pb(this.BK);(D.clearStateOnFinish||D.clearSystemClipboard)&&this.$u("Paste/fail/"+qb.a[D.ribbonCommandInfo.method],!0,void 0,void 0,D.copyPasteTargetType).catch(()=>{});if(ma){Sc=ma.reason;De+=fd.HDa(ma);ma.message&&(Gd=ma.message);if(Ua=fd.TDh(ma))if(1===
Ua.pasteErrorName)Xb=!0,Tc="CopyPasteLengthTooLongPopup",Gd=yc="The pasted content is too long. Popup a dialog to the user.",z.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${yc}, copyPasteTargetType="${D.copyPasteTargetType}"`),Ua=Cb.a.Fg(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),new se.a(this.$,Ua);else if(7===Ua.pasteErrorName)Xb=!0,Tc="No-Op",Gd=yc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",
z.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${yc}, copyPasteTargetType="${D.copyPasteTargetType}"`);else if(8===Ua.pasteErrorName)Xb=!0,Tc="UseShortcutsPopup",Gd=yc="Unable to paste content from the system clipboard. Popup dialog to the user.",z.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${yc}, copyPasteTargetType="${D.copyPasteTargetType}"`),this.kbg();else if(18===Ua.pasteErrorName){Xb=!0;Tc="PasteExternalNotSupportMultipleSelectionPopup";
Gd="Paste external not support multiple selection.";yc="Unknown";var nf=2192;100!==Ua.validationFailureReason&&(yc=Wd[Ua.validationFailureReason],nf=fd.Z0e(Ua.validationFailureReason));this.NHa(nf,yc,!0)}else 20===Ua.pasteErrorName||19===Ua.pasteErrorName?(Xb=!0,20===Ua.pasteErrorName?(Tc="PasteAcrossSessionNotSupportMultipleSelectionPopup",Gd="Paste across session does not support multiple selection."):(Tc="PasteInSameSessionNotSupportMultipleSelectionPopup",Gd="This kind of multiple selection is not supported for same session paste."),
yc="Unknown",nf=2192,100!==Ua.validationFailureReason&&(yc=Wd[Ua.validationFailureReason],nf=fd.Z0e(Ua.validationFailureReason)),Ua=6===Ua.validationFailureReason,this.Hfc(D.commandType,D.expandDestinations)&&Ua&&this.hYb(D.expandDestinations),this.NHa(nf,yc,!0)):6===Ua.pasteErrorName?(Xb=!0,Tc="No-Op",Gd=yc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",z.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${yc}, copyPasteTargetType="${D.copyPasteTargetType}"`)):
17===Ua.pasteErrorName?(Xb=!0,Tc="No-Op",Gd=yc="Paste text on Art is not yet a supported operation",z.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${yc}, copyPasteTargetType="${D.copyPasteTargetType}"`)):16===Ua.pasteErrorName?(Xb=!0,Tc="No-Op",Gd=yc="Paste has failed because the previous copy has failed",Ua=this.getStringifiedError(Ua),z.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${yc}, copyPasteTargetType="${D.copyPasteTargetType}", error=${Ua}`)):
Cb.a.wt(Ua.ewaErrors)?(Cb.a.Dga(Ua.ewaErrors)||Cb.a.yk(Ua.ewaErrors,Cb.a.gsc())?(Xb=!0,Tc="CommunicationError",yc=Cb.a.xf(Ua.ewaErrors),z.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Gd} copyPasteTargetType="${D.copyPasteTargetType}"`)):Cb.a.yk(Ua.ewaErrors,fd.O3j)?(Xb=!0,Tc="SavingWorkbookError",yc=Cb.a.xf(Ua.ewaErrors),z.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Gd} copyPasteTargetType="${D.copyPasteTargetType}"`)):Cb.a.yk(Ua.ewaErrors,
fd.operationSucceededWithAlert)&&(ve=Xb=!0,Tc="OperationSucceededWithAlert",yc=Cb.a.xf(Ua.ewaErrors),z.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Gd} copyPasteTargetType="${D.copyPasteTargetType}"`)),Xb||(Gd=this.kqc(Ua.ewaErrors),Xb=this.hId(ma))):11===Ua.pasteErrorName&&(Xb=!0,Tc="No-Op",Gd="Paste has failed because user try copy cross-session oart object");15===ma.reason&&(Xb=!0,Tc="No-Op",Gd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Lc.a.equals(De,hb.FHk,!1)&&(Xb=!0,Tc="No-Op",Gd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Xb||(Ua=ma?this.getStringifiedError(ma):"null",z.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${Ua}, copyPasteTargetType="${D.copyPasteTargetType}"`));this.N$i(D,Xb,Gd,Tc,De,Sc,ve,ma.pasteContext,Xe);return Promise.reject(ma)}BEc(D,ma){var Ua;z.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${ma.copyPasteTargetType}"`);
this.pasteIndicationManager.ytc(ma.id,!0);if(this.ADj(ma.copyPasteTargetType,D)){bc.a.oVa&&D.wasLastCopyExternal&&D.payloadType===oc.shadowWorkbook&&(this.Mgb=!0);let Xb=null;(null===(Ua=D.pastedRange)||void 0===Ua?0:Ua.Ranges)&&0<D.pastedRange.Ranges.length?Xb=Va.g(D.pastedRange.Ranges):D.wasLastCopyExternal||(Xb=ma.expandDestinations);this.I5j(D,Xb);if(this.sik(D,Xb)){Ua=Va.d(ma.originalDestinations);const yc=1028===ma.commandType?Va.d(ma.expandDestinations):Va.d(Xb);let Tc=null;D.wasLastCopyExternal&&
(ma.isKeyboardEvent||ma.isPasteCommandFromRecoveryUI)&&(Tc={[fd.S$f]:D.clipboardItems});this.pasteDestinationHasMergedCells(ma.expandDestinations)&&(D.pasteDestinationHasMergedCells=!0);D.pasteRecoveryUIDisplayed=!0;const Sc=new na(this.$,Ua,yc,Tc,this.zoom),Gd=kc.ud.$e()?Object(ub.d)(Eb.a.resolve(kc.ud,{Aa:0})):Zd.GetServiceTaskFactory.vf(this.$.ja,406,405,0);264209770===ma.ribbonCommandInfo.command?this.gridView.ya.zYa(()=>{ne.TaskExtensions.Ca(Gd,()=>{const De=Gd.result;De.$ed(Sc);De.Tce(ma.ribbonCommandInfo.method)},
this.qa,8)}):ne.TaskExtensions.Ca(Gd,()=>{const De=Gd.result;De.$ed(Sc);De.Tce(ma.ribbonCommandInfo.method,ma.event)},this.qa,8)}this.eoj(D,Xb)}this.wid("Paste/success/"+qb.a[ma.ribbonCommandInfo.method],D);this.O$i(D);this.Eyg&&(!ma.isKeyboardEvent||Ib(D))&&this.$.ea.qk.get(66)&&(z.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.Eyg=!1,this.BFh());D=new ue(ma.expandDestinations,D.commandParameters.ribbonCommandInfo.command);this.QLj(D);
return Promise.resolve(!0)}eoj(D,ma){ne.TaskExtensions.Ca(Zd.GetServiceTaskFactory.vf(this.$.ja,534,535,1),Ua=>{Ua.result.wyk(D,ma)},this.$.qa,3)}sik(D,ma){return!ma||1!==ma.length||D.commandParameters.clearSystemClipboard||D.commandParameters.clearStateOnFinish||D.commandParameters.skipClipboardAccess?!1:Pa(D)&&(ma=D.clipboardItems.getItem(ya.plainText),D=D.clipboardItems.getItem(ya.html),void 0===ma||null===ma||ma.length>this.$dj||void 0===D||null===D||D.length>this.OQb)?(z.ULS.sendTraceTag(537167769,
0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}ADj(D,ma){return 1===D||ma.payloadType===oc.plainText||ma.payloadType===oc.html||bc.a.oVa&&ma.payloadType===oc.shadowWorkbook}pasteDestinationHasMergedCells(D){const ma=ua.h(this.$).ya.cz();if(!ma||!ma.length)return!1;for(const Ua of ma)if(Ua.dz(D[0]))return!0;return!1}wid(D,ma){let Ua;(()=>{let Xb=this.UTi(ma);({BQa:Ua}=Xb);return Xb})().returnValue&&this.$u(D,Ua,void 0,void 0,ma.commandParameters.copyPasteTargetType).catch(()=>
{})}v0f(D,ma,Ua,Xb,yc,Tc){const Sc=D?this.getStringifiedError(D):"null";let Gd=!1,De=!1,ve=!1,Xe=fd.Dab,nf=fd.e9e+fd.FCa;D&&(nf+=fd.HDa(D),Cb.a.wt(D.ewaErrors)?(Xe=this.kqc(D.ewaErrors),Cb.a.yk(D.ewaErrors,fd.operationSucceededWithAlert)&&(Gd=!0),Cb.a.yk(D.ewaErrors,fd.dragDropNonEmptyRange)&&(De=ve=!0)):D.message&&(Xe=D.message));ve||(ve=this.hId(D));De?this.gridView.ha.selectionType=-1:this.Lv.pPj(yc);ve||z.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${Sc}, copyPasteTargetType="${ma.copyPasteTargetType}`);
this.E9i(ma,Ua,Xb,yc,ve,Xe,nf,Gd,Tc)}ufc(D,ma){let Ua=D;const Xb=this.vqi();if(null===Xb||void 0===Xb?0:Xb.ranges)Ua=this.Lv.xth(ma,Xb.ranges,D);return Ua}vqi(){const D=pb(this.BK);return D&&Ca(D.sourceItem)?D.sourceItem:null}kMj(){this.raiseEvent(fd.aXd,null)}QLj(D){Object(ye.c)(()=>{this.raiseEvent(fd.$Uc,D)})}I5j(D,ma){const Ua=D.commandParameters.originalDestinations;ma&&(Va.V(this.gridView.ha.pa.selectedRanges,Ua)?(this.hYb(ma),D=ac.HelperMethods.pAb(ma),z.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${D}`)):
D.commandParameters.isPasteCommandFromRecoveryUI?(this.hYb(ma,!0),z.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${ma}, active cell: ${ma[0].topLeft}`)):(D=ac.HelperMethods.pAb(Ua),z.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${D}`)))}UTi(D){if(D.isPlainTextPaste||
D.isHtmlPaste||wb(D)||D.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,BQa:!1};var ma=D.copyContextSnapshot;if(D.commandParameters.clearStateOnFinish)return{returnValue:!0,BQa:!0};if(ma&&Ca(ma.sourceItem)){var Ua=ma.sourceItem;if(!Ua.isFromCurrentSession(this.$))return{returnValue:!1,BQa:!0};ma=-1985798686===ma.commandParameters.ribbonCommandInfo.command;if(!(1<Ua.ranges.length||1<D.commandParameters.expandDestinations.length)){const Xb=Va.P(Ua.ranges);D=Va.P(D.commandParameters.expandDestinations);
const yc=this.$.ea.na.sheetName;Ua=Ua.sheetName;if(Ua===yc&&D.equals(Xb))return{returnValue:!1,BQa:!0};if(Ua===yc&&D.Bh(Xb))return{returnValue:!0,BQa:!1}}return{returnValue:ma,BQa:!0}}return{returnValue:!1,BQa:!0}}qyj(){pb(this.BK)&&this.$u("OnStartEdit",!1).catch(()=>{})}epj(){pb(this.BK)&&this.$u("OnEndEdit",!0).catch(()=>{})}kqc(D){D=Cb.a.Jmi(D,fd.FCa);return this.Qej+jb.a.XA(D).toString()}hId(D){D=fd.HDa(D);return!!D&&Lc.a.LFb(D,fd.Pej)}BFh(){const D=Cb.a.Fg(1,2,327,328,za.a.Br?329:za.a.tK?330:
331,530046625,"ActivateLocalStorage"),ma=Object(ub.d)(Eb.a.resolve(kc.s,{Aa:0}));ne.TaskExtensions.Ca(ma,()=>{ma.result.Uj(43,D)},this.qa,3)}g1e(D){return void 0===D||null===D?Fc.qij:D?Fc.success:Fc.failed}static TDh(D){const ma=D.innerError;return ma&&0!==ma.pasteErrorName?D.innerError:null}static EDh(D){const ma=D.innerError;return ma&&0!==ma.copyErrorName?D.innerError:null}static HDa(D){let ma="";if(!D)return fd.L5e;D.errorName&&(ma=D.errorName,D.innerError&&(ma+=fd.FCa+fd.HDa(D.innerError)));
ma||(ma=D&&D.name?D.name:fd.L5e);return ma}static wpc(){fd.Xa||(fd.Xa=Yb.Bnk);return fd.Xa}static Z0e(D){switch(D){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return z.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${D}`),2199}}static FDh(D){switch(D){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;default:return z.ULS.shipAssertTag(537167763,
0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${D}`),2199}}}fd.XUf="EwaJsMetadataChangeListenerId";fd.aXd="cpiOSC";fd.$Uc="cpiPS";fd.NOh="cpiDID";fd.Dab="Unknown";fd.L5e="UnknownError";fd.FCa="_";fd.e9e="DragAndDropError";fd.pasteErrorName="PasteError";fd.Nuh="CancelError";fd.copyErrorName="CopyError";fd.Pej="MergedCellOverlap";fd.S$f="PasteRecoveryCachedClipboardItems";fd.O3j=[1352631530,1679665408];fd.operationSucceededWithAlert=[-103190598];
fd.pasteDataLimitHit=[1306609195];fd.copyThrottlingError=[-386183710];fd.dragDropNonEmptyRange=[563945982];fd.Xa=null;Object(w.a)(fd,"CopyPasteInfrastructure",Cc.a,[718,719,2]);class mb{constructor(){this.r$a=this.TYe=null}}Object(w.a)(mb,"ClipboardPlatformInitializationResult",null,[]);var Oc=a(692),jd=a(232),ud=a(127),pd=a(9),id=a(6),Ed=a(59),Pd=a(27);const lc=(D,ma,Ua,Xb,yc,Tc,Sc,Gd)=>{Gd=void 0===Gd?null:Gd;Sc=D.Oa(1,Sc);Sc.pasteHtmlParameters=ma;return Ed.h(D,"PasteHtmlContent",Sc,Ua,Xb,yc,Tc,
64,Gd)},Kc=(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De,ve)=>{ve=void 0===ve?null:ve;const Xe=D.Oa(9,De);De=Pd.a.MJf()?"PasteString":"PasteStringV2";const nf={};nf.DestinationRange=ma;nf.Source=Ua;nf.AutoAdjustColumnsOn=Xb;Xe.pasteStringParameters=nf;return Ed.h(D,De,Xe,yc,Tc,Sc,Gd,64,ve)},td=(D,ma,Ua,Xb,yc,Tc,Sc,Gd)=>{Gd=void 0===Gd?null:Gd;Sc=D.Oa(1,void 0===Sc?null:Sc);Sc.copyParameters=ma;return Ed.h(D,"Copy",Sc,Ua,Xb,yc,Tc,0,Gd)},zd=(D,ma,Ua,Xb,yc,Tc,Sc,Gd)=>{Gd=void 0===Gd?null:Gd;Sc=D.Oa(1,void 0===Sc?null:
Sc);Sc.pasteParameters=ma;return Ed.h(D,"Paste",Sc,Ua,Xb,yc,Tc,64,Gd)};class me{constructor(D,ma,Ua){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=D;this.destinationRange=ma;this.pasteFlags=Ua}}Object(w.a)(me,"MacroRecorderPasteRangePayload",null,[124]);class Ae{constructor(D,ma){this.content=this.destinationRange=null;this.destinationRange=D;this.content=ma}getContent(){return this.content}}Object(w.a)(Ae,"MacroRecorderPasteStringPayload",null,[124]);var ze=a(74);
class Ne{constructor(D){this.pasteParameters=null;this.pasteParameters=D}}Object(w.a)(Ne,"MacroRecorderPastePayload",null,[124]);var hf=a(621),rf;(function(D){D[D.none=0]="none";D[D.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";D[D.applyLinkFailed=2]="applyLinkFailed";D[D.pasteHtmlFailed=3]="pasteHtmlFailed";D[D.pasteStringFailed=4]="pasteStringFailed";D[D.pasteRangeFailed=5]="pasteRangeFailed";D[D.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";
D[D.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";D[D.clipboardIsInaccessible=8]="clipboardIsInaccessible";D[D.pasteArtFailed=9]="pasteArtFailed";D[D.noArtSourceItem=10]="noArtSourceItem";D[D.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";D[D.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";D[D.invalidShadowWorkbook=13]="invalidShadowWorkbook";D[D.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";D[D.failedToPasteExternalImage=
15]="failedToPasteExternalImage";D[D.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";D[D.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";D[D.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";D[D.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";D[D.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";
D[D.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";D[D.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed"})(rf||(rf={}));Object(w.b)("PasteErrorType",rf);class df{constructor(D,ma){this.errorName=this.innerError=null;this.errorName=D;this.innerError=void 0===ma?null:ma}}Object(w.a)(df,"CCPError",null,[]);class Af extends df{constructor(D,ma){ma=void 0===ma?null:ma;super(Cb.a.xf(void 0===D?null:D,"_"),ma)}}Object(w.a)(Af,"EwaCCPError",df,[]);class Pc extends df{constructor(D,ma,Ua,
Xb,yc){ma=void 0===ma?null:ma;Ua=void 0===Ua?null:Ua;Xb=void 0===Xb?"":Xb;yc=void 0===yc?100:yc;super(rf[D]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=D;this.ewaErrors=ma;this.validationFailureReason=yc;this.innerError=ma?new Af(ma,Ua):Ua;this.message=Xb}}Object(w.a)(Pc,"PasteInnerError",df,[]);var eb=a(204),gc=a(228),Qc=a(118),Vc=a(252),Id=a(368);class be{constructor(D){this.parameters=null;this.parameters=D}getParameters(){return this.parameters}}
Object(w.a)(be,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[124]);var Vb=a(395);class Gc{constructor(D,ma){this.lzc=this.XWa=null;this.Lvc=Tb.EwaSettings.getBooleanFeatureGate(bc.a.$Db,!1);this.xGd=!1;this.DZ=null;this.jA=(Ua,Xb)=>{if(2===Xb.Bu)this.lA.clear(),this.XWa=null;else if(1===Xb.Bu&&this.lA&&this.lA.contains(Xb.Zi)){Ua=ud.a(Xb.Zi.operation.operationName);const yc=Xb.Zi.dequeueUtcTime.getTime()-Xb.Zi.enqueueUtcTime.getTime();z.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${Ua} returned, it took ${yc} milliseconds to complete.`);
this.lA.remove(Xb.Zi);this.XWa=null}};this.$=D;this.gridView=ma;this.xGd&&(this.$.userOperationManager.pt(this.jA),this.lA=new La.a);Pd.a.REa()&&void Eb.a.resolve(kc.m,{Aa:1}).then(Ua=>{this.DZ=Ua})}get OQb(){return this.$.xa.CCPCopyPasteHtmlLimit}get aUf(){return this.$.xa.CCPPastePlainTextLimit}copy(D,ma,Ua,Xb,yc){Xb=void 0===Xb?null:Xb;yc=void 0===yc?null:yc;const Tc=this.$.oa.ua.qf();this.xGd&&this.P3();this.lzc=Tc.ClientRequestId;var Sc=new eb.a(505,0,(Gd,De,ve)=>{const Xe={CopyPasteTargetType:1};
Xe.SourceRanges=D;Xe.CopyOperationId=ma.id;return this.XWa=td(this.$.oa.Pz,Xe,Vc.b(Gd,Ua),Xb?Vc.a(De,Xb):De,ve,ma.ribbonCommandInfo,Tc,yc)},80);Sc=this.$.userOperationManager.enqueueOperation(Sc,ma.ribbonCommandInfo);this.xGd&&this.lA.add(Sc)}R$f(D,ma,Ua,Xb,yc,Tc){return new Promise((Sc,Gd)=>{var De;const ve=Tc.commandParameters.stopwatch.gg;let Xe=2;20===Tc.commandParameters.commandType&&(Xe=16);36===Tc.commandParameters.commandType&&(Xe=32);68===Tc.commandParameters.commandType&&(Xe=64);Pd.a.aMd(this.$)&&
1028===Tc.commandParameters.commandType&&(Xe=1024);4100===Tc.commandParameters.commandType&&(Xe=4096);let nf=null;if(null===(De=Tc.copyContextSnapshot)||void 0===De?0:De.commandParameters)nf=Tc.copyContextSnapshot.commandParameters.id;Gc.c9d(this.$,D,Xb,ma,Ua,null,uf=>{Gc.Isc(uf,Tc,Sc,Gd,ve,this.$,null,!0,null,null)},uf=>{Tc.serverRequestTimeInMs=Tc.commandParameters.stopwatch.gg-ve;uf=Qc.a.Lh(uf.data);Gd(new Pc(5,uf))},yc,Xe,nf,Tc.commandParameters.id)})}pasteRange(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De,ve){return new Promise((Xe,
nf)=>{const uf=Sc.commandParameters.stopwatch.gg;Gc.R6j(this.$,D,ma,Ua,Xb|-5&yc,rg=>{Gc.Isc(rg,Sc,Xe,nf,uf,this.$,null,!0,De,ve)},rg=>{Sc.serverRequestTimeInMs=Sc.commandParameters.stopwatch.gg-uf;rg=Qc.a.Lh(rg.data);rg=new Pc(5,rg);null===ve||void 0===ve?void 0:ve(rg);nf(rg)},Tc,Gd)})}dJj(D,ma,Ua,Xb,yc,Tc,Sc){return new Promise((Gd,De)=>{if(ma)if(ma.length>this.OQb){var ve=Sc.clipboardItems.getItem(ya.plainText);let Xe=-1;void 0!==ve&&null!==ve&&(Xe=ve.length);z.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${ma.length}, MaxHtmlImportLength: ${this.OQb}, PlainTextLength: ${Xe}`);
De(new Pc(1))}else ve=new eb.a(204,0,(Xe,nf,uf)=>{this.$.PB();const rg=Sc.commandParameters.stopwatch.gg;Xe=Vc.b(Xe,mi=>{Gc.Isc(mi,Sc,Gd,De,rg,this.$,ma,!1,null,null)});nf=Vc.a(nf,mi=>{Sc.serverRequestTimeInMs=Sc.commandParameters.stopwatch.gg-rg;mi=Qc.a.Lh(mi.data);De(new Pc(3,mi))});const $f=this.$.oa.ua.qf(),og=Va.v(D,this.$),bh={};bh.SourceHtml=ma;bh.DestinationRanges=og?Va.s(og):null;bh.CopyOperationId=Ua;bh.PasteId=Xb;bh.AutoAdjustColumnsOn=this.qH();return lc(this.$.oa.Pz,bh,Xe,nf,uf,null,
$f,Tc)},65),this.$.userOperationManager.enqueueOperation(ve,yc);else Gd("")})}qH(){return null==this.DZ?!1:this.DZ.qH}eJj(D,ma,Ua,Xb,yc){return new Promise((Tc,Sc)=>{z.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${yc.id}`);ma&&(ma=Lc.a.trimEnd(ma,"\n","\r"));z.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${yc.id}`);if(ma)if(ma.length>
this.aUf)z.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",ma.length,this.aUf),Sc(new Pc(1));else{let De,ve;const Xe=Va.v(D,this.$);z.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${yc.id}`);var Gd=!this.$.ea.isNamedObjectViewMode&&!ma.includes("\n")&&!ma.includes("\t");z.ULS.sendTraceTag(537167751,0,50,
`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${yc.id}. treatAsLink=${Gd}`);Gd=Gd&&Lc.a.XHf(ma);z.ULS.sendTraceTag(537167750,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${yc.id}. treatAsLink=${Gd}`);const nf=this.$.oa.ua.qf();if(Gd){ve=526;z.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${yc.id}`);const uf=
gc.a.Rtd(ma);z.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${yc.id}`);const rg=Va.s(Xe);Gd=($f,og,bh)=>{const mi=yc.commandParameters.stopwatch.gg;$f=Vc.b($f,ni=>{z.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${yc.id}`);yc.requestTelemetryData=ni.RequestTelemetryData;yc.serverRequestTimeInMs=yc.commandParameters.stopwatch.gg-
mi;ni.Errors&&0<ni.Errors.length?Sc(new Pc(2,ni.Errors)):Tc(ma)});og=Vc.a(og,ni=>{yc.serverRequestTimeInMs=yc.commandParameters.stopwatch.gg-mi;ni=Qc.a.Lh(ni.data);Sc(new Pc(2,ni))});this.$.PB();z.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${yc.id}`);return Ed.b(this.$.oa.ua,rg,ma,uf,!1,!1,63,$f,og,bh,D,nf,Xb)};De=()=>new hf.a(rg,ma,uf)}else ve=180,Gd=(uf,rg,$f)=>{this.$.PB();const og=yc.commandParameters.stopwatch.gg;
uf=Vc.b(uf,bh=>{z.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${yc.id}`);Gc.Isc(bh,yc,Tc,Sc,og,this.$,ma,!1,null,null)});rg=Vc.a(rg,bh=>{yc.serverRequestTimeInMs=yc.commandParameters.stopwatch.gg-og;bh=Qc.a.Lh(bh.data);Sc(new Pc(4,bh))});z.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${yc.id}`);return Kc(this.$.oa.Pz,Xe,ma,
this.qH(),uf,rg,$f,null,nf,Xb)},De=()=>new Ae(Xe,ma);z.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${yc.id}`);Gd=new eb.a(ve,0,Gd,65,De);z.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${yc.id}`);this.$.userOperationManager.enqueueOperation(Gd,Ua)}else Tc("")})}kAf(D,ma){ma=[1===ma?4:5];this.gridView.Se.GG(Id.a.C2a(ze.d(this.$.na),D),
ma,!0);this.gridView.Se.Ys(ma);this.gridView.Se.update(!0)}FDd(){const D=[4,5];this.gridView.Se.Fl(D,!1,!1);this.gridView.Se.lo(null,D,!1);1===this.gridView.ha.Yh&&this.gridView.Ys(!1,!1);this.gridView.Se.update(!1,!1)}xth(D,ma,Ua){const Xb=[];for(const yc of Ua)Xb.push(this.Eth(D,ma,yc));return Xb}P3(){if(this.lA)for(const D of this.lA)if(this.$&&this.$.userOperationManager){if(D.operation){const ma=ud.a(D.operation.operationName);z.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${ma}.`)}this.Luh();
this.$.userOperationManager.XBa(D)}}Luh(){if(this.XWa){const D=this.XWa.My;z.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${D}`);Qc.a.Az(D);!Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.lzc&&Ed.i(this.$.oa.ua,this.lzc,null,null,null);this.lzc=this.XWa=null}}Eth(D,ma,Ua){z.ULS.shipAssertTag(537167713,0,!!ma,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");z.ULS.shipAssertTag(537167712,0,0<ma.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");
let Xb=0,yc=0;var Tc=new Set;const Sc=new Set;for(const Gd of ma){ma=`${Gd.left}_${Gd.right}`;const De=`${Gd.top}_${Gd.bottom}`;Sc.has(ma)||(Sc.add(ma),yc+=Gd.width);Tc.has(De)||(Tc.add(De),Xb+=Gd.height)}if(36===D)return Ua.isSingle?Gc.Wgf(yc,Xb,Ua):Ua.clone();516===D&&(D=Xb,Xb=yc,yc=D);D=!(Ua.width%yc)&&!(Ua.height%Xb);Tc=Ua.LW&&!(Ua.height%Xb);Ua.B6&&!(Ua.width%yc)||Tc?Ua=Gc.Wgf(yc,Xb,Ua):D?Ua=Ua.clone():(Ua=Ua.clone(),Ua.bottom=Math.min(pd.a.oi,Ua.top+Xb-1),Ua.right=Math.min(pd.a.hi,Ua.left+yc-
1));return Ua}zkh(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De,ve,Xe){if(!Xb||!Xb.length)return 1;if(1<Xb.length){if(!this.Lvc&&Tc)return 3;if(ve)return 0;if(Gd)return 9;if(De)return 8;if(Xe)return 2;if(1<ma.length)return 4;const nf=ma[0];if(!Sc&&!jd.a.all(Xb,uf=>uf.isSingle||!(uf.width%nf.width)&&!(uf.height%nf.height)))return 5;if((!this.Lvc||!Tc)&&Lc.a.equals(D,Ua,!0))for(const uf of yc)if(uf.Zf(nf)&&!uf.equals(nf))return 6}else if(ma&&0<ma.length){if(0!==this.mFf(ma,De))return 7;if(1<ma.length){if(!this.Lvc&&Tc)return 3;
if((!this.Lvc||!Tc)&&Lc.a.equals(D,Ua,!0))for(const nf of ma)if(D=yc[0],nf.Zf(D)&&!nf.equals(D))return 6}}return 0}mFf(D,ma){if(!D||1>=D.length)return 0;if(ma)return 2;if(!Va.X(D))return 1;ma=new Oc.a(J.a.Ki());for(const Ua of D)for(const Xb of D){const yc=Ua.top===Xb.top&&Ua.bottom===Xb.bottom,Tc=Ua.left===Xb.left&&Ua.right===Xb.right,Sc=Math.max(Ua.left,Xb.left)<Math.min(Ua.right,Xb.right);if(Math.max(Ua.top,Xb.top)<Math.min(Ua.bottom,Xb.bottom)&&!yc||Sc&&!Tc)return 3;ma.add(`${Ua.top}-${Ua.bottom}-${Xb.left}-${Xb.right}`);
ma.add(`${Xb.top}-${Xb.bottom}-${Ua.left}-${Ua.right}`)}for(const Ua of D)ma.remove(`${Ua.top}-${Ua.bottom}-${Ua.left}-${Ua.right}`);return 0<ma.count?3:0}pPj(D){const ma=this.gridView.ha;ma.updateSelection(D,D.topLeft,0);ma.selectionType=-1}jJb(D){if(null===D||void 0===D?0:D.sourceItem){if(!Ca(D.sourceItem))return null;if((D=D.sourceItem)&&Va.jb(D.ranges,!0))return D}return null}MMb(D,ma){z.ULS.shipAssertTag(537167711,0,!!D,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");
return ma&&id.a.NI in ma||D.tabName?!1:1===D.method}static R6j(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De){const ve=D.oa.ua.qf(De?{wta:!0,ksa:1}:{wta:!1,ksa:0});De=new eb.a(506,0,(Xe,nf,uf)=>{D.PB();var rg=D.oa.ua;Xe=Vc.b(Xe,Tc);nf=Vc.a(nf,Sc);var $f=Gd;$f=void 0===$f?null:$f;const og=rg.Oa(9,ve);og.sourceRanges=Ua;og.destinationRanges=Xb;og.flags=yc;return Ed.h(rg,"PasteRange",og,Xe,nf,uf,null,64,$f)},65,()=>new me(Ua,Xb,yc));D.userOperationManager.enqueueOperation(De,ma)}static Isc(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De,ve){Sc=
void 0===Sc?null:Sc;z.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${ma.id}`);ma.requestTelemetryData=D.RequestTelemetryData;ma.serverRequestTimeInMs=ma.commandParameters.stopwatch.gg-yc;Cb.a.Ai(D.Errors)?Cb.a.Joa(D.Errors)?(ma&&(ma.encounteredDeploymentErrors=!0),D=Cb.a.xf(D.Errors),z.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${D}`)):
(D=new Pc(5,D.Errors),null===ve||void 0===ve?void 0:ve(D),Xb(D)):D.Result?(Xb=!!D&&!!D.RequestTelemetryData,ua.h(Tc).mj.Vja(ma.commandParameters.stopwatch.id,D.StateId,Xb?D.RequestTelemetryData.EcsOperationDuration:0,Xb?D.RequestTelemetryData.EcsRequestDuration:0,Xb?D.RequestTelemetryData.WfeRequestDuration:0),Xb=D.Result,ma.pastedRange=Xb.SheetMultiRange,z.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${ma.id}`),
null===De||void 0===De?void 0:De(),Ua(!0),Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0)&&Gd&&!ma.commandParameters.isDragDrop?(ma=Eb.a.mg(kc.Sc))&&ma.wea(6,D):Pd.a.REa()&&Xb.AutoAdjustedColumns&&void Eb.a.resolve(kc.m,{Aa:1}).then(Xe=>{Xe.iZf("Paste")})):(z.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${ma.id}`),
Ua(Sc||!0))}static c9d(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De,ve,Xe,nf){const uf=D.oa.ua.qf(),rg=Gc.A3e(Ua,Xb,yc,ve,Xe,nf);Ua=new eb.a(503,0,($f,og,bh)=>{D.PB();return zd(D.oa.ua,rg,Vc.b($f,Sc),Vc.a(og,Gd),bh,Tc,uf,De)},65,()=>new Ne(rg));D.userOperationManager.enqueueOperation(Ua,ma)}static A3e(D,ma,Ua,Xb,yc,Tc){const Sc={};Sc.ShadowWorkbookBase64=D.shadowWorkbookBase64;Sc.SourceRanges={};Sc.SourceRanges.Ranges=Array(1);Sc.SourceRanges.Ranges[0]={};Sc.SourceRanges.Ranges[0].FirstRow=D.rangeRowStart;Sc.SourceRanges.Ranges[0].LastRow=
D.rangeRowEnd;Sc.SourceRanges.Ranges[0].FirstColumn=D.rangeColumnStart;Sc.SourceRanges.Ranges[0].LastColumn=D.rangeColumnEnd;Tb.EwaSettings.getBooleanFeatureGate(bc.a.$Db,!1)?Ua?Sc.DestinationRanges=Va.u(Ua.SheetName,Ua.NamedObjectName,Va.g(Ua.Ranges)):(z.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Sc.DestinationRanges=null):Sc.DestinationRanges=ma?Va.s(ma):null;Sc.CopyPasteTargetType=1;Sc.PasteType=Xb;Sc.CopyOperationId=yc;Sc.PasteId=
Tc;Sc.SourceClientPath=D.sourceClientPath;Sc.SourceSheetName=D.sourceSheetName;Sc.SourceWorkbookName=D.sourceWorkbookName;if(!D.originalSourceRangesCountExceedsLimit&&D.originalSourceRanges&&0<D.originalSourceRanges.length&&1024===Xb){Sc.OriginalSourceMultiRange={};ma=Array(D.originalSourceRanges.length);for(Ua=0;Ua<ma.length;++Ua)ma[Ua]={},ma[Ua].FirstRow=D.originalSourceRanges[Ua][0],ma[Ua].FirstColumn=D.originalSourceRanges[Ua][1],ma[Ua].LastRow=D.originalSourceRanges[Ua][2],ma[Ua].LastColumn=
D.originalSourceRanges[Ua][3];Sc.OriginalSourceMultiRange.Ranges=ma}return Sc}static Wgf(D,ma,Ua){Ua=Ua.clone();Ua.height<ma&&(Ua.bottom=Math.min(pd.a.oi,Ua.top+ma-1));Ua.width<D&&(Ua.right=Math.min(pd.a.hi,Ua.left+D-1));return Ua}Xhk(D,ma,Ua){return(D=ua.h(D).Je.gj(Ua))?ma.width===D.usedRange.width&&Ua.left===D.usedRange.left||Ua.left===D.usedRange.left&&Ua.right===D.usedRange.right&&0===Ua.width%ma.width:!1}Whk(D,ma,Ua){return(D=ua.h(D).Je.gj(Ua))?ma.height===D.usedRange.height&&Ua.top===D.usedRange.top||
Ua.top===D.usedRange.top&&Ua.bottom===D.usedRange.bottom&&0===Ua.height%ma.height:!1}executeInsertCopiedCutCellsOperation(D,ma,Ua,Xb,yc,Tc,Sc){Tc=void 0===Tc?null:Tc;Sc=void 0===Sc?null:Sc;const Gd={};Gd.InsertDirection=Xb;Gd.SourceRange=D;Gd.DestRange=ma;Gd.CopyCutOperation=Ua?0:1;const De=this.$.oa.ua,ve=this.$.oa.ua.qf(),Xe=()=>new be(Gd);return Vb.a(this.$.userOperationManager,(nf,uf,rg)=>{nf=Tc?Vc.b(nf,Tc):nf;uf=Sc?Vc.a(uf,Sc):uf;const $f=De.Oa(41,null);$f.insertCopiedCutCellsParameters=Gd;return Ed.h(De,
"InsertCopiedCutCellsV2",$f,nf,uf,rg,ve,0)},nf=>new eb.a(104,0,nf,void 0,Xe),yc)}uUh(D,ma,Ua,Xb,yc,Tc,Sc,Gd){return new Promise((De,ve)=>{this.executeInsertCopiedCutCellsOperation(ma,Ua,Xb,yc,Tc,Xe=>{D.requestTelemetryData=Xe.RequestTelemetryData;if(Xe.Errors&&0<Xe.Errors.length){const nf=new Pc(21,Xe.Errors);null===Gd||void 0===Gd?void 0:Gd(nf);ve(new Pc(21,Xe.Errors))}else null===Sc||void 0===Sc?void 0:Sc(),De(!0)},Xe=>{Xe=Qc.a.Lh(Xe.data);Xe=new Pc(21,Xe);null===Gd||void 0===Gd?void 0:Gd(Xe);ve(Xe)})})}executeInsertCopiedCutCellsAcrossSession(D,
ma,Ua,Xb,yc,Tc,Sc,Gd,De,ve,Xe){Tc=void 0===Tc?null:Tc;Sc=void 0===Sc?null:Sc;const nf={};nf.PasteParameters=Gc.A3e(ve,Gd,De,2,Xe.copyContextSnapshot.commandParameters.id,Xe.commandParameters.id);nf.InsertDirection=Xb;nf.SourceRange=D;nf.DestRange=ma;nf.CopyCutOperation=Ua?0:1;const uf=this.$.oa.ua,rg=this.$.oa.ua.qf(),$f=()=>new be(nf);return Vb.a(this.$.userOperationManager,(og,bh,mi)=>{og=Tc?Vc.b(og,Tc):og;bh=Sc?Vc.a(bh,Sc):bh;const ni=uf.Oa(41,null);ni.insertCopiedCutCellsParameters=nf;return Ed.h(uf,
"InsertCopiedCutCellsCrossSession",ni,og,bh,mi,rg,0)},og=>new eb.a(106,0,og,void 0,$f),yc)}}Object(w.a)(Gc,"CopyPasteUtils",null,[717]);var Bb=a(457),uc;(function(D){D[D.range=0]="range";D[D.art=1]="art";D[D.nonGrid=2]="nonGrid"})(uc||(uc={}));Object(w.b)("SourceItemType",uc);var Dc=a(91);class kd{constructor(D){this.fDg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1,["SourceItemType.NonGrid"]:2};this.npb={};this.bDg={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,
["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.Sdd={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",
["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.eDg={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686,["RibbonCommand.WriteToClipboard"]:396830482};this.b7d={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut",["396830482"]:"RibbonCommand.WriteToClipboard"};this.dDg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,
["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.hsa={};this.cDg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.Fcb={};this.gDg={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,
["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.ow={};this.$=D;this.hsa.notDefined=
"InputManager.InputMethod.NotDefined";this.hsa.unknown="InputManager.InputMethod.Unknown";this.hsa.keyboard="InputManager.InputMethod.Keyboard";this.hsa.mouse="InputManager.InputMethod.Mouse";this.hsa.touch="InputManager.InputMethod.Touch";this.hsa.crossSlide="InputManager.InputMethod.CrossSlide";this.Fcb.none="FrameMode.None";this.Fcb.reading="FrameMode.Reading";this.Fcb.edit="FrameMode.Edit";this.ow.unknown="UILocation.Unknown";this.ow.upperRibbon="UILocation.UpperRibbon";this.ow.ribbon="UILocation.Ribbon";
this.ow.QAT="UILocation.QAT";this.ow.jewel="UILocation.Jewel";this.ow.navigationPane="UILocation.NavigationPane";this.ow.keyboardShortcut="UILocation.KeyboardShortcut";this.ow.statusBar="UILocation.StatusBar";this.ow.dialog="UILocation.Dialog";this.ow.floatie="UILocation.Floatie";this.ow.notificationBar="UILocation.NotificationBar";this.ow.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.ow.taskPane="UILocation.TaskPane";this.ow.heroDock="UILocation.HeroDock";this.ow.singleLineRibbon="UILocation.SingleLineRibbon";
this.ow.multilineRibbon="UILocation.MultilineRibbon";this.ow.overflow="UILocation.Overflow";this.ow.tellMe="UILocation.TellMe";this.ow.farPeripheralControls="UILocation.FarPeripheralControls";this.ow.header="UILocation.Header";this.ow.fileMenu="UILocation.FileMenu";this.ow.contextMenu="UILocation.ContextMenu";this.ow.dialogMenu="UILocation.DialogMenu";this.ow.toolbar="UILocation.Toolbar";this.ow.canvas="UILocation.Canvas";this.npb.range="SourceItemType.Range";this.npb.art="SourceItemType.Art";this.npb.nonGrid=
"SourceItemType.NonGrid"}serializeSourceItem(D){const ma={};if(D&&Object.getType(D)===Db)ma.sheetName=D.sheetName,ma.topArray=jd.a.map(D.ranges,Ua=>Ua.top),ma.leftArray=jd.a.map(D.ranges,Ua=>Ua.left),ma.bottomArray=jd.a.map(D.ranges,Ua=>Ua.bottom),ma.rightArray=jd.a.map(D.ranges,Ua=>Ua.right),ma.sessionStateId=D.sessionStateId,ma.sessionId=D.sessionId,ma.sourceItemType=this.l9d(0);else if(D&&Object.getType(D)===qc)ma.activeFloatingObjectControlId=D.activeFloatingObjectControlId,ma.sheetName=D.sheetName,
ma.sessionStateId=D.sessionStateId,ma.sessionId=D.sessionId,ma.floatingObjectType=this.v7j(D.type),ma.sourceItemType=this.l9d(1);else if(D&&Object.getType(D)===Ta)ma.sessionStateId=D.sessionStateId,ma.sessionId=D.sessionId,ma.sourceItemType=this.l9d(2);else return z.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(ma)}serializeCommandParameters(D){if(!D)return z.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),
null;const ma={};ma.id=D.id;ma.commandType=D.commandType;ma.copyPasteTargetType=D.copyPasteTargetType;D.ribbonCommandInfo&&(ma.ribbonCommandName=this.F7j(D.ribbonCommandInfo.command),ma.inputMethodName=this.z7j(D.ribbonCommandInfo.method),ma.frameModeName=this.x7j(D.ribbonCommandInfo.mode),ma.uiLocationName=this.J7j(D.ribbonCommandInfo.Ch),ma.tabName=D.ribbonCommandInfo.tabName);return JSON.stringify(ma)}deserializeSourceItem(D){if(!D)return null;try{const ma=JSON.parse(D);if(!ma)return z.ULS.shipAssertTag(537167703,
0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let Ua=null;switch(this.XPh(ma.sourceItemType)){case 0:Ua=new Db(this.$,this.UPh(ma),ma.sheetName,ma.sessionStateId,ma.sessionId);break;case 1:Ua=new qc(ma.activeFloatingObjectControlId,ma.sheetName,ma.sessionStateId,ma.sessionId,this.RPh(ma.floatingObjectType));break;case 2:Ua=new Ta(ma.sessionStateId,ma.sessionId)}return Ua}catch(ma){return z.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${D?
D.length:0}, errror: ${ma}`),null}}deserializeCommandParameters(D){if(!D)return null;try{const ma=JSON.parse(D);if(!ma)return z.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const Ua=ld.a();Ua.id=ma.id;Ua.ribbonCommandInfo=this.WPh(ma);Ua.commandType=ma.commandType;Ua.copyPasteTargetType=ma.copyPasteTargetType;return Ua}catch(ma){return z.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${D?
D.length:0}, errror: ${ma}`),null}}UPh(D){const ma=[];z.ULS.shipAssertTag(537167699,0,!!D.topArray&&0<D.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${D.topArray?"empty":"null"}.`);z.ULS.shipAssertTag(537167698,0,!!D.leftArray&&0<D.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${D.leftArray?"empty":"null"}.`);z.ULS.shipAssertTag(537167697,0,!!D.bottomArray&&0<D.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${D.bottomArray?
"empty":"null"}.`);z.ULS.shipAssertTag(537167696,0,!!D.rightArray&&0<D.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${D.rightArray?"empty":"null"}.`);if(!(D.topArray&&D.leftArray&&D.bottomArray&&D.rightArray))return ma;z.ULS.shipAssertTag(537167695,0,D.topArray.length===D.bottomArray.length&&D.topArray.length===D.leftArray.length&&D.topArray.length===D.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${D.topArray.length}), BottomArray(${D.bottomArray.length}), LeftArray(${D.leftArray.length}), RightArray(${D.rightArray.length}) should be the same.`);
const Ua=Math.min(D.topArray.length,D.bottomArray.length,D.leftArray.length,D.rightArray.length);for(let Xb=0;Xb<Ua;Xb++)ma.push(new xb.Range(D.topArray[Xb],D.leftArray[Xb],D.bottomArray[Xb],D.rightArray[Xb],!1,!1));return ma}WPh(D){return new Dc.a(this.VPh(D.ribbonCommandName),this.TPh(D.inputMethodName),this.SPh(D.frameModeName),this.ZPh(D.uiLocationName),D.tabName)}F7j(D){return void 0!==D&&null!==D&&D.toString()in this.b7d?this.b7d[D.toString()]:(z.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${D}`),
this.b7d["-911352779"])}VPh(D){return D&&D in this.eDg?this.eDg[D]:(z.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${D}`),-911352779)}z7j(D){return void 0!==D&&null!==D&&qb.a[D]in this.hsa?this.hsa[qb.a[D]]:(z.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${D}`),this.hsa.unknown)}TPh(D){return D&&
D in this.dDg?this.dDg[D]:(z.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${D}`),0)}x7j(D){return void 0!==D&&null!==D&&Bb.a[D]in this.Fcb?this.Fcb[Bb.a[D]]:(z.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${D}`),this.Fcb.edit)}SPh(D){return D&&D in this.cDg?this.cDg[D]:(z.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${D}`),
2)}l9d(D){return void 0!==D&&null!==D&&uc[D]in this.npb?this.npb[uc[D]]:(z.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${D}`),this.npb.range)}XPh(D){return D&&D in this.fDg?this.fDg[D]:(z.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${D}`),0)}v7j(D){return void 0!==D&&null!==D&&D.toString()in this.Sdd?this.Sdd[D.toString()]:(z.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${D}`),
this.Sdd["99"])}RPh(D){return D&&D in this.bDg?this.bDg[D]:(z.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${D}`),99)}J7j(D){return void 0!==D&&null!==D&&ab.a[D]in this.ow?this.ow[ab.a[D]]:(z.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${D}`),this.ow.ribbon)}ZPh(D){return D&&D in this.gDg?this.gDg[D]:(z.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${D}`),
2)}}Object(w.a)(kd,"EnvironmentSerializationHelper",null,[]);class xd{}xd.dqg="SameSession";xd.vmd="CrossSession";xd.xOf="LegacyCrossSession";xd.external="External";Object(w.a)(xd,"PayloadOrigin",null,[]);const Pb=D=>D?D.shadowWorkbookSizeExceedsLimit&&void 0!==D.shadowWorkbookBlockedSize&&null!==D.shadowWorkbookBlockedSize?D.shadowWorkbookBlockedSize:D.shadowWorkbookBase64?D.shadowWorkbookBase64.length:0:0,Ec=D=>D.shadowWorkbookSizeExceedsLimit?!0:Pb(D)>pd.a.tBc;var ed=a(66),Td=a(169),Rd=a(102);
class Ke{constructor(D,ma,Ua){Ua=void 0===Ua?null:Ua;this.hPa=!1;this._name=ma;this.$=D;this.mo=ad.a.instance;this.Lv=new Gc(D,ua.h(D));this.fic=Ua}get name(){return this._name}get Vdd(){return this.mo.za(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}Mzk(D){let ma;ma=null;try{const Ua=D.getItem(ya.shadowWorkbook);if(!Ua)return{returnValue:!1,s2:ma};ma=JSON.parse(Ua);return{returnValue:this.r3i(ma),s2:ma}}catch(Ua){return z.ULS.sendTraceTag(537167835,
0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Ua),{returnValue:!1,s2:ma}}}r3i(D){return!!D&&(!!D.shadowWorkbookBase64||D.shadowWorkbookSizeExceedsLimit)&&void 0!==D.rangeRowStart&&void 0!==D.rangeRowEnd&&void 0!==D.rangeColumnStart&&void 0!==D.rangeColumnEnd}YFc(D){D.wasLastCopyExternal=!0;Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&D.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(D.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.Qjc?20:4);if(bc.a.oVa&&516!==D.commandParameters.commandType&&1028!==D.commandParameters.commandType){let ma=null;if((()=>{let Ua=this.Mzk(D.clipboardItems);({s2:ma}=Ua);return Ua})().returnValue)return D.isShadowWorkbookParsedSuccessfully=!0,this.rDj(D,ma)}if(516!==D.commandParameters.commandType&&36!==D.commandParameters.commandType&&4100!==D.commandParameters.commandType){if(20!==D.commandParameters.commandType){const ma=D.clipboardItems.getItem(ya.html),
Ua=!(void 0===ma||null===ma)&&!!ma&&ma.trim()!==this.Vdd&&(ma.startsWith("<")||za.a.hj&&ma.startsWith("\n<")),Xb=D.clipboardItems.getItem(ya.Lkd),yc=Td.f(D.clipboardItems.getItem(ya.plainText));return!Ua||!Xb&&yc?(yc&&z.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.wYd(D)):this.pDj(D,ma,void 0===Xb?null:Xb)}return this.wYd(D)}return Promise.reject(new Pc(6))}rDj(D,ma){z.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");
D.pasteResult="SystemClipboardShadowWorkbookPaste";D.payloadType=oc.shadowWorkbook;D.payloadOrigin=xd.external;D.shadowWorkbookPayloadSize=Pb(ma);D.shadowWorkbookSizeExceedsLimit=Ec(ma);let Ua=null,Xb=null;const yc=D.commandParameters.originalDestinations;Tb.EwaSettings.getBooleanFeatureGate(bc.a.$Db,!1)?Ua=Va.r(yc,this.$):Xb=Va.v(Va.P(yc),this.$);ma.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(D.originalSourceRangesCountExceedsLimit=ma.originalSourceRangesCountExceedsLimit);if(D.shadowWorkbookSizeExceedsLimit)return z.ULS.sendTraceTag(537167833,
0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${D.shadowWorkbookPayloadSize}) is over the limit(${pd.a.tBc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ma.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Pc(1));z.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${D.commandParameters.id}`);return this.Lv.R$f(D.commandParameters.ribbonCommandInfo,Xb,Ua,ma,[D.commandParameters.stopwatch],
D)}wYd(D){var ma=D.clipboardItems.getItem(ya.plainText);if(void 0!==ma&&null!==ma&&ma.trim()===this.Vdd)return Promise.reject(new Pc(7));void 0!==ma&&null!==ma&&(D.plainTextPayloadSize=ma.length);let Ua=!1;null!==this.fic&&(Ua=this.fic.$lh(D,Lc.a.trimEnd(ma,"\n","\r"),Va.P(D.commandParameters.originalDestinations)));Ua&&ua.h(this.$).mj.nU(D.commandParameters.stopwatch.id,ed.BasicTelemetryCalculator.KS);this.hPa||(this.hPa=!0,Rd.b("AutoAdjustColumnWidthTriggered"));D.isPlainTextPaste=!0;D.pasteResult=
"SystemClipboardPaste";D.payloadOrigin=Ib(D)?xd.xOf:xd.external;D.payloadType=oc.plainText;z.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${D.id}, PasteOperationId=${D.commandParameters.id}`);ma=this.Lv.eJj(Va.P(D.commandParameters.originalDestinations),ma,D.commandParameters.ribbonCommandInfo,[D.commandParameters.stopwatch],D);z.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${D.id}`);
return ma}pDj(D,ma,Ua){this.hPa||(this.hPa=!0,Rd.b("AutoAdjustColumnWidthTriggered"));D.htmlPayloadSize=ma.length;D.isHtmlPaste=!0;D.pasteResult="SystemClipboardHtmlPaste";D.payloadType=oc.html;D.payloadOrigin=Ib(D)?xd.xOf:xd.external;D.cseStatus=3;z.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${D.commandParameters.id}`);return this.Lv.dJj(Va.P(D.commandParameters.originalDestinations),ma,Ua,D.commandParameters.id,D.commandParameters.ribbonCommandInfo,
[D.commandParameters.stopwatch],D)}T3e(D){const ma={};D&&(ma.shadowWorkbookBase64=D.ShadowWorkbookBase64,ma.shadowWorkbookSizeExceedsLimit=D.ShadowWorkbookSizeExceedsLimit,ma.originalSourceRangesCountExceedsLimit=D.OriginalSourceRangesCountExceedsLimit,ma.originalSourceRangesCount=D.OriginalSourceRangesCount,ma.shadowWorkbookBlockedSize=D.ShadowWorkbookBlockedSize);return ma}CNg(D,ma){const Ua=Pa(D),Xb=32===(D.commandParameters.commandType&32),yc=1024===(D.commandParameters.commandType&1024);let Tc=
!1,Sc=null,Gd=null,De=!1;if(!Ua){Tc=-1985798686===D.commandParameters.ribbonCommandInfo.command;var ve=D.copyContextSnapshot;if(ma)De=!ve.sourceItem.isFromCurrentSession(this.$);else if(ve=this.Lv.jJb(ve))Sc=ve.ranges,Gd=ve.sheetName,De=!D.isSameSession}return this.Lv.zkh(Gd,Sc,this.$.na.sheetName,D.commandParameters.originalDestinations,D.commandParameters.expandDestinations,De,Xb,yc,Tc,ma,Ua)}}Object(w.a)(Ke,"BaseCopyPasteHandler",null,[957,739,958]);class $d{constructor(D){this.clipboardItems=
this.key=null;this.z4=D}lia(D){return this.key&&this.key.isEqual(D)?this.createClipboardItems(this.clipboardItems):null}setValue(D,ma){this.key=D;this.clipboardItems=this.createClipboardItems(ma)}createClipboardItems(D){const ma=this.z4.create();var Ua=D.getItem(ya.plainText);Ua&&ma.setItem(ya.plainText,Ua);(Ua=D.getItem(ya.shadowWorkbook))&&ma.setItem(ya.shadowWorkbook,Ua);(D=D.getItem(ya.html))&&ma.setItem(ya.html,D);return ma}}Object(w.a)($d,"CopyCache",null,[]);class we extends Ke{constructor(D,
ma,Ua,Xb,yc){yc=void 0===yc?null:yc;super(D,Xb,ma);this.fic=ma;this.z4=Ua;this.Kkd=yc||new $d(this.z4);this.gridView=ua.h(D);this.ha=this.gridView.ha;this.clipboardRangeFactory=D.ja.Qa(169)}getSourceItem(){const D=Va.d(this.gridView.ha.pa.selectedRanges);return new Db(this.$,D,this.$.ea.na.sheetName,this.$.ea.uh,this.$.xa.UserSessionId)}beforeSerialize(D){D.isSelectionAllowed=!1;D.isAsyncCopy=!1;D.isFromCache=!1;D.encounteredDeploymentErrors=!1;D.plainTextPayloadSize=0;D.shadowWorkbookPayloadSize=
0;D.htmlPayloadSize=0;D.clientSideCopyTime=0;const ma=new ke.a(this.$.sa),Ua=D.sourceItem;D.isSelectionAllowed=jd.a.all(Ua.ranges,Xb=>this.isSelectionAllowed(ma,Xb));D.isSelectionAllowed&&this.Lv.kAf(Ua.ranges,D.commandParameters.commandType)}hWa(D){return this.gridView.ya.w0()&&ua.j(this.gridView,D)}SDj(D,ma,Ua,Xb){let yc=!1;const Tc=1===ma.commandParameters.commandType,Sc=Xb[0].Gv;1===Ua.ranges.length&&1===Xb.length?Tc&&1!==Sc&&Sc!==Ua.ranges[0].Gv?D.cseStatus=17:yc=this.fic.Qod(D,Va.P(Ua.ranges),
Ua.sheetName,Va.P(D.commandParameters.expandDestinations),this.$.ea.na.sheetName,Tc):D.cseStatus=5;yc&&ua.h(this.$).mj.nU(D.commandParameters.stopwatch.id,ed.BasicTelemetryCalculator.KS);return this.yDj(D,Ua,Va.u(this.$.na.sheetName,null,Xb),ma.commandParameters.commandType,yc)}isSelectionAllowed(D,ma){return D.hOb(ma,this.gridView)}yDj(D,ma,Ua,Xb,yc){ma=Va.u(ma.sheetName,null,ma.ranges);D.pasteResult="SameSessionPaste";D.payloadOrigin=xd.dqg;D.payloadType=oc.p9g;z.ULS.sendTraceTag(537167829,0,50,
`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${D.commandParameters.id}`);return this.Lv.pasteRange(D.commandParameters.ribbonCommandInfo,ma,Ua,Xb,D.commandParameters.commandType,[D.commandParameters.stopwatch],D,yc,null,null)}}Object(w.a)(we,"BaseRangeCopyPasteHandler",Ke,[]);var bf=a(42);class $e{constructor(D){this.q_=new bf.a(!0);this.$=D}onDeferredPasteStarted(D){this.q_.$d(D.id)||this.q_.add(D.id,!0);if(0<this.q_.count){const ma=Object(ub.d)(Eb.a.resolve(kc.s,
{Aa:0}));ne.TaskExtensions.Ca(ma,()=>{ma.result.Uj(28,null)},this.$.qa,3)}}onDeferredPasteCompleted(D){const ma=0<this.q_.count;this.q_.$d(D.id)&&this.q_.remove(D.id);if(ma&&!this.q_.count){const Ua=Object(ub.d)(Eb.a.resolve(kc.s,{Aa:0}));ne.TaskExtensions.Ca(Ua,()=>{Ua.result.removeEntry(28)},this.$.qa,3)}}}Object(w.a)($e,"DeferredPasteTracker",null,[]);var $a;(function(D){D[D.none=0]="none";D[D.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";D[D.loadCopiedDataFromServerFailed=2]=
"loadCopiedDataFromServerFailed";D[D.asyncCopyCanceled=3]="asyncCopyCanceled";D[D.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})($a||($a={}));Object(w.b)("CopyErrorType",$a);class Ia extends df{constructor(D,ma){ma=void 0===ma?null:ma;super($a[D]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=D;this.ewaErrors=ma;if(null===ma||void 0===ma?0:ma.length)this.innerError=new Af(ma,null)}}Object(w.a)(Ia,"CopyInnerError",df,[]);var gb=a(138);class Nb extends we{constructor(D,
ma,Ua,Xb){super(D,ma,Ua,"AcrossSessionRangeCopyPasteHandler",void 0===Xb?null:Xb);this.q_=new $e(D)}serialize(D){const ma=D.sourceItem,Ua={};let Xb=this.Kkd.lia(ma);if(Xb)Ua.synchronousResult=Xb,D.isFromCache=!0,D.clientSideCopyTime=D.commandParameters.stopwatch.gg;else{let Tc=null;var yc=Va.I(ma.ranges);if(!Pd.a.oHf()&&this.hWa(yc)){z.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");yc=this.clipboardRangeFactory.create(yc);
try{Tc=yc.toString(),Xb=this.z4.create(),Xb.setItem(ya.plainText,Tc),this.Kkd.setValue(ma,Xb),Ua.synchronousResult=Xb,D.clientSideCopyTime=D.commandParameters.stopwatch.gg}finally{yc&&yc.dispose()}}else D.isAsyncCopy=!0,Ua.synchronousResult=this.z4.create(),Ua.synchronousResult.setItem(ya.plainText,this.Vdd);Ua.asynchronousResult=this.Zwd(D,ma,Tc)}D.syncClipboardItemsKeys=ge(Ua.synchronousResult);return Ua}shouldWaitForCopyToComplete(D){if(!D||!D.copyContextSnapshot)return z.ULS.sendTraceTag(537167907,
0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;z.ULS.shipAssertTag(537167906,0,!!this.$.xa,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(D.copyContextSnapshot.sessionId===this.$.xa.UserSessionId)return z.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),
!1;z.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(D){this.q_.onDeferredPasteStarted(D)}onDeferredPasteCompleted(D){this.q_.onDeferredPasteCompleted(D)}deserialize(D){var ma;D.isClipboardDataContainShadowWorkbook=!(void 0===D.clipboardItems.getItem(ya.shadowWorkbook)||null===D.clipboardItems.getItem(ya.shadowWorkbook));if(ua.h(this.$).ha.Yh&326)return Pa(D)&&(D.wasLastCopyExternal=!0),Promise.reject(new Pc(17));
var Ua=this.CNg(D,!1);if(0!==Ua)return Promise.reject(new Pc(Pa(D)?18:D.isSameSession?19:20,void 0,void 0,void 0,Ua));Ua=D.copyContextSnapshot;var Xb=this.Lv.jJb(Ua);if(Pa(D)||bc.a.uNb&&(null===(ma=D.copyContextSnapshot)||void 0===ma?0:ma.sourceItem)&&cb(D.copyContextSnapshot.sourceItem))return this.YFc(D);ma=D.commandParameters.originalDestinations;if(Xb&&D.isSameSession)return this.SDj(D,Ua,Xb,ma);if(516!==D.commandParameters.commandType){let yc=null;if((()=>{let Tc=this.lIg(D.clipboardItems);({s2:yc}=
Tc);return Tc})().returnValue)return D.isShadowWorkbookParsedSuccessfully=!0,Xb=Ua=null,Tb.EwaSettings.getBooleanFeatureGate(bc.a.$Db,!1)?Ua=Va.r(ma,this.$):Xb=Va.v(Va.P(ma),this.$),this.nDj(D,Xb,Ua,yc);if(D.isClipboardInaccessible)return Promise.reject(new Pc(8));if(36!==D.commandParameters.commandType)return this.wYd(D)}return Promise.reject(new Pc(6))}beforePaste(D){this.$.ja.Qa(373).h4j(D);D.indicationDisplayScheduled=!0}bzk(D){let ma;if(!(D&&D.SourceRanges&&D.SourceRanges.Ranges&&D.SourceRanges.Ranges.length&&
(D.OriginalSourceRangesCountExceedsLimit||D.OriginalSourceMultiRange&&D.OriginalSourceMultiRange.Ranges&&D.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,s2:null};var Ua=D.SourceRanges.Ranges[0];if(!D.ShadowWorkbookBase64&&!D.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,s2:null};ma=this.T3e(D);ma.rangeRowStart=Ua.FirstRow;ma.rangeRowEnd=Ua.LastRow;ma.rangeColumnStart=Ua.FirstColumn;ma.rangeColumnEnd=Ua.LastColumn;ma.sourceClientPath=D.SourceClientPath;ma.sourceSheetName=D.SourceSheetName;
ma.sourceWorkbookName=D.SourceWorkbookName;if(!D.OriginalSourceRangesCountExceedsLimit)for(D=D.OriginalSourceMultiRange.Ranges,ma.originalSourceRanges=Array(D.length),Ua=0;Ua<D.length;++Ua)ma.originalSourceRanges[Ua]=[D[Ua].FirstRow,D[Ua].FirstColumn,D[Ua].LastRow,D[Ua].LastColumn];return{returnValue:!0,s2:ma}}lIg(D){let ma;ma=null;D=D.getItem(ya.shadowWorkbook);if(!D)return{returnValue:!1,s2:ma};ma=JSON.parse(D);return{returnValue:this.q3i(ma),s2:ma}}q3i(D){return!!D&&(!!D.shadowWorkbookBase64||
D.shadowWorkbookSizeExceedsLimit)&&void 0!==D.rangeRowStart&&void 0!==D.rangeRowEnd&&void 0!==D.rangeColumnStart&&void 0!==D.rangeColumnEnd}nDj(D,ma,Ua,Xb){z.ULS.shipAssertTag(537167903,0,!!Xb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");D.pasteResult="CrossSessionPaste";D.payloadOrigin=xd.vmd;D.payloadType=oc.shadowWorkbook;D.shadowWorkbookPayloadSize=Pb(Xb);D.shadowWorkbookSizeExceedsLimit=Ec(Xb);D.cseStatus=3;Xb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&
(D.originalSourceRangesCountExceedsLimit=Xb.originalSourceRangesCountExceedsLimit);if(D.shadowWorkbookSizeExceedsLimit)return z.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${D.shadowWorkbookPayloadSize}) is over the limit(${pd.a.tBc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Xb.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Pc(1));if(1028===D.commandParameters.commandType&&D.originalSourceRangesCountExceedsLimit)return z.ULS.sendTraceTag(572617859,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${Xb.originalSourceRangesCount}) is over the limit(${pd.a.Edj}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${Xb.originalSourceRangesCountExceedsLimit}`),Promise.reject(new Pc(1));z.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${D.commandParameters.id}`);return this.Lv.R$f(D.commandParameters.ribbonCommandInfo,
ma,Ua,Xb,[D.commandParameters.stopwatch],D)}Zwd(D,ma,Ua){z.ULS.shipAssertTag(537167901,0,!!D,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const Xb=D.commandParameters.stopwatch.gg,yc=Va.u(ma.sheetName,null,ma.ranges);return new Promise((Tc,Sc)=>{z.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${D.id}`);this.Lv.copy(yc,D.commandParameters,Gd=>
{D.requestTelemetryData=Gd.RequestTelemetryData;D.serverRequestTimeInMs=D.commandParameters.stopwatch.gg-Xb;if(Cb.a.Ai(Gd.Errors))if(Cb.a.Joa(Gd.Errors))D.encounteredDeploymentErrors=!0,Gd=Cb.a.xf(Gd.Errors),z.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Gd}. copy Id: ${D.id}`);else{var De=Cb.a.xf(Gd.Errors);if(Cb.a.yk(Gd.Errors,[-591377245])){var ve=this.Zz(yc);
if(ve){ve=String.format(this.mo.He(218),ve.toLocaleUpperCase());var Xe=gb.d(Gd.Errors,rg=>-591377245===rg.MessageId);Gd.Errors[Xe].Description=ve;z.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${D.id}`)}}z.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}. copy Id: ${D.id}`);Sc(new Ia(2,Gd.Errors))}else if(z.ULS.sendTraceTag(537167900,
0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${D.id}`),D.markForCancellation)Sc(new Ia(3,Gd.Errors));else{var nf=Gd.Result;ve=nf.PlainTextResult;void 0!==Ua&&null!==Ua&&(ve=Ua);void 0!==ve&&null!==ve&&(D.plainTextPayloadSize=ve.length);De=this.z4.create();var uf;(()=>{let rg=this.bzk(nf);({s2:uf}=rg);return rg})().returnValue&&(D.shadowWorkbookPayloadSize=Pb(uf),D.shadowWorkbookSizeExceedsLimit=Ec(uf),D.originalSourceRangesCountExceedsLimit=
nf.OriginalSourceRangesCountExceedsLimit,Xe=JSON.stringify(uf),De.setItem(ya.shadowWorkbook,Xe));De.setItem(ya.plainText,ve);Pd.a.oHf()&&(ve=nf.HtmlResult,D.htmlSizeExceedsLimit=nf.HtmlSizeExceedsLimit,void 0!==ve&&null!==ve&&(D.htmlPayloadSize=ve.length),De.setItem(ya.html,ve));D.copyTotalSizeExceedsLimit=nf.CopyTotalSizeExceedsLimit;De.setItem(ya.Lkd,D.commandParameters.id);this.Kkd.setValue(ma,De);D.asyncClipboardItemsKeys=ge(De);Tc(De);Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&(De=1===D.commandParameters.commandType?8:7,(ve=Eb.a.mg(kc.Sc))&&ve.wea(De,Gd))}},Gd=>{D.serverRequestTimeInMs=D.commandParameters.stopwatch.gg-Xb;Gd=Qc.a.Lh(Gd.data);const De=Cb.a.xf(Gd);z.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}. copy Id: ${D.id}`);Sc(new Ia(2,Gd))},[D.commandParameters.stopwatch])})}Zz(D){return null==D||null==D.Ranges||0===D.Ranges.length?(z.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),
null):(1===D.Ranges.length?Va.D(D.Ranges[0]):Va.I(Va.g(D.Ranges))).toString()}}Object(w.a)(Nb,"AcrossSessionRangeCopyPasteHandler",we,[]);var ec=a(1095);class Bc{constructor(D,ma,Ua,Xb,yc,Tc,Sc){this.floatingObjectId=D;this.commandParameters=ma;this.gL=Ua;this.ZMh=Xb;this.Aqa=void 0===Tc?null:Tc;this.ike=void 0===Sc?null:Sc;this.xEh=yc}}Object(w.a)(Bc,"CopyArtRequest",null,[]);class Wc{constructor(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De){this.promise=null;this.ribbonCommandInfo=D;this.destination=ma;this.G6e=Ua;
this.ike=yc;this.s2=Tc;this.item=Sc;this.pasteContext=Gd;this.yXa=Ua||ma.FirstRow+"_"+ma.FirstColumn;this.OHf=!0;this.QYe=De}}Object(w.a)(Wc,"PasteArtRequest",null,[]);class od{constructor(D,ma){this.ZWb=new fa.a;this.O8a=D;this.$=ma;this.IJj=Ua=>Promise.resolve(Ua);this.USb=Ua=>Promise.reject(Ua)}VFi(D){if(this.SZi(D.yXa)){z.ULS.sendTraceTag(537167681,5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${D.yXa}`);const ma=this.ZWb.ka(D.yXa);
this.ZWb.da(D.yXa,D);const Ua=ma.promise;ma.OHf=!1;return this.CXh(D,Ua)}this.ZWb.da(D.yXa,D);return this.q6i(D)}SZi(D){return this.ZWb.$d(D)}q6i(D){return new Promise((ma,Ua)=>{D.promise=this.O8a.N$f(D).then(Xb=>{ma(null);return this.BEc(D,Xb)},Xb=>{Ua(null);return this.USb(Xb)})})}CXh(D,ma){return new Promise((Ua,Xb)=>{D.promise=ma.then(yc=>{this.pFk(D,yc);return this.O8a.N$f(D).then(Tc=>{Ua(null);return this.BEc(D,Tc)},Tc=>{Xb(null);return this.USb(Tc)})},yc=>this.USb(yc))})}BEc(D,ma){D.OHf&&(this.byh(D.yXa),
this.G8d(D,ma));return this.IJj(ma)}byh(D){this.ZWb.remove(D)}G8d(D,ma){const Ua=this.Uwi();D.yXa===Ua&&this.O8a.G8d(D.destination,ma,D.item.type)}Uwi(){var D=ua.h(this.$).ha.Ua.activeFloatingObjectControlId;D||(D=Va.v(ua.h(this.$).ha.pa.activeCell,this.$),D=D.FirstRow+"_"+D.FirstColumn);return D}pFk(D,ma){D.destination=null;D.G6e=ma}}Object(w.a)(od,"PasteArtRequestManager",null,[]);var G=a(219),pa=a(139),Ra=a(115);class yb extends Ke{constructor(D,ma,Ua,Xb,yc){yc=void 0===yc?null:yc;super(D,"ArtCopyPasteHandler");
this.Uyh="XLO";this.Vyh="3";this.q_=new $e(D);this.z4=ma;this.O8a=Ua;this.ha=ua.h(D).ha;this.Jkd=yc||new $d(this.z4);this.oDj=new od(Ua,D);this.qAb=Xb}getSourceItem(){z.ULS.shipAssertTag(537167896,0,!!this.ha.Ua.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");z.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.Ua.activeFloatingObjectControlId}]`);return new qc(this.ha.Ua.activeFloatingObjectControlId,
this.$.ea.na.sheetName,this.$.ea.uh,this.$.xa.UserSessionId,this.ha.Ua.gf.floatingObject.type)}beforeSerialize(D){D&&D.commandParameters?(Ya(D),D.commandParameters.copyPasteTargetType=2):z.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(D){const ma=D.sourceItem,Ua={};if(!ma)return z.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Ua;if(!this.a2i())return z.ULS.sendTraceTag(36824456,
0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Ua;z.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${ma.activeFloatingObjectControlId}]`);this.SZd();let Xb=this.Jkd.lia(ma);if(Xb)Ua.synchronousResult=Xb,D.isFromCache=!0,D.isAsyncCopy=!1,D.clientSideCopyTime=D.commandParameters.stopwatch.gg,1===D.commandParameters.commandType&&this.$.Lf(2045211913,D.commandParameters.ribbonCommandInfo.method,
D.commandParameters.ribbonCommandInfo.Ch,null);else{D.isFromCache=!1;D.isAsyncCopy=!0;Xb=this.z4.create();if(D.commandParameters.uploadToClipService){const yc={};yc["data-clipservice-ccpid"]=D.commandParameters.id;yc["data-pkey"]=D.commandParameters.pKey;yc["data-clipservice-type"]=D.commandParameters.clipServiceDataType;yc["data-clipservice-count"]=D.commandParameters.objectCount.toString();yc["data-clipservice-dc"]=D.commandParameters.clipServiceDataCenter;yc["data-clipservice-client"]=this.Uyh;
yc["data-TimeStamp"]=(new Date).toUTCString();yc["data-clipservice-version"]=this.Vyh;Xb.setItem(ya.Wgh,JSON.stringify(yc))}Ua.synchronousResult=this.eah(Xb);Ua.asynchronousResult=this.Zwd(D,ma,Xb)}D.syncClipboardItemsKeys=ge(Ua.synchronousResult);return Ua}eah(D){z.ULS.shipAssertTag(537167891,0,!!this.ha.Ua.gf,"Expecting a floating object to be currently selected for copy");D||(D=this.z4.create());const ma=this.ha.Ua.gf.CHb();ma&&D.setItem(ya.html,`<img src='${ma}'>`);return D}SZd(){const D=this.ha.Ua.gf;
this.qAb.SZd(pa.a.CCb(D.floatingObject),pa.a.Xyh(D.hv))}shouldWaitForCopyToComplete(){z.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(D){this.q_.onDeferredPasteStarted(D)}onDeferredPasteCompleted(D){this.q_.onDeferredPasteCompleted(D)}deserialize(D){var ma=Pa(D),Ua=null;let Xb=null;var yc=!1;if(!ma){Ua=D.copyContextSnapshot;Xb=Ua.sourceItem;if(!Xb)return Promise.reject(new Pc(10));yc=Xb.isFromCurrentSession(this.$)}var Tc=
this.CNg(D,!0);if(0!==Tc)return Promise.reject(new Pc(ma?18:yc?19:20,void 0,void 0,void 0,Tc));if(ma)return this.YFc(D);if(!yc&&!yb.EUi(Xb))return D=`User attempted to paste art of type [${Xb.type}] between sessions.`,z.ULS.sendTraceTag(537167889,0,50,D),Promise.reject(new Pc(11,void 0,void 0,D));if(Ua.isAsyncSerializeFailed)return Promise.reject(new Pc(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let Sc;try{const Gd=D.clipboardItems.getItem(ya.shadowWorkbook);
Sc=JSON.parse(Gd)}catch(Gd){return D=copyPasteInfra.getStringifiedError(Gd),z.ULS.sendTraceTag(537167888,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${D}`),Promise.reject(new Pc(12,void 0,Gd))}Sc.floatingObjectId!==Xb.activeFloatingObjectControlId?z.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Xb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${Sc.floatingObjectId}]`):
z.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Xb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${Sc.floatingObjectId}]`);if(!Sc||!Sc.shadowWorkbookBase64)return Promise.reject(new Pc(13,void 0,void 0,`shadowWorkbookPayload is null = ${!Sc}`));D.isShadowWorkbookParsedSuccessfully=!0;D.shadowWorkbookPayloadSize=Pb(Sc);D.shadowWorkbookSizeExceedsLimit=Ec(Sc);D.payloadOrigin=yc?xd.dqg:xd.vmd;
D.payloadType=oc.HRg;D.cseStatus=0;if(Ec(Sc))return D=`Shadow workbook size [${D.shadowWorkbookPayloadSize}] is over the limit [${pd.a.tBc}]. ShadowWorkbookSizeExceedsLimit: ${Sc.shadowWorkbookSizeExceedsLimit}`,z.ULS.sendTraceTag(36304156,0,15,`ArtCopyPasteHandler.Deserialize: ${D}`),Promise.reject(new Pc(1,void 0,void 0,D));Ua=ma=null;ua.h(this.$).ha.Yh&326?Ua=ua.h(this.$).ha.Ua.activeFloatingObjectControlId:ma=this.$.na&&this.$.na.activeCell?Va.v(this.$.na.activeCell,this.$):Va.v(Va.P(D.commandParameters.originalDestinations),
this.$);yc||!Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||(D.ArtSourceItemType=ec.a[Xb.type],z.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${Xb.type}] between sessions.`));yc=null;if(this.qAb.cyg(Xb))try{yc=this.qAb.Qod(),D.cseStatus=1}catch(Gd){D.cseStatus=15,Tc=copyPasteInfra.getStringifiedError(Gd),z.ULS.sendTraceTag(537167885,
0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${Tc}`)}else D.cseStatus=26;return this.oDj.VFi(new Wc(D.commandParameters.ribbonCommandInfo,ma,Ua,D.commandParameters.commandType,[D.commandParameters.stopwatch],Sc,Xb,D,yc))}YFc(D){D.wasLastCopyExternal=!0;if(D.clipboardItems.getItem("image/png")){const ma=D.commandParameters.stopwatch.gg;D.payloadType=oc.Dnh;return ub.c(this.$.Lf(1403967063,D.commandParameters.ribbonCommandInfo.method,
D.commandParameters.ribbonCommandInfo.Ch,{["dataUrl"]:D.clipboardItems.getItem("image/png")})).then(Ua=>{D.serverRequestTimeInMs=D.commandParameters.stopwatch.gg-ma;return Ua?Promise.resolve(null):Promise.reject(new Pc(15))},()=>{D.serverRequestTimeInMs=D.commandParameters.stopwatch.gg-ma;return Promise.reject(new Pc(15))})}z.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.YFc(D)}a2i(){const D=ua.h(this.$).ha;return D.Ua.activeFloatingObjectControlId&&
D.Ua.gf&&D.Ua.gf.floatingObject?D.Ua.gf.floatingObject.gfe():!1}Zwd(D,ma,Ua){return new Promise((Xb,yc)=>{const Tc=D.commandParameters.stopwatch.gg;z.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.O8a.AEh(new Bc(ma.activeFloatingObjectControlId,D.commandParameters,Sc=>{D.requestTelemetryData=Sc.RequestTelemetryData;D.serverRequestTimeInMs=D.commandParameters.stopwatch.gg-Tc;if(Cb.a.Ai(Sc.Errors))if(Cb.a.Joa(Sc.Errors))D.encounteredDeploymentErrors=
!0,Sc=Cb.a.xf(Sc.Errors),z.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Sc}`);else{var Gd=Cb.a.xf(Sc.Errors);z.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Gd}`);yc(new Ia(4,Sc.Errors))}else if(z.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${ma.activeFloatingObjectControlId}].`),
D.markForCancellation)yc(new Ia(3,Sc.Errors));else{if(Cb.a.wt(Sc.Errors)){var De=Cb.a.xf(Sc.Errors);z.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${De}`)}if(De=Sc.Result){De=this.T3e(De);De.floatingObjectId=ma.activeFloatingObjectControlId;D.shadowWorkbookPayloadSize=Pb(De);D.shadowWorkbookSizeExceedsLimit=Ec(De);try{Gd=JSON.stringify(De)}catch(ve){yc(new Pc(14,void 0,ve,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${D.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${De.floatingObjectId}]`));
return}z.ULS.shipAssertTag(537167881,0,!!Ua,"Expecting syncClipboardItems to be defined");Ua.setItem(ya.shadowWorkbook,Gd);1===D.commandParameters.commandType&&(this.lHj(ma.type,ma.activeFloatingObjectControlId,Sc.StateId),this.deleteFloatingObject(ma.activeFloatingObjectControlId,ma.type));this.Jkd.setValue(ma,Ua);D.asyncClipboardItemsKeys=ge(Ua);Xb(Ua)}else z.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${ma.activeFloatingObjectControlId}`),
Xb(this.Jkd.lia(ma))}},D.commandParameters.commandType,ma.type,Sc=>{D.serverRequestTimeInMs=D.commandParameters.stopwatch.gg-Tc;Sc=Qc.a.Lh(Sc.data);1===D.commandParameters.commandType&&this.O8a.QAk(ma.type,ma.activeFloatingObjectControlId);const Gd=Cb.a.xf(Sc);z.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Gd}`);yc(new Ia(4,Sc))},[D.commandParameters.stopwatch]))})}deleteFloatingObject(D,ma){D=G.a.cE(ma,D);if(D=Ra.a(this.$).lv(D))Ra.a(this.$).deleteFloatingObject(D,
14,!0),ua.h(this.$).ha.Ua.EF=null}lHj(D,ma,Ua){const Xb=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?Eb.a.mg(kc.re):this.$.ja.Qa(277);if(Xb){let Tc=null;D=G.a.cE(D,ma);D=Ra.a(this.$).lv(D);if(null===D||void 0===D?0:D.Am)Tc=D.Am.block;if(Tc){var yc=D.floatingObject.sk();Xb.Gbc(()=>!Tc.Cl.$d(yc),Ua,"CutArt")}}}static EUi(D){return 1===D.type||5===D.type||Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===
D.type||Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)&&8===D.type}}Object(w.a)(yb,"ArtCopyPasteHandler",Ke,[]);var ic=a(63);class bd extends Ne{constructor(D,ma,Ua,Xb){super(D);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=ma;this.top=Ua;this.left=Xb}}Object(w.a)(bd,"MacroRecorderPasteArtPayload",Ne,[]);class Nd{constructor(D,ma){this.$=D;this.qAb=ma}KLi(D,ma,Ua,Xb,yc,Tc,Sc){Tc=void 0===Tc?null:Tc;Sc=void 0===Sc?null:Sc;
const Gd=this.$.oa.ua.qf();let De=null;const ve={CopyPasteTargetType:2};ve.FloatingObjectId=D;ve.CopyOperationId=Ua.id;Ua.floatingObjectType=ma;ve.UploadToClipService=Ua.uploadToClipService;ve.PKey=Ua.pKey;ve.ClipServiceDataCenter=Ua.clipServiceDataCenter;let Xe=0;2===yc?(yc=505,Xe=16,De=(nf,uf,rg)=>td(this.$.oa.ua,ve,Vc.b(nf,Xb),Tc?Vc.a(uf,Tc):uf,rg,Ua.ribbonCommandInfo,Gd,Sc)):(yc=179,De=(nf,uf,rg)=>{this.nTh(ma,D);this.$.PB();var $f=this.$.oa.ua;nf=Vc.b(nf,Xb);uf=Tc?Vc.a(uf,Tc):uf;var og=Ua.ribbonCommandInfo,
bh=Sc;bh=void 0===bh?null:bh;const mi=$f.Oa(1,void 0===Gd?null:Gd);mi.copyParameters=ve;return Ed.h($f,"Cut",mi,nf,uf,rg,og,0,bh)});this.$.userOperationManager.enqueueOperation(new eb.a(yc,0,De,Xe|64),Ua.ribbonCommandInfo)}nTh(D,ma){var Ua=G.a.cE(D,ma);(Ua=Ra.a(this.$).lv(Ua))?(ua.h(this.$).ha.Ua.tM(Ua),Ua.isVisible=!1):z.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${D}, FloatingObjectId: ${ma}`)}QAk(D,ma){D=G.a.cE(D,
ma);if(D=Ra.a(this.$).lv(D))D.isVisible=!0}AEh(D){this.KLi(D.floatingObjectId,D.xEh,D.commandParameters,D.gL,D.ZMh,D.Aqa,D.ike)}sMi(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De){Gd=void 0===Gd?null:Gd;De=void 0===De?!0:De;return new Promise((ve,Xe)=>{const nf=Tc.commandParameters.stopwatch.gg;this.c9d(D,yc,ma,Ua,uf=>{Tc.requestTelemetryData=uf.RequestTelemetryData;Tc.serverRequestTimeInMs=Tc.commandParameters.stopwatch.gg-nf;if(Cb.a.Joa(uf.Errors))Tc&&(Tc.encounteredDeploymentErrors=!0),uf=Cb.a.xf(uf.Errors),z.ULS.sendTraceTag(537167875,
0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${uf}`);else if(Cb.a.Ai(uf.Errors)){var rg=Cb.a.xf(uf.Errors);z.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${rg}`);Xe(new Pc(9,uf.Errors))}else uf.Result?(rg=uf.Result,z.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.xHj(Sc,rg.FloatingObjectId,uf.StateId),ve(Nd.PEd(rg.FloatingObjectId))):(z.ULS.sendTraceTag(537167873,
0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Xe(new Pc(9,uf.Errors)))},uf=>{Tc.serverRequestTimeInMs=Tc.commandParameters.stopwatch.gg-nf;uf=Qc.a.Lh(uf.data);z.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Cb.a.xf(uf)}`);Xe(new Pc(9,uf))},Xb,Gd,De)})}xHj(D,ma,Ua){const Xb=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?Eb.a.mg(kc.re):this.$.ja.Qa(277);if(Xb){const yc=G.a.cE(D,
Nd.PEd(ma));Xb.Gbc(()=>!!Ra.a(this.$).lv(yc),Ua,"PasteArt")}}iie(D,ma){ma&&this.qAb.iie(D,G.a.cE(D.type,ma))}N$f(D){return this.sMi(D.ribbonCommandInfo,D.destination,D.G6e,D.ike,D.s2,D.pasteContext,D.item.type,D.QYe,D.item.isFromCurrentSession(this.$)).then(ma=>ma,ma=>{this.iie(D.item,D.QYe);return Promise.reject(ma)})}G8d(D,ma,Ua){D||(D=Va.v(ua.h(this.$).ha.pa.activeCell,this.$));ua.h(this.$).Lxc(Va.F(D),1)?Ra.a(this.$).Jda(Ua,ma,!0):ua.h(this.$).ha.Ua.yQa(D,ma,Ua).continueWith(Xb=>{Xb.result?z.ULS.sendTraceTag(537167843,
5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${ma}]`):z.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${ma}]`)})}c9d(D,ma,Ua,Xb,yc,Tc,Sc,Gd,De){De=void 0===De?!0:De;const ve=this.$.oa.ua.qf(),Xe={};Xe.ShadowWorkbookBase64=ma.shadowWorkbookBase64;Xe.FloatingObjectId=Xb;Xe.DestinationRanges=Ua?Va.s(Ua):null;Xe.CopyPasteTargetType=2;Xe.ClientEstimationFloatingObjectId=Gd;Ua=new eb.a(503,
0,(nf,uf,rg)=>{Gd||this.$.PB();return zd(this.$.oa.ua,Xe,Vc.b(nf,yc),Vc.a(uf,Tc),rg,null,ve,Sc)},void 0,()=>{if(De){let nf;nf=ic.a.qm(ic.a.Vf(Xe));nf.FloatingObjectId=ma.floatingObjectId;Xe.DestinationRanges||(nf.DestinationRanges=Va.p(this.$.sa.na.sheetName,"",0,0,0,0));return new bd(nf,De,0,0)}return new bd(Xe,De,0,0)});Ua.flags=65;this.$.userOperationManager.enqueueOperation(Ua,D)}static PEd(D){return`${D.length+2}.{${D.toUpperCase()}}`}}Object(w.a)(Nd,"ArtCopyPasteUtils",null,[878]);var ce=a(209);
class le{constructor(D){this.Fkd=this.kBa=null;this.Nkb=15;this.$=D}SZd(D,ma){this.kBa=D;this.Fkd=ma}Qod(){if(!this.kBa||!this.Fkd)return z.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const D=pa.a.CCb(new G.a(this.kBa));D.Id=Nd.PEd(ta.a.create().toString());D.Version=-1;D.Name="";D.IsClientEstimation=!0;var ma=this.RNi(D);if(!ma)return null;const Ua=new G.a(D);
ma.block.Cl.add(Ua);Ua.Wmb();const Xb=Ra.a(this.$);Xb.sic(Ua,ma);ma=Xb.lv(G.a.Moi(D));!ma||ma.floatingObject.fFa||ma.floatingObject.tWa||ma.J0a(this.Fkd);Xb.Jda(D.Type,D.Id,!0);return D.Id}cyg(D){return Tb.EwaSettings.Ia(205)&&D.isFromCurrentSession(this.$)&&!ua.h(this.$).rtl&&!ua.h(this.$).Be.Gl}iie(D,ma){this.cyg(D)&&(D=Ra.a(this.$).lv(ma))&&(z.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${ma}] of type [${D.floatingObject.type}]`),
Ra.a(this.$).deleteFloatingObject(D,15,!0),D.Am&&D.qmb(D.Am,!1))}RNi(D){if(!D)return z.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(ua.h(this.$).ha.Ua.activeFloatingObjectControlId){var ma=ua.h(this.$).ha.Ua.EF.floatingObject;D.OriginDeltaX=ma.offsetX+this.Nkb;D.OriginDeltaY=ma.offsetY+this.Nkb;D.AbsoluteLeft+=this.Nkb;D.AbsoluteTop+=this.Nkb;D.AbsoluteRight+=this.Nkb;D.AbsoluteBottom+=this.Nkb;D.ZOrder=
ma.VG+1;return ua.h(this.$).ha.Ua.EF.Am}if(!this.$.na||!this.$.na.activeCell)return z.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Ua=this.$.na.activeCell;ma=ua.h(this.$).nY(Ua);if(!ma)return z.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${Ua.toString()} is null.`),null;const Xb=ac.HelperMethods.rzd(ma.domElement,
ma.en.domElement);Ua=ma.gridView.Oj(Ua,2);if(!Xb||!Ua)return z.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!Xb}. cellPositionRelativeToGridOrigin is null: ${!Ua} .`),null;D.OriginDeltaX=Ua.topLeft.x-Xb.x;D.OriginDeltaY=Ua.topLeft.y-Xb.y;D.AbsoluteLeft=Ua.topLeft.x;D.AbsoluteTop=Ua.topLeft.y;D.AbsoluteRight=D.AbsoluteLeft+Math.abs(this.kBa.AbsoluteRight-this.kBa.AbsoluteLeft);D.AbsoluteBottom=D.AbsoluteTop+
Math.abs(this.kBa.AbsoluteBottom-this.kBa.AbsoluteTop);D.ZOrder=this.kBa.ZOrder+100;return new ce.a(ma.gridView.ya.Dl(ma.hashCode),ma.hashCode)}}Object(w.a)(le,"ArtPasteClientEstimation",null,[877]);class Le{create(){const D=window.clipboardPlatform;return D?D.createClipboardItems():null}}Object(w.a)(Le,"ClipboardItemsFactory",null,[876]);class Ve{}Ve.undefined="Undefined";Object(w.a)(Ve,"CCPTelemetryConsts",null,[]);class Ub{}Ub.cells="Cells";Ub.floatingObject="FloatingObject";Ub.unknown="Unknown";
Object(w.a)(Ub,"ActiveSelection",null,[]);class Mc{}Mc.wSh="DisplayNotInvoked";Mc.Jod="Displayed";Mc.GHj="PrerequisitesNotReady";Object(w.a)(Mc,"PasteIndicationDisplayStatus",null,[]);class Kd extends Nb{constructor(D,ma,Ua,Xb){super(D,ma,Ua,void 0===Xb?null:Xb);this.lBa=null}beforePaste(){z.ULS.sendTraceTag(508121693,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(D){D.isClipboardDataContainShadowWorkbook=!(void 0===D.clipboardItems.getItem(ya.shadowWorkbook)||null===D.clipboardItems.getItem(ya.shadowWorkbook));
this.Lv.jJb(D.copyContextSnapshot);const ma=D.commandParameters.originalDestinations;if(!D.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let Ua=null;if((()=>{let Xb=this.lIg(D.clipboardItems);({s2:Ua}=Xb);return Xb})().returnValue){D.isShadowWorkbookParsedSuccessfully=!0;let Xb=null,yc=null;Tb.EwaSettings.getBooleanFeatureGate(bc.a.$Db,!1)?Xb=Va.r(ma,this.$):yc=Va.v(Va.P(ma),this.$);return this.MDj(D,yc,Xb,Ua)}return D.isClipboardInaccessible?Promise.reject(new Pc(8)):Promise.reject(new Pc(6))}get copyPasteInfrastructure(){var D;
null!==(D=this.lBa)&&void 0!==D?D:this.lBa=this.$.ja.Qa(254,!0);return this.lBa}OPi(D,ma,Ua,Xb){return this.copyPasteInfrastructure?ub.a(this.copyPasteInfrastructure.YFd(null,Xb.commandParameters.ribbonCommandInfo,D,ma,Ua,Xb)):Promise.reject(new Pc(0))}MDj(D,ma,Ua,Xb){D.pasteResult="CrossSessionPaste";D.payloadOrigin=xd.vmd;D.payloadType=oc.shadowWorkbook;D.shadowWorkbookPayloadSize=Pb(Xb);D.shadowWorkbookSizeExceedsLimit=Ec(Xb);Xb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(D.originalSourceRangesCountExceedsLimit=
Xb.originalSourceRangesCountExceedsLimit);return D.shadowWorkbookSizeExceedsLimit?Promise.reject(new Pc(1)):1028===D.commandParameters.commandType&&D.originalSourceRangesCountExceedsLimit?Promise.reject(new Pc(1)):this.OPi(ma,Ua,Xb,D)}}Object(w.a)(Kd,"AcrossSessionInsertCopiedCutCellsHandler",Nb,[]);class je{constructor(D,ma){this.$=D;this.z4=ma}get name(){return"NonGridCopyHandler"}getSourceItem(){return new Ta(this.$.ea.uh,this.$.xa.UserSessionId)}beforeSerialize(D){Ya(D);D.commandParameters.copyPasteTargetType=
0}serialize(D){const ma={};if(!D.sourceItem)return z.ULS.sendTraceTag(508074082,0,10,"NonGridCopyHandler.Serialize: sourceItem should not be null"),ma;D.isFromCache=!1;D.isAsyncCopy=!1;const Ua=this.z4.create();ya.plainText in D.commandParameters.clipboardItems&&Ua.setItem(ya.plainText,D.commandParameters.clipboardItems[ya.plainText]);ya.html in D.commandParameters.clipboardItems&&Ua.setItem(ya.html,D.commandParameters.clipboardItems[ya.html]);ma.synchronousResult=Ua;return ma}}Object(w.a)(je,"NonGridCopyHandler",
null,[739]);class qe{constructor(D){this.G4c=this.Z0c=this.xWc=this.d6c=null;this.$=D}get hij(){!this.G4c&&this.$.ja.Qa(254,!0)&&(this.G4c=new je(this.$,new Le));return this.G4c}get Z0d(){if(!this.d6c){const D=this.$.ja.Qa(254,!0);D&&(this.d6c=new Nb(this.$,D,new Le))}return this.d6c}get RPi(){if(!this.Z0c){const D=this.$.ja.Qa(254,!0);D&&(this.Z0c=new Kd(this.$,D,new Le))}return this.Z0c}get Rdd(){if(!this.xWc&&this.$.ja.Qa(254,!0)){const D=new le(this.$);this.xWc=new yb(this.$,new Le,new Nd(this.$,
D),D)}return this.xWc}getCopyFlowHandler(D){if(D.commandParameters.clipboardItems)return this.hij;const ma=this.vki(ua.h(this.$).Yh);D.commandParameters.copyPasteHandlerName=ma.name;return ma}getPasteFlowHandler(D){var ma=D.copyContextSnapshot;switch(D.commandParameters.ribbonCommandInfo.command){case -160032004:case -1065525230:return D=this.RPi;default:return ma=wb(D)?this.Rdd:Pa(D)?this.Z0d:(null===ma||void 0===ma?0:ma.sourceItem)&&Object.getType(ma.sourceItem)===qc?this.Rdd:this.Z0d,D.commandParameters.copyPasteHandlerName=
ma.name,ma}}initializePasteContext(D){if(D){D.isSameSession=!1;D.isShadowWorkbookParsedSuccessfully=!1;D.pasteResult=Ve.undefined;D.payloadOrigin=Ve.undefined;D.payloadType=Ve.undefined;D.encounteredDeploymentErrors=!1;D.shadowWorkbookSizeExceedsLimit=!1;D.originalSourceRangesCountExceedsLimit=!1;D.activeSelectionType=this.ggi();D.indicationDisplayScheduled=!1;D.pasteDestinationHasMergedCells=!1;D.cseStatus=0;D.pasteIndicationDisplayStatus=Mc.wSh;if(Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",
!1)||Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))D.ArtSourceItemType=Ve.undefined;if(D.copyContextSnapshot){var ma=D.copyContextSnapshot;const Sc=Ca(ma.sourceItem);var Ua=ma.sourceItem;var Xb=!!Ua&&Object.getType(Ua)===qc;Ua=0;var yc=!1;Sc?(yc=ma.sourceItem,D.isSameSession=yc.isFromCurrentSession(this.$),Ua=1,yc=this.UZi(yc,D)):Xb&&(D.isSameSession=ma.sourceItem.isFromCurrentSession(this.$),Ua=2);if(D.copyContextSnapshot.commandParameters){const Gd=
-1985798686===ma.commandParameters.ribbonCommandInfo.command;Xb=D.commandParameters;var Tc=this.$;ma?Tc&&Tc.xa?ma=ma.sessionId===Tc.xa.UserSessionId:(z.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),ma=!1):(z.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),ma=!1);Xb.clearSystemClipboard=ma&&Gd&&Sc&&!yc;D.commandParameters.copyPasteTargetType=Ua}}}}getSessionId(){return this.$.xa.UserSessionId}UZi(D,ma){const Ua=gb.b(D.ranges,Xb=>Xb.Ei)&&gb.b(ma.commandParameters.originalDestinations,
Xb=>1!==Xb.top);return gb.b(D.ranges,Xb=>Xb.isRow)&&gb.b(ma.commandParameters.originalDestinations,Xb=>1!==Xb.left)||Ua}vki(D){switch(D){case 1:return this.Z0d;case 64:case 4:case 2:case 256:return this.Rdd;default:throw Error.invalidOperation("Unsupported selection");}}ggi(){return ua.h(this.$).ha.Yh&470?Ub.floatingObject:1===ua.h(this.$).ha.Yh?Ub.cells:Ub.unknown}getDialogResponse(){}}Object(w.a)(qe,"ExcelCopyPasteApplicationHost",null,[716]);var Fe=a(184);class We extends Fd.a{constructor(D,ma){super(D);
this.Tx=null;this.QPi=(Ua,Xb)=>{1===Ua?(Ua=We.ERh[Xb[We.DRh]],z.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===Ua?"Horizontal":"Vertical"}`),this.Tx.setResult(Ua)):(z.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.Tx.uy())};this.uj(ma)}get Cf(){return"InsertCopiedCutCellsDialog"}uj(D){this.Tx=new Fe.a;const ma=ad.a.instance.ia(16);
D=this.cI(D);this.initializeAndShow(ma,this.QPi,D)}cI(D){return{[We.fv]:this.Cf,[We.G0i]:D}}}We.DRh="direction";We.G0i="isRtl";We.ERh={["Vertical"]:1,["Horizontal"]:0};Object(w.a)(We,"InsertCopiedCutCellsDialog",Fd.a,[]);class mf{uic(D,ma){return(new We(D,ma)).Tx.task}}Object(w.a)(mf,"InsertCopiedCutCellsDialogFactory",null,[715]);var qf=a(98),Ga=a(54),Ob=a(50),e=a(337),sb=a(29),dc=a(286),N=a(805);class Da{constructor(D){this.jjc="";this.hD=this.Mx=null;this.Mkb=new Map;this.e$=null;this.LGc=!1;this.Ozf=
(ma,Ua)=>{this.hide(void 0===ma?null:ma,void 0===Ua?null:Ua)};this.$=D;this.gridView=ua.h(D);this.gridView.ha.qt(this.Ozf)}b9e(){this.LGc||(z.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.zP(D=>{D.y5(0).then(()=>{this.LGc=!0})}))}h4j(D){const ma=D.commandParameters.id;z.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${ma}, cancelCtx is null = ${!this.Mx}, PrerequisitesDownloaded = ${this.LGc}`);
this.b9e();this.jjc=ma;const Ua=!this.IWf();if(!this.Mx||Ua)this.WVe(),this.Mx=Ga.a.instance.create(()=>{this.vSh(D)},void 0===D.timeoutToShowSpinnerInMs||null===D.timeoutToShowSpinnerInMs?100:D.timeoutToShowSpinnerInMs,Ob.a.sDj);this.e$=D.commandParameters.originalDestinations;bc.a.U$f&&this.o4j(ma)}vSh(D){this.LGc?(this.display(D.commandParameters.originalDestinations),D.pasteIndicationDisplayStatus=Mc.Jod):(z.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),
this.hide(),D.pasteIndicationDisplayStatus=Mc.GHj)}o4j(D){this.Mkb.set(D,sb.a.Ae.zh);Ga.a.instance.create(()=>{this.GSh(D)},this.$.xa.PasteToastNotificationDelayTime,Ob.a.tDj)}GSh(D){this.Mkb.has(D)&&(this.hD?this.hD.displayTimeoutSeconds+=this.$.xa.PasteToastNotificationDefaultDisplayDuration:(D=ad.a.instance.ia(2341),this.hD=e.a.Aw.iG.gS(D,!1),this.hD.image=5,this.hD.HS=N.a.sPj,this.hD.displayTimeoutSeconds=this.$.xa.PasteToastNotificationDefaultDisplayDuration,e.a.Aw.iG.RA(this.hD)))}Hba(D){D&&
this.hD&&(D=ad.a.instance.ia(2342),this.hD.KSc(D),this.hD.image=5,this.hD.HS=N.a.RXe);setTimeout(()=>{this.HTj()},3E3)}HTj(){this.hD&&(e.a.Aw.iG.removeEntry(this.hD),this.hD=null)}display(D){z.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Se.GG(Id.a.C2a(ze.d(this.gridView.$.na),D),Da.ZFc,!0);this.gridView.Se.Ys(Da.ZFc)}ytc(D,ma){ma=void 0===ma?!0:ma;z.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${D}, currentPasteCommandId = ${this.jjc}`);
D&&Lc.a.equals(D,this.jjc,!1)&&this.hide();if(bc.a.U$f&&D&&this.Mkb.has(D)){const Ua=dc.a(sb.a.Ae.zh,this.Mkb.get(D));6E4<Ua&&z.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${D}), scheduleDisplayToHideDurationInMs (${Ua}))`);this.Mkb.delete(D);null!=this.hD&&0===this.Mkb.size&&this.Hba(ma)}}hide(D){this.e$&&(void 0===D?0:D)&&this.IWf()&&z.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");
this.jjc="";this.WVe();this.e$=null;0!==this.gridView.Se.Wvd([30]).length&&(this.gridView.Se.Fl(Da.ZFc),this.gridView.Se.lo(null,Da.ZFc))}IWf(){return Va.V(this.gridView.ha.pa.selectedRanges,this.e$)}WVe(){this.Mx&&(qf.a.Sa(this.Mx),this.Mx=null)}dispose(){this.hide();this.hD&&this.Hba(!1);this.gridView.ha.Pt(this.Ozf)}}Da.ZFc=[30];Object(w.a)(Da,"PasteIndicationManager",null,[714,2]);var fb=a(1187),Wb=a(58),Jc=a(796),md=a(549);const sd=()=>{var D=navigator.userAgentData;if(D)for(let ma=0;ma<D.brands.length;ma++){if("Microsoft Edge"===
D.brands[ma].brand&&79<=parseFloat(D.brands[ma].version))return!0}else if(navigator.userAgent&&(D=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&79<=parseFloat(D[2]))return!0;return!1},Od=D=>{const ma=bc.a.MSi&&!D.isMobileMode,Ua=bc.a.NSi&&D.isMobileMode&&D.isEditMode;D=D.oh.get(57);return(ma||Ua)&&!D&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&(sd()||za.a.Br&&za.a.TEa(86)))};class Ce extends Qb.a{constructor(D){super();this.Tyh="clipboard-read";
this.$=D;this.mo=ad.a.instance;this.YTi=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8282600_EnableClipboardPermissionLogging");this.Dg()}create(){const D=Wb.a.$0([73,74],4,this.$a,void 0,void 0,void 0,Ce.zYb),ma=Object(ub.d)(Eb.a.resolve(kc.Db,{Aa:this.$a})),Ua=Tb.EwaSettings.Pi()?Object(ub.d)(Eb.a.resolve(kc.ze)):nb.Task.Ra(null);ne.TaskExtensions.Ca(ne.TaskExtensions.Dh([ma,D,Ua],this.qa),()=>{const Xb=new fb.a;let yc=null;this.RBh(Xb).then(Tc=>{yc=Tc.TYe;const Sc=copyPasteInfra.createCopyPasteInfra(yc,
new qe(this.$),Xb,{isChangeGateEnabled:Tb.EwaSettings.isChangeGateEnabled});z.ULS.shipAssertTag(537167762,0,!!this.$.xa,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");z.ULS.shipAssertTag(537167761,0,!!this.$.xa&&!!this.$.xa.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");const Gd=yc.getMetadataManager();var De=Object(Jc.a)(this.$.ja,254,()=>new fd(this.$,Gd,ma.result,Sc,new Gc(this.$,
ua.h(this.$)),new mf,this.$.xa.DocumentHostInfo.UserId,yc.getInitializationError(),Ua.result));this.Df(De);if(Tc.r$a){De=fd.wpc();const ve=JSON.stringify(Tc.r$a.dataClipboardCapabilities),Xe=Tc.r$a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Tc.r$a.dataClipboardStrategyType,nf=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();z.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${De}, StrategyType=${Tc.r$a.dataClipboardStrategyType}, StrategyCapabilities=${ve}, IsBestStrategyTypeInitialized=${Xe}, InfraLoadTimeMS=${nf}`)}else z.ULS.shipAssertTag(537167760,
0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},Tc=>{const Sc=fd.wpc();Tc=Tc?copyPasteInfra.getStringifiedError(Tc):"null";z.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${Sc} error: ${Tc}`)})},this.qa,3)}dispose(){super.dispose()}RBh(D){var ma,Ua;let Xb=null;var yc=
window.clipboardPlatform;yc&&(Xb=yc.getClipboardPlatformEnvironment(),null===(ma=yc.setClipboardPlatformFeatureGateManager)||void 0===ma?void 0:ma.call(yc,md.a()));if(!Xb)return z.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);ma=this.$.xa;yc=[ma.OfficeOnlineChromeExtensionId,ma.ChromeClipboardAccessExtensionId];const Tc=this.mo.za(5),Sc=this.$.oh.get(57);
let Gd=!Sc&&this.$.oh.get(5);var De=this.$.ea.ff;De&&(De.inWebPart||De.inViewerFromWebPart||De.isDivSyndicated)&&(Gd=!1);(De=Od(this.$))&&z.ULS.sendTraceTag(508703874,0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");try{this.YTi&&(null===(Ua=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===Ua?0:Ua.query)&&navigator.permissions.query({name:this.Tyh}).then(ve=>{z.ULS.sendTraceTag(508151361,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Clipboard read permission state: ${null===
ve||void 0===ve?void 0:ve.state}`)}).catch(ve=>{z.ULS.sendTraceTag(508151360,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(ve)}`)})}catch(ve){z.ULS.sendTraceTag(508151331,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(ve)}`)}Ua=this.uji(Gd,!Sc,De);z.ULS.shipAssertTag(537167758,0,!!ma.DocumentHostInfo,
"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Xb.init({isChangeGateEnabled:Tb.EwaSettings.isChangeGateEnabled},D,yc,ma.SharedClipboardHostingApp,ma.SharedClipboardHostingApps,ma.SharedClipboardHostingEnvironments,ma.SharedClipboardOverrideOrigin,ma.SharedClipboardSchemaVersion,ma.SharedClipboardExpirationInMinutes,ma.ClipboardPromiseTimeoutInMinutes,Tc,ma.MachineCluster,new kd(this.$),Ua,ma.DocumentHostInfo.UserId,
ma.ClipboardTtlInMS,Tb.EwaSettings.Ia(273),ma.UserSessionId,ma.BulsEndpointUrl).then(ve=>Object(Ka.a)(new mb,{TYe:Xb,r$a:ve}),ve=>Promise.reject(ve))}uji(D,ma,Ua){const Xb=[];D&&Ua&&Xb.push(this.e4e(9));D&&ma&&Xb.push(this.e4e(6));ma&&(Xb.push(this.lmd(7)),Xb.push(this.lmd(0)));D&&Xb.push(this.b3e());Xb.push({clipboardStrategyType:4});Ua=Xb?Xb.map(yc=>JSON.stringify(yc)).join(","):"[]";z.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${D}, isSystemClipboardAllowed=${ma}, result = ${Ua}`);
return Xb}b3e(){const D=this.$.xa,ma={clipboardStrategyType:5};ma.sessionId=D.UserSessionId;ma.useSharedClipboardIframe=!0;ma.sharedClipboardHostingApp=D.SharedClipboardHostingApp;ma.sharedClipboardHostingApps=D.SharedClipboardHostingApps;ma.sharedClipboardHostingEnvironments=D.SharedClipboardHostingEnvironments;ma.sharedClipboardOverrideOrigin=D.SharedClipboardOverrideOrigin;ma.sharedClipboardSchemaVersion=D.SharedClipboardSchemaVersion;ma.sharedClipboardExpirationInMinutes=D.SharedClipboardExpirationInMinutes;
ma.wacCluster=D.MachineCluster;return ma}e4e(D){const ma={};ma.clipboardStrategyType=D;ma.localStorageStrategyParameters=this.b3e();ma.systemClipboardStrategyParameters=this.lmd(0);return ma}lmd(D){const ma={};ma.clipboardStrategyType=D;ma.skipFilesIfPlainTextExists=!0;return ma}static ta(D){D.ja.$c(373,new Da(D));D.ja.$c(Ce.zYb,new Ce(D))}}Ce.zYb=255;Object(w.a)(Ce,"CopyPasteInfrastructureFactory",Qb.a,[]);var Qe=a(11),lf=a(150),Oe=a(16),ag=a(153);Object(Eb.b)(kc.Wc,{nn:"singleton"})(D=>Lo(function*(){const ma=
yield Eb.a.resolve(kc.nb,D),Ua=lf.KeyInputManager.instance,Xb=ag.a.instance.qM();return new xg(ma,Ua,Xb)}));class xg extends Cc.a{constructor(D,ma,Ua){super();this.statusBarManager=null;this.C7e=()=>{this.Gkc()};this.MRh=()=>{this.Gkc()};this.B7e=Xb=>{10===Xb&&this.Gkc()};this.onKeyDown=Xb=>13===Xb.Ga.keyCode?(Xb=new Dc.a(237279923,1,2,6,null),this.$.Ha.Me(Xb,{[id.a.skipClipboardAccess]:!0,[id.a.Raf]:!0}),!0):!1;this.$=D;this.kz=ma;this.Jp=Ua;this.Dqd=!1;this.$.ja.Ne(29,Xb=>{this.statusBarManager=
Xb;Xb.YL(this)})}dispose(){this.Qk();this.Jp=this.kz=this.$=null;this.statusBarManager&&(this.statusBarManager.FI(this),this.statusBarManager=null)}wq(){return!0}Ov(D,ma){if("QueryPasteShortcutEnabledLabel"!==D&&!xg.yqk.includes(D))return!1;const Ua=this.uK();"QueryPasteShortcutEnabledLabel"===D?(ma.Visible=Ua,z.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${Ua} for commandId ${D}`)):(ma.Visible=!Ua,z.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!Ua} for commandId ${D}`));
return!0}aXh(){this.Kl();this.raiseEvent("pasteShortcutStatusChanged")}Gkc(){this.Qk();this.raiseEvent("pasteShortcutStatusChanged")}uK(){return this.Dqd}$t(D){this.addHandler("pasteShortcutStatusChanged",D)}Eu(D){this.removeHandler("pasteShortcutStatusChanged",D)}Kl(){if(!this.uK()){this.Dqd=!0;ua.h(this.$).lm.jr(this.C7e);this.Jp.ta("blur",this.MRh);const D=this.$.ja.Qa(65);D&&D.daa&&D.daa.registerForCommentEvents(this.B7e);this.kz.oz(Oe.a.Hf,this.$.AC,this.onKeyDown,!0)}}Qk(){if(this.uK()){this.Dqd=
!1;ua.h(this.$).lm.$q(this.C7e);this.Jp.detach("blur");const D=this.$.ja.Qa(65);D&&D.daa&&D.daa.unregisterForCommentEvents(this.B7e);this.kz.Cz(Oe.a.Hf,this.$.AC,this.onKeyDown,!0)}}}xg.yqk=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(w.a)(xg,"PasteShortcutManager",Cc.a,[555,256,169,2]);class Yf extends Qb.a{constructor(D){super();this.$=D;this.Dg()}create(){const D=this.$;this.Df(D.ja.Qa(478)||this.$.ja.$c(478,new xg(D,lf.KeyInputManager.instance,ag.a.instance.qM())))}static ta(D){D.ja.$c(479,
new Yf(D))}}Object(w.a)(Yf,"PasteShortcutManagerFactory",Qb.a,[]);var Wa=a(793),vb=a(203),cc=a(106),Ic=a(1325),dd=a(313),Cd=a(201);let ae=class{constructor(D,ma,Ua){this.sEb=null;this.$=D;ma?(z.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.sEb=new Ic.a(D,ma,Ua)):z.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Uf(){return!1}executeCommand(D,
ma,Ua){D=!1;switch(ma.command){case 73979048:this.sEb&&this.sEb.sHj(ma,cc.TaskManager.instance,P.AFrameworkApplication.fa,Ua),D=!0}return D?nb.Task.Ra(!0):Cd.a(ma.command)}Kf(D,ma){return 73979048===ma.command&&P.AFrameworkApplication.oja(dd.a)}Yf(){return!1}dispose(){this.sEb&&this.sEb.dispose()}};ae=Object(vb.__decorate)([Object(Eb.d)(kc.V),Object(vb.__param)(0,Object(kc.nb)()),Object(vb.__param)(1,Object(kc.l)()),Object(vb.__param)(2,Object(kc.qe)())],ae);Object(w.a)(ae,"DataFromPictureCommandHandler",
null,[165,2]);class Be extends Wa.a{constructor(D){super(D)}lj(){const D=Object(ub.d)(Eb.a.resolve(kc.l,{Aa:1})),ma=Object(ub.d)(Eb.a.resolve(kc.qe,{Aa:this.$a}));ne.TaskExtensions.Ca(ne.TaskExtensions.Dh([D,ma],this.$.qa),()=>{this.Gi([new ae(this.$,D.result,ma.result)])},this.$.qa,3)}static ta(D){Wa.a.Kk(452,new Be(D))}}Object(w.a)(Be,"DataFromPictureCommandHandlerFactory",Wa.a,[]);var oe=a(531),Te=a(1219),wf=a(340),fg=a(882),Og=a(167);class yf extends Te.a{constructor(D,ma,Ua){super(D,ma,Ua);this.Z8b=
this.Lza=null}get pU(){return P.AFrameworkApplication.ra.NG}Mof(D){switch(D){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}ANg(D){return yf.sma(D,this.VAi())}VAi(){return yf.kIe}sma(D,ma){ma=void 0===ma?null:ma;D=this.ANg(D);return 0!==D?(ma&&ma.xKe(),2===D&&this.Lm(0,this.Mof(D)),!1):!0}finalizeUpload(D,ma){z.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.iXd=ma;this.alk();wf.a.mark(5576);
this.Z8b=this.pU.Sf("LoadResource","PictureUploadTime")}Lm(D,ma){const Ua=new Og.StandardDialog;Ua.Ye=0;Ua.RE(D,CommonUIStrings.l_ImageUploadFailedTitle,ma,null)}sTb(){z.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.sTb();this.Z8b&&(this.Z8b.stop(),this.Z8b=null);this.hzh()}alk(){this.Lza=(new fg.a).create();this.Lza.message=CommonUIStrings.l_ImageUploadWait;this.Lza.Ye=5;this.Lza.ay=!1;this.Lza.yJa(null,null,null)}hzh(){this.Lza&&(this.Lza.close(),this.Lza=null)}static UHi(D,
ma){D=jb.a.Po(D);for(let Ua=0;Ua<ma.length;++Ua)if(D.endsWith(ma[Ua]))return!0;return!1}static sma(D,ma){ma=void 0===ma?null:ma;ma||(ma=yf.kIe);return D?yf.UHi(D,ma)?0:2:1}}yf.kIe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(w.a)(yf,"PictureUploader",Te.a,[]);var Sf=a(588),Wf=a(335),ng=a(241),Me=a(191),Dg=a(179),Tg=a(444),gg=a(119),Rg=a(175),qh=a(233),ug;(function(D){D[D.unknown=0]="unknown";D[D.bing=1]="bing";D[D.M365=2]="M365"})(ug||(ug={}));Object(w.b)("InsertMediaProviders",ug);var Dh=
a(95),zg=a(1046);class Eg extends zg.a{constructor(D,ma){super(D,K.a.c0(ma))}KVb(D,ma){this.isEnabled()&&this.kZ(this.targetOrigin)&&(this.rp(D),this.Dn(D,ma))}}Object(w.a)(Eg,"InsertMediaCrossDocumentMessenger",zg.a,[696,229,2]);class Lg{}Object(w.a)(Lg,"OnlineMediaSearchResult",null,[]);var jg=a(401),hh=a(924),Jh=a(369),uh;(function(D){D[D.OK=0]="OK";D[D.cancel=1]="cancel";D[D.error=2]="error";D[D.open=3]="open"})(uh||(uh={}));Object(w.b)("HubbleAction",uh);var Ja=a(69);class Fb extends Me.a{constructor(D,
ma,Ua,Xb,yc,Tc){super();this.Rwc=!1;this.correlationId=this.ZNd=this.qG=this.HEa=null;this.amj=()=>{this.PCa(this.v9a);this.PLc(1)};this.BMd=Sc=>{Sc.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Sc.target.id||Sc.shiftKey?"KeepFocusStartDiv"===Sc.target.id&&Sc.shiftKey&&(Sc.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Sc.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.Ntj=()=>{this.Wzb&&(this.Wzb.launchUpsellExperience("stockimages"),z.ULS.sendTraceTag(537155807,
0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.lvj=Sc=>{Sc&&Sc.Values&&(Sc=Sc.Values,delete Sc.m_Origin,delete Sc.m_Source,delete Sc.m_ReceivedTime,z.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+Sc.eventName||!1),Dg.a.sendOtelEvent(Object.assign(new hh.a,{otelEvent:Sc})))};this.eo=Tc;this.$=D;this.YCf=ma;this.Wzb=Ua;this.Lda=[];this.Mib=Xb;this.hRh=yc;this.EOe=this.$.xa.InsertOnlinePictureMaxCountOfImagesToInsert;this.Wi=this.lIh()}Skk(D){this.Rwc=!1;this.showDialog(this.eo,
null);this.HEa=document.getElementById(this.sl("InsertMediaFrame"));if(!this.HEa)throw this.PCa(this.v9a),Error.invalidOperation("Couldn't get InsertMediaIframe.");var ma=document.getElementById(this.sl("WACDialogPanel"));ma&&ma.setAttribute(Tg.a.ih,Tg.a.CPa);ma=document.createElement("div");ma.id="KeepFocusStartDiv";ma.tabIndex=0;ma.className="keep-focus-start";this.HEa.parentNode.insertBefore(ma,this.HEa.parentNode.firstChild);ma=document.createElement("div");ma.id="KeepFocusDiv";ma.tabIndex=0;
ma.className="keep-focus";this.correlationId=ta.a.create();this.HEa.parentNode.appendChild(ma);$addHandler(this.KRa,"keydown",this.BMd);this.HEa.src=this.YCf;this.HEa.frameBorder="0";ma=document.getElementById(this.sl("WACDialogButtonPanel"));if(!ma)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");ma.className="display-none";ma=document.getElementById(this.sl("WACDialogTitleText"));if(!ma)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");ma.className="display-none";
2===this.Mib&&(document.getElementById(this.sl("WACDialogTitlePanel")).className="display-none",document.getElementById(this.sl("WACDialogBodyPanel")).className="padding-zero");gg.FocusManager.instance().hW().scope.P0=!0;this.qG=new Eg(this.HEa.contentWindow,this.YCf);this.qG.kZ("https://osiziwuspersimmon002.blob.core.windows.net");this.qG.kZ("https://osizewuspersimmon001.blob.core.windows.net");this.qG.kZ("https://osizpscuspersimmon000.blob.core.windows.net");this.qG.kZ("https://cdn.hubblecontent.msit.osi.office.net");
this.qG.kZ("https://cdn.hubblecontent.osi.office.net");this.qG.KVb(Rg.a.kah,Ua=>{this.Qkj(Ua,D.Hea)});this.qG.KVb(Rg.a.insert,()=>{this.dtj(D.Hea)});this.qG.KVb(Rg.a.Bgd,this.amj);this.qG.KVb(Rg.a.Nah,Ua=>{this.lvj(Ua)});2===this.Mib&&0===this.hRh&&(this.qG.KVb(Rg.a.g6i,this.Ntj),this.ZNd=this.Wzb.i_a("MsoPremiumStockImages",Ua=>{z.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");Ua.isEnabled?this.qG.sendMessage(Rg.a.UGk,{["LicenseTier"]:Ua.toString()}):
z.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.PLc(3)}dispose(){this.Lda=null;this.Wzb&&this.ZNd&&this.Wzb.b3d("MsoPremiumStockImages",this.ZNd);this.qG&&(this.qG.dispose(),this.qG=null);super.dispose()}hide(){super.hide();Dh.a.zMc(this.$)}get eba(){return qh.a.nkc+"/InsertMediaDialog"}get u4(){return!1}Qkj(D,ma){D=D&&D.Values?(D=D.Values)?Object(Ka.a)(new Lg,{Action:D.action||"",Caption:D.caption||"",ContentType:D.contentType||
"",FileExtension:D.extension||"",PageUrl:D.pageUrl||"",SourceUrl:D.sourceUrl||"",ThumbnailUrl:D.thumbnailUrl||"",LicenseUrl:D.licenseUrl||"",LicenseDisplayName:D.licenseDisplayName||"",Height:D.height||0,Width:D.width||0}):null:null;D&&(this.Lda.push(D),this.Rwc&&(z.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),ma(this.Lda),this.Rwc=!1,this.PCa(this.v9a)))}dtj(D){this.Lda&&0<this.Lda.length?this.Lda.length<=this.EOe?(D(this.Lda),this.PLc(0),this.PCa(this.v9a)):
(this.RE(),z.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.Lda.length=0,this.PLc(2)):this.Rwc=!0}lIh(){const D=document.createElement("div");D.id="InsertMediaDialog";D.className=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const ma=document.createElement("div");ma.id="InsertMediaPanel";ma.className=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",
!0)?"insert-media-panel":"insert-media-panel-old";const Ua=document.createElement("iframe");Ua.id="InsertMediaFrame";Ua.className="insert-media-frame";D.appendChild(ma);ma.appendChild(Ua);return jg.b(D)}RE(){const D=Cb.a.Fg(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");D.Description=String.format(ad.a.instance.He(206),this.EOe.toLocaleString());new se.a(this.$,D)}eri(){return 2===this.Mib?"M365":"bing"}PLc(D){var ma,Ua;if(2===this.Mib||1===this.Mib){const yc=P.AFrameworkApplication.fa.Ta("InsertMediaDialogAriaTenantNameSpace");
if(yc&&""!==yc){var Xb=[];Array.add(Xb,Object.assign(new Ja.a,{name:"DialogMode",string:this.eri()}));Array.add(Xb,Object.assign(new Ja.a,{name:"Provider",string:ug[this.Mib]}));Array.add(Xb,Object.assign(new Ja.a,{name:"InsertedFiles",int64:null===(ma=this.Lda)||void 0===ma?void 0:ma.length}));Xb.push(Object.assign(new Ja.a,{name:"MediaDetails",string:this.Lda?JSON.stringify(this.Lda.map(Tc=>Tc.SourceUrl)):null}));Array.add(Xb,Object.assign(new Ja.a,{name:"DialogResult",string:uh[D]}));Array.add(Xb,
Object.assign(new Ja.a,{name:"CorrelationId",string:null===(Ua=this.correlationId)||void 0===Ua?void 0:Ua.toString()}));Dg.a.sendTelemetryEvent(Object.assign(new Jh.a,{name:String.format("{0}.{1}",yc,"InsertOnlineImages"),dataFields:Xb}))}}}}Object(w.a)(Fb,"InsertMediaDialog",Me.a,[]);var rc=a(404),Hc=a(309);class $c extends yf{constructor(D,ma,Ua,Xb,yc,Tc){super(null,Ua,Xb);this.SRf=0;this.Hea=Sc=>{if(Sc){var Gd=Array(Sc.length);for(var De=0;De<Sc.length;De++){const nf=Sc[De];Gd[De]={};Gd[De].SourceUrl=
nf.SourceUrl;jb.a.Lsa(nf.LicenseUrl)&&jb.a.Lsa(nf.PageUrl)&&(Gd[De].LicenseUrl=nf.LicenseUrl,Gd[De].LicenseDisplayName=nf.LicenseDisplayName,Gd[De].PageUrl=nf.PageUrl);Gd[De].AltText=-2053056795===this.xg.command?nf.Caption:"";Gd[De].IsCellPicture=15735758===this.xg.command||570484235===this.xg.command}var ve=-2009825598===this.xg.command?"bing":"M365";De=ua.h(this.$);var Xe=Va.o(De.ha.pa.activeCell,this.$);Vb.a(this.$.userOperationManager,(nf,uf,rg)=>Wf.v(this.$.oa.ua,Xe,Gd,ve,Vc.b(nf,this.Bvj),
Vc.a(uf,this.Avj),rg,null),nf=>new eb.a(595,0,nf),this.xg);ac.HelperMethods.s6?(De=new Map,De.set("MediaProvider",ve),De.set("ImagesCount",Sc.length.toString()),De.set("TimeTakenToOpenDialog",this.SRf.toString()),Y.Health.instance.recordKpiUsage(Hc.a.ZPi,1,rc.a.PEg,De)):z.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.sTb()}else z.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
this.Bvj=Sc=>{if(ng.a(Sc))z.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${Cb.a.xf(Sc.Errors)}`);else{z.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const Gd=this.xg.command;15735758!==Gd&&570484235!==Gd&&(Sc.Result?Ra.a(this.$).Jda(1,Sc.Result):z.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};
this.Avj=()=>{z.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=D;this.xg=ma;this.$N=Tc;this.oPe=oa.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let D=null;D=this.$.Ve.Sf("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.xg.command){case -2009825598:case 15735758:this.ckk();break;case -2053056795:case 570484235:this.oPe.execute(ma=>{ma.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(Ua=>z.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${Ua}`)).then(Ua=>{this.dkk(Ua);return null})})}D.stop();this.SRf=D.gg}ckk(){let D=this.$.xa.BingPictureEndpoint;const ma=Sf.a.wP(P.AFrameworkApplication.lcid),Ua=ta.a.create();D?(D=0<D.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(D,1,1):String.format(D,1,P.AFrameworkApplication.lcid,ma?ma.name:"en-us",P.AFrameworkApplication.buildVersion,
Ua.toString(),1,this.$.xa.DocumentHostInfo.LoggableUserId),this.uic(D,1,-1,ad.a.instance.ia(1764))):(z.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.$N.setException(Error.create("Failed to access the Bing service endpoint")))}dkk(D){var ma=this.$.xa.M365PictureEndpoint,Ua=ta.a.create();if(ma){var Xb=this.$.xa.DocumentHostInfo.UserId;Xb=Xb?jb.a.XA(Xb).toString():"0";var yc=this.oPe.instance.isFreemiumUpsellEnabled();
D=D?1:yc?0:-1;Ua=Ua.toString();yc=Sf.a.wP(P.AFrameworkApplication.lcid).name;ma=String.format(ma,P.AFrameworkApplication.lcid,yc,P.AFrameworkApplication.buildVersion,Ua,1,Xb,D,1);this.uic(ma,2,D,ad.a.instance.ia(1763))}else z.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.$N.setException(Error.create("Failed to access the M365 service endpoint"))}uic(D,ma,Ua,Xb){try{(new Fb(this.$,D,oa.a.instance.pj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
ma,Ua,Xb)).Skk(this),this.$N.setResult(!0)}catch(yc){z.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${yc}] [MediaProvider : ${ma}] [DialogLicenseTier : ${Ua}]`),this.$N.setException(yc)}}}Object(w.a)($c,"OnlinePictureUploaderWrapper",yf,[2]);let Hd=class{constructor(D,ma){this.$=D;this.uploaderCreator=ma}executeCommand(D,ma,Ua){D=ma.command;switch(D){case 1403967063:case -2060689045:if(Ua&&"dataUrl"in Ua)return ma=new Fe.a,this.uploaderCreator&&
this.uploaderCreator.ANi(this.$,cc.TaskManager.instance,P.AFrameworkApplication.fa,Ua,Ua.dataUrl,ma),ma.task;this.uploaderCreator&&this.uploaderCreator.GOi(this.$,ma,cc.TaskManager.instance,P.AFrameworkApplication.fa,Ua);return nb.Task.Ra(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return D=new Fe.a,new $c(this.$,ma,cc.TaskManager.instance,P.AFrameworkApplication.fa,Ua,D),D.task;default:return Cd.a(D)}}Kf(D,ma){let Ua=this.$.isEditMode;if(Ua)switch(ma.command){case 1403967063:Ua=
!0;break;case -2053056795:Ua=!0;break;case -2009825598:Ua=!0;break;case -2060689045:case 15735758:case 570484235:Ua=Pd.a.cNb()&&1===D;break;default:Ua=!1}return Ua}Yf(){return!1}Uf(){return!1}};Hd=Object(vb.__decorate)([Object(Eb.d)(kc.mc),Object(vb.__param)(0,Object(kc.nb)()),Object(vb.__param)(1,Object(kc.qe)())],Hd);Object(w.a)(Hd,"PictureCommandHandler",null,[165]);class Ud extends Wa.a{constructor(D){super(D)}lj(){ne.TaskExtensions.Ca(Object(ub.d)(Eb.a.resolve(kc.qe,{Aa:this.$a})),D=>{this.Gi([new Hd(this.$,
D.result)])},this.$.qa,3)}static ta(D){Wa.a.Kk(90,new Ud(D))}}Object(w.a)(Ud,"PictureCommandHandlerFactory",Wa.a,[]);var wa=a(408),sa=a(48);class fc{constructor(){this.Tka=this.Mlf=null}}Object(w.a)(fc,"GestureAdapterInfo",null,[]);class yd{constructor(){this.SYc=null}K7i(){if(!this.SYc){var D="hammer.min.js";P.AFrameworkApplication.fa.Zr("IsServerFlavorDebug")&&(D=P.AFrameworkApplication.fa.la("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");D=P.AFrameworkApplication.KE(String.format("{0}",D),
5);D=kb.a.create(D,null,null);bb.a.oqa(D);this.SYc=D.fib}return this.SYc}static get instance(){yd.Ka||(yd.Ka=new yd);return yd.Ka}}yd.Ka=null;Object(w.a)(yd,"HammerJsDependencyLoader",null,[697]);var Sd;(function(D){D[D.none=-1]="none";D[D.nGc=0]="pinch";D[D.pan=1]="pan";D[D.ufe=2]="swipe"})(Sd||(Sd={}));Object(w.b)("GestureEvent",Sd);var Ie=a(83);class pf extends Ie.a{constructor(D,ma,Ua,Xb,yc,Tc,Sc,Gd){super(D,Ua,Xb,Tc);this.wsb=ma;this.Lna=Sc;this.h3=Gd;this.LZg=yc}get shiftKey(){return this.Lna}get ctrlKey(){return this.h3}get clientPoint(){return this.wsb}get lDa(){return this.LZg}static create(D,
ma,Ua,Xb,yc,Tc){if(Ua.rawEvent)if(Tc){var Sc=Ua.rawEvent;Sc=new Sys.UI.Point(Sc.clientX,Sc.clientY)}else Sc=Ie.a.ZHb(Ua);else Sc=new Sys.UI.Point(Ua.clientX,Ua.clientY);return new pf(D,Sc,ma,Ua,Xb,yc,Ua.shiftKey,Ua.ctrlKey,Tc)}}Object(w.a)(pf,"GestureEventArgs",Ie.a,[]);class If{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(w.a)(If,"GestureManagerData",null,[]);class bg{}bg.WSg=2;bg.XSg=4;bg.YSg=8;bg.ZSg=8;Object(w.a)(bg,"HammerConstants",null,[]);var hg=a(113),dg=a(211),pg=a(88);class Ug extends sa.a{constructor(D,ma){super();this.Dya=wa.a.Pfi;this.L5c=!!window.PointerEvent;this.zHe=window.hasOwnProperty("ontouchstart");this.i5a=this.Xvb=null;this.vfa=!1;
this.TY=new fa.a;this.pwb=new fa.a;this.MZg=new La.a;this.bya=null;this.m4a=this.Q_c=this.jqe=this.CXc=this.y3c=this.QDe=this.pqe=this.Vxb=!1;this.Bvb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.w8c=null;this.qHa=(Ua,Xb,yc)=>{Ua=this.rqf(Ua);Xb=this.Api(yc);Hammer.inputHandler(this,Ua,Xb);this.vfa&&yc.preventDefault();return this.vfa};this.AYa=(Ua,Xb,yc)=>{var Tc=yc.rawEvent.pointerType.toString();const Sc=yc.rawEvent.pointerId.toString();if("touch"!==Tc)return!1;Ua=this.rqf(Ua);
if(1!==Ua&&!this.TY.$d(Sc))return!1;this.pqe&&1===Ua&&yc.rawEvent.isPrimary&&this.TY.count&&(z.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Ofc());this.Vxb?this.Jah(Sc,Xb,yc):this.TY.da(Sc,yc);this.y3c&&2===Ua&&(!this.CXc||this.CXc&&"function"===typeof yc.rawEvent.getCoalescedEvents)&&(Xb=yc.rawEvent.getCoalescedEvents())&&this.lyf()&&(this.Bvb=Math.max(this.Bvb,Xb.length));this.QDe&&(this.vfa=!1);Tc=this.zpi(this.TY,yc,Tc);Hammer.inputHandler(this,Ua,Tc);if(4===Ua||8===
Ua)this.Vxb?this.Gjg(Sc):this.TY.remove(Sc),this.TY.count||(this.session=null,this.y3c&&-1!==this.Bvb&&(z.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Bvb),this.Bvb=-1));this.vfa&&yc.preventDefault();return this.vfa};this.qEc=()=>!1;this.lh=hg.EventHandlerManager.instance;this.L5c?(z.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Xvb=this.AYa,this.i5a=Oe.a.Rfi):this.zHe?(z.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Xvb=this.qHa,this.i5a=
Oe.a.lqb):(z.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Xvb=this.qEc,this.i5a=Oe.a.Qfi);this.ek=ma;this.Lma=D;P.AFrameworkApplication.fa&&(this.Vxb=P.AFrameworkApplication.fa.la("UsePointerCaptureIsEnabled"),this.pqe=P.AFrameworkApplication.fa.la("ClearCacheOnPrimaryPointerIsEnabled"),this.QDe=P.AFrameworkApplication.fa.la("ResetHandledBeforeInputHandlerIsEnabled"),this.y3c=P.AFrameworkApplication.fa.la("LogCoalescedEventsIsEnabled"),this.CXc=P.AFrameworkApplication.fa.la("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.jqe=P.AFrameworkApplication.fa.la("CheckIfHammerExistsAfterDownloadIsEnabled"),this.Q_c=P.AFrameworkApplication.fa.la("HammerJsPerformanceTimersIsEnabled"),this.m4a=this.Vxb&&P.AFrameworkApplication.fa.la("CancelDragFromGestureInputManagerIsEnabled")&&P.AFrameworkApplication.fa.la("UseGestureInputManagerPointerCacheIsEnabled"))}soi(){return this.L5c?0:this.zHe?1:2}vr(D){super.vr(D);this.lh.fsa(this.i5a,D,0,this.Xvb)}sq(D){super.sq(D);this.lh.GRa(D,this.i5a)}AQj(D,ma,Ua){Ua=void 0===Ua?null:Ua;
var Xb=void 0===Xb?null:Xb;P.AFrameworkApplication.hxc()?yd.instance.K7i().continueWith(yc=>{this.$pk();if(yc.vj||yc.Uk)z.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",yc.status);else{z.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",yc.status);if(this.jqe){yc=window.Hammer;if("undefined"===typeof yc){z.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.BPc();return}if("undefined"===typeof yc.inputHandler){z.ULS.sendTraceTag(590901390,310,
10,"Hammer.inputHandler does not exist");this.BPc();return}}if(!D)throw this.BPc(),Error.argumentNull("source element can not be null");yc=dg.a.QDa(D,this.Dya);if(void 0===yc||null===yc)yc=new fa.a,dg.a.job(D,this.Dya,yc),this.BQj(D);var Tc=null;if(!yc.$d(Sd[0])){Tc=Object;var Sc=Tc.assign,Gd=new fc,De=Sd[0],ve=Xb;ve=void 0===ve?null:ve;if(void 0===this||null===this)throw z.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Xe=null;switch(De){case Oe.a.nGc:Xe=
new Hammer.Pinch(ve);break;case Oe.a.pan:Xe=new Hammer.Pan(ve)}Xe&&(Xe.manager=this);Tc=Sc.call(Tc,Gd,{Tka:Xe,Mlf:ma});yc.add(Sd[0],Tc)}if(void 0!==Ua&&null!==Ua)for(Sc=0;Sc<Ua.length;Sc++)yc.$d(Sd[Ua[Sc]])&&(Gd=yc.ka(Sd[Ua[Sc]]),Tc.Tka.recognizeWith(Gd.Tka))}this.BPc()}):z.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}$pk(){this.Q_c&&(this.ek?this.w8c=this.ek.Sf("Task","RegisterGestureAdapterAfterLoad"):z.ULS.sendTraceTag(590387074,310,
10,"_stopwatchBuilder is null"))}BPc(){this.Q_c&&(this.w8c?this.w8c.stop():z.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}BQj(D){this.MZg.add(D);this.lh.fsa(this.i5a,D,0,this.Xvb)}recognize(D){var ma=Array(D.pointers.length);for(var Ua=0;Ua<D.pointers.length;Ua++)ma[Ua]=D.pointers[Ua].target;Ua=null;for(this.bya=this.Xqi(ma);void 0!==this.bya&&null!==this.bya&&(Ua=dg.a.QDa(this.bya,this.Dya),void 0===Ua||null===Ua);this.bya=this.bya.parentNode);if(void 0!==
Ua&&null!==Ua){this.curRecognizer&&this.curRecognizer.state===bg.ZSg&&(this.curRecognizer=null);ma=Ua.keys;for(const Xb of ma){ma=Ua.ka(Xb);void 0!==ma&&null!==ma&&void 0!==ma.Tka&&null!==ma.Tka&&(void 0===this.curRecognizer||null===this.curRecognizer||ma.Tka===this.curRecognizer||ma.Tka.canRecognizeWith(this.curRecognizer))&&ma.Tka.recognize(D);const yc=ma.Tka.state;this.curRecognizer||bg.WSg!==yc&&bg.XSg!==yc&&bg.YSg!==yc||(this.curRecognizer=ma.Tka)}}}emit(D,ma){if("hammer.input"!==D){this.vfa=
!1;ma=pf.create(D,this.bya,ma.srcEvent,ma,3,this.L5c);var Ua=dg.a.QDa(this.bya,this.Dya);if(this.$Zi(D))var Xb=0;else if(this.PZi(D))Xb=1;else if(this.f2i(D))Xb=2;else{z.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Ua}=Ua.Ag(Sd[Xb]));void 0!==Ua&&null!==Ua&&((Ua=Ua.Mlf,Ua.aXi())?D.endsWith("start")?this.vfa=Ua.xqj(ma):D.endsWith("end")?(Ua.vqj(ma),this.vfa=!0):D.endsWith("cancel")?(Ua.uqj(ma),this.vfa=!0):D.endsWith("move")&&(this.vfa=Ua.wqj(ma)):
z.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",D))}}get(D){return Object(R.a)(Hammer.Recognizer,D)}Xqi(D){if(1>D.length)return null;if(1===D.length)return D[0];var ma=D[0],Ua=!0;for(let Xb=1;Xb<D.length;Xb++){if(!D[Xb])return null;if(ma!==D[Xb]){Ua=!1;break}}if(Ua)return ma;ma=this.dmf(D[0]);Ua=0;for(const Xb of D){D=this.dmf(Xb);if(ma.ka(ma.count-1)!==D.ka(D.count-1))return null;for(let yc=ma.count-2,Tc=D.count-2;yc>=Ua&&0<=Tc;yc--,Tc--)if(ma.ka(yc)!==D.ka(Tc)){Ua=
yc+1;break}}return ma.ka(Ua)}dmf(D){const ma=new La.a;for(;void 0!==D&&null!==D;D=D.parentNode)ma.add(D);return ma}rqf(D){switch(D){case Oe.a.oj:case Oe.a.bpa:return 1;case Oe.a.mk:case Oe.a.TPa:return 2;case Oe.a.Uh:case Oe.a.aBb:return 4;case Oe.a.pRc:case Oe.a.ufd:return 8}return 0}lyf(){return 1<this.TY.count}Ofc(){z.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Vxb)for(const D of this.TY)this.Gjg(D.key);else this.TY=new fa.a;this.session=null}Jah(D,ma,Ua){z.ULS.sendTraceTag(594055959,
310,50,"AddOrReplacePointerInCaches: pointerId: {0}",D);if(!this.pwb.$d(D)){try{ma.setPointerCapture(D)}catch(Xb){z.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Xb)}this.pwb.add(D,ma)}this.TY.da(D,Ua);this.m4a&&1<this.TY.count&&this.Lma&&!this.Lma.NBb&&(this.Lma.NBb=!0)}Gjg(D){z.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",D);if(this.pwb.$d(D)){try{this.pwb.ka(D).releasePointerCapture(D)}catch(ma){z.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ma)}this.pwb.remove(D)}else z.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",D);this.TY.remove(D);this.m4a&&1>=this.TY.count&&this.Lma&&this.Lma.NBb&&(this.Lma.NBb=!1)}Api(D){const ma=new If;var Ua=D.rawEvent;const Xb=Ua.touches;Ua=Ua.changedTouches;ma.pointers=Array.clone(Xb);ma.pointers=Array.clone(0<Xb.length?Xb:Ua);ma.changedPointers=Array.clone(Ua);ma.srcEvent=D;ma.pointerType="touch";return ma}zpi(D,ma,Ua){const Xb=new If;Xb.pointers=pg.toArray(D.values);Xb.changedPointers=[ma];Xb.pointerType=Ua;Xb.srcEvent=
ma;return Xb}$Zi(D){return jb.a.startsWith(D,Oe.a.nGc)}PZi(D){return jb.a.startsWith(D,Oe.a.pan)}f2i(D){return jb.a.startsWith(D,Oe.a.ufe)}}Object(w.a)(Ug,"GestureInputManager",sa.a,[677,678]);var $g=a(361);class ih{constructor(){this.$b=null;this.iC=!1}get name(){return"Common.App.GestureInputManager"}dl(D){D.register(Ug,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").If().Rf(()=>new Ug($g.a.instance,P.AFrameworkApplication.ra.NG));this.$b=D}init(){this.iC||(this.$b.resolve("Common.App.GestureManager.GestureInputManager"),
this.iC=!0)}dispose(){}static main(){Ea.a.instance.Ul(new ih)}}Object(w.a)(ih,"GestureInputManagerPackage",null,[4,5]);var Zf=a(109);class gh extends Zf.a{constructor(){super()}static instance(){return gh.Ka||(gh.Ka=new gh)}}gh.Tyj="OnTextSelectionHighlightChangeEvent";gh.Ka=null;Object(w.a)(gh,"TextSelectionHighlightChangeEvent",Zf.a,[]);class Zg extends Me.a{constructor(D,ma){super(!1,!1,!0);this.kXb=(Ua,Xb)=>{1===Ua&&(this.gLa.pEd=Xb.tooltipPersistenceEnabled,Ua=Xb.textSelectionChangeEnabled,this.gLa.A0b!==
Ua&&this.f7g.raiseEvent(gh.Tyj),this.gLa.A0b=Ua)};this.gLa=D;this.f7g=ma}start(){const D={["tooltipPersistenceEnabled"]:this.gLa.pEd};D.textSelectionChangeEnabled=this.gLa.A0b;this.initializeAndShow("",this.kXb,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:D});z.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(w.a)(Zg,"AccessibilitySettingsDialog",Me.a,[]);var Sg=a(129);class Ah{constructor(D,ma){this.ojk=()=>{(new Zg(this.gLa,gh.instance())).start();
return 32};this.Ma=D;this.gLa=ma}ik(){this.Ma.hf(ha.a.njk,Sg.a.frame,this.ojk)}}Object(w.a)(Ah,"AccessibilitySettingsDialogActor",null,[720]);const rh=D=>{const ma=new Fe.a;P.AFrameworkApplication.lg.ir(Mb(D),1,null,null,!0,2,Ua=>{200===Ua.data.httpStatus?ma.setResult("true"===Ua.data.responseData.toLowerCase()):ma.setResult(!1)},()=>{ma.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ma.task},Oa=(D,ma)=>{P.AFrameworkApplication.lg.ir(Mb(D),2,ma.toString().toLowerCase(),null,!0,2,null,
null,null,void 0,void 0,void 0,void 0,"8")},Mb=D=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",P.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",D,P.AFrameworkApplication.ml);var sc=a(152);class vc{constructor(){this.f7a=this.o5a=null}get pEd(){return!!this.o5a}set pEd(D){D!==this.o5a&&(this.o5a=D,sc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(D),this.ayc()&&Oa("saveHoverableRibbonTooltipIsEnabled",D))}get A0b(){return!!this.f7a}set A0b(D){D!==
this.f7a&&(this.f7a=D,this.ayc()&&Oa("saveTextSelectionHighlightChangeIsEnabled",D))}R7i(){const D=new Fe.a;if(this.o5a)D.setResult(this.o5a);else if(this.ayc()){const ma=rh("getHoverableRibbonTooltipIsEnabled");ma.continueWith(()=>{this.o5a=ma.result;sc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ma.result);D.setResult(ma.result)},8)}else D.setResult(!1)}q8i(){const D=new Fe.a;if(this.f7a)D.setResult(this.f7a);else if(this.ayc()){const ma=rh("getTextSelectionHighlightChangeIsEnabled");
ma.continueWith(()=>{this.f7a=ma.result;D.setResult(ma.result)},8)}else D.setResult(!1)}ayc(){const D=P.AFrameworkApplication.fa.la("IsRoamingServiceEnabled"),ma=P.AFrameworkApplication.fa.la("IsAnonymousUser");return D&&!ma}}Object(w.a)(vc,"AccessibilitySettingsInfo",null,[679]);var vd=a(122);class Qd{constructor(){this.$b=null}get name(){return"Common.App.AccessibilitySettings"}dl(D){this.$b=D;this.$b.register(vc,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Rf(()=>
new vc).If();this.$b.register(Ah,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Rf(()=>new Ah(P.AFrameworkApplication.Oe,this.$b.pj("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).If()}init(){const D=this.$b.pj("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ma=this.$b.pj("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");D&&ma?(ma.ik(),D.R7i(),D.q8i(),
vd.a(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",D.A0b)):vd.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){Ea.a.instance.Ul(new Qd)}}Object(w.a)(Qd,"AccessibilitySettingsPackage",null,[4,5]);class de extends Me.a{constructor(D,ma){super(!1,!1,!0);this.kXb=(Ua,Xb)=>{if(1===Ua){Ua=Xb.showRibbonChoice;if(this.fEe!==Xb.ribbonLayoutChoice)appChrome.onRibbonModeToggle();
this.ZFe!==Ua&&("AlwaysShow"===Ua?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.fEe=D;this.ZFe=ma}start(){this.initializeAndShow("",this.kXb,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.fEe,["showRibbonChoice"]:this.ZFe}})}}Object(w.a)(de,"RibbonSettingsDialog",Me.a,[]);class xe{constructor(D){this.Ma=D}ik(){this.Ma.hf(ha.a.amk,Sg.a.frame,this.bmk)}bmk(){let D="SingleLineRibbon";"Multiline"===appChrome.selectors.getRibbonMode()&&
(D="ClassicRibbon");const ma=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new de(D,ma)).start();return 32}}Object(w.a)(xe,"RibbonSettingsDialogActor",null,[676]);class ef{constructor(){this.$b=null}get name(){return"Common.App.RibbonSettings"}dl(D){this.$b=D;this.$b.register(xe,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").Rf(()=>new xe(P.AFrameworkApplication.Oe)).If()}init(){const D=this.$b.pj("Common.App.RibbonSettings.IRibbonSettingsDialogActor");
D?D.ik():vd.a(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){Ea.a.instance.Ul(new ef)}}Object(w.a)(ef,"RibbonSettingsPackage",null,[4,5]);var Ff=a(34),xf=a(14),cg=a(311);class Bf{constructor(D){this.QKc=D||""}static get G$e(){return Bf.Vse||(Bf.Vse=new Bf(""))}static get HPd(){return Bf.Bze||(Bf.Bze=Bf.Y_(2).QKc)}static Vqa(D){D=jb.a.Qn(D||"");return new Bf(D)}static Xqa(D){return Bf.Vqa(ad.a.instance.ia(D))}static Y_(D){return new Bf(ad.a.instance.za(D))}static Xud(D,
...ma){return Bf.Vci(ad.a.instance.He(D),...ma)}static Vci(D,...ma){const Ua=ma.length,Xb=Array(Ua);for(let yc=0;yc<Ua;yc++)Xb[yc]=(ma[yc]||Bf.G$e).QKc;return new Bf(String.format(D,Xb))}}Bf.Vse=null;Bf.Bze=null;Object(w.a)(Bf,"SafeHtml",null,[571]);const Mf=(D,ma)=>{ma&&(D.append(ma),D.append(Bf.HPd))};var ah=a(120),Eh=a(835),Uh=a(234),sh;let oh=sh=class{constructor(D,ma,Ua){this.E7=this.yX=this.tQ=null;this.Pqa=kc.Ab.$e()?ma.cellTextEditBox.Ja.Ii:Ua;this.vKh(D);this.mHj();kc.Ab.$e()||D.ja.$c(244,
this)}get isActive(){return!!this.Pqa&&document.activeElement===this.Pqa}readText(D){D=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?D:String.format(ad.a.instance.He(30),D);this.tQ.setAttribute(id.a.Ly,D);this.yX.setAttribute(id.a.Ly,D);this.usk()}dispose(){this.E7&&this.E7.parentNode&&this.E7.parentNode.removeChild(this.E7);this.yX=this.tQ=this.E7=this.Pqa=null}vKh(D){var ma=D.Af+"readoutElementWrapper";const Ua=D.Af+"readoutElement1",Xb=D.Af+"readoutElement2";
this.E7=document.getElementById(ma);this.E7||(this.E7=document.createElement(Uh.a.div),this.E7.id=ma,this.tQ=document.createElement(Uh.a.label),this.tQ.id=Ua,this.tQ.setAttribute(id.a.ih,id.a.Wdc),this.tQ.setAttribute("aria-roledescription",""),this.tQ.setAttribute("aria-multiline",!1),this.yX=document.createElement(Uh.a.label),this.yX.id=Xb,this.yX.setAttribute(id.a.ih,id.a.Wdc),this.yX.setAttribute("aria-roledescription",""),this.yX.setAttribute("aria-multiline",!1),this.tQ.style.width="0px",this.tQ.style.height=
"0px",this.yX.style.width="0px",this.yX.style.height="0px",this.tQ.tabIndex=-1,this.yX.tabIndex=-1,this.E7.appendChild(this.tQ),this.E7.appendChild(this.yX),D=D.Af+id.a.Rhc,ma=document.getElementById(D),z.ULS.shipAssertTag(537153942,3,!!ma,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${D}`),ma&&ma.appendChild(this.E7))}mHj(){this.Pqa&&this.tQ&&this.yX&&(this.Pqa.setAttribute(id.a.y$,this.tQ.id),this.Pqa.setAttribute(id.a.Vdc,`${this.tQ.id} ${this.yX.id}`))}usk(){if(Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||
this.isActive){let D="";xf.DOMElementExtensions.hasAttribute(this.Pqa,id.a.y$)&&(D=this.Pqa.getAttribute(id.a.y$).toString());this.Pqa.setAttribute(id.a.y$,D===this.tQ.id?this.yX.id:this.tQ.id)}this.isActive||z.ULS.sendTraceTag(537153941,0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static LVa(){if(null==sh.hHb)if(Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8104883_ActiveDescendantGridReadout")&&!za.a.EFa)sh.hHb=!0;else if(sh.hHb=!1,za.a.tK||za.a.hj)sh.hHb=!0;return sh.hHb}};
oh.hHb=null;oh=sh=Object(vb.__decorate)([Object(Eb.d)(kc.Ab),Object(vb.__param)(0,Object(kc.nb)()),Object(vb.__param)(1,Object(kc.bc)())],oh);Object(w.a)(oh,"FocusBasedReadout",null,[557,2]);let Wh=class{constructor(D,ma,Ua,Xb){Ua=void 0===Ua?D.AC:Ua;Xb=void 0===Xb?D.Bi:Xb;this.x_f=(yc,Tc)=>{this.u1d(Tc.xg.command)};this.msg=()=>{if(!this.$.ea.tf){var yc={["AriaLiveOffCount"]:this.Toe,["AriaLivePoliteCount"]:this.Uoe,["AriaLiveAssertiveCount"]:this.Soe,["AriaLiveRudeCount"]:this.Voe,["ScreenReaderDivCount"]:this.PEe,
["AlertScreenReaderDivCount"]:this.Boe,["AuxScreenReaderDivCount"]:this.cpe,["AriaAlertCount"]:this.Qoe,["ReadCommandOnCompletionCount"]:this.tDe,["TotalAriaLiveRegionUpdates"]:this.yHe};Dg.a.sendTelemetryEvent(Object(Ka.a)(new Jh.a,{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:ah.a.Bl(yc)}))}};this.$=D;this.wf=void 0===ma?null:ma;this.Tea=document.createElement("div");this.Tea.setAttribute(id.a.A$,id.a.Jn);this.Tea.className=Ff.a.krd;Ua.insertBefore(this.Tea,Xb);this.Ufa=
document.createElement("div");this.Ufa.setAttribute(id.a.A$,id.a.Jn);this.Ufa.className=Ff.a.krd;Ua.insertBefore(this.Ufa,this.Tea);this.Y1g=ad.a.instance.za(2);this.C$=document.createElement("div");this.C$.setAttribute(id.a.ih,id.a.Moa);this.C$.setAttribute(id.a.Noa,id.a.BPa);this.C$.className=Ff.a.krd;Ua.insertBefore(this.C$,this.Ufa);this.yHe=this.tDe=this.Qoe=this.cpe=this.Boe=this.PEe=this.Voe=this.Soe=this.Uoe=this.Toe=0;this.register();Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)||this.$.ja.$c(211,this)}get xXa(){return this.Y1g}get isActive(){return!0}get Phh(){return this.Tea}get C4j(){return this.Ufa}get activeCell(){return ua.h(this.$).Pe(null)}get fMb(){return Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",!1)}dispose(){this.$&&this.unregister();xf.DOMElementExtensions.Lj(this.C$);xf.DOMElementExtensions.Lj(this.Tea);xf.DOMElementExtensions.Lj(this.Ufa);this.Ufa=this.Tea=this.C$=this.$=null}setEnabled(D){this.$tg(this.Ufa,
D)}Z9j(){this.$tg(this.Tea,!0)}readText(D){this.Ylb(Bf.Vqa(D),!0)}D7(D){this.Ylb(Bf.Vqa(D),!1)}sgg(D,ma){if(1>ma||!D)z.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Ua=new Sys.StringBuilder;D=String.format(ad.a.instance.He(34),ma,D);Mf(Ua,D);Mf(Ua,ad.a.instance.ia(857));this.Ylb(Bf.Vqa(Ua.toString()),!1)}}zNj(D,ma,Ua){if(1>Ua||1>ma||ma>Ua||!D)z.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Xb=new Sys.StringBuilder;Mf(Xb,D);Xb.append(String.format(ad.a.instance.He(55),
ma,Ua));this.Ylb(Bf.Vqa(Xb.toString()),!1)}}u1d(D){this.fMb||(D=this.lwi(D),this.Ylb(D,!1))}xNj(D){this.fMb&&(D=this.kwi(D),this.Ylb(D,!1,!0))}Ylb(D,ma,Ua){Ua=void 0===Ua?!1:Ua;if(D=D?D.QKc:null)ma=ma?this.Ufa:this.Tea,Lc.a.equals(ma.innerHTML,D,!1)&&(D+=Bf.HPd),this.PGg(ma,Ua),this.wf.tm(ma,D)}TZa(D,ma){this.C$.getAttribute(id.a.Noa)!==ma&&this.C$.setAttribute(id.a.Noa,ma);D=D?Bf.Vqa(D).QKc:"";this.PGg(this.C$);this.wf.tm(this.C$,D)}ANj(D,ma,Ua,Xb){var yc=!0;yc=void 0===yc?!1:yc;const Tc=ad.a.instance.He(54);
z.ULS.shipAssertTag(537153949,0,!(void 0===D||null===D));z.ULS.shipAssertTag(537153948,0,!(void 0===ma||null===ma));z.ULS.shipAssertTag(537153947,0,!(void 0===Ua||null===Ua));z.ULS.shipAssertTag(537153946,0,!(void 0===Xb||null===Xb));z.ULS.shipAssertTag(537153945,0,!(void 0===Tc||null===Tc));D=String.format(Tc,D||"",ma||"",Ua||"",Xb||"");yc?this.TZa(D,id.a.xAa):this.readText(D)}CCk(D){var ma=this.Ufa.style;D?(D=cg.a.nUe(D.cell,ma),ma=D.wA,ma.top=ma.left=ma.bottom=ma.right=null,D.BZ()):ma.cssText=
""}lwi(D){if(this.fMb)return null;switch(D){case -1985798686:return Bf.Xqa(12);case -911352779:return Bf.Xqa(11);case 237279923:return Bf.Xqa(13);case -1502853784:return Bf.Y_(81);case -111689794:return Bf.Y_(78);case -287251124:return this.fAd(1333,ma=>ma.bold);case -1925065947:return this.fAd(1334,ma=>ma.italic);case 1764140053:return this.fAd(1335,ma=>ma.underline)}return null}kwi(D){if(!this.fMb||6!==D.Ch)return null;const ma=this.activeCell;if(!ma)return null;switch(D.command){case -1985798686:return Bf.Xqa(12);
case -911352779:return Bf.Xqa(11);case 237279923:return Bf.Xqa(13);case -1502853784:return Bf.Y_(81);case -111689794:return Bf.Y_(78);case 368460465:D=ua.h(this.$).Je.gj(ma.range,!0);if(null!==D)return this.aUa(2291,!D.hasAutoFilter,!1);D=this.$.sa.na;if(!D)break;return this.aUa(2291,null===D.KI,!1);case -1522760979:return this.aUa(1150,ua.h(this.$).isFormulaView,!1);case 1941920197:return Bf.Xqa(836);case 1051390410:return Bf.Y_(589);case 1542466017:return Bf.Y_(591);case -706918724:return Bf.Y_(590);
case 369708605:return Bf.Y_(592);case -1215659745:return Bf.Y_(523);case 1783960667:return Bf.Y_(521);case -1355155015:return Bf.Y_(554);case -1158102843:return Bf.Y_(522);case -287251124:return D=this.vwc(D.command,ma),null===D?null:this.aUa(1333,D);case -1925065947:return D=this.vwc(D.command,ma),null===D?null:this.aUa(1334,D);case 1764140053:return D=this.vwc(D.command,ma),null===D?null:this.aUa(1335,D);case -1590502662:return D=this.vwc(D.command,ma),null===D?null:this.aUa(1336,D);case 862890474:case 963349338:D=
this.FDa(ma);if(null===D)break;D=Bf.Vqa(String(D));return Bf.Xud(214,D);case 1896159024:return Bf.Vqa(ad.a.instance.He(228));case -1554384558:return Bf.Vqa(ad.a.instance.He(229))}return null}register(){z.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(z.ULS.shipAssertTag(537153943,0,!!this.$.Ha,"Can't register to CommandHandlerManager's event"),this.$.Ha&&this.$.Ha.$Oa(this.x_f),this.$.ea&&this.$.ea.wF(this.msg))}unregister(){this.$&&(this.$.Ha.rIa(this.x_f),
this.$.ea.xG(this.msg))}$tg(D,ma){const Ua=D===this.Tea;ma?(Ua&&oh.LVa()||D.setAttribute(id.a.Noa,id.a.xAa),Ua&&D.setAttribute(id.a.ih,id.a.Moa),D.setAttribute(id.a.A$,id.a.Gw),D.removeAttribute(id.a.A$),this.wf.tm(D,D.innerHTML+" ")):(D.removeAttribute(id.a.Noa),Ua&&D.removeAttribute(id.a.ih),D.setAttribute(id.a.A$,id.a.Jn))}fAd(D,ma){const Ua=this.activeCell;if(!Ua)return null;const Xb=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),yc=[7,8];ma=ma(Ua)?
!0:!1;return Bf.Xud(Xb?yc[+ma]:yc[+!ma],Bf.Xqa(D))}PGg(D,ma){ma=void 0===ma?!1:ma;switch(D.getAttribute(id.a.Noa)){case id.a.cRe:++this.Toe;break;case id.a.xAa:++this.Uoe;break;case id.a.BPa:++this.Soe;break;case id.a.Qkh:++this.Voe}switch(D){case this.C4j:++this.PEe;break;case this.Phh:++this.Boe;break;case this.C$:++this.cpe}D.getAttribute(id.a.ih)===id.a.Moa&&++this.Qoe;ma&&++this.tDe;this.yHe++}aUa(D,ma,Ua){Ua=void 0===Ua?!0:Ua;return this.fMb?Bf.Xud(ma?Ua?7:216:Ua?8:217,Bf.Xqa(D)):null}vwc(D,
ma){return ua.h(this.$).ha.Ua.isFloatingObjectSelected?this.AWi(D):this.BWi(D,ma)}AWi(D){const ma={};switch(D){case -287251124:D="QueryBold";break;case -1925065947:D="QueryItalics";break;case 1764140053:D="QueryUnderline";break;case -1590502662:D="QueryStrikethrough";break;default:return!1}const Ua=Ra.a(this.$);return Ua?(Ua.yUa(D,ma),ma[Eh.a.On]):!1}BWi(D,ma){if(!ma)return null;var Ua=ua.h(this.$);ma=Td.a(ma);Ua.De&&(ma.Font=Ua.lm.GDa(ma.Font));Ua=ma.Font;switch(D){case -287251124:return Ua.Bold;
case -1925065947:return Ua.Italic;case 1764140053:return Ua.Underline;case -1590502662:return Ua.Strikethrough}return!1}FDa(D){if(!D)return null;const ma=ua.h(this.$);if(ma.ha.Ua.isFloatingObjectSelected)return null;D=Td.a(D);ma.De&&(D.Font=ma.lm.GDa(D.Font));return D.Font.FontSize}};Wh=Object(vb.__decorate)([Object(Eb.d)(kc.i),Object(vb.__param)(0,Object(kc.nb)()),Object(vb.__param)(1,Object(kc.fc)())],Wh);Object(w.a)(Wh,"AriaLiveNotifier",null,[560,557,2]);class vh extends Qb.a{constructor(D){super();
this.$=D;this.Dg()}create(){const D=Object(ub.d)(Eb.a.resolve(kc.fc,{Aa:this.$a}));ne.TaskExtensions.Ca(ne.TaskExtensions.Dh([D],this.$.qa),()=>{this.Df(this.$.ja.Qa(211)||new Wh(this.$,D.result,this.$.AC,this.$.Bi))},this.qa,3)}static ta(D){D.ja.$c(212,new vh(D))}}Object(w.a)(vh,"AriaLiveNotifierFactory",Qb.a,[]);class Qh extends Qb.a{constructor(D){super();this.$=D;this.Dg()}create(){oh.LVa()?ua.h(this.$).cellTextEditBox.Ja.NZ(()=>{const D=this.$.ja.Qa(244)||new oh(this.$,null,ua.h(this.$).cellTextEditBox.Ja.Ii);
this.Df(D)}):this.Df(null)}static ta(D){D.ja.$c(315,new Qh(D))}}Object(w.a)(Qh,"FocusBasedReadoutFactory",Qb.a,[]);const yh=D=>{switch(D){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;
case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var Kh=a(218);class jh{static get yMj(){return jh.lDe||(jh.lDe=RegExp("([A-Z]+)","g"))}static get xMj(){return jh.kDe||(jh.kDe=RegExp("([A-Z])","g"))}static get Zwh(){return jh.kqe||(jh.kqe=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Vzd(D){return jh.Psf(D.toString())}static Psf(D){return jh.Zwh.test(D)?
D.replace(jh.yMj,"$1 ").replace(jh.xMj,' "$1"').trim():D}static hYj(D){const ma=D.lastIndexOf("!");return D.substring(0,-1<ma?ma+1:0)+jh.Psf(D.substring(-1<ma?ma+1:0,D.length))}}jh.lDe=null;jh.kDe=null;jh.kqe=null;Object(w.a)(jh,"RangeAriaExtensions",null,[]);class Xh{constructor(){this.activeItemName=null;this.lKf=!1;this.tableName=null;this.u$a=0;this.kQc=!1}}Object(w.a)(Xh,"SelectionReadoutState",null,[]);var Tf;let Ag=Tf=class{constructor(D,ma,Ua,Xb,yc){this.gridReadoutNotifier=null;this.Rlb=
!1;this.OAa=this.sAb=null;this.Qka=()=>{Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?z.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):ua.h(this.$).De&&!ua.h(this.$).inRangePicker||this.Zdc.tv()};this.Lkj=()=>{if(!ua.h(this.$).ha.Ua.IJd){var Tc,Sc=(()=>{let Gd=this.dgi();({activeCell:Tc}=Gd);return Gd})().returnValue;this.readText(Sc,Tc)}};this.jG=()=>{const Tc=this.activeCell;this.readText("Editing",Tc);
Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Tc&&Tc.dtc&&!ua.h(this.$).vyf||this.Zdc.cancel()};this.Lg=()=>{Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?z.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(this.Qka(),this.Rlb&&ua.h(this.$).inRangePicker&&1===ob.a.Ke&&(null===this.sAb?this.sAb=Ga.a.instance.create(this.z1d,Tf.abc,"readSelectedRanges"):this.sAb.tv()))};
this.$=ma;this.ariaLiveNotifier=D;this.I_b=Xb;this.Ug=Ua;this.EI=new Xh;this.LVa=oh.LVa();this.Rlb=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.LVa&&(this.gridReadoutNotifier=yc,z.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?Tf.abc=0:Tf.abc=700);this.Zdc=Ga.a.instance.create(this.Lkj,
Tf.abc,Ob.a.$5j,!1);this.Kl()}get activeCell(){return ua.h(this.$).Pe(null)}dispose(){this.$&&this.Qk();qf.a.Sa(this.Zdc);this.I_b=this.$=this.Zdc=null}rwd(D,ma,Ua){Ua=void 0===Ua?!0:Ua;if(null!==this.$.Le.lk&&"FindAndReplaceDialog"===this.$.Le.lk.Cf||!D)return"";var Xb=this.$.ja;const yc=new Sys.StringBuilder;this.xjh(yc,D,ma);if(Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Tc=this.Ug.tra(D.range);(null===Tc||void 0===Tc?0:Tc.oce)&&this.EPe(yc,Tc);Tc=this.Ug.nu(D.range);
(null===Tc||void 0===Tc?0:Tc.Sra)&&this.EPe(yc,Tc)}Tc=D.V5?this.fqf(D):D.text;Mf(yc,Tc);Tc=this.$.activeItemName;this.EI.activeItemName!==Tc&&(Mf(yc,Tc),this.EI.activeItemName=Tc);Tc=1===ma.length?Va.P(ma).isSingle?"":ad.a.instance.ia(853):String.format(ad.a.instance.He(31),ma.length);Mf(yc,Tc);for(var Sc of ma)Tc=this.LVa?Sc.toString():jh.Vzd(Sc),Mf(yc,Tc),1===ma.length&&Tf.N2i(Sc)&&(Tc=ua.h(this.$).ya.kv(Sc.bottomRight),void 0!==Tc&&null!==Tc&&Tc.text&&(Tc=Tc.V5?this.eqf(Tc,Tc.text):Tc.text,Mf(yc,
Tc)));Sc=D.cell;Sc=this.nti(Sc.c2j,Sc.cAh);Mf(yc,Sc);this.ijh(yc,D);Ua&&(D.dWa?Mf(yc,ad.a.instance.ia(841)):D.tFa&&Mf(yc,ad.a.instance.ia(842)));if(D.hasAutoFilter||D.tia)this.yjh(yc,D.hasAutoFilter?D.cell.autoFilterType:D.cell.xEj),Ua&&Mf(yc,ad.a.instance.ia(844));Kh.d(this.$,D.range)&&Mf(yc,ad.a.instance.ia(848));this.fjh(yc,D);Ua=(Ua=Xb.Qa(14))?Ua.dhi():"";Mf(yc,Ua);D.cy&&(Ua=ua.h(this.$).ya.kv(D.range),Ua=!!Ua&&Ua.hasIgnorableError,Tf.Jfk(D)?Tf.gjh(yc,D):Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
Ua?Mf(yc,ad.a.instance.ia(846)):Mf(yc,ad.a.instance.ia(845)));D.EP&&(Mf(yc,ad.a.instance.ia(847)),D.bKb&&Mf(yc,String.format(ad.a.instance.He(16),D.vNh)),Mf(yc,D.iconName));D.hasRichValueIcon&&(Sc=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateConvertToLinkedEntityManager",!1)?Eb.a.mg(kc.N):this.$.ja.Qa(271),Ua="",Sc&&D.cell.lOd&&(Sc=Sc.u_(D.cell.lOd))&&Sc.DomainId.Id!==Tf.hLk&&(Ua=Sc.Name),D.cell.GSi?(Mf(yc,String.format(ad.a.instance.He(187),Ua)),Mf(yc,ad.a.instance.ia(1812))):
(Mf(yc,String.format(ad.a.instance.He(185),Ua)),Mf(yc,ad.a.instance.ia(1811))));this.lHi(D)&&Mf(yc,Tf.foi(D));(Xb=Xb.Qa(231))&&Mf(yc,Xb.vqf(ma,!0));1===ma.length&&ma[0].isSingle&&Tf.Ifk(D,ma[0],this.$)&&(ma=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateConvertToLinkedEntityManager",!1)?Eb.a.mg(kc.N):this.$.ja.Qa(271))&&Mf(yc,ma.qhi());D.S0b&&D.T0b&&Mf(yc,D.T0b);(ma=D.cell.hhd)&&Mf(yc,ma);this.ejh(yc,D);D.bWa&&D.hUb&&(D=D.QYd)&&(Mf(yc,ad.a.instance.ia(1985)),Mf(yc,D));return yc.toString()}OUe(D){this.OAa=
this.EI;this.EI=Object(Ka.a)(new Xh,{activeItemName:this.OAa.activeItemName,kQc:D?this.OAa.kQc:!1,tableName:D?this.OAa.tableName:"",u$a:D?this.OAa.u$a:-1})}jog(){this.OAa&&(this.EI=this.OAa,this.OAa=null)}nti(D,ma){return 2===D||2===ma?ad.a.instance.ia(875):1===D||1===ma?ad.a.instance.ia(876):""}fqf(D){return this.eqf(D.cell,D.text)}xjh(D,ma,Ua){if(Ua&&1===Ua.length&&Ua[0].isSingle){Ua="";var Xb=this.Ug.tra(ma.range);if(Xb){Ua=Xb.pivotTableName;this.bdd(D,Ua);var yc=Xb.fwc?ad.a.instance.ia(835):"";
Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(yc+=(Xb.altText?Xb.altText+" . ":"")+(Xb.altTextSummary?Xb.altTextSummary:""));this.GPe(D,!0,Ua,yc);Mf(D,this.Ug.A0i(Xb,ma.range)?ad.a.instance.ia(838):"");Mf(D,this.Ug.gUi(Xb,ma.range)?ad.a.instance.ia(837):"")}else if(Xb=this.Ug.nu(ma.range)){Ua=(yc=ua.h(this.$).Je.gj(ma.range))?yc.name:"";this.bdd(D,Ua);let Tc="";yc&&(Tc=(yc.k2a?yc.k2a+" . ":"")+(yc.l2a?yc.l2a:""));this.GPe(D,!1,Ua,Tc);Mf(D,this.Ug.cHf(Xb,
ma.range)?ad.a.instance.ia(837):"")}else this.bdd(D,Ua),this.EI.tableName="",this.EI.u$a=-1}}bdd(D,ma){ma!==this.EI.tableName&&this.EI.tableName&&(D.append(ad.a.instance.ia(this.EI.kQc?834:833)),Mf(D," "+this.EI.tableName))}GPe(D,ma,Ua,Xb){Ua!==this.EI.tableName&&(D.append(ad.a.instance.ia(ma?832:831)),Mf(D," "+Ua),Mf(D,Xb),this.EI.tableName=Ua,this.EI.kQc=ma,this.EI.u$a=-1)}EPe(D,ma){const Ua=ua.h(this.$).ha.pa.activeCell;if(Ua.top!==ma.top&&Ua.left!==this.EI.u$a){D.append(ad.a.instance.ia(837));
ma=new xb.Range(ma.top,Ua.left,ma.top,Ua.left,!0,!0);Mf(D,jh.Vzd(ma));if(ma=ua.h(this.$).Pe(ma))ma=ma.V5?this.fqf(ma):ma.text,Mf(D,ma);this.EI.u$a=Ua.left}}eqf(D,ma){const Ua=D.fI;return D.nEa?String.format(ad.a.instance.He(14),ma,Ua):String.format(ad.a.instance.He(13),ma,jh.hYj(Ua))}Kl(){z.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var D=ua.h(this.$);z.ULS.shipAssertTag(537153929,0,!!D,"Can't register to grid's events");D&&(D.kf.jr(this.jG),D.ya.Uu(this.Qka),
D.tJ(this.Qka),this.Rlb&&D.kf.Wr(this.Yi.bind(this)),D=D.ha,z.ULS.shipAssertTag(537153928,0,!!D,"Can't register to selectionManager's events"),D&&(D.qt(this.Lg),D.add_activeCellChanged(this.Qka),D.Ua.uJ(this.Qka),this.Rlb&&(this.z1d=this.z1d.bind(this))))}}Qk(){if(this.$){var D=ua.h(this.$);D&&(D.kf.$q(this.jG),D.ya.Ot(this.Qka),D.VK(this.Qka),this.Rlb&&D.kf.Zq(this.Yi),D=D.ha)&&(D.Pt(this.Qka),D.remove_activeCellChanged(this.Qka),D.Ua.xQ(this.Qka))}}readText(D,ma){this.LVa&&this.gridReadoutNotifier&&
(Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(D):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(D),this.Rlb&&!ma||this.ariaLiveNotifier.CCk(ma))}Yi(){this.sAb&&this.sAb.cancel()}z1d(){this.readText(this.Ywi())}Ywi(){let D="";ua.h(this.$).ha.rangePicker.pQ.forEach(()=>{D+=void 0});return D+=" selected"}dgi(){let D;D=null;var ma=ua.h(this.$).ha;if(1!==ma.Yh&&!ma.Ua.gf)return z.ULS.sendTraceTag(537153927,
0,15,`selectionManager.CommandSelectionMode=${ma.Yh} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:D};switch(ma.Yh){case 2:return{returnValue:this.gji(ma),activeCell:D};case 64:var Ua=ma.Ua.gf.floatingObject;let Xb="";if(ma=ma.Ua.gf.qx||ma.Ua.gf.$g)Xb=(ma=ma.firstChild)?xf.DOMElementExtensions.getTextContent(ma):"";return{returnValue:String.format(ad.a.instance.He(53),Tf.epc(Ua.altText,Ua.altTextDescription,Ua.name),Xb,Ua.altTextDescription),activeCell:D};
case 4:return{returnValue:Tf.oih(ma.Ua.gf.floatingObject),activeCell:D};case 512:return{returnValue:pa.a.Dof(ma.Ua.gf.floatingObject.spd),activeCell:D};case 8:return Ua=ma.Ua.gf.floatingObject,{returnValue:String.format(ad.a.instance.He(51),Ua?Ua.name:""),activeCell:D};case 1:return D=this.activeCell,Ua=ma.pa.selectedRanges,ua.h(this.$).inRangePicker?this.ivi(ma,D):{returnValue:this.rwd(D,Ua),activeCell:D}}return{returnValue:"",activeCell:D}}ivi(D,ma){D=D.rangePicker.pQ.map(Xb=>Xb.range);const Ua=
ua.h(this.$).Pe(D[0]);return{returnValue:this.rwd(Ua,D),activeCell:ma}}gji(D){const ma=new Sys.StringBuilder;ma.append(Tf.pwh(D));const Ua=this.$.ja.Qa(231);Ua&&Mf(ma,Ua.vqf(D.Ua.gf.floatingObject,!1));return ma.toString()}lHi(D){D=D.OEf();let ma=!1;this.EI.lKf!==D&&(this.EI.lKf=D,ma=!0);return ma}ijh(D,ma){if(ma.veb)if(ma=this.I_b.byi(ma)){var Ua=ad.a.instance,Xb=Ua.ia;a:switch(ma.type){case 0:var yc=828;break a;case 1:yc=829;break a;default:yc=830}Ua=Xb.call(Ua,yc);Mf(D,String.format(ad.a.instance.He(25),
Ua));ma=String.format(ad.a.instance.He(24),jh.Vzd(ma.Jok));Mf(D,ma)}else z.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),Mf(D,String.format(ad.a.instance.He(25),""))}yjh(D,ma){switch(ma){case 1:case 11:Mf(D,ad.a.instance.ia(849));break;case 6:Mf(D,ad.a.instance.ia(849));Mf(D,ad.a.instance.ia(851));break;case 7:Mf(D,ad.a.instance.ia(849));Mf(D,ad.a.instance.ia(852));break;case 2:Mf(D,ad.a.instance.ia(850));Mf(D,ad.a.instance.ia(851));break;case 3:Mf(D,ad.a.instance.ia(850));
Mf(D,ad.a.instance.ia(852));break;default:Mf(D,ad.a.instance.ia(850))}}fjh(D,ma){var Ua;const Xb=this.$.ja.Qa(65);ma=Xb?Xb.qTa(ma.range):null;let yc="";const Tc=Object(R.a)(558,ma);if(ma)yc=!ma.agb&&Tc&&Tc.i2i?String.format(ad.a.instance.He(29),Tc.mtk):String.format(ad.a.instance.He(23),ma.author);else if(null===(Ua=null===Xb||void 0===Xb?void 0:Xb.Xq)||void 0===Ua?0:Ua.lK)yc=String.format(ad.a.instance.He(28),Xb.Xq.qT.author);Mf(D,yc)}ejh(D,ma){const Ua=this.$.ja.Qa(286);Ua&&(ma=Ua.fhi(ze.d(this.$.na),
ma.range))&&0<ma.length&&(ma=String.format(ad.a.instance.He(1===ma.length?220:221),ma[0]),Mf(D,ma))}static oih(D){return String.format(ad.a.instance.He(52),Tf.epc(D.altText,D.altTextDescription,D.name),D.altTextDescription)}static foi(D){return ad.a.instance.ia(D.OEf()?839:840)}static epc(D,ma,Ua){return D||ma?D:Ua}static pwh(D){var ma=D.Ua.gf;D=ma.floatingObject;const Ua=D.kg,Xb=Ua.ChartTitle,yc=D.altText,Tc=D.altTextDescription,Sc=!!(Ua.Attributes&4);return(ma=ma.getSelectionDescription())?ma:Ua.DataRangeForDisplay?
String.format(ad.a.instance.He(Sc?49:47),Tf.epc(yc,Tc,D.name),Tc,Xb,ad.a.instance.ia(yh(Ua.ChartCategory)),Ua.DataRangeForDisplay):String.format(ad.a.instance.He(Sc?50:48),Tf.epc(yc,Tc,D.name),Tc,Xb,ad.a.instance.ia(yh(Ua.ChartCategory)))}static Jfk(D){return Tb.EwaSettings.Ia(101)&&(D.wMb||D.awc)}static gjh(D,ma){ma.O1a?ma.wMb?Mf(D,String.format(ad.a.instance.He(26),ma.O1a.topLeft.toString())):ma.awc&&(ma=ma.O1a.WE(),Mf(D,String.format(ad.a.instance.He(27),(ma.LastColumn-ma.FirstColumn+1).toString(),
(ma.LastRow-ma.FirstRow+1).toString()))):z.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static Ifk(D,ma,Ua){return D.cy||!Tb.EwaSettings.Ia(131)?!1:(D=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateConvertToLinkedEntityManager",!1)?Eb.a.mg(kc.N):Ua.ja.Qa(271))?D.Dvc(ma):!1}static N2i(D){return D.top===D.bottom&&D.left+1===D.right||D.top+1===D.bottom&&D.left===
D.right}};Ag.HQk="#";Ag.hLk=268435712;Ag.abc=500;Ag=Tf=Object(vb.__decorate)([Object(Eb.d)(kc.Fd),Object(vb.__param)(0,Object(kc.i)()),Object(vb.__param)(1,Object(kc.nb)()),Object(vb.__param)(2,Object(kc.ie)()),Object(vb.__param)(3,Object(kc.ce)()),Object(vb.__param)(4,Object(kc.Ab)())],Ag);Object(w.a)(Ag,"SelectionReadoutHandler",null,[559,2]);class Bh extends Qb.a{constructor(D){super();this.$=D;this.Dg()}create(){const D=this.$.ja,ma=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?Object(ub.d)(Eb.a.resolve(kc.i,{Aa:this.$a})):Zd.GetServiceTaskFactory.vf(D,211,212,this.$a),Ua=Object(ub.d)(Eb.a.resolve(kc.ie,{Aa:this.$a})),Xb=Object(ub.d)(Eb.a.resolve(kc.ce,{Aa:this.$a})),yc=kc.Ab.$e()?Object(ub.d)(Eb.a.resolve(kc.Ab,{Aa:this.$a})):Zd.GetServiceTaskFactory.vf(D,244,315,this.$a);ne.TaskExtensions.Ca(ne.TaskExtensions.Dh([ma,Ua,Xb,yc],this.qa),()=>{const Tc=Object(Jc.a)(this.$.ja,226,()=>new Ag(ma.result,this.$,Ua.result,Xb.result,yc.result));this.Df(Tc)},this.$.qa,3)}static ta(D){D.ja.$c(227,
new Bh(D))}}Object(w.a)(Bh,"SelectionReadoutHandlerFactory",Qb.a,[]);var ea=a(128),Ab=a(536);class pc{constructor(){this.CVc={}}c9g(D){this.CVc[D.id.toString()]=D}Cij(D){const ma=this.CVc;for(const Ua in ma)ma[Ua].notify(D,!1);this.CVc={}}iKj(D,ma){ma&&this.c9g(ma);return this.m6f(D,ma)}Spd(D){this.Cij(D)}C$e(D,ma){D.notify(ma,!0)}}Object(w.a)(pc,"AEventEmitter",null,[672]);var wc;(function(D){D[D.notStarted=0]="notStarted";D[D.waiting=1]="waiting";D[D.awa=2]="shouldRetry";D[D.complete=3]="complete"})(wc||
(wc={}));Object(w.b)("EventResultState",wc);class Ld{constructor(){this._state=0}get state(){return this._state}set state(D){z.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:wc[this._state],["NewState"]:wc[D]},"ResultType",this.ntf());this._state=D}}Object(w.a)(Ld,"AEventResult",null,[704]);class ee extends Ld{constructor(){super();this.x8c=this.nwb=null;this.state=0;this.c1c=this.Nve=!1}get rX(){return this.nwb}get rwa(){return this.x8c}get yQi(){return this.Nve}ntf(){return"GetMoreInfo Result"}}
Object(w.a)(ee,"GetMoreInfoResult",Ld,[703,704]);var Pe=a(763),cf=a(538),vf=a(696),Ef=a(612);class ca{constructor(D,ma,Ua,Xb,yc,Tc,Sc,Gd){this.openUrlInNewTab=(De,ve,Xe,nf,uf)=>{uf&&uf.MenuItemId&&(z.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:uf.SourceControlId,["AppType"]:Ef.a[this.fQ]}),He.a.Ph(uf.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.SYa=(De,ve,Xe,nf,uf)=>{if(uf&&uf.MenuItemId){const rg=P.AFrameworkApplication.fa.la("WacInTabOpenMRUIsEnabledForUiHost"),
$f=P.AFrameworkApplication.fa.la("UiHostSupportsDocRebootFeatures");z.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",rg,$f);if(rg&&$f){z.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:uf.SourceControlId,["AppType"]:Ef.a[this.fQ]});De=uf.MenuItemId.toString();const og={};og[cf.a.WZa]="1";og[cf.a.documentUrl]=De;og[cf.a.reason]=vf.a.open;z.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");
P.AFrameworkApplication.kK().execute(bh=>{bh.sendMessage(Rg.a.Z4,og)})}else this.openUrlInNewTab(De,ve,Xe,nf,uf)}return 32};this.jlc=()=>{this.HQf();return 32};this.Ma=D;this.xk=ma;this.uVg=Ua;this.Z8=Xb;this.sh=yc;this.G_c=Tc;this.j_g=Sc;this.X$b=Gd}fQj(){this.gjb.hf(ha.a.openUrlInNewTab,Sg.a.frame,this.openUrlInNewTab);this.gjb.hf(ha.a.SYa,Sg.a.frame,this.SYa);P.AFrameworkApplication.iS?this.HQf():this.gjb.ji(ha.a.jlc,Sg.a.frame,this.jlc,96)}Mja(D,ma,Ua){Ua=void 0===Ua?"":Ua;if(ma&&ma.sK){const Xb=
Pe.a[ma.status];ma=ma.sK.getTime();const yc=this.fB()-ma;z.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:D,["RequestStatus"]:Xb,["ElapsedMs"]:yc,["StartTime"]:ma,["Notes"]:Ua})}else z.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:D})}HQf(){var D=P.AFrameworkApplication.fa.la("QPGVCI"),ma=K.a.$x(document.URL,"wdNewAndOpenCt",D);if(ma){ma=parseInt(ma);var Ua=K.a.$x(document.URL,"wdPreviousSession",
D);D=K.a.$x(document.URL,"wdPreviousCorrelation",D);var Xb=P.AFrameworkApplication.fa.la("NAOPLP");if(P.AFrameworkApplication.iS){var yc=P.AFrameworkApplication.iS.getTime();!ma||ma>yc?z.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:ma,["DocumentLoadedTime"]:yc,["SessionId"]:Ua,["Correlation"]:D}):z.ULS.sendTraceTag(5849683,202,Xb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:yc-
ma,["ClickTimestamp"]:ma,["SessionId"]:Ua,["Correlation"]:D})}else z.ULS.sendTraceTag(5849681,202,Xb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:ma,["SessionId"]:Ua,["Correlation"]:D})}}get gjb(){return this.Ma.value}get zRb(){return this.xk.value}get AWf(){return this.uVg.value}get fQ(){return this.Z8.value}get sCc(){return this.sh.value}get fB(){return this.G_c}get g1(){return this.j_g.value}get supportsGetMoreInfoForPersonalStorage(){return this.X$b.value}static get instance(){return ca.Ka||
(ca.Ka=ca.uS())}static uS(){return new ca(new Ab.a(()=>P.AFrameworkApplication.Oe),new Ab.a(()=>P.AFrameworkApplication.lg),new Ab.a(()=>P.AFrameworkApplication.ra),new Ab.a(()=>P.AFrameworkApplication.ra.Pa.Cj),new Ab.a(()=>P.AFrameworkApplication.jl),()=>(new Date).getTime(),new Ab.a(()=>P.AFrameworkApplication.ra.Pa.g1),new Ab.a(()=>P.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}ca.Ka=null;Object(w.a)(ca,"NewAndOpenCommonHelpers",null,[671]);var ra=a(116);class Gb{constructor(D,
ma,Ua){this.g$b=this.ym=null;this.I6c=0;this.k5g=D;this.sh=ma;this.Tre=Ua}uhh(){this.I6c=this.enb+1}o6d(D){this.ym&&(this.sh.At(this.ym),this.ym=null);D&&(this.I6c=0)}Rpk(D){const ma=this.nvk;0<=ma?(this.uhh(),this.o6d(!1),this.ym=new ra.a(4,1,ma,D,107),this.sh.Li(this.ym)):(this.o6d(!0),z.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Tre}))}get enb(){return this.I6c}get nvk(){return this.enb>=this.Psg.length?-1:this.Psg[this.enb]}get Psg(){if(!this.g$b){const D=(this.k5g.value||
"0").split(",");this.g$b=[];for(let ma=0;ma<D.length;ma++){const Ua=parseInt(D[ma]);isNaN(Ua)?z.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Tre,["Entry"]:D[ma]}):Array.add(this.g$b,Ua)}}return this.g$b}}Object(w.a)(Gb,"RetryHelper",null,[]);class tc extends pc{constructor(D,ma){super();this.J9=D;this.Qwb=new Gb(ma,this.dRb.sCc,"GetMoreInfo");this.ht=new ee}rcj(){this.GQd("Document opened")}IIh(D){return()=>{this.GQd(D,!0)}}m6f(D,ma){ma=void 0===
ma?null:ma;z.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:D});3===this.ht.state?(ma&&this.C$e(ma,this.ht),z.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:D})):this.GQd(D);return this.ht}GQd(D,ma){this.Qwb.o6d(!(void 0===ma?0:ma));1===this.ht.state?z.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:D,["RetryIndex"]:this.Qwb.enb}):(z.ULS.sendTraceTag(5849621,
202,50,"Making GetMoreInfo request {0}",{["Trigger"]:D,["RetryIndex"]:this.Qwb.enb}),this.ht.state=1,ma=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.dRb.g1,P.AFrameworkApplication.ml),this.dRb.zRb.o$(ma,1,null,null,[tc.vCe,tc.DGe],!1,5,this.LHh(),this.KHh(D),null))}LHh(){return D=>{var ma=!1;let Ua=!1;var Xb=!1,yc;if(P.AFrameworkApplication.fa.la("GetMoreInfoDataFromResponseBody"))if(D.data.responseData){let Tc=Ba.d(D.data.responseData);({ev:yc}=Tc);Tc.returnValue?yc?(Xb=!0,this.ht.x8c=yc.StorageServiceDisplayName,
this.ht.nwb=tc.SLf(yc.PersonalFileStorageUrl)?yc.PersonalFileStorageUrl:"",""===this.ht.rX&&"SharePointOnlineConsumer"===P.AFrameworkApplication.fa.Ta("FileSource")&&(this.ht.nwb=K.a.O1(P.AFrameworkApplication.breadcrumbFolderUrl)),ma=""===this.ht.rX&&""!==this.ht.rwa):z.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):z.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else z.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");Xb||((yc=D.data.responseHeaders)?(this.ht.x8c=(yc[tc.DGe]||"").toString(),ma=(yc[tc.vCe]||"").toString(),this.ht.nwb=tc.SLf(ma)?ma:"",""===this.ht.rX&&"SharePointOnlineConsumer"===P.AFrameworkApplication.fa.Ta("FileSource")?(this.ht.nwb=K.a.O1(P.AFrameworkApplication.breadcrumbFolderUrl),ma=""===this.ht.rX&&""!==this.ht.rwa):ma=""===ma&&""!==this.ht.rwa):(z.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),Ua=!0));Xb=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.Qwb.enb,Ua,ma,Xb);this.dRb.Mja("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",D.data,Xb);this.etg(3,ma,Ua)}}KHh(D){return ma=>{this.dRb.Mja("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",ma.data,"Failure");this.etg(2);this.Qwb.Rpk(this.IIh(D))}}etg(D,ma,Ua){this.ht.state=D;this.ht.Nve=void 0===
ma?!1:ma;this.ht.c1c=void 0===Ua?!1:Ua;this.Spd(this.ht)}get dRb(){return this.J9.value}static get instance(){return tc.Ka||(tc.Ka=tc.uS())}static uS(){return new tc(new Ab.a(()=>ca.instance),new Ab.a(()=>P.AFrameworkApplication.Dri))}static SLf(D){if(!D)return z.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(jb.a.Po(D).startsWith("https://"))return!0;z.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}tc.vCe="PersonalFileStorageUrl";
tc.DGe="StorageServiceDisplayName";tc.Ka=null;Object(w.a)(tc,"GetMoreInfoActor",pc,[]);class wd{constructor(D,ma,Ua,Xb,yc){this.R_g=6E4;this.HBf="inactive";this.rJe="active";this.UU=!0;this.sh=D;this.SZg=ma;this.G_c=Ua;this.kac=Xb;this.Za=new Zf.a;yc&&this.Jpk();this.Wxe=this.Hqf()}gKe(D){this.Za.addHandler(this.rJe,D)}Hah(D){this.Za.addHandler(this.HBf,D)}Jpk(){const D=new ra.a(5,2,this.R_g,Object(ea.a)(this,this.VKi,"inactiveLoop"),108);this.WKi.Li(D)}VKi(){const D=this.Hqf(),ma=this.fB()-D;ma>
this.VQc&&this.UU&&(z.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ma}),this.UU=!1,this.Za.raiseEvent(this.HBf));D-this.Wxe>this.VQc&&(this.UU=!0,this.Za.raiseEvent(this.rJe));this.Wxe=D}get WKi(){return this.sh.value}get Hqf(){return this.SZg}get fB(){return this.G_c}get VQc(){return this.kac.value}static get instance(){return wd.Ka||(wd.Ka=wd.uS())}static uS(){return new wd(new Ab.a(()=>cc.TaskManager.instance),()=>P.AFrameworkApplication.dXa.getTime(),()=>(new Date).getTime(),
new Ab.a(()=>P.AFrameworkApplication.VQc),!0)}}wd.Ka=null;Object(w.a)(wd,"InactivityManager",null,[]);var he=a(1020);class Re extends Ld{constructor(){super();this.qAe=this.sAe=this.rAe=null;this.state=this.uHe=0;this.c1c=!1}get nSd(){return this.rAe}get GVf(){return this.sAe}get mSd(){return this.qAe}get svk(){return this.uHe}ntf(){return"MruActor Result"}}Object(w.a)(Re,"MruResult",Ld,[705,704]);class ff{constructor(D,ma,Ua){this.task=null;this.cNi=D;this.eej=ma;this.UQ=Ua;this.retryCount=this.CLb=
0;this.V5c=this.cPb=null}XZi(D,ma){return D===L.a.wud||20===ma||18===ma||3===ma}r0i(D){return 3===D||5===D||6===D||7===D||9===D||10===D||11===D||12===D||13===D||14===D||15===D||16===D||23===D||26===D||27===D||28===D}get XGc(){return this.V5c}reset(){this.CLb=this.retryCount=0;this.V5c=this.cPb=null;this.task&&(this.UQ.At(this.task),this.task=null)}BPi(D,ma,Ua,Xb){this.V5c=String.format("{0}_{1}",Ua,Xb);if(this.retryCount>=this.eej)return z.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),
!1;if(this.XZi(Ua,Xb))return z.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.r0i(Xb)&&1<=this.CLb)return this.cPb=Ua,!1;ma=Math.max(ma,this.cNi*Math.pow(2,this.CLb));if(26===Xb)ma=Math.max(ma,3E4);else if(27===Xb||28===Xb)ma=Math.max(ma,6E4);9===Xb||412===Ua&&(null==this.cPb||412!==this.cPb)?ma=500:this.CLb+=1;this.cPb=Ua;this.retryCount+=1;this.task&&this.UQ.At(this.task);z.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ma);this.task=
new ra.a(2,1,ma,D,107);this.UQ.Li(this.task);return!0}}Object(w.a)(ff,"RetryManager",null,[]);class jf{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(w.a)(jf,"WriteOptions",null,[]);class zf extends pc{constructor(D,ma,Ua,Xb,yc,Tc,Sc){super();this.SLk=Gd=>{this.Kxf(Gd.data)};this.qMh=Gd=>{if(Gd.data.httpStatus===L.a.hab)this.Kxf(Gd.data);else{var De=Gd.data.httpStatus===L.a.ilb,ve=ba.a.fu();this.Vxf(this.Qza,Gd,this.cMh(),ve);
ve&&(ve.set("StatusCode",Gd.data.httpStatus.toString()),De||this.uad(Gd.data,ve));Y.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Gd.data.httpStatus),De,!1,Object.assign({},{extendedProperties:ve}))}};this.Ori=Gd=>{this.srf(Gd)};this.Nri=Gd=>{this.srf(Gd,!0)};this.Kri=Gd=>{this.rrf(Gd)};this.Jri=Gd=>{this.rrf(Gd,!0)};this.J9=D;this.R1g=ma;this.oza=new ff(P.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),P.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.EB.sCc);this.Qza=new ff(P.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),P.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.EB.sCc);this.i4g=Ua;this.LIe=Xb;this.w8g={};this.QY=new Re;this.OZg=yc;this.p8b="";this.IA=Tc;this.Yse=Sc;this.j4g=P.AFrameworkApplication.fa.Ng("WordRecentLinksCount",25)}get xUc(){return this.w8g}$Rj(){this.EB.gjb.hf(ha.a.renameMostRecentlyUsedFileEntry,Sg.a.frame,
Object(ea.a)(this,this.yXj,"renameMruEntry"))}yXj(){return this.Yle("Rename")}Acj(){this.ATf("File Opened")}Bcj(){this.ATf("IntervalUpdate")}ATf(D){z.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:D});this.Yle(D)}D5(D){(D=jb.a.D5(D))&&D.startsWith(".")&&(D=D.substring(1,D.length));return D}qpc(){switch(this.EB.fQ){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}UAi(D){var ma=this.OZg();
if(!ma)return null;const Ua=new jf;Ua.documentUrl=this.Yse.value?encodeURI(ma):ma;Ua.mruItemId=this.p8b;Ua.app=this.qpc();if(ma=this.IA())Ua.folderName=ma.breadcrumbFolderName,ma=ma.qq,Ua.documentName=jb.a.Ns(ma),Ua.documentExt=this.D5(ma);D&&(Ua.documentName?Ua.documentName.length?255<=Ua.documentName.length?D.set("DocumentNameLength","Long"):2084<=Ua.documentName.length&&D.set("DocumentNameLength","VeryLong"):D.set("DocumentNameLength","0"):D.set("DocumentNameLength","Null"));return JSON.stringify(Ua)}Yle(D,
ma){ma=void 0===ma?!1:ma;if(4===this.EB.fQ&&!P.AFrameworkApplication.gCa)return 2;var Ua=ba.a.fu();Ua&&(Ua.set("Trigger",D),Ua.set("IsRetry",ma?"true":"false"),Ua.set("MruIdSent",this.p8b?"true":"false"),Ua.set("URLEncoded",this.Yse.value?"true":"false"));Y.Health.instance.recordKpiUsage("WriteMru",T.b.FailureBased,"smartfio",Ua);D=this.UAi(Ua);if(!D)return ma=!P.AFrameworkApplication.webEditingEnabled,Ua&&(Ua.set("WebEditingIsEnabled",P.AFrameworkApplication.webEditingEnabled?"true":"false"),Ua.set("ProtectedFile",
P.AFrameworkApplication.JZa?"true":"false")),Y.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ma,!1,Object.assign({},{extendedProperties:Ua})),2;this.Qza&&!ma&&this.Qza.reset();Ua=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.EB.g1,this.localeName);this.LIe?this.xUc["X-FileId"]=P.AFrameworkApplication.ml:Ua+=String.format("&{0}",P.AFrameworkApplication.ml);P.AFrameworkApplication.pf&&(this.xUc["X-Office-AudienceGroup"]=Object(R.a)(String,P.AFrameworkApplication.pf.AudienceGroup)||
"");this.xUc["X-Timeout"]=15E3;return this.EB.zRb.ir(Ua,2,D,this.xUc,!0,5,this.SLk,this.qMh,null,void 0,void 0,void 0,void 0,"4")}Kxf(D){const ma=ba.a.fu();this.Qza&&(ma&&this.Qza.XGc&&(ma.set("LastError",this.Qza.XGc),ma.set("NumRetries",this.Qza.retryCount.toString())),this.Qza.reset());const Ua=he.c(D.responseData);Ua&&Ua.diagnostics_data&&(this.p8b=Ua.diagnostics_data.mru_id);D=+D.G4-+D.sK;ma&&ma.set("RequestDuration",D.toString());Y.Health.instance.recordKpiSuccess("WriteMru",Object.assign({},
{extendedProperties:ma}))}cMh(){return()=>{this.Yle("Retry",!0)}}Mri(){this.iBc("Polling")}Lri(){this.iBc("Retry",!0)}tcj(){this.iBc("Open")}scj(){this.iBc("Activity")}iBc(D,ma){ma=void 0===ma?!1:ma;var Ua=void 0===Ua?!1:Ua;z.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:D});const Xb=ba.a.fu();Xb&&(Xb.set("Trigger",D),Xb.set("IsRetry",ma?"true":"false"),Ua&&Xb.set("RecentLinks","true"));Y.Health.instance.recordKpiUsage("GetMru",T.b.FailureBased,"smartfio",Xb);this.oza&&
!ma&&this.oza.reset();Ua?this.O2e(this.Nri,this.Jri,!0):this.O2e(this.Ori,this.Kri)}uad(D,ma){D&&D.responseHeaders&&(D=D.responseHeaders["X-CorrelationId"])&&ma.set("ServerCorrelationId",D)}c$i(D,ma){D&&(ma&&ma.set("RequestDuration",(+D.G4-+D.sK).toString()),Y.Health.instance.recordKpiSuccess("GetMru",Object.assign({},{extendedProperties:ma})))}srf(D,ma){ma=void 0===ma?!1:ma;var Ua="";let Xb=null,yc=null,Tc=null;const Sc=he.c(D.data.responseData);Sc&&(Xb=Sc.places?Sc.places.items:[],yc=Sc.documents?
Sc.documents.items:[],(Tc=he.a(Sc,ma))&&(Ua=Ba.c(Tc)));P.AFrameworkApplication.ra&&P.AFrameworkApplication.ra.Pa.x6&&sc.c()&&!ma&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ua,!0));Ua=ba.a.fu();this.oza&&(Ua&&this.oza.XGc&&(Ua.set("LastError",this.oza.XGc),Ua.set("NumRetries",this.oza.retryCount.toString())),this.oza.reset());ma&&Ua&&Ua.set("RecentLinks","true");Tc||Xb||yc?(ma?this.EB.Mja("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",D.data,"Success"):this.EB.Mja("MruActor.GetMruV2FromServerSuccessCallback",
D.data,"Success"),this.VSc(3,Tc,Xb,yc),this.c$i(D.data,Ua)):(ma?this.EB.Mja("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",D.data,"Failure: Invalid JSON"):this.EB.Mja("MruActor.GetMruV2FromServerSuccessCallback",D.data,"Failure: Invalid JSON"),Ua&&this.uad(D.data,Ua),Y.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign({},{extendedProperties:Ua})),this.VSc(3,null,null,null,!0));this.Spd(this.QY)}Vxf(D,ma,Ua,Xb){let yc=0,Tc=0;const Sc=he.c(ma.data.responseData);
Sc&&(null!=Sc.response_code&&(yc=Sc.response_code,Xb&&Xb.set("MruResponseCode",yc.toString()),9===yc&&(this.p8b="")),Sc.error_data&&null!=Sc.error_data.retry_after_ms&&(Tc=Sc.error_data.retry_after_ms,Xb&&Xb.set("ExpectedRetryAfter",Tc.toString())));D&&(ma=D.BPi(Ua,Tc,ma.data.httpStatus,yc),Xb&&(Xb.set("CurrentRetryCount",D.retryCount.toString()),Xb.set("RetryScheduled",ma?"true":"false")))}rrf(D,ma){ma=void 0===ma?!1:ma;const Ua=D.data.httpStatus===L.a.ilb,Xb=ba.a.fu();Xb&&(Xb.set("StatusCode",D.data.httpStatus.toString()),
ma&&Xb.set("RecentLinks","true"),Ua||this.uad(D.data,Xb));ma?this.EB.Mja("MruActor.GetMruForRecentLinksFromServerFailureCallback",D.data,"Failure"):this.EB.Mja("MruActor.GetMruFromServerFailureCallback",D.data,"Failure");this.VSc(2);this.Vxf(this.oza,D,Object(ea.a)(this,this.Lri,"getMruFromServerRetryTask"),Xb);Y.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",D.data.httpStatus),Ua,!1,Object.assign({},{extendedProperties:Xb}));this.Spd(this.QY);P.AFrameworkApplication.ra&&
P.AFrameworkApplication.ra.Pa.x6&&sc.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),ma||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}VSc(D,ma,Ua,Xb,yc){if(3!==this.QY.state||3===D)this.QY.rAe=void 0===ma?null:ma,this.QY.sAe=void 0===Ua?null:Ua,this.QY.qAe=void 0===Xb?null:Xb,this.QY.state=D,this.QY.c1c=void 0===yc?!1:yc,this.QY.uHe=this.EB.fB()}m6f(D,ma){z.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:D,["ResultState"]:this.QY.state});
ma&&3===this.QY.state&&this.C$e(ma,this.QY);return this.QY}O2e(D,ma,Ua){Ua=void 0===Ua?!1:Ua;this.VSc(1);let Xb;const yc={};Xb=Ua?String.format(this.EB.g1+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.j4g,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.EB.g1+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.qpc(),this.localeName);this.i4g.value||(Xb+="&entity=docs");P.AFrameworkApplication.pf&&(yc["X-Office-AudienceGroup"]=Object(R.a)(String,
P.AFrameworkApplication.pf.AudienceGroup)||"");Ua&&(yc["X-Office-Application"]="147");this.LIe?yc["X-FileId"]=P.AFrameworkApplication.ml:Xb+=String.format("&{0}",P.AFrameworkApplication.ml);this.EB.zRb.ir(Xb,1,null,yc,!0,5,D,ma,null)}get EB(){return this.J9.value}get localeName(){return this.R1g.value}static get instance(){return zf.Ka||(zf.Ka=zf.uS())}static uS(){return new zf(new Ab.a(()=>ca.instance),new Ab.a(()=>Sf.a.wP(P.AFrameworkApplication.lcid).name),new Ab.a(()=>P.AFrameworkApplication.ra.Pa.cA),
P.AFrameworkApplication.fa.la("MruWriteFileIdInHeader"),()=>P.AFrameworkApplication.ra.Pa.Iw,()=>P.AFrameworkApplication.zp,new Ab.a(()=>P.AFrameworkApplication.fa.la("OICEncodeUrlIsEnabled")))}}zf.Ka=null;Object(w.a)(zf,"MruActor",pc,[]);class Qf{constructor(){this.Uxb=this.vDe=this.$b=null;this.Iq=!1;this.sPh=()=>{cc.TaskManager.instance.At(this.IVf)};this.NKe=()=>{cc.TaskManager.instance.Li(this.IVf)}}get name(){return"Common.App.NewAndOpen.Core"}dl(D){this.$b=D;D.register(671,"Common.INewAndOpenCommonHelpers").If().Rf(()=>
ca.instance);D.register(672,"Common.IEventEmitter<Common.IGetMoreInfoResult>").If().Rf(()=>tc.instance);D.register(672,"Common.IEventEmitter<Common.IMruResult>").If().Rf(()=>zf.instance)}init(){P.AFrameworkApplication.fa.Xw(()=>{this.jLb()})}jLb(){this.$b.resolve("Common.INewAndOpenCommonHelpers");this.$b.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.$b.resolve("Common.IEventEmitter<Common.IMruResult>");var D=!1;ca.instance.fQj();P.AFrameworkApplication.Nca&&(D=!0);P.AFrameworkApplication.rgg&&
(zf.instance.tcj(),0<P.AFrameworkApplication.HVf&&this.NKe(),this.sek(),D=!0);P.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&D&&tc.instance.rcj();P.AFrameworkApplication.TEk&&(D=zf.instance,D.$Rj(),D.Acj(),cc.TaskManager.instance.Li(this.UEk))}sek(){wd.instance.gKe(Object(ea.a)(zf.instance,zf.instance.scj,"makeGetMruRequestActivityTrigger"));wd.instance.gKe(this.NKe);wd.instance.Hah(this.sPh)}get IVf(){return this.vDe||(this.vDe=new ra.a(5,2,P.AFrameworkApplication.HVf,Object(ea.a)(zf.instance,
zf.instance.Mri,"getMruFromServerTask"),109))}get UEk(){return this.Uxb||(this.Uxb=new ra.a(2,2,6E4*P.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(ea.a)(zf.instance,zf.instance.Bcj,"makeUpdateMruTask"),197))}dispose(){this.Iq||(this.Iq=!0,this.Uxb&&(cc.TaskManager.instance.At(this.Uxb),this.Uxb=null))}}Object(w.a)(Qf,"CorePackageManager",null,[4,5,2]);var Kf=a(858);class Gf{constructor(D,ma){this.M7c=this.L7c=null;this.T6a=new Fe.a;
this.kTb=Ua=>{let Xb=null;Xb&&Xb.length||!Ua||!Ua.data||(Xb=Ua.data.responseData);if(Xb&&Xb.length)try{const yc=Ba.a(Xb);this.L7c=yc.NavBarDataJson;z.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.L7c?(()=>{let Tc=Ba.d(yc.NavBarDataJson);({ev:this.M7c}=Tc);return Tc})().returnValue?(this.E$i(this.M7c),this.T6a.setResult(this.M7c)):(z.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Kf.a.vqb(this.L7c)}),this.T6a.uy()):
(z.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.T6a.uy())}catch(yc){z.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.T6a.uy()}else z.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.wSb=()=>{this.T6a.uy();z.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.xk=D;this.cga=ma.appSettings[Gf.TKk]||""}get xfk(){return this.T6a.task}get X$(){return this.xk.value}RZj(){const D=
{};D[Gf.PGi]=P.AFrameworkApplication.ml;D["Content-Type"]="application/json; charset=utf-8";z.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ma=K.a.Zn(this.cga+Gf.yfk,Gf.dkj,P.AFrameworkApplication.ra.Pa.Cj.toString());this.X$.ir(ma,1,"",D,!0,2,this.kTb,this.wSb,null,void 0,void 0,void 0,void 0,"20")}E$i(D){try{const ma={};ma.FlightName=D.FlightName;ma.SessionID=D.SessionID;z.ULS.sendTraceTag(594883776,215,50,Ba.c(ma))}catch(ma){z.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}static get instance(){return Gf.Ka||(Gf.Ka=Gf.cTa())}static cTa(){return new Gf(new Ab.a(()=>P.AFrameworkApplication.lg),P.AFrameworkApplication.fa,P.AFrameworkApplication.ra.Pa.Cj)}}Gf.PGi="X-qs";Gf.dkj="at";Gf.yfk="O365ShellServiceProxy.ashx";Gf.Ka=null;Gf.TKk="ShellWebServiceBase";Object(w.a)(Gf,"O365ShellActor",null,[673]);class lg{constructor(){this.$b=null;this.kG=()=>{P.AFrameworkApplication.useO365ShellService&&P.AFrameworkApplication.ra.Pa.wu&&this.$b.resolve("Common.App.O365Shell.O365ShellActor").RZj()}}get name(){return"Common.App.O365Shell"}dl(D){this.$b=
D;this.$b.register(Gf,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").If().Rf(()=>new Gf(new Ab.a(()=>P.AFrameworkApplication.lg),P.AFrameworkApplication.fa,P.AFrameworkApplication.ra.Pa.Cj))}init(){P.AFrameworkApplication.fa.Xw(this.kG)}dispose(){}static main(){Ea.a.instance.Ul(new lg)}}Object(w.a)(lg,"PackageManager",null,[4,5]);var Hf=a(263),Of=a(697),Yg=a(103),eh=a(280),Hg=a(174),Pg=a(89),Fg=a(75),Ch=a(609),Vg=a(909);class wh extends Yg.a{constructor(D,ma){super(D);
this.PY=[];this.Rxe=null;this.mXb=Ua=>{let Xb="forward";Ua.Values[cf.a.direction]?Xb=Ua.Values[cf.a.direction].toLowerCase():z.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Ua=0;let yc=!0;"backward"===Xb?(Ua=this.EMd.length-1,yc=!1):"forward"===Xb?(Ua=0,yc=!0):z.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Xb}`);this.AVf(yc,Ua,!1)};this.w3f=()=>{this.PY=[]};this.wYa=Ua=>{-411645385===this.$.shortcutKeyManager.Qv(Ua)&&this.MHf()&&(this.$.Ha.Me(new Dc.a(-411645385,
1,this.$.zf,6,null),{["event"]:Ua},Ua),Ua.stopPropagation());this.SIj(Ua)};this.Ctj=Ua=>{this.mka(Ua)};this.Ie=ma;this.zx=ua.h(this.Ie);this.tg.ta("keydown",this.Ctj);this.tg.ta("keyup",this.wYa);eh.a(ma).Sfh(this.w3f);Pg.a(ma.xa,27)&&ne.TaskExtensions.Ca(Zd.GetServiceTaskFactory.vf(ma.ja,21,137,1),Ua=>{Ua=Ua.result;Ua.rp(Rg.a.vAf);Ua.Dn(Rg.a.vAf,this.mXb)},ma.qa)}get $(){return this.Ie}get EMd(){this.PY.length||(this.PY=this.Cqf());return this.PY}get fta(){return this.Rxe}set fta(D){this.Rxe=D;this.PY=
this.Cqf()}dispose(){this.$&&eh.a(this.$).NWj(this.w3f);this.Ie=null;this.PY.length=0;super.dispose()}RIj(D){this.mka(D)}AVf(D,ma,Ua,Xb){Xb=void 0===Xb?null:Xb;var yc=this.psk(D,ma,void 0===Ua?!0:Ua,Xb);if(!yc){Ua=ma;var Tc=D?1:-1,Sc=this.EMd;do{yc=!1;if(Pg.a(this.$.xa,27)){if(Ua+=Tc,Ua>=Sc.length||0>Ua)yc=!0}else Ua=(Ua+Tc+Sc.length)%Sc.length;if(yc){this.tbj(D,ma,Xb);break}else if(yc=this.eEg(D,ma,Ua,!1,Xb))break}while(Ua!==ma)}}psk(D,ma,Ua,Xb){Xb=void 0===Xb?null:Xb;let yc=null;0<=ma&&(yc=this.PY[ma]);
return(null===yc||void 0===yc?0:yc.nl)&&yc.Wl(D,void 0===Ua?!0:Ua)?(Xb&&Fg.g(Xb),z.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${yc.Qh} into a sub region`),yc.Ko(),!0):!1}eEg(D,ma,Ua,Xb,yc){yc=void 0===yc?null:yc;Ua=this.PY[Ua];const Tc=eh.a(this.Ie).iB(Hf.a.aDa),Sc=eh.a(this.Ie).iB(Hf.a.KJb),Gd=this.zx.ha.Ua.isFloatingObjectSelected;if(Ua===Sc&&Gd||Ua===Tc&&!Xb&&!Gd)return!1;if((null===Ua||void 0===Ua?0:Ua.nl)&&Ua.Wl(D,!1)){yc&&Fg.g(yc);Ua.Ko();if(D=this.PY[ma])D.Rp(),
z.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${D.Qh} to ${Ua.Qh}`);return!0}return!1}tbj(D,ma,Ua){(Ua=void 0===Ua?null:Ua)&&Fg.g(Ua);if(ma=this.PY[ma])ma.Rp(),z.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${ma.Qh}`);ne.TaskExtensions.Ca(Zd.GetServiceTaskFactory.vf(this.$.ja,21,137,0),Xb=>{Xb.result.sendMessage(Rg.a.eyb,{[cf.a.direction]:D?"forward":"backward"})},this.$.qa)}SIj(D){var ma=this.$.shortcutKeyManager.pzk(D),Ua;if(Ua=ma)Ua=!!ma&&Object.values(Vg.a).includes(ma);
Ua&&(ma=new Dc.a(ma,1,this.$.zf,6,null),this.$.Ha.Me(ma,{["event"]:D},D))}mka(D){var ma=this.$.isEditMode?Hg.a(this.$):null;if(!this.$.Le.Nsa||wh.QXi(ma))if(117===D.keyCode&&(D.ctrlKey||Fg.b(D))){ma=this.Ltf(D.target);var Ua=!D.shiftKey;z.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ma}`);var Xb=eh.a(this.Ie).iB(Hf.a.rXb);Xb=this.PY.indexOf(Xb);P.AFrameworkApplication.ra.Pa.oE&&this.$.N0&&-1!==Xb&&ma===Xb&&Of.ShyRibbon.$R(this.$.r_b,
0);this.AVf(Ua,ma,!0,D)}else 117!==D.keyCode||wh.vhf?-411645385===this.$.shortcutKeyManager.Qv(D)?this.MHf()&&(this.$.Ha.Me(new Dc.a(-411645385,1,this.$.zf,6,null),{["event"]:D},D),D.stopPropagation()):1588554917===this.$.shortcutKeyManager.Qv(D)?0===this.mode?(Ch.a(this.$)||this.$.Ha.Me(new Dc.a(1588554917,1,this.$.zf,6,null),{["event"]:D},D),D.preventDefault(),D.stopPropagation()):3===this.mode&&(D.preventDefault(),D.stopPropagation()):Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowRenamePromptCallout",
!1)||-1966746939!==this.$.shortcutKeyManager.Qv(D)?1058684758===this.$.shortcutKeyManager.Qv(D)?(ma=this.Ltf(D.target),Xb=eh.a(this.Ie).iB(Hf.a.rXb),Ua=eh.a(this.Ie).iB(Hf.a.aDa),Xb=this.PY.indexOf(Xb),Ua=this.PY.indexOf(Ua),P.AFrameworkApplication.ra.Pa.oE&&this.$.N0&&-1!==Xb&&ma===Xb&&1===this.$.r_b&&Of.ShyRibbon.$R(1,0),-1!==Ua&&ma!==Ua&&this.eEg(!0,ma,Ua,!0,D)):Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.Kxi(D)?(ma=this.$.shortcutKeyManager.Qv(D),
z.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${ma} fired in ${this.mode} mode`),0===this.mode?(this.$.Ha.Me(new Dc.a(ma,1,this.$.zf,6,null)),D.preventDefault(),D.stopPropagation()):Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowRenamePromptCallout",!1)&&4===this.mode&&-1966746939===ma&&(D.preventDefault(),D.stopPropagation())):this.oEi(D):(D.preventDefault(),D.stopPropagation()):(D=e.a.Aw.iG.gS(Tg.a.Umi(),!1),D.image=Pd.a.ygb()?3:0,e.a.Aw.iG.RA(D),
wh.vhf=!0)}Ltf(D){const ma=this.EMd;for(let Ua=0,Xb=ma.length;Ua<Xb;++Ua){const yc=ma[Ua];if(yc&&yc.Bm(D))return Ua}return-1}Cqf(){const D=[];for(let ma=0,Ua=this.fta.length;ma<Ua;ma++){const Xb=eh.a(this.$).iB(this.fta[ma]);Xb&&D.push(Xb)}return D}MHf(){return 0===this.mode||4===this.mode}static QXi(D){return D?D.inKeytipMode:!1}}wh.vhf=!1;Object(w.a)(wh,"AccessibilityManager",Yg.a,[570,2]);var kh=a(170);let Vh=class extends wh{constructor(D){super(document.documentElement,D);this.jH=0;this.bnh=
[Hf.a.l1e,Hf.a.DTd,Hf.a.rtc,Hf.a.Uge,Hf.a.rXb,Hf.a.Tfd,Hf.a.Iud,Hf.a.xwf,Hf.a.Zed,Hf.a.Mfe,Hf.a.xnk,Hf.a.oxg,Hf.a.KJb,Hf.a.Fkf,Hf.a.Vgd,Hf.a.aDa,Hf.a.Vae,Hf.a.ahd,Hf.a.zCg,Hf.a.TOf,Hf.a.sfd];this.TJk=[Hf.a.rtc,Hf.a.aOg,Hf.a.$Ng,Hf.a.bOg];this.rIj=[Hf.a.rtc,Hf.a.Scg,Hf.a.Tcg,Hf.a.Wcg];this.Evh=[Hf.a.wkf,Hf.a.wwf,Hf.a.vkf,Hf.a.skf,Hf.a.q5e];this.QHj=[Hf.a.l1e,Hf.a.DTd,Hf.a.Tfd,Hf.a.Iud,Hf.a.Zed,Hf.a.Mfe,Hf.a.KJb,Hf.a.Vgd,Hf.a.aDa,Hf.a.Vae,Hf.a.ncg,Hf.a.ahd,Hf.a.sfd];this.fIj=[Hf.a.KJb,Hf.a.Mud];const ma=
ad.a.instance.za(253);this.E$j=this.$.shortcutKeyManager.BIb(ma);this.mode=0;Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateEwaAccessibilityManager")||D.ja.$c(15,this);ne.TaskExtensions.Ca(Zd.GetServiceTaskFactory.vf(D.ja,21,137,1),Ua=>{Ua=Ua.result;Ua.rp(Rg.a.eyb);Ua.Dn(Rg.a.eyb,this.mXb)},D.qa)}get mode(){return this.jH}set mode(D){this.jH=D;switch(D){case 0:this.fta=this.bnh;break;case 2:this.fta=this.TJk;break;case 3:this.fta=this.rIj;break;case 4:this.fta=this.Evh;break;case 5:this.fta=
this.QHj;break;case 6:this.fta=this.fIj;break;default:z.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}mka(D){this.$.Wg&65536&&super.mka(D)}oEi(D){if(Lc.a.equals(this.E$j,this.$.shortcutKeyManager.nyd(D),!1)){const ma=kh.b(this.$);if(null===ma||void 0===ma?0:ma.nl)Fg.g(D),ma.Wl(!0,!1)}}};Vh=Object(vb.__decorate)([Object(Eb.d)(kc.mb),Object(vb.__param)(0,Object(kc.nb)())],Vh);Object(w.a)(Vh,"EwaAccessibilityManager",wh,[]);class $h extends Qb.a{constructor(D){super();
this.$=D;this.Dg()}create(){this.Df(this.$.ja.Qa(15)||new Vh(this.$))}static ta(D){D.ja.$c(157,new $h(D))}}Object(w.a)($h,"AccessibilityManagerFactory",Qb.a,[]);var Mg=a(121),Ye=a(287),E=a(52),ja=a(261),Ha=a(7),Jb=a(38),jc=a(136);class Uc extends Mg.a{constructor(D,ma,Ua,Xb,yc){super(D,ma);Uc.vQd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Uc.uQd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Uc.kTf=[-1468309555,611268539,-1750576502,
61029505,-658377927];Uc.jTf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];this.COc=Ua;this.Umk=Xb;this.Pwk=yc}execute(D){var ma=Object(R.a)(8,D.Oh);D.activityState[Jb.a.Zza]=!0;var Ua=Uc.Txi(D);if(Uc.Yfk(D,Ua))return Uc.idj(D),Ua=50,0<D.errors.length&&(Ua=15),z.ULS.sendTraceTag(537153891,0,Ua,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${Cb.a.xf(D.errors)}`),D.activityState[Jb.a.Zza]=!1,this.jk(Ha.a.idle),
3;switch(Ua){case 1:case 3:this.DPi(D,Ua);break;case 2:this.CPi(D);break;case 0:D.activityState[Jb.a.G7a]=null}z.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${Ua}. activityName:${this.activityName}. NextActivityName:${this.b7}. TimeFromLastStatefulResponse:${ma.ea.E2}.`);var Xb=bf.a.Sj(D.activityState,jc.a.rqb);z.ULS.shipAssertTag(40502925,0,!Xb||Xb&&(1===Ua||3===Ua),`triggerSilentReloadAfterTokenRefresh: ${Xb}, silentReloadType: ${Ua}`);ma=ma.No.reloadCount;
return 0!==Ua&&0<ma?(Xb=Ye.a.$Ta(ma,200),z.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${Ua}] retryNum [${ma}] delayInMs [${Xb}] activityName [${this.activityName}]`),Ga.a.instance.create(()=>{Uc.lM(D)},Xb,Ob.a.b8j),1):3}DPi(D,ma){z.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const Ua=Object(R.a)(8,D.Oh);D.activityState[Jb.a.xyb]=!0;Ua.ovc||E.a.instance.dm("ReopenOnLoad");!Uc.isEditMode(D)&&
Cb.a.iAb(D.errors)&&(z.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),D.activityState[Jb.a.rbc]=Ua.ea.sessionId,D.activityState[Jb.a.xbc]=!0);D.QQd();3===ma?(Ua.ea.Yj()||Ua.ea.cjj(),Ua.RK(!0,!0),this.jk(this.Pwk),D.activityState[Jb.a.OJe]=Ua.workbookContext.CalcMode):(Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ma&&Ua.RK(!0,!0),D.activityState[Jb.a.cad]=!1,
this.jk(this.COc))}CPi(D){z.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");D.activityState[Jb.a.G7a]=null;D.QQd();this.jk(this.Umk);D=Object(R.a)(8,D.Oh);D.ovc||(E.a.instance.dm("RefreshOnLoad"),D.PWb())}static lM(D){D.lM()}static Txi(D){const ma=Object(R.a)(8,D.Oh),Ua=ma.ea,Xb=Uc.isEditMode(D);var yc=Cb.a.yk(D.errors,Xb?Uc.uQd:Uc.vQd);const Tc=Cb.a.yk(D.errors,Xb?Uc.jTf:Uc.kTf),Sc=ma.DW,Gd=ma.No.reloadCount,De=ma.xa.MaxConsecutiveSilentReloadAllowed,
ve=ma.No.Syf(),Xe=Cb.a.xf(D.errors),nf=Cb.a.xf(D.WHa),uf=0<Cb.a.oS(bh=>!bh.triggerSilentReopenOnly,D.errors).length;let rg=yc;const $f=bf.a.Sj(D.activityState,jc.a.rqb);$f&&(rg=!0);const og={name:"SessionReloadSilentActivity.GetSilentReloadType"};og.editMode=Xb;og.isSilentReopenError=yc;og.isSilentRefreshError=Tc;og.reloadSequenceCount=ma.No.p_a;og.reloadCount=Gd;og.maxReloads=De;og.stopSilentReloads=ve;og.errorNames=Xe;og.processedErrorNames=nf;og.isClientDirty=Sc;og.errorsForSilentReopenOnly=uf;
og.triggerSilentReloadAfterTokenRefresh=$f;og.IsReopenDisabled=ma.mWa;yc=ic.a.Vf(og);z.ULS.sendTraceTag(21837004,0,50,yc);if(!ve){if(rg&&(Xb?Uc.Nfk(D):Uc.Qfk(D)))return ja.a.xxg(D,ma)?3:ma.mWa?2:1;if(Tc&&(Xb||!Ua.$lb))return 2}return 0}static Yfk(D,ma){for(const Ua of D.errors)if(-1337545025===Ua.MessageId||-238814601===Ua.MessageId)return!1;return Cb.a.oS(Ua=>!Ua.triggerSilentReopenOnly,D.errors).length?3!==ma:!1}static idj(D){const ma=Cb.a.oS(Ua=>!Ua.triggerSilentReopenOnly,D.errors);for(const Ua of ma)D.Uja(Ua)}static isEditMode(D){const ma=
Object(R.a)(8,D.Oh);return ma.ea.tf?ma.Ft&&!!(ma.Wg&64):bf.a.Sj(D.activityState,Jb.a.Cv)}static Qfk(D){const ma=Object(R.a)(8,D.Oh),Ua=Cb.a.Xaa(D.errors,Uc.vQd);if(gb.b(Ua,Xb=>Xb.ForceVersionUpgrade))return!1;D=Cb.a.iAb(D.errors);return!ma.ea.$lb||D?!0:!1}static Nfk(D){D=Cb.a.Xaa(D.errors,Uc.uQd);return!gb.b(D,ma=>ma.ForceVersionUpgrade)}}Uc.vQd=null;Uc.uQd=null;Uc.kTf=null;Uc.jTf=null;Object(w.a)(Uc,"SessionReloadSilentActivity",Mg.a,[]);class Rc extends Qb.a{constructor(D,ma){super();this.activityName=
D;this.fP=ma;this.Dg()}create(){this.Df(new Uc(this.activityName,this.fP,Ha.a.XD,Ha.a.gm,Ha.a.W0b))}static ta(D){D.ja.$c(143,new Rc(Ha.a.Gva,Ha.a.KAb));D.ja.$c(144,new Rc(Ha.a.fMc,Ha.a.TYa));D.ja.$c(145,new Rc(Ha.a.gMc,Ha.a.yXd));D.ja.$c(154,new Rc(Ha.a.Vnb,Ha.a.CU))}}Object(w.a)(Rc,"SessionReloadSilentActivityFactory",Qb.a,[]);var Dd=a(674),Yd=a(334),Jd=a(503),Md=a(550),Je=a(187),af=a(221),gf=a(196),of=a(283),Cf=a(188),Df=a(265),Vf=a(47);class qg extends Yg.a{constructor(D,ma,Ua,Xb,yc){super(D);
this.wEg=[6];this.rEg=[26];this.Xu=null;this.qNb=this.Iyc=!1;this.Ww=this.ria=null;this.onPointerDown=Tc=>{if(1!==this.$.Ha.GM())return!0;Tc=this.zoomManager.Sh(Tc);if(this.bG)return!0;var Sc=Vf.a(this.$).OId||Vf.a(this.$).Gt();if(this.RKd||Sc)return this.Rmb(),!0;this.Ww=this.dr;this.a3d();this.SDd();Sc=2===Tc.Te&&Tc.vs===Sys.UI.MouseButton.leftButton;const Gd=3===Tc.Te;if(Sc||Gd)Tc=this.ha.Mt(Tc.clientPoint,Tc.rf,5,void 0,void 0,!0),Tc||(Tc=this.Ww),this.qNb=Sc,this.Iyc=Gd,this.Ww=this.uvf(Tc),
this.SDd(),Sc?this.cRj():Gd&&this.RRj(),Df.b(this.$,!0);return!0};this.rn=Tc=>{Tc=this.zoomManager.Sh(Tc);if(!this.bG)return!1;let Sc=this.qNb?this.ha.Mt(Tc.clientPoint,Tc.rf,5,void 0,void 0,!0):this.ha.Mt(Tc.clientPoint,Tc.rf,5,!0,!1,!0);Sc||(Sc=this.ha.h4(Tc.clientPoint,Tc.rf,5));Sc&&(Tc=this.uvf(this.Bzb(Sc)),this.Oec(Tc.bottomRight),this.Ww.equals(Tc)||(this.Ww=Tc,this.bWb(!1),this.a3d(!1),this.SDd(!1),this.pJi(),this.Se.update(!1)),this.qDk(this.Ww));return!0};this.Yk=Tc=>{this.zoomManager.Sh(Tc);
if(!this.bG)return!1;this.resizeTable();this.Rmb();return!0};this.pTb=Tc=>{this.zoomManager.Sh(Tc);if(!this.bG)return z.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Rmb();return!0};this.nka=Tc=>{this.zoomManager.Sh(Tc);this.Rmb();return!0};this.PZf=()=>{this.bG&&this.Rmb()};this.gridView=ma;this.zoom=yc;this.$=ma.$;this.Ug=Xb;this.ha=ma.ha;this.Se=ma.Se;this.parentElement=D;this.nrh();za.a.Ht||za.a.t6||
of.a.instance.va(Oe.a.yg,this.ria,this.onPointerDown);this.dr=Ua;this.q2c=this.RKd=!1;this.Ug.Tch(this.PZf)}get bG(){return this.qNb||this.Iyc}get ZKf(){return this.q2c}dispose(){this.Rmb();this.Ug.iUj(this.PZf);this.ZKf||za.a.Ht||za.a.t6||of.a.instance.Da(Oe.a.yg,this.ria,this.onPointerDown);if(this.bG){Df.b(this.$,!1);try{this.zA()}catch(D){z.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${D}`)}}this.parentElement&&this.parentElement.contains(this.ria)&&
this.parentElement.removeChild(this.ria);this.ria=this.parentElement=null;super.dispose()}get zoomManager(){return Tb.EwaSettings.Pi()?this.zoom.zoomManager:U.a(this.$)}uvf(D){const ma=D.bottom-this.dr.topLeft.bottom-1;return 0<=D.right-this.dr.topLeft.right+1&&0<=ma&&D.bottom>=this.dr.top&&D.right>=this.dr.left?new xb.Range(this.dr.top,this.dr.left,D.bottom,D.right,!1,!1):this.Ww}SDd(D){this.CMc([this.Ww],6,void 0===D?!0:D);this.Se.Ys(this.wEg)}bWb(D){D=void 0===D?!0:D;this.Se.Fl(this.wEg);this.CMc([null],
6,D)}a3d(D){D=void 0===D?!0:D;this.Se.Fl(this.rEg);this.CMc([null],26,D)}pJi(){var D=!1;D=void 0===D?!0:D;const ma=this.Ysk();0<ma.length&&(this.CMc(ma,26,D),this.Se.Ys(this.rEg))}Ysk(){const D=[];this.dr.contains(this.Ww)&&(this.dr.right!==this.Ww.right&&D.push(new xb.Range(this.dr.top,this.Ww.right+1,this.Ww.bottom,this.dr.right,!1,!1)),this.dr.bottom!==this.Ww.bottom&&D.push(new xb.Range(this.Ww.bottom+1,this.dr.left,this.dr.bottom,this.dr.right,!1,!1)));return D}resizeTable(){if(!this.Ww.equals(this.dr)){const D=
new xb.Range(this.dr.top,this.dr.left,this.Ww.bottom,this.Ww.right,!1,!1);this.tyk(D);this.RKd=!0}}onKeyDown(D){this.zoomManager.Sh(D);return!0}lVd(){this.ZKf&&(za.a.Ht||za.a.t6||(of.a.instance.va(Oe.a.yg,this.ria,this.onPointerDown),this.ria.classList.remove("ewr-table-resize-default-cursor"),this.q2c=this.ria.disabled=!1),this.q2c=!1)}nrh(){const D=document.createElement("div");D.className="ewr-table-resize-handle";const ma=document.createElement("div");ma.className="ewr-table-resize-fillhandle-higher";
const Ua=document.createElement("div");Ua.className="ewr-table-resize-fillhandle-broader";D.appendChild(ma);D.appendChild(Ua);this.ria=D;this.parentElement.appendChild(this.ria)}Oec(D){let ma=60;const Ua=this.Ww.contains(D);let Xb=D.top,yc=D.bottom,Tc=D.left,Sc=D.right,Gd=null;if(Ua){if(this.gridView.ZC(this.dr.topLeft)&&!this.dr.BJa)return;D.bottom<this.Ww.bottom?(Xb=Math.max(1,yc-2,this.dr.top),ma=16):(Tc=Math.max(1,Sc-2,this.dr.left),ma=4);yc=Xb;Sc=Tc;Gd=new xb.Range(Xb,Tc,Xb,Tc,!1,!1)}else D.right>=
this.dr.right?(Sc+=2,ma=8):D.bottom>=this.dr.bottom&&(yc+=2,ma=32),Xb=yc,Tc=Sc,Gd=new xb.Range(yc,Sc,yc,Sc,!1,!1),ma=16;this.gridView.ZC(Gd)||(this.Xu?this.Xu.us||(this.Xu=Ga.a.instance.create(()=>{this.gridView.jB(Gd,ma,"TableResizeBehavior.BringRangeIntoView")},40,Ob.a.uEg)):this.Xu=Ga.a.instance.create(()=>{this.gridView.jB(Gd,ma,"TableResizeBehavior.BringRangeIntoView")},40,Ob.a.uEg))}Bzb(D){let ma=D;if(this.gridView.Be.BS){if(!this.gridView.Pe(D.topLeft)){const Ua=this.gridView.Ln("TableResizeBehavior.AdjustHiddenRowColumns",
this.gridView.dW,this.Ww.top!==D.top?1:2);try{Ua.vo=this.Ww.top<D.top||this.Ww.left<D.left,Ua.fA(D.topLeft),ma=Ua.$$cu().range}finally{Ua&&Ua.dispose()}}ma.right=ma.left+D.width-1;ma.bottom=ma.top+D.height-1}return ma}CMc(D,ma,Ua){Ua=void 0===Ua?!0:Ua;const Xb=[];for(const yc of D)Xb.push(new Id.a(yc,ze.d(this.$.na)));this.Se.GG(Xb,[ma],!0,void 0,Ua)}cRj(){of.a.instance.va(Oe.a.Yp,document.documentElement,this.rn);for(const D of this.gridView.Jr)of.a.instance.va(Oe.a.Yp,D.domElement,this.rn);of.a.instance.va(Oe.a.Hk,
document.documentElement,this.Yk);this.A7e()}RRj(){Cf.a.instance.va(Oe.a.mk,document.documentElement,this.rn);for(const D of this.gridView.Jr)Cf.a.instance.va(Oe.a.mk,D.domElement,this.rn);Cf.a.instance.va(Oe.a.Uh,document.documentElement,this.pTb);this.A7e()}zA(){this.qNb&&this.FBk();this.Iyc&&this.PBk()}FBk(){of.a.instance.Da(Oe.a.Yp,document.documentElement,this.rn);for(const D of this.gridView.Jr)of.a.instance.Da(Oe.a.Yp,D.domElement,this.rn);of.a.instance.Da(Oe.a.Hk,document.documentElement,
this.Yk);this.rhg()}PBk(){Cf.a.instance.Da(Oe.a.mk,document.documentElement,this.rn);for(const D of this.gridView.Jr)Cf.a.instance.Da(Oe.a.mk,D.domElement,this.rn);Cf.a.instance.Da(Oe.a.Uh,document.documentElement,this.pTb);this.rhg()}A7e(){this.gridView.cellTextEditBox.ubb(!0)}rhg(){this.gridView.cellTextEditBox.ubb(!1)}tyk(D){this.$.Lf(-1400250766,ob.a.Ke,30,{["ResizeTableRange"]:D,["OriginalTableRange"]:this.dr})}qDk(D){if(!this.dr.contains(D)){D=this.Xsk();for(const ma of D)if(this.Ug.oLd(ma)){this.gridView.Dk.iw(id.a.pij);
return}}this.gridView.rtl?this.gridView.Dk.iw(id.a.thj):this.gridView.Dk.iw(id.a.Pjj)}Rmb(){if(this.bG){Df.b(this.$,!1);try{this.zA()}catch(D){z.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${D}`)}}this.Xu&&(this.Xu.cancel(),this.Xu.dispose());this.Iyc=this.qNb=!1;this.bWb();this.a3d();Df.b(this.$,!1);this.gridView.Dk.iw(id.a.S5)}Xsk(){const D=[];this.dr.right!==this.Ww.right&&D.push(new xb.Range(this.dr.top,this.dr.right+1,this.Ww.bottom,
this.Ww.right,!1,!1));this.dr.bottom!==this.Ww.bottom&&D.push(new xb.Range(this.dr.bottom+1,this.dr.left,this.Ww.bottom,this.dr.right,!1,!1));return D}static createInstance(D,ma,Ua,Xb,yc){if(!ma)return null;const Tc=D.Se;Tc.GG(Ua,[27],!0);Tc.Ys(qg.Ssk);Ua=Tc.KM(27,D.Be.El(ma.bottomRight),qg.Tli(ma,Ua)).di;return new qg(Ua,D,ma,Xb,yc)}static Tli(D,ma){var Ua;for(let Xb=0;Xb<ma.length;Xb++)if((null===(Ua=ma[Xb])||void 0===Ua?0:Ua.range)&&ma[Xb].range.equals(D))return Xb;return 0}}qg.Ssk=[27];Object(w.a)(qg,
"TableResizeBehavior",Yg.a,[]);var Gg=a(253);class eg{}eg.X2h="ewa-ttrd-buttonarea";Object(w.a)(eg,"CssClassNames",null,[]);var Jf=a(148),Rf=a(149),Kg=a(301);class Uf extends Gg.a{constructor(D,ma){super(document.createElement("div"));this.J$c=this.PHd=this.z$f=this.tW=!1;this.K8d=null;this.yh=()=>{Kh.d(this.$,this.gridView.ha.pa.activeCell)?(this.lVa=!0,this.wDb(!1)):(this.k6=this.lVa=!1,this.SJg())};this.cx=()=>{this.lVa?this.wDb(!0):this.k6=!1};this.VGa=()=>{this.J$c=!0;this.lVa&&(this.k6=!1)};
this.onContentReady=()=>{this.$.isEditMode?Kh.d(this.$,this.gridView.ha.pa.activeCell)&&(this.lVa=!0,this.wDb(!1)):this.k6=!1};this.Vca=()=>{this.J$c=!1;this.lVa?this.wDb(!1):this.k6=!1};this.Mh=(Ua,Xb)=>{this.lVa&&(Ua=this.gridView.dZa(Xb.wg.block.Ah.BlockCachePosition.PaneType).SG(Xb.wg.hash))&&(Ua.y4d(this.pzf),Ua.hcd(this.pzf))};this.pzf=()=>{this.Ilg()};this.$=D;this.zoom=ma;this.gridView=ua.h(this.$);this.parentElement=this.domElement;this.parentElement.className=eg.X2h;this.rUa=this.gridView.xn;
this.Qtd=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.lVa=!0;this.cOi();this.Qtd&&this.GLi();this.Clh();this.wDb(!1);z.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get zoomManager(){return Tb.EwaSettings.Pi()?this.zoom.zoomManager:U.a(this.$)}get k6(){return this.PHd}set k6(D){this.PHd!==D&&(this.PHd=this.isVisible=D)}get uOb(){return!!(this.$.Wg&16)}get tYi(){const D=this.gridView.ha.pa.activeCell;return D.right===D.maxColumns}get pyb(){const D=
this.gridView.Pe(null);return D&&this.gridView.nja(D.range)?this.RDa(D):(D&&z.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.iQh();this.$=this.gridView=this.parentElement=this.rUa=null;super.dispose()}Hji(D){const ma=this.bAi(this.gridView.Pe(null).range);return ma?this.Qtd?`=${this.Kuf()}(${D}${this.$.listSeparator}${ma})`:`=SUBTOTAL(${D},${ma})`:null}Kuf(){var D,ma,Ua;return null!==(Ua=null===(ma=null===
(D=this.Zg)||void 0===D?void 0:D.localeInfo)||void 0===ma?void 0:ma.getWorksheetFuncName(344))&&void 0!==Ua?Ua:"SUBTOTAL"}bAi(D){var ma=ua.h(this.$).Je.gj(D);if(!ma)return null;ma=gf.a(ma,!1);ma.right=ma.left=D.left;return ma.toString()}cOi(){Uf.JO={};Uf.JO["100"]=ad.a.instance.ia(1105);Uf.JO["101"]=ad.a.instance.ia(1108);Uf.JO["102"]=ad.a.instance.ia(1107);Uf.JO["103"]=ad.a.instance.ia(1112);Uf.JO["104"]=ad.a.instance.ia(1109);Uf.JO["105"]=ad.a.instance.ia(1110);Uf.JO["109"]=ad.a.instance.ia(1106);
Uf.JO["107"]=ad.a.instance.ia(1113);Uf.JO["110"]=ad.a.instance.ia(1115);Uf.JO["111"]=ad.a.instance.ia(1166)}GLi(){void Eb.a.resolve(kc.u).then(D=>this.Zg=D)}GCj(){var D=this.gridView.Pe(null);if(D&&(D=D.cy?D.formulaBarText:null))if(this.Qtd){const ma="="+this.Kuf()+"(",Ua=ma.length;if(D.toUpperCase().startsWith(ma)){if(D=D.substring(Ua,Ua+3),D in Uf.JO)return D}else return"111"}else if("=SUBTOTAL("===D.substring(0,10)){if(D=D.substring(10,13),D in Uf.JO)return D}else return"111";return"100"}Clh(){this.gridView.ya.ot(this.Mh);
this.gridView.ha.add_activeCellChanged(this.yh);this.gridView.Dw(this.onContentReady);this.gridView.cellTextEditBox.jr(this.VGa);this.gridView.cellTextEditBox.Wr(this.Vca)}iQh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.remove_activeCellChanged(this.yh),this.gridView.ya.ys(this.Mh)),this.gridView.qz(this.onContentReady),this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.$q(this.VGa),this.gridView.cellTextEditBox.Zq(this.Vca)),this.SJg())}wDb(D){this.DDk(D);this.uOb&&(this.vrk(),
this.pyb?(this.z$f||this.Olh(),this.J$c?this.k6=!1:(this.k6=!0,this.Ilg())):(z.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.k6=!1))}Ilg(){appChrome.renderTableTotalRowOptions(this.parentElement,Uf.JO,Uf.JO[this.GCj()].toString(),Math.round(this.zoomManager.Jk(17)),D=>{z.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${D}`);const ma={["SelectedOption"]:Uf.JO[D],
["FunctionKeyCode"]:D,["Location"]:"canvas"};Rf.b(this.$).Gg(Jf.a.btk,ma,null,!0);if("111"===D)return this.DRi(),!0;if("100"!==D){this.K8d=this.Hji(D);if(!this.K8d)return z.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.F0a(this.K8d)}else this.F0a("");xf.DOMElementExtensions.setFocus(this.gridView.kf.Ja.domElement);return!0})}DRi(){z.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const D=new Dc.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ha.Me(D)}RDa(D){if(!D)return null;var ma=this.gridView.cellTextEditBox.Ja.domElement;var Ua=0<xf.DOMElementExtensions.getHeight(ma)&&0<xf.DOMElementExtensions.getWidth(ma)&&0<=ma.offsetTop&&0<=ma.offsetLeft;if(Ua)ma=xf.DOMElementExtensions.RDa(ma,this.gridView.xn);else{ma=this.gridView.getCellBounds(D.cell);var Xb=xf.DOMElementExtensions.getBoundingClientRect(this.gridView.xn);ma=new Sys.UI.Bounds(ma.x-Xb.x,ma.y-Xb.y,ma.width,ma.height)}if(ma)if(Ua)2<
ma.height&&2<ma.height&&(ma.x+=1,ma.y+=1,ma.height-=2,ma.width-=2);else if(Ua=ua.h(this.$).uP(D.cell))Ua=Ua.width,Xb=Lc.a.equals(cg.a.eIb(D.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Xb&&(ma.x=ma.x+ma.width-Ua),D.Zsa&&this.gridView.rtl===Xb&&(ma.width=Ua);else return null;return ma}DDk(D){var ma=this.pyb;if(ma){var Ua=17>=ma.height?ma.y:ma.y+ma.height-17-2;ma=this.tYi?this.gridView.rtl?ma.x:ma.x+ma.width-(17<ma.height?17:ma.height):this.gridView.rtl?ma.x-(17<ma.height?17:ma.height):ma.x+
ma.width;var Xb=this.zoomManager.ura(new Sys.UI.Point(ma,Ua));this.parentElement.style.top=ac.HelperMethods.rg(Xb.y);this.parentElement.style.left=ac.HelperMethods.rg(Xb.x);this.zoomManager.dbk(this.parentElement);D&&(this.k6=this.gridView.Tyc(new xc.a(ma,Ua)))}else this.k6=!1}Olh(){this.rUa.insertBefore(this.parentElement,this.rUa.firstChild);this.z$f=!0}vrk(){this.tW||(this.gridView.view.Fv(this.cx),this.tW=!0)}SJg(){this.tW&&this.gridView.view&&(this.gridView.view.Fu(this.cx),this.tW=!1)}F0a(D){const ma=
this.gridView.kf,Ua=this.gridView.Pe(null);Ua&&(D=Object(Ka.a)(new Kg.a,{Text:D}),this.gridView.setCell(D,Ua.range,0,127,null),ma.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Uf.atk="TableTotalRowDropDownIconButtonId";Uf.JO=null;Object(w.a)(Uf,"TableTotalRowOptions",Gg.a,[2]);let nh=class extends Jd.a{constructor(D,ma){super(ua.h(D));this.DBb=this.v8=this.oQc=this.BBb=null;this.lPe=!1;this.Vxe=null;this.b5b=0;this.tjc=null;this.iec=()=>{const Ua={},Xb=this.$zd();for(const Tc in Xb){const Sc=
Xb[Tc];if(!Sc)continue;const Gd=this.Yyi(Sc);if(Gd){if(Gd in this.JOa){var yc=this.JOa[Gd];if(yc.bG){yc.dr.equals(Sc)||(yc.dr=Sc);delete this.JOa[Gd];Ua[Gd]=yc;continue}}(yc=qg.createInstance(ua.h(this.$),Sc,this.Dgi(),this,this.zoom))?Ua[Gd]=yc:z.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${Sc.Zz(!1)}`)}}this.xgc(null,null);this.E3b=Ua};this.xgc=()=>{const Ua=this.JOa;for(const Tc in Ua){var Xb=Tc,yc=Ua[Tc];yc&&(yc.dispose(),delete this.JOa[Xb])}this.E3b=
{}};this.Jfg=()=>{this.xgc(null,null);this.iec(null,null)};this.onFocus=()=>{this.Vxe=ua.h(this.$).ha.pa.activeCell};this.wB=()=>{this.$.isEditMode&&this.yh(null,null)};this.yh=()=>{!this.lPe&&Kh.d(this.$,this.gridView.ha.pa.activeCell)&&this.e8i()};this.i1=()=>{this.qLb(1);this.$.ea.cq(this.i1)};this.tUb=()=>{this.lPe=!0;this.oQc=new Uf(this.$,this.zoom)};this.$=D;this.zoom=ma;this.gridView=ua.h(this.$);this.E3b={};this.iec(null,null);this.$.sa&&this.$.sa.Vj(this.Jfg);this.Tbd(this.iec);this.$.ea.aM(this.wB);
this.gridView.ha.add_activeCellChanged(this.yh);this.$.isEditMode&&this.yh(null,null)}Tbd(D){this.addHandler(Jd.a.Olb,D)}m4d(D){this.removeHandler(Jd.a.Olb,D)}Tch(D){this.addHandler("tce",D)}iUj(D){this.removeHandler("tce",D)}get JOa(){return this.E3b}get KMd(){return this.Vxe}get ARa(){return this.b5b}get fs(){const D=ua.h(this.$);return D.Je.gj(D.ha.pa.activeCell,!1)}get D_d(){return this.KMd?ua.h(this.$).Je.gj(this.KMd,!1):null}oLd(D){return!!this.jsf(D)}nu(D){return this.gvi(this.Ssf(D))}NHb(D){return this.Ssf(D)}ORj(D){D?
(this.DBb?this.DBb!==D&&(qf.a.Sa(this.v8),this.v8=null,this.DBb=D):this.DBb=D,this.v8||(this.v8=ag.a.instance.Kh(this.DBb)),this.v8.Ar("focusin")||this.v8.ta("focusin",this.onFocus)):z.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement received")}cHf(D,ma){return D?D.Sra&&D.top===ma.top:(z.ULS.shipAssertTag(537151244,0,!!D,"autofilterRange can't be null"),!1)}tra(D){D=this.BBb?Va.M(D,this.BBb):this.view.getRangeInformation(D);return 0<D.length&&Object(Yd.a)(af.PivotTableRange,
D[0])?D[0]:null}gUi(D,ma){return D?!D.fwc&&!!D.Iv&&D.Iv.Zf(ma):(z.ULS.shipAssertTag(537151243,0,!!D,"Pivot table can't be null"),!1)}A0i(D,ma){return D?!D.fwc&&!!D.qA&&D.qA.Zf(ma):(z.ULS.shipAssertTag(537151242,0,!!D,"Pivot table can't be null"),!1)}Sbc(D){super.Sbc(D);if((D=ac.HelperMethods.usf(D))&&0<D.length){this.BBb=Array(D.length);for(let ma=0;ma<D.length;ma++)this.BBb[ma]=Je.a.kE(D[ma])}}VVb(){super.VVb();this.BBb=null}REh(D,ma){let Ua;Ua=!1;if(!D||!ma)return{returnValue:!1,m4:Ua};D=D.clone();
D.right+=1;D.left=D.right;if(!D.$C)return{returnValue:!1,m4:Ua};if(D.top<ma.Be.Pl){const Xb=D.clone();Xb.bottom>=ma.Be.Pl&&(Xb.bottom=ma.Be.Pl-1);if(!(()=>{let yc=this.B1e(Xb,ma);({m4:Ua}=yc);return yc})().returnValue)return{returnValue:!1,m4:Ua}}if(D.bottom>=ma.Be.Pl){const Xb=D.clone();Xb.top<=ma.Be.Pl&&(Xb.top=ma.Be.Pl);if(!(()=>{let yc=this.B1e(Xb,ma);({m4:Ua}=yc);return yc})().returnValue)return{returnValue:!1,m4:Ua}}return{returnValue:!0,m4:Ua}}vEg(D){(D=this.nu(D.topLeft))&&D.toString()in this.JOa&&
(this.JOa[D.toString()].RKd=!1)}fLj(){this.raiseEvent("tce")}jn(D,ma){if(!this.oQc)return!1;switch(ma){case -569786022:case 541421805:if(this.oQc.k6){const Ua=document.getElementById(Uf.atk);Ua&&Ga.a.instance.create(()=>{xf.DOMElementExtensions.$uc(Ua,null)},0,Ob.a.Usk,!0,!0)}return!0;default:return!1}}dispose(){this.xgc(null,null);this.m4d(this.iec);this.$.sa.vk(this.Jfg);this.$.ar(this.xgc);this.E3b=null;this.$.ea&&this.$.ea.UK(this.wB);this.gridView.ha.remove_activeCellChanged(this.yh);this.oQc=
null;this.v8&&(qf.a.Sa(this.v8),this.v8=null);super.dispose()}AGi(D,ma,Ua,Xb){var yc=this.gridView.Je.gj(new xb.Range(ma,Ua,ma,Ua,!1,!1));if(this.tjc=yc){var Tc=yc.usedRange,Sc=D.ctrlKey||za.a.isMac&&Fg.b(D);yc=!D.shiftKey&&Sc;D=D.shiftKey&&!Sc;ua.h(this.$).ha.selectionType=3;switch(Xb){case 0:this.b5b=0;ma=this.nmd(D,Tc.top,Ua,Tc.bottom,Ua);this.V$d(ma,yc,D);break;case 1:this.b5b=1;ma=this.nmd(D,ma,Tc.left,ma,Tc.right);this.V$d(ma,yc,D);break;case 2:this.b5b=2;ma=this.nmd(D,Tc.top,Tc.left,Tc.bottom,
Tc.right);this.V$d(ma,yc,D);break;default:z.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Xb.toString()}`);return}ua.h(this.$).ha.selectionType=3;z.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else z.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}jgk(D){const ma=this.tjc.usedRange;
return this.tJf(D)||1!==this.ARa&&this.tJf(new xb.Range(ma.top,D.left,ma.bottom,D.right,!1,!1))?!0:!1}$0d(D){return D.Autofilters}B1e(D,ma){let Ua;Ua=!1;const Xb=ma.Be.El(D),yc=ma.wi(Xb).Xk;if(!yc)return z.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Xb}`),{returnValue:!1,m4:Ua};if(!yc.Bh(D))return{returnValue:!0,m4:Ua};D=ma.Ln("TableManager.CouldExpandImpl",D,2);try{for(;D.$$mn();){if(D.$$cu().text||D.Np.reb)return Ua=!0,{returnValue:!1,m4:Ua};if(D.$$cu().mI)return{returnValue:!1,
m4:Ua}}}finally{D&&D.dispose()}return{returnValue:!0,m4:Ua}}gvi(D){if(!D)return null;const ma=new Md.AutofilterRange(D.top,D.left,D.bottom,D.right,null,null,null,D.id,D.Sra);ma.BJa=D.BJa;const Ua=this.gridView.Je.gj(D,!0);if(!Ua)return null;for(let Xb=0,yc=this.rangeList.length;Xb<yc;Xb++){const Tc=this.rangeList[Xb],Sc=this.gridView.Je.gj(Tc,!0);Sc&&Sc.name===Ua.name&&Tc!==D&&this.D_i(Tc)&&(ma.union(Tc),Tc.BJa&&(ma.BJa=!0))}return ma}D_i(D){return!!ua.h(this.$).Je.gj(D)}Dgi(){const D=[];for(const ma of this.rangeList){const Ua=
new Id.a(this.nu(ma.topLeft),ze.d(this.$.na));D.push(Ua)}return D}$zd(){const D={};for(const ma of this.rangeList){if(!ma)continue;const Ua=this.nu(ma.topLeft);Ua&&(D[Ua.toString()]=this.nu(ma.topLeft))}return D}e8i(){this.$.ea.ei?this.qLb(0):this.$.ea.zm(this.i1)}qLb(D){this.$.zP(ma=>{ma.y5(D).then(this.tUb)})}Yyi(D){const ma=this.gridView.Je.gj(D);return ma?ma.name:D.toString()}V$d(D,ma,Ua){D&&(Ua=Ua?ua.h(this.$).ha.pa.activeCell:D.topLeft,Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8480129_RemoveRiskyUnused"),
ma?this.gridView.ha.updateSelection(D,Ua,0,1):this.gridView.ha.ZK([D],0,Ua,0))}nmd(D,ma,Ua,Xb,yc){const Tc=gf.d(this.tjc),Sc=gf.g(this.tjc),Gd=ma+(1!==this.ARa&&Tc?1:0),De=Xb-(1!==this.ARa&&Sc?1:0),ve=this.gridView.inRangePicker||this.gridView.Fm;if(D){var Xe=ve&&!Id.a.Nic(this.gridView.ha.rangePicker.pQ).length?new xb.Range(Gd,Ua,De,yc,!1,!1):ve?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.pa.activeCell;Xe=new xb.Range(Xe.top<Gd?Xe.top:Gd,Xe.left<Ua?Xe.left:Ua,Xe.bottom>De?Xe.bottom:
De,Xe.right>yc?Xe.right:yc,!1,!1)}else Xe=new xb.Range(Gd,Ua,De,yc,!1,!1);if(1!==this.ARa&&(Tc||Sc)&&(!D||D&&this.Jjd(Xe,Gd,Ua,De,yc))){D=ve?Id.a.Nic(this.gridView.ha.rangePicker.pQ):this.gridView.ha.pa.selectedRanges;for(const nf of D)if(this.Jjd(nf,Gd,Ua,De,yc)){Xe.top=ma;Xe.bottom=Xb;break}}return Xe}tJf(D){const ma=this.gridView.inRangePicker||this.gridView.Fm?Id.a.Nic(this.gridView.ha.rangePicker.pQ):this.gridView.ha.pa.selectedRanges;for(const Ua of ma)if(this.Jjd(Ua,D.top,D.left,D.bottom,D.right))return!0;
return!1}Jjd(D,ma,Ua,Xb,yc){return!!D&&D.top===ma&&D.bottom===Xb&&D.left===Ua&&D.right===yc}};nh=Object(vb.__decorate)([Object(Eb.d)(kc.ie),Object(vb.__param)(0,Object(kc.nb)()),Object(vb.__param)(1,Object(kc.ze)())],nh);Object(w.a)(nh,"TableManager",Jd.a,[563,2]);let zh=class extends Jd.a{constructor(D){super(Object(ua.h)(D))}byi(D){for(const ma of this.rangeList)if(D.range.contains(ma))return ma;return null}$0d(D){return D.GridBlockModel&&(D=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(D.GridBlockModel))?
D.getSparklineRanges():null}};zh=Object(vb.__decorate)([Object(Eb.d)(kc.ce),Object(vb.__param)(0,Object(kc.nb)())],zh);Object(w.a)(zh,"SparklineManager",Jd.a,[565]);let Ph=class extends Cc.a{constructor(){super()}jgh(D){this.addHandler("TAF",D)}eXj(D){this.removeHandler("TAF",D)}sLj(){this.raiseEvent("TAF")}};Ph=Object(vb.__decorate)([Object(Eb.d)(kc.Xb),Object(vb.__param)(0,Object(kc.nb)())],Ph);Object(w.a)(Ph,"GridHighlightBehaviorEventManager",Cc.a,[564,2]);var ii=a(82),Fh=a(132);class ji extends Sys.EventArgs{constructor(D,
ma){super();this.start=D;this.bfb=ma}}Object(w.a)(ji,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);class Ii extends Cc.a{constructor(D){super();this.pBc=[3];this.xya=void 0;this.gridView=D;this.zIg=Pd.a.ZF();this.XS=Pd.a.ZF()}get coloredReferencesManager(){const D=this.gridView.$.ja.Qa(281);D||z.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
return D}get Sz(){if(this.xya)return this.xya;const D=this.gridView.$.ja.Qa(464);D||z.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");D.Sz||z.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.xya=D.Sz}Leh(D){this.addHandler("mrek",
D)}L1(D,ma,Ua){for(const Xb of this.gridView.Jr)of.a.instance.va(Oe.a.Yp,Xb.domElement,D);of.a.instance.va(Oe.a.Hk,document.documentElement,ma);this.gridView.cellTextEditBox.ubb(!0);Ua&&of.a.instance.va(Oe.a.pG,this.gridView.xn,ma)}GQj(D,ma,Ua){document.documentElement.addEventListener("pointermove",D);document.documentElement.addEventListener("pointerup",ma);this.gridView.cellTextEditBox.ubb(!0);Ua&&this.gridView.xn.addEventListener("pointerleave",ma)}wie(D,ma,Ua){for(const Xb of this.gridView.Jr)of.a.instance.Da(Oe.a.Yp,
Xb.domElement,D);of.a.instance.Da(Oe.a.Hk,document.documentElement,ma);this.gridView.cellTextEditBox.ubb(!1);Ua&&of.a.instance.Da(Oe.a.pG,this.gridView.xn,ma)}ABk(D,ma,Ua){document.documentElement.removeEventListener("pointermove",D);document.documentElement.removeEventListener("pointerup",ma);this.gridView.cellTextEditBox.ubb(!1);Ua&&this.gridView.xn.removeEventListener("pointerleave",ma)}HQj(D,ma){for(const Ua of this.gridView.Jr)Cf.a.instance.va(Oe.a.mk,Ua.domElement,D);Cf.a.instance.va(Oe.a.Uh,
document.documentElement,ma)}BBk(D,ma){for(const Ua of this.gridView.Jr)Cf.a.instance.Da(Oe.a.mk,Ua.domElement,D);Cf.a.instance.Da(Oe.a.Uh,document.documentElement,ma)}w2e(D,ma,Ua,Xb){const yc=document.createElement("div");yc.className=ma;for(const Tc of Ua)yc.classList.add(Tc);D.appendChild(yc);of.a.instance.va(Oe.a.yg,yc,Xb);return yc}Otf(D){D=D.rf.parentNode;if(!D)return z.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),
null;D=parseInt(D.getAttribute(id.a.bfb),10);return isNaN(D)?(z.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Se.KM(3,1,D)}cZb(D,ma,Ua){D=(void 0===Ua?!0:Ua)&&(this.XS?!!this.Sz&&this.Sz.KYi(D):!!this.coloredReferencesManager&&this.coloredReferencesManager.JYi(D));for(const Xb of ma)xf.DOMElementExtensions.setVisible(Xb,D)}gpc(){return this.gridView.ov?Fh.a(this.gridView.$):this.gridView.kf}Kgg(){if(this.XS){var D=
this.gpc();D&&this.Sz?this.zIg?D.aR(null):this.Sz.yqb(D,null):(z.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Se.Fl(this.pBc),this.gridView.Se.lo(null,this.pBc))}else this.fOj()}fOj(){const D=this.gpc();D&&this.coloredReferencesManager?this.zIg?D.aR(null):this.coloredReferencesManager.aR(D,null):(z.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),
this.gridView.Se.Fl(this.pBc),this.gridView.Se.lo(null,this.pBc))}Veg(D,ma){this.raiseEvent("mrek",new ji(D,ma))}}Object(w.a)(Ii,"BehaviorHelperMethods",Cc.a,[]);class mg extends Yg.a{constructor(D,ma){super(D,void 0===ma?null:ma)}m8a(){}}Object(w.a)(mg,"HighlightFlyweightBehavior",Yg.a,[]);var li=a(18),Mh=a(450),Ci=a(142),oi=a(266),Wg=a(36);class Rh extends Gg.a{constructor(D,ma,Ua,Xb){super(document.createElement("div"));this.kjc=null;this.D2b=!1;this.onPointerDown=yc=>{yc=this.zoomManager?this.zoomManager.Sh(yc):
yc;this.D2b=!1;if(3===(ob.a.Ke=yc.Te)){const Tc=yc.Ga.rawEvent,Sc=Tc.srcElement||Tc.target;xf.DOMElementExtensions.Ek(this.domElement,Sc)&&xf.DOMElementExtensions.Ek(Tc.currentTarget,Sc)&&(this.D2b=!0,this.kjc=yc.clientPoint)}return!1};this.Yk=yc=>{yc=this.zoomManager?this.zoomManager.Sh(yc):yc;this.raiseEvent("GrPointerUp",yc);return this.D2b=!1};this.rn=yc=>{yc=this.zoomManager?this.zoomManager.Sh(yc):yc;3===yc.Te&&this.D2b&&this.yHi(yc.clientPoint)&&(this.raiseEvent("GrDrag"),this.D2b=!1);return!1};
this.Hg=yc=>{this.zoomManager&&this.zoomManager.Sh(yc);return!0};this.$=Ua;this.zoom=Xb;this.domElement.classList.add(Wg.a.Bff);this.domElement.classList.add(Wg.a.$mc);D.appendChild(this.domElement);xf.DOMElementExtensions.setVisible(this.domElement,!1);this.vUa=document.createElement("div");this.vUa.classList.add(Wg.a.Zmc);this.vUa.style.borderColor=ma;this.domElement.appendChild(this.vUa);of.a.instance.va(Oe.a.yg,this.domElement,this.onPointerDown);of.a.instance.va(Oe.a.Hk,this.domElement,this.Yk);
Cf.a.instance.va(Oe.a.Uh,this.domElement,this.Yk);of.a.instance.va(Oe.a.Yp,this.domElement,this.rn);Cf.a.instance.va(Oe.a.mk,this.domElement,this.rn);oi.a.instance.va(Oe.a.click,this.domElement,this.Hg)}get zoomManager(){return Tb.EwaSettings.Pi()?this.zoom.zoomManager:U.a(this.$)}BMe(D){this.addHandler("GrDrag",D)}Ekg(D){this.removeHandler("GrDrag",D)}AMe(D){this.addHandler("GrContxt",D)}Dkg(D){this.removeHandler("GrContxt",D)}CMe(D){this.addHandler("GrPointerUp",D)}Fkg(D){this.removeHandler("GrPointerUp",
D)}dispose(){sa.a.oIa(this.domElement);super.dispose()}ktg(){this.domElement.classList.remove(Wg.a.$mc);this.vUa.classList.remove(Wg.a.Zmc);this.vUa.classList.add(Tb.EwaSettings.uu?Wg.a.Dff:Wg.a.Cff)}NJg(){this.vUa.classList.remove(Tb.EwaSettings.uu?Wg.a.Dff:Wg.a.Cff);this.vUa.classList.add(Wg.a.Zmc);this.domElement.classList.add(Wg.a.$mc)}yHi(D){return!!this.kjc&&(3<Math.abs(D.x-this.kjc.x)||3<Math.abs(D.y-this.kjc.y))}static YHb(D,ma){D=Tb.EwaSettings.Pi()?ma.zoomManager?ma.zoomManager.zoom:pd.a.vI:
U.a(D.$)?U.a(D.$).zoom:pd.a.vI;return Math.round(9/Math.max(D,1))}}Rh.PQd=0;Object(w.a)(Rh,"TouchGrippie",Gg.a,[]);var Di=a(133);class xh extends mg{constructor(D,ma,Ua,Xb,yc){super(ma);this.BLd=this.gAb=!1;this.jfc=null;this.pI=this.dja=this.xLd=!1;this.CB=()=>{this.gAb&&this.xLd?this.fwa():this.Gba()};this.C2f=Sc=>{3===Sc.Te&&(this.xLd=!0,this.fwa());return!1};this.D2f=Sc=>{if(3===Sc.Te){if(!Sc.rf||this.QVi(Sc))return!1;this.xLd=!1;this.Gba()}return!1};this.dk=()=>{this.dja&&this.Aie();this.fwa();
this.BLd=!1};this.dx=()=>{this.Gba();this.BLd=!0};this.mHa=(Sc,Gd)=>{Gd.Jba===this.Jba&&(Gd.visible?this.BLd||this.fwa():this.Gba())};this.A8f=()=>{this.E2f(this.gY.domElement,!1)};this.CZf=()=>{this.E2f(this.rV.domElement,!0)};this.TDc=(Sc,Gd)=>{this.pI&&Di.b(this.gridView.$).pL(Gd.Ga.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.Lua(Gd)};this.UDc=(Sc,Gd)=>{this.pI&&Di.b(this.gridView.$).pL(Gd.Ga.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.Lua(Mh.b(Gd))};this.HSb=()=>{3===
ob.a.Ke?this.fwa():this.Gba();this.dja&&1===ob.a.Ke&&this.Aie()};this.B8f=()=>{this.C8j()};this.L9e=()=>{this.Gba()};this.Ir=()=>{this.ha.Ua.gf&&this.Gba()};this.oZf=()=>{this.Gba()};this.v2f=(Sc,Gd)=>{this.Aie();3===Gd.Te?this.fwa():this.Gba()};this.IHc=()=>{this.gAb&&(this.Gba(),this.fwa())};const Tc=Ua.$;this.zx=Ua;this.zoom=yc;this.ha=Ua.ha;this.QM=D;this.U5j=ma;this.paneType=Xb;D=this.domElement.currentStyle;ma="#000000";D&&(ma=D.borderTopColor);this.gY=new Rh(this.Eif(),ma,Tc,yc);this.rV=new Rh(this.Eif(),
ma,Tc,yc);this.gY.BMe(this.A8f);this.gY.AMe(this.TDc);this.gY.CMe(this.UDc);this.rV.BMe(this.CZf);this.rV.AMe(this.TDc);this.rV.CMe(this.UDc);for(const Sc of this.gridView.Jr)Cf.a.instance.va(Oe.a.oj,Sc.domElement,this.D2f),Cf.a.instance.va(Oe.a.Uh,Sc.domElement,this.C2f);Ua.view.Fv(this.CB);Ua.kf.jr(this.L9e);Ua.Se.qzb(this.mHa);Ua.acc(this.oZf);Tc.MD(this.IHc);Ua.Dw(this.IHc);this.ha.woa(this.dk);this.ha.xoa(this.dx);Ua.tJ(this.Ir);this.ha.ezb(this.v2f);ob.a.JMe(this.HSb);ne.TaskExtensions.Ca(Object(ub.d)(Eb.a.resolve(kc.Xb,
{Aa:0})),Sc=>{Sc.result.jgh(this.B8f)},Tc.qa,3);this.pI=Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncContextMenu",!1)}get gridView(){return this.zx}dispose(){qf.a.Wf([this.gY,this.rV]);this.gY.Ekg(this.A8f);this.gY.Dkg(this.TDc);this.gY.Fkg(this.UDc);this.rV.Ekg(this.CZf);this.rV.Dkg(this.TDc);this.rV.Fkg(this.UDc);for(var D of this.gridView.Jr)Cf.a.instance.Da(Oe.a.oj,D.domElement,this.D2f),Cf.a.instance.Da(Oe.a.Uh,D.domElement,this.C2f);this.gridView.view.Fu(this.CB);this.gridView.kf.$q(this.L9e);
this.gridView.Se.AWb(this.mHa);this.gridView.WIc(this.oZf);this.gridView.$.wG(this.IHc);this.gridView.qz(this.IHc);this.ha.zda(this.dk);this.ha.ela(this.dx);this.gridView.VK(this.Ir);this.ha.rWb(this.v2f);ob.a.Lkg(this.HSb);this.dja&&z.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(D=Eb.a.mg(kc.Xb))&&D.eXj(this.B8f);super.dispose()}k1a(){if(!this.QM.range||!this.QM.range.equals(this.Hnb))return!1;const D=!this.gridView.cWa();return this.gridView.De&&
D&&(this.Hnb.isRow||this.Hnb.Ei)?!1:this.dja?!0:3===ob.a.Ke}Gba(){this.gAb&&(this.gY.set_visible(!1),this.rV.set_visible(!1),this.gAb=!1)}fwa(){if(this.k1a()){var D=xf.DOMElementExtensions.getBoundingClientRect(this.jfc);D||z.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.gridView.xn,this.gridView.Be.Gl);var ma=xf.DOMElementExtensions.getBoundingClientRect(this.U5j),Ua=new Sys.UI.Bounds(ma.x-D.x,ma.y-D.y,ma.width,ma.height),Xb=
this.Hnb,yc=Xb.topLeft,Tc=Xb.bottomRight,Sc=Xb.isRow||Xb.Ei;if(Xb.Ei){var Gd=this.j$h();Xb=Ua.x-2*Rh.YHb(this.gridView,this.zoom);var De=Gd;var ve=Ua.x+ma.width}else Xb.isRow?(Xb=ve=this.i$h(),De=Ua.y-2*Rh.YHb(this.gridView,this.zoom),Gd=Ua.y+ma.height):(De=Ua.y,Gd=Ua.y+ma.height,this.gridView.rtl?(Xb=Ua.x+ma.width,ve=Ua.x):(Xb=Ua.x,ve=Ua.x+ma.width));ma=Rh.PQd+(Sc?0:Rh.YHb(this.gridView,this.zoom));this.gY.style.left=ac.HelperMethods.rg(Xb-ma);this.gY.style.top=ac.HelperMethods.rg(De-ma);this.rV.style.left=
ac.HelperMethods.rg(ve-ma);this.rV.style.top=ac.HelperMethods.rg(Gd-ma);this.gY.set_visible(this.bHf(De,Xb,yc,Sc,D));this.rV.set_visible(this.bHf(Gd,ve,Tc,Sc,D));this.gAb=!0}}bHf(D,ma,Ua,Xb,yc){const Tc=xf.DOMElementExtensions.getBoundingClientRect(this.gridView.wi(this.paneType).domElement);yc=new Sys.UI.Bounds(Tc.x-yc.x-3,Tc.y-yc.y-3,Tc.width+6,Tc.height+6);return(this.gridView.Be.El(Ua)===this.paneType||Xb)&&He.a.$S(yc,new Sys.UI.Point(ma,D))}j$h(){return(this.gridView.view.visibleArea.height+
this.gridView.Be.height+Rh.PQd-Rh.YHb(this.gridView,this.zoom))/2}i$h(){return(this.gridView.view.visibleArea.width+this.gridView.Be.width+Rh.PQd-Rh.YHb(this.gridView,this.zoom))/2}K6f(){this.fwa()}QVi(D){return xf.DOMElementExtensions.vnb(D.rf,li.a.fE)&&(this.jXi(D)||this.kXi(D))}kXi(D){if(this.gridView.rtl)D=D.clientPoint.x;else{const ma=xf.DOMElementExtensions.getBoundingClientRect(D.rf);D=D.clientPoint.x-(ma.x+ma.width-Ci.a.vz)}return 0<D&&D<=Ci.a.vz}jXi(D){const ma=xf.DOMElementExtensions.getBoundingClientRect(D.rf);
D=D.clientPoint.y-(ma.y+ma.height-Ci.a.vz);return 0<D&&D<=Ci.a.vz}E2f(D,ma){this.dja&&z.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.Ngd(D,ma,this.dja);this.Gba()}C8j(){this.dja||(z.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.dja=!0,this.gY.ktg(),this.rV.ktg(),this.gridView.ha.sourceRange=this.gridView.ha.pa.og,this.fwa())}Aie(){this.dja&&(z.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.dja=!1,this.gY.NJg(),this.rV.NJg())}Eif(){this.jfc||(this.jfc=this.gridView.xn);return this.jfc}}Object(w.a)(xh,"SelectionTouchGrippiesBehaviorBase",mg,[]);class fh extends xh{constructor(D,ma,Ua,Xb,yc){super(D,ma,Ua,Xb,yc)}get Jba(){return 19}get Hnb(){return this.gridView.ha.pa.activeRange}k1a(){const D=this.gridView.Fm||this.gridView.De;return!this.gridView.ha.pa.Fk&&!D&&super.k1a()}}Object(w.a)(fh,"DiscontinuousSelectionTouchGrippiesBehavior",xh,[]);var bi=a(685);class ei extends mg{constructor(D){super(D);
const ma=document.createElement("div");ma.className=Wg.a.p5h;D.appendChild(ma)}}Object(w.a)(ei,"SelectionBorderBehavior",mg,[]);class Xf{}Xf.Tff="ewr-selection-draghandle-grab";Xf.k5h="ewr-selection-draghandle-top-enhanced";Xf.e5h="ewr-selection-draghandle-bottom-enhanced";Xf.g5h="ewr-selection-draghandle-left-enhanced";Xf.i5h="ewr-selection-draghandle-right-enhanced";Xf.l5h="ewr-selection-draghandle-top-updated";Xf.f5h="ewr-selection-draghandle-bottom-updated";Xf.h5h="ewr-selection-draghandle-left-updated";
Xf.j5h="ewr-selection-draghandle-right-updated";Xf.m5h="ewr-selection-dragtooltip-updated";Xf.d5h="ewr-selection-drag-tooltip-fluent";Xf.Uff="ewr-selection-draghandle-reduced";Xf.E5h="ewr_selection_rearrangeleft";Xf.F5h="ewr_selection_rearrangeright";Xf.G5h="ewr_selection_rearrangetop";Xf.D5h="ewr_selection_rearrangebottom";Xf.w5h="ewr_selection_rearrange-flange-left";Xf.A5h="ewr_selection_rearrange-fullrowcol-flange-left";Xf.x5h="ewr_selection_rearrange-flange-right";Xf.B5h="ewr_selection_rearrange-fullrowcol-flange-right";
Xf.y5h="ewr_selection_rearrange-flange-top";Xf.C5h="ewr_selection_rearrange-fullrowcol-flange-top";Xf.v5h="ewr_selection_rearrange-flange-bottom";Xf.z5h="ewr_selection_rearrange-fullrowcol-flange-bottom";Xf.selecting="selecting";Xf.c5h="ewr-selection-drag-shadow";Xf.H5h="ewr-selection-resizemarqueehandle";Xf.K5h="ewr-selection-resizemarqueehandle-topleft";Xf.L5h="ewr-selection-resizemarqueehandle-topright";Xf.I5h="ewr-selection-resizemarqueehandle-bottomleft";Xf.J5h="ewr-selection-resizemarqueehandle-bottomright";
Xf.V4h="ewr-marquee-thick";Xf.X4h="ewr-resizemarqueehandle-thick";Object(w.a)(Xf,"CssClassNames",null,[]);class lh extends ei{constructor(D,ma,Ua,Xb,yc){super(D);this.V1a=!1;this.S$c=this.T$c=null;this.Vke=this.YDd=this.VZ=this.hga=0;this.w1=this.Xe=this.sourceRange=this.Gua=null;this.Yk=Tc=>{Tc=this.zoomManager.Sh(Tc);return this.s5f(Tc)};this.onPointerDown=Tc=>{Tc=this.zoomManager.Sh(Tc);if(!this.UNc())return!1;if(2===Tc.Te&&Tc.vs===Sys.UI.MouseButton.leftButton&&!this.V1a){var Sc=this.sAd(Tc);
if(!Sc)return z.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Xe=Sc.clone();this.sourceRange=this.Xe.clone();this.Gua=this.Xe;if(Sc=this.Gri(Tc))return this.Ks=5,this.Vke=Sc.top-this.sourceRange.top,this.YDd=Sc.left-this.sourceRange.left,ua.h(this.$).Dk.iw(lh.pFb),this.uWd(Tc),this.V1a=!0,Df.b(this.$,!0),!0}return!1};this.rn=Tc=>{Tc=this.zoomManager.Sh(Tc);if(this.vWd(Tc))return!0;if(Tc=this.Wv?this.ha.h4(Tc.clientPoint,Tc.rf,5,!0):
this.ha.Mt(Tc.clientPoint,Tc.rf,5,void 0,void 0,!0)){Tc=this.FBb(Tc);if(this.Xe.equals(Tc))return!0;this.Xe=Tc;if(!this.L2())return z.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.snc(!0),!1}return!0};this.q5f=Tc=>{Tc=new Sys.UI.DomEvent(Tc);Tc=bi.a.create(Tc.type,Tc.target,Tc,2);return this.S$c(Tc)};this.v5f=Tc=>{Tc=new Sys.UI.DomEvent(Tc);Tc=bi.a.create(Tc.type,Tc.target,Tc,2);return this.T$c(Tc)};this.Xg=(Tc,Sc)=>{Sc.cT||this.eob(this.$.isEditMode)};
this.UJ=[];this.$=ma;this.gridView=ua.h(this.$);this.zoom=yc;this.ha=ua.h(this.$).ha;this.paneType=Ua;this.Xr=Xb;this.Wv=Tb.EwaSettings.Wv();Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdatingGrabHandlePropertiesForHighlightedCell",!1)?this.P8d=[Xf.l5h,Xf.f5h,Xf.h5h,Xf.j5h]:this.P8d=[Xf.k5h,Xf.e5h,Xf.g5h,Xf.i5h];this.$.Go(this.Xg)}get zoomManager(){return Tb.EwaSettings.Pi()?this.zoom.zoomManager:U.a(this.$)}get Se(){return ua.h(this.$).Se}get Ks(){return this.ha.selectionType}set Ks(D){this.ha.selectionType=
D}dispose(){this.UJ.forEach(D=>{of.a.instance.Da(Oe.a.yg,D,this.onPointerDown)});this.UJ.length=0;this.Gua=this.sourceRange=this.Xe=null;z.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.hga}, EwaControl is null : ${!this.$}`);this.$&&(this.$.Hp(this.Xg),1===this.hga&&(z.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.AV(this.S$c,this.T$c,!1)));super.dispose()}s5f(D){if(5!==
this.Ks)return!1;(D=this.CYa(D))||this.snc(!1);Df.b(this.$,!1);return D}L1(D,ma){z.ULS.shipAssertTag(537159377,0,!this.hga,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.hga}`);this.hga+=1;this.S$c=D;this.T$c=ma;this.Wv?this.Xr.GQj(this.q5f,this.v5f,this.Z0b()):this.Xr.L1(D,ma,this.Z0b())}FBb(D){if(!D||!this.Xe)return z.ULS.shipAssertTag(537159376,0,!!D,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),
z.ULS.shipAssertTag(537159375,0,!!this.Xe,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ma=this.Xe.clone();1!==this.VZ&&(ma.left=Math.max(D.left-this.YDd,1),ma.right=ma.left+this.sourceRange.width-1);2!==this.VZ&&(ma.top=Math.max(D.top-this.Vke,1),ma.bottom=ma.top+this.sourceRange.height-1);return this.Bzb(ma)}AV(D,ma,Ua,Xb){Ua=void 0===Ua?!0:Ua;Xb=void 0===Xb?!0:Xb;z.ULS.shipAssertTag(537159374,0,1===this.hga,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.hga}`);
--this.hga;this.Wv?this.Xr.ABk(this.q5f,this.v5f,this.Z0b()):this.Xr.wie(D,ma,this.Z0b());Ua&&this.eYe(Xb);this.VZ=0;this.V1a=!1}Bzb(D){var ma=ua.h(this.$);let Ua=D;if(ma.Be.BS){if(!ma.Pe(D.topLeft)){ma=ma.Ln("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ma.dW,this.Gua.top!==D.top?1:2);try{ma.vo=this.Gua.top<D.top||this.Gua.left<D.left,ma.fA(D.topLeft),Ua=ma.$$cu().range}finally{ma&&ma.dispose()}}Ua.right=Math.min(Ua.left+D.width-1,pd.a.hi);Ua.bottom=Math.min(Ua.top+D.height-1,pd.a.oi)}return this.Gua=
Ua}eob(D){this.UJ.forEach(ma=>{xf.DOMElementExtensions.setVisible(ma,D)})}Gri(D){const ma=D.rf;D=D.clientPoint;if(!ma||!D)return z.ULS.shipAssertTag(537159373,0,!!ma,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),z.ULS.shipAssertTag(537159372,0,!!D,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;D.y+=ma===this.UJ[lh.epd]?2:ma===this.UJ[lh.h9e]?-2:0;D.x+=ma===this.UJ[lh.i9e]?2:ma===this.UJ[lh.dpd]?-2:0;return this.Wv?this.ha.h4(D,ma,5,!0):this.ha.Mt(D,
ma,5,void 0,void 0,!0)}}lh.n1e="copy";lh.pFb="grabbing";lh.epd=0;lh.h9e=1;lh.i9e=2;lh.dpd=3;Object(w.a)(lh,"DragSelectionClickBehaviorBase",ei,[]);class Ei extends lh{constructor(D,ma,Ua,Xb,yc,Tc,Sc){super(D,ma,Ua,yc,Sc);this.eg=this.WK=null;this.Dxf=()=>{this.snc(!0)};for(const Gd of this.P8d)ma=this.Xr.w2e(D,Gd,[Xf.Tff],this.onPointerDown),this.UJ.push(ma);this.eob(this.$.isEditMode);this.yK=Xb;this.coloredReferencesManager=this.$.ja.Qa(281);z.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,
"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.XS=Pd.a.ZF())D=this.$.ja.Qa(464),z.ULS.shipAssertTag(512312961,0,!!D,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.Sz=D.Sz;for(const Gd of this.UJ)of.a.instance.va(Oe.a.x1,Gd,this.yK.PAf),of.a.instance.va(Oe.a.pG,Gd,this.yK.QAf);this.m8a(Tc)}m8a(D){this.Xr.cZb(D,this.UJ);this.yK.aU()}uWd(D){z.ULS.sendTraceTag(537159390,
0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.ZUa=!0;this.eg.yJ(!1);this.Ks=5;this.yK.k9e(D.rf);this.eg.Ja.removeSelection();this.eg.pcc(this.Dxf);this.L1(this.rn,this.Yk);this.VZ=this.sourceRange.isRow?1:this.sourceRange.Ei?2:0}CYa(){const D=this.q2();this.Ks=-1;this.AV(this.rn,this.Yk);return D}eYe(){this.gridView.ZUa=!1;this.yK.l9e(this.UJ[0]);this.eg.Ja.setCaretPositionToEnd();this.eg.hJc(this.Dxf);this.Xr.Kgg()}snc(D){z.ULS.sendTraceTag(537159389,
0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");D&&this.AV(this.rn,this.Yk)}sAd(D){this.eg=this.Xr.gpc();this.WK=this.Xr.Otf(D);return this.eg&&this.WK&&this.WK.range?this.WK.range:(z.ULS.shipAssertTag(537159388,0,!!this.eg,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),z.ULS.shipAssertTag(537159387,0,!!this.WK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),
z.ULS.shipAssertTag(537159386,0,!!this.WK.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}q2(){return this.WK?this.XS?this.Sz.iRb(this.eg,this.WK,this.Xe):this.coloredReferencesManager.iRb(this.eg,this.WK,this.Xe):(z.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}L2(){return this.q2()}Z0b(){return!0}vWd(){return!1}UNc(){return!0}}
Object(w.a)(Ei,"DragMarqueeClickBehavior",lh,[]);var wi=a(99),yi=a(811),Ji=a(70),Ki=a(347),zi=a(210);class ig extends lh{constructor(D,ma,Ua,Xb,yc,Tc){super(D,ma,Ua,yc,Tc);this.uha=this.pl=null;this.Ei=this.isRow=!1;this.Gm=Tb.EwaSettings.Gm();this.hbb=Ji.a.f5;this.ulc=0;this.dk=()=>{this.domElement.classList.remove(Xf.selecting);Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8222878_DisableGrabHandlesForEntireSheetSelection")&&(this.FYh()?this.eob(!1):this.eob(!0));if(ig.oPj&&this.ha.pa.bT){const Sc=
this.Pe(this.ha.pa.og);null!==Sc&&(Sc.hasAutoFilter?this.domElement.classList.add(Xf.Uff):this.domElement.classList.remove(Xf.Uff))}};this.dx=()=>{this.domElement.classList.add(Xf.selecting)};this.Lg=()=>{if(this.$.isEditMode){const Sc=this.UNc();this.eob(Sc)}};this.Ug=Xb;this.OHd=!1;if(0===ig.Wkc[Ua].length)for(const Sc of this.P8d)ma=document.createElement("div"),ma.className=Sc,ma.classList.add(Xf.Tff),ig.Wkc[Ua].push(ma);for(const Sc of ig.Wkc[Ua])D.appendChild(Sc),of.a.instance.va(Oe.a.yg,Sc,
this.onPointerDown),this.UJ.push(Sc);this.eob(this.$.isEditMode);this.Ku={};this.gridView.VS=!1;this.ha.xoa(this.dx);this.ha.woa(this.dk)}dispose(){this.ha&&(this.ha.ela(this.dx),this.ha.zda(this.dk));if(this.Ku)for(var D=1;4>=D;D++)xf.DOMElementExtensions.Lj(this.Ku[D.toString()]);for(D=1;4>=D;D++)ig.Wkc[D].length=0;this.Ku=this.pl=null;super.dispose()}eYe(D){D&&(ua.h(this.$).Dk.iw(id.a.S5),lf.KeyInputManager.instance.Da(Oe.a.Hf,this.domElement.ownerDocument.body,this.onKeyDown),this.gridView.VS=
!1);for(D=1;4>=D;D++){const ma=this.Ku[D.toString()];ma&&ma.parentNode.removeChild(ma);this.Ku[D.toString()]=null}this.pl=null}sAd(){return this.ha.pa.og}q2(){this.ha.updateSelection(this.Xe,this.Xe.topLeft,0);return!0}wJa(D,ma){ma=void 0===ma?!1:ma;var Ua=!isNullOrUndefined(this.wha);if(D&&ma||D!==Ua){Ua=this.q6();var Xb=this.bja();D&&(Ua||Xb)?(ma&&this.wha&&(this.Se.Fl(this.wha),this.wha=null),this.Se.Ftc(!0),this.wha=this.NHd()?[65]:[62,Ua?63:64],this.Se.lo(this.sourceRange,this.wha),this.Se.Ys(this.wha),
z.ULS.sendTraceTag(507872737,0,50,`DragSelectionClickBehavior.showOrHideSourceHighlights: show source highlights for ${this.NHd()?"copy":"cut"} operation`)):this.wha&&(this.Se.Fl(this.wha),this.wha=null,this.Se.hwa(),z.ULS.sendTraceTag(507872736,0,50,"DragSelectionClickBehavior.showOrHideSourceHighlights: hide source highlights"))}}jTc(){const D=!isNullOrUndefined(this.wha);this.wJa(D,!0)}L2(D){D=void 0===D?!1:D;if(this.Gm){const Ua=this.q6();var ma=this.bja();Ua||ma?(ma=this.QLf(),this.uha=Ua?ig.pUh:
ig.oUh,this.Se.lo(this.Xe,this.uha),ma?this.Se.Ys(this.uha):this.wKb(),this.wJa(ma)):(this.uha=ig.gqa,this.Se.lo(this.Xe,this.uha),this.Se.Ys(this.uha))}else this.Se.lo(this.Xe,ig.gqa),this.Se.Ys(ig.gqa);this.bL(D);return!0}wKb(){this.uha&&(this.Se.Fl(this.uha),this.uha=null)}jma(D){D=void 0===D?!1:D;this.Se.lo(this.Xe,this.pl);if(this.Gm){const ma=this.q6()||this.bja(),Ua=this.RLf();ma&&!Ua?this.Se.Fl(this.pl):this.Se.Ys(this.pl);ma&&this.wJa(Ua)}else this.Se.Ys(this.pl);this.bL(D)}$sh(D,ma,Ua,Xb,
yc,Tc,Sc,Gd,De){ma?(ma=Sc,yc=Xb.y+yc.y-Tc.y-Gd,Sc=Tc.width-De-ma,Xb=Xb.height,D=D.y-Tc.y-yc):(ma=Ua?Xb.x-yc.right+Tc.right+Gd:Xb.x+yc.left-Tc.left-Gd,yc=Sc,Sc=Xb.width,Xb=Tc.height-De-yc,D=Ua?Tc.width-(D.x-Tc.left)-ma:D.x-Tc.left-ma);return{hbb:new Ji.a(ma,yc,Sc,Xb),ulc:D}}ath(D,ma,Ua,Xb,yc,Tc){ma?(ma=Xb.x,D=D.y-Tc.y-yc):(ma=Ua?Tc.width-(D.x-Tc.left)-yc:D.x-Tc.left-yc,D=Xb.y);return new Sys.UI.Point(ma*(Ua?-1:1),D)}Kwg(D){var ma=this.gridView.xn,Ua=ma.getBoundingClientRect(),Xb=this.gridView.Je.Jpc(D),
yc=this.gridView.Je.ksf(Xb)||this.gridView.wi(1);Xb=yc.domElement;const Tc=Xb.getBoundingClientRect();yc=this.Se.jTa(this.sourceRange,yc.paneType,!1);const Sc=this.q6(),{hbb:Gd,ulc:De}=this.$sh(D,Sc,this.gridView.rtl,yc,Tc,Ua,(Sc?this.gridView.Hda:this.gridView.UZ).qyd(),Sc?Xb.scrollTop:Xb.scrollLeft,Ci.a.vz/this.zoomManager.zoom);this.hbb=Gd;this.ulc=De;ig.Faa||(ig.Faa=document.createElement("div"),ig.Faa.id=`${this.gridView.$.Af}rowColDragShadow`,ig.Faa.className=Xf.c5h,xf.DOMElementExtensions.setVisible(ig.Faa,
!1),ma.appendChild(ig.Faa));ma=new zi.a(ig.Faa.style);Ua=ma.wA;Ua.height=`${this.hbb.height}px`;Ua.width=`${this.hbb.width}px`;this.Vob(D,ma)}xKb(){ig.Faa&&xf.DOMElementExtensions.setVisible(ig.Faa,!1)}Vob(D,ma){if(ig.Faa){ma=ma||new zi.a(ig.Faa.style);var Ua=ma.wA,Xb=this.gridView.xn.getBoundingClientRect(),{x:yc,y:Tc}=this.ath(D,this.q6(),this.gridView.rtl,this.hbb,this.ulc,Xb);Ua.transform=`translate(${yc}px, ${Tc}px)`;xf.DOMElementExtensions.dae(ma,ig.Faa,!0);ma.BZ()}}Pe(D){return(D=this.gridView.ya.kv(D))?
new Ki.a(D,this.gridView):null}FYh(){if(this.ha.pa.Fk){const D=this.ha.pa.og;if(null!=D&&1===D.top&&1===D.left&&D.bottom===D.maxRows&&D.right===D.maxColumns)return!0}return!1}snc(){z.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}Z0b(){return!1}Qva(D,ma,Ua,Xb){Xb=void 0===Xb?!1:Xb;var yc=xf.DOMElementExtensions.getBoundingClientRect(ma);let Tc=ma===this.UJ[lh.epd]||ma===this.UJ[lh.h9e];var Sc=ma===this.UJ[lh.i9e]||
ma===this.UJ[lh.dpd];this.isRow&&Sc||this.Ei&&Tc?Sc="100px":(Tc=this.isRow||Tc,Sc=this.Gm?Tc?(Xb?ig.zwk:ig.Ewk)+"px":(Xb?ig.wwk:ig.Awk)+"px":(Tc?Xb?ig.ywk:ig.Dwk:Xb?ig.xwk:ig.Bwk)+"px");ma=Tc?ma===this.UJ[lh.epd]?"top":"bottom":ma===this.UJ[lh.dpd]?"right":"left";D=100*(Tc?D.x-yc.x:D.y-yc.y)/(Tc?yc.width:yc.height);for(yc=1;4>=yc;yc++){var Gd=document.createElement("div"),De=document.createElement("div");const ve=document.createElement("div");Gd.appendChild(De);Gd.appendChild(ve);Xb&&(De=document.createElement("div"),
Gd.appendChild(De),ve.style.fontWeight="bold");Gd.className=this.Gm?Xf.d5h:Xf.m5h;this.Ku[yc.toString()]=Gd;this.Se.KM(Ua,yc).di.appendChild(Gd);if(Gd=this.Ku[yc.toString()])Gd.style[ma]=Sc,Gd.style[Tc?"left":"top"]=D+"%"}}zLg(D,ma,Ua){const Xb=ua.h(this.$),yc=Xb.Oj(D);var Tc=Xb.wi(this.paneType);Ua=yi.a.YB(Tc.view.vm,this.domElement.parentNode,Ua,Xb.rtl);Tc=!1;let Sc=2;ma&&Ua.y-yc.topLeft.y>yc.height/2?(Tc=!0,Sc=1):!ma&&Ua.x-yc.topLeft.x>yc.width/2&&(Tc=!0);if(Tc){ma=Xb.Ln("DragSelectionClickBehavior.updateMouseSelectionRange",
Xb.dW,Sc);try{ma.fA(D),ma.$$mn(),ma.$$cu()}finally{ma&&ma.dispose()}}}jCb(D){this.Se.Fl(this.pl);this.AV(this.BYa,this.DYa,void 0,D)}RZ(D){this.Gm?this.wKb():this.Se.Fl(ig.gqa);this.AV(this.rn,this.Yk,void 0,D)}Yx(){return ig.gqa}Ffb(D){return D.Ga.keyCode===wi.a.o3a||za.a.isMac&&D.Ga.keyCode===wi.a.d2b}DLb(D){D=ua.h(this.$).getRangeInformation(D);for(let ma=0,Ua=D.length;ma<Ua;++ma)if(Object(Yd.a)(af.PivotTableRange,D[ma]))return D=Cb.a.Fg(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Vf.a(this.$).kx([D]),
!0;return!1}aLe(){this.OHd||(this.ha.lNe(this.RWd),this.OHd=!0)}u_a(){this.ha&&(this.ha.clg(this.RWd),this.OHd=!1)}q6(){return 1===this.VZ}bja(){return 2===this.VZ}}ig.Bwk=-85;ig.Dwk=-40;ig.xwk=-120;ig.ywk=-50;ig.Awk=-95;ig.Ewk=-50;ig.wwk=-130;ig.zwk=-60;ig.gqa=[48];ig.pUh=[66,68];ig.oUh=[67,69];ig.Hgg=[58,60];ig.Ggg=[59,61];ig.Wkc=[[],[],[],[],[],[]];ig.oPj=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8196440_ReduceDragAreaIfAutoFilter");Object(w.a)(ig,"DragSelectionClickBehavior",lh,[]);class ch{constructor(D,
ma){this.destinationRange=this.sourceRange=null;this.sourceRange=D;this.destinationRange=ma}}Object(w.a)(ch,"MacroRecorderTableRowColumnRearrangedPayload",null,[124]);class Li extends ig{constructor(D,ma,Ua,Xb,yc,Tc){super(D,ma,Ua,Xb,yc,Tc);this.Qla=null;this.dA=this.RP=!1;this.GMd=0;this.e1a=this.VRa=null;this.sM=0;this.tlc=ad.a.instance.ia(2269);this.m9e=ad.a.instance.ia(2270);this.sNc=ad.a.instance.ia(2271);this.qxg=ad.a.instance.ia(2272);this.G2f=(Sc,Gd)=>{this.EId=!0;this.onPointerDown(Gd)};
this.onKeyDown=Sc=>this.Ffb(Sc)||Sc.Ga.keyCode===wi.a.p3a?(this.VVa||(lf.KeyInputManager.instance.va(Oe.a.mh,this.domElement.ownerDocument.body,this.onKeyUp),this.VVa=!0),!this.x0&&this.Ffb(Sc)&&(ua.h(this.$).Dk.iw(lh.n1e),this.x0=!0,this.Gm&&this.jTc()),this.US||Sc.Ga.keyCode!==wi.a.p3a||(ua.h(this.$).Dk.iw(lh.pFb),this.US=!0,2===this.sM?(z.ULS.shipAssertTag(509159443,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150300,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.RZ(!1),this.VZ=0,this.pl=this.dA?[11]:[12],this.RP=this.dA,this.u2d(),z.ULS.shipAssertTag(509159442,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.jma()):3===this.sM?(z.ULS.shipAssertTag(509159441,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150299,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.iCb(!1),this.VZ=this.isRow?1:2,this.Sua(),z.ULS.shipAssertTag(509159440,
0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.L2()):1===this.sM&&(z.ULS.shipAssertTag(509159439,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150298,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.jCb(!1),this.Sua(),z.ULS.shipAssertTag(509159438,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.L2())),!0):!1;this.onKeyUp=
Sc=>this.Ffb(Sc)||Sc.Ga.keyCode===wi.a.p3a?(this.GMd=this.Ffb(Sc)?0:1,this.gridView.VS&&ua.h(this.$).Dk.iw(lh.pFb),Sc.Ga.keyCode===wi.a.p3a&&(2===this.sM?(z.ULS.shipAssertTag(509159437,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150297,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.iCb(!1),this.VZ=0,this.Sua(!0),z.ULS.shipAssertTag(509159436,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.L2(!0)):3===this.sM?(z.ULS.shipAssertTag(509159435,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150296,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!1),this.VZ=this.isRow?1:2,this.pl=this.Gm?this.isRow?ig.Hgg:ig.Ggg:this.isRow?[11]:[12],this.u2d(!0),z.ULS.shipAssertTag(509159434,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.jma(!0)):1===this.sM&&
(z.ULS.shipAssertTag(509159433,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150295,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!1),this.pl=this.dA?[11]:[12],this.LVb(!0),z.ULS.shipAssertTag(509159432,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.jma(!0))),this.m1b(this.GMd),this.Gm&&0===this.GMd&&this.jTc(),!0):!1;this.DYa=Sc=>{Sc=this.zoomManager.Sh(Sc);
this.u_a();5===this.Ks?this.s5f(Sc):(this.gridView.VS=!1,z.ULS.shipAssertTag(509159430,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Se.Fl(this.pl),this.Gm&&(this.wJa(!1),this.xKb()),!this.$.Zu([this.Xe],!1)||this.dOj()||this.wJd()||(this.ha.sourceRange=this.sourceRange.clone(),this.fJj(),this.dA?this.Xe.top>this.sourceRange.top&&(Sc=this.Xe.height,this.Xe.top-=Sc,this.Xe.bottom-=Sc):this.Xe.left>this.sourceRange.left&&(Sc=this.Xe.width,this.Xe.left-=Sc,
this.Xe.right-=Sc),this.q2()));z.ULS.sendTraceTag(509150292,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.AV(this.BYa,this.DYa);this.tableRange=null;this.Ks=-1;this.Qla=null;this.sM=0;return!0};this.WSb=()=>{this.gridView.VS=!1;this.u_a();this.sM=0;z.ULS.shipAssertTag(509159429,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.Se.Fl(this.pl);this.Gm&&(this.wJa(!1),this.xKb());if(!this.$.Zu([this.Xe],!1))return z.ULS.sendTraceTag(509150291,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.AV(this.VSb,this.WSb),this.Ks=-1,this.uCb(),!0;if(!(this.ha.pa.og.equals(this.Xe)||this.DLb(this.Xe)||this.DLb(this.sourceRange)||this.wJd())){this.q2();this.ha.sourceRange=this.sourceRange.clone();var Sc=this.ha.sourceRange;const Gd=this.ha.pa.og;this.Wv?this.$.Lf(-694765314,2,30,{[id.a.lCa]:this.x0,[id.a.qlc]:!0,[id.a.slc]:this.RP,[id.a.Eaa]:Sc,[id.a.Daa]:Gd,[id.a.URa]:this.US,[id.a.plc]:this.EId}):this.$.Lf(-694765314,
2,30,{[id.a.lCa]:this.x0,[id.a.qlc]:!0,[id.a.slc]:this.RP,[id.a.Eaa]:Sc,[id.a.Daa]:Gd,[id.a.URa]:this.US});this.x0||(this.Xe.top>this.sourceRange.top&&(this.isRow||this.Xe.left===this.sourceRange.left&&this.RP)?(Sc=this.Xe.height,this.Xe.top-=Sc,this.Xe.bottom-=Sc):this.Xe.left>this.sourceRange.left&&(this.Ei||this.Xe.top===this.sourceRange.top&&!this.RP)&&(Sc=this.Xe.width,this.Xe.left-=Sc,this.Xe.right-=Sc),this.q2())}z.ULS.sendTraceTag(509150290,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");
this.AV(this.VSb,this.WSb);this.Qla=this.tableRange=null;this.Ks=-1;this.RP=!1;this.uCb();return!0};this.BYa=Sc=>{Sc=this.zoomManager.Sh(Sc);var Gd=Sc.clientPoint;this.w1=Sc;const De=this.Wv?this.ha.h4(Gd,Sc.rf,5,!0):this.ha.Mt(Gd,Sc.rf,5,void 0,void 0,!0);this.Gm&&(this.q6()||this.bja())&&this.Vob(Sc.clientPoint);if(De){if(this.tableRange.contains(De.topLeft)){if(this.zLg(De,this.dA,Gd),this.Xe=this.jQa(De),this.ha.sourceRange=this.Xe,this.Se.lo(this.Xe,this.pl),z.ULS.shipAssertTag(509159428,0,!!this.pl,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Se.Ys(this.pl),z.ULS.shipAssertTag(509159427,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.Gm?this.wKb():this.Se.Fl(ig.gqa),6!==this.Ks){for(Sc=1;4>=Sc;Sc++)if(Gd=this.Ku[Sc.toString()])Gd.parentNode.removeChild(Gd),this.Se.KM(this.dA?11:12,Sc).di.appendChild(Gd);this.Ks=6}}else this.Xe=this.FBb(De),this.axf(!1);this.bL()}return!0};this.VSb=Sc=>{Sc=this.zoomManager.Sh(Sc);var Gd=
Sc.clientPoint;this.w1=Sc;var De=this.Wv?this.ha.h4(Gd,Sc.rf,5,!0):this.ha.Mt(Gd,Sc.rf,5,void 0,void 0,!0);this.Gm&&(this.q6()||this.bja())&&this.Vob(Sc.clientPoint);if(De){if(this.Hyf(De))return this.Xe=this.FBb(De),this.$wf(!1),!0;var ve=ua.h(this.$),Xe=ve.Oj(De),nf=ve.wi(this.paneType);Gd=yi.a.YB(nf.view.vm,this.domElement.parentNode,Gd,ve.rtl);nf=!1;let uf=2;this.RP=!1;if(this.isRow||this.Ei){this.isRow&&Gd.y-Xe.topLeft.y>Xe.height/2?(nf=!0,uf=1):this.Ei&&Gd.x-Xe.topLeft.x>Xe.width/2&&(nf=!0);
if(nf){Sc=ve.Ln("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ve.dW,uf);try{Sc.fA(De),Sc.$$mn(),De=Sc.$$cu().range}finally{Sc&&Sc.dispose()}}this.Xe=this.FBb(De)}else{Gd.x-Xe.topLeft.x===Xe.width?(this.RP=!1,nf=!0):Gd.y-Xe.topLeft.y>Xe.height/2&&(this.RP=nf=!0,uf=1);this.Qla&&(this.RP=this.dA);if(nf){ve=ve.Ln("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ve.dW,uf);try{ve.fA(De),ve.$$mn(),De=ve.$$cu().range}finally{ve&&ve.dispose()}}z.ULS.shipAssertTag(509159424,
0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.Se.Fl(this.pl);this.pl=this.RP?[11]:[12];for(ve=1;4>=ve;ve++)(Xe=this.Ku[ve.toString()])&&Xe.parentNode.removeChild(Xe),this.Ku[ve.toString()]=null;this.Qva(Sc.clientPoint,Sc.rf,this.RP?11:12);this.Xe=this.jQa(De)}this.ha.sourceRange=this.Xe;z.ULS.shipAssertTag(509159395,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.Gm?this.jma():(this.Se.lo(this.Xe,this.pl),this.Se.Ys(this.pl));
z.ULS.shipAssertTag(509159394,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.Gm?this.wKb():this.Se.Fl(ig.gqa);if(6!==this.Ks){for(De=1;4>=De;De++)if(Sc=this.Ku[De.toString()])ve=this.Gm?this.isRow?58:this.Ei?59:this.RP?11:12:this.isRow||this.RP?11:12,Sc.parentNode.removeChild(Sc),this.Se.KM(ve,De).di.appendChild(Sc);this.Ks=6}this.Gm||this.bL()}return!0};this.RWd=()=>{this.gridView.VS&&5<=this.Ks&&(this.tableRange?this.US?(z.ULS.shipAssertTag(509159381,
0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150281,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!0)):(z.ULS.shipAssertTag(509159380,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150280,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.jCb(!0)):this.US?this.isRow||this.Ei?(z.ULS.shipAssertTag(509159385,
0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150285,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!0)):(z.ULS.shipAssertTag(509159384,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150284,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.iCb(!0)):this.isRow||this.Ei?(z.ULS.shipAssertTag(509159383,0,!!this.pl,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150283,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.iCb(!0)):(z.ULS.shipAssertTag(509159382,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150282,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!0)));this.x0&&this.m1b();this.US&&this.m1b(1);this.sM=0;this.Ks=-1;this.u_a()};
this.tableRange=null;this.VVa=this.x0=this.US=!1;this.uCb();this.Wv&&1===this.paneType&&this.gridView.bfh(this.G2f)}dispose(){this.x0&&this.m1b();this.US&&this.m1b(1);this.Wv&&1===this.paneType&&this.gridView.$Vj(this.G2f);super.dispose()}uWd(D){this.w1=D;this.Qla=null;this.dA=this.isRow=this.Ei=this.RP=!1;lf.KeyInputManager.instance.va(Oe.a.Hf,this.domElement.ownerDocument.body,this.onKeyDown);this.aLe();this.gridView.VS=!0;(this.tableRange=this.Fth(this.Ug.nu(this.sourceRange.topLeft)))&&!this.tableRange.equals(this.sourceRange)?
(this.Qla=this.tableRange,this.sM=1,this.pl=(this.dA=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Ks=6,z.ULS.sendTraceTag(509150305,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.L1(this.BYa,this.DYa),this.VRa=this.tlc,this.e1a=this.sNc,this.Qva(D.clientPoint,D.rf,this.dA?11:12,!0),z.ULS.shipAssertTag(509159447,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.jma(!0)):
(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.Ei=this.sourceRange.Ei,this.isRow||this.Ei?(this.sM=3,this.VZ=this.isRow?1:2,this.Ks=6,this.pl=this.Gm?this.isRow?ig.Hgg:ig.Ggg:this.isRow?[11]:[12],z.ULS.sendTraceTag(509150303,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.L1(this.VSb,this.WSb),this.VRa=this.tlc,this.e1a=this.sNc,this.Qva(D.clientPoint,D.rf,this.isRow?this.Gm?58:11:this.Gm?59:12,!0),this.Gm&&this.Kwg(D.clientPoint),z.ULS.shipAssertTag(509159446,
0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.jma(!0)):(this.sM=2,this.VZ=0,z.ULS.sendTraceTag(509150302,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.L1(this.rn,this.Yk),this.VRa=this.m9e,this.e1a=this.qxg,this.Qva(D.clientPoint,D.rf,48,!0),z.ULS.shipAssertTag(509159445,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.L2(!0)))}CYa(){this.gridView.VS=!1;this.u_a();this.sM=0;
z.ULS.shipAssertTag(509159431,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.Gm?(this.Se.Fl(this.uha),this.wJa(!1),this.xKb()):this.Se.Fl(ig.gqa);if(!this.$.Zu([this.Xe],!1))return z.ULS.sendTraceTag(509150294,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.uCb(),this.AV(this.rn,this.Yk),this.Ks=-1,!0;if(this.ha.pa.og.equals(this.Xe)||this.DLb(this.Xe)||this.DLb(this.sourceRange))this.Ks=-1;else{this.q2();this.ha.sourceRange=
this.sourceRange.clone();const D=this.ha.sourceRange,ma=this.ha.pa.og;this.Wv?this.$.Lf(-694765314,2,30,{[id.a.lCa]:this.x0,[id.a.Eaa]:D,[id.a.Daa]:ma,[id.a.URa]:this.US,[id.a.plc]:this.EId}):this.$.Lf(-694765314,2,30,{[id.a.lCa]:this.x0,[id.a.Eaa]:D,[id.a.Daa]:ma,[id.a.URa]:this.US})}z.ULS.sendTraceTag(509150293,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.AV(this.rn,this.Yk);this.uCb();return!0}vWd(D){const ma=this.Wv?this.ha.h4(D.clientPoint,D.rf,5,!0):this.ha.Mt(D.clientPoint,
D.rf,5,void 0,void 0,!0);this.w1=D;this.Gm&&(this.q6()||this.bja())&&this.Vob(D.clientPoint);return this.Hyf(ma)?(this.Xe=this.jQa(ma),this.$wf(!0),!0):this.aHi(ma)?(this.Xe=this.FBb(ma),this.axf(!0),!0):!1}bL(D){D=void 0===D?!1:D;const ma=this.Xe.toString();for(let Ua=1;4>=Ua;Ua++){const Xb=this.Ku[Ua.toString()];Xb&&Xb.childNodes&&0<Xb.childNodes.length&&(Xb.childNodes[0].innerText=ma,Xb.childNodes[1].innerText=this.VRa,D&&(Xb.childNodes[2].innerText=this.e1a))}}Hyf(D){return!!this.Qla&&1!==this.sM&&
!!D&&this.Qla.contains(D.topLeft)}aHi(D){return!!this.Qla&&1===this.sM&&!!D&&!this.Qla.contains(D.topLeft)}$wf(D){this.tableRange=this.Qla;this.sM=1;const ma=!this.US;D?(z.ULS.shipAssertTag(509159393,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),z.ULS.sendTraceTag(509150289,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!1),this.pl=this.dA?[11]:[12],this.LVb(ma),z.ULS.shipAssertTag(509159392,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.jma(ma)):(z.ULS.shipAssertTag(509159391,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150288,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.iCb(!1),this.Sua(ma),z.ULS.shipAssertTag(509159390,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.L2(ma))}axf(D){this.tableRange=null;this.sM=2;const ma=!this.US;D?(z.ULS.shipAssertTag(509159389,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
z.ULS.sendTraceTag(509150287,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.RZ(!1),this.pl=this.dA?[11]:[12],this.RP=this.dA,this.u2d(ma),z.ULS.shipAssertTag(509159388,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.jma(ma)):(z.ULS.shipAssertTag(509159387,0,!!this.pl,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),z.ULS.sendTraceTag(509150286,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.jCb(!1),this.Sua(ma),z.ULS.shipAssertTag(509159386,0,!!this.Yx(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.L2(ma))}UNc(){if(!ua.h(this.$).ha.pa.Fk)return z.ULS.sendTraceTag(507875651,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;const D=ua.h(this.$).getRangeInformation(this.ha.pa.og);for(const ma of D)if(Object(Yd.a)(af.PivotTableRange,ma))return z.ULS.sendTraceTag(507875650,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because intersecting a pivot table"),!1;return!0}Fth(D){if(D&&D.contains(this.sourceRange)&&!D.equals(this.sourceRange)){if(D.Sra&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===D.top){const ma=new xb.Range(this.sourceRange.top,this.sourceRange.left,D.bottom,this.sourceRange.right,!1,!1);if(!ma.equals(D))return this.sourceRange=ma,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,
0),D}this.dA=D.left===this.sourceRange.left&&D.right===this.sourceRange.right;if(D.top===this.sourceRange.top&&D.bottom===this.sourceRange.bottom||this.dA)return D}return null}jQa(D){const ma=D.clone();this.dA?ma.left=Math.max(D.left-this.YDd,1):ma.top=Math.max(D.top-this.Vke,1);ma.right=ma.left+this.sourceRange.width-1;ma.bottom=ma.top+this.sourceRange.height-1;return this.Bzb(ma)}wJd(){const D=this.Xe.topLeft.Zf(this.sourceRange);return!D&&(this.tableRange||this.Gm&&(this.isRow||this.Ei))?this.dA||
this.Gm&&this.isRow?this.Xe.top===this.sourceRange.bottom+1:this.Xe.left===this.sourceRange.right+1:D}dOj(){if(this.dA&&this.Xe.left!==this.tableRange.left||!this.dA&&this.Xe.top!==this.tableRange.top){const D=Cb.a.Fg(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Vf.a(this.$).kx([D]);return!0}return!1}fJj(){const D=this.$.Ve.Sf("UserAction","RearrangeRowColumnClientSide"),ma={["CopyPasteTargetType"]:1,["OperationId"]:ta.a.create().toString(),["Stopwatch"]:D,["DragDropIsShiftKeyDown"]:this.US,["EncounteredDeploymentErrors"]:!1},
Ua=this.x0?2:1,Xb=this.$.ja.Qa(254);(new Promise((yc,Tc)=>{this.c7h(Sc=>{Sc.Errors&&0<Sc.Errors.length?Tc(new Pc(22,Sc.Errors)):yc(!0)},Sc=>{Sc=Qc.a.Lh(Sc.data);Tc(new Pc(22,Sc))})})).then(()=>{z.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Xb&&Xb.faj(ma,Ua,this.sourceRange,this.Xe);return Promise.resolve(!0)},yc=>{z.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${yc?
copyPasteInfra.getStringifiedError(yc):"null"}, copyPasteTargetType="${1}"`);return Xb?Xb.hwj(yc,ma,Ua,this.sourceRange,this.Xe):Promise.reject(yc)})}c7h(D,ma){D=void 0===D?null:D;ma=void 0===ma?null:ma;const Ua={};this.dA?(Ua.FirstRow=this.Xe.top-1,Ua.FirstColumn=0,Ua.DeltaColumn=0,Ua.DeltaRow=this.Xe.bottom-this.Xe.top+1):(Ua.FirstRow=0,Ua.FirstColumn=this.Xe.left-1,Ua.DeltaColumn=this.Xe.right-this.Xe.left+1,Ua.DeltaRow=0);Ua.LastRow=pd.a.rB;Ua.LastColumn=pd.a.eA;Ua.SheetName=this.$.sa.na?this.$.sa.na.name:
this.$.nf.getItemByName(this.$.nf.na.name).sheetName;const Xb=Va.v(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new eb.a(514,0,(yc,Tc,Sc)=>{var Gd=this.$.oa.ua;yc=D?Vc.b(yc,D):yc;Tc=ma?Vc.a(Tc,ma):Tc;const De=Gd.Oa(41,null);De.sourceRange=Xb;De.destinationRange=Ua;return Ed.h(Gd,"RearrangeRowColumn",De,yc,Tc,Sc,null,0)},64,()=>new ch(Xb,Ua)),null)}m1b(D){D=void 0===D?0:D;0===D?this.x0=!1:1===D&&(this.US=!1);this.x0||this.US||(lf.KeyInputManager.instance.Da(Oe.a.mh,this.domElement.ownerDocument.body,
this.onKeyUp),this.VVa=!1)}Sua(D){D=void 0===D?!1:D;this.Ks=5;z.ULS.sendTraceTag(509150277,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.L1(this.rn,this.Yk);this.VRa=this.m9e;this.e1a=this.qxg;this.Qva(this.w1.clientPoint,this.w1.rf,this.Gm&&this.isRow?66:this.Gm&&this.Ei?67:48,D)}u2d(D){D=void 0===D?!1:D;this.Ks=6;z.ULS.sendTraceTag(509150276,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");let ma;ma=this.Gm?this.isRow?58:this.Ei?
59:this.dA?11:12:this.isRow||this.dA?11:12;this.L1(this.VSb,this.WSb);this.VRa=this.tlc;this.e1a=this.sNc;this.Qva(this.w1.clientPoint,this.w1.rf,ma,D)}LVb(D){D=void 0===D?!1:D;this.Ks=6;z.ULS.sendTraceTag(509150275,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.L1(this.BYa,this.DYa);this.VRa=this.tlc;this.e1a=this.sNc;this.Qva(this.w1.clientPoint,this.w1.rf,this.dA?11:12,D)}iCb(D){this.Se.Fl(this.pl);this.AV(this.VSb,this.WSb,void 0,D)}uCb(){this.EId=!1}QLf(){return!this.Xe.equals(this.sourceRange)}RLf(){return!this.wJd()}NHd(){return this.x0}}
Object(w.a)(Li,"DragSelectionClickBehaviorCellRangeAndTable",ig,[]);var Vi=a(402);class Si extends ig{constructor(D,ma,Ua,Xb,yc,Tc){super(D,ma,Ua,Xb,yc,Tc);this.RWd=()=>{this.gridView.VS&&(z.ULS.shipAssertTag(509159371,0,!!this.pl,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),z.ULS.sendTraceTag(509150340,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.jCb(!0));5===this.Ks&&(z.ULS.shipAssertTag(509159370,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
z.ULS.sendTraceTag(509150339,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.RZ(!0));this.u_a()};this.DYa=Sc=>{this.zoomManager.Sh(Sc);this.gridView.VS=!1;this.u_a();z.ULS.shipAssertTag(509159369,0,!!this.pl,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.Se.Fl(this.pl);this.Gm&&(this.wJa(!1),this.xKb());this.ha.sourceRange=this.sourceRange.clone();this.BKf?this.$.Lf(927125067,ob.a.Ke,30,null):this.ysa?(this.q2(),this.ha.sourceRange=this.sourceRange.clone(),
this.$.Lf(-694765314,2,30,{[id.a.lCa]:!0,[id.a.Eaa]:this.ha.sourceRange,[id.a.Daa]:this.ha.pa.og,[id.a.URa]:!1}),z.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),ua.h(this.$).Dk.iw(id.a.S5),this.ysa=!1):this.ZIj();z.ULS.sendTraceTag(509150338,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.AV(this.BYa,this.DYa);this.Ks=-1;return!0};this.BYa=Sc=>{Sc=this.zoomManager.Sh(Sc);const Gd=Sc.clientPoint;this.w1=
Sc;const De=this.Wv?this.ha.h4(Gd,Sc.rf,5,!0):this.ha.Mt(Gd,Sc.rf,5,void 0,void 0,!0);this.Gm&&(this.q6()||this.bja())&&this.Vob(Sc.clientPoint);if(De){if(!this.fKd(De))return this.VDi(Sc),!0;this.zLg(De,this.isRow,Gd);if(this.isRow||this.Ei)this.Xe=this.jQa(De);this.ha.sourceRange=this.Xe;this.Se.lo(this.Xe,this.pl);z.ULS.shipAssertTag(509159368,0,!!this.pl,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.Se.Ys(this.pl);z.ULS.shipAssertTag(509159367,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null");
this.Gm?this.wKb():this.Se.Fl(ig.gqa);this.bL()}return!0};this.onKeyDown=Sc=>this.Ffb(Sc)?(this.VVa||(lf.KeyInputManager.instance.va(Oe.a.mh,this.domElement.ownerDocument.body,this.onKeyUp),this.VVa=!0),this.ysa||(ua.h(this.$).Dk.iw(lh.n1e),this.ysa=!0,this.Gm&&this.jTc()),!0):!1;this.onKeyUp=Sc=>{this.Ffb(Sc)&&(lf.KeyInputManager.instance.Da(Oe.a.mh,this.domElement.ownerDocument.body,this.onKeyUp),this.VVa=!1,this.gridView.VS?ua.h(this.$).Dk.iw(lh.pFb):ua.h(this.$).Dk.iw(id.a.S5),this.ysa=!1,this.Gm&&
this.jTc());return!0};this.s4f=Sc=>{Sc.Errors&&0<Sc.Errors.length?(z.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${Cb.a.xf(Sc.Errors)}]`),this.Xe.left=this.sourceRange.left,this.Xe.right=this.sourceRange.right,this.Xe.top=this.sourceRange.top,this.Xe.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Xe.top&&this.sourceRange.bottom>=this.Xe.top-1?(this.Xe.top=this.sourceRange.top,this.Xe.bottom=this.sourceRange.bottom):
(this.sourceRange.top>this.Xe.top||(this.Xe.top-=this.sourceRange.height),this.Xe.bottom=this.Xe.top+this.sourceRange.height-1):this.sourceRange.left<=this.Xe.left&&this.sourceRange.right>=this.Xe.left-1?(this.Xe.left=this.sourceRange.left,this.Xe.right=this.sourceRange.right):(this.sourceRange.left>this.Xe.left||(this.Xe.left-=this.sourceRange.width),this.Xe.right=this.Xe.left+this.sourceRange.width-1);this.q2();this.Ks=-1};this.r4f=Sc=>{Sc=Qc.a.Lh(Sc.data);z.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${Cb.a.xf(Sc)}]`)};
this.ysa=this.VVa=!1}dispose(){super.dispose()}uWd(D){this.w1=D;this.isRow=this.Ei=!1;this.aLe();this.VZ=null!=this.Xe?this.Xe.isRow?1:this.Xe.Ei?2:0:0;this.gridView.VS=!0;lf.KeyInputManager.instance.va(Oe.a.Hf,this.domElement.ownerDocument.body,this.onKeyDown);this.lf=this.Ug.tra(this.sourceRange);this.gFf=this.L_i(this.Xe);this.lf||z.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.BKf=(new ke.a(this.$.sa)).Vk;
ua.h(this.$).Dk.iw(lh.pFb);this.fKd(this.Xe)?(this.isRow=this.C0i(),this.Ei=this.iUi(),this.isRow||this.Ei?(this.rgb=!1,this.LVb(D),this.Xe=this.jQa(this.Xe),z.ULS.shipAssertTag(509159377,0,!!this.pl,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),this.jma()):(this.rgb=!0,this.Sua(D),z.ULS.shipAssertTag(509159376,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.L2())):(this.rgb=!0,this.Sua(D),this.Gm&&(this.q6()||this.bja())&&this.Kwg(D.clientPoint),
z.ULS.shipAssertTag(509159375,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.L2())}CYa(){this.gridView.VS=!1;this.u_a();this.Gm&&(this.wJa(!1),this.xKb());return this.BKf?(this.$.Lf(927125067,ob.a.Ke,30,null),z.ULS.shipAssertTag(509159374,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),z.ULS.sendTraceTag(509150343,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.RZ(!0),this.rgb=!1,this.Ks=
-1,!0):this.ysa||this.gFf?(this.q2(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Lf(-694765314,2,30,{[id.a.lCa]:this.ysa,[id.a.Eaa]:this.ha.sourceRange,[id.a.Daa]:this.ha.pa.og,[id.a.URa]:!1}),z.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.ysa}"`),ua.h(this.$).Dk.iw(id.a.S5),z.ULS.shipAssertTag(509159373,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),z.ULS.sendTraceTag(509150342,
0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.RZ(!0),this.rgb=!1,this.Ks=-1,this.gFf=!1,!0):5===this.Ks?(z.ULS.shipAssertTag(509159372,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),z.ULS.sendTraceTag(509150341,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.RZ(!0),this.rgb=!1,this.ikk(),this.Ks=-1,!0):!1}vWd(D){const ma=this.Wv?this.ha.h4(D.clientPoint,D.rf,5,!0):this.ha.Mt(D.clientPoint,D.rf,
5,void 0,void 0,!0);this.w1=D;this.Gm&&(this.q6()||this.bja())&&this.Vob(D.clientPoint);return this.rgb?!1:this.fKd(ma)?(this.WDi(D),!0):!1}bL(){const D=new xb.Range(this.Xe.top,this.Xe.left,this.Xe.bottom,this.Xe.right,!1,!0);6===this.Ks&&(this.isRow?(--D.top,D.bottom=D.top+this.Xe.height-1):(--D.left,D.right=D.left+this.Xe.width-1));for(let ma=1;4>=ma;ma++){const Ua=this.Ku[ma.toString()];Ua&&Ua.childNodes&&0<Ua.childNodes.length&&(Ua.childNodes[0].innerText=D.toString())}}UNc(){if(!ua.h(this.$).ha.pa.Fk)return z.ULS.sendTraceTag(507875653,
0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;var D=ua.h(this.$).getRangeInformation(this.ha.pa.og);for(var ma of D)if(Object(Yd.a)(af.PivotTableRange,ma)&&(D=this.Ug.tra(ma)))return ma=!D.isOlap||!D.bhb(!0),z.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",D),D.isActionable&&ma;return!1}jQa(D){D=D.clone();this.isRow?(D.left=
this.sourceRange.left,D.right=this.lf.right,D.bottom=D.top+this.sourceRange.height-1):this.Ei?(D.top=this.sourceRange.top,D.bottom=this.lf.qA?this.lf.qA.bottom:this.lf.bottom,D.right=D.left+this.sourceRange.width-1):z.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.Bzb(D)}ZIj(){const D={},ma=Va.v(this.sourceRange,this.$);ua.h(this.$).getRangeInformation(this.Xe);if(this.isRow){ma.FirstColumn=D.FirstColumn=this.Xe.left-
1;ma.LastColumn=D.LastColumn=this.Xe.right-1;if(this.sourceRange.top<=this.Xe.top&&this.sourceRange.bottom>=this.Xe.top-1){z.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Xe.top?D.LastRow=D.FirstRow=this.Xe.top-1:(D.FirstRow=this.Xe.top-this.sourceRange.height-1,D.LastRow=D.FirstRow+this.sourceRange.height-1)}else{D.FirstRow=Math.min(this.Xe.top,this.Xe.bottom-1);D.LastRow=this.Xe.bottom-1;if(this.sourceRange.left<=
this.Xe.left&&this.sourceRange.right>=this.Xe.left-1){z.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}D.LastColumn=this.sourceRange.left>this.Xe.left?D.FirstColumn=this.Xe.left-1:D.FirstColumn=this.Xe.left-this.sourceRange.width-1}const Ua={};Ua.SheetName=this.$.sa.na?this.$.sa.na.name:this.$.nf.getItemByName(this.$.nf.na.name).sheetName;Ua.Ranges=Array(2);Ua.Ranges[0]=ma;Ua.Ranges[1]=D;this.Y6h(Ua)}Y6h(D){this.$.userOperationManager.enqueueOperation(new eb.a(265,
0,(ma,Ua,Xb)=>{var yc=this.$.oa.ua;ma=this.s4f?Vc.b(ma,this.s4f):ma;Ua=this.r4f?Vc.a(Ua,this.r4f):Ua;const Tc=yc.Oa(1,null);Tc.moveRange=D;return Ed.h(yc,"MoveLineItems",Tc,ma,Ua,Xb,null,0)},64),null)}fKd(D){return null!==this.lf&&null!==D&&this.xYi(D)&&this.w0i(D)&&this.L2i(D)&&this.iTi(D)}xYi(D){return this.lf.qA?D.left>=this.lf.qA.left:this.lf.Iv?D.left>=this.lf.Iv.left:D.left>=this.lf.left}w0i(D){return this.lf.Iv?D.right<=this.lf.Iv.right:this.lf.qA?D.right<=this.lf.qA.right:D.right<=this.lf.right}L2i(D){return this.isRow?
null!==this.lf.qA&&D.top>=this.lf.qA.top:this.Ei?null!==this.lf.Iv&&D.top>=this.lf.Iv.top:null===this.lf.top||D.top>=this.lf.top}iTi(D){return this.lf.qA?D.bottom<=this.lf.qA.bottom:this.lf.Iv?D.bottom<=this.lf.Iv.bottom:D.bottom<=this.lf.bottom}L_i(D){return null!==this.lf&&this.lf.left>=D.left&&this.lf.right<=D.right&&this.lf.top>=D.top&&this.lf.bottom<=D.bottom}C0i(){return null!==this.lf&&null!==this.lf.qA&&this.lf.qA.top<=this.Xe.top&&this.lf.qA.left<=this.Xe.left&&this.lf.qA.right>=this.Xe.left}iUi(){return null!==
this.lf&&null!==this.lf.Iv&&this.lf.Iv.top===this.Xe.top&&this.lf.Iv.left<=this.Xe.left&&this.lf.Iv.right>=this.Xe.right}LVb(D){this.Ks=6;this.pl=this.isRow?[11]:[12];z.ULS.sendTraceTag(509150337,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.L1(this.BYa,this.DYa);this.Qva(D.clientPoint,D.rf,this.isRow?11:12,!1)}Sua(D){this.Ks=5;z.ULS.sendTraceTag(509150336,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.L1(this.rn,this.Yk);this.Qva(D.clientPoint,
D.rf,this.Gm&&this.q6()?66:this.Gm&&this.bja()?67:48,!1)}WDi(D){z.ULS.shipAssertTag(509159366,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange.handleDragWithinPivotTable: getDragHighlight is null");z.ULS.sendTraceTag(509150307,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.RZ(!1);this.LVb(D);this.Xe=this.jQa(this.Xe);z.ULS.shipAssertTag(509159365,0,!!this.pl,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.jma()}VDi(D){z.ULS.shipAssertTag(509159364,
0,!!this.pl,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");z.ULS.sendTraceTag(509150306,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.jCb(!1);this.Sua(D);z.ULS.shipAssertTag(509159363,0,!!this.Yx(),"DragSelectionClickBehaviorPivotTableRange.handleDragOutsidePivotTable: getDragHighlight is null");this.L2()}ikk(){if((null==this.sourceRange||null==this.Xe||this.sourceRange.Zz(!1)!==this.Xe.Zz(!1))&&!this.DLb(this.Xe)){var D=Cb.a.Fg(1,0,904,
903,0,2069074184,"PivotTableInvalidMove");D.HelpTopicId=Vi.a.sok;D.HelpDescription=ad.a.instance.ia(913);Vf.a(this.$).kx([D])}}QLf(){return!this.Xe.equals(this.sourceRange)}RLf(){return!1}NHd(){return this.ysa}}Object(w.a)(Si,"DragSelectionClickBehaviorPivotTableRange",ig,[]);var Mi=a(397);class Ti extends ei{constructor(D,ma){super(D);this.dk=()=>{this.domElement.classList.remove(Xf.selecting);Mi.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.dx=()=>{this.domElement.classList.add(Xf.selecting)};
this.onPointerDown=Ua=>{2===Ua.Te&&Ua.vs===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.pa.og,Mi.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.ika=()=>{this.gridView.$.Lf(1983983164,2,30,null);return!0};this.Xg=()=>{xf.DOMElementExtensions.setVisible(this.Sha,this.gridView.$.isEditMode)};this.uHa=()=>{xf.DOMElementExtensions.setVisible(this.Sha,!1)};this.tHa=()=>{xf.DOMElementExtensions.setVisible(this.Sha,
!0)};this.x2f=()=>{xf.DOMElementExtensions.setVisible(this.Sha,!1)};this.w2f=()=>{xf.DOMElementExtensions.setVisible(this.Sha,!0)};this.qSb=(Ua,Xb)=>{xf.DOMElementExtensions.setVisible(this.Sha,!Xb.zJe)};this.gridView=ma;ma=document.createElement("div");ma.className=Tb.EwaSettings.uu()?Wg.a.o5h:Wg.a.n5h;this.Sha=ma;this.Xg(null,null);D.appendChild(ma);of.a.instance.va(Oe.a.yg,this.Sha,this.onPointerDown);oi.a.instance.va(Oe.a.fo,this.Sha,this.ika);this.gridView.$.Go(this.Xg);this.gridView.$.Le.jcd(this.uHa);
this.gridView.$.Le.icd(this.tHa);this.gridView.fMe(this.qSb);this.gridView.cellTextEditBox.jr(this.x2f);this.gridView.cellTextEditBox.Wr(this.w2f)}dispose(){of.a.instance.Da(Oe.a.yg,this.Sha,this.onPointerDown);oi.a.instance.Da(Oe.a.fo,this.Sha,this.ika);this.gridView.$&&(this.gridView.ha.ela(this.dx),this.gridView.ha.zda(this.dk),this.gridView.$.Hp(this.Xg),this.gridView.$.Le.C4d(this.uHa),this.gridView.$.Le.B4d(this.tHa),this.gridView.nkg(this.qSb),this.gridView.cellTextEditBox.$q(this.x2f),this.gridView.cellTextEditBox.Zq(this.w2f));
super.dispose()}}Object(w.a)(Ti,"FillHandleClickBehavior",ei,[]);class Ni{constructor(D){this.PAf=ma=>{this.ASc(ma.rf,1);return!0};this.QAf=ma=>{this.ASc(ma.rf,-1);return!0};this.dk=()=>{this.RId=!1};this.dx=()=>{this.RId=!0};this.gridView=D;this.Keb=0;this.RId=this.Pwc=!1;this.tca=Number.NaN;this.gridView.ha.xoa(this.dx);this.gridView.ha.woa(this.dk);this.gridView.ha.lNe(this.dk)}dispose(){this.gridView.ha.ela(this.dx);this.gridView.ha.zda(this.dk);this.gridView.ha.clg(this.dk)}aU(){this.Keb=0;this.Pwc=
!1;this.tca=Number.NaN}k9e(D){this.Pwc=!0;this.ASc(D,1)}l9e(D){this.Pwc=!1;this.ASc(D,-1)}ASc(D,ma){if(D)if(D.parentNode)if(this.RId)isNaN(this.tca)||(this.PSc(this.tca,!1),this.tca=Number.NaN);else if(D=parseInt(D.parentNode.getAttribute(id.a.bfb),10),isNaN(D))z.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.tca)&&D!==this.tca){if(this.Pwc)return;this.PSc(this.tca,!1)}if(isNaN(this.tca)||D!==this.tca)this.tca=
D,this.Keb=0;!this.Keb&&0<ma&&this.PSc(D,!0);this.Keb=Math.max(this.Keb+ma,0);!this.Keb&&0>ma&&(this.PSc(D,!1),this.tca=Number.NaN)}else z.ULS.shipAssertTag(537159367,0,!!D.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else z.ULS.shipAssertTag(537159368,0,!!D,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}PSc(D,ma){var Ua=this.gridView.Be.cUc;for(const Xb of Ua)for(Ua=this.gridView.Se.KM(3,Xb,D).di,xf.DOMElementExtensions.toggleCssClass(Ua,Xf.V4h,
ma),Ua=Ua.firstChild;Ua;Ua=Ua.nextSibling)Lc.a.contains(Ua.className,"resizemarqueehandle",!0)&&xf.DOMElementExtensions.toggleCssClass(Ua,Xf.X4h,ma)}}Object(w.a)(Ni,"MarqueeHoveringManager",null,[]);var Oi=a(304),Ai=a(926),Bi=a(1249);class Yh extends mg{constructor(D,ma){super(D);this.Wsc=!1;this.EEc=()=>{if(!this.Tw)return z.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Tw.jMj(this.yia);this.Tw.vXh(this.zia);if(3===this.Tw.model.state)return!0;
this.Tw.nEd(!0);return!0};this.nka=()=>{if(!this.Tw)return!1;this.Tw.Jeg(!1);this.Tw.k6d(this.zia,!1);if(3===this.Tw.model.state)return!0;this.Tw.nEd(!1);return!0};this.onPointerDown=Ua=>this.Tw?2===Ua.Te&&Ua.vs===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.NSb=()=>{if(!this.Tw)return!1;this.Tw.k6d(this.zia,!0);this.Tw.nEd(!1);this.Tw.Vab();return!0};this.onDoubleClick=Ua=>{if(Ua.Ga)return Ua.Ga.stopPropagation(),!0;z.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};this.container=D;this.Tw=Object(R.a)(Bi.a,ma.metadata);this.myg(ma)&&this.UCf(ma.isVisible)}dispose(){this.Yig();this.Tw=null;super.dispose()}m8a(D){this.Tw=Object(R.a)(Bi.a,D.metadata);this.myg(D)?this.UCf(D.isVisible):this.Yig();!Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&D.isVisible!==D.$Fa&&this.Tw&&(this.Tw.mdk(D.isVisible?1:0),xf.DOMElementExtensions.setVisible(this.zia,D.isVisible))}UCf(D){this.Wsc||(this.Wsc=!0,this.zia=document.createElement("div"),
this.zia.id=`${this.container.id}-${id.a.FWe}`,this.zia.className=Ai.a.tvh,this.yia=document.createElement("div"),this.yia.id=`${this.container.id}-${id.a.Zgd}`,this.yia.className=Ai.a.Zgd,this.uW=document.createElement("div"),this.uW.appendChild(this.yia),this.uW.className=Ai.a.svh,this.zia.appendChild(this.uW),this.container.appendChild(this.zia),z.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),
of.a.instance.va(Oe.a.x1,this.uW,this.EEc),of.a.instance.va(Oe.a.pG,this.uW,this.nka),of.a.instance.va(Oe.a.yg,this.uW,this.onPointerDown),Oi.a.instance.va(Oe.a.click,this.uW,this.NSb),Oi.a.instance.va(Oe.a.fo,this.uW,this.onDoubleClick),xf.DOMElementExtensions.setVisible(this.uW,D))}Yig(){this.Wsc&&(this.Wsc=!1,of.a.instance.Da(Oe.a.x1,this.uW,this.EEc),of.a.instance.Da(Oe.a.pG,this.uW,this.nka),of.a.instance.Da(Oe.a.yg,this.uW,this.onPointerDown),Oi.a.instance.Da(Oe.a.click,this.uW,this.NSb),Oi.a.instance.Da(Oe.a.fo,
this.uW,this.onDoubleClick),xf.DOMElementExtensions.Lj(this.yia),this.yia=null,xf.DOMElementExtensions.Lj(this.zia),this.zia=null)}myg(D){D=new Id.a(D.range,D.sheetId);return!!this.Tw&&this.Tw.nvc(D)}}Object(w.a)(Yh,"RangeCatchUpActivityHighlightBehavior",mg,[]);class vi extends xh{constructor(D,ma,Ua,Xb,yc){super(D,ma,Ua,Xb,yc)}get Jba(){return 16}get Hnb(){return this.gridView.ha.rangePicker.Nvd(!1)}k1a(){return(this.gridView.inRangePicker||this.gridView.Fm)&&super.k1a()}}Object(w.a)(vi,"RangePickerTouchGrippiesBehavior",
xh,[]);class ki extends mg{constructor(D,ma,Ua){super(D);const Xb=document.createElement("div"),yc=document.createElement("div");Tb.EwaSettings.Gm()?Ua?(Xb.className=ma?Xf.A5h:Xf.C5h,yc.className=ma?Xf.B5h:Xf.z5h):(Xb.className=ma?Xf.w5h:Xf.y5h,yc.className=ma?Xf.x5h:Xf.v5h):(Xb.className=ma?Xf.E5h:Xf.G5h,yc.className=ma?Xf.F5h:Xf.D5h);D.appendChild(Xb);D.appendChild(yc)}}Object(w.a)(ki,"RearrangeHighlightBehavior",mg,[]);var Pi;(function(D){D[D.topLeft=0]="topLeft";D[D.topRight=1]="topRight";D[D.bottomLeft=
2]="bottomLeft";D[D.bottomRight=3]="bottomRight";D[D.error=4]="error"})(Pi||(Pi={}));Object(w.b)("Corner",Pi);class gi extends mg{constructor(D,ma,Ua,Xb,yc,Tc){super(D);this.eg=this.WK=null;this.qaa=0;this.Xe=this.sourceRange=null;this.V1a=!1;this.onPointerDown=Sc=>{Sc=this.zoomManager.Sh(Sc);if(this.Nxg(Sc)&&!this.V1a){this.hRf();this.eg=this.Xr.gpc();this.WK=this.Xr.Otf(Sc);if(!this.eg||!this.WK||!this.WK.range)return z.ULS.shipAssertTag(537159361,0,!!this.eg,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),
z.ULS.shipAssertTag(537159360,0,!!this.WK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),z.ULS.shipAssertTag(537159331,0,!!this.WK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Xe=this.WK.range.clone();this.sourceRange=this.Xe.clone();this.qaa=this.cpf(Sc);if(4===this.qaa)return z.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Gd=this.qrf(Sc,!0);if(!Gd)return z.ULS.shipAssertTag(537159329,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.m3e(Gd))return z.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.ZUa=!0;this.eg.yJ(!1);this.yK.k9e(Sc.rf);this.Xr.Veg(!0,this.QM.SZ);this.eg.Ja.removeSelection();this.eg.pcc(this.Exf);this.lig();this.V1a=!0;Df.b(this.$,!0)}return!0};this.rn=Sc=>{Sc=this.zoomManager.Sh(Sc);Sc=this.qrf(Sc,!1);if(!Sc)return!0;
Sc=this.m3e(Sc);if(!Sc)return z.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.doc(!0),!1;if(this.Xe.equals(Sc))return!0;this.Xe=Sc;Sc=this.L2();Sc||(z.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.doc(!0));return Sc};this.Yk=Sc=>{this.zoomManager.Sh(Sc);Sc=this.q2();z.ULS.shipAssertTag(537159325,0,Sc,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.doc(!Sc);
return Sc};this.Exf=()=>{this.doc(!0)};this.gridView=ma;this.zoom=Tc;this.$=ma.$;this.DQ=[];this.ha=this.gridView.ha;this.yK=Ua;this.Xr=Xb;this.QM=yc;this.coloredReferencesManager=this.$.ja.Qa(281);z.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.XS=Pd.a.ZF())ma=this.$.ja.Qa(464),z.ULS.shipAssertTag(510255176,0,!!ma,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),
this.Sz=ma.Sz;for(const Sc of this.Qng())ma=this.Xr.w2e(D,Sc,this.KNe(),this.onPointerDown),this.DQ.push(ma);for(const Sc of this.DQ)of.a.instance.va(Oe.a.x1,Sc,this.yK.PAf),of.a.instance.va(Oe.a.pG,Sc,this.yK.QAf);this.m8a(yc)}dispose(){this.DQ.forEach(D=>{of.a.instance.Da(Oe.a.yg,D,this.onPointerDown)});this.DQ.length=0;super.dispose()}get zoomManager(){return Tb.EwaSettings.Pi()?this.zoom.zoomManager:U.a(this.$)}m8a(D){this.QM=D;this.SNe(D);this.Xr.cZb(D,this.DQ,this.Tbe());this.yK.aU()}qrf(D,
ma){const Ua=D.rf;D=D.clientPoint;if(!Ua||!D)return z.ULS.shipAssertTag(537159324,0,!!Ua,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),z.ULS.shipAssertTag(537159323,0,!!D,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ma&&(D=this.CVf(D));ma=this.ha.Mt(D,Ua,0,!0,!1,!0);ma||(D=this.CVf(D),ma=this.ha.Mt(D,Ua,0,!0,!1,!0));return ma}CVf(D){D.y+=0===this.qaa||1===this.qaa?2:-2;D.x+=0===this.qaa||2===this.qaa?2:-2;return D}m3e(D){if(!D||!this.sourceRange)return z.ULS.shipAssertTag(537159322,
0,!!D,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),z.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.qaa)return new xb.Range(D.top,D.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.qaa)return new xb.Range(D.top,this.sourceRange.left,this.sourceRange.bottom,D.right,!0,!1);if(2===this.qaa)return new xb.Range(this.sourceRange.top,D.left,D.bottom,this.sourceRange.right,!0,!1);if(3===
this.qaa)return new xb.Range(this.sourceRange.top,this.sourceRange.left,D.bottom,D.right,!0,!1);z.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Pi[this.qaa]}`);return null}q2(){return this.XS?this.Sz.iRb(this.eg,this.WK,this.Xe):this.coloredReferencesManager.iRb(this.eg,this.WK,this.Xe)}L2(){return this.q2()}doc(D){D&&z.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");
this.yK.l9e(this.DQ[0]);this.Xr.Veg(!1,this.QM.SZ);this.eg.Ja.setCaretPositionToEnd();this.eg.hJc(this.Exf);this.EJg();this.V1a=this.gridView.ZUa=!1;Df.b(this.$,!1);this.Xr.Kgg()}}Object(w.a)(gi,"ResizeMarqueeBehaviorBase",mg,[]);class Qi extends gi{constructor(D,ma,Ua,Xb,yc,Tc){super(D,ma,Ua,Xb,yc,Tc)}Qng(){return[Xf.K5h,Xf.L5h,Xf.I5h,Xf.J5h]}KNe(){return[Xf.H5h]}cpf(D){D=D.rf;if(D===this.DQ[0])return 0;if(D===this.DQ[1])return 1;if(D===this.DQ[2])return 2;if(D===this.DQ[3])return 3;z.ULS.shipAssertTag(537159318,
0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}lig(){this.Xr.L1(this.rn,this.Yk,!0)}EJg(){this.Xr.wie(this.rn,this.Yk,!0)}Nxg(D){return 2===(ob.a.Ke=D.Te)&&D.vs===Sys.UI.MouseButton.leftButton}Tbe(){return!0}hRf(){z.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}SNe(D){for(const ma of this.DQ)ma.style.backgroundColor=D.di.style.borderColor}}Object(w.a)(Qi,"ResizeMarqueeMouseBehavior",
gi,[]);class ph extends gi{constructor(D,ma,Ua,Xb,yc,Tc){super(D,ma,Ua,Xb,yc,Tc);this.HSb=()=>{const Sc=3===ob.a.Ke;this.ZMd&&!Sc?this.Xr.cZb(this.QM,this.DQ,!1):!this.ZMd&&Sc&&this.Xr.cZb(this.QM,this.DQ,!0);this.ZMd=Sc};this.zwj=(Sc,Gd)=>{Gd.bfb===this.QM.SZ&&this.Xr.cZb(this.QM,this.DQ,!Gd.start&&this.Tbe())};ob.a.JMe(this.HSb);this.ZMd=3===ob.a.Ke;this.Xr.Leh(this.zwj)}dispose(){ob.a.Lkg(this.HSb);super.dispose()}Qng(){return[Wg.a.T4h,Wg.a.S4h]}KNe(){return[Wg.a.Bff,Wg.a.$mc,Wg.a.Zmc]}cpf(D){D=
D.rf;if(D===this.DQ[0])return 0;if(D===this.DQ[1])return 3;z.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}lig(){za.a.JP?this.Xr.L1(this.rn,this.Yk,!1):this.Xr.HQj(this.rn,this.Yk)}EJg(){za.a.JP?this.Xr.wie(this.rn,this.Yk,!1):this.Xr.BBk(this.rn,this.Yk)}Nxg(D){return 3===(ob.a.Ke=D.Te)}Tbe(){return 3===ob.a.Ke}hRf(){z.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}SNe(){}}
Object(w.a)(ph,"ResizeMarqueeTouchBehavior",gi,[]);class Nh extends mg{constructor(D,ma){super(D);Nh.CDb(D,li.a.b5h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.horizontal);Nh.CDb(D,li.a.a5h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.vertical);Nh.CDb(D,li.a.Y4h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.horizontal);Nh.CDb(D,li.a.$4h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.vertical);Nh.CDb(D,Wg.a.Z4h)}static CDb(D,ma,Ua){const Xb=document.createElement("div");Xb.className=ma;Ua&&(Xb.style.backgroundImage=
`url("${Ua}")`);D.appendChild(Xb)}}Object(w.a)(Nh,"SelectionCutCopyBehavior",mg,[]);class Oh extends mg{constructor(D){super(D);appChrome.renderSpinner(D)}}Object(w.a)(Oh,"SelectionPasteBehavior",mg,[]);class Sh extends mg{constructor(D,ma){super(D);Sh.VDb(D,li.a.u5h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.horizontal);Sh.VDb(D,li.a.t5h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.vertical);Sh.VDb(D,li.a.q5h+" "+Wg.a.MCa,null===ma||void 0===ma?void 0:ma.horizontal);Sh.VDb(D,li.a.s5h+" "+Wg.a.MCa,
null===ma||void 0===ma?void 0:ma.vertical);Sh.VDb(D,Wg.a.r5h)}static VDb(D,ma,Ua){const Xb=document.createElement("div");Xb.className=ma;Ua&&(Xb.style.backgroundImage=`url("${Ua}")`);D.appendChild(Xb)}}Object(w.a)(Sh,"SelectionRangePickerBehavior",mg,[]);class Z extends xh{constructor(D,ma,Ua,Xb,yc){super(D,ma,Ua,Xb,yc)}get Jba(){return 0}get Hnb(){return this.gridView.ha.pa.og}k1a(){const D=this.gridView.Fm||this.gridView.De;return this.gridView.ha.pa.Fk&&!D&&super.k1a()}}Object(w.a)(Z,"SelectionTouchGrippiesBehavior",
xh,[]);let tb=class extends ii.a{constructor(D,ma,Ua){super();this.yAb=(Xb,yc)=>{Xb=yc.Jba;const Tc=this.gridView;yc=yc.vJi;const Sc=yc.di,Gd=yc.l4;switch(Xb){case 24:yc.l4.push(new Yh(Sc,yc));break;case 0:yc.l4.push(new Ti(Sc,Tc));za.a.Ht||(Gd.push(new Li(Sc,this.gridView.$,yc.paneType,this.Ug,this.Xr,this.zoom)),Gd.push(new Si(Sc,this.gridView.$,yc.paneType,this.Ug,this.Xr,this.zoom)));Gd.push(new Z(yc,Sc,Tc,yc.paneType,this.zoom));break;case 3:Gd.push(new ei(Sc));za.a.Ht||(Gd.push(new Ei(Sc,this.gridView.$,
yc.paneType,this.yK,this.Xr,yc,this.zoom)),Gd.push(new Qi(Sc,this.gridView,this.yK,this.Xr,yc,this.zoom)),Gd.push(new ph(Sc,this.gridView,this.yK,this.Xr,yc,this.zoom)));break;case 4:case 5:Gd.push(new Nh(Sc,this.hPe));break;case 30:Gd.push(new Oh(Sc));break;case 16:Gd.push(new Sh(Sc,this.hPe));Gd.push(new vi(yc,Sc,Tc,yc.paneType,this.zoom));break;case 11:case 12:case 58:case 59:case 60:case 61:Gd.push(new ki(Sc,11===Xb||58===Xb||60===Xb,58===Xb||59===Xb||60===Xb||61===Xb));break;case 17:Gd.push(new ei(Sc));
break;case 19:Gd.push(new ei(Sc)),Gd.push(new fh(yc,Sc,Tc,yc.paneType,this.zoom))}yc.OAb=!0};this.$=D;this.zoom=Ua;this.gridView=ua.h(D);this.Ug=ma;this.yK=new Ni(this.gridView);this.Xr=new Ii(this.gridView);this.gridView.Se&&(this.gridView.Se.feh(this.yAb),this.gridView.Se.update(!1))}get hPe(){Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.gPe&&(this.gPe={vertical:Wb.a.current.uq(102),horizontal:Wb.a.current.uq(103)});return this.gPe}dispose(){this.gridView.Se.kVj(this.yAb);
this.yK&&(this.yK.dispose(),this.yK=null);super.dispose()}};tb=Object(vb.__decorate)([Object(Eb.d)(kc.Yb),Object(vb.__param)(0,Object(kc.nb)()),Object(vb.__param)(1,Object(kc.ie)()),Object(vb.__param)(2,Object(kc.ze)())],tb);Object(w.a)(tb,"GridHighlightsBehaviorManager",ii.a,[]);let $b=class extends Mg.a{constructor(D,ma){D=void 0===D?Ha.a.Unb:D;ma=void 0===ma?Ha.a.XD:ma;super(D,ma)}execute(D){const ma=Object(R.a)(8,D.Oh);z.ULS.shipAssertTag(537153921,0,Cb.a.iAb(D.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");
ma.RK(!0,!0);D.activityState[Jb.a.rbc]=ma.ea.sessionId;D.activityState[Jb.a.xyb]=!0;D.activityState[Jb.a.xbc]=!0;z.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};$b=Object(vb.__decorate)([Object(Eb.d)(kc.Hd)],$b);Object(w.a)($b,"SessionReloadActivity",Mg.a,[]);var Yc=a(688),rd=a(580),Vd=a(1220);class pe extends Me.a{constructor(D,ma){ma=void 0===ma?!0:ma;super(!1,!1,pe.Dz);this.t6a=null;this.zte=!1;this.gr=[];this.Yl=null;
this.qqj=Ua=>{this.q5g&&(this.Yl=this.jwg(Ua,this.xac))};this.Fzj=()=>{this.Yl&&this.Yl.MF&&(this.zte||(this.Yl.iRj(this.rVd),this.zte=!0),this.Yl.Thf())};this.rVd=Ua=>{this.t6a.uploadStatusLabel=Ua;this.rKa(this.titleText,Object(ea.a)(this,this.Kuc,"insertDialogHandler"),this.t6a)};this.jXd=()=>{this.tdg()};this.onKeyDown=Ua=>{4!==gg.FocusManager.instance().wdg(Ua)&&Ua.preventDefault()};this.xac=D;this.q5g=ma;this.hC=this.WGe=!1;this.Xna=null;this.UZc=!1;this.Wi=this.gRh;this.xh="InsertFileDialog";
this.uf(1,this.actionButtonText);pe.Dz?(this.t6a={["id"]:this.xh,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:this.Fzj}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.qqj},this.initializeAndShow(this.titleText,Object(ea.a)(this,this.Kuc,"insertDialogHandler"),this.t6a),this.u5b=!0):(this.showDialog(this.titleText,Object(ea.a)(this,this.Kuc,"insertDialogHandler")),ma&&this.kwg(),(D=this.tP(1))&&this.gr.push(D),
(D=this.tP(0))&&this.gr.push(D),this.tLg(),this.u5b=!1)}get eHk(){return this.xac}validate(){this.Yl.MF||z.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Yl.MF.value?!0:(pe.RE(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Kuc(D){1===D&&this.isEnabled()?pe.Dz&&this.Yl.MF&&!this.Yl.MF.value?(this.t6a.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.rKa(this.titleText,Object(ea.a)(this,this.Kuc,"insertDialogHandler"),this.t6a)):(this.Aeb(),this.xac.finalizeUpload(this.Yl,
Object(ea.a)(this,this.dispose,"dispose"))):0===D&&this.hide()}kwg(){this.UZc=!1;this.Yl=this.jwg(document.getElementById("uploadFrameContainer"),this.xac);P.AFrameworkApplication.fa.la("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Xna=this.jXd,sa.a.addHandler(this.Yl.vEd,"load",this.Xna));this.Yl.MF||z.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.tdg()}tdg(){if(this.Yl&&!this.UZc){var D=this.Yl.MF;D&&(sa.a.addHandler(D,Oe.a.Hf,this.onKeyDown),D=[D],this.gr=D.concat.apply(D,
this.gr),this.tLg(),this.UZc=!0)}}dispose(){if(this.Yl&&!pe.Dz){const D=this.Yl.MF;D&&sa.a.removeHandler(D,Oe.a.Hf,this.onKeyDown);this.Xna&&sa.a.removeHandler(this.Yl.vEd,"load",this.Xna)}this.Yl=null;super.dispose()}tLg(){if(0<this.gr.length){const D=new Vd.a(this.gr),ma=gg.FocusManager.instance().hW();ma&&(this.gr[0].focus(),ma.Wk=D,ma.Dca=!0)}}static get Dz(){return P.AFrameworkApplication.ra.Pa.cA&&P.AFrameworkApplication.ra.Pa.yJf}static RE(D){const ma=document.getElementById("errorText");ma.innerText=
D;ma.style.display="inline-block"}}Object(w.a)(pe,"InsertFileDialog",Me.a,[]);class Ze{static get Wi(){return Me.a.Rq(Ze.to,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Ze.to="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(w.a)(Ze,"InsertImageDialogHtml",
null,[]);class tf extends pe{constructor(D,ma){super(D,void 0===ma?!0:ma)}get actionButtonText(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get gRh(){return Ze.Wi}validate(){this.Yl.MF||z.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");const D=Object(R.a)(yf,this.eHk),ma=D.ANg(this.Yl.MF.value);return 0!==ma?(pe.RE(D.Mof(ma)),!1):!0}}Object(w.a)(tf,"InsertImageDialog",pe,[]);var Nf=a(760),Bg=a(1339);class Ng extends Bg.a{constructor(D,
ma,Ua,Xb,yc,Tc,Sc,Gd){Gd=void 0===Gd?!1:Gd;super(D,ma,Ua,Xb,yc,"UploadFrame",Tc.ea.sessionId,"image/*",!1,null,void 0===Sc?!1:Sc);this.$=Tc;this.NMg=!0;this.FTi=Gd;this.PFd()}ia(D){return D}ftg(D){z.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Qc.a.ddd(D,this.$.xa);D.n$(pd.a.sessionId,this.sessionId);var ma=ua.h(this.$).ha;ma=Va.o(ma.pa.w5,this.$);D.n$(pd.a.bKj,this.$.sa.na.name);D.n$(pd.a.aKj,ma.FirstRow.toString());D.n$(pd.a.$Jj,ma.FirstColumn.toString());D.n$(pd.a.cQi,
this.FTi.toString())}iyf(){this.dog("ServerUploadError")}PYa(D){this.dog(D)}static ZVi(D){return!D||Lc.a.equals(D,"ServerUploadError",!1)}}Object(w.a)(Ng,"UploadFrameWrapper",Bg.a,[]);class sg extends tf{constructor(D,ma,Ua,Xb){super(D,!1);this.F_=null;this.KJa=!1;this.wf=null;this.xDc=()=>{this.Xie("");this.cSc();return!1};this.$=ma;this.oTc=D;this.vW=Nf.a.instance;this.fa=Ua;this.wf=Xb;this.kwg();this.DFd();this.$.Le.aD=!0}jwg(D,ma){return new Ng(D,Object(ea.a)(ma,ma.OYa,"onUploadFrameInitialized"),
Object(ea.a)(ma,ma.Hea,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.cSc();this.vW=this.oTc=null;super.dispose()}hide(){super.hide();this.$.Le.aD=!1}validate(){var D=this.oTc.k2b(this.Yl.MF.value,this.oTc.SHg(this.Yl));return 0!==D?(D=this.oTc.Cxd(D).Description,this.Xie(D),this.Yee(),!1):!0}isEnabled(){return!0}Xie(D){var ma;null===(ma=this.wf)||void 0===ma?void 0:ma.dug(this.F_,D)}DFd(){this.F_=document.getElementById("errorText");this.F_.style.display="inline-block";this.KJa=!1;this.Xie("");
this.KRa.style.maxWidth=this.KRa.currentStyle.minWidth}Yee(){this.vW.va(Oe.a.click,this.Yl.MF,this.xDc);this.vW.va(Oe.a.Hf,this.Yl.MF,this.xDc);this.KJa=!0}cSc(){this.KJa&&(this.vW.Da(Oe.a.click,this.Yl.MF,this.xDc),this.vW.Da(Oe.a.Hf,this.Yl.MF,this.xDc),this.KJa=!1)}}Object(w.a)(sg,"InsertImageDialogWrapper",tf,[]);class wg extends yf{constructor(D,ma,Ua,Xb,yc){yc=void 0===yc?!0:yc;super(null,ma,Ua);this.zqa=this.gL=null;this.cHd=this.Xgb=!1;this.SYd=null;this.Hea=Tc=>{this.Ele.stop();this.cec.cancel();
if(Ng.ZVi(Tc))this.H2?this.dxf(4):(Tc=new Yc.a(0,2,null,null,!1,null,null,null),Tc.status=8,this.xhe(new rd.a(Tc),null,"InsertPictureWebMethod")),z.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.H2}`);else{const Sc=wg.mJk(Tc);0!==Sc?(z.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${Tc}`),this.dxf(Sc)):this.vGi(Tc)}this.sTb();this.dispose()};this.xpj=Tc=>{this.sma(Tc,this.Yl)&&this.finalizeUpload(this.Yl,null)};this.OYa=Tc=>{z.ULS.sendTraceTag(526399120,
0,50,"Upload frame initialized");this.Yl=Tc;if(!this.ZBa){if(this.rTc){if(this.FVe()||this.$Xa&&za.a.bD){Tc.bFb(this.xpj);return}const Sc=Tc.bFb(null);if(!this.sma(Sc,Tc))return}this.finalizeUpload(Tc,null)}};this.czj=()=>{this.H2=!0};this.Ie=D;this.Ele=D.Ve.wj("WebServiceCall","InsertPictureOperation");this.cec=Ga.a.instance.create(this.czj,1E5,Ob.a.cnh,!1);this.H2=!1;this.qBc=this.$.xa.InsertPictureMaxFileSizeBytes;Xb&&(this.Xgb="TestOnly"in Xb);Xb&&(this.cHd="IsCellPicture"in Xb);yc&&this.showDialog()}get $(){return this.Ie}get wdj(){return this.qBc/
1024/1024}dispose(){qf.a.Sa(this.cec);this.Yl&&this.Yl.xKe();this.Yl=this.cec=this.Ie=null}INj(D){if(!this.$)return z.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),nb.Task.Ra(!0);if(!this.$.aca)return nb.Task.Ra(!0);const ma=new Fe.a,Ua=new FileReader;D=D.MF.files[0];const Xb=()=>{ma.yA(!0)};Ua.onload=()=>{this.SYd=Ua.result;ma.yA(!0)};Ua.onerror=Xb;Ua.onabort=Xb;Ua.readAsDataURL(D);return ma.task}SHg(D){let ma=-1;D=D.MF;(null===D||void 0===D?0:D.files)&&0<D.files.length&&
(ma=D.files[0].size);return ma}k2b(D,ma){let Ua=wg.pEh(yf.sma(D));0===Ua?-1!==ma&&(z.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${ma}, maxAllowedSize: ${this.qBc}, remainingWorkbookSize: ${this.$.ea.NNf}`),ma>this.qBc?Ua=3:ma>this.$.ea.NNf&&(Ua=7)):6===Ua&&this.Zaj(D);z.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${Ua}`);return Ua}sma(D,ma){D=this.k2b(D,this.SHg(ma));return 0!==D?(this.ZBa||1===D||this.Cce(D),!1):!0}gHg(D){D.srk()}Cxd(D){let ma=
0,Ua=1,Xb=-1100324317,yc="InsertPictureUnknownError",Tc=null;switch(D){case 1:ma=1758;Ua=0;Xb=940870981;yc="InsertPictureNoFileSelected";break;case 3:Ua=0;Xb=1250467391;yc="InsertPicturePictureTooBig";Tc=String.format(ad.a.instance.He(181),this.wdj.toLocaleString());break;case 6:ma=1762;Ua=0;Xb=1380041209;yc="InsertPictureUnsupportedFormat";break;case 7:ma=1759;Ua=0;Xb=-903115058;yc="InsertPictureExceedWorkbookSize";break;case 4:ma=1760;Ua=0;Xb=1218352119;yc="InsertPictureUploadTimeout";break;case 5:ma=
1761,Ua=0,Xb=1979899005,yc="InsertPictureServiceNonDeterministicError"}D=wg.Fg(ma,Ua,Xb,yc);Tc&&(D.Description=Tc);return D}showDialog(){if(this.FVe())this.ZBa=!1,this.Yl=new Ng(this.$.domElement,this.OYa,this.Hea,this.fa,!1,this.$,!0,this.cHd);else if(z.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Xgb&&(za.a.JP||za.a.bD&&72>za.a.XXe))this.ZBa=!1,this.Yl=new Ng(this.$.domElement,this.OYa,this.Hea,this.fa,!1,this.$);else{this.ZBa=!0;const D=Object(ub.d)(Eb.a.resolve(kc.fc,
{Aa:0}));ne.TaskExtensions.Ca(D,()=>{this.Yl=(new sg(this,this.$,this.fa,D.result)).Yl},this.$.qa,3)}}vGi(D){let ma={};try{if(ma=ic.a.qm(D),lb.b().vF(this.Ele.id,ma.ServerCorrelationId,"actions","ServerActions"),!Cb.a.Ai(ma.Errors)&&ma.Result&&(this.$.ea.N2(ma.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.cHd)){const Ua=ma.Result;Ra.a(this.$).Jda(1,Ua);const Xb=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?Eb.a.mg(kc.re):this.$.ja.Qa(277);
Xb&&Xb.Ead(this.$,1,ma.Result,ma,"InsertPicture");z.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Ua){z.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${D?D.length:-1}, errror: ${Ua}`)}this.ARc(ma,null,"InsertPictureWebMethod")}dxf(D){D=this.Cxd(D);const ma={};ma.Errors=[D];this.ARc(ma,null,"InsertPictureWebMethod")}ARc(D,ma,Ua){this.gL(D,ma,Ua)}xhe(D,ma,Ua){this.zqa(D,ma,
Ua)}Cce(D){D=this.Cxd(D);new se.a(this.$,D)}Zaj(D){const ma=this.$.xa.InsertPicturUnsupportedExtensionsForLogging;D=jb.a.Po(D);for(let Ua=0;Ua<ma.length;++Ua)if(D.endsWith(ma[Ua])){z.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${ma[Ua]}`);break}}static mJk(D){return!D||Lc.a.equals(D,pd.a.insertPictureUnknownError,!0)?2:Lc.a.equals(D,pd.a.insertPictureNoFileSelectedError,!0)?1:Lc.a.equals(D,pd.a.bQi,!0)?3:Lc.a.equals(D,pd.a.eQi,!0)?5:0}static Fg(D,ma,Ua,Xb){return Cb.a.Fg(1,
0,0,D,ma,Ua,Xb)}static pEh(D){switch(D){case 1:return 1;case 2:return 6}return 0}FVe(){return this.Xgb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(w.a)(wg,"BasePictureUploaderWrapper",yf,[2]);class vg extends wg{constructor(D,ma,Ua,Xb,yc,Tc){Tc=void 0===Tc?!0:Tc;super(D,ma,Ua,Xb,!1);this.Z8h=yc;this.Onc=D.Ve.wj("LoadResource","FileReaderUploaderLoadResource");Tc&&this.showDialog()}skk(){this.qBc=28E5;this.Cce(3)}itd(D){z.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");
const ma=new FileReader;D=D.MF.files;if(0==D.length)z.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Ua=D[0];ma.onload=()=>{this.Onc.stop();this.Z8h.yyj(ma.result,this);z.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${Ua.type}, Size:${Ua.size.toString()}`)};ma.onerror=()=>{this.Onc.stop();z.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${Ua.type}, Size:${Ua.size.toString()}`)};
ma.onabort=()=>{this.Onc.stop();z.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${Ua.type}, Size:${Ua.size.toString()}`)};this.Onc.start();ma.readAsDataURL(Ua)}}finalizeUpload(D,ma){this.itd(D,ma)}}Object(w.a)(vg,"FileReaderUploaderWrapper",wg,[572]);class si{constructor(D,ma){this.dataUri=this.sheetName=null;this.sheetName=D;this.dataUri=ma}getSheetName(){return this.sheetName}}Object(w.a)(si,"MacroRecorderPictureInsertedPayload",null,[124]);
class Lh extends wg{constructor(D,ma,Ua,Xb,yc,Tc){Tc=void 0===Tc?!0:Tc;super(D,Ua,Xb,yc,!1);this.xg=ma;Tc&&this.showDialog()}itd(D,ma){super.finalizeUpload(D,ma);Vb.a(this.$.userOperationManager,(Ua,Xb)=>{this.gL=Ua;this.zqa=Xb;this.Ele.start();this.cec.tv();this.H2=!1;this.gHg(D);return this.INj(D)},Ua=>{const Xb={};this.$.Pn(Xb);const yc=Xb.SheetName;Ua=new eb.a(510,0,Ua,72,()=>new si(yc,this.SYd?this.SYd:""));Ua.iJa(()=>!0);Ua.xg=this.xg;return Ua},this.xg)}finalizeUpload(D,ma){this.itd(D,ma)}}
Object(w.a)(Lh,"PictureUploaderWrapper",wg,[]);class di{constructor(D,ma){this.filename=D;this.blob=ma}}Object(w.a)(di,"UploadBlobParameters",null,[]);class ai extends Lh{constructor(D,ma,Ua,Xb,yc,Tc,Sc){super(D,ma,Ua,Xb,yc,!1);this.rTc=!1;this.$N=Sc;this.cuc=ai.aei(Tc);D=this.k2b(this.cuc.name,this.cuc.size);0!==D?(this.Cce(D),this.$N.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),this.dispose()):this.Yl=new Ng(this.$.domElement,this.OYa,this.Hea,Xb,!1,this.$)}xhe(D,ma,Ua){super.xhe(D,
ma,Ua);this.$N.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}ARc(D,ma,Ua){super.ARc(D,ma,Ua);Cb.a.Ai(D.Errors)?this.$N.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${Cb.a.xf(D.Errors)}`)):this.$N.setResult(!0)}gHg(D){const ma=new di(this.cuc.name,this.cuc);D.rDg(ma)}static aei(D){var ma=D.split(",");D=ma[0].includes("base64")?window.self.atob(ma[1]):window.self.decodeURI(ma[1]);
ma=ma[0].split(":")[1].split(";")[0];const Ua=new Uint8Array(D.length);for(let Xb=0;Xb<D.length;Xb++)Ua[Xb]=D.charCodeAt(Xb);D=new Blob([Ua],{type:ma});D.name="Image.png";return D}}Object(w.a)(ai,"DataUrlUploaderWrapper",Lh,[]);let ci=class{constructor(){}GOi(D,ma,Ua,Xb,yc){-2060689045===ma.command&&(yc.IsCellPicture=!0);new Lh(D,ma,Ua,Xb,yc,!0)}ANi(D,ma,Ua,Xb,yc,Tc){new ai(D,null,ma,Ua,Xb,yc,Tc)}ONi(D,ma,Ua,Xb,yc){new vg(D,ma,Ua,Xb,yc,!0)}};ci=Object(vb.__decorate)([Object(Eb.d)(kc.qe)],ci);Object(w.a)(ci,
"UploaderCreator",null,[556]);class fi{constructor(D,ma){this.$=ma;this.ariaLiveNotifier=D}xgg(){const D=this.ghi();this.ariaLiveNotifier.TZa(D,id.a.BPa)}ghi(){const D=new Sys.StringBuilder;this.$.workbookContext&&Mf(D,this.$.workbookContext.WorkbookFileName);Mf(D,ad.a.instance.ia(855));Mf(D,this.ihi());Mf(D,this.hhi());Mf(D,ad.a.instance.ia(856));return D.toString()}ihi(){return this.$.isEditMode?ad.a.instance.ia(860):ad.a.instance.ia(861)}hhi(){var D=this.qKk();const ma=this.$.sa.na;D=1!==D?String.format(ad.a.instance.He(32),
D):ad.a.instance.ia(854);D=new Sys.StringBuilder(D);ma&&ma.sheetName&&(D.append(Bf.HPd),D.append(String.format(ad.a.instance.He(33),ma.sheetName)));return D.toString()}qKk(){let D=0;for(const ma of this.$.sa.items)ma.visible&&D++;return D}}Object(w.a)(fi,"WorkbookReadout",null,[]);let Jg=class{constructor(D,ma){this.l1=()=>{this.fh||this.bPe()};this.fh=!1;this.P4=ma.e_;this.ariaLiveNotifier=D;this.Sle=new fi(D,ma);this.P4&&this.P4.EW?this.bPe():this.Kl()}dispose(){this.Qk();this.ariaLiveNotifier=
this.P4=null;this.fh=!0}Kl(){if(this.P4){this.P4.Dw(this.l1);this.P4.ya.Uu(this.l1);this.P4.tJ(this.l1);var D=Object(R.a)(170,this.P4);D&&(D.kf.jr(this.l1),D.ha.qt(this.l1),D.ha.add_activeCellChanged(this.l1),D.ha.Ua.uJ(this.l1))}else z.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Qk(){if(this.P4){this.P4.ya.Ot(this.l1);this.P4.VK(this.l1);const D=Object(R.a)(170,this.P4);D&&(D.kf.$q(this.l1),D.ha.Pt(this.l1),D.ha.remove_activeCellChanged(this.l1),
D.ha.Ua.xQ(this.l1))}}bPe(){this.Sle.xgg();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Z9j();this.dispose()}};Jg=Object(vb.__decorate)([Object(Eb.d)(kc.ue),Object(vb.__param)(0,Object(kc.i)()),Object(vb.__param)(1,Object(kc.nb)())],Jg);Object(w.a)(Jg,"WorkbookReadoutHandler",null,[2]);let Hh=class{constructor(D,ma,Ua){this.y3f=()=>{this.Sle.xgg();this.ariaLiveNotifier.setEnabled(!0)};this.$=ma;this.ariaLiveNotifier=D;this.Sle=new fi(D,ma);this.voc=Ua.yzd(this.$);this.voc.zeh(this.y3f)}dispose(){this.voc&&
this.voc.DVj(this.y3f);this.voc=this.ariaLiveNotifier=this.$=null}};Hh=Object(vb.__decorate)([Object(Eb.d)(kc.kb),Object(vb.__param)(0,Object(kc.i)()),Object(vb.__param)(1,Object(kc.nb)()),Object(vb.__param)(2,Object(kc.Ld)())],Hh);Object(w.a)(Hh,"EmbeddedWorkbookReadoutHandler",null,[2]);Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Aa.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(()=>{Qe.a.Na(D=>
{Ce.ta(D)})})();(()=>{Qe.a.Na(D=>{Tb.EwaSettings.qFa()||Yf.ta(D)})})();(()=>{Qe.a.Na(D=>{Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateDataFromPictureCommandHandler")||Be.ta(D)})})();oe.a.Rl(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
(()=>{Qe.a.Na(D=>{Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateInsertPictureCommandHandler")||Ud.ta(D)})})();Type.registerNamespace("Common.App.GestureManager");ih.main();Type.registerNamespace("Common.App.AccessibilitySettings");Qd.main();Type.registerNamespace("Common.App.RibbonSettings");ef.main();(()=>{Qe.a.Na(D=>{Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||vh.ta(D);kc.Ab.$e()||Qh.ta(D);kc.Fd.$e()||Bh.ta(D)})})();oe.a.Rl(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-drag-tooltip-fluent{position:absolute;background-color:#fff;box-shadow:0 0 2px 0 #0000001f,0 4px 8px 0 #00000024;border-radius:4px;height:fit-content;width:max-content;font-size:10px;padding:4px 8px 6px 8px}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top-enhanced,.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top{height:calc(3px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom-enhanced,.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom{height:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right-enhanced,.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left-enhanced,.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px/var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107c41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107c41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107c41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107c41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr_selection_rearrange-flange-left,.ewr_selection_rearrange-fullrowcol-flange-left{border-left:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;left:-2px;top:-3.5px}.ewr_selection_rearrange-flange-right,.ewr_selection_rearrange-fullrowcol-flange-right{border-right:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;right:-5px;top:-3.5px}.ewr_selection_rearrange-flange-top,.ewr_selection_rearrange-fullrowcol-flange-top{border-top:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;top:-2px;left:-3.5px}.ewr_selection_rearrange-flange-bottom,.ewr_selection_rearrange-fullrowcol-flange-bottom{border-bottom:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;bottom:-5px;left:-3.5px}.ewr_selection_rearrange-fullrowcol-flange-left{left:0}.ewr_selection_rearrange-fullrowcol-flange-right{right:-3px}.ewr_selection_rearrange-fullrowcol-flange-top{top:0}.ewr_selection_rearrange-fullrowcol-flange-bottom{bottom:-3px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-drag-shadow{position:absolute;top:0;background-color:#107c41;opacity:15%;z-index:52;pointer-events:none;border-radius:2px}.ewa-grid-ltr .ewr-selection-drag-shadow{left:0}.ewa-grid-rtl .ewr-selection-drag-shadow{right:0}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107c41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
Type.registerNamespace("Common.App.NewAndOpen.Core");Ea.a.instance.Ul(new Qf);Type.registerNamespace("Common.App.O365Shell");lg.main();oe.a.Rl(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
(()=>{Qe.a.Na(D=>{Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateEwaAccessibilityManager")||$h.ta(D)})})();(()=>{Qe.a.Na(D=>{Rc.ta(D)})})();String(k);String(Dd);String(b);String(f);String(h);String(t);String(u);String(d);String(m);String(n);String(v);String(l);String(y);String(C);String(x);String(c);window.___1699049107525_closurehack=k;window.___1699049107525_closurehack=Dd;window.___1699049107525_closurehack=b;window.___1699049107525_closurehack=f;window.___1699049107525_closurehack=
h;window.___1699049107525_closurehack=t;window.___1699049107525_closurehack=u;window.___1699049107525_closurehack=d;window.___1699049107525_closurehack=m;window.___1699049107525_closurehack=n;window.___1699049107525_closurehack=v;window.___1699049107525_closurehack=l;window.___1699049107525_closurehack=y;window.___1699049107525_closurehack=C;window.___1699049107525_closurehack=x;window.___1699049107525_closurehack=c}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/156c443ce21c8c3be2bf7f739ef8befb/EwaTS.frs.js.map