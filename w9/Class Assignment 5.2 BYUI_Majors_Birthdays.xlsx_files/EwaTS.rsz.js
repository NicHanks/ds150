'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[49],{1415:function(B,A,a){function c(Ma){return 0<Ma&&Ma<=Ba.a.oi}function b(Ma){return 0<Ma&&Ma<=Ba.a.hi}function k(Ma,V){let fa="";V.sort((Eb,kc)=>Eb.start-kc.start);let ub=0,rb=V.shift();const hd=Ma.length;for(;ub<hd&&rb;)ub===rb.start?(fa+=rb.value,rb.wFa&&(fa+="#"),ub=rb.end,rb=V.shift()):(fa+=Ma[ub],ub++);ub<hd&&(fa+=Ma.substring(ub));return fa}function m(Ma,V){return Ma.top<=V.top&&Ma.left<=V.left&&Ma.bottom>=
V.bottom&&Ma.right>=V.right}function d(Ma,V,fa,ub){switch(fa){case -706918724:case 674605324:var rb=Ma.destination.Mg;if(!rb)return J("shouldCurrentBlockPairBeProcessed",fa),!1;if(rb.right<V.left)return Ma.F0=!0,xa.ULS.sendTraceTag(508150742,0,50,`GridInstantaneousAction.processGridAction command=${fa}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${V.left}, blockRangeRightMostValue=${rb.right}, hashCode=${Ma.destination.Eg}, isRow=${ub}`),!1;break;case 369708605:case 1415868706:rb=
Ma.source.Mg;if(!rb)return J("shouldCurrentBlockPairBeProcessed",fa),!1;if(rb.right<V.left)return Ma.F0=!0,xa.ULS.sendTraceTag(508150741,0,50,`GridInstantaneousAction.processGridAction command=${fa}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${V.left}, blockRangeRightMostValue=${rb.right}, hashCode=${Ma.destination.Eg}, isRow=${ub}`),!1;break;case 1542466017:case -1113896058:rb=Ma.source.Mg;if(!rb)return J("shouldCurrentBlockPairBeProcessed",fa),!1;if(rb.bottom<V.top)return Ma.F0=
!0,xa.ULS.sendTraceTag(508150740,0,50,`GridInstantaneousAction.processGridAction command=${fa}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${V.top}, blockRangeBottomMostValue=${rb.bottom}, hashCode=${Ma.destination.Eg}, isRow=${ub}`),!1;break;case 1051390410:case 1554436520:rb=Ma.destination.Mg;if(!rb)return J("shouldCurrentBlockPairBeProcessed",fa),!1;if(rb.bottom<V.top)return Ma.F0=!0,xa.ULS.sendTraceTag(508150739,0,50,`GridInstantaneousAction.processGridAction command=${fa}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${V.top}, blockRangeBottomMostValue=${rb.bottom}, hashCode=${Ma.destination.Eg}, isRow=${ub}`),
!1}return!0}function n(Ma,V,fa){const ub=V?C(Ma):y(Ma),rb=[];if(!Sa.EwaSettings.nca()&&0===ub&&1===Ma.length)return rb.push({destination:Ma[0],source:null,F0:!1}),rb;if(Sa.EwaSettings.lFa()||Sa.EwaSettings.jFa()||Sa.EwaSettings.FVa())rb.push(...l(Ma,ub,V,fa));else for(let hd=0;hd<=ub;hd++){V=Ma.filter(Eb=>Eb.z5().topLeft.Y===hd);for(let Eb=0;Eb+1<V.length;Eb+=1)rb.push({destination:V[Eb],source:V[Eb+1],F0:!1})}xa.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${rb.length}  and command=${fa}`);
return rb}function l(Ma,V,fa,ub){const rb=[];for(let hd=0;hd<=V;hd++){const Eb=Ma.filter(zc=>fa?zc.z5().topLeft.X===hd:zc.z5().topLeft.Y===hd),kc=Eb.length;for(let zc=0;zc<kc;zc+=2)switch(ub){case -1113896058:case 1542466017:rb.push({source:Eb[zc],destination:f(zc+1,Eb),F0:!1});break;case 1554436520:case 1051390410:rb.push({destination:Eb[zc],source:f(zc+1,Eb),F0:!1});break;case 1415868706:case 369708605:rb.push({source:Eb[zc],destination:f(zc+1,Eb),F0:!1});break;case 674605324:case -706918724:rb.push({destination:Eb[zc],
source:f(zc+1,Eb),F0:!1})}}return rb}function f(Ma,V){return Ma<V.length?V[Ma]:null}function h(Ma,V,fa,ub,rb,hd){let Eb,kc=0;kc=O(ub)?Ea.HelperMethods.zK(()=>{Eb=gridRenderer.CanvasRendererGlobals.performModelRowColOperation(Ma,V,fa,ub,rb)}):Ea.HelperMethods.zK(()=>{Eb=gridRenderer.CanvasRendererGlobals.hideRowCols(Ma,V,rb)});x("HideRowCols",kc,hd);return Eb}function t(Ma,V,fa,ub,rb,hd,Eb){let kc;if(!Ma||!V)return kc;kc=O(rb)?gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(Ma,
V,fa,ub,rb,hd):gridRenderer.CanvasRendererGlobals.performModelCascade(Ma,V,fa,hd);kc.Zej&&x("ModelCascade",kc.Zej.xZk,Eb);return kc}function u(Ma){return!Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8497251_globalStyleForCse")||-1113896058!==Ma&&1415868706!==Ma&&1554436520!==Ma&&674605324!==Ma&&1051390410!==Ma?-706918724===Ma||-1113896058===Ma||1415868706===Ma||1554436520===Ma||674605324===Ma||1051390410===Ma:gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled()}
function v(Ma,V,fa,ub){return fa?-1113896058===ub||1542466017===ub?Ma.RowNumbers[Ma.RowNumbers.length-V-1]:Ma.RowNumbers[0]:1415868706===ub||369708605===ub?Ma.ColumnNumbers[Ma.ColumnNumbers.length-V-1]:Ma.ColumnNumbers[0]}function y(Ma){let V=-1;for(let fa=0;fa<Ma.length;fa++){const ub=Ma[fa].z5().topLeft.Y;ub>V&&(V=ub)}return V}function C(Ma){let V=-1;for(let fa=0;fa<Ma.length;fa++){const ub=Ma[fa].z5().topLeft.X;ub>V&&(V=ub)}return V}function x(Ma,V,fa){ad?xa.ULS.sendTraceTag(509723719,0,20,`GridInstantaneousAction: Time taken to complete operation=${Ma} is time=${V} and command=${fa}`):
xa.ULS.sendTraceTag(507869347,0,50,`GridInstantaneousAction: Time taken to complete operation=${Ma} is time=${V} and command=${fa}`)}function w(Ma,V,fa){var ub,rb;for(const Eb of V)if(!Sa.EwaSettings.nca()||Eb.source&&Eb.destination){if(!(Sa.EwaSettings.nca()||Eb.source&&Eb.destination))return!0;var hd=null===(ub=Eb.destination)||void 0===ub?void 0:ub.Mg;V=null===(rb=Eb.source)||void 0===rb?void 0:rb.Mg;if(Sa.EwaSettings.Mwc()&&(!hd||!V))return J("isFirstRowColOfNextBlockHidden",fa),!0;hd=Ma.Svd(hd);
V=Ma.Svd(V);switch(fa){case -706918724:case 674605324:return hd&&hd.IsFirstColOfNextBlockHidden;case 369708605:case 1415868706:return hd&&(null===hd||void 0===hd?void 0:hd.IsLastColOfPrevBlockHidden)||V&&(null===V||void 0===V?void 0:V.IsFirstColOfNextBlockHidden);case 1051390410:case 1554436520:return hd&&hd.IsFirstRowOfNextBlockHidden;case 1542466017:case -1113896058:return hd&&(null===hd||void 0===hd?void 0:hd.IsLastRowOfPrevBlockHidden)||V&&(null===V||void 0===V?void 0:V.IsFirstRowOfNextBlockHidden)}}return!1}
function z(Ma,V,fa){for(const ub of V){if(Sa.EwaSettings.sXi()&&!ub)return xa.ULS.sendTraceTag(508339915,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: blockPair or sourceBlock is null and command=${fa}`),!0;if(!ub.source||!ub.destination)if(Sa.EwaSettings.nca())continue;else return xa.ULS.sendTraceTag(507875778,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: sourceBlock or destination Block is null and command=${fa}`),!0;if(Sa.EwaSettings.Mwc()){V=ub.source.Mg;const rb=ub.destination.Mg;
if(!V||!rb)return J("isSelectedRangeAcrossBlocks",fa),!0;if(Sa.EwaSettings.rXi()){if(V.Zf(Ma)&&rb.Zf(Ma))return!0}else{const hd=-706918724===fa||674605324===fa||1051390410===fa||1554436520===fa;if(hd&&V.Zf(Ma)||!hd&&rb.Zf(Ma))return!0}}else if(ub.source.Mg.Zf(Ma))return!0}return!1}function F(Ma,V,fa,ub){return Sa.EwaSettings.XMb()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade(Ma,V,fa,ub):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(Ma,V,ub)}function J(Ma,V){xa.ULS.sendTraceTag(508347672,
0,50,`GridInstantaneousAction: BlockRange was null in the method = ${Ma} and command =${V}`)}function R(Ma,V,fa){if(-706918724===V||674605324===V||1051390410===V||1554436520===V){if(Ma.destination)return Ma=Ma.destination.Mg,Ma?Ma.Zf(fa):(J("doesBlockRangeIntersectWithSelectedRange",V),!1);J("doesBlockRangeIntersectWithSelectedRange destinationBlock",V)}else if(369708605===V||1415868706===V||1542466017===V||-1113896058===V){if(Ma.source)return Ma=Ma.source.Mg,Ma?Ma.Zf(fa):(J("doesBlockRangeIntersectWithSelectedRange",
V),!1);J("doesBlockRangeIntersectWithSelectedRange sourceBlock",V)}return!1}function I(Ma){switch(Ma){case -706918724:case 1051390410:return ac.Hide;case 369708605:case 1542466017:return ac.Unhide;case 674605324:case 1554436520:return ac.Delete;case 1415868706:case -1113896058:return ac.Insert}throw Error(`GridInstantaneousAction::getGridInstantaneousOperation: Command ${Ma} not supported currently`);}function O(Ma){switch(Ma){case ac.Hide:return Sa.EwaSettings.XMb()||Sa.EwaSettings.Nwc();case ac.Insert:return Sa.EwaSettings.lFa()||
Sa.EwaSettings.jFa();case ac.Delete:return Sa.EwaSettings.FVa()||Sa.EwaSettings.rMb();default:return!1}}function Y(Ma){const V=Sa.EwaSettings.lFa()&&-1113896058===Ma;return Sa.EwaSettings.jFa()&&1415868706===Ma||V}function K(Ma){const V=Sa.EwaSettings.FVa()&&1554436520===Ma;return Sa.EwaSettings.rMb()&&674605324===Ma||V}function L(){return Lc}function X(){Lc={dispose(){}}}a.r(A);var T={};a.r(T);a.d(T,"ResizeCommandHandler",function(){return Wd});var ba={};a.r(ba);a.d(ba,"GridInstantaneousOperation",
function(){return ac});a.d(ba,"GridInstantaneousAction",function(){return te});a.d(ba,"testableGetBlockPairsInViewport",function(){return n});a.d(ba,"testablePerformModelRowColOperation",function(){return h});a.d(ba,"testablePerformModelCascade",function(){return t});a.d(ba,"testableGetPartialInteractivityState",function(){return L});a.d(ba,"testableInitPartialInteractivityState",function(){return X});a.d(ba,"testableIsFirstRowColOfNextBlockHidden",function(){return w});a.d(ba,"testableIsSelectedRangeAcrossBlocks",
function(){return z});a.d(ba,"testableGetRowColNumberForCascade",function(){return v});var Q=a(531),P=a(11),ka=a(0),ia=a(299),Ba=a(9),va=a(18),W=a(71),S=a(70),da=a(6),aa=a(34);class za{}za.h2h="ewa-resizehdr-row-hidden";za.g2h="ewa-resizehdr-col-hidden";Object(ka.a)(za,"CssClassNames",null,[]);var qa=a(283),ta=a(16),Xa=a(188),oa=a(685),ha=a(35),Za=a(266),Fa=a(5),La=a(232),xa=a(15),db=a(65),bb=a(148),kb=a(45),Rb=a(23),zb=a(58),nc=a(14),Zb=a(75),Sa=a(1),Na=a(103),Ea=a(12),Aa=a(13),Ka=a(268),nb=a(149),
Qb=a(397),jb=a(47),qb=a(79);class ab{constructor(Ma,V,fa,ub,rb,hd,Eb){this.rEa=Ma;this.eRb=V;this.Nta=fa;this.vDd=ub;this.Zmb=rb;this.xLf=hd;this.bHi=Eb}}Object(ka.a)(ab,"HeaderEventCachedInfo",null,[]);class xb{constructor(Ma){this.lpd=Ma}b1e(Ma){Ma=Ea.HelperMethods.ZYd(Ma);return Math.max(0,Math.min(xb.pUf,Ma))}P0e(Ma){return this.QEj(Ma)}Yzh(Ma){return Math.round(this.lpd*Ma+2*this.Cof()+1)}QEj(Ma){return Math.max(0,Math.min(xb.STf,(Math.max(0,Math.min(Ba.a.sBc,Ma))-2*this.Cof()-1)/this.lpd))}Cof(){return Math.floor(Math.max((this.lpd+
3)/4,2))}Sqc(Ma,V){return V?Ma?xb.pUf:Ba.a.hRd:Ma?xb.STf:Ba.a.sBc}}xb.pUf=409;xb.STf=255;Object(ka.a)(xb,"ResizeHeadersConverter",null,[]);var Tb=a(133);class Cc extends Na.a{constructor(Ma,V){super(V.domElement);this.v3=this.Ung=!1;this.Lk=this.Ahb=this.EJa=null;this.Y5d=!0;this.Zxc=!1;this.TXb=this.Io=this.offset=0;this.ES=this.GX=this.u8=null;this.qIi="headerResizeTooltip";this.$Q=this.mPd=null;this.Bed=this.y9=this.CIa=!1;this.W9f=this.wkb=Ba.a.NEa;this.F2b=!1;this.SNb=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ResizeHeaderUXModernization",
!1);this.tKd=!1;this.lG=fa=>{if(this.grid.Hl)return!1;fa=qb.a(this.grid.$).Sh(fa);if(3===fa.Te&&!this.yLf(fa.Ga)||!this.Zbg(fa,!1))return!1;xa.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const ub=this.wOc();this.Bvd(fa.clientPoint,ub,!0);this.CIa||(qa.a.instance.va(ta.a.Yp,this.domElement.ownerDocument.body,this.Jjb),Xa.a.instance.va(ta.a.mk,this.domElement.ownerDocument.body,this.Jjb),this.CIa=!0);this.v3&&this.uBf(fa);return!1};this.rSb=fa=>{fa=
qb.a(this.grid.$).Sh(fa);this.Bed&&this.uBf(fa);if(!fa.Ga.type.includes("touch")&&fa.Ga.button!==Sys.UI.MouseButton.leftButton||!this.pWa)return!1;Zb.g(fa.Ga);this.faf();fa=this.grid.Hl?this.wkb:Ba.a.NEa;if(this.grid.Hl&&this.Lk){var ub=fa!==this.Io;!ub&&this.F2b&&(this.nh.removeRowColFromModel(this.Lk.ayb,this.Lk.pmb),this.nh.Dea(this.grid.ha.pa.selectedRanges),this.nh.Ip("HeaderResizeBehavior::onDocumentMouseUp"))}else this.Lk&&(fa=this.y9?this.uxd():this.Lk.rba()),ub=fa!==this.Io;if(this.EJa&&
ub&&fa!==Ba.a.NEa){fa=this.grid;var rb=this.eAd(fa);ub={};ub.SheetMultiRange=kb.r(rb,fa.$);Cc.H$d(ub,this.isRow,this.Io);if(this.grid.Hl){rb=this.Lk?this.Lk.ayb:-1;const hd=ub.SheetMultiRange.Ranges[0],Eb=Cc.hja()&&0===this.Io?20:50;xa.ULS.sendTraceTag(509694147,2,Eb,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${rb}, isResizingHiddenHeader=${this.y9}, headerViewBlockHashCode=${this.nh.hashCode},
          rangeFirstRow=${hd.FirstRow}, rangeFirstColumn=${hd.FirstColumn}, rangeLastRow=${hd.LastRow}, rangeLastColumn=${hd.LastColumn},`)}this.DXh(ub);fa.Bsk=!0}else this.dk(null,null),this.fWb();return this.F2b=this.y9=!1};this.ika=fa=>{if(this.grid.Hl)return!1;fa=oa.a.create(fa.eventName,fa.rf,fa.Ga,fa.Te);fa=qb.a(this.grid.$).Sh(fa);if(!this.Zbg(fa,!0))return!1;fa=this.grid;var ub=this.eAd(fa);ub=kb.r(ub,fa.$);this.SNb?fa.Se.Fl([this.isRow?51:52]):fa.Se.Fl([this.isRow?13:14]);fa.Se.hwa();this.fWb();
fa.$.Lf(this.isRow?146338636:1391094586,db.a.Ke,30,{["autoFitRanges"]:ub});return!1};this.H2f=fa=>{this.v3?(this.y9&&!this.F2b&&(this.$$g(),this.nh.Ip("HeaderResizeBehavior::onHeaderResizeChanged")),this.Zxc||this.GCf(),fa=new Sys.UI.DomEvent(fa),fa=oa.a.create(ta.a.TPa,this.domElement,fa,2),fa=qb.a(this.grid.$).Sh(fa),this.IVd(fa.clientPoint)):xa.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Lk?this.Lk.ayb:-1}, isRow = ${this.isRow}`)};
this.I2f=fa=>{fa=new Sys.UI.DomEvent(fa);fa=oa.a.create(ta.a.TPa,this.domElement,fa,2);this.rSb(fa)};this.Csj=fa=>{var ub;if(Cc.hja()&&!this.Lk){fa=!!this.nh;const rb=null===(ub=this.nh)||void 0===ub?void 0:ub.hashCode;xa.ULS.sendTraceTag(508368662,2,15,`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, isViewBlockSet=${fa}, this.viewBlock.hashCode=${rb}`)}else this.bHa(fa,this.Lk,!1)};this.Jjb=fa=>
{fa=qb.a(this.grid.$).Sh(fa);Zb.g(fa.Ga);return this.IVd(fa.clientPoint)};this.zN=fa=>{if(this.grid.Hl)return!1;fa=qb.a(this.grid.$).Sh(fa);let ub;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return jb.a(this.grid.$).Gt()&&(ub=this.syd(fa))&&(ub.rEa.style.cursor=""),!1;if(this.v3)return this.GCf(),!1;ub=this.syd(fa);if(!ub)return!1;ub.rEa.style.cursor=!this.grid.De&&this.cMd(ub)?this.isRow?"row-resize":"col-resize":"";Zb.g(fa.Ga);return!0};this.dx=()=>{this.fWb()};this.dk=
()=>{if((3===db.a.Ke||ha.a.Ht)&&this.grid.ha.pa.Fk){var fa=this.grid.ha.pa.og;if(!(!fa.isRow&&!fa.Ei||!this.domElement||fa.isRow&&this.isRow&&!this.nh.dy.includes(fa.top)||fa.Ei&&!this.isRow&&!this.nh.dy.includes(fa.left))){var ub=this.grid.Oj(fa,this.nh.en.paneType);if(ub){if(this.grid.Hl){const rb=this.isRow?fa.bottom:fa.right;this.Lk=this.nh.Ow(Rb.Range.Pf(fa.bottom,fa.right));if(!this.Lk){xa.ULS.sendTraceTag(522826880,2,Cc.hja?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${rb}, is row ${this.isRow}`);
return}}this.$Q||this.SLh();fa.isRow&&this.isRow?(this.$Mc(!0,"onSelectionEnded"),this.$Q.style.top=ub.bottomRight.y-this.$Q.offsetHeight/2+"px"):fa.isRow||this.isRow||(this.$Mc(!0,"onSelectionEnded"),Ka.c(this.$Q.style,this.grid.rtl,ub.bottomRight.x-this.$Q.offsetWidth/2+"px"))}}}};this.HT=(fa,ub)=>{Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&xa.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${ub.fV}`);
ub.fV&&this.QBb()};this.nh=V;this.isRow=V.isRow;this.rtl=V.en.rtl;this.grid=Ma;this.UTf=this.isRow?Ba.a.hRd:Ba.a.sBc;this.lIi=Aa.a.instance.ia(436);this.uIi=Aa.a.instance.ia(435);this.oIi=Aa.a.instance.ia(437);nb.a(this.grid.$,fa=>{this.mPd=fa.KV(bb.a.$_j,!1)});this.rQj();this.grid.ha.KR(this.dk);this.grid.ha.xoa(this.dx);this.grid.Dw(this.dk);jb.a(this.grid.$).Jj.voa(this.HT)}get pWa(){return this.v3}get b0j(){this.pYh();return Cc.$mb}zsj(Ma){Sa.EwaSettings.QNb()&&!this.pWa&&this.s3i(Ma.pmb)&&this.nh.aNc(Ma.pmb,
!1)}Dsj(Ma,V){Sa.EwaSettings.QNb()&&!this.pWa&&this.nh.aNc(Ma.pmb,V)}bHa(Ma,V,fa){var ub=new Sys.UI.DomEvent(Ma);ub=oa.a.create(ta.a.TPa,this.domElement,ub,2);ub=qb.a(this.grid.$).Sh(ub);this.Ybg(V,ub.clientPoint.x,ub.clientPoint.y,!1,fa,Ma);Ma=this.wOc();this.Bvd(this.EJa,Ma,!0);this.CIa||(Ma=this.domElement.ownerDocument.body,Ma.addEventListener("pointermove",this.H2f),Ma.addEventListener("pointerup",this.I2f),this.CIa=!0)}ysj(Ma,V,fa){this.Ybg(V,Ma.clientX,Ma.clientY,!0,fa,Ma);Ma=this.grid;V=this.eAd(Ma);
V=kb.r(V,Ma.$);this.SNb?Ma.Se.Fl([this.isRow?51:52]):Ma.Se.Fl([this.isRow?13:14]);Ma.Se.hwa();this.fWb();Ma.$.Lf(this.isRow?146338636:1391094586,db.a.Ke,30,{["autoFitRanges"]:V})}dispose(){this.jid("dispose");this.grid.ha&&(this.grid.ha.ZT(this.dk),this.grid.ha.ela(this.dx));this.grid.qz(this.dk);jb.a(this.grid.$)&&jb.a(this.grid.$).Jj.$ua(this.HT);Za.a.instance.Da(ta.a.fo,this.domElement,this.ika);qa.a.instance.Da(ta.a.Hk,this.domElement.ownerDocument.body,this.rSb);Xa.a.instance.Da(ta.a.Uh,this.domElement.ownerDocument.body,
this.rSb);ha.a.Ht||(qa.a.instance.Da(ta.a.yg,this.domElement,this.lG),qa.a.instance.Da(ta.a.Yp,this.domElement,this.zN));this.CIa&&(qa.a.instance.Da(ta.a.Yp,this.domElement.ownerDocument.body,this.Jjb),Xa.a.instance.Da(ta.a.mk,this.domElement.ownerDocument.body,this.Jjb),this.CIa=!1);this.$Q&&(qa.a.instance.Da(ta.a.yg,this.$Q,this.lG),Za.a.instance.Da(ta.a.fo,this.$Q,this.ika),Cc.hja()?this.Tjg("dispose"):(this.jid(""),this.$Q=null));this.Ung&&(nc.DOMElementExtensions.Lj(Cc.$mb),Cc.$mb=null);this.nh=
null;super.dispose()}rQj(){Za.a.instance.va(ta.a.fo,this.domElement,this.ika);qa.a.instance.va(ta.a.Hk,this.domElement.ownerDocument.body,this.rSb);Xa.a.instance.va(ta.a.Uh,this.domElement.ownerDocument.body,this.rSb);ha.a.Ht||(qa.a.instance.va(ta.a.yg,this.domElement,this.lG),qa.a.instance.va(ta.a.Yp,this.domElement,this.zN))}pYh(){if(!Cc.$mb){document.getElementById(Cc.Tng);this.Ung=!0;var Ma=Cc.$mb=document.createElement("div");this.grid.$.frame.lba().appendChild(Ma);Ma.id=Cc.Tng;Ma.className=
aa.a.i2h;nc.DOMElementExtensions.setVisible(Ma,!1)}}s3i(Ma){return-1<=Ma?!0:!1}faf(){if(this.CIa){const Ma=this.domElement.ownerDocument.body;this.grid.Hl?(Ma.removeEventListener("pointermove",this.H2f),Ma.removeEventListener("pointerup",this.I2f)):(qa.a.instance.Da(ta.a.Yp,Ma,this.Jjb),Xa.a.instance.Da(ta.a.mk,Ma,this.Jjb));this.CIa=!1}this.v3=!1;Sa.EwaSettings.QNb()&&this.nh.aNc(this.Lk.pmb,!1);this.ETj();Qb.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}f1j(){this.SNb?this.tKd?
(this.tKd=!1,this.grid.Se.Fl(this.isRow?[49,51]:[50,52])):this.grid.Se.Fl(this.isRow?[51]:[52]):this.grid.Se.Fl([this.isRow?13:14]);this.grid.Se.hwa()}$$g(){this.nh.addRowColToModel(this.Lk.ayb-1,this.Lk.pmb);this.F2b=!0}IVd(Ma){if(!this.v3)return!1;const V=this.isRow;if(!this.grid.Hl&&!this.u8){this.u8=document.createElement("div");this.u8.style.cssText="position: relative; width: inherit; height: inherit;"+(V?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var fa=this.Lk.eK();fa.nextSibling;)this.u8.appendChild(fa.nextSibling);
fa.parentNode.appendChild(this.u8)}fa=V?Ma.y-this.Ahb.y:(this.rtl?-1:1)*(Ma.x-this.Ahb.x);const ub=V?Ma.y-this.EJa.y:(this.rtl?-1:1)*(Ma.x-this.EJa.x),rb=this.grid.Hl?this.wkb:this.Lk.rba();if(rb===Ba.a.NEa)return!1;fa&&(0<this.Io||0<rb+ub)&&rb+ub<=this.UTf&&(this.Io=this.wOc(ub),this.Bvd(Ma,this.Io,!1),this.grid.Hl?this.Io>=Cc.tzf?(this.Y5d=!0,this.Lk.setCellExtent(this.Io)):this.Y5d&&(this.Y5d=!1,this.Lk.setCellExtent(Cc.tzf)):(nc.DOMElementExtensions.exa(this.Lk.eK(),!V,Math.max(this.TXb+ub,0)),
this.u8.style[V?"top":this.rtl?"right":"left"]=Math.max(ub,-this.TXb)+"px"),fa=(this.grid.Hl?this.W9f:V?this.Lk.nh.rH:this.Lk.nh.sH)+Math.max(ub,this.grid.Hl?-this.wkb+Cc.qsc:-this.TXb),nc.DOMElementExtensions.exa(this.Lk.nh.domElement,!V,fa),this.grid.Hl&&this.Lk.nh.I8j(fa),this.Ahb=new Sys.UI.Point(Ma.x,Ma.y),this.$Mc(!1,"onHeaderResizeChangedInternal"));return!0}$Mc(Ma,V){var fa;nc.DOMElementExtensions.setVisible(this.$Q,Ma);Cc.hja()&&xa.ULS.sendTraceTag(508150752,2,50,`HeaderResizeBehavior.setTouchResizerVisible: called with visible: ${Ma}. caller:${V} isRow: ${this.isRow}, blockHash: ${null===
(fa=this.nh)||void 0===fa?void 0:fa.hashCode}`)}rba(){return this.Lk?this.y9?Cc.DIi:this.Lk.rba():Ba.a.NEa}Bvd(Ma,V,fa){this.ES&&fa&&(xa.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.Ljg());this.ES||fa||xa.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.mPd&&this.mPd(()=>({["Location"]:"canvas"}));
this.ES?this.Glf(V):(this.ES=document.createElement("div"),this.ES.id=this.qIi,this.Glf(V),this.ES.className=aa.a.k1h,V=document.getElementById(this.grid.$.Af+da.a.PVf),V.insertBefore(this.ES,V.firstChild),Ma=qb.a(this.grid.$).ura(Ma),this.ES.style.left=(this.rtl?Math.max(Ma.x-this.ES.offsetWidth,0):Ma.x-Math.max(Ma.x+this.ES.offsetWidth-V.offsetWidth,0)).toString()+"px",V=document.getElementById(da.a.tAa),this.ES.style.top=(Ma.y-(Fa.AFrameworkApplication.ra&&Fa.AFrameworkApplication.ra.Pa.Gh?0:V.offsetHeight)-
this.ES.offsetHeight).toString()+"px")}Ljg(){nc.DOMElementExtensions.Lj(this.ES);this.ES=null}Glf(Ma){var V=new xb(this.grid.$.workbookContext.DxDigitNormal);V=this.isRow?V.b1e(Ma).toFixed(2):V.P0e(Ma).toFixed(2);this.ES.innerText=`${this.isRow?this.lIi:this.uIi} ${V} (${Ma.toString()} ${this.oIi})`}Zbg(Ma,V){let fa;const ub=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===Ma.Te&&Ma.Ga.button!==Sys.UI.MouseButton.leftButton||!this.cMd(fa=this.syd(Ma))||!ub)return!1;Zb.g(Ma.Ga);
this.EJa=this.Ahb=new Sys.UI.Point(Ma.clientPoint.x,Ma.clientPoint.y);this.zsh(fa,V);if(!this.Lk)return!1;this.v3=!0;this.l0i(this.Lk,fa)&&this.DMi();this.TXb=this.uxd();return this.$bg(Ma.Ga.rawEvent,V)}Ybg(Ma,V,fa,ub,rb,hd){this.v3=!0;this.y9=rb;this.Lk=Ma;this.pRf("prepareResizeOperation");this.Zxc=!1;this.EJa=this.Ahb=new Sys.UI.Point(V,fa);Ma=this.Lk.getRange();this.GX=rb?this.ZNe(Ma):Ma;this.wkb=this.rba();this.W9f=this.isRow?this.Lk.nh.rH:this.Lk.nh.sH;this.$bg(hd,ub)}$bg(Ma,V){const fa=this.grid.Hl?
{["IsResizingHiddenHeader"]:this.y9,["IsAutoFitting"]:V,["NumberOfSelectedRanges"]:this.grid.ha.pa.wI,["Location"]:"canvas",["ResizeRange"]:this.GX,["ResizedCellAbsoluteIndex"]:this.Lk.ayb,["HeaderViewBlockHashCode"]:this.nh.hashCode}:{["IsResizingHiddenHeader"]:this.y9,["IsAutoFitting"]:V,["NumberOfSelectedRanges"]:this.grid.ha.pa.wI,["Location"]:"canvas"};nb.b(this.grid.$).Gg(bb.a.R_j,fa);this.grid.Sik&&(V=V?"header_resize_autofit":"header_resize_start",Tb.b(this.grid.$).pL(Ma,V,void 0));this.offset=
this.Lk.mia();this.Io=this.grid.Hl?this.wkb:this.Lk.rba();if(this.Io===Ba.a.NEa)return!1;Qb.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}l0i(Ma,V){var fa=this.Lk.eK();if(!fa)return xa.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;fa=fa.nextSibling;if(!fa)return!1;Ma=Ma.getRange();fa=this.nh.wDa(fa).getRange();if(!Ma||!fa)return xa.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ma=this.isRow?Ma.bottom:
Ma.right;fa=this.isRow?fa.bottom:fa.right;return Ma+1!==fa&&Ma!==fa&&this.cMd(V,!0)}DMi(){var Ma=this.Lk.eK();const V=this.nh.wDa(Ma.nextSibling);Cc.m0i(V,this.isRow)?(this.Lk=V,this.GX=this.Lk.getRange()):(this.aah(Ma),this.Lk=V,Ma=this.Lk.getRange(),this.GX=this.ZNe(Ma),this.y9=!0)}ZNe(Ma){return this.isRow?new Rb.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.right,!1,!0):new Rb.Range(Ma.top,Ma.left-1,Ma.bottom,Ma.left-1,!1,!0)}aah(Ma){const V=this.nh.wDa(Ma.nextSibling),fa=Cc.XHh(V,this.isRow,this.rtl);fa&&
Ma.parentNode.insertBefore(fa,V.eK())}eAd(Ma){const V=this.GX,fa=Ma.ha.pa.selectedRanges;if(Ma.ha.pa.hFb(V))if(this.isRow){if(La.a.all(fa,ub=>ub.isRow))return fa}else if(La.a.all(fa,ub=>ub.Ei))return fa;return[V]}getCellExtent(){return this.Lk.getCellExtent()}uxd(){const Ma=this.Lk.eK().style;return Math.max(0,Math.min(this.UTf,0|parseInt(this.isRow?Ma.height:Ma.width,10)))}wOc(Ma){Ma=void 0===Ma?0:Ma;const V=this.grid;var fa=this.nh.en.paneType;let ub;ub=this.isRow?3===fa?[3,2]:[1,4]:4===fa?[2,4]:
[1,3];var rb=Math.max(this.grid.Hl?this.wkb:this.Lk.rba(),0);rb=this.y9&&!this.grid.Hl?Math.max(this.uxd(),0):Math.max(rb+Ma,0);fa=V.ari(fa,this.isRow);fa=this.isRow?new S.a(0,this.offset,fa,rb):new S.a(this.offset,0,rb,fa);this.SNb?0===Ma?Ma=[this.isRow?51:52]:(this.tKd=!0,Ma=[this.isRow?49:50]):Ma=[this.isRow?13:14];V.Se.lo(new Rb.Range(1,1,Ba.a.oi,Ba.a.hi,!1,!0),Ma,!1);V.Se.Ys(Ma,fa,ub);return rb}jid(Ma){this.GX=this.EJa=this.Ahb=null;if(this.u8){const V=this.u8.parentNode;if(V)for(V.removeChild(this.u8);this.u8.firstChild;)V.appendChild(this.u8.firstChild);
this.u8=null}Cc.hja()?this.Lk&&(this.Lk=null,this.pRf("clearResizeState::"+Ma)):this.Lk=null;this.v3=!1}ETj(){this.Zxc=!1;this.Ljg();nc.DOMElementExtensions.setVisible(Cc.$mb,!1);this.$Mc(!1,"removeResizeArtifacts");this.f1j()}syd(Ma){if(nc.DOMElementExtensions.kI(Ma.rf,"a"))return null;const V=this.yLf(Ma.Ga);if(V&&this.grid.ha.pa.Fk){var fa=this.grid.ha.pa.og;fa=this.nh.Ow(Rb.Range.Pf(fa.bottom,fa.right))}else fa=this.nh.wDa(Ma.rf);if(!fa)return null;const ub=fa.eK(),rb=new Sys.UI.Bounds(ub.offsetLeft,
ub.offsetTop,ub.offsetWidth,ub.offsetHeight);var hd=nc.DOMElementExtensions.getBoundingClientRect(Ma.rf);hd=new Sys.UI.Point(Ma.clientPoint.x-hd.x,Ma.clientPoint.y-hd.y);this.isRow&&!V&&(hd.y+=Ea.HelperMethods.aI(Ma.rf,ub,this.rtl).y);return new ab(ub,hd,rb,fa.getRange(),Math.max(Cc.hfj,Math.min(Cc.dej,(this.isRow?rb.height:rb.width)*Cc.a0j)),V,!this.isRow&&0<ub.getElementsByTagName("input").length)}cMd(Ma,V){V=void 0===V?!1:V;if(!Ma||this.grid.De)return!1;if(Ma.xLf)return!0;var fa=Ma.Nta;const ub=
Ma.Zmb;var rb=this.nh.en.paneType,hd=this.grid.wi(rb).Xk,Eb=!!hd&&hd.top===Ma.vDd.top,kc=!!hd&&hd.left===Ma.vDd.left;rb=!!hd&&hd.bottom===Ma.vDd.bottom&&(3===rb||2===rb);this.isRow?(kc=Ma.eRb.y,Ma=kc<=ub&&!Eb,fa=kc>=fa.height-ub-(rb?Cc.Rci:0),V=V?Ma:fa||Ma):(rb=Ma.bHi,Eb=this.rtl,hd=Ma.eRb.x,Ma=hd<=ub&&(!kc||Eb)&&(!rb||!Eb),fa=hd>=fa.width-ub&&(!Eb||!kc)&&(!rb||Eb),V=V?Eb?fa:Ma:Ma||fa);return V}zsh(Ma,V){const fa=this.isRow;if(Ma.xLf)this.Lk=this.nh.wDa(Ma.rEa);else if(fa&&Ma.eRb.y<=Ma.Zmb&&Ma.Nta.height>
Ma.Zmb||!fa&&Ma.Nta.width>Ma.Zmb&&(!this.rtl&&Ma.eRb.x<=Ma.Zmb||this.rtl&&Ma.eRb.x>=Ma.Nta.width-Ma.Zmb)){if(this.Lk=Ma.rEa.previousSibling?this.nh.wDa(Ma.rEa.previousSibling):this.sqi(),V&&Ma.rEa.classList.contains(fa?aa.a.lgf:aa.a.kgf)&&(Ma=this.nh.wDa(Ma.rEa)))Ma=Ma.getRange(),this.GX=fa?new Rb.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.right,!1,!0):new Rb.Range(Ma.top,Ma.left-1,Ma.bottom,Ma.left-1,!1,!0)}else this.Lk=this.nh.wDa(Ma.rEa);!this.GX&&this.Lk&&(this.GX=this.Lk.getRange())}sqi(){var Ma=this.isRow?
1:0;return(Ma=this.nh.en.SG(this.nh.en.ya.sk(this.grid.$.na,W.a.aP(this.nh.position.X+Ma-1,this.nh.position.Y-Ma,this.nh.position.PaneType))))?Ma.rqi():null}GCf(){this.Zxc=!0;const Ma=this.b0j;nc.DOMElementExtensions.setVisible(Ma,!0);Ma.style.cursor=this.SNb?this.isRow?"ns-resize":"ew-resize":this.isRow?aa.a.rrd:aa.a.ard;this.wOc()}DXh(Ma){this.grid.$.Lf(this.isRow?745189930:-445963340,db.a.Ke,30,{["resizeRowColumnParameters"]:Ma})}SLh(){const Ma=document.createElement("div");Ma.className=aa.a.W2h;
const V=document.createElement("div");V.className=va.a.dS;Ma.appendChild(V);const fa=document.createElement("img");fa.src=zb.a.rk(0);fa.className=this.isRow?va.a.f2h:va.a.a2h;V.appendChild(fa);this.nh.SA.domElement.parentNode.insertBefore(Ma,this.nh.SA.domElement);this.grid.Hl?Ma.addEventListener("pointerdown",this.Csj):(qa.a.instance.va(ta.a.yg,Ma,this.lG),Za.a.instance.va(ta.a.fo,Ma,this.ika));nc.DOMElementExtensions.setVisible(Ma,!1);this.$Q=Ma}pRf(Ma){Cc.hja()&&!this.Lk&&xa.ULS.sendTraceTag(508368661,
2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${Ma}`)}fWb(){this.grid.Hl&&Cc.hja()&&!this.Lk||this.jid("removeResizer");this.Tjg("removeResizer")}Tjg(Ma){var V,fa,ub,rb;if(this.$Q){const hd=null===(ub=null===(fa=null===(V=this.nh)||void 0===V?void 0:V.SA)||void 0===fa?void 0:fa.domElement)||void 0===ub?void 0:ub.parentNode;Cc.hja()&&hd?hd.removeChild(this.$Q):this.nh.SA.domElement.parentNode.removeChild(this.$Q);this.$Q=null;Cc.hja()&&xa.ULS.sendTraceTag(508150751,
2,50,`HeaderResizeBehavior.removeTouchResizer: Touch resized removed. Was called from caller:${Ma}.isRow: ${this.isRow}, blockHash: ${null===(rb=this.nh)||void 0===rb?void 0:rb.hashCode}, is flowContainer define: ${!!hd}`)}}yLf(Ma){return nc.DOMElementExtensions.Ek(this.$Q,Ma.target)}QBb(){this.v3&&(this.grid.Hl&&this.IVd(this.EJa),this.faf(),this.grid.Hl||nc.DOMElementExtensions.exa(this.Lk.eK(),!this.isRow,this.TXb),this.fWb(),this.F2b=this.y9=!1)}uBf(Ma){(Ma=Ma.Ga.rawEvent)&&Ma.detail===Cc.p5j&&
(Ma.type===ta.a.Lt?(this.v3=!1,this.Bed=!0):Ma.type===ta.a.tN&&(this.v3=!0,this.Bed=!1))}static VHh(Ma,V){return new Cc(Ma,V)}static H$d(Ma,V,fa){if(V){Ma.ColumnWidth=-1;Ma.RowHeight=fa;for(const ub of Ma.SheetMultiRange.Ranges)ub.FirstColumn=0,ub.LastColumn=0}else{Ma.RowHeight=-1;Ma.ColumnWidth=fa;for(const ub of Ma.SheetMultiRange.Ranges)ub.FirstRow=0,ub.LastRow=0}}static m0i(Ma,V){if(!Ma||!Ma.eK())return xa.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const fa=Ma.getRange();
Ma=Ma.eK().style;if(!fa||!Ma)return xa.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ma=V?Ma.height:Ma.width;return(V?fa.top:fa.left)===(V?Ba.a.oi:Ba.a.hi)&&Ma===Cc.APg}static XHh(Ma,V,fa){if(!Ma)return xa.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var ub=Ma.eK();if(!ub||!ub.style)return xa.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;Ma=document.createElement("div");const rb=ub.style;Ma.style.top=V?rb.top:Cc.APg;
V||(fa?Ma.style.right=rb.right:Ma.style.left=rb.left);Ma.classList.add(V?za.h2h:za.g2h);Ma.classList.add(V?aa.a.pGb:aa.a.oGb);fa=document.createElement("div");fa.classList.add(V?aa.a.Qff:aa.a.dsd);ub=V?Number.parseInvariant(ub.innerText):Rb.Range.v$a(ub.innerText);fa.innerText=V?(ub-1).toString():Rb.Range.EV(ub-1);Ma.appendChild(fa);return Ma}static hja(){return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8257683_JSCrash_during_touch_resizeV2")}}Cc.hfj=0;Cc.dej=5;Cc.qsc=1;Cc.tzf=1;Cc.DIi=0;Cc.Rci=
3;Cc.a0j=.1;Cc.Tng="ewa-rszrbg";Cc.APg="0px";Cc.p5j=2;Cc.$mb=null;Object(ka.a)(Cc,"HeaderResizeBehavior",Na.a,[695]);class lb extends ia.a{constructor(){super();this.Dg()}create(){this.Df(Cc.VHh)}static ta(Ma){Ma.ja.$c(136,new lb)}}Object(ka.a)(lb,"HeaderResizeBehaviorFactory",ia.a,[]);var Ya=a(64),Hb=a(793),Lb=a(41),qc=a(203),mc=a(185),Ta=a(448),Va=a(395),Db=a(204),Ca=a(157),cb=a(241),hb=a(252),ya=a(66),Pa=a(19);class wb{constructor(Ma,V){this.isRow=!1;this.autoFitRange=null;this.isRow=Ma;this.autoFitRange=
V}}Object(ka.a)(wb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[124]);class Ib{constructor(Ma){this.resizeParameters=null;this.resizeParameters=Ma}}Object(ka.a)(Ib,"MacroRecorderSheetRowsColumnsResizedPayload",null,[124]);var pb=a(137),xc=a(300),ua=a(22),U=a(57);class na extends xc.a{constructor(Ma,V){super(Ma);this.HTa=(fa,ub)=>{fa=this.Eyd(fa,ub);return this.nvd(fa)};this.S_j=(fa,ub)=>{var rb=this.iOb=ub[na.WUi];1===fa?(fa=ub[na.$mk],rb=this.xvf(fa,rb),xa.ULS.shipAssertTag(537153996,0,rb!==
na.Pia,`ResizeHeadersDialogHandler - invalid size input, size = ${fa}`),fa=rb!==this.xFd,xa.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.iOb,rb,fa),fa&&this.xFh(rb)):xa.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===V.command;this.gridView=Pa.h(this.$);this.iKc=new xb(this.$.workbookContext.DxDigitNormal);this.xFd=
this.rth();Ma=this.eEh(this.xFd);V=this.gEh(this.xFd);this.eo=Aa.a.instance.ia(this.isRow?478:479);Ma=this.cI(Ma,V);this.initializeAndShow(this.eo,this.S_j,Ma);xa.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Cf(){return"ResizeHeadersDialog"}get iOb(){return na.vxe}set iOb(Ma){na.vxe=Ma}cI(Ma,V){return{[na.SM]:this.Cf,[na.B0i]:this.isRow,[na.eNi]:Ma,[na.dNi]:V,[na.TXi]:this.iOb,[na.Dyd]:this.HTa}}rth(){const Ma=this.fgi();try{return this.Lki(Ma)}finally{Ma&&
Ma.dispose()}}xFh(Ma){const V={};V.SheetMultiRange=kb.r(this.gridView.ha.pa.selectedRanges,this.$);na.H$d(V,this.isRow,Ma);this.$.Lf(this.isRow?745189930:-445963340,db.a.Ke,8,{["resizeRowColumnParameters"]:V})}xvf(Ma,V){return ua.a.fca(Ma)?V?this.dEh(Ma):this.fEh(Ma):na.Pia}fEh(Ma){return Math.floor(parseFloat(Ma))}dEh(Ma){Ma=parseFloat(Ma);return 0>Ma?na.Pia:Ma?this.isRow?Ea.HelperMethods.aFj(Ma):this.iKc.Yzh(Ma):0}gEh(Ma){return Ma===na.Pia?"":this.isRow?this.iKc.b1e(Ma).toString():this.iKc.P0e(Ma).toFixed(2)}eEh(Ma){return Ma===
na.Pia?"":Ma.toString()}Lki(Ma){if(!Ma||!Ma.$$mn()||!Ma.Np)return na.Pia;var V=Object(pb.a)(670,Ma.Np);if(!V)return na.Pia;for(V=this.isRow?V.cVa:V.vFd;Ma.$$mn();){const fa=Object(pb.a)(670,Ma.Np);if(fa&&(this.isRow?fa.cVa:fa.vFd)!==V)return na.Pia}return V}fgi(){const Ma=[];for(const fa of this.gridView.ha.pa.selectedRanges){const ub=fa.clone();var V=this.gridView.wi(this.gridView.Be.El(ub));V=ub.Bh(V.Xk);if(!V)return null;this.isRow?ub.right=ub.left=V.left:ub.top=ub.bottom=V.top;Ma.push(ub)}return Ma.length?
this.gridView.maa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ma):null}Eyd(Ma,V){if(!ua.a.fca(Ma))return 1;Ma=this.xvf(Ma,V);if(0===Ma){V=this.gridView.ha.pa.selectedRanges;const fa=this.gridView.vl("ResizeHeaderDialog");if(Object(U.d)(fa)){if(!fa.value.CVe(V,this.isRow))return 3}else if(this.k0i())return 3}return this.v3i(Ma)?0:2}k0i(){const Ma=this.gridView.ha.pa.selectedRanges;return this.isRow&&kb.U(Ma)||!this.isRow&&kb.T(Ma)}nvd(Ma){let V="";switch(Ma){case 0:V="";break;case 1:V=
Aa.a.instance.ia(767);break;case 2:V=String.format(Aa.a.instance.He(99),0,this.Sqc(this.iOb));break;case 3:V=Aa.a.instance.ia(768)}return V}v3i(Ma){return 0<=Ma&&Ma<=this.Sqc(!1)}Sqc(Ma){return this.iKc.Sqc(Ma,this.isRow)}static H$d(Ma,V,fa){if(V){Ma.ColumnWidth=na.Pia;Ma.RowHeight=fa;for(const ub of Ma.SheetMultiRange.Ranges)ub.FirstColumn=0,ub.LastColumn=0}else{Ma.RowHeight=na.Pia;Ma.ColumnWidth=fa;for(const ub of Ma.SheetMultiRange.Ranges)ub.FirstRow=0,ub.LastRow=0}}}na.SM="id";na.B0i="isRow";
na.eNi="initialSizeInPx";na.dNi="initialSizeInDefaultUnits";na.TXi="isInitialUnitsDefaultUnits";na.Dyd="getInputErrorIfInvalid";na.$mk="size";na.WUi="isDefaultUnits";na.Pia=-1;na.vxe=!0;Object(ka.a)(na,"ResizeHeadersDialog",xc.a,[]);var ob=a(59),bc=a(68),oc=a(303),Yb=a(155),Fc=a(33),ld=a(336),qd=a(102),fe=a(8),ge=a(146);let Wd=class{constructor(Ma,V,fa,ub){this.xwj=(rb,hd)=>{if(!cb.a(rb)&&hd){const Eb=!!rb&&!!rb.RequestTelemetryData;Pa.h(this.$).mj.Vja(hd,rb.StateId,Eb?rb.RequestTelemetryData.EcsOperationDuration:
0,Eb?rb.RequestTelemetryData.EcsRequestDuration:0,Eb?rb.RequestTelemetryData.WfeRequestDuration:0)}};this.gnj=(rb,hd)=>{Lb.TaskExtensions.Ca(bc.GetServiceTaskFactory.vf(this.$.ja,534,535,1),Eb=>{Eb.result.vyk(hd)},this.$.qa,3)};this.$=Ma;this.$h=V;this.gridInstantaneousAction=fa;this.grid=Pa.h(this.$);this.JJb=ub}Uf(Ma,V){Ma=!0;switch(V){case -445963340:case 1391094586:Ma=this.hh(8);break;case 745189930:case 146338636:Ma=this.hh(16)}return!Ma}executeCommand(Ma,V,fa){var ub=Pa.h(this.$);const rb=V.command;
var hd=mc.a.create().toString();let Eb=Lb.TaskExtensions.Om();switch(rb){case 1391094586:case 146338636:Ma=1391094586===rb;(hd=fa.autoFitRanges)&&hd.Ranges&&hd.Ranges.length||(hd=kb.r(ub.ha.pa.selectedRanges,this.$));Eb=this.jTh(Ma?1:0,hd,V);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ma=-445963340===rb||-706918724===rb||369708605===rb;var kc=Sa.EwaSettings.WMb()||Sa.EwaSettings.XMb(),zc=Sa.EwaSettings.Nwc();(kc&&-706918724===rb||zc&&1051390410===
rb)&&ub.mj.l8(18,hd,Ta.a(rb));if(-445963340===rb||745189930===rb){var Nc=Ta.a(V.command);ub.mj.l8(16,hd,Nc);ub=fa.resizeRowColumnParameters}else{fa=Sa.EwaSettings.zLf()&&(369708605===rb||1542466017===rb)&&fa.rangeToUnhide?[fa.rangeToUnhide]:ub.ha.pa.selectedRanges;kc=0;zc=!1;let Ee="",He=!1;const gd=Sa.EwaSettings.QMb();gd&&(Ee=Ta.a(V.command),zc=1<fa.length?!0:!1);for(var Fd of fa){if(gd&&this.JJb){var Xd=this.grid.ya.x5(Fd);this.JJb.qad(Xd,Ee)}if(-706918724===rb||369708605===rb)Xd=Fd.right-Fd.left+
1,kc+=0<Xd?Xd:-1*Xd;else if(1542466017===rb||1051390410===rb)He=!0,kc+=Fd.bottom-Fd.top+1}gd&&this.JJb&&(this.JJb.oLe(kc,Ee),this.JJb.qKe(Ee,He,kc,fa[0]));if(369708605===rb||1542466017===rb){if(xa.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${kc}, isDiscontinuous=${zc}`),Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8373854_LogUnhideButtonClickOnNoHiddenRangePresent")){kc=Fd=!1;zc=this.grid.vl("ResizeCmdHandler");if(Object(U.d)(zc)){zc=zc.value;
for(var ie of fa)if(Fd=ie.isRow&&zc.cyc(ie),kc=ie.Ei&&zc.Gvc(ie),Fd||kc)break}Fd||kc||xa.ULS.sendTraceTag(508061769,0,50,"ResizeCommandHandler.doResize: unhide Rows/Columns clicked when no hidden range in selected range")}}else-706918724!==rb&&1051390410!==rb||xa.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${kc}, isDiscontinuous=${zc}`);if(!Object(U.d)(ub.vl("ResizeCmdHandler"))){if(-706918724===rb&&6===V.Ch&&kb.T(fa)){xa.ULS.sendTraceTag(537154007,
0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===rb&&6===V.Ch&&kb.U(fa)){xa.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}ie=369708605===rb||1542466017===rb?-2:0;ub={};ub.SheetMultiRange=kb.r(fa,this.$);if(Ma)for(Nc of ub.SheetMultiRange.Ranges)Nc.FirstRow=0,Nc.LastRow=0;else for(const Bd of ub.SheetMultiRange.Ranges)Bd.FirstColumn=
0,Bd.LastColumn=0;ub.RowHeight=Ma?-1:ie;ub.ColumnWidth=Ma?ie:-1}Eb=this.FTh(ub,V,hd,Ma);break;case 957527587:case 2040891415:Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===V.tabName&&qd.b("HomeTabFormat"),new na(this.$,V)}return Eb}Kf(Ma,V,fa,ub){if(Ma=!!fa&&!!ub&&1===ub.UD)switch(V.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ma=
!1}return Ma}Yf(){return!1}k$i(Ma){xa.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(oc.c)(Ma)}. Reason: ${Object(oc.c)(Ma)?void 0:Ma.reason}.`)}hh(Ma){return(new Ca.a(this.$.sa)).hh(Ma)}jTh(Ma,V,fa){const ub=this.$.oa.ua.qf(),rb=0===Ma,hd=()=>new wb(rb,V);return Va.a(this.$.userOperationManager,(Eb,kc,zc)=>{var Nc=this.$.oa.ua;Eb=hb.b(Eb,this.gnj);var Fd={fUi:!rb,FAb:V};const Xd=Nc.Oa(41,ub);Xd.isRow=rb;Xd.autoFitRanges=V;return ob.h(Nc,
"AutoFit",Xd,Eb,kc,zc,Fd,0)},Eb=>new Db.a(135,0,Eb,void 0,hd),fa)}FTh(Ma,V,fa,ub){const rb=V.command,hd=Pa.h(this.$),Eb=kb.g(Ma.SheetMultiRange.Ranges);if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var kc=1051390410===rb||745189930===rb&&0===Ma.RowHeight,zc=-706918724===rb||-445963340===rb&&0===Ma.ColumnWidth;const ie=hd.vl("ResizeCmdHandler");if((kc||zc)&&Object(U.d)(ie)&&!ie.value.CVe(Eb,!ub))return this.pSh(ub),Lb.TaskExtensions.Om()}let Nc;kc=(Sa.EwaSettings.WMb()||
Sa.EwaSettings.XMb())&&-706918724===rb;zc=Sa.EwaSettings.Nwc()&&1051390410===rb;if(745189930===rb||-445963340===rb||kc||zc)xa.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ma.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),kc||zc?(this.gridInstantaneousAction.ehg(),Object(Yb.d)(()=>{hd.mj.KXa();this.gridInstantaneousAction.VRe(rb,!ub)},this.$.qa,0)):(Nc=this.$h.Bce(hd,Eb,ub?Ma.ColumnWidth:Ma.RowHeight,!ub),this.k$i(Nc),Object(oc.c)(Nc)&&hd.mj.nU(fa,
ya.BasicTelemetryCalculator.KS));const Fd=this.$.oa.ua.qf({wta:!0,ksa:3});kc=(ie,Ee,He)=>{this.$.PB();kb.i(Eb,",",this.$,!1);var gd=this.$.oa.ua;ie=hb.b(ie,this.xwj);const Bd=gd.Oa(41,void 0===Fd?null:Fd);Bd.resizeRowColumnParameters=Ma;return ob.h(gd,"ResizeRowsColumns",Bd,ie,Ee,He,fa,0)};const Xd=()=>new Ib(Ma);return Nc&&Object(oc.c)(Nc)?Va.a(this.$.userOperationManager,kc,ie=>new Db.a(136,0,ie,64,Xd),V):Va.a(this.$.userOperationManager,kc,ie=>new Db.a(136,0,ie,void 0,Xd),V)}pSh(Ma){Ma=Fc.a.Fg(1,
0,Ma?769:771,Ma?770:772,0,Ma?-2037763134:503471870,Ma?"HideAllColumnsError":"HideAllRowsError");new ld.a(this.$,Ma)}};Wd=Object(qc.__decorate)([Object(ge.d)(fe.Ad),Object(qc.__param)(0,Object(fe.nb)()),Object(qc.__param)(1,Object(fe.Db)()),Object(qc.__param)(2,Object(fe.Zb)()),Object(qc.__param)(3,Object(fe.Wb)())],Wd);Object(ka.a)(Wd,"ResizeCommandHandler",null,[165]);var Zd=a(94);class ke extends Hb.a{constructor(Ma){super(Ma)}lj(){const Ma=Object(Zd.d)(ge.a.resolve(fe.Db,{Aa:this.$a}));let V;V=
Sa.EwaSettings.WMb()||Sa.EwaSettings.Nwc()?Object(Zd.d)(ge.a.resolve(fe.Zb,{Aa:this.$a})):Ya.Task.Ra(null);let fa;fa=Sa.EwaSettings.QMb()?Object(Zd.d)(ge.a.resolve(fe.Wb,{Aa:this.$a})):Ya.Task.Ra(null);Lb.TaskExtensions.Ca(Lb.TaskExtensions.Dh([Ma,fa],this.qa),()=>{this.Gi([new Wd(this.$,Ma.result,V.result,fa.result)])},this.qa,3)}static ta(Ma){Hb.a.Kk(113,new ke(Ma))}}Object(ka.a)(ke,"ResizeCommandHandlerFactory",Hb.a,[]);var ne=a(98),se=a(1014);class Cb{constructor(Ma,V,fa){this.sMb=!0;this.Zg=
Ma;this.uda=V;this.sMb=fa||Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8453101_deleteRowsRefUpdate")}NFk(Ma,V,fa,ub){if(Ma){var rb=Ma.includes(this.uda);if(!this.Zg)return{isRefError:Ma.includes(this.uda),newFormula:Ma};var hd=this.Zg.Lsd(Ma);if(hd){var Eb=0>fa||0>V,kc=[];for(const ye of hd)switch(hd=ye.ref,hd.type){case se.a.cell:var zc=hd,Nc=zc.row,Fd=zc.col;hd="Abs"===Nc.kind;var Xd="Abs"===Fd.kind;Nc=Nc.index+1;Fd=Fd.index+1;var ie=Rb.Range.Pf(Nc,Fd);zc=zc.span;if(Eb&&m(ub,ie)){kc.push({value:this.uda,
start:zc.start,end:zc.end});rb=!0;break}var Ee=0===fa?!0:ie.left<ub.right;ie=0===V?!0:ie.bottom<ub.top;if(Ee&&ie)break;Nc=ie?Nc:Nc+V;Fd=Ee?Fd:Fd+fa;if(!c(Nc)||!b(Fd)){kc.push({value:this.uda,start:zc.start,end:zc.end});rb=!0;break}hd=Rb.Range.Pf(Nc,Fd).K5(Xd,hd,Xd,hd);kc.push({value:hd,start:zc.start,end:zc.end,wFa:this.Zg.vQa(zc.end,Ma)});break;case se.a.column:if(!fa)break;Fd=hd;Xd=Fd.startIndex;Nc=Fd.endIndex;zc=Xd.index+1;hd=Nc.index+1;Xd="Abs"===Xd.kind;Nc="Abs"===Nc.kind;ie=Rb.Range.Uqa(zc,
hd);Fd=Fd.span;if(Eb&&m(ub,ie)){kc.push({value:this.uda,start:Fd.start,end:Fd.end});rb=!0;break}Ee=ie.left<ub.left;ie=ie.right<ub.left;if(Ee&&ie)break;zc=Ee?zc:zc+fa;var He=ie?hd:hd+fa;Eb&&0<=He-zc&&1>zc&&(zc=1);this.sMb&&0>fa&&Ee&&!ie&&ub.right>hd&&1<=ub.left-1&&(He=ub.left-1);if(!b(zc)||!b(He)){kc.push({value:this.uda,start:Fd.start,end:Fd.end});rb=!0;break}hd=Rb.Range.Uqa(zc,He).K5(Xd,!1,Nc,!1);kc.push({value:hd,start:Fd.start,end:Fd.end});break;case se.a.row:if(!V)break;Nc=hd;Fd=Nc.startIndex;
zc=Nc.endIndex;hd="Abs"===Fd.kind;Xd="Abs"===zc.kind;Fd=Fd.index+1;zc=zc.index+1;ie=Rb.Range.Wqa(Fd,zc);Nc=Nc.span;if(Eb&&m(ub,ie)){kc.push({value:this.uda,start:Nc.start,end:Nc.end});rb=!0;break}Ee=ie.top<ub.top;ie=ie.bottom<ub.top;if(Ee&&ie)break;Fd=Ee?Fd:Fd+V;He=ie?zc:zc+V;Eb&&0<=He-Fd&&1>Fd&&(Fd=1);this.sMb&&0>V&&Ee&&!ie&&ub.bottom>zc&&1<=ub.top-1&&(He=ub.top-1);if(!c(Fd)||!c(He)){kc.push({value:this.uda,start:Nc.start,end:Nc.end});rb=!0;break}hd=Rb.Range.Wqa(Fd,He).K5(!1,hd,!1,Xd);kc.push({value:hd,
start:Nc.start,end:Nc.end});break;case se.a.range:var gd=hd;zc=gd.top;Fd=gd.left;Ee=gd.bottom;ie=gd.right;var Bd=zc.index+1;Nc=Fd.index+1;hd=Ee.index+1;Xd=ie.index+1;zc="Abs"===zc.kind;Fd="Abs"===Fd.kind;Ee="Abs"===Ee.kind;He="Abs"===ie.kind;var ue=new Rb.Range(Bd,Nc,hd,Xd,!1,!1);ie=gd.topLeftSpan;gd=gd.bottomRightSpan;if(Eb&&m(ub,ue)){kc.push({value:this.uda,start:ie.start,end:gd.end});rb=!0;break}const Ue=0===V?!0:ue.top<ub.top,Sb=0===fa?!0:ue.left<ub.left,cd=0===V?!0:ue.bottom<ub.top;ue=0===fa?
!0:ue.right<ub.left;if(Ue&&Sb&&cd&&ue)break;let Xc=Ue?Bd:Bd+V;Bd=cd?hd:hd+V;let fd=Sb?Nc:Nc+fa;Nc=ue?Xd:Xd+fa;this.sMb&&0>V&&Ue&&!cd&&ub.bottom>hd&&1<=ub.top-1&&(Bd=ub.top-1);this.sMb&&0>fa&&Sb&&!ue&&ub.right>Xd&&1<=ub.left-1&&(Nc=ub.left-1);Eb&&0<=Bd-Xc&&1>Xc&&(Xc=1);Eb&&0<=Bd-fd&&1>fd&&(fd=1);b(fd)&&c(Xc)?b(Nc)&&c(Bd)?(hd=Rb.Range.Pf(Xc,fd).K5(zc,Fd,!1,!1),Xd=Rb.Range.Pf(Bd,Nc).K5(Ee,He,!1,!1),kc.push({value:hd,start:ie.start,end:ie.end,wFa:this.Zg.vQa(ie.end,Ma)}),kc.push({value:Xd,start:gd.start,
end:gd.end,wFa:this.Zg.vQa(gd.end,Ma)})):(kc.push({value:this.uda,start:gd.start,end:gd.end}),rb=!0):(kc.push({value:this.uda,start:ie.start,end:ie.end}),rb=!0)}return{newFormula:k(Ma,kc),isRefError:rb}}}}dispose(){this.Zg=null}}Object(ka.a)(Cb,"GridReferenceUpdate",null,[2]);var ib=a(218),ac;(function(Ma){Ma.Hide="Hide";Ma.Unhide="Unhide";Ma.Insert="Insert";Ma.Delete="Delete"})(ac||(ac={}));Object(ka.b)("GridInstantaneousOperation",ac);let Lc=null,ad=!1,te=class{constructor(Ma,V,fa){this.$=Ma;this.Zg=
V;this.$h=fa;this.zVb="!REF#";this.zl=()=>{Lc&&(ne.a.Sa(Lc),Lc=null);this.Isa&&(this.$.CId=!1)};this.N4f=()=>{this.zVb=this.Puc.gi.ErrorNames[3];this.$Bd=new Cb(this.Zg,this.zVb)};this.gridView=Pa.h(this.$);this.ya=this.gridView.ya;this.gWa=!1;this.Dmd=this.$.ea.uh;this.hXb={};this.MS={};this.Uga={};this.Isa=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GlobalStylesSlice1",!1);this.ya.Uu(this.zl);this.aVi=Sa.EwaSettings.FVa();this.cYi=Sa.EwaSettings.lFa();this.$Xi=Sa.EwaSettings.jFa();
this.$Ui=Sa.EwaSettings.rMb();(this.kFa=this.$Xi||this.cYi||this.aVi||this.$Ui)&&this.$.ja.Ne(268,ub=>{this.Puc=ub;ub.gi?(ub.gi.ErrorNames&&3<ub.gi.ErrorNames.length&&(this.zVb=ub.gi.ErrorNames[3]),this.$Bd=new Cb(this.Zg,this.zVb)):this.Puc.Gbd(this.N4f)});ad=Sa.EwaSettings.BOb()}dispose(){this.gridView=this.$=null;this.MS={};this.gWa=!1;this.hXb={};this.ya.Ot(this.zl);this.Puc&&this.Puc.jJc(this.N4f)}VRe(Ma,V,fa){if(this.gWa)xa.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${Ma}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=${V}`);
else{var ub=this.ya.Jmf(),rb=n(ub,V,Ma);this.MS={};this.kFa&&(this.Uga={},this.fmb=0,this.mhc=fa);this.dYi(Ma,ub,rb,V)?(this.gWa=!0,this.$.CId=!0,this.vdg(Ma,V,rb,ub)):this.gridView.mj.KXa(!1)}}ehg(){this.Dmd=this.$.ea.uh}dYi(Ma,V,fa,ub){const rb=this.gridView;if(!u(Ma))return!1;if(rb.rtl)return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8249176_HideColumnRtlLogEnabled")&&xa.ULS.sendTraceTag(508171339,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = hasRtl, value=true, isRow=${ub}`),
!1;if(rb.Be.BS)return xa.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = hasPanes, value=true, isRow=${ub}`),!1;var hd=rb.vl("GridInstantaneousAction");if(!Object(U.d)(hd))return xa.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = ActiveSheetProcessedData, value=null, isRow=${ub}`),!1;var Eb=rb.ha.pa.selectedRanges,kc=Eb[0],zc=Eb.length;if(1<zc)return xa.ULS.sendTraceTag(509658007,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = SelectedRanges, value=${zc}, reason = Discontinuous selection, isRow=${ub}`),!1;var Nc=Sa.EwaSettings.lFa()&&-1113896058===Ma;zc=Sa.EwaSettings.jFa()&&1415868706===Ma;if(Nc||zc){if(Nc){if(1!==kc.top){var Fd=new Rb.Range(kc.top-1,kc.left,kc.top-1,kc.right,!1,!1);Fd=hd.value.cyc(Fd)}}else 1!==kc.left&&(Fd=new Rb.Range(kc.top,kc.left-1,kc.bottom,kc.left-1,!1,!1),Fd=hd.value.Gvc(Fd));if(Fd)return xa.ULS.sendTraceTag(508072654,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = isPreviousRowColHidden, value=true, isRow=${ub}`),!1;var Xd;a:{for(const gd of fa){if(Sa.EwaSettings.nca()){if(!gd.source)continue}else if(!gd.source)break;Fd=null===(Xd=gd.source)||void 0===Xd?void 0:Xd.Mg;if(!Fd){J("isFirstRowColOfNonInitialModel",Ma);break}if(Fd.Zf(kc)){Xd=!1;Nc?1!==Fd.top&&kc.top===Fd.top&&(Xd=!0):1!==Fd.left&&kc.left===Fd.left&&(Xd=!0);break a}}Xd=!0}if(Xd)return xa.ULS.sendTraceTag(508065493,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = isFirstRowColInNonInitialModel, value=true, isRow=${ub}`),!1}if(hd.value.qgb(kc))return xa.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = isPartOfRangeHidden, value=true, isRow=${ub}`),!1;hd=ub?kc.bottom-kc.top+1:kc.right-kc.left+1;if(Sa.EwaSettings.XMb()?hd>Sa.EwaSettings.udj():hd>Sa.EwaSettings.vdj())return xa.ULS.sendTraceTag(508409418,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = rowColCount, value=${hd}, reason = rowColCount is higher than the limit, isRow=${ub}`),!1;if(Nc&&(Nc=rb.usedRange.bottom+hd,Nc>Ba.a.rB))return xa.ULS.sendTraceTag(508061699,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = newRowCount, value=${Nc}, reason = newRowCount is higher than the MaxRows, isRow=${ub}`),!1;if(zc&&(zc=rb.usedRange.right+hd,zc>Ba.a.eA))return xa.ULS.sendTraceTag(508061698,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = newColCount, value=${zc}, reason = newColCount is higher than the MaxRows, isRow=${ub}`),!1;if(z(kc,fa,Ma))return xa.ULS.sendTraceTag(508404044,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = isSelectedRangeAcrossBlocks, value=true, isRow=${ub}`),!1;if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8489943_CSEOnTablesDisabled")&&!this.cuh(kc,Ma))return xa.ULS.sendTraceTag(507855194,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = selectedRangeContainingTable, value=true, isRow=${ub}`),!1;V=V.length;if(V>Sa.EwaSettings.tdj())return xa.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = BlocksInViewport, value=${V}, reason = Blocks in viewport limit exceeded, isRow=${ub}`),!1;a:{V=hd-1;for(ie of fa){if(!ie){xa.ULS.sendTraceTag(509649925,0,50,`GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null and command=${Ma}`);
var ie=!1;break a}zc=ie.source;if(!Sa.EwaSettings.nca()||zc){if(!Sa.EwaSettings.nca()&&!zc){ie=!1;break a}zc=zc.gh.GridBlockModel;hd=v(zc,V,ub,Ma);if(!F(zc,hd,V,ub)){ie=!1;break a}}}ie=!0}if(!ie)return xa.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=${ub}`),!1;a:{ie=ub?kc.top:kc.left;V=ub?kc.bottom-kc.top:kc.right-kc.left;kc=this.ya.qDa(kc,this.$.activeItemName);
for(Ee of kc)if(!F(Ee.gh.GridBlockModel,ie,V,ub)){var Ee=!1;break a}Ee=!0}if(!Ee)return xa.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=${ub}`),!1;a:{Eb=Eb[0];Ee=0;for(He of fa)if(!Sa.EwaSettings.nca()||He.source&&He.destination){if(!(Sa.EwaSettings.nca()||He.source&&He.destination))break;ie=He.destination.Mg;kc=He.source.Mg;if(null===
ie||null===kc){J("getTransitionCount source or destination block range is null",Ma);var He=Sa.EwaSettings.cRd()+1;break a}if(!ie&&Sa.EwaSettings.Mwc()){J("getTransitionCount",Ma);He=Sa.EwaSettings.cRd()+1;break a}V=Eb;(kc=369708605===Ma||1415868706===Ma||1542466017===Ma||-1113896058===Ma?kc.Zf(V):ie.Zf(V))||(kc=Ma,zc=He,ie=Eb,!Sa.EwaSettings.nca()||zc.source&&zc.destination?(V=zc.source.Mg,zc=zc.destination.Mg,!Sa.EwaSettings.Mwc()||zc&&V?kc=-706918724===kc||674605324===kc?zc.left>ie.right:369708605===
kc||1415868706===kc?V.left>ie.right:1051390410===kc||1554436520===kc?zc.top>ie.bottom:V.top>ie.bottom:(J("shouldPerformTransitions",kc),kc=!1)):kc=!1);kc&&(Ee+=1)}He=Ee}if(He>Sa.EwaSettings.cRd())return xa.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = TransitionCount, value=${He}, reason = Transition count limit exceeded, isRow=${ub}`),!1;if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8043178_HideColumnBugFixes")&&w(rb,fa,Ma))return xa.ULS.sendTraceTag(508564123,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=${ub}`),!1;xa.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${Ma}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=${ub}`);return!0}vdg(Ma,V,fa,ub){try{if(u(Ma)){var rb=Ea.HelperMethods.Ze(),hd=Sa.EwaSettings.bRd(),Eb=fa.filter(Xd=>!Xd.F0),
kc=this.gridView.ha.pa.selectedRanges[0],zc=V?kc.bottom-kc.top:kc.right-kc.left,Nc=I(Ma);for(const Xd of Eb){if(this.Pac("WebServiceResponseReceivedInProcessGridAction",ub,Ma,V))return;if(this.kFa){if(!d(Xd,kc,Ma,V))continue}else{const Bd=Xd.destination.Mg;if(!Bd){J("processGridAction",Ma);return}if(Bd.right<kc.left){Xd.F0=!0;xa.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${Ma}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${kc.left}, blockRangeRightMostValue=${Bd.right}, hashCode=${Xd.destination.Eg}, isRow=false`);
continue}}const ie=V?kc.topLeft.top:kc.topLeft.left;let Ee,He;Sa.EwaSettings.nca()?(Ee=Xd.source?this.xpc("SourceModel",Xd.source,Ma):null,He=Xd.destination?this.xpc("DestinationModel",Xd.destination,Ma):null):(Ee=this.xpc("SourceModel",Xd.source,Ma),He=this.xpc("DestinationModel",Xd.destination,Ma));const gd=Xd.destination?Xd.destination.Eg:Xd.source.Eg;if(R(Xd,Ma,kc)){if(!h(Nc===ac.Hide||Nc===ac.Delete?He:Ee,ie,zc,Nc,V,Ma)){this.Rza();xa.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${Ma}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${gd}, isRow=${V}, rowColNumber=${ie}`);
return}xa.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${Ma}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${gd}, isRow=${V}, rowColNumber=${ie}`)}if(Ee&&He){let Bd;Bd=this.kFa?v(Ee,zc,V,Ma):Ee.ColumnNumbers[0];const ue=Xd.source.Eg;if(t(Ee,He,Bd,zc,Nc,V,Ma).isSuccess)Xd.F0=!0,xa.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${Ma}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${ue}, isRow=${V}, rowColNumber=${Bd}`);
else{this.Rza();xa.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${Ma}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${ue}, isRow=${V}, rowColNumber=${Bd}`);return}}else Xd.F0=!0;this.$qk(He,Ee,Xd);if(Ea.HelperMethods.Ze()-rb>hd){this.n4j(Ma,V,Eb,ub);return}}fa=()=>{try{this.UAh(V,Ma,ub,kc),x("ProcessGridAction",Ea.HelperMethods.Ze()-rb,Ma)}catch(Xd){this.xxf(Xd,Ma)}};if(this.kFa&&this.mhc&&this.mhc.InsertDeleteRangeItems&&
0<this.mhc.InsertDeleteRangeItems.length)if(this.$Bd){var Fd=this.mhc.InsertDeleteRangeItems[0];this.PLg(ub,Ma,V,(Xd,ie)=>0!==Fd.DeltaRow?Xd>=kc.top:0!==Fd.DeltaColumn?ie>=kc.left:!1,Xd=>this.$Bd.NFk(Xd,Fd.DeltaRow,Fd.DeltaColumn,kc),fa)}else this.gWa=!1,this.gridView.mj.KXa(!1),xa.ULS.sendTraceTag(508063873,0,15,`GridInstantaneousAction:processGridAction gridReferenceUpdates is null command=${Ma}`);else fa()}else this.gWa=!1,this.gridView.mj.KXa(!1)}catch(Xd){this.xxf(Xd,Ma)}}UAh(Ma,V,fa,ub){if(!this.Pac("CommitGridInstantaneousActionResults",
fa,V,Ma)){var rb=Ea.HelperMethods.Ze();if(this.MS&&0!==Object.keys(this.MS).length){if(Y(V))for(var hd=0;hd<fa.length;hd++){var Eb=fa[hd].Eg;Eb&&(Eb=this.MS[Eb])&&gridRenderer.CanvasRendererGlobals.removeExtraModelRowCol(Eb)}this.tFj(fa);if(Y(V)||K(V)){hd=this.gridView.usedRange;for(var kc of fa)kc.KJ=4,this.Vfk(kc,hd,ub,Ma,V)&&(this.MS[kc.Eg]=null)}if(this.kFa&&this.Uga)for(var zc in this.Uga)ub=this.Uga[zc],(kc=ub.gIj)&&ub.gHd&&this.$h.Ggc(kc.range,!0);this.xTg(V,fa)?(zc=mc.a.create().toString(),
ub=this.gridView.vl("GridInstantaneousAction"),Object(U.d)(ub)?(ub.value.dTc(this.gridView.ha.pa.selectedRanges,0,Ma),ub=Object.keys(this.MS),this.ya.F0d(ub,zc,Ma?"row":"column",!0,V),this.gWa=!1,Lc=jb.a(this.$).Jj.GOa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,Aa.a.instance.ia(2188)),x("CommitGridInstantaneousActionResults",Ea.HelperMethods.Ze()-rb,V),this.kFa&&this.Uga&&window.setTimeout(()=>{this.Pac("commitGridInstantaneousActionResults",fa,V,Ma)||this.P6j()},Sa.EwaSettings.bRd())):
(this.hog(fa),this.Rza(),xa.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${V}, parameter = ActiveSheetProcessedData, value=null, isRow=${Ma}`))):(this.hog(fa),this.Rza())}else this.Rza(),xa.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${V}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${Ma}`)}}P6j(){const Ma=[];for(const fa in this.Uga){const ub=this.Uga[fa];
if(!ub.gHd){var V=Rb.Range.Pf(ub.rowNum,ub.colNum);(V=this.gridView.Pe(V))&&Ma.push({zha:V,editText:ub.cellText})}}0<Ma.length&&this.$h.Ush(Ma)}xpc(Ma,V,fa){let ub=this.MS[V.Eg];if(!ub){const rb=Ea.HelperMethods.zK(()=>{ub=V.vji()});x(Ma,rb,fa)}return ub}tFj(Ma){for(const V of Ma)Ma=V.Eg,this.hXb[Ma]||(this.hXb[Ma]=V.kJb())}hog(Ma){for(const V of Ma){Ma=V.Eg;const fa=this.hXb[Ma];if(fa&&!V.Ylg(fa)){xa.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${Ma}`);
this.Rza();break}}}xTg(Ma,V){for(const fa of V)if(V=fa.Eg,this.MS[V]){if(!fa.Ylg(this.MS[V]))return xa.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${Ma}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${V}, isRow=false`),!1;ad&&(fa.WQd=!0)}return!0}n4j(Ma,V,fa,ub){window.setTimeout(()=>{this.vdg(Ma,V,fa,ub)},0)}W2i(Ma){for(const V of Ma)if(V.gh.Information.Revision>this.Dmd)return!0;return!1}Pac(Ma,V,
fa,ub){return this.W2i(V)?(this.Dmd=this.$.ea.uh,this.Rza(),xa.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${fa}, parameter = ${Ma}, value=true, reason = "Server response received before completing client side estimation", isRow=${ub}}`),!0):!1}Rza(){this.MS={};this.gWa=!1;this.hXb={};this.gridView.mj.KXa(!1);this.kFa&&(this.fmb=0,this.Uga={})}xxf(Ma,V){this.Rza();xa.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${Ma} for command=${V}`)}$qk(Ma,
V,fa){Ma&&(this.MS[fa.destination.Eg]=Ma);V&&(this.MS[fa.source.Eg]=V)}Vfk(Ma,V,fa,ub,rb){const hd=ub?Ma.Mg.top>V.bottom:Ma.Mg.left>V.right;V=this.MS[Ma.Eg];if(!V)return!1;if(Ma=(ub?fa.top>Ma.Mg.bottom:fa.left>Ma.Mg.right)||hd){if(0<V.Cells.length)return!1;if(Y(rb)?ub?28<V.RowNumbers.length:30<V.ColumnNumbers.length:ub?28>V.RowNumbers.length:30>V.ColumnNumbers.length)return!0}return Ma}PLg(Ma,V,fa,ub,rb,hd){if(!this.Pac("updateReferenceForBlocks",Ma,V,fa))if(Ma.length-1===this.fmb)hd();else{for(var Eb=
Ea.HelperMethods.Ze();Ea.HelperMethods.Ze()-Eb<Sa.EwaSettings.bRd()&&Ma.length-1>=this.fmb;){var kc=Ma[this.fmb].Eg;this.fmb++;var zc=this.dti(kc);zc=gridRenderer.CanvasRendererGlobals.getChangedCells(zc,ub);for(const Nc of zc)zc=Rb.Range.Pf(Nc.rowNum,Nc.colNum),zc=this.gridView.Pe(zc),this.Uga[Nc.rowNum+"|"+Nc.colNum]=Object.assign({},Nc,{gHd:!0,gIj:zc});kc=gridRenderer.CanvasRendererGlobals.updateReferenceUpdateForModel(this.MS[kc],this.zVb,ub,rb);for(const Nc of kc)this.Uga[Nc.rowNum+"|"+Nc.colNum]=
Object.assign({},Nc,{gHd:!1})}Ma.length-1>this.fmb?window.setTimeout(()=>{this.PLg(Ma,V,fa,ub,rb,hd)},0):hd()}}dti(Ma){return this.ya.Dl(Ma).gh.GridBlockModel}cuh(Ma,V){if(674605324===V||-706918724===V)return!0;Ma=Object(ib.a)(this.gridView.$,Ma);if(!Ma)return!0;Ma=Ma.usedRange;return this.gridView.kba().contains(Ma)?!1:!0}};te=Object(qc.__decorate)([Object(ge.d)(fe.Zb),Object(qc.__param)(0,Object(fe.nb)()),Object(qc.__param)(1,Object(fe.u)()),Object(qc.__param)(2,Object(fe.Db)())],te);Object(ka.a)(te,
"GridInstantaneousAction",null,[658]);Q.a.Rl(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(()=>{P.a.Na(Ma=>{lb.ta(Ma);fe.Ad.$e()||ke.ta(Ma)})})();String(T);String(ba);window.___1699049107571_closurehack=T;window.___1699049107571_closurehack=ba}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/54a4f018bfdb3fb0f89397774960f202/EwaTS.rsz.js.map