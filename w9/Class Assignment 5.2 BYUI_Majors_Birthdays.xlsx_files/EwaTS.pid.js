'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[36],{1393:function(B,A,a){a.r(A);var c={};a.r(c);a.d(c,"TableIntelligenceManager",function(){return La});var b={};a.r(b);a.d(b,"TableIntelligenceDarkActivationManager",function(){return kb});var k={};a.r(k);a.d(k,"LineageDiscoverabilityCallout",function(){return pb});var m={};a.r(m);a.d(m,"ShowCalloutCommandHandler",function(){return id});var d={};a.r(d);a.d(d,"EwaNotificationFocusManager",function(){return td});
var n={};a.r(n);a.d(n,"OptimizeWorkbookManager",function(){return df});var l={};a.r(l);a.d(l,"FormulaRemediationManager",function(){return Af});var f=a(1),h=a(11),t=a(0),u=a(15),v=a(299),y=a(41),C=a(203),x=a(2),w=a(185),z=a(823),F=a(795);class J extends z.a{constructor(){super();this.range=null;this.H_=Object.assign(new F.a,{T_:J.getTypeName(),B_:J.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(t.a)(J,
"ExcelRangeWrapperAnnotation",z.a,[]);class R extends J{constructor(){super();this.primaryTable=this.sheetName=this.boundaryConfidence=this.hasMergedcells=this.tableName=this.interpretations=null;this.H_=Object.assign(new F.a,{T_:R.getTypeName(),B_:R.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(t.a)(R,"ExcelRecognizedTableNew",J,[]);class I extends R{constructor(){super();
this.requestId=null;this.H_=Object.assign(new F.a,{T_:I.getTypeName(),B_:I.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]}}Object(t.a)(I,"ExcelRangeMetadata",R,[]);var O=a(1266);class Y extends O.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new F.a,{T_:Y.getTypeName(),B_:Y.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell",
"AugLoop_Core_GridCell"]}}Object(t.a)(Y,"ExtendedExcelCell",O.a,[]);var K=a(928);class L extends K.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=null;this.H_=Object.assign(new F.a,{T_:L.getTypeName(),B_:L.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(t.a)(L,"RangeDataSignal",K.a,[]);var X=a(1194),T=a(111),ba=a(40),Q=a(22),P=a(19);class ka extends Sys.EventArgs{constructor(Pc){super();
this.WHc=Pc}}Object(t.a)(ka,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var ia=a(200),Ba=a(23),va=a(368);class W{constructor(Pc,eb,gc,Qc,Vc){this.analyzedRange=Pc;this.interpretations=eb;this.tableName=gc;this.id=Qc;this.Tyf=Vc}}Object(t.a)(W,"RecognizedTable",null,[]);class S{constructor(Pc,eb,gc){this.classification=Pc;this.aggregations=eb;this.headerReferences=gc}}Object(t.a)(S,"TableField",null,[]);var da=a(1195);const aa=Pc=>{var eb=new va.a(za(Pc.range),Pc.range.worksheetId);var gc=Pc.interpretations;
var Qc=new ia.a;if(gc&&gc.length)for(const Ec of gc){b:switch(Ec.orientation.toLowerCase()){case "columnmajor":gc=2;break b;case "rowmajor":gc=1;break b;default:u.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),gc=0}const ed=gc;if(0===ed)u.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{gc=da.a;var Vc=za(Ec.location),Id=Ec.confidence,be=Ec.headerRowCount,Vb=Ec.headerColumnCount;var Gc=Ec.fields;var Bb=new ia.a;if(Gc)for(const Td of Gc){Gc=
Bb;var uc=Gc.add;c:switch(Td.classification.toLowerCase()){case "dimension":var Dc=1;break c;case "measure":Dc=2;break c;default:u.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),Dc=0}var kd=Td.aggregations;var xd=new ia.a;if(kd)for(const Rd of kd)switch(Rd.toLowerCase()){case "sum":xd.add(0);break;case "count":xd.add(1);break;case "average":xd.add(2);break;case "min":xd.add(3);break;case "max":xd.add(4);break;case "distinctcount":xd.add(5);break;case "stddev":xd.add(6);
break;case "variance":xd.add(7);break;default:u.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}kd=xd;var Pb=Td.headerReferences;xd=new ia.a;if(Pb)for(const Rd of Pb)Pb=new Ba.Range(Rd.top,Rd.left,Rd.top,Rd.left,!1,!1),xd.add(Pb);uc.call(Gc,new S(Dc,kd,xd))}gc=new gc(Vc,Id,be,Vb,ed,Bb);Qc.add(gc)}}return new W(eb,Qc,Pc.tableName,Pc.id,Pc.hasMergedcells)},za=Pc=>new Ba.Range(Pc.top,Pc.left,Pc.bottom,Pc.right,!1,!1);var qa=a(1045);class ta{constructor(Pc,eb){this.MTc=0;this.qD=
new Map;this.mGd=!1;this.tableIntelligenceManager=Pc;this.zk=eb;f.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Flc=new qa.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.Flc.start(),this.CPc=!0);this.tableIntelligenceManager.M7a("Valid",this.Mzj.bind(this));this.tableIntelligenceManager.M7a("Invalid",this.otj.bind(this));f.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.zk.i$g(this.dnj.bind(this))}ZDa(Pc,
eb,gc){if(!this.qD)return u.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let Qc=eb;f.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&void 0!==gc&&this.MTc>gc&&(u.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${gc}, versionChanges: ${this.MTc}`),Qc=eb^4);return this.qD.has(Pc.sheetId)?(eb=this.qD.get(Pc.sheetId).filter(Vc=>Vc.table.analyzedRange.range.Zf(Pc.range)&&(Qc&Vc.metadataState)==Vc.metadataState),u.ULS.sendTraceTag(509681792,
306,50,`getRecognizedTables: foundRecords: ${eb.length}`),eb):[]}Mzj(Pc,eb){if(this.qD){if(!this.mGd){f.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.CPc&&(this.Flc.stop(),u.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.Flc.gg),this.CPc=!1);for(const gc of this.qD){const [Qc,Vc]=gc;Vc.every(Id=>4===Id.metadataState)?this.qD.delete(Qc):this.qD.set(Qc,Vc.filter(Id=>4!==Id.metadataState))}this.mGd=!0}Pc=eb.WHc;this.qD.has(Pc.analyzedRange.sheetId)||
this.qD.set(Pc.analyzedRange.sheetId,[]);this.qD.get(Pc.analyzedRange.sheetId).push({table:Pc,metadataState:2});this.MTc=0}else u.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}otj(Pc,eb){this.mGd=!1;f.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.CPc&&(this.Flc.start(),this.CPc=!0);Pc=eb.WHc;if(!this.qD)u.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.qD.has(Pc.analyzedRange.sheetId))for(const gc of this.qD.get(Pc.analyzedRange.sheetId))gc.table.id===
eb.WHc.id&&(gc.metadataState=4)}dnj(){this.MTc++}}Object(t.a)(ta,"TableIntelligenceQueryManager",null,[187]);class Xa{}Object(t.a)(Xa,"RecognizedTableLog",null,[]);class oa{}Object(t.a)(oa,"Interpretation",null,[]);class ha{constructor(Pc){this.qD=new Map;this.pdc=void 0;this.Szb=new Set;this.gSb=void 0;this.tableIntelligenceManager=Pc}eSg(){this.gSb?u.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.gSb=this.Ajb.bind(this),this.tableIntelligenceManager.M7a("Valid",
this.gSb))}gaj(Pc){Pc=this.sanitize(Pc);u.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(Pc)}`)}Ajb(Pc,eb){Pc=eb.WHc;f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Szb&&this.qD?(this.Szb.has(Pc.id)||(this.cch(Pc),this.Szb.add(Pc.id)),this.pdc||(this.pdc=window.setTimeout(this.lua.bind(this),2E3))):u.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.Szb}, recognizedTableStore = ${!!this.qD}`))}lua(){for(const Pc of this.qD){const [,
eb]=Pc;u.ULS.sendTraceTag(521233110,306,15,JSON.stringify(eb))}window.clearTimeout(this.pdc);this.Szb=this.pdc=void 0;this.qD.clear();this.qD=void 0;this.tableIntelligenceManager.ATj(this.gSb);this.gSb=void 0}cch(Pc){const eb=Pc.analyzedRange.sheetId;this.qD.has(eb)||this.qD.set(eb,[]);this.qD.get(eb).push(this.sanitize(Pc))}sanitize(Pc){const eb=[];for(const gc of Pc.interpretations){let Qc=0,Vc=0;for(const Id of gc.fields)1===Id.classification?Qc++:2===Id.classification&&Vc++;eb.push({confidence:gc.confidence,
headerRowCount:gc.headerRowCount,headerColumnCount:gc.headerColumnCount,orientation:gc.orientation,measureCount:Vc,dimensionCount:Qc})}return{interpretations:eb,range:{top:Pc.analyzedRange.range.top,bottom:Pc.analyzedRange.range.bottom,left:Pc.analyzedRange.range.left,right:Pc.analyzedRange.range.right},isTable:!!Pc.tableName,annotationId:Pc.id}}}Object(t.a)(ha,"RecognizedTableLogger",null,[]);var Za=a(8),Fa=a(146);let La=class extends ba.a{constructor(Pc,eb){super();this.gGf=this.fGf=!1;this.instantaneousSupportInformationManager=
null;this.K1d=void 0;this.DRf=!1;this.D6h=(gc,Qc)=>{var Vc;if(1===Qc.operationType){const be=Qc.annotation;if(be){u.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${be.requestId}`);gc=aa(be);f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Vc=this.K1d)||void 0===Vc?void 0:Vc.gaj(gc));var Id=null;(()=>{let Vb=this.lde.Ag(be.requestId);({value:Id}=Vb);return Vb})().returnValue?(this.lde.remove(be.requestId),
Id(gc)):u.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${be.requestId}`)}else u.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.zk=Pc;this.$=eb;this.lde=new T.a;Za.he.$e()||this.$.ja.$c(20,this);f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.K1d=new ha(this));this.zk.register(this.zk.fW().WX("TableIntelligence").VX(()=>
{}).build())}f0(){this.m2a||(this.m2a=new ta(this,this.zk));return this.m2a}lri(Pc,eb){if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<Pc.range.Gv)return u.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${Pc.range.Gv} exceeds limit of ${1E4}`),4;this.d9g();if(this.G_i(Pc.range))return this.cvi(Pc,eb);u.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}qld(Pc){return(eb,gc)=>{this.HIj(this.IQd(Pc),gc)}}M7a(Pc,
eb){var gc,Qc;f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(Qc=null===(gc=this.$)||void 0===gc?void 0:gc.sa)||void 0===Qc?0:Qc.count)&&this.$.sa.count>f.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?u.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.sa.count}`):(this.gGf||(this.zk.Qua("TableIntelligence",
{jy:!0,annotationType:R.getTypeName(),gX:this.qld("New"),r3a:this.qld("Valid"),Vuc:this.qld("Invalid")}),this.gGf=!0),this.hbh(Pc,eb),this.ROi())}ATj(Pc){this.removeHandler(this.IQd("Valid"),Pc)}hbh(Pc,eb){this.addHandler(this.IQd(Pc),eb)}tQj(){this.zk.Qua("TableIntelligence",{annotationType:I.getTypeName(),jy:!1,gX:this.D6h})}d9g(){this.fGf||(this.fGf=!0,this.tQj())}HIj(Pc,eb){1===eb.operationType&&((eb=eb.annotation)?(eb=aa(eb),this.raiseEvent(Pc,new ka(eb))):u.ULS.sendTraceTag(523772681,306,10,
"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}IQd(Pc){return`${"RecognizedTableUpdate"}_${Pc}`}cvi(Pc,eb){u.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const gc=Pc.range,Qc=P.h(this.$).Ln("TableIntelligence",gc,1),Vc=[],Id=[];let be=0;const Vb=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);for(this.instantaneousSupportInformationManager||this.$.ja.Ne(268,Gc=>{this.instantaneousSupportInformationManager=
Gc});Qc.$$mn();){const Gc=Qc.$$cu();if(!Gc)continue;if(0===Gc.im.type&&Q.a.vu(Gc.im.value))continue;Gc.mI&&Gc.range&&Id.push(Object(x.a)(new X.a,{worksheetId:Pc.sheetId,left:Gc.range.left-1,top:Gc.range.top-1,right:Gc.range.right-1,bottom:Gc.range.bottom-1}));const Bb=Gc.range.top-1,uc=Gc.range.left-1;let Dc=null,kd=null;({category:kd}=this.instantaneousSupportInformationManager.Vwa(Gc.cell.Ok,!0));Gc.text!=Gc.im.value&&(Dc=Gc.text,Vb&&be++);Vc.push(Object.assign(new Y,{row:Bb,column:uc,value:Gc.im.value,
type:Gc.im.type,displayText:Dc,RXk:kd}))}Vb&&u.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${be}, number of values: ${Vc.length}, range size: ${gc.height} rows by ${gc.width} columns`);if(0<Vc.length)return this.kKh(Vc,Pc,Id,eb),Id.length?5:0;u.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}kKh(Pc,eb,gc,Qc){var Vc=eb.range;Vc=Object(x.a)(new X.a,{top:Vc.top,left:Vc.left,bottom:Vc.bottom,right:Vc.right,
worksheetId:eb.sheetId});eb=w.a.create().toString();Pc=Object(x.a)(new L,{cells:Pc,range:Vc,mergeCellAddresses:gc,requestId:eb});this.zk.wpb(Pc);this.lde.add(eb,Qc)}G_i(Pc){const eb=P.h(this.$);if(f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)){const gc=eb.kba();u.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${gc.width}, viewportHeight: ${gc.height}`)}return eb.ya.J0(4,this.$.na)&&!!eb.Pe(Pc.topLeft)&&!!eb.Pe(Pc.bottomLeft)&&!!eb.Pe(Pc.topRight)&&!!eb.Pe(Pc.bottomRight)}ROi(){var Pc;
!this.DRf&&f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.DRf=!0,null===(Pc=this.K1d)||void 0===Pc?void 0:Pc.eSg())}};La=Object(C.__decorate)([Object(Fa.d)(Za.he),Object(C.__param)(0,Object(Za.l)()),Object(C.__param)(1,Object(Za.nb)())],La);Object(t.a)(La,"TableIntelligenceManager",ba.a,[2,173]);var xa=a(94);class db extends v.a{constructor(Pc){super();this.$=Pc;this.Dg()}create(){y.TaskExtensions.Ca(Object(xa.d)(Fa.a.resolve(Za.l,{Aa:1})),Pc=>{if(Pc=
Pc.result){let eb=this.$.ja.Qa(20);eb||(eb=new La(Pc,this.$),this.$.ja.$c(20,eb));this.Df(eb)}else u.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),this.Df(null)},this.$.qa,3)}static ta(Pc){Pc.ja.$c(404,new db(Pc))}}Object(t.a)(db,"TableIntelligenceManagerFactory",v.a,[]);var bb=a(68);let kb=class{constructor(Pc,eb){this.XOe=!1;this.tableIntelligenceManager=Pc;f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",
!1)&&void(f.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateRecognizedTableGridHighlighter")?Fa.a.resolve(Za.td,{Aa:1}):bb.GetServiceTaskFactory.$Ib(eb.ja,510,511,1));this.tableIntelligenceManager.M7a("Valid",()=>{this.XOe||(u.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.XOe=!0)})}};kb=Object(C.__decorate)([Object(Fa.d)(Za.ge),Object(C.__param)(0,Object(Za.he)()),Object(C.__param)(1,Object(Za.nb)())],kb);Object(t.a)(kb,"TableIntelligenceDarkActivationManager",
null,[174]);var Rb=a(796);class zb extends v.a{constructor(Pc){super();this.$=Pc;this.Dg()}static ta(Pc){Pc.ja.$c(481,new zb(Pc))}create(){if(Za.he.$e())void Fa.a.resolve(Za.he,{Aa:1}).then(Pc=>{const eb=Object(Rb.a)(this.$.ja,480,()=>new kb(Pc,this.$));this.Df(eb)});else{const Pc=bb.GetServiceTaskFactory.vf(this.$.ja,20,404,1);y.TaskExtensions.Ca(Pc,()=>{const eb=Pc.result,gc=Object(Rb.a)(this.$.ja,480,()=>new kb(eb,this.$));this.Df(gc)},this.$.qa,3)}}}Object(t.a)(zb,"TableIntelligenceDarkActivationManagerFactory",
v.a,[]);var nc=a(1305),Zb=a(963),Sa=a(964),Na=a(184),Ea=a(195);class Aa{constructor(Pc){this.hQ=null;this.$=Pc}show(){const Pc=this.kTa();u.ULS.shipAssertTag(537169938,0,!!Pc,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");Ea.UISurfaces.TF().then(eb=>{const gc=eb.callout(Pc);this.hQ=eb.addNotification(gc)},eb=>{u.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${eb}`);return null})}dismiss(){this.hQ&&Ea.UISurfaces.TF().then(Pc=>{Pc.removeNotification(this.hQ);
return this.hQ=null})}a3a(Pc){Ea.UISurfaces.TF().then(eb=>{eb.updateNotification(this.hQ,eb.callout(Object.assign(new Zb.a,Pc)))},eb=>{u.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${eb}`);return null})}}Object(t.a)(Aa,"EwaReactCallout",null,[262]);class Ka{static UNb(Pc){return!!(Pc&1)}static vKd(Pc){return!!(Pc&2)}static QHk(Pc){return!!(Pc&Ka.rLi)}}Ka.rLi=6;Object(t.a)(Ka,"EwaReactCalloutModeUtil",null,[]);class nb{constructor(){this.N4=0;this.ZOb=
null;this.UPc=!0}}Object(t.a)(nb,"EwaReactShowOrDismissCalloutMetadata",null,[]);var Qb=a(63),jb=a(124),qb=a(923);class ab{constructor(Pc,eb,gc){this.indexedDB=null;this.$=Pc;this.XR=eb;this.mQa=gc}fPf(){const Pc=new Na.a,eb=new nb;y.TaskExtensions.Ca(this.Eaf(),gc=>{gc.result?y.TaskExtensions.Ca(this.indexedDB.ETa(this.XR),Qc=>{if(Qc=Qc.result){Qc=Qb.a.qm(Qc);if(!Qc){this.yhf(Pc);return}if(Ka.UNb(this.mQa)){const Vc=Qc.NumberOfDisplays;eb.N4=Vc?Number.parseLocale(Vc):0}Ka.vKd(this.mQa)&&(Qc=Qc.LastDisplay,
eb.ZOb=Qc?new Date(Number.parseLocale(Qc)):null)}Pc.setResult(eb)},this.$.qa):this.yhf(Pc)},this.$.qa,3);return Pc.task}Aqg(Pc){const eb=new Na.a;y.TaskExtensions.Ca(this.Eaf(),gc=>{gc.result||eb.setResult(!1);gc={};Ka.UNb(this.mQa)&&(gc.NumberOfDisplays=Pc.N4.toString());Ka.vKd(this.mQa)&&(gc.LastDisplay=jb.toTimestamp(Pc.ZOb).m.toString());gc=Qb.a.Vf(gc);y.TaskExtensions.Ca(this.indexedDB.j0a(new qb.a(this.XR,gc)),Qc=>{eb.setResult(Qc.result)},this.$.qa,3)},this.$.qa,3)}Eaf(){const Pc=new Na.a;
this.indexedDB?Pc.setResult(!0):void Fa.a.resolve(Za.kc,{Aa:1}).then(eb=>{eb.Xi()?(eb.initialize("Callouts","EwaCallouts"),this.indexedDB=eb,Pc.setResult(!0)):(u.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),Pc.setResult(!1))});return Pc.task}yhf(Pc){const eb=new nb;eb.UPc=!1;Pc.setResult(eb)}}Object(t.a)(ab,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[261]);class xb{constructor(Pc,eb,gc,Qc,Vc,Id){this.Efc=
eb;this.Gfc=gc;this.mQa=Qc;this.XR=Vc;this.localStorage=Id;this.$=Pc}fPf(){const Pc=new Na.a,eb=new nb;if(Ka.UNb(this.mQa)){let gc=0;eb.UPc=(()=>{let Qc=this.qzk();({eka:gc}=Qc);return Qc})().returnValue&&eb.UPc;eb.N4=gc}Pc.setResult(eb);return Pc.task}Aqg(Pc){const eb=new Na.a;var gc=!0;if(Ka.UNb(this.mQa)){const Qc=this.Ymf();Qc&&(gc=Number.parseLocale(Qc),gc=this.Yzk((gc&~this.Gfc|Pc.N4<<this.Efc).toString()))}eb.setResult(gc)}qzk(){var Pc;return(Pc=this.Ymf())?(Pc=(Number.parseLocale(Pc)&this.Gfc)>>
this.Efc,u.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.XR} already appeared. Found the callout in storage.`),{returnValue:!0,eka:Pc}):{returnValue:!1,eka:0}}Yzk(Pc){try{if(!this.localStorage.Xi())return!1;try{return this.localStorage.setItem("CalloutIds",Pc),!0}catch(eb){u.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${eb.message||"Unknown"}`)}}catch(eb){u.ULS.sendTraceTag(537169930,
0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${eb.message}`)}return!1}Ymf(){try{if(!this.localStorage.Xi())return u.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.XR}.`),null;const Pc=this.localStorage.getItem("CalloutIds");return Pc?Pc:(u.ULS.sendTraceTag(537169928,
0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(Pc){return u.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${Pc.message}`),null}}}Object(t.a)(xb,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[261]);var Tb=a(65),Cc=a(148),lb=a(193),Ya=a(149),Hb=a(609);class Lb extends Aa{constructor(Pc,
eb,gc,Qc,Vc,Id,be,Vb,Gc,Bb,uc,Dc,kd,xd,Pb,Ec,ed,Td){Bb=void 0===Bb?!1:Bb;uc=void 0===uc?!1:uc;Dc=void 0===Dc?!1:Dc;kd=void 0===kd?!1:kd;xd=void 0===xd?!1:xd;Pb=void 0===Pb?!0:Pb;Ec=void 0===Ec?!1:Ec;ed=void 0===ed?null:ed;Td=void 0===Td?!1:Td;super(Pc);this.N4=0;this.nce=this.gUc=this.GOg=!1;this.C5f=()=>{this.Ruc()};this.DWg=eb;this.Cjk=gc;this.aSh=Qc;this.Lx=Vc;this.Kx=Id;this.localStorage=Gc;this.CWg=be;this.BWg=Vb;this.e7i=Bb;this.MDd=uc;this.dSh=Dc;this.setInitialFocus=kd;this.useCoachmark=xd;
this.aLc=!1;this.lak=Pb;this.YUf=this.mri();this.lQa=ed;this.nce=Td;this.hasDynamicSizing=Ec}get Azb(){return{}}set PQg(Pc){this.Lx=Pc}Hme(){}sTa(){return 1}Ywd(){return 0}get eka(){return 1}get xcg(){return!0}get XR(){return this.DWg}get Gfc(){return this.CWg}get Efc(){return this.BWg}show(){y.TaskExtensions.Ca(this.sJa(),Pc=>{Pc.result&&this.Wjk()},this.$.qa)}hQf(){Ya.b(this.$).Gg(Cc.a.Icf,this.Bvf("dismiss"),void 0,!0)}gRf(){Ya.b(this.$).Gg(Cc.a.Icf,this.Bvf("show"),void 0,!0)}kTa(){const Pc=Object(x.a)(new nc.a,
{label:this.aSh,onExecute:()=>{this.Hme();this.hQf();this.gUc=!0;this.Ruc()}});let eb=null;this.MDd||(eb=Object(x.a)(new nc.a,{label:this.Cjk,onExecute:()=>{this.gUc=!0;this.gRf();const gc=lb.c({["InputMethod"]:Tb.a.Ke},this.Azb);this.$.Ha.Me(this.ribbonCommandInfo,gc);this.Ruc()}}));return Object(x.a)(new Zb.a,{target:this.uJb(),content:this.Kx,title:this.Lx,primaryButtonProps:this.MDd?Pc:eb,secondaryButtonProps:this.MDd?null:Pc,showCloseIcon:this.nce,preventLightDismiss:!this.e7i,hasDynamicSizing:this.hasDynamicSizing,
calloutProps:Object(x.a)(new Sa.a,{onDismiss:()=>{this.Ruc()},directionalHint:this.lQa,preventDismissOnScroll:!0,preventDismissOnResize:!this.dSh,isBeakVisible:this.lak,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}Ruc(){this.GOg=!0;const Pc=Fa.a.mg(Za.jd);Pc&&Pc.sWj(this.C5f);(this.xcg&&this.gUc||this.nce)&&this.sIg(!0);this.gUc||u.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.XR} was dismissed without user interaction`);
this.dismiss()}sJa(){const Pc=new Na.a;this.nsa()?y.TaskExtensions.Ca(this.YUf.fPf(),eb=>{var gc=this.sTa();eb=eb.result;if(eb.UPc)if(this.N4=eb.N4,Ka.UNb(gc)&&(this.aLc||eb.N4>=this.eka))u.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.XR} already appeared. Found the callout in storage.`),this.aLc=!0,Pc.setResult(!1);else{if(Ka.vKd(gc)&&eb.ZOb&&(gc=jb.getElapsedSeconds(eb.ZOb,new Date),(eb=this.Ywd())||u.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.XR} with mode RestrictedBycooldown`),
gc<eb)){Pc.setResult(!1);return}gc=!this.hQ&&!!this.uJb()&&!Hb.a(this.$);Pc.setResult(gc)}else Pc.setResult(!1),u.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.XR}.`)},this.$.qa):Pc.setResult(!1);return Pc.task}nsa(){return!0}uJb(){if(document.querySelector(this.wX))return this.wX;if(document.querySelector(this.vX))return this.vX;if(document.querySelector(this.WW))return this.WW;u.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.XR}`);
return null}sIg(Pc){Pc=void 0===Pc?!1:Pc;this.aLc=!0;this.sTa();const eb=new nb;eb.N4=Pc?this.eka:this.N4+1;eb.ZOb=new Date;this.YUf.Aqg(eb)}Wjk(){this.aLc=!0;this.sIg();u.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.XR} callout, current number of displayes: ${this.N4}`);void Fa.a.Xn(Za.jd).then(Pc=>{this.GOg||Pc.yfh(this.C5f)});super.show()}mri(){const Pc=this.sTa();return Ka.QHk(Pc)?new ab(this.$,this.XR,Pc):new xb(this.$,this.Efc,this.Gfc,Pc,this.XR,this.localStorage)}Bvf(Pc){return{["selection"]:Pc,
["callout"]:this.XR,["Location"]:"floatie",["displayCount"]:this.N4}}}Object(t.a)(Lb,"EwaReactShowOrDismissCallout",Aa,[]);var qc=a(91),mc=a(281),Ta=a(9);const Va='[id="'+Ta.a.xCg+'"]';class Db extends Lb{constructor(Pc,eb,gc,Qc,Vc,Id,be,Vb,Gc,Bb){super(Pc,eb,null,gc,Qc,Vc,Id,be,new mc.a,Vb,!0,!0,Gc,!1,!1,void 0,Bb)}get wX(){return Va}get vX(){return Va}get WW(){return Va}get ribbonCommandInfo(){return new qc.a(-847286761,Tb.a.Ke,this.$.zf,0,null)}nsa(){return!(this.$.isMobileMode||this.$.ea.ff.inEmbedView||
this.$.ea.ff.inWebPart)}}Object(t.a)(Db,"ZoomTeachingCallout",Lb,[]);var Ca=a(13);class cb extends Db{constructor(Pc){super(Pc,"AdjustZoomTeachingCallout",Ca.a.instance.za(694),null,Ca.a.instance.za(693),2,1,!1,!0,2)}}Object(t.a)(cb,"AdjustZoomTeachingCallout",Db,[]);class hb extends Lb{constructor(Pc){super(Pc,"ConditionalFormattingManageRulesTeachingCallout",Ca.a.instance.za(643),Ca.a.instance.za(644),Ca.a.instance.za(641),Ca.a.instance.za(642),2,1,new mc.a)}get wX(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get vX(){return'[data-unique-id="RibbonOverflowMenu"]'}get WW(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new qc.a(-20558303,
Tb.a.Ke,this.$.zf,0,null)}}Object(t.a)(hb,"ConditionalFormattingManageRulesTeachingCallout",Lb,[]);var ya;(function(Pc){Pc[Pc.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";Pc[Pc.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";Pc[Pc.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";Pc[Pc.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";Pc[Pc.lineageDiscoverability=4]="lineageDiscoverability";Pc[Pc.lineageTeachingCallout=5]="lineageTeachingCallout";
Pc[Pc.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";Pc[Pc.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";Pc[Pc.linkedEntityGallery=8]="linkedEntityGallery";Pc[Pc.fixedFreezePane=9]="fixedFreezePane";Pc[Pc.phoneticTeachingCallout=10]="phoneticTeachingCallout";Pc[Pc.powerQueryCallout=11]="powerQueryCallout";Pc[Pc.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";Pc[Pc.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";Pc[Pc.tableInNewWorkbook=
14]="tableInNewWorkbook";Pc[Pc.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";Pc[Pc.dataCleansing=16]="dataCleansing";Pc[Pc.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";Pc[Pc.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";Pc[Pc.functionDialog=21]="functionDialog";Pc[Pc.length=22]="length"})(ya||(ya={}));Object(t.b)("EwaCalloutName",ya);var Pa=a(42);class wb extends Db{constructor(Pc){super(Pc,"FixedFreezePaneTeachingCallout",
Ca.a.instance.za(647),Ca.a.instance.za(645),Ca.a.instance.za(646),65536,16,!0,!1,8)}sTa(){return 0}}Object(t.a)(wb,"FixedFreezePaneTeachingCallout",Db,[]);var Ib;let pb=Ib=class extends Lb{constructor(Pc){super(Pc,Ib.j7i,Ca.a.instance.za(650),Ca.a.instance.za(652),Ca.a.instance.za(648),Ca.a.instance.za(649),3072,10,new mc.a)}cik(){return this.sJa()}get wX(){return"[data-unique-id=Review]"}get vX(){return"[data-unique-id=pivotOverflowButton]"}get WW(){return'[id="'+this.$.Af+'Ribbon.Review-title"]'}get xcg(){return!1}get ribbonCommandInfo(){return new qc.a(1834994092,
Tb.a.Ke,this.$.zf,9,null)}get eka(){return 2}sTa(){return 3}Ywd(){return 86400}nsa(){return this.$.ea.Zhb}};pb.j7i="LineageDiscoverabilityCallout";pb=Ib=Object(C.__decorate)([Object(Fa.d)(Za.tc),Object(C.__param)(0,Object(Za.nb)())],pb);Object(t.a)(pb,"LineageDiscoverabilityCallout",Lb,[176]);class xc extends Lb{constructor(Pc){super(Pc,xc.n7i,"",Ca.a.instance.za(651),Ca.a.instance.za(653),Ca.a.instance.za(654),4096,12,new mc.a,void 0,!0);this.lQa=9}get wX(){return xc.hOd}get vX(){return xc.hOd}get WW(){return xc.hOd}get ribbonCommandInfo(){return null}}
xc.n7i="LineageTeachingCallout";xc.hOd="#LineagePaneFilterButton";Object(t.a)(xc,"LineageTeachingCallout",Lb,[]);var ua=a(112),U=a(6),na=a(58),ob=a(1031);class bc extends ob.a{constructor(Pc){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Pc.paragraphs;this.image=Pc.image;this.imageWidth=Pc.imageWidth;this.imageHeight=Pc.imageHeight}}Object(t.a)(bc,"TextAboveImage",ob.a,[]);class oc{constructor(Pc,eb){this.imageHeight=this.imageWidth=this.image=
this.paragraphs=null;this.paragraphs=Pc;this.image=eb}}Object(t.a)(oc,"TextAboveImageCustomProps",null,[]);var Yb=a(1032);class Fc extends Aa{constructor(Pc){super(Pc);this.Rsg=0;this.B1a=this.target=null;this.sTc=!1;this.Kx=this.Lx=null;this.bfd=0}WM(Pc,eb,gc,Qc,Vc,Id){if(!this.Er()){switch(Qc){case "DataTypes_PBI":this.bfd=1;break;default:this.bfd=0}this.target=Pc;this.Lx=String.format(Ca.a.instance.za(676),eb);this.Kx=String.format(Ca.a.instance.za(677),gc);this.Rsg=Id;this.j8j(Qc,Vc)}}j8j(Pc,
eb){const gc=!!this.$.xa&&Q.a.equals(this.$.xa.UICultureTag,"en-us",!0);this.sTc=eb&&gc;eb&&!gc?this.B1a="BlankCell":Pc?this.B1a=Pc:(u.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.B1a="BlankCell")}show(){u.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.Kx&&!!this.Lx,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Er()||(u.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}Er(){return!!this.hQ}kTa(){const Pc=Object(x.a)(new nc.a,{label:Ca.a.instance.za(682),ariaDescription:Ca.a.instance.za(683),onExecute:()=>{u.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),eb=Object(x.a)(new nc.a,{label:this.sTc?Ca.a.instance.za(680):
Ca.a.instance.za(678),ariaDescription:this.sTc?Ca.a.instance.za(681):Ca.a.instance.za(679),onExecute:()=>{u.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.sTc?"Try sample data":"Learn more")+'" button');var Id=new Map;Id.set("Domain",this.Rsg.toString());ua.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",0,"ropari",Id);Id=new qc.a(-859308420,Tb.a.Ke,this.$.zf,9,null);this.$.Ha.Me(Id,{[Tb.a.Vi]:"HelpID="+this.B1a,["InputMethod"]:Tb.a.Ke,
["ShouldCanvasTakeFocus"]:!0,[Tb.a.ig]:U.a.PM});this.dismiss()}});var gc=!!this.$&&!!this.$.frame&&!!this.$.frame.lE&&this.$.frame.lE.IP;switch(this.bfd){case 1:var Qc=gc?125:122;break;default:Qc=gc?124:119}Qc=Object(x.a)(new Yb.a(na.a.current.uq(Qc)),{alt:Ca.a.instance.He(184)});const Vc=this.Kx.split("\n\n");gc=Object(x.a)(new oc(Vc,Qc),{imageWidth:280,imageHeight:gc?142:192});gc=new bc(gc);return Object(x.a)(new Zb.a,{target:this.target,content:gc,title:this.Lx,primaryButtonProps:eb,secondaryButtonProps:Pc,
showCloseIcon:!0,calloutProps:Object(x.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(t.a)(Fc,"LinkedEntityBlankCellConvertTeachingCallout",Aa,[]);class ld extends Lb{constructor(Pc){super(Pc,"LinkedEntityFirstOrganizationDataCallout",Ca.a.instance.za(672),Ca.a.instance.za(674),Ca.a.instance.za(670),Ca.a.instance.za(671),8192,13,
new mc.a,void 0,void 0,!0,!0);this.target=null;this.B1a="DataTypes_PBI"}get wX(){return this.target.toString()}get vX(){return this.target.toString()}get WW(){return'[id="'+this.$.Af+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new qc.a(-859308420,Tb.a.Ke,this.$.zf,9,null)}get Azb(){return{[Tb.a.Vi]:"HelpID="+this.B1a,["ShouldCanvasTakeFocus"]:!0,[Tb.a.ig]:U.a.PM}}WM(Pc){this.Er()||(this.target=Pc,this.B1a="DataTypes_PBI")}Er(){return!!this.hQ}nsa(){u.ULS.shipAssertTag(537169921,0,
!!this.target,"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Er()}}Object(t.a)(ld,"LinkedEntityFirstOrganizationDataTeachingCallout",Lb,[]);class qd extends Lb{constructor(Pc){super(Pc,"LinkedEntityGalleryTeachingCallout","",Ca.a.instance.za(682),Ca.a.instance.za(684),Ca.a.instance.za(685),49152,14,new mc.a,void 0,!0,!0,!0,!0);this.target=
null;this.lQa=5}get eka(){return 2}get wX(){return this.target.toString()}get vX(){this.lQa=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get WW(){return""}get ribbonCommandInfo(){return new qc.a(-847286761,Tb.a.Ke,this.$.zf,0,U.a.oVb)}show(){u.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Er()||(u.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),
super.show())}WM(Pc){this.Er()||(this.target=Pc)}Er(){return!!this.hQ}nsa(){u.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Er()}}Object(t.a)(qd,"LinkedEntityGalleryTeachingCallout",Lb,[]);var fe=a(12);class ge extends Aa{constructor(Pc){super(Pc);this.Kx=this.Lx=this.target=null}WM(Pc,eb,gc){this.Er()||(this.target=
Pc,this.Lx=String.format(Ca.a.instance.He(186),eb),this.Kx=String.format(Ca.a.instance.He(188),gc))}show(){u.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.Kx&&!!this.Lx,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Er()||(u.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}Er(){return!!this.hQ}kTa(){const Pc=
Object(x.a)(new nc.a,{label:Ca.a.instance.ia(1806),ariaDescription:Ca.a.instance.ia(1807),onExecute:()=>{u.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');ua.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",0,"ropari",null);fe.HelperMethods.Ph("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var eb=Object(x.a)(new Yb.a(na.a.current.uq(this.$&&
this.$.frame&&this.$.frame.lE&&this.$.frame.lE.IP?126:123)),{alt:Ca.a.instance.He(189)});eb=Object(x.a)(new oc([this.Kx],eb),{imageWidth:280,imageHeight:142});eb=new bc(eb);return Object(x.a)(new Zb.a,{target:this.target,content:eb,title:this.Lx,primaryButtonProps:Pc,showCloseIcon:!0,calloutProps:Object(x.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}
Object(t.a)(ge,"LinkedEntityNoCuratedDataTeachingCallout",Aa,[]);var Wd=a(179),Zd=a(369);class ke extends Aa{constructor(Pc){super(Pc);this.Kx=this.Lx=null}WM(Pc){this.Er()||(this.target=Pc,this.O8j())}show(){u.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.Kx&&!!this.Lx,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Er()||(u.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),
Wd.a.sendTelemetryEvent(Object(x.a)(new Zd.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}Er(){return!!this.hQ}kTa(){return Object(x.a)(new Zb.a,{target:this.target,title:this.Lx,content:this.Kx,showCloseIcon:!0,calloutProps:Object(x.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}O8j(){let Pc=
-1,eb=0;const gc=Fa.a.mg(Za.Sc);gc&&(Pc=gc.awb,eb=gc.Ktb);switch(eb){default:this.Lx=Ca.a.instance.za(722);this.Kx=Ca.a.instance.za(725);break;case 1:this.Lx=String.format(Ca.a.instance.za(723),Pc);this.Kx=Ca.a.instance.za(726);break;case 2:this.Lx=String.format(Ca.a.instance.za(724),Pc),this.Kx=Ca.a.instance.za(726)}}}Object(t.a)(ke,"OptimizeWorkbookBusinessBarCallout",Aa,[]);var ne=a(163);class se extends Lb{constructor(Pc,eb,gc,Qc,Vc,Id,be,Vb,Gc){Vb=void 0===Vb?!1:Vb;super(Pc,void 0===Gc?"OverrideBrowserShortcutsTeachingCallout":
Gc,eb,gc,Qc,Vc,Id,be,new mc.a,Vb)}get wX(){return"[data-unique-id=Help]"}get vX(){return"[data-unique-id=pivotOverflowButton]"}get WW(){return'[id="'+this.$.Af+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new qc.a(-1018439626,Tb.a.Ke,this.$.zf,0,U.a.I1)}nsa(){return!ne.a.get(U.a.zZb)}}Object(t.a)(se,"OverrideBrowserShortcutsTeachingCallout",Lb,[]);class Cb extends se{constructor(Pc,eb,gc,Qc,Vc,Id,be,Vb){super(Pc,eb,gc,Qc,Vc,Id,be,void 0===Vb?!1:Vb,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new qc.a(-901364793,
Tb.a.Ke,this.$.zf,0,U.a.I1)}get Azb(){return{[U.a.WXd]:!1}}}Object(t.a)(Cb,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",se,[]);var ib=a(55);class ac extends Lb{constructor(Pc,eb,gc,Qc,Vc,Id,be,Vb,Gc,Bb,uc,Dc,kd,xd,Pb,Ec,ed,Td,Rd){super(Pc,eb,gc,Qc,Vc,Id,Vb,Gc,Bb,void 0===uc?!1:uc,void 0===Dc?!1:Dc,void 0===kd?!1:kd,void 0===xd?!1:xd,void 0===Pb?!1:Pb,void 0===Ec?!0:Ec,void 0===ed?!1:ed,void 0===Td?null:Td,void 0===Rd?!1:Rd);this.learnMoreUrl=null;this.learnMoreUrl=be}TAj(){try{ib.a.R_(this.learnMoreUrl)}catch(Pc){}}Hme(){null!=
this.learnMoreUrl&&this.TAj()}}Object(t.a)(ac,"EwaReactShowOrLearnMoreCallout",Lb,[]);const Lc='[id="'+Ta.a.xCg+'"]';class ad extends ac{constructor(Pc){super(Pc,"PhoneticTeachingCallout",Ca.a.instance.za(695),Ca.a.instance.za(698),Ca.a.instance.za(697),Ca.a.instance.za(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new mc.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get wX(){return Lc}get vX(){return Lc}get WW(){return Lc}get ribbonCommandInfo(){return new qc.a(1455037301,
Tb.a.Ke,this.$.zf,0,null)}hQf(){u.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}gRf(){u.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(t.a)(ad,"PhoneticTeachingCallout",ac,[]);var te=a(174);class Ma extends Lb{constructor(Pc,eb,gc,Qc,Vc,Id){super(Pc,eb,Ca.a.instance.za(708),Ca.a.instance.za(707),Ca.a.instance.za(703),gc,Qc,Vc,new mc.a,!0,!1,void 0,void 0,void 0,!0,!0);this.lQa=5;this.HBb=Id}get eka(){return 2}get wX(){return 1===te.a(this.$).cU?
"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get vX(){return"[data-unique-id=Connections_MLR"}nsa(){return this.HBb}get WW(){return'[id="'+this.$.Af+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new qc.a(-859308420,Tb.a.Ke,this.$.zf,9,null)}get Azb(){return{[Tb.a.Vi]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[Tb.a.ig]:U.a.PM}}MZb(){return this.sJa()}show(){this.uJb()?super.show():u.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}
Object(t.a)(Ma,"PowerQueryRefreshTeachingCalloutBase",Lb,[]);class V extends Ma{constructor(Pc){super(Pc,"PowerQueryRefreshFromTableTeachingCallout",Ca.a.instance.za(705),3145728,20,f.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"))}}Object(t.a)(V,"PowerQueryRefreshFromTableTeachingCallout",Ma,[]);class fa extends Lb{constructor(Pc){super(Pc,"QueriesTaskPaneTeachingCallout",Ca.a.instance.za(702),Ca.a.instance.za(701),Ca.a.instance.za(849),Ca.a.instance.za(850),12582912,22,
new mc.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.lQa=5;this.HBb=f.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations")}get eka(){return 2}get wX(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get vX(){return"[data-unique-id=Connections_MLR]"}get WW(){return'[id="'+this.$.Af+'Ribbon.Data.Queries"]'}MZb(){return this.sJa()}show(){this.uJb()?super.show():u.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}nsa(){return this.HBb}get ribbonCommandInfo(){return new qc.a(1156885807,
Tb.a.Ke,this.$.zf,0,U.a.oVb)}}Object(t.a)(fa,"QueriesTaskPaneTeachingCallout",Lb,[]);var ub=a(447),rb=a(204),hd=a(610),Eb=a(241),kc=a(252);class zc extends Ma{constructor(Pc){super(Pc,"PowerQueryAuthenticatedRefreshTeachingCallout",Ca.a.instance.za(706),805306368,28,f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))}}Object(t.a)(zc,"PowerQueryAuthenticatedRefreshTeachingCallout",Ma,[]);class Nc extends Lb{constructor(Pc){super(Pc,"PowerQueryClearAllPermissionsTeachingCallout",
Ca.a.instance.za(708),Ca.a.instance.za(701),Ca.a.instance.za(852),Ca.a.instance.za(853),3,32,new mc.a,!0,!1,void 0,void 0,void 0,!0,!0);this.lQa=5;this.HBb=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1)}get eka(){return 2}get wX(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get vX(){return"[data-unique-id=Connections_MLR]"}get WW(){return'[id="'+this.$.Af+'Ribbon.Data.Queries"]'}MZb(){return this.sJa()}show(){this.uJb()?super.show():u.ULS.sendTraceTag(508687132,
0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}nsa(){return this.HBb}get ribbonCommandInfo(){return new qc.a(-859308420,Tb.a.Ke,this.$.zf,9,null)}get Azb(){return{[Tb.a.Vi]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[Tb.a.ig]:U.a.PM}}}Object(t.a)(Nc,"PowerQueryClearAllPermissionsTeachingCallout",Lb,[]);class Fd{constructor(Pc){this.Ayf=this.azf=!1;this.sJa=!0;this.Mrj=eb=>{if(eb&&!Eb.a(eb))try{const gc=eb.Result,Qc=gc.QueryGroups;if(0<gc.Queries.length||
0<Qc.length)this.azf=!0,this.Ayf=gc.PowerQueryDataSources?gc.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||gc.PowerQueryDataSources.includes("OData.Feed"):!1,void this.Rkk()}catch(gc){u.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${gc}.`)}};this.PDc=()=>{u.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=Pc;this.$dg=new fa(Pc);this.powerQueryClearAllPermissionsCallout=new Nc(Pc);this.JZd=
f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new zc(Pc):new V(Pc)}show(){this.sJa&&this.C6j()}C6j(){this.$.userOperationManager.enqueueOperation(new rb.a(587,0,(Pc,eb,gc)=>hd.d(this.$.oa.ua,kc.b(Pc,this.Mrj),kc.a(eb,this.PDc),gc,null),80,()=>new ub.a),null)}Rkk(){const Pc=this;return Lo(function*(){(yield xa.c(Pc.$dg.MZb()))&&Pc.azf?Pc.$dg.show():(yield xa.c(Pc.JZd.MZb()))&&(Pc.JZd instanceof zc||Pc.Ayf)?Pc.JZd.show():(yield xa.c(Pc.powerQueryClearAllPermissionsCallout.MZb()))&&
Pc.powerQueryClearAllPermissionsCallout.show();Pc.sJa=!1})}}Object(t.a)(Fd,"PowerQueryCallout",null,[262]);class Xd extends Aa{constructor(Pc){super(Pc);this.qTd=this.Dkd=this.Kx=this.Lx=this.target=null}WM(Pc,eb,gc){this.Er()||(this.target=Pc,this.Dkd=eb,this.qTd=gc,this.Lx=Ca.a.instance.za(710),this.Kx=Ca.a.instance.za(711))}show(){u.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.Kx&&!!this.Lx&&!!this.Dkd&&!!this.qTd,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Er()||(u.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}Er(){return!!this.hQ}kTa(){const Pc=Object(x.a)(new nc.a,{label:Ca.a.instance.za(712),ariaDescription:Ca.a.instance.za(714),onExecute:()=>{u.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.Dkd();this.dismiss()}}),eb=Object(x.a)(new nc.a,{label:Ca.a.instance.za(713),ariaDescription:Ca.a.instance.za(715),onExecute:()=>
{u.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.qTd();this.dismiss()}});return Object(x.a)(new Zb.a,{target:this.target,content:this.Kx,title:this.Lx,primaryButtonProps:Pc,secondaryButtonProps:eb,showCloseIcon:!0,calloutProps:Object(x.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(t.a)(Xd,
"TableAIConvertToTableCallout",Aa,[]);var ie=a(187),Ee=a(81);class He{constructor(Pc){this.Lxk=Pc}show(){Ee.a.instance.We("Common.ISystemInitiatedFeedback").execute(Pc=>{Pc.logActivity(this.Lxk,null)})}}Object(t.a)(He,"EwaLppCallout",null,[262]);var gd=a(45);class Bd extends He{constructor(Pc){super("ExcelTableInNewWorkbook");this.uHd=this.tja=!1;this.createTable=()=>{const eb=gd.v(new ie.a(1,1,8,3,Ta.a.oi,Ta.a.hi),this.$),gc={};gc.TableRange=eb;gc.HasHeader=!1;this.$.Lf(71074531,Tb.a.Ke,9,gc)};this.L3e=
()=>{this.createSampleTable("0")};this.M3e=()=>{this.createSampleTable("2")};this.N3e=()=>{this.createSampleTable("1")};this.$=Pc;(this.tja=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.uHd=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.L3e,!0),window.addEventListener("ExcelCreateSampleTableContact",
this.M3e,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.N3e,!0)}dispose(){this.tja&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.uHd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.L3e,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.M3e,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.N3e,!0))}createSampleTable(Pc){const eb={};eb[Tb.a.ig]=Pc;this.$.Lf(1371713064,Tb.a.Ke,9,eb)}}Object(t.a)(Bd,"TableInNewWorkbookCallout",
He,[]);var ue=a(1207);class ye extends Aa{constructor(Pc){super(Pc);this.zOc=5E3;this.Lx=ue.a.Title;this.currentState=0}DCa(Pc,eb){ue.c.get(this.currentState).includes(Pc)&&(6===Pc?window.requestAnimationFrame(()=>this.kmc(Pc,eb)):this.kmc(Pc,eb))}O1b(Pc){this.target=Pc}show(){super.dismiss();this.Cng();super.show()}dismiss(){this.DCa(0);window.clearTimeout(this.Oig);super.dismiss()}kTa(){return Object(x.a)(new Zb.a,{target:this.target,title:this.Lx,content:this.Kx,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,
preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.Cng();super.a3a({message:this.Kx})}kmc(Pc,eb){const gc=ue.b.get(Pc);this.LCk(this.YTh(Pc)?`${gc}${eb}`:gc);this.currentState=Pc;0!=this.currentState?(this.update(),this.show()):this.dismiss()}YTh(Pc){switch(Pc){case 5:case 6:return!0;default:return!1}}Cng(){window.clearTimeout(this.Oig);this.Oig=window.setTimeout(()=>
this.dismiss(),this.zOc)}LCk(Pc){this.Kx=Pc}}Object(t.a)(ye,"FormulaByExampleCurtainLifterCallout",Aa,[]);var Ue=a(180);class Sb extends Lb{constructor(Pc){super(Pc,"DataCleansingTeachingCallout",Ue.a.ia(1952),Ue.a.ia(1953),"",Ue.a.ia(1954),16777216,24,new mc.a,!0,!1,!1,!1,!0,!0,!0,5,!0);this.Dee="[id=DataCleansingTaskPane]";this.XOg=!1}WM(Pc,eb){this.PQg=String.format(Ca.a.instance.He(213),Pc);this.XOg=eb}sTa(){return f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)&&this.XOg?0:2}Ywd(){return 2592E3}get wX(){return this.Dee}get vX(){return this.Dee}get WW(){return this.Dee}get ribbonCommandInfo(){return new qc.a(-1190551534,Tb.a.Ke,this.$.zf,0,null)}}Object(t.a)(Sb,"DataCleansingTeachingCallout",Lb,[]);var cd=a(120);class Xc extends Aa{constructor(Pc){super(Pc);this.Kx=this.Lx=this.target=null;this.duration=0}WM(Pc,eb,gc){this.Er()||(this.target=Pc,this.Lx=this.Hii(eb),this.Kx=Ca.a.instance.za(737),this.operation=eb,this.duration=gc)}show(){u.ULS.shipAssertTag(512304648,
0,!!this.target&&!!this.Kx&&!!this.Lx,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");if(!this.Er()){u.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var Pc={["Operation"]:this.operation,["Duration"]:this.duration};Wd.a.sendTelemetryEvent(Object(x.a)(new Zd.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",
dataFields:cd.a.Bl(Pc)}));super.show()}}Er(){return!!this.hQ}kTa(){return Object(x.a)(new Zb.a,{target:this.target,title:this.Lx,content:this.Kx,showCloseIcon:!0,calloutProps:Object(x.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}Hii(Pc){switch(Pc){case 0:return Ca.a.instance.za(727);case 1:return Ca.a.instance.za(728);case 2:return Ca.a.instance.za(729);
case 3:return Ca.a.instance.za(730);case 4:return Ca.a.instance.za(731);case 5:return Ca.a.instance.za(732);case 6:return Ca.a.instance.za(733);case 7:return Ca.a.instance.za(734);case 8:return Ca.a.instance.za(735);case 9:return Ca.a.instance.za(736);default:return""}}}Object(t.a)(Xc,"OptimizeWorkbookSlowOperationsCallout",Aa,[]);class fd extends Lb{constructor(Pc){super(Pc,"FunctionDialogTeachingCallout",void 0,Ca.a.instance.za(763),Ca.a.instance.za(760),Ca.a.instance.za(761),1073741824,30,new mc.a,
!0,!0,!1,!1,!0,!0,!0,5,!0)}WM(Pc){this.Ncd=`[id=${"CellEdit"===Pc?this.$.Af+U.a.sHb:"InsertFunction"}]`}sTa(){return 1}get wX(){return this.Ncd}get vX(){return this.Ncd}get WW(){return this.Ncd}get ribbonCommandInfo(){return null}}Object(t.a)(fd,"FunctionDialogTeachingCallout",Lb,[]);class mb extends He{constructor(Pc){super("ExcelLiveWebEntryPointCallout");this.Zia=!1;this.TBg=()=>{this.$.Lf(327119921,Tb.a.Ke,9,null)};this.$=Pc;(this.Zia=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",
!1))&&window.addEventListener("TryCoEditInTeams",this.TBg,!0)}dispose(){this.Zia&&window.removeEventListener("TryCoEditInTeams",this.TBg,!0)}}Object(t.a)(mb,"ExcelLiveWebEntryPointCallout",He,[]);class Oc{constructor(Pc){this.$=Pc;this.tC=new Pa.a(!1)}Xsi(Pc){if(!this.tC.$d(ya[Pc]))switch(Pc){case 0:this.mFh(Pc);break;case 2:this.tC.add(ya[Pc],new Fc(this.$));break;case 3:this.tC.add(ya[Pc],new ge(this.$));break;case 6:this.tC.add(ya[Pc],new ld(this.$));break;case 1:this.tC.add(ya[Pc],new hb(this.$));
break;case 4:this.tC.add(ya[Pc],new pb(this.$));break;case 5:this.tC.add(ya[Pc],new xc(this.$));break;case 7:this.tC.add(ya[Pc],new cb(this.$));break;case 8:this.tC.add(ya[Pc],new qd(this.$));break;case 9:this.tC.add(ya[Pc],new wb(this.$));break;case 13:this.tC.add(ya[Pc],new ke(this.$));break;case 10:this.tC.add(ya[Pc],new ad(this.$));break;case 11:this.tC.add(ya[Pc],new Fd(this.$));break;case 12:this.tC.add(ya[Pc],new Xd(this.$));break;case 14:this.tC.add(ya[Pc],new Bd(this.$));break;case 15:this.tC.add(ya[Pc],
new ye(this.$));break;case 16:this.tC.add(ya[Pc],new Sb(this.$));break;case 18:this.tC.add(ya[Pc],new Xc(this.$));break;case 20:this.tC.add(ya[Pc],new mb(this.$));break;case 21:this.tC.add(ya[Pc],new fd(this.$));break;default:return null}return this.tC.getItem(ya[Pc])}mFh(Pc){this.tC.add(ya[Pc],new Cb(this.$,Ca.a.instance.za(640),Ca.a.instance.za(637),Ca.a.instance.za(638),Ca.a.instance.za(639),16,4,!0))}}Object(t.a)(Oc,"EwaCalloutFactory",null,[]);var jd=a(60),ud=a(64),pd=a(154);let id=class{constructor(Pc){this.$=
Pc;this.YZh=new Oc(this.$)}Uf(){return!1}Yf(){return!1}Kf(Pc,eb,gc){Pc=gc.CalloutName;this.Nik=f.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(pd.c)(this.$)&&!this.vTi(Pc);return!!eb&&-847286761===eb.command&&jd.a.fj.IW&&!this.Nik}vTi(Pc){return this.$.iy&&9===Pc}executeCommand(Pc,eb,gc){Pc=gc.CalloutName;if(eb=this.YZh.Xsi(Pc)){switch(Pc){case 2:eb.WM(gc.Target,gc.RibbonButtonLabel,gc.ExampleEntities,gc.BlankCellResourceId,gc.HasBlankCellWalkthrough,
gc.ServiceDomain);break;case 3:eb.WM(gc.Target,gc.RibbonButtonLabel,gc.ExampleEntities);break;case 6:eb.WM(gc.Target);break;case 8:eb.WM(gc.Target);break;case 13:eb.WM(gc.Target);break;case 15:return eb.O1b(gc.Target),eb.DCa(gc.NewState,gc.Reason),ud.Task.Ra(!0);case 12:eb.WM(gc.Target,gc.ConvertToTableCallback,gc.NoThanksCallback);break;case 16:eb.WM(gc.SuggestionsCount,gc.WithoutCoolDown);break;case 18:eb.WM(gc.Target,gc.Operation,gc.Duration);break;case 21:eb.WM(gc.Trigger)}eb.show();return ud.Task.Ra(!0)}return ud.Task.Ra(!1)}};
id=Object(C.__decorate)([Object(Fa.d)(Za.Rd),Object(C.__param)(0,Object(Za.nb)())],id);Object(t.a)(id,"ShowCalloutCommandHandler",null,[165]);var Ed=a(280),Pd=a(263),lc=a(152),Kc=a(1144);let td=class{constructor(Pc){this.ofd=this.jud=null;this.tXc=this.isFocused=!1;this.$=Pc}dispose(){}get ng(){return null}get nl(){return this.tXc}get Qh(){return Pd.a.DTd}Wl(Pc,eb){eb||this.isFocused||!this.jud||this.jud();return!eb}Bm(Pc){return Pc===document.activeElement&&this.isFocused}Ko(){this.isFocused=!0}Rp(){this.isFocused&&
this.ofd&&(this.ofd(),this.isFocused=!1)}TNi(){u.ULS.shipAssertTag(537169939,0,lc.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const Pc=Object(x.a)(new Kc.a,{onFirstActionableAppear:()=>{Ed.a(this.$).sn(this);this.tXc=!0},onLastActionableDisappear:()=>{Ed.a(this.$).rD(this);this.tXc=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(Pc).then(eb=>
{this.jud=()=>{eb.focus()};this.ofd=()=>{eb.blur()};return null})}};td=Object(C.__decorate)([Object(Fa.d)(Za.ob),Object(C.__param)(0,Object(Za.nb)())],td);Object(t.a)(td,"EwaNotificationFocusManager",null,[654,2,54]);var zd=a(82),me=a(59);const Ae=(Pc,eb,gc,Qc,Vc,Id,be)=>{be=Pc.Oa(1,void 0===be?null:be);be.sheetName=eb;return me.h(Pc,"EvaluateSheetOptimizableContent",be,gc,Qc,Vc,Id,4)};var ze=a(44),Ne=a(137);class hf{constructor(Pc,eb){this.sessionID=null;this.V9f=gc=>{if(gc){let Qc=ze.d(gc.data);
({ev:gc}=Qc);if(Qc.returnValue&&(gc=Object(Ne.a)(Object,gc))&&"OptimizeWorkbookTaskPane"===gc.Origin)if(this.sessionID!==gc.SessionId)u.ULS.sendTraceTag(509748062,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(gc.Event){case "CoauthorsDetected":this.lBj.Rjk();u.ULS.sendTraceTag(508117312,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Coauth error dialog shown.");
break;default:u.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.lBj=Pc;this.sessionID=eb}initialize(){window.addEventListener("message",this.V9f,!1)}dispose(){window.removeEventListener("message",this.V9f,!1)}}Object(t.a)(hf,"OptimizeWorkbookTaskPaneListener",null,[]);var rf=a(167);let df=class extends zd.a{constructor(Pc){super();this.businessBar=null;this.Ktb=2;this.awb=-1;this.bLc=!1;this.CTb=null;this.Xsc=
!1;this.mVd=eb=>{this.$&&((eb=eb.Result)?eb.HasSignificantOptimizableContent?(u.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),f.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.ea.r$(this.kA),eb.OptimizableRangesOrPercentage&&(this.awb=eb.OptimizableRangesOrPercentage),0>=this.awb&&0!==this.Ktb&&(u.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),
this.Ktb=0),f.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&!eb.Completed?u.ULS.sendTraceTag(508170697,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation was marked as not complete"):this.Wob()):u.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):u.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.Dwj=
(eb,gc,Qc)=>{(eb=eb.Result)?eb.HasSignificantOptimizableContent?(u.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.bLc=!0,this.mmk(gc,Qc)):u.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):u.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.kA=(eb,gc)=>{eb=1<gc.dNg;
this.Xsc||eb?this.Xsc&&eb&&(this.businessBar&&this.businessBar.Yia(62)&&(u.ULS.sendTraceTag(508170695,0,50,"OptimizeWorkbookManager.onUserListChanged: Hide the business bar"),this.wEa()),this.$.ea.P1(this.kA)):(this.Wob(),this.Xsc=!0,u.ULS.sendTraceTag(508170696,0,50,"OptimizeWorkbookManager.onUserListChanged: Show the business bar"))};this.$=Pc;this.Epk();this.bLc=!1;this.NUh=f.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.CTb=new hf(this,this.$.ea.sessionId)}dispose(){this.wEa();
f.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.ea.P1(this.kA);this.$=this.businessBar=null;this.m8e();super.dispose()}nPi(){this.CTb&&this.CTb.initialize()}m8e(){this.CTb&&this.CTb.dispose()}wEa(){this.businessBar&&this.businessBar.Yia(62)&&this.businessBar.removeEntry(62)}Epk(){Ee.a.instance.We("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Pc=>{Pc.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(eb=>{if(eb){var gc=
this.$.oa.ua,Qc=this.Ktb,Vc=this.mVd;const Id=gc.Oa(1,null);Id.businessBarMessageType=Qc;me.h(gc,"EvaluateOptimizableContentV2",Id,Vc,null,null,null,4)}return eb})})}Wob(){this.Xsc=!0;const Pc=Object(xa.d)(Fa.a.resolve(Za.s,{Aa:1}));y.TaskExtensions.Ca(Pc,()=>{const eb=Pc.result;eb&&(eb.Uj(62,null,null,this.jii()),this.businessBar=eb)},this.$.qa,3)}jii(){switch(this.Ktb){default:return Ca.a.instance.ia(2239);case 1:return String.format(Ca.a.instance.za(720),this.awb);case 2:return String.format(Ca.a.instance.za(721),
this.awb)}}wea(Pc,eb,gc){if(eb&&eb.RequestTelemetryData&&!(eb.RequestTelemetryData.EcsOperationDuration<this.NUh)&&this.businessBar&&this.businessBar.Yia(62)&&!this.bLc){var Qc=gc?gc:this.$.na.sheetName;if(6===Pc||7===Pc||8===Pc||9===Pc)this.evaluateSheetOptimizableContent(Qc,Pc,eb.RequestTelemetryData.EcsOperationDuration);else{const Vc=()=>{P.h(this.$).ya.Ot(Vc);this.evaluateSheetOptimizableContent(Qc,Pc,eb.RequestTelemetryData.EcsOperationDuration)};P.h(this.$).ya.Uu(Vc)}}}evaluateSheetOptimizableContent(Pc,
eb,gc){Ae(this.$.oa.ua,Pc,Qc=>{this.Dwj(Qc,eb,gc)},null,null,null)}mmk(Pc,eb){const gc=new qc.a(-847286761,Tb.a.Ke,this.$.zf,0,null),Qc={CalloutName:18};Qc.Target=this.businessBar.kwd(62);Qc.Operation=Pc;Qc.Duration=eb;this.$.Ha.Me(gc,Qc)}Rjk(){const Pc=new rf.StandardDialog;Pc.Ye=0;Pc.qn(Ca.a.instance.za(874),Ca.a.instance.za(875),0)}};df=Object(C.__decorate)([Object(Fa.d)(Za.Sc),Object(C.__param)(0,Object(Za.nb)())],df);Object(t.a)(df,"OptimizeWorkbookManager",zd.a,[655]);let Af=class extends zd.a{constructor(Pc){super();
this.mVd=eb=>{eb.Result&&u.ULS.sendTraceTag(507883930,0,50,"FormulaRemediationManager.OnEvaluateSuccess:  broken formula")};this.$=Pc;this.g9i()}g9i(){var Pc=this.$.oa.ua,eb=this.mVd;const gc=Pc.Oa(1,null);me.h(Pc,"BrokenFormulasTelemetry",gc,eb,null,null,null,4)}dispose(){this.$=null;super.dispose()}};Af=Object(C.__decorate)([Object(Fa.d)(Za.Rb),Object(C.__param)(0,Object(Za.nb)())],Af);Object(t.a)(Af,"FormulaRemediationManager",zd.a,[]);(()=>{h.a.Na(Pc=>{Za.he.$e()||db.ta(Pc);f.EwaSettings.isChangeGateEnabled("OfficeVSO:8486356_MigrateTableIntelligenceDarkActivationManager")||
zb.ta(Pc)})})();String(m);String(d);String(n);String(l);String(k);String(b);String(c);window.___1699049107561_closurehack=m;window.___1699049107561_closurehack=d;window.___1699049107561_closurehack=n;window.___1699049107561_closurehack=l;window.___1699049107561_closurehack=k;window.___1699049107561_closurehack=b;window.___1699049107561_closurehack=c}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/85b8393992c5c3b9af84f0b6d3c46c57/EwaTS.pid.js.map